(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Jk=50,Zk=.25,da=1,ms=4,eN=2,tN=5,OE=10,nN=300,xd=1500,ME=100,Of=250,ni=1e3,__=500,gn="DIALOG_CLOSED_REASON",LE=60,rN=5,VE=2,FE=.25,BE=.75,iN=["animals","letters","digits","people","geometric","stuff"],wc=["0ï¸âƒ£","1ï¸âƒ£","2ï¸âƒ£","3ï¸âƒ£","4ï¸âƒ£","5ï¸âƒ£","6ï¸âƒ£","7ï¸âƒ£","8ï¸âƒ£","9ï¸âƒ£"],Ec=["ðŸ„°","ðŸ„±","ðŸ„²","ðŸ„³","ðŸ„´","ðŸ„µ","ðŸ„¶","ðŸ„·","ðŸ„¸","ðŸ„¹","ðŸ„º","ðŸ„»","ðŸ„¼","ðŸ„½","ðŸ„¾","ðŸ„¿","ðŸ…€","ðŸ…","ðŸ…‚","ðŸ…ƒ","ðŸ…„","ðŸ……","ðŸ…†","ðŸ…‡","ðŸ…ˆ","ðŸ…‰"];window.sentryOnLoad=function(){Sentry.init({enabled:!0,release:`a966b11
`,environment:"production",beforeSend:(t,e)=>e.originalException===gn?null:t})};{let t=function(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","G-F7R3KZMTTS",{anonymize_ip:!0,cookie_expires:0})}var sN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function US(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function oN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var jS={exports:{}},Ug={},zS={exports:{}},ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fh=Symbol.for("react.element"),aN=Symbol.for("react.portal"),lN=Symbol.for("react.fragment"),uN=Symbol.for("react.strict_mode"),cN=Symbol.for("react.profiler"),hN=Symbol.for("react.provider"),dN=Symbol.for("react.context"),fN=Symbol.for("react.forward_ref"),gN=Symbol.for("react.suspense"),pN=Symbol.for("react.memo"),mN=Symbol.for("react.lazy"),UE=Symbol.iterator;function _N(t){return t===null||typeof t!="object"?null:(t=UE&&t[UE]||t["@@iterator"],typeof t=="function"?t:null)}var $S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qS=Object.assign,HS={};function Eu(t,e,n){this.props=t,this.context=e,this.refs=HS,this.updater=n||$S}Eu.prototype.isReactComponent={};Eu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Eu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function GS(){}GS.prototype=Eu.prototype;function xy(t,e,n){this.props=t,this.context=e,this.refs=HS,this.updater=n||$S}var Cy=xy.prototype=new GS;Cy.constructor=xy;qS(Cy,Eu.prototype);Cy.isPureReactComponent=!0;var jE=Array.isArray,WS=Object.prototype.hasOwnProperty,Ay={current:null},KS={key:!0,ref:!0,__self:!0,__source:!0};function QS(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)WS.call(e,r)&&!KS.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var h=Array(u),g=0;g<u;g++)h[g]=arguments[g+2];i.children=h}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Fh,type:t,key:s,ref:a,props:i,_owner:Ay.current}}function vN(t,e){return{$$typeof:Fh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function by(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fh}function yN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var zE=/\/+/g;function hm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?yN(""+t.key):e.toString(36)}function af(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Fh:case aN:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+hm(a,0):r,jE(i)?(n="",t!=null&&(n=t.replace(zE,"$&/")+"/"),af(i,e,n,"",function(g){return g})):i!=null&&(by(i)&&(i=vN(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(zE,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",jE(t))for(var u=0;u<t.length;u++){s=t[u];var h=r+hm(s,u);a+=af(s,e,n,h,i)}else if(h=_N(t),typeof h=="function")for(t=h.call(t),u=0;!(s=t.next()).done;)s=s.value,h=r+hm(s,u++),a+=af(s,e,n,h,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Cd(t,e,n){if(t==null)return t;var r=[],i=0;return af(t,r,"","",function(s){return e.call(n,s,i++)}),r}function wN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wr={current:null},lf={transition:null},EN={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:lf,ReactCurrentOwner:Ay};ft.Children={map:Cd,forEach:function(t,e,n){Cd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Cd(t,function(){e++}),e},toArray:function(t){return Cd(t,function(e){return e})||[]},only:function(t){if(!by(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ft.Component=Eu;ft.Fragment=lN;ft.Profiler=cN;ft.PureComponent=xy;ft.StrictMode=uN;ft.Suspense=gN;ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EN;ft.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=qS({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Ay.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(h in e)WS.call(e,h)&&!KS.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&u!==void 0?u[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=n;else if(1<h){u=Array(h);for(var g=0;g<h;g++)u[g]=arguments[g+2];r.children=u}return{$$typeof:Fh,type:t.type,key:i,ref:s,props:r,_owner:a}};ft.createContext=function(t){return t={$$typeof:dN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hN,_context:t},t.Consumer=t};ft.createElement=QS;ft.createFactory=function(t){var e=QS.bind(null,t);return e.type=t,e};ft.createRef=function(){return{current:null}};ft.forwardRef=function(t){return{$$typeof:fN,render:t}};ft.isValidElement=by;ft.lazy=function(t){return{$$typeof:mN,_payload:{_status:-1,_result:t},_init:wN}};ft.memo=function(t,e){return{$$typeof:pN,type:t,compare:e===void 0?null:e}};ft.startTransition=function(t){var e=lf.transition;lf.transition={};try{t()}finally{lf.transition=e}};ft.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ft.useCallback=function(t,e){return wr.current.useCallback(t,e)};ft.useContext=function(t){return wr.current.useContext(t)};ft.useDebugValue=function(){};ft.useDeferredValue=function(t){return wr.current.useDeferredValue(t)};ft.useEffect=function(t,e){return wr.current.useEffect(t,e)};ft.useId=function(){return wr.current.useId()};ft.useImperativeHandle=function(t,e,n){return wr.current.useImperativeHandle(t,e,n)};ft.useInsertionEffect=function(t,e){return wr.current.useInsertionEffect(t,e)};ft.useLayoutEffect=function(t,e){return wr.current.useLayoutEffect(t,e)};ft.useMemo=function(t,e){return wr.current.useMemo(t,e)};ft.useReducer=function(t,e,n){return wr.current.useReducer(t,e,n)};ft.useRef=function(t){return wr.current.useRef(t)};ft.useState=function(t){return wr.current.useState(t)};ft.useSyncExternalStore=function(t,e,n){return wr.current.useSyncExternalStore(t,e,n)};ft.useTransition=function(){return wr.current.useTransition()};ft.version="18.2.0";zS.exports=ft;var G=zS.exports;const Ct=US(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IN=G,TN=Symbol.for("react.element"),SN=Symbol.for("react.fragment"),xN=Object.prototype.hasOwnProperty,CN=IN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AN={key:!0,ref:!0,__self:!0,__source:!0};function YS(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)xN.call(e,r)&&!AN.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:TN,type:t,key:s,ref:a,props:i,_owner:CN.current}}Ug.Fragment=SN;Ug.jsx=YS;Ug.jsxs=YS;jS.exports=Ug;var R=jS.exports,bN={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var v_=function(t,e){return v_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},v_(t,e)};function XS(t,e){v_(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var jr=function(){return jr=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},jr.apply(this,arguments)};function jc(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Xl(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,i++)r[i]=s[a];return r}function PN(t,e){for(;t.length<e;)t="0"+t;return t}function cs(t,e){var n,r,i;if(e.length===0)return t;for(n=0,i=e.length;n<i;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t<0?t*-2:t}function RN(t,e,n){return Object.keys(e).sort().reduce(r,t);function r(i,s){return JS(i,e[s],s,n)}}function JS(t,e,n,r){var i=cs(cs(cs(t,n),kN(e)),typeof e);if(e===null)return cs(i,"null");if(e===void 0)return cs(i,"undefined");if(typeof e=="object"||typeof e=="function"){if(r.indexOf(e)!==-1)return cs(i,"[Circular]"+n);r.push(e);var s=RN(i,e,r);if(!("valueOf"in e)||typeof e.valueOf!="function")return s;try{return cs(s,String(e.valueOf()))}catch(a){return cs(s,"[valueOf exception]"+(a.stack||a.message))}}return cs(i,e.toString())}function kN(t){return Object.prototype.toString.call(t)}function NN(t){return PN(JS(0,t,"",[]).toString(16),8)}var Py=NN,DN={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ON={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},MN={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],size:["width","height"]},LN={color:"colors",backgroundColor:"colors",borderColor:"colors",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",outlineColor:"colors",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",fill:"colors",stroke:"colors"},VN={margin:1,marginTop:1,marginRight:1,marginBottom:1,marginLeft:1,marginX:1,marginY:1,top:1,bottom:1,left:1,right:1},Ti={unitlessProperties:DN,propertyAliases:ON,multiplePropertyAliases:MN,propertyScales:LN,negativeProperties:VN},zr=function(t,e,n){for(var r=t,i=typeof e=="string"?e.split("."):[e],s=0,a=i;s<a.length;s++){var u=a[s];r=r?r[u]:void 0}return r===void 0?n:r},ZS=function(t,e){if(typeof e!="number"||e>=0)return zr(t,e,e);var n=Math.abs(e),r=zr(t,n,n);return typeof r=="string"?"-"+r:r*-1},y_=function(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!(t in Ti.unitlessProperties)?e+"px":String(e).trim()},w_=function(t){return t.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})},FN=function(t,e){var n={},r=zr(e,"breakpoints"),i=Object.entries(r).reduce(function(I,j,z){var X,V=j[0],B=j[1];return jr(jr({},I),(X={},X[V]="@media screen and (min-width: #"+z+"#"+B+")",X))},{_:null});for(var s in t){var a=t[s],u=typeof a;if(a!=null){if(s.includes("&")||s.startsWith("@")||u==="string"||u==="number"){n[s]=a;continue}for(var h=Object.keys(a),g=0,m=h;g<m.length;g++){var w=m[g],T=i[w];if(!T){n[s]=a[w];continue}n[T]=n[T]||{},a[w]!=null&&(n[T][s]=a[w])}}}return n},Ry=function(t,e){var n={},r=FN(t,e);for(var i in r){var s=r[i];if(s&&typeof s=="object"){n[i]=Ry(s,e);continue}var a=zr(Ti.propertyAliases,i,i),u=zr(Ti.propertyScales,a),h=zr(e,u,zr(e,a,{})),g=a in Ti.negativeProperties?ZS(h,s):zr(h,s,s);if(Ti.multiplePropertyAliases[a])for(var m=Ti.multiplePropertyAliases[a],w=0;w<m.length;w++)n[m[w]]=g;else n[a]=g}return n},E_=function(t,e,n){Object.keys(e).forEach(function(r){var i=e[r];typeof i=="string"||typeof i=="number"?(n[t]||(n[t]=""),n[t]+=w_(r)+":"+y_(r,i)+";"):typeof i=="object"&&(r.startsWith("@media")||r.startsWith("@supports")?(n[r]||(n[r]={}),E_(t,i,n[r])):E_(r.replace(/&/g,t),i,n))})},ex=function(t){var e={};return E_("&",t,e),e},ky=[],lo="global",Mf="data-css-system-id",I_="data-css-system-ids",T_=" ",BN=typeof process=="object"&&bN&&!1,S_=function(){function t(e){var n=this;this.createdIds={};var r=document.querySelector("style["+Mf+'="'+e+'"]');if(r===null)r=document.createElement("style"),r.setAttribute(Mf,e),document.head.appendChild(r);else{var i=r.getAttribute(I_);i!==null&&i.split(T_).forEach(function(s){return n.createdIds[s]=!0})}this.element=r}return t.prototype.insertRule=function(e){var n=this.element.sheet;n.insertRule(e,n.cssRules.length)},t.prototype.remove=function(){this.element.remove()},t}(),$E=function(t){XS(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.insertRule=function(n){this.element.textContent+=n+`
`},e}(S_),tx=function(){function t(){var e;this.styleSheets=(e={},e[lo]=new S_(lo),e)}return t.prototype.getGlobalStyleSheet=function(){return this.styleSheets[lo]},t.prototype.createStyleSheet=function(e){return this.styleSheets[e]=new S_(e),this.styleSheets[e]},t.prototype.removeStyleSheet=function(e){this.styleSheets[e]&&(this.styleSheets[e].remove(),delete this.styleSheets[e])},t}(),UN=function(t){XS(e,t);function e(){var n,r=t!==null&&t.apply(this,arguments)||this;return r.styleSheets=(n={},n[lo]=new $E(lo),n),r}return e.prototype.createStyleSheet=function(n){return this.styleSheets[n]=new $E(n),this.styleSheets[n]},e}(tx),qE=function(){function t(e){this.rules=[],this.createdIds={},this.id=e}return t.prototype.insertRule=function(e){this.rules.push(e)},t.prototype.getStyleTag=function(){return"<style "+Mf+'="'+this.id+'" '+I_+'="'+Object.keys(this.createdIds).join(T_)+'">'+this.rules.join(`
`)+"</style>"},t.prototype.getStyleComponent=function(){var e;return G.createElement("style",(e={},e[Mf]=this.id,e[I_]=Object.keys(this.createdIds).join(T_),e.dangerouslySetInnerHTML={__html:this.rules.join(`
`)},e))},t}(),jN=function(){function t(){var e;this.styleSheets=(e={},e[lo]=new qE(lo),e)}return t.prototype.getGlobalStyleSheet=function(){return this.styleSheets[lo]},t.prototype.createStyleSheet=function(e){return this.styleSheets[e]=new qE(e),this.styleSheets[e]},t.prototype.removeStyleSheet=function(e){delete this.styleSheets[e]},t.prototype.getStyleTags=function(){return Object.values(this.styleSheets).map(function(e){return e.getStyleTag()}).join(`
`)},t.prototype.getStyleComponents=function(){return Object.values(this.styleSheets).map(function(e){return e.getStyleComponent()})},t}(),zN=typeof document<"u",Ny=G.createContext(zN?BN?new UN:new tx:new jN),$N={breakpoints:{s:"40em",m:"52em",l:"64em"},space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},Di=G.createContext($N),qN=function(t,e){e===void 0&&(e=ky);var n=G.useContext(Ny),r=G.useContext(Di),i=G.useMemo(function(){var s=Ry(t,r),a=Py(s),u="style-"+a,h=n.getGlobalStyleSheet();if(!h.createdIds[u]){for(var g=ex(s),m=Object.keys(g).sort(function(J,re){return J<re?-1:J>re?1:0}),w=0,T=m;w<T.length;w++){var I=T[w];if(typeof g[I]=="string"){var j=I.replace(/&/g,"."+u),z=g[I];h.insertRule(j+"{"+z+"}")}else{var X=I,V=g[X],B="";for(var U in V){var j=U.replace(/&/g,"."+u),z=V[U];B+=j+"{"+z+"}"}h.insertRule(X.replace(/#\d#/,"")+"{"+B+"}")}}h.createdIds[u]=!0}return u},Xl([r],e));return i},HN=function(t,e){e===void 0&&(e=ky);var n=G.useContext(Ny),r=G.useContext(Di),i=G.useMemo(function(){var s=Py({systemObject:t,theme:r}),a=n.createStyleSheet(s);for(var u in t)for(var h=Ry(t[u],r),g=ex(h),m=Object.keys(g).sort(function(J,re){return J<re?-1:J>re?1:0}),w=0,T=m;w<T.length;w++){var I=T[w];if(typeof g[I]=="string"){var j=I.replace(/&/g,u).replace(/#\d#/,""),z=g[I];a.insertRule(j+"{"+z+"}")}else{var X=I,V=g[X],B="";for(var U in V){var j=U.replace(/&/g,u),z=V[U];B+=j+"{"+z+"}"}a.insertRule(X.replace(/#\d#/,"")+"{"+B+"}")}}return s},Xl([r],e));G.useEffect(function(){return function(){return n.removeStyleSheet(i)}},Xl([i,r],e))},GN=function(t,e){var n="";for(var r in t){var i=t[r],s=zr(Ti.propertyAliases,r,r),a=zr(Ti.propertyScales,s),u=zr(e,a,zr(e,s,{})),h=s in Ti.negativeProperties?ZS(u,i):zr(u,i,i);if(Ti.multiplePropertyAliases[s])for(var g=Ti.multiplePropertyAliases[s],m=0;m<g.length;m++)n+=w_(g[m])+":"+y_(s,h)+";";else n+=w_(s)+":"+y_(s,h)+";"}return n},Lf=function(t,e){e===void 0&&(e=ky);var n=G.useContext(Ny),r=G.useContext(Di),i=G.useMemo(function(){var s="keyframes-"+Py({keyframesObject:t,theme:r}),a=n.getGlobalStyleSheet();if(!a.createdIds[s]){var u="";for(var h in t){var g=t[h],m=isNaN(h)?h:h+"%",w=GN(g,r);u+=m+"{"+w+"}"}a.insertRule("@keyframes "+s+"{"+u+"}"),a.createdIds[s]=!0}return s},Xl([r],e));return i},nx=function(t){var e=t.css,n=jc(t,["css"]);return function(r){var i=r.css,s=jc(r,["css"]);return jr(jr(jr({},n),{css:jr(jr({},e),i)}),s)}},Bh=function(t,e){var n=typeof e=="function"?e:nx(e);return Ct.forwardRef(function(r,i){var s=n(r),a=s.as,u=a===void 0?t:a,h=s.css,g=s.deps,m=s.className,w=jc(s,["as","css","deps","className"]),T=qN(h,g),I=m?m+" "+T:T;return Ct.createElement(u,jr({ref:i},w,{className:I}))})},as=function(t,e){var n=typeof e=="function"?e:nx(e);return Ct.forwardRef(function(r,i){var s=n(r),a=s.css,u=jc(s,["css"]);return Ct.createElement(t,jr({ref:i,css:a},u))})},WN=function(t){var e=t.gap,n=jc(t,["gap"]),r=n.flexDirection,i=G.useContext(Di),s=G.useMemo(function(){var a;if(e&&r){if(typeof r=="string"){var u=r==="column"||r==="column-reverse";return{"& > * + *":(a={},a[u?"mt":"ml"]=e,a)}}for(var h=void 0,g=void 0,m=typeof e=="object"?e:{_:e},w=r,T=new Set(Xl(Object.keys(w),Object.keys(m))),I={},j={},z=Xl(["_"],Object.keys(i.breakpoints)),X=0,V=z;X<V.length;X++){var B=V[X];if(T.has(B)!==!1){var U=B,J=w[U]!=null?w[U]:h;h=J;var re=m[U]!=null?m[U]:g;g=re;var u=J==="column"||J==="column-reverse";u?(I[U]=re,j[U]=0):(j[U]=re,I[U]=0)}}return{"& > * + *":{mt:I,ml:j}}}},[e,r,i]);return e?jr(jr({},n),s):n},x_={},rx={exports:{}},Yr={},ix={exports:{}},sx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ce,Te){var Oe=Ce.length;Ce.push(Te);e:for(;0<Oe;){var Je=Oe-1>>>1,Tt=Ce[Je];if(0<i(Tt,Te))Ce[Je]=Te,Ce[Oe]=Tt,Oe=Je;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function r(Ce){if(Ce.length===0)return null;var Te=Ce[0],Oe=Ce.pop();if(Oe!==Te){Ce[0]=Oe;e:for(var Je=0,Tt=Ce.length,ot=Tt>>>1;Je<ot;){var Ft=2*(Je+1)-1,Xe=Ce[Ft],dn=Ft+1,Cn=Ce[dn];if(0>i(Xe,Oe))dn<Tt&&0>i(Cn,Xe)?(Ce[Je]=Cn,Ce[dn]=Oe,Je=dn):(Ce[Je]=Xe,Ce[Ft]=Oe,Je=Ft);else if(dn<Tt&&0>i(Cn,Oe))Ce[Je]=Cn,Ce[dn]=Oe,Je=dn;else break e}}return Te}function i(Ce,Te){var Oe=Ce.sortIndex-Te.sortIndex;return Oe!==0?Oe:Ce.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var h=[],g=[],m=1,w=null,T=3,I=!1,j=!1,z=!1,X=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Ce){for(var Te=n(g);Te!==null;){if(Te.callback===null)r(g);else if(Te.startTime<=Ce)r(g),Te.sortIndex=Te.expirationTime,e(h,Te);else break;Te=n(g)}}function J(Ce){if(z=!1,U(Ce),!j)if(n(h)!==null)j=!0,he(re);else{var Te=n(g);Te!==null&&lt(J,Te.startTime-Ce)}}function re(Ce,Te){j=!1,z&&(z=!1,V(ne),ne=-1),I=!0;var Oe=T;try{for(U(Te),w=n(h);w!==null&&(!(w.expirationTime>Te)||Ce&&!rt());){var Je=w.callback;if(typeof Je=="function"){w.callback=null,T=w.priorityLevel;var Tt=Je(w.expirationTime<=Te);Te=t.unstable_now(),typeof Tt=="function"?w.callback=Tt:w===n(h)&&r(h),U(Te)}else r(h);w=n(h)}if(w!==null)var ot=!0;else{var Ft=n(g);Ft!==null&&lt(J,Ft.startTime-Te),ot=!1}return ot}finally{w=null,T=Oe,I=!1}}var te=!1,ae=null,ne=-1,me=5,pe=-1;function rt(){return!(t.unstable_now()-pe<me)}function Ve(){if(ae!==null){var Ce=t.unstable_now();pe=Ce;var Te=!0;try{Te=ae(!0,Ce)}finally{Te?xe():(te=!1,ae=null)}}else te=!1}var xe;if(typeof B=="function")xe=function(){B(Ve)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,it=we.port2;we.port1.onmessage=Ve,xe=function(){it.postMessage(null)}}else xe=function(){X(Ve,0)};function he(Ce){ae=Ce,te||(te=!0,xe())}function lt(Ce,Te){ne=X(function(){Ce(t.unstable_now())},Te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){j||I||(j=!0,he(re))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(Ce){switch(T){case 1:case 2:case 3:var Te=3;break;default:Te=T}var Oe=T;T=Te;try{return Ce()}finally{T=Oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,Te){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var Oe=T;T=Ce;try{return Te()}finally{T=Oe}},t.unstable_scheduleCallback=function(Ce,Te,Oe){var Je=t.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?Je+Oe:Je):Oe=Je,Ce){case 1:var Tt=-1;break;case 2:Tt=250;break;case 5:Tt=1073741823;break;case 4:Tt=1e4;break;default:Tt=5e3}return Tt=Oe+Tt,Ce={id:m++,callback:Te,priorityLevel:Ce,startTime:Oe,expirationTime:Tt,sortIndex:-1},Oe>Je?(Ce.sortIndex=Oe,e(g,Ce),n(h)===null&&Ce===n(g)&&(z?(V(ne),ne=-1):z=!0,lt(J,Oe-Je))):(Ce.sortIndex=Tt,e(h,Ce),j||I||(j=!0,he(re))),Ce},t.unstable_shouldYield=rt,t.unstable_wrapCallback=function(Ce){var Te=T;return function(){var Oe=T;T=Te;try{return Ce.apply(this,arguments)}finally{T=Oe}}}})(sx);ix.exports=sx;var KN=ix.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ox=G,Wr=KN;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ax=new Set,zc={};function Wa(t,e){Jl(t,e),Jl(t+"Capture",e)}function Jl(t,e){for(zc[t]=e,t=0;t<e.length;t++)ax.add(e[t])}var As=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),C_=Object.prototype.hasOwnProperty,QN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HE={},GE={};function YN(t){return C_.call(GE,t)?!0:C_.call(HE,t)?!1:QN.test(t)?GE[t]=!0:(HE[t]=!0,!1)}function XN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JN(t,e,n,r){if(e===null||typeof e>"u"||XN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Er(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wn[t]=new Er(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wn[e]=new Er(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wn[t]=new Er(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wn[t]=new Er(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wn[t]=new Er(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wn[t]=new Er(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wn[t]=new Er(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wn[t]=new Er(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wn[t]=new Er(t,5,!1,t.toLowerCase(),null,!1,!1)});var Dy=/[\-:]([a-z])/g;function Oy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Dy,Oy);Wn[e]=new Er(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Dy,Oy);Wn[e]=new Er(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Dy,Oy);Wn[e]=new Er(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wn[t]=new Er(t,1,!1,t.toLowerCase(),null,!1,!1)});Wn.xlinkHref=new Er("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wn[t]=new Er(t,1,!1,t.toLowerCase(),null,!0,!0)});function My(t,e,n,r){var i=Wn.hasOwnProperty(e)?Wn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JN(e,n,i,r)&&(n=null),r||i===null?YN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Vs=ox.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ad=Symbol.for("react.element"),El=Symbol.for("react.portal"),Il=Symbol.for("react.fragment"),Ly=Symbol.for("react.strict_mode"),A_=Symbol.for("react.profiler"),lx=Symbol.for("react.provider"),ux=Symbol.for("react.context"),Vy=Symbol.for("react.forward_ref"),b_=Symbol.for("react.suspense"),P_=Symbol.for("react.suspense_list"),Fy=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),cx=Symbol.for("react.offscreen"),WE=Symbol.iterator;function Uu(t){return t===null||typeof t!="object"?null:(t=WE&&t[WE]||t["@@iterator"],typeof t=="function"?t:null)}var en=Object.assign,dm;function lc(t){if(dm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);dm=e&&e[1]||""}return`
`+dm+t}var fm=!1;function gm(t,e){if(!t||fm)return"";fm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(g){var r=g}Reflect.construct(t,[],e)}else{try{e.call()}catch(g){r=g}t.call(e.prototype)}else{try{throw Error()}catch(g){r=g}t()}}catch(g){if(g&&r&&typeof g.stack=="string"){for(var i=g.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,u=s.length-1;1<=a&&0<=u&&i[a]!==s[u];)u--;for(;1<=a&&0<=u;a--,u--)if(i[a]!==s[u]){if(a!==1||u!==1)do if(a--,u--,0>u||i[a]!==s[u]){var h=`
`+i[a].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=a&&0<=u);break}}}finally{fm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?lc(t):""}function ZN(t){switch(t.tag){case 5:return lc(t.type);case 16:return lc("Lazy");case 13:return lc("Suspense");case 19:return lc("SuspenseList");case 0:case 2:case 15:return t=gm(t.type,!1),t;case 11:return t=gm(t.type.render,!1),t;case 1:return t=gm(t.type,!0),t;default:return""}}function R_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Il:return"Fragment";case El:return"Portal";case A_:return"Profiler";case Ly:return"StrictMode";case b_:return"Suspense";case P_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ux:return(t.displayName||"Context")+".Consumer";case lx:return(t._context.displayName||"Context")+".Provider";case Vy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fy:return e=t.displayName||null,e!==null?e:R_(t.type)||"Memo";case Ys:e=t._payload,t=t._init;try{return R_(t(e))}catch{}}return null}function eD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R_(e);case 8:return e===Ly?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Eo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function hx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tD(t){var e=hx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function bd(t){t._valueTracker||(t._valueTracker=tD(t))}function dx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=hx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function k_(t,e){var n=e.checked;return en({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function KE(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Eo(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fx(t,e){e=e.checked,e!=null&&My(t,"checked",e,!1)}function N_(t,e){fx(t,e);var n=Eo(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?D_(t,e.type,n):e.hasOwnProperty("defaultValue")&&D_(t,e.type,Eo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function QE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function D_(t,e,n){(e!=="number"||Vf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var uc=Array.isArray;function Fl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Eo(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function O_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return en({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function YE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ye(92));if(uc(n)){if(1<n.length)throw Error(ye(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Eo(n)}}function gx(t,e){var n=Eo(e.value),r=Eo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function XE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function px(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function M_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?px(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pd,mx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pd=Pd||document.createElement("div"),Pd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $c(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nD=["Webkit","ms","Moz","O"];Object.keys(Ic).forEach(function(t){nD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ic[e]=Ic[t]})});function _x(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ic.hasOwnProperty(t)&&Ic[t]?(""+e).trim():e+"px"}function vx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=_x(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var rD=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function L_(t,e){if(e){if(rD[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function V_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var F_=null;function By(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var B_=null,Bl=null,Ul=null;function JE(t){if(t=zh(t)){if(typeof B_!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=Hg(e),B_(t.stateNode,t.type,e))}}function yx(t){Bl?Ul?Ul.push(t):Ul=[t]:Bl=t}function wx(){if(Bl){var t=Bl,e=Ul;if(Ul=Bl=null,JE(t),e)for(t=0;t<e.length;t++)JE(e[t])}}function Ex(t,e){return t(e)}function Ix(){}var pm=!1;function Tx(t,e,n){if(pm)return t(e,n);pm=!0;try{return Ex(t,e,n)}finally{pm=!1,(Bl!==null||Ul!==null)&&(Ix(),wx())}}function qc(t,e){var n=t.stateNode;if(n===null)return null;var r=Hg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ye(231,e,typeof n));return n}var U_=!1;if(As)try{var ju={};Object.defineProperty(ju,"passive",{get:function(){U_=!0}}),window.addEventListener("test",ju,ju),window.removeEventListener("test",ju,ju)}catch{U_=!1}function iD(t,e,n,r,i,s,a,u,h){var g=Array.prototype.slice.call(arguments,3);try{e.apply(n,g)}catch(m){this.onError(m)}}var Tc=!1,Ff=null,Bf=!1,j_=null,sD={onError:function(t){Tc=!0,Ff=t}};function oD(t,e,n,r,i,s,a,u,h){Tc=!1,Ff=null,iD.apply(sD,arguments)}function aD(t,e,n,r,i,s,a,u,h){if(oD.apply(this,arguments),Tc){if(Tc){var g=Ff;Tc=!1,Ff=null}else throw Error(ye(198));Bf||(Bf=!0,j_=g)}}function Ka(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Sx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ZE(t){if(Ka(t)!==t)throw Error(ye(188))}function lD(t){var e=t.alternate;if(!e){if(e=Ka(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return ZE(i),t;if(s===r)return ZE(i),e;s=s.sibling}throw Error(ye(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,u=i.child;u;){if(u===n){a=!0,n=i,r=s;break}if(u===r){a=!0,r=i,n=s;break}u=u.sibling}if(!a){for(u=s.child;u;){if(u===n){a=!0,n=s,r=i;break}if(u===r){a=!0,r=s,n=i;break}u=u.sibling}if(!a)throw Error(ye(189))}}if(n.alternate!==r)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?t:e}function xx(t){return t=lD(t),t!==null?Cx(t):null}function Cx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cx(t);if(e!==null)return e;t=t.sibling}return null}var Ax=Wr.unstable_scheduleCallback,eI=Wr.unstable_cancelCallback,uD=Wr.unstable_shouldYield,cD=Wr.unstable_requestPaint,pn=Wr.unstable_now,hD=Wr.unstable_getCurrentPriorityLevel,Uy=Wr.unstable_ImmediatePriority,bx=Wr.unstable_UserBlockingPriority,Uf=Wr.unstable_NormalPriority,dD=Wr.unstable_LowPriority,Px=Wr.unstable_IdlePriority,jg=null,Ji=null;function fD(t){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(jg,t,void 0,(t.current.flags&128)===128)}catch{}}var Ci=Math.clz32?Math.clz32:mD,gD=Math.log,pD=Math.LN2;function mD(t){return t>>>=0,t===0?32:31-(gD(t)/pD|0)|0}var Rd=64,kd=4194304;function cc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~i;u!==0?r=cc(u):(s&=a,s!==0&&(r=cc(s)))}else a=n&~i,a!==0?r=cc(a):s!==0&&(r=cc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ci(e),i=1<<n,r|=t[n],e&=~i;return r}function _D(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vD(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Ci(s),u=1<<a,h=i[a];h===-1?(!(u&n)||u&r)&&(i[a]=_D(u,e)):h<=e&&(t.expiredLanes|=u),s&=~u}}function z_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Rx(){var t=Rd;return Rd<<=1,!(Rd&4194240)&&(Rd=64),t}function mm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Uh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ci(e),t[e]=n}function yD(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ci(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function jy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ci(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var bt=0;function kx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Nx,zy,Dx,Ox,Mx,$_=!1,Nd=[],uo=null,co=null,ho=null,Hc=new Map,Gc=new Map,Js=[],wD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tI(t,e){switch(t){case"focusin":case"focusout":uo=null;break;case"dragenter":case"dragleave":co=null;break;case"mouseover":case"mouseout":ho=null;break;case"pointerover":case"pointerout":Hc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(e.pointerId)}}function zu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=zh(e),e!==null&&zy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ED(t,e,n,r,i){switch(e){case"focusin":return uo=zu(uo,t,e,n,r,i),!0;case"dragenter":return co=zu(co,t,e,n,r,i),!0;case"mouseover":return ho=zu(ho,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Hc.set(s,zu(Hc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Gc.set(s,zu(Gc.get(s)||null,t,e,n,r,i)),!0}return!1}function Lx(t){var e=fa(t.target);if(e!==null){var n=Ka(e);if(n!==null){if(e=n.tag,e===13){if(e=Sx(n),e!==null){t.blockedOn=e,Mx(t.priority,function(){Dx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function uf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=q_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);F_=r,n.target.dispatchEvent(r),F_=null}else return e=zh(n),e!==null&&zy(e),t.blockedOn=n,!1;e.shift()}return!0}function nI(t,e,n){uf(t)&&n.delete(e)}function ID(){$_=!1,uo!==null&&uf(uo)&&(uo=null),co!==null&&uf(co)&&(co=null),ho!==null&&uf(ho)&&(ho=null),Hc.forEach(nI),Gc.forEach(nI)}function $u(t,e){t.blockedOn===e&&(t.blockedOn=null,$_||($_=!0,Wr.unstable_scheduleCallback(Wr.unstable_NormalPriority,ID)))}function Wc(t){function e(i){return $u(i,t)}if(0<Nd.length){$u(Nd[0],t);for(var n=1;n<Nd.length;n++){var r=Nd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(uo!==null&&$u(uo,t),co!==null&&$u(co,t),ho!==null&&$u(ho,t),Hc.forEach(e),Gc.forEach(e),n=0;n<Js.length;n++)r=Js[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Js.length&&(n=Js[0],n.blockedOn===null);)Lx(n),n.blockedOn===null&&Js.shift()}var jl=Vs.ReactCurrentBatchConfig,zf=!0;function TD(t,e,n,r){var i=bt,s=jl.transition;jl.transition=null;try{bt=1,$y(t,e,n,r)}finally{bt=i,jl.transition=s}}function SD(t,e,n,r){var i=bt,s=jl.transition;jl.transition=null;try{bt=4,$y(t,e,n,r)}finally{bt=i,jl.transition=s}}function $y(t,e,n,r){if(zf){var i=q_(t,e,n,r);if(i===null)Cm(t,e,r,$f,n),tI(t,r);else if(ED(i,t,e,n,r))r.stopPropagation();else if(tI(t,r),e&4&&-1<wD.indexOf(t)){for(;i!==null;){var s=zh(i);if(s!==null&&Nx(s),s=q_(t,e,n,r),s===null&&Cm(t,e,r,$f,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Cm(t,e,r,null,n)}}var $f=null;function q_(t,e,n,r){if($f=null,t=By(r),t=fa(t),t!==null)if(e=Ka(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Sx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $f=t,null}function Vx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hD()){case Uy:return 1;case bx:return 4;case Uf:case dD:return 16;case Px:return 536870912;default:return 16}default:return 16}}var ro=null,qy=null,cf=null;function Fx(){if(cf)return cf;var t,e=qy,n=e.length,r,i="value"in ro?ro.value:ro.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return cf=i.slice(t,1<r?1-r:void 0)}function hf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Dd(){return!0}function rI(){return!1}function Xr(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Dd:rI,this.isPropagationStopped=rI,this}return en(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Dd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Dd)},persist:function(){},isPersistent:Dd}),e}var Iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hy=Xr(Iu),jh=en({},Iu,{view:0,detail:0}),xD=Xr(jh),_m,vm,qu,zg=en({},jh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qu&&(qu&&t.type==="mousemove"?(_m=t.screenX-qu.screenX,vm=t.screenY-qu.screenY):vm=_m=0,qu=t),_m)},movementY:function(t){return"movementY"in t?t.movementY:vm}}),iI=Xr(zg),CD=en({},zg,{dataTransfer:0}),AD=Xr(CD),bD=en({},jh,{relatedTarget:0}),ym=Xr(bD),PD=en({},Iu,{animationName:0,elapsedTime:0,pseudoElement:0}),RD=Xr(PD),kD=en({},Iu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ND=Xr(kD),DD=en({},Iu,{data:0}),sI=Xr(DD),OD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=LD[t])?!!e[t]:!1}function Gy(){return VD}var FD=en({},jh,{key:function(t){if(t.key){var e=OD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?MD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gy,charCode:function(t){return t.type==="keypress"?hf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BD=Xr(FD),UD=en({},zg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oI=Xr(UD),jD=en({},jh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gy}),zD=Xr(jD),$D=en({},Iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),qD=Xr($D),HD=en({},zg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GD=Xr(HD),WD=[9,13,27,32],Wy=As&&"CompositionEvent"in window,Sc=null;As&&"documentMode"in document&&(Sc=document.documentMode);var KD=As&&"TextEvent"in window&&!Sc,Bx=As&&(!Wy||Sc&&8<Sc&&11>=Sc),aI=" ",lI=!1;function Ux(t,e){switch(t){case"keyup":return WD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Tl=!1;function QD(t,e){switch(t){case"compositionend":return jx(e);case"keypress":return e.which!==32?null:(lI=!0,aI);case"textInput":return t=e.data,t===aI&&lI?null:t;default:return null}}function YD(t,e){if(Tl)return t==="compositionend"||!Wy&&Ux(t,e)?(t=Fx(),cf=qy=ro=null,Tl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bx&&e.locale!=="ko"?null:e.data;default:return null}}var XD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XD[t.type]:e==="textarea"}function zx(t,e,n,r){yx(r),e=qf(e,"onChange"),0<e.length&&(n=new Hy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var xc=null,Kc=null;function JD(t){Zx(t,0)}function $g(t){var e=Cl(t);if(dx(e))return t}function ZD(t,e){if(t==="change")return e}var $x=!1;if(As){var wm;if(As){var Em="oninput"in document;if(!Em){var cI=document.createElement("div");cI.setAttribute("oninput","return;"),Em=typeof cI.oninput=="function"}wm=Em}else wm=!1;$x=wm&&(!document.documentMode||9<document.documentMode)}function hI(){xc&&(xc.detachEvent("onpropertychange",qx),Kc=xc=null)}function qx(t){if(t.propertyName==="value"&&$g(Kc)){var e=[];zx(e,Kc,t,By(t)),Tx(JD,e)}}function eO(t,e,n){t==="focusin"?(hI(),xc=e,Kc=n,xc.attachEvent("onpropertychange",qx)):t==="focusout"&&hI()}function tO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $g(Kc)}function nO(t,e){if(t==="click")return $g(e)}function rO(t,e){if(t==="input"||t==="change")return $g(e)}function iO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Pi=typeof Object.is=="function"?Object.is:iO;function Qc(t,e){if(Pi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!C_.call(e,i)||!Pi(t[i],e[i]))return!1}return!0}function dI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fI(t,e){var n=dI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dI(n)}}function Hx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Hx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Gx(){for(var t=window,e=Vf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vf(t.document)}return e}function Ky(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sO(t){var e=Gx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Hx(n.ownerDocument.documentElement,n)){if(r!==null&&Ky(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=fI(n,s);var a=fI(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oO=As&&"documentMode"in document&&11>=document.documentMode,Sl=null,H_=null,Cc=null,G_=!1;function gI(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;G_||Sl==null||Sl!==Vf(r)||(r=Sl,"selectionStart"in r&&Ky(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Cc&&Qc(Cc,r)||(Cc=r,r=qf(H_,"onSelect"),0<r.length&&(e=new Hy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Sl)))}function Od(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xl={animationend:Od("Animation","AnimationEnd"),animationiteration:Od("Animation","AnimationIteration"),animationstart:Od("Animation","AnimationStart"),transitionend:Od("Transition","TransitionEnd")},Im={},Wx={};As&&(Wx=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function qg(t){if(Im[t])return Im[t];if(!xl[t])return t;var e=xl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Wx)return Im[t]=e[n];return t}var Kx=qg("animationend"),Qx=qg("animationiteration"),Yx=qg("animationstart"),Xx=qg("transitionend"),Jx=new Map,pI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lo(t,e){Jx.set(t,e),Wa(e,[t])}for(var Tm=0;Tm<pI.length;Tm++){var Sm=pI[Tm],aO=Sm.toLowerCase(),lO=Sm[0].toUpperCase()+Sm.slice(1);Lo(aO,"on"+lO)}Lo(Kx,"onAnimationEnd");Lo(Qx,"onAnimationIteration");Lo(Yx,"onAnimationStart");Lo("dblclick","onDoubleClick");Lo("focusin","onFocus");Lo("focusout","onBlur");Lo(Xx,"onTransitionEnd");Jl("onMouseEnter",["mouseout","mouseover"]);Jl("onMouseLeave",["mouseout","mouseover"]);Jl("onPointerEnter",["pointerout","pointerover"]);Jl("onPointerLeave",["pointerout","pointerover"]);Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uO=new Set("cancel close invalid load scroll toggle".split(" ").concat(hc));function mI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,aD(r,e,void 0,t),t.currentTarget=null}function Zx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var u=r[a],h=u.instance,g=u.currentTarget;if(u=u.listener,h!==s&&i.isPropagationStopped())break e;mI(i,u,g),s=h}else for(a=0;a<r.length;a++){if(u=r[a],h=u.instance,g=u.currentTarget,u=u.listener,h!==s&&i.isPropagationStopped())break e;mI(i,u,g),s=h}}}if(Bf)throw t=j_,Bf=!1,j_=null,t}function Bt(t,e){var n=e[X_];n===void 0&&(n=e[X_]=new Set);var r=t+"__bubble";n.has(r)||(eC(e,t,2,!1),n.add(r))}function xm(t,e,n){var r=0;e&&(r|=4),eC(n,t,r,e)}var Md="_reactListening"+Math.random().toString(36).slice(2);function Yc(t){if(!t[Md]){t[Md]=!0,ax.forEach(function(n){n!=="selectionchange"&&(uO.has(n)||xm(n,!1,t),xm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Md]||(e[Md]=!0,xm("selectionchange",!1,e))}}function eC(t,e,n,r){switch(Vx(e)){case 1:var i=TD;break;case 4:i=SD;break;default:i=$y}n=i.bind(null,e,n,t),i=void 0,!U_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Cm(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;a=a.return}for(;u!==null;){if(a=fa(u),a===null)return;if(h=a.tag,h===5||h===6){r=s=a;continue e}u=u.parentNode}}r=r.return}Tx(function(){var g=s,m=By(n),w=[];e:{var T=Jx.get(t);if(T!==void 0){var I=Hy,j=t;switch(t){case"keypress":if(hf(n)===0)break e;case"keydown":case"keyup":I=BD;break;case"focusin":j="focus",I=ym;break;case"focusout":j="blur",I=ym;break;case"beforeblur":case"afterblur":I=ym;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=iI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=AD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=zD;break;case Kx:case Qx:case Yx:I=RD;break;case Xx:I=qD;break;case"scroll":I=xD;break;case"wheel":I=GD;break;case"copy":case"cut":case"paste":I=ND;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=oI}var z=(e&4)!==0,X=!z&&t==="scroll",V=z?T!==null?T+"Capture":null:T;z=[];for(var B=g,U;B!==null;){U=B;var J=U.stateNode;if(U.tag===5&&J!==null&&(U=J,V!==null&&(J=qc(B,V),J!=null&&z.push(Xc(B,J,U)))),X)break;B=B.return}0<z.length&&(T=new I(T,j,null,n,m),w.push({event:T,listeners:z}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",T&&n!==F_&&(j=n.relatedTarget||n.fromElement)&&(fa(j)||j[bs]))break e;if((I||T)&&(T=m.window===m?m:(T=m.ownerDocument)?T.defaultView||T.parentWindow:window,I?(j=n.relatedTarget||n.toElement,I=g,j=j?fa(j):null,j!==null&&(X=Ka(j),j!==X||j.tag!==5&&j.tag!==6)&&(j=null)):(I=null,j=g),I!==j)){if(z=iI,J="onMouseLeave",V="onMouseEnter",B="mouse",(t==="pointerout"||t==="pointerover")&&(z=oI,J="onPointerLeave",V="onPointerEnter",B="pointer"),X=I==null?T:Cl(I),U=j==null?T:Cl(j),T=new z(J,B+"leave",I,n,m),T.target=X,T.relatedTarget=U,J=null,fa(m)===g&&(z=new z(V,B+"enter",j,n,m),z.target=U,z.relatedTarget=X,J=z),X=J,I&&j)t:{for(z=I,V=j,B=0,U=z;U;U=sl(U))B++;for(U=0,J=V;J;J=sl(J))U++;for(;0<B-U;)z=sl(z),B--;for(;0<U-B;)V=sl(V),U--;for(;B--;){if(z===V||V!==null&&z===V.alternate)break t;z=sl(z),V=sl(V)}z=null}else z=null;I!==null&&_I(w,T,I,z,!1),j!==null&&X!==null&&_I(w,X,j,z,!0)}}e:{if(T=g?Cl(g):window,I=T.nodeName&&T.nodeName.toLowerCase(),I==="select"||I==="input"&&T.type==="file")var re=ZD;else if(uI(T))if($x)re=rO;else{re=tO;var te=eO}else(I=T.nodeName)&&I.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(re=nO);if(re&&(re=re(t,g))){zx(w,re,n,m);break e}te&&te(t,T,g),t==="focusout"&&(te=T._wrapperState)&&te.controlled&&T.type==="number"&&D_(T,"number",T.value)}switch(te=g?Cl(g):window,t){case"focusin":(uI(te)||te.contentEditable==="true")&&(Sl=te,H_=g,Cc=null);break;case"focusout":Cc=H_=Sl=null;break;case"mousedown":G_=!0;break;case"contextmenu":case"mouseup":case"dragend":G_=!1,gI(w,n,m);break;case"selectionchange":if(oO)break;case"keydown":case"keyup":gI(w,n,m)}var ae;if(Wy)e:{switch(t){case"compositionstart":var ne="onCompositionStart";break e;case"compositionend":ne="onCompositionEnd";break e;case"compositionupdate":ne="onCompositionUpdate";break e}ne=void 0}else Tl?Ux(t,n)&&(ne="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ne="onCompositionStart");ne&&(Bx&&n.locale!=="ko"&&(Tl||ne!=="onCompositionStart"?ne==="onCompositionEnd"&&Tl&&(ae=Fx()):(ro=m,qy="value"in ro?ro.value:ro.textContent,Tl=!0)),te=qf(g,ne),0<te.length&&(ne=new sI(ne,t,null,n,m),w.push({event:ne,listeners:te}),ae?ne.data=ae:(ae=jx(n),ae!==null&&(ne.data=ae)))),(ae=KD?QD(t,n):YD(t,n))&&(g=qf(g,"onBeforeInput"),0<g.length&&(m=new sI("onBeforeInput","beforeinput",null,n,m),w.push({event:m,listeners:g}),m.data=ae))}Zx(w,e)})}function Xc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=qc(t,n),s!=null&&r.unshift(Xc(t,s,i)),s=qc(t,e),s!=null&&r.push(Xc(t,s,i))),t=t.return}return r}function sl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _I(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var u=n,h=u.alternate,g=u.stateNode;if(h!==null&&h===r)break;u.tag===5&&g!==null&&(u=g,i?(h=qc(n,s),h!=null&&a.unshift(Xc(n,h,u))):i||(h=qc(n,s),h!=null&&a.push(Xc(n,h,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var cO=/\r\n?/g,hO=/\u0000|\uFFFD/g;function vI(t){return(typeof t=="string"?t:""+t).replace(cO,`
`).replace(hO,"")}function Ld(t,e,n){if(e=vI(e),vI(t)!==e&&n)throw Error(ye(425))}function Hf(){}var W_=null,K_=null;function Q_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Y_=typeof setTimeout=="function"?setTimeout:void 0,dO=typeof clearTimeout=="function"?clearTimeout:void 0,yI=typeof Promise=="function"?Promise:void 0,fO=typeof queueMicrotask=="function"?queueMicrotask:typeof yI<"u"?function(t){return yI.resolve(null).then(t).catch(gO)}:Y_;function gO(t){setTimeout(function(){throw t})}function Am(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Wc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Wc(e)}function fo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function wI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Tu=Math.random().toString(36).slice(2),Ui="__reactFiber$"+Tu,Jc="__reactProps$"+Tu,bs="__reactContainer$"+Tu,X_="__reactEvents$"+Tu,pO="__reactListeners$"+Tu,mO="__reactHandles$"+Tu;function fa(t){var e=t[Ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[bs]||n[Ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=wI(t);t!==null;){if(n=t[Ui])return n;t=wI(t)}return e}t=n,n=t.parentNode}return null}function zh(t){return t=t[Ui]||t[bs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Cl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function Hg(t){return t[Jc]||null}var J_=[],Al=-1;function Vo(t){return{current:t}}function qt(t){0>Al||(t.current=J_[Al],J_[Al]=null,Al--)}function Lt(t,e){Al++,J_[Al]=t.current,t.current=e}var Io={},sr=Vo(Io),Mr=Vo(!1),ba=Io;function Zl(t,e){var n=t.type.contextTypes;if(!n)return Io;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Lr(t){return t=t.childContextTypes,t!=null}function Gf(){qt(Mr),qt(sr)}function EI(t,e,n){if(sr.current!==Io)throw Error(ye(168));Lt(sr,e),Lt(Mr,n)}function tC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ye(108,eD(t)||"Unknown",i));return en({},n,r)}function Wf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Io,ba=sr.current,Lt(sr,t),Lt(Mr,Mr.current),!0}function II(t,e,n){var r=t.stateNode;if(!r)throw Error(ye(169));n?(t=tC(t,e,ba),r.__reactInternalMemoizedMergedChildContext=t,qt(Mr),qt(sr),Lt(sr,t)):qt(Mr),Lt(Mr,n)}var ps=null,Gg=!1,bm=!1;function nC(t){ps===null?ps=[t]:ps.push(t)}function _O(t){Gg=!0,nC(t)}function Fo(){if(!bm&&ps!==null){bm=!0;var t=0,e=bt;try{var n=ps;for(bt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ps=null,Gg=!1}catch(i){throw ps!==null&&(ps=ps.slice(t+1)),Ax(Uy,Fo),i}finally{bt=e,bm=!1}}return null}var bl=[],Pl=0,Kf=null,Qf=0,ri=[],ii=0,Pa=null,vs=1,ys="";function na(t,e){bl[Pl++]=Qf,bl[Pl++]=Kf,Kf=t,Qf=e}function rC(t,e,n){ri[ii++]=vs,ri[ii++]=ys,ri[ii++]=Pa,Pa=t;var r=vs;t=ys;var i=32-Ci(r)-1;r&=~(1<<i),n+=1;var s=32-Ci(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,vs=1<<32-Ci(e)+i|n<<i|r,ys=s+t}else vs=1<<s|n<<i|r,ys=t}function Qy(t){t.return!==null&&(na(t,1),rC(t,1,0))}function Yy(t){for(;t===Kf;)Kf=bl[--Pl],bl[Pl]=null,Qf=bl[--Pl],bl[Pl]=null;for(;t===Pa;)Pa=ri[--ii],ri[ii]=null,ys=ri[--ii],ri[ii]=null,vs=ri[--ii],ri[ii]=null}var Hr=null,$r=null,Wt=!1,Ei=null;function iC(t,e){var n=oi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function TI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Hr=t,$r=fo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Hr=t,$r=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Pa!==null?{id:vs,overflow:ys}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=oi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Hr=t,$r=null,!0):!1;default:return!1}}function Z_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ev(t){if(Wt){var e=$r;if(e){var n=e;if(!TI(t,e)){if(Z_(t))throw Error(ye(418));e=fo(n.nextSibling);var r=Hr;e&&TI(t,e)?iC(r,n):(t.flags=t.flags&-4097|2,Wt=!1,Hr=t)}}else{if(Z_(t))throw Error(ye(418));t.flags=t.flags&-4097|2,Wt=!1,Hr=t}}}function SI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Hr=t}function Vd(t){if(t!==Hr)return!1;if(!Wt)return SI(t),Wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Q_(t.type,t.memoizedProps)),e&&(e=$r)){if(Z_(t))throw sC(),Error(ye(418));for(;e;)iC(t,e),e=fo(e.nextSibling)}if(SI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$r=fo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$r=null}}else $r=Hr?fo(t.stateNode.nextSibling):null;return!0}function sC(){for(var t=$r;t;)t=fo(t.nextSibling)}function eu(){$r=Hr=null,Wt=!1}function Xy(t){Ei===null?Ei=[t]:Ei.push(t)}var vO=Vs.ReactCurrentBatchConfig;function yi(t,e){if(t&&t.defaultProps){e=en({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Yf=Vo(null),Xf=null,Rl=null,Jy=null;function Zy(){Jy=Rl=Xf=null}function e0(t){var e=Yf.current;qt(Yf),t._currentValue=e}function tv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function zl(t,e){Xf=t,Jy=Rl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pr=!0),t.firstContext=null)}function ui(t){var e=t._currentValue;if(Jy!==t)if(t={context:t,memoizedValue:e,next:null},Rl===null){if(Xf===null)throw Error(ye(308));Rl=t,Xf.dependencies={lanes:0,firstContext:t}}else Rl=Rl.next=t;return e}var ga=null;function t0(t){ga===null?ga=[t]:ga.push(t)}function oC(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,t0(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ps(t,r)}function Ps(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xs=!1;function n0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ss(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function go(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,wt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ps(t,n)}return i=r.interleaved,i===null?(e.next=e,t0(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ps(t,n)}function df(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,jy(t,n)}}function xI(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Jf(t,e,n,r){var i=t.updateQueue;Xs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var h=u,g=h.next;h.next=null,a===null?s=g:a.next=g,a=h;var m=t.alternate;m!==null&&(m=m.updateQueue,u=m.lastBaseUpdate,u!==a&&(u===null?m.firstBaseUpdate=g:u.next=g,m.lastBaseUpdate=h))}if(s!==null){var w=i.baseState;a=0,m=g=h=null,u=s;do{var T=u.lane,I=u.eventTime;if((r&T)===T){m!==null&&(m=m.next={eventTime:I,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var j=t,z=u;switch(T=e,I=n,z.tag){case 1:if(j=z.payload,typeof j=="function"){w=j.call(I,w,T);break e}w=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=z.payload,T=typeof j=="function"?j.call(I,w,T):j,T==null)break e;w=en({},w,T);break e;case 2:Xs=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,T=i.effects,T===null?i.effects=[u]:T.push(u))}else I={eventTime:I,lane:T,tag:u.tag,payload:u.payload,callback:u.callback,next:null},m===null?(g=m=I,h=w):m=m.next=I,a|=T;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;T=u,u=T.next,T.next=null,i.lastBaseUpdate=T,i.shared.pending=null}}while(!0);if(m===null&&(h=w),i.baseState=h,i.firstBaseUpdate=g,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ka|=a,t.lanes=a,t.memoizedState=w}}function CI(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ye(191,i));i.call(r)}}}var lC=new ox.Component().refs;function nv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:en({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Wg={isMounted:function(t){return(t=t._reactInternals)?Ka(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=pr(),i=mo(t),s=Ss(r,i);s.payload=e,n!=null&&(s.callback=n),e=go(t,s,i),e!==null&&(Ai(e,t,i,r),df(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=pr(),i=mo(t),s=Ss(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=go(t,s,i),e!==null&&(Ai(e,t,i,r),df(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=pr(),r=mo(t),i=Ss(n,r);i.tag=2,e!=null&&(i.callback=e),e=go(t,i,r),e!==null&&(Ai(e,t,r,n),df(e,t,r))}};function AI(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Qc(n,r)||!Qc(i,s):!0}function uC(t,e,n){var r=!1,i=Io,s=e.contextType;return typeof s=="object"&&s!==null?s=ui(s):(i=Lr(e)?ba:sr.current,r=e.contextTypes,s=(r=r!=null)?Zl(t,i):Io),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Wg,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function bI(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Wg.enqueueReplaceState(e,e.state,null)}function rv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=lC,n0(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ui(s):(s=Lr(e)?ba:sr.current,i.context=Zl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(nv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Wg.enqueueReplaceState(i,i.state,null),Jf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var r=n.stateNode}if(!r)throw Error(ye(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var u=i.refs;u===lC&&(u=i.refs={}),a===null?delete u[s]:u[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,t))}return t}function Fd(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function PI(t){var e=t._init;return e(t._payload)}function cC(t){function e(V,B){if(t){var U=V.deletions;U===null?(V.deletions=[B],V.flags|=16):U.push(B)}}function n(V,B){if(!t)return null;for(;B!==null;)e(V,B),B=B.sibling;return null}function r(V,B){for(V=new Map;B!==null;)B.key!==null?V.set(B.key,B):V.set(B.index,B),B=B.sibling;return V}function i(V,B){return V=_o(V,B),V.index=0,V.sibling=null,V}function s(V,B,U){return V.index=U,t?(U=V.alternate,U!==null?(U=U.index,U<B?(V.flags|=2,B):U):(V.flags|=2,B)):(V.flags|=1048576,B)}function a(V){return t&&V.alternate===null&&(V.flags|=2),V}function u(V,B,U,J){return B===null||B.tag!==6?(B=Mm(U,V.mode,J),B.return=V,B):(B=i(B,U),B.return=V,B)}function h(V,B,U,J){var re=U.type;return re===Il?m(V,B,U.props.children,J,U.key):B!==null&&(B.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===Ys&&PI(re)===B.type)?(J=i(B,U.props),J.ref=Hu(V,B,U),J.return=V,J):(J=vf(U.type,U.key,U.props,null,V.mode,J),J.ref=Hu(V,B,U),J.return=V,J)}function g(V,B,U,J){return B===null||B.tag!==4||B.stateNode.containerInfo!==U.containerInfo||B.stateNode.implementation!==U.implementation?(B=Lm(U,V.mode,J),B.return=V,B):(B=i(B,U.children||[]),B.return=V,B)}function m(V,B,U,J,re){return B===null||B.tag!==7?(B=Ta(U,V.mode,J,re),B.return=V,B):(B=i(B,U),B.return=V,B)}function w(V,B,U){if(typeof B=="string"&&B!==""||typeof B=="number")return B=Mm(""+B,V.mode,U),B.return=V,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Ad:return U=vf(B.type,B.key,B.props,null,V.mode,U),U.ref=Hu(V,null,B),U.return=V,U;case El:return B=Lm(B,V.mode,U),B.return=V,B;case Ys:var J=B._init;return w(V,J(B._payload),U)}if(uc(B)||Uu(B))return B=Ta(B,V.mode,U,null),B.return=V,B;Fd(V,B)}return null}function T(V,B,U,J){var re=B!==null?B.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return re!==null?null:u(V,B,""+U,J);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Ad:return U.key===re?h(V,B,U,J):null;case El:return U.key===re?g(V,B,U,J):null;case Ys:return re=U._init,T(V,B,re(U._payload),J)}if(uc(U)||Uu(U))return re!==null?null:m(V,B,U,J,null);Fd(V,U)}return null}function I(V,B,U,J,re){if(typeof J=="string"&&J!==""||typeof J=="number")return V=V.get(U)||null,u(B,V,""+J,re);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case Ad:return V=V.get(J.key===null?U:J.key)||null,h(B,V,J,re);case El:return V=V.get(J.key===null?U:J.key)||null,g(B,V,J,re);case Ys:var te=J._init;return I(V,B,U,te(J._payload),re)}if(uc(J)||Uu(J))return V=V.get(U)||null,m(B,V,J,re,null);Fd(B,J)}return null}function j(V,B,U,J){for(var re=null,te=null,ae=B,ne=B=0,me=null;ae!==null&&ne<U.length;ne++){ae.index>ne?(me=ae,ae=null):me=ae.sibling;var pe=T(V,ae,U[ne],J);if(pe===null){ae===null&&(ae=me);break}t&&ae&&pe.alternate===null&&e(V,ae),B=s(pe,B,ne),te===null?re=pe:te.sibling=pe,te=pe,ae=me}if(ne===U.length)return n(V,ae),Wt&&na(V,ne),re;if(ae===null){for(;ne<U.length;ne++)ae=w(V,U[ne],J),ae!==null&&(B=s(ae,B,ne),te===null?re=ae:te.sibling=ae,te=ae);return Wt&&na(V,ne),re}for(ae=r(V,ae);ne<U.length;ne++)me=I(ae,V,ne,U[ne],J),me!==null&&(t&&me.alternate!==null&&ae.delete(me.key===null?ne:me.key),B=s(me,B,ne),te===null?re=me:te.sibling=me,te=me);return t&&ae.forEach(function(rt){return e(V,rt)}),Wt&&na(V,ne),re}function z(V,B,U,J){var re=Uu(U);if(typeof re!="function")throw Error(ye(150));if(U=re.call(U),U==null)throw Error(ye(151));for(var te=re=null,ae=B,ne=B=0,me=null,pe=U.next();ae!==null&&!pe.done;ne++,pe=U.next()){ae.index>ne?(me=ae,ae=null):me=ae.sibling;var rt=T(V,ae,pe.value,J);if(rt===null){ae===null&&(ae=me);break}t&&ae&&rt.alternate===null&&e(V,ae),B=s(rt,B,ne),te===null?re=rt:te.sibling=rt,te=rt,ae=me}if(pe.done)return n(V,ae),Wt&&na(V,ne),re;if(ae===null){for(;!pe.done;ne++,pe=U.next())pe=w(V,pe.value,J),pe!==null&&(B=s(pe,B,ne),te===null?re=pe:te.sibling=pe,te=pe);return Wt&&na(V,ne),re}for(ae=r(V,ae);!pe.done;ne++,pe=U.next())pe=I(ae,V,ne,pe.value,J),pe!==null&&(t&&pe.alternate!==null&&ae.delete(pe.key===null?ne:pe.key),B=s(pe,B,ne),te===null?re=pe:te.sibling=pe,te=pe);return t&&ae.forEach(function(Ve){return e(V,Ve)}),Wt&&na(V,ne),re}function X(V,B,U,J){if(typeof U=="object"&&U!==null&&U.type===Il&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case Ad:e:{for(var re=U.key,te=B;te!==null;){if(te.key===re){if(re=U.type,re===Il){if(te.tag===7){n(V,te.sibling),B=i(te,U.props.children),B.return=V,V=B;break e}}else if(te.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===Ys&&PI(re)===te.type){n(V,te.sibling),B=i(te,U.props),B.ref=Hu(V,te,U),B.return=V,V=B;break e}n(V,te);break}else e(V,te);te=te.sibling}U.type===Il?(B=Ta(U.props.children,V.mode,J,U.key),B.return=V,V=B):(J=vf(U.type,U.key,U.props,null,V.mode,J),J.ref=Hu(V,B,U),J.return=V,V=J)}return a(V);case El:e:{for(te=U.key;B!==null;){if(B.key===te)if(B.tag===4&&B.stateNode.containerInfo===U.containerInfo&&B.stateNode.implementation===U.implementation){n(V,B.sibling),B=i(B,U.children||[]),B.return=V,V=B;break e}else{n(V,B);break}else e(V,B);B=B.sibling}B=Lm(U,V.mode,J),B.return=V,V=B}return a(V);case Ys:return te=U._init,X(V,B,te(U._payload),J)}if(uc(U))return j(V,B,U,J);if(Uu(U))return z(V,B,U,J);Fd(V,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,B!==null&&B.tag===6?(n(V,B.sibling),B=i(B,U),B.return=V,V=B):(n(V,B),B=Mm(U,V.mode,J),B.return=V,V=B),a(V)):n(V,B)}return X}var tu=cC(!0),hC=cC(!1),$h={},Zi=Vo($h),Zc=Vo($h),eh=Vo($h);function pa(t){if(t===$h)throw Error(ye(174));return t}function r0(t,e){switch(Lt(eh,e),Lt(Zc,t),Lt(Zi,$h),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:M_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=M_(e,t)}qt(Zi),Lt(Zi,e)}function nu(){qt(Zi),qt(Zc),qt(eh)}function dC(t){pa(eh.current);var e=pa(Zi.current),n=M_(e,t.type);e!==n&&(Lt(Zc,t),Lt(Zi,n))}function i0(t){Zc.current===t&&(qt(Zi),qt(Zc))}var Xt=Vo(0);function Zf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pm=[];function s0(){for(var t=0;t<Pm.length;t++)Pm[t]._workInProgressVersionPrimary=null;Pm.length=0}var ff=Vs.ReactCurrentDispatcher,Rm=Vs.ReactCurrentBatchConfig,Ra=0,Jt=null,In=null,Rn=null,eg=!1,Ac=!1,th=0,yO=0;function Zn(){throw Error(ye(321))}function o0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Pi(t[n],e[n]))return!1;return!0}function a0(t,e,n,r,i,s){if(Ra=s,Jt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ff.current=t===null||t.memoizedState===null?TO:SO,t=n(r,i),Ac){s=0;do{if(Ac=!1,th=0,25<=s)throw Error(ye(301));s+=1,Rn=In=null,e.updateQueue=null,ff.current=xO,t=n(r,i)}while(Ac)}if(ff.current=tg,e=In!==null&&In.next!==null,Ra=0,Rn=In=Jt=null,eg=!1,e)throw Error(ye(300));return t}function l0(){var t=th!==0;return th=0,t}function Li(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?Jt.memoizedState=Rn=t:Rn=Rn.next=t,Rn}function ci(){if(In===null){var t=Jt.alternate;t=t!==null?t.memoizedState:null}else t=In.next;var e=Rn===null?Jt.memoizedState:Rn.next;if(e!==null)Rn=e,In=t;else{if(t===null)throw Error(ye(310));In=t,t={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},Rn===null?Jt.memoizedState=Rn=t:Rn=Rn.next=t}return Rn}function nh(t,e){return typeof e=="function"?e(t):e}function km(t){var e=ci(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=In,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=a=null,h=null,g=s;do{var m=g.lane;if((Ra&m)===m)h!==null&&(h=h.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),r=g.hasEagerState?g.eagerState:t(r,g.action);else{var w={lane:m,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};h===null?(u=h=w,a=r):h=h.next=w,Jt.lanes|=m,ka|=m}g=g.next}while(g!==null&&g!==s);h===null?a=r:h.next=u,Pi(r,e.memoizedState)||(Pr=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=h,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Jt.lanes|=s,ka|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Nm(t){var e=ci(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Pi(s,e.memoizedState)||(Pr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function fC(){}function gC(t,e){var n=Jt,r=ci(),i=e(),s=!Pi(r.memoizedState,i);if(s&&(r.memoizedState=i,Pr=!0),r=r.queue,u0(_C.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Rn!==null&&Rn.memoizedState.tag&1){if(n.flags|=2048,rh(9,mC.bind(null,n,r,i,e),void 0,null),Nn===null)throw Error(ye(349));Ra&30||pC(n,e,i)}return i}function pC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Jt.updateQueue,e===null?(e={lastEffect:null,stores:null},Jt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function mC(t,e,n,r){e.value=n,e.getSnapshot=r,vC(e)&&yC(t)}function _C(t,e,n){return n(function(){vC(e)&&yC(t)})}function vC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Pi(t,n)}catch{return!0}}function yC(t){var e=Ps(t,1);e!==null&&Ai(e,t,1,-1)}function RI(t){var e=Li();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:t},e.queue=t,t=t.dispatch=IO.bind(null,Jt,t),[e.memoizedState,t]}function rh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Jt.updateQueue,e===null?(e={lastEffect:null,stores:null},Jt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function wC(){return ci().memoizedState}function gf(t,e,n,r){var i=Li();Jt.flags|=t,i.memoizedState=rh(1|e,n,void 0,r===void 0?null:r)}function Kg(t,e,n,r){var i=ci();r=r===void 0?null:r;var s=void 0;if(In!==null){var a=In.memoizedState;if(s=a.destroy,r!==null&&o0(r,a.deps)){i.memoizedState=rh(e,n,s,r);return}}Jt.flags|=t,i.memoizedState=rh(1|e,n,s,r)}function kI(t,e){return gf(8390656,8,t,e)}function u0(t,e){return Kg(2048,8,t,e)}function EC(t,e){return Kg(4,2,t,e)}function IC(t,e){return Kg(4,4,t,e)}function TC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function SC(t,e,n){return n=n!=null?n.concat([t]):null,Kg(4,4,TC.bind(null,e,t),n)}function c0(){}function xC(t,e){var n=ci();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&o0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function CC(t,e){var n=ci();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&o0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function AC(t,e,n){return Ra&21?(Pi(n,e)||(n=Rx(),Jt.lanes|=n,ka|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pr=!0),t.memoizedState=n)}function wO(t,e){var n=bt;bt=n!==0&&4>n?n:4,t(!0);var r=Rm.transition;Rm.transition={};try{t(!1),e()}finally{bt=n,Rm.transition=r}}function bC(){return ci().memoizedState}function EO(t,e,n){var r=mo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},PC(t))RC(e,n);else if(n=oC(t,e,n,r),n!==null){var i=pr();Ai(n,t,r,i),kC(n,e,r)}}function IO(t,e,n){var r=mo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(PC(t))RC(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,u=s(a,n);if(i.hasEagerState=!0,i.eagerState=u,Pi(u,a)){var h=e.interleaved;h===null?(i.next=i,t0(e)):(i.next=h.next,h.next=i),e.interleaved=i;return}}catch{}finally{}n=oC(t,e,i,r),n!==null&&(i=pr(),Ai(n,t,r,i),kC(n,e,r))}}function PC(t){var e=t.alternate;return t===Jt||e!==null&&e===Jt}function RC(t,e){Ac=eg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function kC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,jy(t,n)}}var tg={readContext:ui,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useInsertionEffect:Zn,useLayoutEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useMutableSource:Zn,useSyncExternalStore:Zn,useId:Zn,unstable_isNewReconciler:!1},TO={readContext:ui,useCallback:function(t,e){return Li().memoizedState=[t,e===void 0?null:e],t},useContext:ui,useEffect:kI,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gf(4194308,4,TC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gf(4194308,4,t,e)},useInsertionEffect:function(t,e){return gf(4,2,t,e)},useMemo:function(t,e){var n=Li();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Li();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=EO.bind(null,Jt,t),[r.memoizedState,t]},useRef:function(t){var e=Li();return t={current:t},e.memoizedState=t},useState:RI,useDebugValue:c0,useDeferredValue:function(t){return Li().memoizedState=t},useTransition:function(){var t=RI(!1),e=t[0];return t=wO.bind(null,t[1]),Li().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Jt,i=Li();if(Wt){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=e(),Nn===null)throw Error(ye(349));Ra&30||pC(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,kI(_C.bind(null,r,s,t),[t]),r.flags|=2048,rh(9,mC.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Li(),e=Nn.identifierPrefix;if(Wt){var n=ys,r=vs;n=(r&~(1<<32-Ci(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=th++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},SO={readContext:ui,useCallback:xC,useContext:ui,useEffect:u0,useImperativeHandle:SC,useInsertionEffect:EC,useLayoutEffect:IC,useMemo:CC,useReducer:km,useRef:wC,useState:function(){return km(nh)},useDebugValue:c0,useDeferredValue:function(t){var e=ci();return AC(e,In.memoizedState,t)},useTransition:function(){var t=km(nh)[0],e=ci().memoizedState;return[t,e]},useMutableSource:fC,useSyncExternalStore:gC,useId:bC,unstable_isNewReconciler:!1},xO={readContext:ui,useCallback:xC,useContext:ui,useEffect:u0,useImperativeHandle:SC,useInsertionEffect:EC,useLayoutEffect:IC,useMemo:CC,useReducer:Nm,useRef:wC,useState:function(){return Nm(nh)},useDebugValue:c0,useDeferredValue:function(t){var e=ci();return In===null?e.memoizedState=t:AC(e,In.memoizedState,t)},useTransition:function(){var t=Nm(nh)[0],e=ci().memoizedState;return[t,e]},useMutableSource:fC,useSyncExternalStore:gC,useId:bC,unstable_isNewReconciler:!1};function ru(t,e){try{var n="",r=e;do n+=ZN(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Dm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function iv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var CO=typeof WeakMap=="function"?WeakMap:Map;function NC(t,e,n){n=Ss(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){rg||(rg=!0,gv=r),iv(t,e)},n}function DC(t,e,n){n=Ss(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){iv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){iv(t,e),typeof r!="function"&&(po===null?po=new Set([this]):po.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function NI(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new CO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=UO.bind(null,t,e,n),e.then(t,t))}function DI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function OI(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ss(-1,1),e.tag=2,go(n,e,1))),n.lanes|=1),t)}var AO=Vs.ReactCurrentOwner,Pr=!1;function ur(t,e,n,r){e.child=t===null?hC(e,null,n,r):tu(e,t.child,n,r)}function MI(t,e,n,r,i){n=n.render;var s=e.ref;return zl(e,i),r=a0(t,e,n,r,s,i),n=l0(),t!==null&&!Pr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Rs(t,e,i)):(Wt&&n&&Qy(e),e.flags|=1,ur(t,e,r,i),e.child)}function LI(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!v0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,OC(t,e,s,r,i)):(t=vf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Qc,n(a,r)&&t.ref===e.ref)return Rs(t,e,i)}return e.flags|=1,t=_o(s,r),t.ref=e.ref,t.return=e,e.child=t}function OC(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Qc(s,r)&&t.ref===e.ref)if(Pr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Pr=!0);else return e.lanes=t.lanes,Rs(t,e,i)}return sv(t,e,n,r,i)}function MC(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(Nl,Br),Br|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Lt(Nl,Br),Br|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Lt(Nl,Br),Br|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Lt(Nl,Br),Br|=r;return ur(t,e,i,n),e.child}function LC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function sv(t,e,n,r,i){var s=Lr(n)?ba:sr.current;return s=Zl(e,s),zl(e,i),n=a0(t,e,n,r,s,i),r=l0(),t!==null&&!Pr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Rs(t,e,i)):(Wt&&r&&Qy(e),e.flags|=1,ur(t,e,n,i),e.child)}function VI(t,e,n,r,i){if(Lr(n)){var s=!0;Wf(e)}else s=!1;if(zl(e,i),e.stateNode===null)pf(t,e),uC(e,n,r),rv(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var h=a.context,g=n.contextType;typeof g=="object"&&g!==null?g=ui(g):(g=Lr(n)?ba:sr.current,g=Zl(e,g));var m=n.getDerivedStateFromProps,w=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||h!==g)&&bI(e,a,r,g),Xs=!1;var T=e.memoizedState;a.state=T,Jf(e,r,a,i),h=e.memoizedState,u!==r||T!==h||Mr.current||Xs?(typeof m=="function"&&(nv(e,n,m,r),h=e.memoizedState),(u=Xs||AI(e,n,u,r,T,h,g))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=g,r=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,aC(t,e),u=e.memoizedProps,g=e.type===e.elementType?u:yi(e.type,u),a.props=g,w=e.pendingProps,T=a.context,h=n.contextType,typeof h=="object"&&h!==null?h=ui(h):(h=Lr(n)?ba:sr.current,h=Zl(e,h));var I=n.getDerivedStateFromProps;(m=typeof I=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==w||T!==h)&&bI(e,a,r,h),Xs=!1,T=e.memoizedState,a.state=T,Jf(e,r,a,i);var j=e.memoizedState;u!==w||T!==j||Mr.current||Xs?(typeof I=="function"&&(nv(e,n,I,r),j=e.memoizedState),(g=Xs||AI(e,n,g,r,T,j,h)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,j,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,j,h)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=j),a.props=r,a.state=j,a.context=h,r=g):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),r=!1)}return ov(t,e,n,r,s,i)}function ov(t,e,n,r,i,s){LC(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&II(e,n,!1),Rs(t,e,s);r=e.stateNode,AO.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=tu(e,t.child,null,s),e.child=tu(e,null,u,s)):ur(t,e,u,s),e.memoizedState=r.state,i&&II(e,n,!0),e.child}function VC(t){var e=t.stateNode;e.pendingContext?EI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&EI(t,e.context,!1),r0(t,e.containerInfo)}function FI(t,e,n,r,i){return eu(),Xy(i),e.flags|=256,ur(t,e,n,r),e.child}var av={dehydrated:null,treeContext:null,retryLane:0};function lv(t){return{baseLanes:t,cachePool:null,transitions:null}}function FC(t,e,n){var r=e.pendingProps,i=Xt.current,s=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Lt(Xt,i&1),t===null)return ev(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Xg(a,r,0,null),t=Ta(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=lv(n),e.memoizedState=av,t):h0(e,a));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return bO(t,e,a,r,u,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,u=i.sibling;var h={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=_o(i,h),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=_o(u,s):(s=Ta(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?lv(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=av,r}return s=t.child,t=s.sibling,r=_o(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function h0(t,e){return e=Xg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Bd(t,e,n,r){return r!==null&&Xy(r),tu(e,t.child,null,n),t=h0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bO(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Dm(Error(ye(422))),Bd(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Xg({mode:"visible",children:r.children},i,0,null),s=Ta(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&tu(e,t.child,null,a),e.child.memoizedState=lv(a),e.memoizedState=av,s);if(!(e.mode&1))return Bd(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(ye(419)),r=Dm(s,r,void 0),Bd(t,e,a,r)}if(u=(a&t.childLanes)!==0,Pr||u){if(r=Nn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ps(t,i),Ai(r,t,i,-1))}return _0(),r=Dm(Error(ye(421))),Bd(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jO.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,$r=fo(i.nextSibling),Hr=e,Wt=!0,Ei=null,t!==null&&(ri[ii++]=vs,ri[ii++]=ys,ri[ii++]=Pa,vs=t.id,ys=t.overflow,Pa=e),e=h0(e,r.children),e.flags|=4096,e)}function BI(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),tv(t.return,e,n)}function Om(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function BC(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ur(t,e,r.children,n),r=Xt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&BI(t,n,e);else if(t.tag===19)BI(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Lt(Xt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Zf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Om(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Zf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Om(e,!0,n,null,s);break;case"together":Om(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Rs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ka|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,n=_o(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_o(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function PO(t,e,n){switch(e.tag){case 3:VC(e),eu();break;case 5:dC(e);break;case 1:Lr(e.type)&&Wf(e);break;case 4:r0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Lt(Yf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Lt(Xt,Xt.current&1),e.flags|=128,null):n&e.child.childLanes?FC(t,e,n):(Lt(Xt,Xt.current&1),t=Rs(t,e,n),t!==null?t.sibling:null);Lt(Xt,Xt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return BC(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Lt(Xt,Xt.current),r)break;return null;case 22:case 23:return e.lanes=0,MC(t,e,n)}return Rs(t,e,n)}var UC,uv,jC,zC;UC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uv=function(){};jC=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,pa(Zi.current);var s=null;switch(n){case"input":i=k_(t,i),r=k_(t,r),s=[];break;case"select":i=en({},i,{value:void 0}),r=en({},r,{value:void 0}),s=[];break;case"textarea":i=O_(t,i),r=O_(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Hf)}L_(n,r);var a;n=null;for(g in i)if(!r.hasOwnProperty(g)&&i.hasOwnProperty(g)&&i[g]!=null)if(g==="style"){var u=i[g];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(zc.hasOwnProperty(g)?s||(s=[]):(s=s||[]).push(g,null));for(g in r){var h=r[g];if(u=i!=null?i[g]:void 0,r.hasOwnProperty(g)&&h!==u&&(h!=null||u!=null))if(g==="style")if(u){for(a in u)!u.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in h)h.hasOwnProperty(a)&&u[a]!==h[a]&&(n||(n={}),n[a]=h[a])}else n||(s||(s=[]),s.push(g,n)),n=h;else g==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,u=u?u.__html:void 0,h!=null&&u!==h&&(s=s||[]).push(g,h)):g==="children"?typeof h!="string"&&typeof h!="number"||(s=s||[]).push(g,""+h):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(zc.hasOwnProperty(g)?(h!=null&&g==="onScroll"&&Bt("scroll",t),s||u===h||(s=[])):(s=s||[]).push(g,h))}n&&(s=s||[]).push("style",n);var g=s;(e.updateQueue=g)&&(e.flags|=4)}};zC=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gu(t,e){if(!Wt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function er(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function RO(t,e,n){var r=e.pendingProps;switch(Yy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(e),null;case 1:return Lr(e.type)&&Gf(),er(e),null;case 3:return r=e.stateNode,nu(),qt(Mr),qt(sr),s0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ei!==null&&(_v(Ei),Ei=null))),uv(t,e),er(e),null;case 5:i0(e);var i=pa(eh.current);if(n=e.type,t!==null&&e.stateNode!=null)jC(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ye(166));return er(e),null}if(t=pa(Zi.current),Vd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ui]=e,r[Jc]=s,t=(e.mode&1)!==0,n){case"dialog":Bt("cancel",r),Bt("close",r);break;case"iframe":case"object":case"embed":Bt("load",r);break;case"video":case"audio":for(i=0;i<hc.length;i++)Bt(hc[i],r);break;case"source":Bt("error",r);break;case"img":case"image":case"link":Bt("error",r),Bt("load",r);break;case"details":Bt("toggle",r);break;case"input":KE(r,s),Bt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Bt("invalid",r);break;case"textarea":YE(r,s),Bt("invalid",r)}L_(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var u=s[a];a==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&Ld(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&Ld(r.textContent,u,t),i=["children",""+u]):zc.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&Bt("scroll",r)}switch(n){case"input":bd(r),QE(r,s,!0);break;case"textarea":bd(r),XE(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Hf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=px(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Ui]=e,t[Jc]=r,UC(t,e,!1,!1),e.stateNode=t;e:{switch(a=V_(n,r),n){case"dialog":Bt("cancel",t),Bt("close",t),i=r;break;case"iframe":case"object":case"embed":Bt("load",t),i=r;break;case"video":case"audio":for(i=0;i<hc.length;i++)Bt(hc[i],t);i=r;break;case"source":Bt("error",t),i=r;break;case"img":case"image":case"link":Bt("error",t),Bt("load",t),i=r;break;case"details":Bt("toggle",t),i=r;break;case"input":KE(t,r),i=k_(t,r),Bt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=en({},r,{value:void 0}),Bt("invalid",t);break;case"textarea":YE(t,r),i=O_(t,r),Bt("invalid",t);break;default:i=r}L_(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var h=u[s];s==="style"?vx(t,h):s==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&mx(t,h)):s==="children"?typeof h=="string"?(n!=="textarea"||h!=="")&&$c(t,h):typeof h=="number"&&$c(t,""+h):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(zc.hasOwnProperty(s)?h!=null&&s==="onScroll"&&Bt("scroll",t):h!=null&&My(t,s,h,a))}switch(n){case"input":bd(t),QE(t,r,!1);break;case"textarea":bd(t),XE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Eo(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Fl(t,!!r.multiple,s,!1):r.defaultValue!=null&&Fl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Hf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return er(e),null;case 6:if(t&&e.stateNode!=null)zC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ye(166));if(n=pa(eh.current),pa(Zi.current),Vd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ui]=e,(s=r.nodeValue!==n)&&(t=Hr,t!==null))switch(t.tag){case 3:Ld(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ld(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ui]=e,e.stateNode=r}return er(e),null;case 13:if(qt(Xt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Wt&&$r!==null&&e.mode&1&&!(e.flags&128))sC(),eu(),e.flags|=98560,s=!1;else if(s=Vd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ye(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ye(317));s[Ui]=e}else eu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;er(e),s=!1}else Ei!==null&&(_v(Ei),Ei=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Xt.current&1?Tn===0&&(Tn=3):_0())),e.updateQueue!==null&&(e.flags|=4),er(e),null);case 4:return nu(),uv(t,e),t===null&&Yc(e.stateNode.containerInfo),er(e),null;case 10:return e0(e.type._context),er(e),null;case 17:return Lr(e.type)&&Gf(),er(e),null;case 19:if(qt(Xt),s=e.memoizedState,s===null)return er(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Gu(s,!1);else{if(Tn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Zf(t),a!==null){for(e.flags|=128,Gu(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Lt(Xt,Xt.current&1|2),e.child}t=t.sibling}s.tail!==null&&pn()>iu&&(e.flags|=128,r=!0,Gu(s,!1),e.lanes=4194304)}else{if(!r)if(t=Zf(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Wt)return er(e),null}else 2*pn()-s.renderingStartTime>iu&&n!==1073741824&&(e.flags|=128,r=!0,Gu(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pn(),e.sibling=null,n=Xt.current,Lt(Xt,r?n&1|2:n&1),e):(er(e),null);case 22:case 23:return m0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Br&1073741824&&(er(e),e.subtreeFlags&6&&(e.flags|=8192)):er(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function kO(t,e){switch(Yy(e),e.tag){case 1:return Lr(e.type)&&Gf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return nu(),qt(Mr),qt(sr),s0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return i0(e),null;case 13:if(qt(Xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));eu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return qt(Xt),null;case 4:return nu(),null;case 10:return e0(e.type._context),null;case 22:case 23:return m0(),null;case 24:return null;default:return null}}var Ud=!1,nr=!1,NO=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function kl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){rn(t,e,r)}else n.current=null}function cv(t,e,n){try{n()}catch(r){rn(t,e,r)}}var UI=!1;function DO(t,e){if(W_=zf,t=Gx(),Ky(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,u=-1,h=-1,g=0,m=0,w=t,T=null;t:for(;;){for(var I;w!==n||i!==0&&w.nodeType!==3||(u=a+i),w!==s||r!==0&&w.nodeType!==3||(h=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(I=w.firstChild)!==null;)T=w,w=I;for(;;){if(w===t)break t;if(T===n&&++g===i&&(u=a),T===s&&++m===r&&(h=a),(I=w.nextSibling)!==null)break;w=T,T=w.parentNode}w=I}n=u===-1||h===-1?null:{start:u,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(K_={focusedElem:t,selectionRange:n},zf=!1,Fe=e;Fe!==null;)if(e=Fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Fe=t;else for(;Fe!==null;){e=Fe;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var z=j.memoizedProps,X=j.memoizedState,V=e.stateNode,B=V.getSnapshotBeforeUpdate(e.elementType===e.type?z:yi(e.type,z),X);V.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var U=e.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(J){rn(e,e.return,J)}if(t=e.sibling,t!==null){t.return=e.return,Fe=t;break}Fe=e.return}return j=UI,UI=!1,j}function bc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&cv(e,n,s)}i=i.next}while(i!==r)}}function Qg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function $C(t){var e=t.alternate;e!==null&&(t.alternate=null,$C(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ui],delete e[Jc],delete e[X_],delete e[pO],delete e[mO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qC(t){return t.tag===5||t.tag===3||t.tag===4}function jI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function dv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Hf));else if(r!==4&&(t=t.child,t!==null))for(dv(t,e,n),t=t.sibling;t!==null;)dv(t,e,n),t=t.sibling}function fv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fv(t,e,n),t=t.sibling;t!==null;)fv(t,e,n),t=t.sibling}var Un=null,wi=!1;function Hs(t,e,n){for(n=n.child;n!==null;)HC(t,e,n),n=n.sibling}function HC(t,e,n){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(jg,n)}catch{}switch(n.tag){case 5:nr||kl(n,e);case 6:var r=Un,i=wi;Un=null,Hs(t,e,n),Un=r,wi=i,Un!==null&&(wi?(t=Un,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Un.removeChild(n.stateNode));break;case 18:Un!==null&&(wi?(t=Un,n=n.stateNode,t.nodeType===8?Am(t.parentNode,n):t.nodeType===1&&Am(t,n),Wc(t)):Am(Un,n.stateNode));break;case 4:r=Un,i=wi,Un=n.stateNode.containerInfo,wi=!0,Hs(t,e,n),Un=r,wi=i;break;case 0:case 11:case 14:case 15:if(!nr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&cv(n,e,a),i=i.next}while(i!==r)}Hs(t,e,n);break;case 1:if(!nr&&(kl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){rn(n,e,u)}Hs(t,e,n);break;case 21:Hs(t,e,n);break;case 22:n.mode&1?(nr=(r=nr)||n.memoizedState!==null,Hs(t,e,n),nr=r):Hs(t,e,n);break;default:Hs(t,e,n)}}function zI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new NO),e.forEach(function(r){var i=zO.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function vi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:Un=u.stateNode,wi=!1;break e;case 3:Un=u.stateNode.containerInfo,wi=!0;break e;case 4:Un=u.stateNode.containerInfo,wi=!0;break e}u=u.return}if(Un===null)throw Error(ye(160));HC(s,a,i),Un=null,wi=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(g){rn(i,e,g)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)GC(e,t),e=e.sibling}function GC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vi(e,t),Mi(t),r&4){try{bc(3,t,t.return),Qg(3,t)}catch(z){rn(t,t.return,z)}try{bc(5,t,t.return)}catch(z){rn(t,t.return,z)}}break;case 1:vi(e,t),Mi(t),r&512&&n!==null&&kl(n,n.return);break;case 5:if(vi(e,t),Mi(t),r&512&&n!==null&&kl(n,n.return),t.flags&32){var i=t.stateNode;try{$c(i,"")}catch(z){rn(t,t.return,z)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,u=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&fx(i,s),V_(u,a);var g=V_(u,s);for(a=0;a<h.length;a+=2){var m=h[a],w=h[a+1];m==="style"?vx(i,w):m==="dangerouslySetInnerHTML"?mx(i,w):m==="children"?$c(i,w):My(i,m,w,g)}switch(u){case"input":N_(i,s);break;case"textarea":gx(i,s);break;case"select":var T=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var I=s.value;I!=null?Fl(i,!!s.multiple,I,!1):T!==!!s.multiple&&(s.defaultValue!=null?Fl(i,!!s.multiple,s.defaultValue,!0):Fl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Jc]=s}catch(z){rn(t,t.return,z)}}break;case 6:if(vi(e,t),Mi(t),r&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(z){rn(t,t.return,z)}}break;case 3:if(vi(e,t),Mi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wc(e.containerInfo)}catch(z){rn(t,t.return,z)}break;case 4:vi(e,t),Mi(t);break;case 13:vi(e,t),Mi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(g0=pn())),r&4&&zI(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(nr=(g=nr)||m,vi(e,t),nr=g):vi(e,t),Mi(t),r&8192){if(g=t.memoizedState!==null,(t.stateNode.isHidden=g)&&!m&&t.mode&1)for(Fe=t,m=t.child;m!==null;){for(w=Fe=m;Fe!==null;){switch(T=Fe,I=T.child,T.tag){case 0:case 11:case 14:case 15:bc(4,T,T.return);break;case 1:kl(T,T.return);var j=T.stateNode;if(typeof j.componentWillUnmount=="function"){r=T,n=T.return;try{e=r,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(z){rn(r,n,z)}}break;case 5:kl(T,T.return);break;case 22:if(T.memoizedState!==null){qI(w);continue}}I!==null?(I.return=T,Fe=I):qI(w)}m=m.sibling}e:for(m=null,w=t;;){if(w.tag===5){if(m===null){m=w;try{i=w.stateNode,g?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=w.stateNode,h=w.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,u.style.display=_x("display",a))}catch(z){rn(t,t.return,z)}}}else if(w.tag===6){if(m===null)try{w.stateNode.nodeValue=g?"":w.memoizedProps}catch(z){rn(t,t.return,z)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;m===w&&(m=null),w=w.return}m===w&&(m=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:vi(e,t),Mi(t),r&4&&zI(t);break;case 21:break;default:vi(e,t),Mi(t)}}function Mi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qC(n)){var r=n;break e}n=n.return}throw Error(ye(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&($c(i,""),r.flags&=-33);var s=jI(t);fv(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,u=jI(t);dv(t,u,a);break;default:throw Error(ye(161))}}catch(h){rn(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OO(t,e,n){Fe=t,WC(t)}function WC(t,e,n){for(var r=(t.mode&1)!==0;Fe!==null;){var i=Fe,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Ud;if(!a){var u=i.alternate,h=u!==null&&u.memoizedState!==null||nr;u=Ud;var g=nr;if(Ud=a,(nr=h)&&!g)for(Fe=i;Fe!==null;)a=Fe,h=a.child,a.tag===22&&a.memoizedState!==null?HI(i):h!==null?(h.return=a,Fe=h):HI(i);for(;s!==null;)Fe=s,WC(s),s=s.sibling;Fe=i,Ud=u,nr=g}$I(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Fe=s):$I(t)}}function $I(t){for(;Fe!==null;){var e=Fe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nr||Qg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:yi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&CI(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}CI(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var g=e.alternate;if(g!==null){var m=g.memoizedState;if(m!==null){var w=m.dehydrated;w!==null&&Wc(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}nr||e.flags&512&&hv(e)}catch(T){rn(e,e.return,T)}}if(e===t){Fe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Fe=n;break}Fe=e.return}}function qI(t){for(;Fe!==null;){var e=Fe;if(e===t){Fe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Fe=n;break}Fe=e.return}}function HI(t){for(;Fe!==null;){var e=Fe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Qg(4,e)}catch(h){rn(e,n,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(h){rn(e,i,h)}}var s=e.return;try{hv(e)}catch(h){rn(e,s,h)}break;case 5:var a=e.return;try{hv(e)}catch(h){rn(e,a,h)}}}catch(h){rn(e,e.return,h)}if(e===t){Fe=null;break}var u=e.sibling;if(u!==null){u.return=e.return,Fe=u;break}Fe=e.return}}var MO=Math.ceil,ng=Vs.ReactCurrentDispatcher,d0=Vs.ReactCurrentOwner,li=Vs.ReactCurrentBatchConfig,wt=0,Nn=null,En=null,qn=0,Br=0,Nl=Vo(0),Tn=0,ih=null,ka=0,Yg=0,f0=0,Pc=null,Ar=null,g0=0,iu=1/0,fs=null,rg=!1,gv=null,po=null,jd=!1,io=null,ig=0,Rc=0,pv=null,mf=-1,_f=0;function pr(){return wt&6?pn():mf!==-1?mf:mf=pn()}function mo(t){return t.mode&1?wt&2&&qn!==0?qn&-qn:vO.transition!==null?(_f===0&&(_f=Rx()),_f):(t=bt,t!==0||(t=window.event,t=t===void 0?16:Vx(t.type)),t):1}function Ai(t,e,n,r){if(50<Rc)throw Rc=0,pv=null,Error(ye(185));Uh(t,n,r),(!(wt&2)||t!==Nn)&&(t===Nn&&(!(wt&2)&&(Yg|=n),Tn===4&&Zs(t,qn)),Vr(t,r),n===1&&wt===0&&!(e.mode&1)&&(iu=pn()+500,Gg&&Fo()))}function Vr(t,e){var n=t.callbackNode;vD(t,e);var r=jf(t,t===Nn?qn:0);if(r===0)n!==null&&eI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&eI(n),e===1)t.tag===0?_O(GI.bind(null,t)):nC(GI.bind(null,t)),fO(function(){!(wt&6)&&Fo()}),n=null;else{switch(kx(r)){case 1:n=Uy;break;case 4:n=bx;break;case 16:n=Uf;break;case 536870912:n=Px;break;default:n=Uf}n=tA(n,KC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function KC(t,e){if(mf=-1,_f=0,wt&6)throw Error(ye(327));var n=t.callbackNode;if($l()&&t.callbackNode!==n)return null;var r=jf(t,t===Nn?qn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=sg(t,r);else{e=r;var i=wt;wt|=2;var s=YC();(Nn!==t||qn!==e)&&(fs=null,iu=pn()+500,Ia(t,e));do try{FO();break}catch(u){QC(t,u)}while(!0);Zy(),ng.current=s,wt=i,En!==null?e=0:(Nn=null,qn=0,e=Tn)}if(e!==0){if(e===2&&(i=z_(t),i!==0&&(r=i,e=mv(t,i))),e===1)throw n=ih,Ia(t,0),Zs(t,r),Vr(t,pn()),n;if(e===6)Zs(t,r);else{if(i=t.current.alternate,!(r&30)&&!LO(i)&&(e=sg(t,r),e===2&&(s=z_(t),s!==0&&(r=s,e=mv(t,s))),e===1))throw n=ih,Ia(t,0),Zs(t,r),Vr(t,pn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ye(345));case 2:ra(t,Ar,fs);break;case 3:if(Zs(t,r),(r&130023424)===r&&(e=g0+500-pn(),10<e)){if(jf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){pr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Y_(ra.bind(null,t,Ar,fs),e);break}ra(t,Ar,fs);break;case 4:if(Zs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Ci(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=pn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*MO(r/1960))-r,10<r){t.timeoutHandle=Y_(ra.bind(null,t,Ar,fs),r);break}ra(t,Ar,fs);break;case 5:ra(t,Ar,fs);break;default:throw Error(ye(329))}}}return Vr(t,pn()),t.callbackNode===n?KC.bind(null,t):null}function mv(t,e){var n=Pc;return t.current.memoizedState.isDehydrated&&(Ia(t,e).flags|=256),t=sg(t,e),t!==2&&(e=Ar,Ar=n,e!==null&&_v(e)),t}function _v(t){Ar===null?Ar=t:Ar.push.apply(Ar,t)}function LO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Pi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zs(t,e){for(e&=~f0,e&=~Yg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ci(e),r=1<<n;t[n]=-1,e&=~r}}function GI(t){if(wt&6)throw Error(ye(327));$l();var e=jf(t,0);if(!(e&1))return Vr(t,pn()),null;var n=sg(t,e);if(t.tag!==0&&n===2){var r=z_(t);r!==0&&(e=r,n=mv(t,r))}if(n===1)throw n=ih,Ia(t,0),Zs(t,e),Vr(t,pn()),n;if(n===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ra(t,Ar,fs),Vr(t,pn()),null}function p0(t,e){var n=wt;wt|=1;try{return t(e)}finally{wt=n,wt===0&&(iu=pn()+500,Gg&&Fo())}}function Na(t){io!==null&&io.tag===0&&!(wt&6)&&$l();var e=wt;wt|=1;var n=li.transition,r=bt;try{if(li.transition=null,bt=1,t)return t()}finally{bt=r,li.transition=n,wt=e,!(wt&6)&&Fo()}}function m0(){Br=Nl.current,qt(Nl)}function Ia(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dO(n)),En!==null)for(n=En.return;n!==null;){var r=n;switch(Yy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gf();break;case 3:nu(),qt(Mr),qt(sr),s0();break;case 5:i0(r);break;case 4:nu();break;case 13:qt(Xt);break;case 19:qt(Xt);break;case 10:e0(r.type._context);break;case 22:case 23:m0()}n=n.return}if(Nn=t,En=t=_o(t.current,null),qn=Br=e,Tn=0,ih=null,f0=Yg=ka=0,Ar=Pc=null,ga!==null){for(e=0;e<ga.length;e++)if(n=ga[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ga=null}return t}function QC(t,e){do{var n=En;try{if(Zy(),ff.current=tg,eg){for(var r=Jt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}eg=!1}if(Ra=0,Rn=In=Jt=null,Ac=!1,th=0,d0.current=null,n===null||n.return===null){Tn=1,ih=e,En=null;break}e:{var s=t,a=n.return,u=n,h=e;if(e=qn,u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var g=h,m=u,w=m.tag;if(!(m.mode&1)&&(w===0||w===11||w===15)){var T=m.alternate;T?(m.updateQueue=T.updateQueue,m.memoizedState=T.memoizedState,m.lanes=T.lanes):(m.updateQueue=null,m.memoizedState=null)}var I=DI(a);if(I!==null){I.flags&=-257,OI(I,a,u,s,e),I.mode&1&&NI(s,g,e),e=I,h=g;var j=e.updateQueue;if(j===null){var z=new Set;z.add(h),e.updateQueue=z}else j.add(h);break e}else{if(!(e&1)){NI(s,g,e),_0();break e}h=Error(ye(426))}}else if(Wt&&u.mode&1){var X=DI(a);if(X!==null){!(X.flags&65536)&&(X.flags|=256),OI(X,a,u,s,e),Xy(ru(h,u));break e}}s=h=ru(h,u),Tn!==4&&(Tn=2),Pc===null?Pc=[s]:Pc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var V=NC(s,h,e);xI(s,V);break e;case 1:u=h;var B=s.type,U=s.stateNode;if(!(s.flags&128)&&(typeof B.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(po===null||!po.has(U)))){s.flags|=65536,e&=-e,s.lanes|=e;var J=DC(s,u,e);xI(s,J);break e}}s=s.return}while(s!==null)}JC(n)}catch(re){e=re,En===n&&n!==null&&(En=n=n.return);continue}break}while(!0)}function YC(){var t=ng.current;return ng.current=tg,t===null?tg:t}function _0(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),Nn===null||!(ka&268435455)&&!(Yg&268435455)||Zs(Nn,qn)}function sg(t,e){var n=wt;wt|=2;var r=YC();(Nn!==t||qn!==e)&&(fs=null,Ia(t,e));do try{VO();break}catch(i){QC(t,i)}while(!0);if(Zy(),wt=n,ng.current=r,En!==null)throw Error(ye(261));return Nn=null,qn=0,Tn}function VO(){for(;En!==null;)XC(En)}function FO(){for(;En!==null&&!uD();)XC(En)}function XC(t){var e=eA(t.alternate,t,Br);t.memoizedProps=t.pendingProps,e===null?JC(t):En=e,d0.current=null}function JC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=kO(n,e),n!==null){n.flags&=32767,En=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tn=6,En=null;return}}else if(n=RO(n,e,Br),n!==null){En=n;return}if(e=e.sibling,e!==null){En=e;return}En=e=t}while(e!==null);Tn===0&&(Tn=5)}function ra(t,e,n){var r=bt,i=li.transition;try{li.transition=null,bt=1,BO(t,e,n,r)}finally{li.transition=i,bt=r}return null}function BO(t,e,n,r){do $l();while(io!==null);if(wt&6)throw Error(ye(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(yD(t,s),t===Nn&&(En=Nn=null,qn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||jd||(jd=!0,tA(Uf,function(){return $l(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=li.transition,li.transition=null;var a=bt;bt=1;var u=wt;wt|=4,d0.current=null,DO(t,n),GC(n,t),sO(K_),zf=!!W_,K_=W_=null,t.current=n,OO(n),cD(),wt=u,bt=a,li.transition=s}else t.current=n;if(jd&&(jd=!1,io=t,ig=i),s=t.pendingLanes,s===0&&(po=null),fD(n.stateNode),Vr(t,pn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(rg)throw rg=!1,t=gv,gv=null,t;return ig&1&&t.tag!==0&&$l(),s=t.pendingLanes,s&1?t===pv?Rc++:(Rc=0,pv=t):Rc=0,Fo(),null}function $l(){if(io!==null){var t=kx(ig),e=li.transition,n=bt;try{if(li.transition=null,bt=16>t?16:t,io===null)var r=!1;else{if(t=io,io=null,ig=0,wt&6)throw Error(ye(331));var i=wt;for(wt|=4,Fe=t.current;Fe!==null;){var s=Fe,a=s.child;if(Fe.flags&16){var u=s.deletions;if(u!==null){for(var h=0;h<u.length;h++){var g=u[h];for(Fe=g;Fe!==null;){var m=Fe;switch(m.tag){case 0:case 11:case 15:bc(8,m,s)}var w=m.child;if(w!==null)w.return=m,Fe=w;else for(;Fe!==null;){m=Fe;var T=m.sibling,I=m.return;if($C(m),m===g){Fe=null;break}if(T!==null){T.return=I,Fe=T;break}Fe=I}}}var j=s.alternate;if(j!==null){var z=j.child;if(z!==null){j.child=null;do{var X=z.sibling;z.sibling=null,z=X}while(z!==null)}}Fe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Fe=a;else e:for(;Fe!==null;){if(s=Fe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:bc(9,s,s.return)}var V=s.sibling;if(V!==null){V.return=s.return,Fe=V;break e}Fe=s.return}}var B=t.current;for(Fe=B;Fe!==null;){a=Fe;var U=a.child;if(a.subtreeFlags&2064&&U!==null)U.return=a,Fe=U;else e:for(a=B;Fe!==null;){if(u=Fe,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Qg(9,u)}}catch(re){rn(u,u.return,re)}if(u===a){Fe=null;break e}var J=u.sibling;if(J!==null){J.return=u.return,Fe=J;break e}Fe=u.return}}if(wt=i,Fo(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(jg,t)}catch{}r=!0}return r}finally{bt=n,li.transition=e}}return!1}function WI(t,e,n){e=ru(n,e),e=NC(t,e,1),t=go(t,e,1),e=pr(),t!==null&&(Uh(t,1,e),Vr(t,e))}function rn(t,e,n){if(t.tag===3)WI(t,t,n);else for(;e!==null;){if(e.tag===3){WI(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(po===null||!po.has(r))){t=ru(n,t),t=DC(e,t,1),e=go(e,t,1),t=pr(),e!==null&&(Uh(e,1,t),Vr(e,t));break}}e=e.return}}function UO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=pr(),t.pingedLanes|=t.suspendedLanes&n,Nn===t&&(qn&n)===n&&(Tn===4||Tn===3&&(qn&130023424)===qn&&500>pn()-g0?Ia(t,0):f0|=n),Vr(t,e)}function ZC(t,e){e===0&&(t.mode&1?(e=kd,kd<<=1,!(kd&130023424)&&(kd=4194304)):e=1);var n=pr();t=Ps(t,e),t!==null&&(Uh(t,e,n),Vr(t,n))}function jO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ZC(t,n)}function zO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ye(314))}r!==null&&r.delete(e),ZC(t,n)}var eA;eA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mr.current)Pr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Pr=!1,PO(t,e,n);Pr=!!(t.flags&131072)}else Pr=!1,Wt&&e.flags&1048576&&rC(e,Qf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pf(t,e),t=e.pendingProps;var i=Zl(e,sr.current);zl(e,n),i=a0(null,e,r,t,i,n);var s=l0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Lr(r)?(s=!0,Wf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,n0(e),i.updater=Wg,e.stateNode=i,i._reactInternals=e,rv(e,r,t,n),e=ov(null,e,r,!0,s,n)):(e.tag=0,Wt&&s&&Qy(e),ur(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=qO(r),t=yi(r,t),i){case 0:e=sv(null,e,r,t,n);break e;case 1:e=VI(null,e,r,t,n);break e;case 11:e=MI(null,e,r,t,n);break e;case 14:e=LI(null,e,r,yi(r.type,t),n);break e}throw Error(ye(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yi(r,i),sv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yi(r,i),VI(t,e,r,i,n);case 3:e:{if(VC(e),t===null)throw Error(ye(387));r=e.pendingProps,s=e.memoizedState,i=s.element,aC(t,e),Jf(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ru(Error(ye(423)),e),e=FI(t,e,r,n,i);break e}else if(r!==i){i=ru(Error(ye(424)),e),e=FI(t,e,r,n,i);break e}else for($r=fo(e.stateNode.containerInfo.firstChild),Hr=e,Wt=!0,Ei=null,n=hC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(eu(),r===i){e=Rs(t,e,n);break e}ur(t,e,r,n)}e=e.child}return e;case 5:return dC(e),t===null&&ev(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Q_(r,i)?a=null:s!==null&&Q_(r,s)&&(e.flags|=32),LC(t,e),ur(t,e,a,n),e.child;case 6:return t===null&&ev(e),null;case 13:return FC(t,e,n);case 4:return r0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=tu(e,null,r,n):ur(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yi(r,i),MI(t,e,r,i,n);case 7:return ur(t,e,e.pendingProps,n),e.child;case 8:return ur(t,e,e.pendingProps.children,n),e.child;case 12:return ur(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Lt(Yf,r._currentValue),r._currentValue=a,s!==null)if(Pi(s.value,a)){if(s.children===i.children&&!Mr.current){e=Rs(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){a=s.child;for(var h=u.firstContext;h!==null;){if(h.context===r){if(s.tag===1){h=Ss(-1,n&-n),h.tag=2;var g=s.updateQueue;if(g!==null){g=g.shared;var m=g.pending;m===null?h.next=h:(h.next=m.next,m.next=h),g.pending=h}}s.lanes|=n,h=s.alternate,h!==null&&(h.lanes|=n),tv(s.return,n,e),u.lanes|=n;break}h=h.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ye(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),tv(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ur(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,zl(e,n),i=ui(i),r=r(i),e.flags|=1,ur(t,e,r,n),e.child;case 14:return r=e.type,i=yi(r,e.pendingProps),i=yi(r.type,i),LI(t,e,r,i,n);case 15:return OC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yi(r,i),pf(t,e),e.tag=1,Lr(r)?(t=!0,Wf(e)):t=!1,zl(e,n),uC(e,r,i),rv(e,r,i,n),ov(null,e,r,!0,t,n);case 19:return BC(t,e,n);case 22:return MC(t,e,n)}throw Error(ye(156,e.tag))};function tA(t,e){return Ax(t,e)}function $O(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(t,e,n,r){return new $O(t,e,n,r)}function v0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qO(t){if(typeof t=="function")return v0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vy)return 11;if(t===Fy)return 14}return 2}function _o(t,e){var n=t.alternate;return n===null?(n=oi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function vf(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")v0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Il:return Ta(n.children,i,s,e);case Ly:a=8,i|=8;break;case A_:return t=oi(12,n,e,i|2),t.elementType=A_,t.lanes=s,t;case b_:return t=oi(13,n,e,i),t.elementType=b_,t.lanes=s,t;case P_:return t=oi(19,n,e,i),t.elementType=P_,t.lanes=s,t;case cx:return Xg(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lx:a=10;break e;case ux:a=9;break e;case Vy:a=11;break e;case Fy:a=14;break e;case Ys:a=16,r=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=oi(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ta(t,e,n,r){return t=oi(7,t,r,e),t.lanes=n,t}function Xg(t,e,n,r){return t=oi(22,t,r,e),t.elementType=cx,t.lanes=n,t.stateNode={isHidden:!1},t}function Mm(t,e,n){return t=oi(6,t,null,e),t.lanes=n,t}function Lm(t,e,n){return e=oi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function HO(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mm(0),this.expirationTimes=mm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mm(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function y0(t,e,n,r,i,s,a,u,h){return t=new HO(t,e,n,u,h),e===1?(e=1,s===!0&&(e|=8)):e=0,s=oi(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},n0(s),t}function GO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:El,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function nA(t){if(!t)return Io;t=t._reactInternals;e:{if(Ka(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Lr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var n=t.type;if(Lr(n))return tC(t,n,e)}return e}function rA(t,e,n,r,i,s,a,u,h){return t=y0(n,r,!0,t,i,s,a,u,h),t.context=nA(null),n=t.current,r=pr(),i=mo(n),s=Ss(r,i),s.callback=e??null,go(n,s,i),t.current.lanes=i,Uh(t,i,r),Vr(t,r),t}function Jg(t,e,n,r){var i=e.current,s=pr(),a=mo(i);return n=nA(n),e.context===null?e.context=n:e.pendingContext=n,e=Ss(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=go(i,e,a),t!==null&&(Ai(t,i,a,s),df(t,i,a)),a}function og(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function KI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function w0(t,e){KI(t,e),(t=t.alternate)&&KI(t,e)}function WO(){return null}var iA=typeof reportError=="function"?reportError:function(t){console.error(t)};function E0(t){this._internalRoot=t}Zg.prototype.render=E0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));Jg(t,e,null,null)};Zg.prototype.unmount=E0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Na(function(){Jg(null,t,null,null)}),e[bs]=null}};function Zg(t){this._internalRoot=t}Zg.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ox();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Js.length&&e!==0&&e<Js[n].priority;n++);Js.splice(n,0,t),n===0&&Lx(t)}};function I0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ep(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function QI(){}function KO(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var g=og(a);s.call(g)}}var a=rA(e,r,t,0,null,!1,!1,"",QI);return t._reactRootContainer=a,t[bs]=a.current,Yc(t.nodeType===8?t.parentNode:t),Na(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var g=og(h);u.call(g)}}var h=y0(t,0,!1,null,null,!1,!1,"",QI);return t._reactRootContainer=h,t[bs]=h.current,Yc(t.nodeType===8?t.parentNode:t),Na(function(){Jg(e,h,n,r)}),h}function tp(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var u=i;i=function(){var h=og(a);u.call(h)}}Jg(e,a,t,i)}else a=KO(n,e,t,i,r);return og(a)}Nx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=cc(e.pendingLanes);n!==0&&(jy(e,n|1),Vr(e,pn()),!(wt&6)&&(iu=pn()+500,Fo()))}break;case 13:Na(function(){var r=Ps(t,1);if(r!==null){var i=pr();Ai(r,t,1,i)}}),w0(t,1)}};zy=function(t){if(t.tag===13){var e=Ps(t,134217728);if(e!==null){var n=pr();Ai(e,t,134217728,n)}w0(t,134217728)}};Dx=function(t){if(t.tag===13){var e=mo(t),n=Ps(t,e);if(n!==null){var r=pr();Ai(n,t,e,r)}w0(t,e)}};Ox=function(){return bt};Mx=function(t,e){var n=bt;try{return bt=t,e()}finally{bt=n}};B_=function(t,e,n){switch(e){case"input":if(N_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Hg(r);if(!i)throw Error(ye(90));dx(r),N_(r,i)}}}break;case"textarea":gx(t,n);break;case"select":e=n.value,e!=null&&Fl(t,!!n.multiple,e,!1)}};Ex=p0;Ix=Na;var QO={usingClientEntryPoint:!1,Events:[zh,Cl,Hg,yx,wx,p0]},Wu={findFiberByHostInstance:fa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},YO={bundleType:Wu.bundleType,version:Wu.version,rendererPackageName:Wu.rendererPackageName,rendererConfig:Wu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=xx(t),t===null?null:t.stateNode},findFiberByHostInstance:Wu.findFiberByHostInstance||WO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{jg=zd.inject(YO),Ji=zd}catch{}}Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QO;Yr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I0(e))throw Error(ye(200));return GO(t,e,null,n)};Yr.createRoot=function(t,e){if(!I0(t))throw Error(ye(299));var n=!1,r="",i=iA;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=y0(t,1,!1,null,null,n,!1,r,i),t[bs]=e.current,Yc(t.nodeType===8?t.parentNode:t),new E0(e)};Yr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=xx(e),t=t===null?null:t.stateNode,t};Yr.flushSync=function(t){return Na(t)};Yr.hydrate=function(t,e,n){if(!ep(e))throw Error(ye(200));return tp(null,t,e,!0,n)};Yr.hydrateRoot=function(t,e,n){if(!I0(t))throw Error(ye(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=iA;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=rA(e,null,t,1,n??null,i,!1,s,a),t[bs]=e.current,Yc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Zg(e)};Yr.render=function(t,e,n){if(!ep(e))throw Error(ye(200));return tp(null,t,e,!1,n)};Yr.unmountComponentAtNode=function(t){if(!ep(t))throw Error(ye(40));return t._reactRootContainer?(Na(function(){tp(null,null,t,!1,function(){t._reactRootContainer=null,t[bs]=null})}),!0):!1};Yr.unstable_batchedUpdates=p0;Yr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ep(n))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return tp(t,e,n,!1,r)};Yr.version="18.2.0-next-9e3b772b8-20220608";function sA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sA)}catch(t){console.error(t)}}sA(),rx.exports=Yr;var T0=rx.exports,YI=T0;x_.createRoot=YI.createRoot,x_.hydrateRoot=YI.hydrateRoot;var vv=function(t,e){return vv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},vv(t,e)};function di(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vv(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Be=function(){return Be=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Be.apply(this,arguments)};function ks(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Bi(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var oA={exports:{}},Rt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mn=typeof Symbol=="function"&&Symbol.for,S0=Mn?Symbol.for("react.element"):60103,x0=Mn?Symbol.for("react.portal"):60106,np=Mn?Symbol.for("react.fragment"):60107,rp=Mn?Symbol.for("react.strict_mode"):60108,ip=Mn?Symbol.for("react.profiler"):60114,sp=Mn?Symbol.for("react.provider"):60109,op=Mn?Symbol.for("react.context"):60110,C0=Mn?Symbol.for("react.async_mode"):60111,ap=Mn?Symbol.for("react.concurrent_mode"):60111,lp=Mn?Symbol.for("react.forward_ref"):60112,up=Mn?Symbol.for("react.suspense"):60113,XO=Mn?Symbol.for("react.suspense_list"):60120,cp=Mn?Symbol.for("react.memo"):60115,hp=Mn?Symbol.for("react.lazy"):60116,JO=Mn?Symbol.for("react.block"):60121,ZO=Mn?Symbol.for("react.fundamental"):60117,eM=Mn?Symbol.for("react.responder"):60118,tM=Mn?Symbol.for("react.scope"):60119;function Jr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case S0:switch(t=t.type,t){case C0:case ap:case np:case ip:case rp:case up:return t;default:switch(t=t&&t.$$typeof,t){case op:case lp:case hp:case cp:case sp:return t;default:return e}}case x0:return e}}}function aA(t){return Jr(t)===ap}Rt.AsyncMode=C0;Rt.ConcurrentMode=ap;Rt.ContextConsumer=op;Rt.ContextProvider=sp;Rt.Element=S0;Rt.ForwardRef=lp;Rt.Fragment=np;Rt.Lazy=hp;Rt.Memo=cp;Rt.Portal=x0;Rt.Profiler=ip;Rt.StrictMode=rp;Rt.Suspense=up;Rt.isAsyncMode=function(t){return aA(t)||Jr(t)===C0};Rt.isConcurrentMode=aA;Rt.isContextConsumer=function(t){return Jr(t)===op};Rt.isContextProvider=function(t){return Jr(t)===sp};Rt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===S0};Rt.isForwardRef=function(t){return Jr(t)===lp};Rt.isFragment=function(t){return Jr(t)===np};Rt.isLazy=function(t){return Jr(t)===hp};Rt.isMemo=function(t){return Jr(t)===cp};Rt.isPortal=function(t){return Jr(t)===x0};Rt.isProfiler=function(t){return Jr(t)===ip};Rt.isStrictMode=function(t){return Jr(t)===rp};Rt.isSuspense=function(t){return Jr(t)===up};Rt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===np||t===ap||t===ip||t===rp||t===up||t===XO||typeof t=="object"&&t!==null&&(t.$$typeof===hp||t.$$typeof===cp||t.$$typeof===sp||t.$$typeof===op||t.$$typeof===lp||t.$$typeof===ZO||t.$$typeof===eM||t.$$typeof===tM||t.$$typeof===JO)};Rt.typeOf=Jr;oA.exports=Rt;var nM=oA.exports,lA=nM,rM={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},iM={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},uA={};uA[lA.ForwardRef]=rM;uA[lA.Memo]=iM;function cA(t,e,n){if(n===void 0&&(n=Error),!t)throw new n(e)}var gt;(function(t){t[t.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",t[t.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",t[t.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",t[t.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",t[t.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",t[t.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",t[t.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",t[t.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",t[t.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",t[t.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",t[t.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",t[t.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",t[t.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",t[t.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",t[t.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",t[t.INVALID_TAG=23]="INVALID_TAG",t[t.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",t[t.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",t[t.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(gt||(gt={}));var Ut;(function(t){t[t.literal=0]="literal",t[t.argument=1]="argument",t[t.number=2]="number",t[t.date=3]="date",t[t.time=4]="time",t[t.select=5]="select",t[t.plural=6]="plural",t[t.pound=7]="pound",t[t.tag=8]="tag"})(Ut||(Ut={}));var su;(function(t){t[t.number=0]="number",t[t.dateTime=1]="dateTime"})(su||(su={}));function XI(t){return t.type===Ut.literal}function sM(t){return t.type===Ut.argument}function hA(t){return t.type===Ut.number}function dA(t){return t.type===Ut.date}function fA(t){return t.type===Ut.time}function gA(t){return t.type===Ut.select}function pA(t){return t.type===Ut.plural}function oM(t){return t.type===Ut.pound}function mA(t){return t.type===Ut.tag}function _A(t){return!!(t&&typeof t=="object"&&t.type===su.number)}function yv(t){return!!(t&&typeof t=="object"&&t.type===su.dateTime)}var vA=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,aM=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function lM(t){var e={};return t.replace(aM,function(n){var r=n.length;switch(n[0]){case"G":e.era=r===4?"long":r===5?"narrow":"short";break;case"y":e.year=r===2?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":e.month=["numeric","2-digit","short","long","narrow"][r-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":e.day=["numeric","2-digit"][r-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":e.weekday=r===4?"long":r===5?"narrow":"short";break;case"e":if(r<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][r-4];break;case"c":if(r<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][r-4];break;case"a":e.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":e.hourCycle="h12",e.hour=["numeric","2-digit"][r-1];break;case"H":e.hourCycle="h23",e.hour=["numeric","2-digit"][r-1];break;case"K":e.hourCycle="h11",e.hour=["numeric","2-digit"][r-1];break;case"k":e.hourCycle="h24",e.hour=["numeric","2-digit"][r-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":e.minute=["numeric","2-digit"][r-1];break;case"s":e.second=["numeric","2-digit"][r-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":e.timeZoneName=r<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),e}var uM=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function cM(t){if(t.length===0)throw new Error("Number skeleton cannot be empty");for(var e=t.split(uM).filter(function(T){return T.length>0}),n=[],r=0,i=e;r<i.length;r++){var s=i[r],a=s.split("/");if(a.length===0)throw new Error("Invalid number skeleton");for(var u=a[0],h=a.slice(1),g=0,m=h;g<m.length;g++){var w=m[g];if(w.length===0)throw new Error("Invalid number skeleton")}n.push({stem:u,options:h})}return n}function hM(t){return t.replace(/^(.*?)-/,"")}var JI=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,yA=/^(@+)?(\+|#+)?[rs]?$/g,dM=/(\*)(0+)|(#+)(0+)|(0+)/g,wA=/^(0+)$/;function ZI(t){var e={};return t[t.length-1]==="r"?e.roundingPriority="morePrecision":t[t.length-1]==="s"&&(e.roundingPriority="lessPrecision"),t.replace(yA,function(n,r,i){return typeof i!="string"?(e.minimumSignificantDigits=r.length,e.maximumSignificantDigits=r.length):i==="+"?e.minimumSignificantDigits=r.length:r[0]==="#"?e.maximumSignificantDigits=r.length:(e.minimumSignificantDigits=r.length,e.maximumSignificantDigits=r.length+(typeof i=="string"?i.length:0)),""}),e}function EA(t){switch(t){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function fM(t){var e;if(t[0]==="E"&&t[1]==="E"?(e={notation:"engineering"},t=t.slice(2)):t[0]==="E"&&(e={notation:"scientific"},t=t.slice(1)),e){var n=t.slice(0,2);if(n==="+!"?(e.signDisplay="always",t=t.slice(2)):n==="+?"&&(e.signDisplay="exceptZero",t=t.slice(2)),!wA.test(t))throw new Error("Malformed concise eng/scientific notation");e.minimumIntegerDigits=t.length}return e}function e1(t){var e={},n=EA(t);return n||e}function gM(t){for(var e={},n=0,r=t;n<r.length;n++){var i=r[n];switch(i.stem){case"percent":case"%":e.style="percent";continue;case"%x100":e.style="percent",e.scale=100;continue;case"currency":e.style="currency",e.currency=i.options[0];continue;case"group-off":case",_":e.useGrouping=!1;continue;case"precision-integer":case".":e.maximumFractionDigits=0;continue;case"measure-unit":case"unit":e.style="unit",e.unit=hM(i.options[0]);continue;case"compact-short":case"K":e.notation="compact",e.compactDisplay="short";continue;case"compact-long":case"KK":e.notation="compact",e.compactDisplay="long";continue;case"scientific":e=Be(Be(Be({},e),{notation:"scientific"}),i.options.reduce(function(h,g){return Be(Be({},h),e1(g))},{}));continue;case"engineering":e=Be(Be(Be({},e),{notation:"engineering"}),i.options.reduce(function(h,g){return Be(Be({},h),e1(g))},{}));continue;case"notation-simple":e.notation="standard";continue;case"unit-width-narrow":e.currencyDisplay="narrowSymbol",e.unitDisplay="narrow";continue;case"unit-width-short":e.currencyDisplay="code",e.unitDisplay="short";continue;case"unit-width-full-name":e.currencyDisplay="name",e.unitDisplay="long";continue;case"unit-width-iso-code":e.currencyDisplay="symbol";continue;case"scale":e.scale=parseFloat(i.options[0]);continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(dM,function(h,g,m,w,T,I){if(g)e.minimumIntegerDigits=m.length;else{if(w&&T)throw new Error("We currently do not support maximum integer digits");if(I)throw new Error("We currently do not support exact integer digits")}return""});continue}if(wA.test(i.stem)){e.minimumIntegerDigits=i.stem.length;continue}if(JI.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(JI,function(h,g,m,w,T,I){return m==="*"?e.minimumFractionDigits=g.length:w&&w[0]==="#"?e.maximumFractionDigits=w.length:T&&I?(e.minimumFractionDigits=T.length,e.maximumFractionDigits=T.length+I.length):(e.minimumFractionDigits=g.length,e.maximumFractionDigits=g.length),""});var s=i.options[0];s==="w"?e=Be(Be({},e),{trailingZeroDisplay:"stripIfInteger"}):s&&(e=Be(Be({},e),ZI(s)));continue}if(yA.test(i.stem)){e=Be(Be({},e),ZI(i.stem));continue}var a=EA(i.stem);a&&(e=Be(Be({},e),a));var u=fM(i.stem);u&&(e=Be(Be({},e),u))}return e}var $d={"001":["H","h"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["H","h","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["H","hB","h","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["H","h","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["H","hB","h","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["H","h","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["H","h","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["H","h","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["H","h","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["H","hB","h","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["H","h","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["H","h","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["H","h","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function pM(t,e){for(var n="",r=0;r<t.length;r++){var i=t.charAt(r);if(i==="j"){for(var s=0;r+1<t.length&&t.charAt(r+1)===i;)s++,r++;var a=1+(s&1),u=s<2?1:3+(s>>1),h="a",g=mM(e);for((g=="H"||g=="k")&&(u=0);u-- >0;)n+=h;for(;a-- >0;)n=g+n}else i==="J"?n+="H":n+=i}return n}function mM(t){var e=t.hourCycle;if(e===void 0&&t.hourCycles&&t.hourCycles.length&&(e=t.hourCycles[0]),e)switch(e){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n=t.language,r;n!=="root"&&(r=t.maximize().region);var i=$d[r||""]||$d[n||""]||$d["".concat(n,"-001")]||$d["001"];return i[0]}var Vm,_M=new RegExp("^".concat(vA.source,"*")),vM=new RegExp("".concat(vA.source,"*$"));function mt(t,e){return{start:t,end:e}}var yM=!!String.prototype.startsWith&&"_a".startsWith("a",1),wM=!!String.fromCodePoint,EM=!!Object.fromEntries,IM=!!String.prototype.codePointAt,TM=!!String.prototype.trimStart,SM=!!String.prototype.trimEnd,xM=!!Number.isSafeInteger,CM=xM?Number.isSafeInteger:function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<=9007199254740991},wv=!0;try{var AM=TA("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");wv=((Vm=AM.exec("a"))===null||Vm===void 0?void 0:Vm[0])==="a"}catch{wv=!1}var t1=yM?function(e,n,r){return e.startsWith(n,r)}:function(e,n,r){return e.slice(r,r+n.length)===n},Ev=wM?String.fromCodePoint:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r="",i=e.length,s=0,a;i>s;){if(a=e[s++],a>1114111)throw RangeError(a+" is not a valid code point");r+=a<65536?String.fromCharCode(a):String.fromCharCode(((a-=65536)>>10)+55296,a%1024+56320)}return r},n1=EM?Object.fromEntries:function(e){for(var n={},r=0,i=e;r<i.length;r++){var s=i[r],a=s[0],u=s[1];n[a]=u}return n},IA=IM?function(e,n){return e.codePointAt(n)}:function(e,n){var r=e.length;if(!(n<0||n>=r)){var i=e.charCodeAt(n),s;return i<55296||i>56319||n+1===r||(s=e.charCodeAt(n+1))<56320||s>57343?i:(i-55296<<10)+(s-56320)+65536}},bM=TM?function(e){return e.trimStart()}:function(e){return e.replace(_M,"")},PM=SM?function(e){return e.trimEnd()}:function(e){return e.replace(vM,"")};function TA(t,e){return new RegExp(t,e)}var Iv;if(wv){var r1=TA("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");Iv=function(e,n){var r;r1.lastIndex=n;var i=r1.exec(e);return(r=i[1])!==null&&r!==void 0?r:""}}else Iv=function(e,n){for(var r=[];;){var i=IA(e,n);if(i===void 0||SA(i)||DM(i))break;r.push(i),n+=i>=65536?2:1}return Ev.apply(void 0,r)};var RM=function(){function t(e,n){n===void 0&&(n={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!n.ignoreTag,this.locale=n.locale,this.requiresOtherClause=!!n.requiresOtherClause,this.shouldParseSkeletons=!!n.shouldParseSkeletons}return t.prototype.parse=function(){if(this.offset()!==0)throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},t.prototype.parseMessage=function(e,n,r){for(var i=[];!this.isEOF();){var s=this.char();if(s===123){var a=this.parseArgument(e,r);if(a.err)return a;i.push(a.val)}else{if(s===125&&e>0)break;if(s===35&&(n==="plural"||n==="selectordinal")){var u=this.clonePosition();this.bump(),i.push({type:Ut.pound,location:mt(u,this.clonePosition())})}else if(s===60&&!this.ignoreTag&&this.peek()===47){if(r)break;return this.error(gt.UNMATCHED_CLOSING_TAG,mt(this.clonePosition(),this.clonePosition()))}else if(s===60&&!this.ignoreTag&&Tv(this.peek()||0)){var a=this.parseTag(e,n);if(a.err)return a;i.push(a.val)}else{var a=this.parseLiteral(e,n);if(a.err)return a;i.push(a.val)}}}return{val:i,err:null}},t.prototype.parseTag=function(e,n){var r=this.clonePosition();this.bump();var i=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Ut.literal,value:"<".concat(i,"/>"),location:mt(r,this.clonePosition())},err:null};if(this.bumpIf(">")){var s=this.parseMessage(e+1,n,!0);if(s.err)return s;var a=s.val,u=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!Tv(this.char()))return this.error(gt.INVALID_TAG,mt(u,this.clonePosition()));var h=this.clonePosition(),g=this.parseTagName();return i!==g?this.error(gt.UNMATCHED_CLOSING_TAG,mt(h,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Ut.tag,value:i,children:a,location:mt(r,this.clonePosition())},err:null}:this.error(gt.INVALID_TAG,mt(u,this.clonePosition())))}else return this.error(gt.UNCLOSED_TAG,mt(r,this.clonePosition()))}else return this.error(gt.INVALID_TAG,mt(r,this.clonePosition()))},t.prototype.parseTagName=function(){var e=this.offset();for(this.bump();!this.isEOF()&&NM(this.char());)this.bump();return this.message.slice(e,this.offset())},t.prototype.parseLiteral=function(e,n){for(var r=this.clonePosition(),i="";;){var s=this.tryParseQuote(n);if(s){i+=s;continue}var a=this.tryParseUnquoted(e,n);if(a){i+=a;continue}var u=this.tryParseLeftAngleBracket();if(u){i+=u;continue}break}var h=mt(r,this.clonePosition());return{val:{type:Ut.literal,value:i,location:h},err:null}},t.prototype.tryParseLeftAngleBracket=function(){return!this.isEOF()&&this.char()===60&&(this.ignoreTag||!kM(this.peek()||0))?(this.bump(),"<"):null},t.prototype.tryParseQuote=function(e){if(this.isEOF()||this.char()!==39)return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if(e==="plural"||e==="selectordinal")break;return null;default:return null}this.bump();var n=[this.char()];for(this.bump();!this.isEOF();){var r=this.char();if(r===39)if(this.peek()===39)n.push(39),this.bump();else{this.bump();break}else n.push(r);this.bump()}return Ev.apply(void 0,n)},t.prototype.tryParseUnquoted=function(e,n){if(this.isEOF())return null;var r=this.char();return r===60||r===123||r===35&&(n==="plural"||n==="selectordinal")||r===125&&e>0?null:(this.bump(),Ev(r))},t.prototype.parseArgument=function(e,n){var r=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(gt.EXPECT_ARGUMENT_CLOSING_BRACE,mt(r,this.clonePosition()));if(this.char()===125)return this.bump(),this.error(gt.EMPTY_ARGUMENT,mt(r,this.clonePosition()));var i=this.parseIdentifierIfPossible().value;if(!i)return this.error(gt.MALFORMED_ARGUMENT,mt(r,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(gt.EXPECT_ARGUMENT_CLOSING_BRACE,mt(r,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Ut.argument,value:i,location:mt(r,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(gt.EXPECT_ARGUMENT_CLOSING_BRACE,mt(r,this.clonePosition())):this.parseArgumentOptions(e,n,i,r);default:return this.error(gt.MALFORMED_ARGUMENT,mt(r,this.clonePosition()))}},t.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),n=this.offset(),r=Iv(this.message,n),i=n+r.length;this.bumpTo(i);var s=this.clonePosition(),a=mt(e,s);return{value:r,location:a}},t.prototype.parseArgumentOptions=function(e,n,r,i){var s,a=this.clonePosition(),u=this.parseIdentifierIfPossible().value,h=this.clonePosition();switch(u){case"":return this.error(gt.EXPECT_ARGUMENT_TYPE,mt(a,h));case"number":case"date":case"time":{this.bumpSpace();var g=null;if(this.bumpIf(",")){this.bumpSpace();var m=this.clonePosition(),w=this.parseSimpleArgStyleIfPossible();if(w.err)return w;var T=PM(w.val);if(T.length===0)return this.error(gt.EXPECT_ARGUMENT_STYLE,mt(this.clonePosition(),this.clonePosition()));var I=mt(m,this.clonePosition());g={style:T,styleLocation:I}}var j=this.tryParseArgumentClose(i);if(j.err)return j;var z=mt(i,this.clonePosition());if(g&&t1(g==null?void 0:g.style,"::",0)){var X=bM(g.style.slice(2));if(u==="number"){var w=this.parseNumberSkeletonFromString(X,g.styleLocation);return w.err?w:{val:{type:Ut.number,value:r,location:z,style:w.val},err:null}}else{if(X.length===0)return this.error(gt.EXPECT_DATE_TIME_SKELETON,z);var V=X;this.locale&&(V=pM(X,this.locale));var T={type:su.dateTime,pattern:V,location:g.styleLocation,parsedOptions:this.shouldParseSkeletons?lM(V):{}},B=u==="date"?Ut.date:Ut.time;return{val:{type:B,value:r,location:z,style:T},err:null}}}return{val:{type:u==="number"?Ut.number:u==="date"?Ut.date:Ut.time,value:r,location:z,style:(s=g==null?void 0:g.style)!==null&&s!==void 0?s:null},err:null}}case"plural":case"selectordinal":case"select":{var U=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(gt.EXPECT_SELECT_ARGUMENT_OPTIONS,mt(U,Be({},U)));this.bumpSpace();var J=this.parseIdentifierIfPossible(),re=0;if(u!=="select"&&J.value==="offset"){if(!this.bumpIf(":"))return this.error(gt.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,mt(this.clonePosition(),this.clonePosition()));this.bumpSpace();var w=this.tryParseDecimalInteger(gt.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,gt.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(w.err)return w;this.bumpSpace(),J=this.parseIdentifierIfPossible(),re=w.val}var te=this.tryParsePluralOrSelectOptions(e,u,n,J);if(te.err)return te;var j=this.tryParseArgumentClose(i);if(j.err)return j;var ae=mt(i,this.clonePosition());return u==="select"?{val:{type:Ut.select,value:r,options:n1(te.val),location:ae},err:null}:{val:{type:Ut.plural,value:r,options:n1(te.val),offset:re,pluralType:u==="plural"?"cardinal":"ordinal",location:ae},err:null}}default:return this.error(gt.INVALID_ARGUMENT_TYPE,mt(a,h))}},t.prototype.tryParseArgumentClose=function(e){return this.isEOF()||this.char()!==125?this.error(gt.EXPECT_ARGUMENT_CLOSING_BRACE,mt(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},t.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,n=this.clonePosition();!this.isEOF();){var r=this.char();switch(r){case 39:{this.bump();var i=this.clonePosition();if(!this.bumpUntil("'"))return this.error(gt.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,mt(i,this.clonePosition()));this.bump();break}case 123:{e+=1,this.bump();break}case 125:{if(e>0)e-=1;else return{val:this.message.slice(n.offset,this.offset()),err:null};break}default:this.bump();break}}return{val:this.message.slice(n.offset,this.offset()),err:null}},t.prototype.parseNumberSkeletonFromString=function(e,n){var r=[];try{r=cM(e)}catch{return this.error(gt.INVALID_NUMBER_SKELETON,n)}return{val:{type:su.number,tokens:r,location:n,parsedOptions:this.shouldParseSkeletons?gM(r):{}},err:null}},t.prototype.tryParsePluralOrSelectOptions=function(e,n,r,i){for(var s,a=!1,u=[],h=new Set,g=i.value,m=i.location;;){if(g.length===0){var w=this.clonePosition();if(n!=="select"&&this.bumpIf("=")){var T=this.tryParseDecimalInteger(gt.EXPECT_PLURAL_ARGUMENT_SELECTOR,gt.INVALID_PLURAL_ARGUMENT_SELECTOR);if(T.err)return T;m=mt(w,this.clonePosition()),g=this.message.slice(w.offset,this.offset())}else break}if(h.has(g))return this.error(n==="select"?gt.DUPLICATE_SELECT_ARGUMENT_SELECTOR:gt.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,m);g==="other"&&(a=!0),this.bumpSpace();var I=this.clonePosition();if(!this.bumpIf("{"))return this.error(n==="select"?gt.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:gt.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,mt(this.clonePosition(),this.clonePosition()));var j=this.parseMessage(e+1,n,r);if(j.err)return j;var z=this.tryParseArgumentClose(I);if(z.err)return z;u.push([g,{value:j.val,location:mt(I,this.clonePosition())}]),h.add(g),this.bumpSpace(),s=this.parseIdentifierIfPossible(),g=s.value,m=s.location}return u.length===0?this.error(n==="select"?gt.EXPECT_SELECT_ARGUMENT_SELECTOR:gt.EXPECT_PLURAL_ARGUMENT_SELECTOR,mt(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!a?this.error(gt.MISSING_OTHER_CLAUSE,mt(this.clonePosition(),this.clonePosition())):{val:u,err:null}},t.prototype.tryParseDecimalInteger=function(e,n){var r=1,i=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(r=-1);for(var s=!1,a=0;!this.isEOF();){var u=this.char();if(u>=48&&u<=57)s=!0,a=a*10+(u-48),this.bump();else break}var h=mt(i,this.clonePosition());return s?(a*=r,CM(a)?{val:a,err:null}:this.error(n,h)):this.error(e,h)},t.prototype.offset=function(){return this.position.offset},t.prototype.isEOF=function(){return this.offset()===this.message.length},t.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},t.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var n=IA(this.message,e);if(n===void 0)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return n},t.prototype.error=function(e,n){return{val:null,err:{kind:e,message:this.message,location:n}}},t.prototype.bump=function(){if(!this.isEOF()){var e=this.char();e===10?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},t.prototype.bumpIf=function(e){if(t1(this.message,e,this.offset())){for(var n=0;n<e.length;n++)this.bump();return!0}return!1},t.prototype.bumpUntil=function(e){var n=this.offset(),r=this.message.indexOf(e,n);return r>=0?(this.bumpTo(r),!0):(this.bumpTo(this.message.length),!1)},t.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var n=this.offset();if(n===e)break;if(n>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},t.prototype.bumpSpace=function(){for(;!this.isEOF()&&SA(this.char());)this.bump()},t.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),n=this.offset(),r=this.message.charCodeAt(n+(e>=65536?2:1));return r??null},t}();function Tv(t){return t>=97&&t<=122||t>=65&&t<=90}function kM(t){return Tv(t)||t===47}function NM(t){return t===45||t===46||t>=48&&t<=57||t===95||t>=97&&t<=122||t>=65&&t<=90||t==183||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function SA(t){return t>=9&&t<=13||t===32||t===133||t>=8206&&t<=8207||t===8232||t===8233}function DM(t){return t>=33&&t<=35||t===36||t>=37&&t<=39||t===40||t===41||t===42||t===43||t===44||t===45||t>=46&&t<=47||t>=58&&t<=59||t>=60&&t<=62||t>=63&&t<=64||t===91||t===92||t===93||t===94||t===96||t===123||t===124||t===125||t===126||t===161||t>=162&&t<=165||t===166||t===167||t===169||t===171||t===172||t===174||t===176||t===177||t===182||t===187||t===191||t===215||t===247||t>=8208&&t<=8213||t>=8214&&t<=8215||t===8216||t===8217||t===8218||t>=8219&&t<=8220||t===8221||t===8222||t===8223||t>=8224&&t<=8231||t>=8240&&t<=8248||t===8249||t===8250||t>=8251&&t<=8254||t>=8257&&t<=8259||t===8260||t===8261||t===8262||t>=8263&&t<=8273||t===8274||t===8275||t>=8277&&t<=8286||t>=8592&&t<=8596||t>=8597&&t<=8601||t>=8602&&t<=8603||t>=8604&&t<=8607||t===8608||t>=8609&&t<=8610||t===8611||t>=8612&&t<=8613||t===8614||t>=8615&&t<=8621||t===8622||t>=8623&&t<=8653||t>=8654&&t<=8655||t>=8656&&t<=8657||t===8658||t===8659||t===8660||t>=8661&&t<=8691||t>=8692&&t<=8959||t>=8960&&t<=8967||t===8968||t===8969||t===8970||t===8971||t>=8972&&t<=8991||t>=8992&&t<=8993||t>=8994&&t<=9e3||t===9001||t===9002||t>=9003&&t<=9083||t===9084||t>=9085&&t<=9114||t>=9115&&t<=9139||t>=9140&&t<=9179||t>=9180&&t<=9185||t>=9186&&t<=9254||t>=9255&&t<=9279||t>=9280&&t<=9290||t>=9291&&t<=9311||t>=9472&&t<=9654||t===9655||t>=9656&&t<=9664||t===9665||t>=9666&&t<=9719||t>=9720&&t<=9727||t>=9728&&t<=9838||t===9839||t>=9840&&t<=10087||t===10088||t===10089||t===10090||t===10091||t===10092||t===10093||t===10094||t===10095||t===10096||t===10097||t===10098||t===10099||t===10100||t===10101||t>=10132&&t<=10175||t>=10176&&t<=10180||t===10181||t===10182||t>=10183&&t<=10213||t===10214||t===10215||t===10216||t===10217||t===10218||t===10219||t===10220||t===10221||t===10222||t===10223||t>=10224&&t<=10239||t>=10240&&t<=10495||t>=10496&&t<=10626||t===10627||t===10628||t===10629||t===10630||t===10631||t===10632||t===10633||t===10634||t===10635||t===10636||t===10637||t===10638||t===10639||t===10640||t===10641||t===10642||t===10643||t===10644||t===10645||t===10646||t===10647||t===10648||t>=10649&&t<=10711||t===10712||t===10713||t===10714||t===10715||t>=10716&&t<=10747||t===10748||t===10749||t>=10750&&t<=11007||t>=11008&&t<=11055||t>=11056&&t<=11076||t>=11077&&t<=11078||t>=11079&&t<=11084||t>=11085&&t<=11123||t>=11124&&t<=11125||t>=11126&&t<=11157||t===11158||t>=11159&&t<=11263||t>=11776&&t<=11777||t===11778||t===11779||t===11780||t===11781||t>=11782&&t<=11784||t===11785||t===11786||t===11787||t===11788||t===11789||t>=11790&&t<=11798||t===11799||t>=11800&&t<=11801||t===11802||t===11803||t===11804||t===11805||t>=11806&&t<=11807||t===11808||t===11809||t===11810||t===11811||t===11812||t===11813||t===11814||t===11815||t===11816||t===11817||t>=11818&&t<=11822||t===11823||t>=11824&&t<=11833||t>=11834&&t<=11835||t>=11836&&t<=11839||t===11840||t===11841||t===11842||t>=11843&&t<=11855||t>=11856&&t<=11857||t===11858||t>=11859&&t<=11903||t>=12289&&t<=12291||t===12296||t===12297||t===12298||t===12299||t===12300||t===12301||t===12302||t===12303||t===12304||t===12305||t>=12306&&t<=12307||t===12308||t===12309||t===12310||t===12311||t===12312||t===12313||t===12314||t===12315||t===12316||t===12317||t>=12318&&t<=12319||t===12320||t===12336||t===64830||t===64831||t>=65093&&t<=65094}function Sv(t){t.forEach(function(e){if(delete e.location,gA(e)||pA(e))for(var n in e.options)delete e.options[n].location,Sv(e.options[n].value);else hA(e)&&_A(e.style)||(dA(e)||fA(e))&&yv(e.style)?delete e.style.location:mA(e)&&Sv(e.children)})}function OM(t,e){e===void 0&&(e={}),e=Be({shouldParseSkeletons:!0,requiresOtherClause:!0},e);var n=new RM(t,e).parse();if(n.err){var r=SyntaxError(gt[n.err.kind]);throw r.location=n.err.location,r.originalMessage=n.err.message,r}return e!=null&&e.captureLocation||Sv(n.val),n.val}function Vi(t,e){var n=e&&e.cache?e.cache:UM,r=e&&e.serializer?e.serializer:BM,i=e&&e.strategy?e.strategy:LM;return i(t,{cache:n,serializer:r})}function MM(t){return t==null||typeof t=="number"||typeof t=="boolean"}function xA(t,e,n,r){var i=MM(r)?r:n(r),s=e.get(i);return typeof s>"u"&&(s=t.call(this,r),e.set(i,s)),s}function CA(t,e,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),s=e.get(i);return typeof s>"u"&&(s=t.apply(this,r),e.set(i,s)),s}function A0(t,e,n,r,i){return n.bind(e,t,r,i)}function LM(t,e){var n=t.length===1?xA:CA;return A0(t,this,n,e.cache.create(),e.serializer)}function VM(t,e){return A0(t,this,CA,e.cache.create(),e.serializer)}function FM(t,e){return A0(t,this,xA,e.cache.create(),e.serializer)}var BM=function(){return JSON.stringify(arguments)};function b0(){this.cache=Object.create(null)}b0.prototype.get=function(t){return this.cache[t]};b0.prototype.set=function(t,e){this.cache[t]=e};var UM={create:function(){return new b0}},Fi={variadic:VM,monadic:FM},ns;(function(t){t.MISSING_VALUE="MISSING_VALUE",t.INVALID_VALUE="INVALID_VALUE",t.MISSING_INTL_API="MISSING_INTL_API"})(ns||(ns={}));var Bo=function(t){di(e,t);function e(n,r,i){var s=t.call(this,n)||this;return s.code=r,s.originalMessage=i,s}return e.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},e}(Error),i1=function(t){di(e,t);function e(n,r,i,s){return t.call(this,'Invalid values for "'.concat(n,'": "').concat(r,'". Options are "').concat(Object.keys(i).join('", "'),'"'),ns.INVALID_VALUE,s)||this}return e}(Bo),jM=function(t){di(e,t);function e(n,r,i){return t.call(this,'Value for "'.concat(n,'" must be of type ').concat(r),ns.INVALID_VALUE,i)||this}return e}(Bo),zM=function(t){di(e,t);function e(n,r){return t.call(this,'The intl string context variable "'.concat(n,'" was not provided to the string "').concat(r,'"'),ns.MISSING_VALUE,r)||this}return e}(Bo),lr;(function(t){t[t.literal=0]="literal",t[t.object=1]="object"})(lr||(lr={}));function $M(t){return t.length<2?t:t.reduce(function(e,n){var r=e[e.length-1];return!r||r.type!==lr.literal||n.type!==lr.literal?e.push(n):r.value+=n.value,e},[])}function AA(t){return typeof t=="function"}function yf(t,e,n,r,i,s,a){if(t.length===1&&XI(t[0]))return[{type:lr.literal,value:t[0].value}];for(var u=[],h=0,g=t;h<g.length;h++){var m=g[h];if(XI(m)){u.push({type:lr.literal,value:m.value});continue}if(oM(m)){typeof s=="number"&&u.push({type:lr.literal,value:n.getNumberFormat(e).format(s)});continue}var w=m.value;if(!(i&&w in i))throw new zM(w,a);var T=i[w];if(sM(m)){(!T||typeof T=="string"||typeof T=="number")&&(T=typeof T=="string"||typeof T=="number"?String(T):""),u.push({type:typeof T=="string"?lr.literal:lr.object,value:T});continue}if(dA(m)){var I=typeof m.style=="string"?r.date[m.style]:yv(m.style)?m.style.parsedOptions:void 0;u.push({type:lr.literal,value:n.getDateTimeFormat(e,I).format(T)});continue}if(fA(m)){var I=typeof m.style=="string"?r.time[m.style]:yv(m.style)?m.style.parsedOptions:r.time.medium;u.push({type:lr.literal,value:n.getDateTimeFormat(e,I).format(T)});continue}if(hA(m)){var I=typeof m.style=="string"?r.number[m.style]:_A(m.style)?m.style.parsedOptions:void 0;I&&I.scale&&(T=T*(I.scale||1)),u.push({type:lr.literal,value:n.getNumberFormat(e,I).format(T)});continue}if(mA(m)){var j=m.children,z=m.value,X=i[z];if(!AA(X))throw new jM(z,"function",a);var V=yf(j,e,n,r,i,s),B=X(V.map(function(re){return re.value}));Array.isArray(B)||(B=[B]),u.push.apply(u,B.map(function(re){return{type:typeof re=="string"?lr.literal:lr.object,value:re}}))}if(gA(m)){var U=m.options[T]||m.options.other;if(!U)throw new i1(m.value,T,Object.keys(m.options),a);u.push.apply(u,yf(U.value,e,n,r,i));continue}if(pA(m)){var U=m.options["=".concat(T)];if(!U){if(!Intl.PluralRules)throw new Bo(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ns.MISSING_INTL_API,a);var J=n.getPluralRules(e,{type:m.pluralType}).select(T-(m.offset||0));U=m.options[J]||m.options.other}if(!U)throw new i1(m.value,T,Object.keys(m.options),a);u.push.apply(u,yf(U.value,e,n,r,i,T-(m.offset||0)));continue}}return $M(u)}function qM(t,e){return e?Be(Be(Be({},t||{}),e||{}),Object.keys(t).reduce(function(n,r){return n[r]=Be(Be({},t[r]),e[r]||{}),n},{})):t}function HM(t,e){return e?Object.keys(t).reduce(function(n,r){return n[r]=qM(t[r],e[r]),n},Be({},t)):t}function Fm(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}function GM(t){return t===void 0&&(t={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Vi(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.NumberFormat).bind.apply(e,Bi([void 0],n,!1)))},{cache:Fm(t.number),strategy:Fi.variadic}),getDateTimeFormat:Vi(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.DateTimeFormat).bind.apply(e,Bi([void 0],n,!1)))},{cache:Fm(t.dateTime),strategy:Fi.variadic}),getPluralRules:Vi(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.PluralRules).bind.apply(e,Bi([void 0],n,!1)))},{cache:Fm(t.pluralRules),strategy:Fi.variadic})}}var bA=function(){function t(e,n,r,i){var s=this;if(n===void 0&&(n=t.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(h){var g=s.formatToParts(h);if(g.length===1)return g[0].value;var m=g.reduce(function(w,T){return!w.length||T.type!==lr.literal||typeof w[w.length-1]!="string"?w.push(T.value):w[w.length-1]+=T.value,w},[]);return m.length<=1?m[0]||"":m},this.formatToParts=function(h){return yf(s.ast,s.locales,s.formatters,s.formats,h,void 0,s.message)},this.resolvedOptions=function(){var h;return{locale:((h=s.resolvedLocale)===null||h===void 0?void 0:h.toString())||Intl.NumberFormat.supportedLocalesOf(s.locales)[0]}},this.getAst=function(){return s.ast},this.locales=n,this.resolvedLocale=t.resolveLocale(n),typeof e=="string"){if(this.message=e,!t.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var a=i||{};a.formatters;var u=ks(a,["formatters"]);this.ast=t.__parse(e,Be(Be({},u),{locale:this.resolvedLocale}))}else this.ast=e;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=HM(t.formats,r),this.formatters=i&&i.formatters||GM(this.formatterCache)}return Object.defineProperty(t,"defaultLocale",{get:function(){return t.memoizedDefaultLocale||(t.memoizedDefaultLocale=new Intl.NumberFormat().resolvedOptions().locale),t.memoizedDefaultLocale},enumerable:!1,configurable:!0}),t.memoizedDefaultLocale=null,t.resolveLocale=function(e){if(!(typeof Intl.Locale>"u")){var n=Intl.NumberFormat.supportedLocalesOf(e);return n.length>0?new Intl.Locale(n[0]):new Intl.Locale(typeof e=="string"?e:e[0])}},t.__parse=OM,t.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},t}(),Da;(function(t){t.FORMAT_ERROR="FORMAT_ERROR",t.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",t.INVALID_CONFIG="INVALID_CONFIG",t.MISSING_DATA="MISSING_DATA",t.MISSING_TRANSLATION="MISSING_TRANSLATION"})(Da||(Da={}));var qh=function(t){di(e,t);function e(n,r,i){var s=this,a=i?i instanceof Error?i:new Error(String(i)):void 0;return s=t.call(this,"[@formatjs/intl Error ".concat(n,"] ").concat(r,`
`).concat(a?`
`.concat(a.message,`
`).concat(a.stack):""))||this,s.code=n,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(s,e),s}return e}(Error),WM=function(t){di(e,t);function e(n,r){return t.call(this,Da.UNSUPPORTED_FORMATTER,n,r)||this}return e}(qh),KM=function(t){di(e,t);function e(n,r){return t.call(this,Da.INVALID_CONFIG,n,r)||this}return e}(qh),s1=function(t){di(e,t);function e(n,r){return t.call(this,Da.MISSING_DATA,n,r)||this}return e}(qh),fi=function(t){di(e,t);function e(n,r,i){var s=t.call(this,Da.FORMAT_ERROR,"".concat(n,`
Locale: `).concat(r,`
`),i)||this;return s.locale=r,s}return e}(qh),Bm=function(t){di(e,t);function e(n,r,i,s){var a=t.call(this,"".concat(n,`
MessageID: `).concat(i==null?void 0:i.id,`
Default Message: `).concat(i==null?void 0:i.defaultMessage,`
Description: `).concat(i==null?void 0:i.description,`
`),r,s)||this;return a.descriptor=i,a.locale=r,a}return e}(fi),QM=function(t){di(e,t);function e(n,r){var i=t.call(this,Da.MISSING_TRANSLATION,'Missing message: "'.concat(n.id,'" for locale "').concat(r,'", using ').concat(n.defaultMessage?"default message (".concat(typeof n.defaultMessage=="string"?n.defaultMessage:n.defaultMessage.map(function(s){var a;return(a=s.value)!==null&&a!==void 0?a:JSON.stringify(s)}).join(),")"):"id"," as fallback."))||this;return i.descriptor=n,i}return e}(qh);function Qa(t,e,n){return n===void 0&&(n={}),e.reduce(function(r,i){return i in t?r[i]=t[i]:i in n&&(r[i]=n[i]),r},{})}var YM=function(t){},XM=function(t){},PA={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:YM,onWarn:XM};function RA(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function ea(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}function JM(t){t===void 0&&(t=RA());var e=Intl.RelativeTimeFormat,n=Intl.ListFormat,r=Intl.DisplayNames,i=Vi(function(){for(var u,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((u=Intl.DateTimeFormat).bind.apply(u,Bi([void 0],h,!1)))},{cache:ea(t.dateTime),strategy:Fi.variadic}),s=Vi(function(){for(var u,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((u=Intl.NumberFormat).bind.apply(u,Bi([void 0],h,!1)))},{cache:ea(t.number),strategy:Fi.variadic}),a=Vi(function(){for(var u,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((u=Intl.PluralRules).bind.apply(u,Bi([void 0],h,!1)))},{cache:ea(t.pluralRules),strategy:Fi.variadic});return{getDateTimeFormat:i,getNumberFormat:s,getMessageFormat:Vi(function(u,h,g,m){return new bA(u,h,g,Be({formatters:{getNumberFormat:s,getDateTimeFormat:i,getPluralRules:a}},m||{}))},{cache:ea(t.message),strategy:Fi.variadic}),getRelativeTimeFormat:Vi(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return new(e.bind.apply(e,Bi([void 0],u,!1)))},{cache:ea(t.relativeTime),strategy:Fi.variadic}),getPluralRules:a,getListFormat:Vi(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return new(n.bind.apply(n,Bi([void 0],u,!1)))},{cache:ea(t.list),strategy:Fi.variadic}),getDisplayNames:Vi(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return new(r.bind.apply(r,Bi([void 0],u,!1)))},{cache:ea(t.displayNames),strategy:Fi.variadic})}}function P0(t,e,n,r){var i=t&&t[e],s;if(i&&(s=i[n]),s)return s;r(new WM("No ".concat(e," format named: ").concat(n)))}function qd(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=Be({timeZone:e},t[r]),n},{})}function o1(t,e){var n=Object.keys(Be(Be({},t),e));return n.reduce(function(r,i){return r[i]=Be(Be({},t[i]||{}),e[i]||{}),r},{})}function a1(t,e){if(!e)return t;var n=bA.formats;return Be(Be(Be({},n),t),{date:o1(qd(n.date,e),qd(t.date||{},e)),time:o1(qd(n.time,e),qd(t.time||{},e))})}var xv=function(t,e,n,r,i){var s=t.locale,a=t.formats,u=t.messages,h=t.defaultLocale,g=t.defaultFormats,m=t.fallbackOnEmptyString,w=t.onError,T=t.timeZone,I=t.defaultRichTextElements;n===void 0&&(n={id:""});var j=n.id,z=n.defaultMessage;cA(!!j,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var X=String(j),V=u&&Object.prototype.hasOwnProperty.call(u,X)&&u[X];if(Array.isArray(V)&&V.length===1&&V[0].type===Ut.literal)return V[0].value;if(!r&&V&&typeof V=="string"&&!I)return V.replace(/'\{(.*?)\}'/gi,"{$1}");if(r=Be(Be({},I),r||{}),a=a1(a,T),g=a1(g,T),!V){if(m===!1&&V==="")return V;if((!z||s&&s.toLowerCase()!==h.toLowerCase())&&w(new QM(n,s)),z)try{var B=e.getMessageFormat(z,h,g,i);return B.format(r)}catch(U){return w(new Bm('Error formatting default message for: "'.concat(X,'", rendering default message verbatim'),s,n,U)),typeof z=="string"?z:X}return X}try{var B=e.getMessageFormat(V,s,a,Be({formatters:e},i||{}));return B.format(r)}catch(U){w(new Bm('Error formatting message: "'.concat(X,'", using ').concat(z?"default message":"id"," as fallback."),s,n,U))}if(z)try{var B=e.getMessageFormat(z,h,g,i);return B.format(r)}catch(U){w(new Bm('Error formatting the default message for: "'.concat(X,'", rendering message verbatim'),s,n,U))}return typeof V=="string"?V:typeof z=="string"?z:X},kA=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function dp(t,e,n,r){var i=t.locale,s=t.formats,a=t.onError,u=t.timeZone;r===void 0&&(r={});var h=r.format,g=Be(Be({},u&&{timeZone:u}),h&&P0(s,e,h,a)),m=Qa(r,kA,g);return e==="time"&&!m.hour&&!m.minute&&!m.second&&!m.timeStyle&&!m.dateStyle&&(m=Be(Be({},m),{hour:"numeric",minute:"numeric"})),n(i,m)}function ZM(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return dp(t,"date",e,a).format(u)}catch(h){t.onError(new fi("Error formatting date.",t.locale,h))}return String(u)}function eL(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return dp(t,"time",e,a).format(u)}catch(h){t.onError(new fi("Error formatting time.",t.locale,h))}return String(u)}function tL(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=n[2],u=a===void 0?{}:a,h=t.timeZone,g=t.locale,m=t.onError,w=Qa(u,kA,h?{timeZone:h}:{});try{return e(g,w).formatRange(i,s)}catch(T){m(new fi("Error formatting date time range.",t.locale,T))}return String(i)}function nL(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return dp(t,"date",e,a).formatToParts(u)}catch(h){t.onError(new fi("Error formatting date.",t.locale,h))}return[]}function rL(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return dp(t,"time",e,a).formatToParts(u)}catch(h){t.onError(new fi("Error formatting time.",t.locale,h))}return[]}var iL=["style","type","fallback","languageDisplay"];function sL(t,e,n,r){var i=t.locale,s=t.onError,a=Intl.DisplayNames;a||s(new Bo(`Intl.DisplayNames is not available in this environment.
Try polyfilling it using "@formatjs/intl-displaynames"
`,ns.MISSING_INTL_API));var u=Qa(r,iL);try{return e(i,u).of(n)}catch(h){s(new fi("Error formatting display name.",i,h))}}var oL=["type","style"],l1=Date.now();function aL(t){return"".concat(l1,"_").concat(t,"_").concat(l1)}function lL(t,e,n,r){r===void 0&&(r={});var i=NA(t,e,n,r).reduce(function(s,a){var u=a.value;return typeof u!="string"?s.push(u):typeof s[s.length-1]=="string"?s[s.length-1]+=u:s.push(u),s},[]);return i.length===1?i[0]:i.length===0?"":i}function NA(t,e,n,r){var i=t.locale,s=t.onError;r===void 0&&(r={});var a=Intl.ListFormat;a||s(new Bo(`Intl.ListFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-listformat"
`,ns.MISSING_INTL_API));var u=Qa(r,oL);try{var h={},g=n.map(function(m,w){if(typeof m=="object"){var T=aL(w);return h[T]=m,T}return String(m)});return e(i,u).formatToParts(g).map(function(m){return m.type==="literal"?m:Be(Be({},m),{value:h[m.value]||m.value})})}catch(m){s(new fi("Error formatting list.",i,m))}return n}var uL=["type"];function cL(t,e,n,r){var i=t.locale,s=t.onError;r===void 0&&(r={}),Intl.PluralRules||s(new Bo(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ns.MISSING_INTL_API));var a=Qa(r,uL);try{return e(i,a).select(n)}catch(u){s(new fi("Error formatting plural.",i,u))}return"other"}var hL=["numeric","style"];function dL(t,e,n){var r=t.locale,i=t.formats,s=t.onError;n===void 0&&(n={});var a=n.format,u=!!a&&P0(i,"relative",a,s)||{},h=Qa(n,hL,u);return e(r,h)}function fL(t,e,n,r,i){i===void 0&&(i={}),r||(r="second");var s=Intl.RelativeTimeFormat;s||t.onError(new Bo(`Intl.RelativeTimeFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-relativetimeformat"
`,ns.MISSING_INTL_API));try{return dL(t,e,i).format(n,r)}catch(a){t.onError(new fi("Error formatting relative time.",t.locale,a))}return String(n)}var gL=["style","currency","currencyDisplay","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem"];function DA(t,e,n){var r=t.locale,i=t.formats,s=t.onError;n===void 0&&(n={});var a=n.format,u=a&&P0(i,"number",a,s)||{},h=Qa(n,gL,u);return e(r,h)}function pL(t,e,n,r){r===void 0&&(r={});try{return DA(t,e,r).format(n)}catch(i){t.onError(new fi("Error formatting number.",t.locale,i))}return String(n)}function mL(t,e,n,r){r===void 0&&(r={});try{return DA(t,e,r).formatToParts(n)}catch(i){t.onError(new fi("Error formatting number.",t.locale,i))}return[]}function _L(t){var e=t?t[Object.keys(t)[0]]:void 0;return typeof e=="string"}function vL(t){t.onWarn&&t.defaultRichTextElements&&_L(t.messages||{})&&t.onWarn(`[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. 
Please consider using "@formatjs/cli" to pre-compile your messages for performance.
For more details see https://formatjs.io/docs/getting-started/message-distribution`)}function yL(t,e){var n=JM(e),r=Be(Be({},PA),t),i=r.locale,s=r.defaultLocale,a=r.onError;return i?!Intl.NumberFormat.supportedLocalesOf(i).length&&a?a(new s1('Missing locale data for locale: "'.concat(i,'" in Intl.NumberFormat. Using default locale: "').concat(s,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(i).length&&a&&a(new s1('Missing locale data for locale: "'.concat(i,'" in Intl.DateTimeFormat. Using default locale: "').concat(s,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(a&&a(new KM('"locale" was not configured, using "'.concat(s,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),r.locale=r.defaultLocale||"en"),vL(r),Be(Be({},r),{formatters:n,formatNumber:pL.bind(null,r,n.getNumberFormat),formatNumberToParts:mL.bind(null,r,n.getNumberFormat),formatRelativeTime:fL.bind(null,r,n.getRelativeTimeFormat),formatDate:ZM.bind(null,r,n.getDateTimeFormat),formatDateToParts:nL.bind(null,r,n.getDateTimeFormat),formatTime:eL.bind(null,r,n.getDateTimeFormat),formatDateTimeRange:tL.bind(null,r,n.getDateTimeFormat),formatTimeToParts:rL.bind(null,r,n.getDateTimeFormat),formatPlural:cL.bind(null,r,n.getPluralRules),formatMessage:xv.bind(null,r,n),$t:xv.bind(null,r,n),formatList:lL.bind(null,r,n.getListFormat),formatListToParts:NA.bind(null,r,n.getListFormat),formatDisplayName:sL.bind(null,r,n.getDisplayNames)})}function OA(t){cA(t,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var MA=Be(Be({},PA),{textComponent:G.Fragment});function wL(t){return function(e){return t(G.Children.toArray(e))}}function Cv(t,e){if(t===e)return!0;if(!t||!e)return!1;var n=Object.keys(t),r=Object.keys(e),i=n.length;if(r.length!==i)return!1;for(var s=0;s<i;s++){var a=n[s];if(t[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}var R0=typeof window<"u"&&!window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=G.createContext(null)):G.createContext(null);R0.Consumer;var EL=R0.Provider,IL=EL,TL=R0;function nn(){var t=G.useContext(TL);return OA(t),t}var Av;(function(t){t.formatDate="FormattedDate",t.formatTime="FormattedTime",t.formatNumber="FormattedNumber",t.formatList="FormattedList",t.formatDisplayName="FormattedDisplayName"})(Av||(Av={}));var bv;(function(t){t.formatDate="FormattedDateParts",t.formatTime="FormattedTimeParts",t.formatNumber="FormattedNumberParts",t.formatList="FormattedListParts"})(bv||(bv={}));function LA(t){var e=function(n){var r=nn(),i=n.value,s=n.children,a=ks(n,["value","children"]),u=typeof i=="string"?new Date(i||0):i,h=t==="formatDate"?r.formatDateToParts(u,a):r.formatTimeToParts(u,a);return s(h)};return e.displayName=bv[t],e}function Hh(t){var e=function(n){var r=nn(),i=n.value,s=n.children,a=ks(n,["value","children"]),u=r[t](i,a);if(typeof s=="function")return s(u);var h=r.textComponent||G.Fragment;return G.createElement(h,null,u)};return e.displayName=Av[t],e}function Um(t){return{locale:t.locale,timeZone:t.timeZone,fallbackOnEmptyString:t.fallbackOnEmptyString,formats:t.formats,textComponent:t.textComponent,messages:t.messages,defaultLocale:t.defaultLocale,defaultFormats:t.defaultFormats,onError:t.onError,onWarn:t.onWarn,wrapRichTextChunksInFragment:t.wrapRichTextChunksInFragment,defaultRichTextElements:t.defaultRichTextElements}}function VA(t){return t&&Object.keys(t).reduce(function(e,n){var r=t[n];return e[n]=AA(r)?wL(r):r,e},{})}var u1=function(t,e,n,r){for(var i=[],s=4;s<arguments.length;s++)i[s-4]=arguments[s];var a=VA(r),u=xv.apply(void 0,Bi([t,e,n,a],i,!1));return Array.isArray(u)?G.Children.toArray(u):u},c1=function(t,e){var n=t.defaultRichTextElements,r=ks(t,["defaultRichTextElements"]),i=VA(n),s=yL(Be(Be(Be({},MA),r),{defaultRichTextElements:i}),e),a={locale:s.locale,timeZone:s.timeZone,fallbackOnEmptyString:s.fallbackOnEmptyString,formats:s.formats,defaultLocale:s.defaultLocale,defaultFormats:s.defaultFormats,messages:s.messages,onError:s.onError,defaultRichTextElements:i};return Be(Be({},s),{formatMessage:u1.bind(null,a,s.formatters),$t:u1.bind(null,a,s.formatters)})},SL=function(t){di(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.cache=RA(),n.state={cache:n.cache,intl:c1(Um(n.props),n.cache),prevConfig:Um(n.props)},n}return e.getDerivedStateFromProps=function(n,r){var i=r.prevConfig,s=r.cache,a=Um(n);return Cv(i,a)?null:{intl:c1(a,s),prevConfig:a}},e.prototype.render=function(){return OA(this.state.intl),G.createElement(IL,{value:this.state.intl},this.props.children)},e.displayName="IntlProvider",e.defaultProps=MA,e}(G.PureComponent);const xL=SL;function CL(t,e){var n=t.values,r=ks(t,["values"]),i=e.values,s=ks(e,["values"]);return Cv(i,n)&&Cv(r,s)}function FA(t){var e=nn(),n=e.formatMessage,r=e.textComponent,i=r===void 0?G.Fragment:r,s=t.id,a=t.description,u=t.defaultMessage,h=t.values,g=t.children,m=t.tagName,w=m===void 0?i:m,T=t.ignoreTag,I={id:s,description:a,defaultMessage:u},j=n(I,h,{ignoreTag:T});return typeof g=="function"?g(Array.isArray(j)?j:[j]):w?G.createElement(w,null,G.Children.toArray(j)):G.createElement(G.Fragment,null,j)}FA.displayName="FormattedMessage";var BA=G.memo(FA,CL);BA.displayName="MemoizedFormattedMessage";const xt=BA;Hh("formatDate");Hh("formatTime");Hh("formatNumber");Hh("formatList");Hh("formatDisplayName");LA("formatDate");LA("formatTime");const fe=Bh("div",({css:t,...e})=>({css:WN({display:"flex",minWidth:0,minHeight:0,flex:"none",alignSelf:"auto",alignItems:"stretch",flexDirection:"column",justifyContent:"flex-start",...t}),...e})),UA=t=>{const e=G.useContext(Di);return R.jsxs(fe,{as:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 467.27 512",...t,children:[R.jsx("polygon",{fill:e.colors.shape,points:"352.33 159.67 432.16 239.45 432.16 399.13 319.29 512 93.55 512 159.67 445.87 0 286.25 319.29 286.25 272.55 239.45 272.55 79.84 352.33 0 465.26 112.87 352.33 112.87 352.33 159.67"}),R.jsxs("g",{children:[R.jsx("polygon",{fill:e.colors.pieces.mt1,points:"272.57 79.84 272.57 239.45 352.36 319.29 432.19 399.13 432.19 239.45 352.36 159.67 352.36 112.87 465.29 112.87 352.36 0 272.57 79.84"}),R.jsx("polygon",{fill:e.colors.pieces.st1,points:"93.58 512 319.32 512 432.19 399.13 319.32 286.25 93.58 512"}),R.jsx("polygon",{fill:e.colors.pieces.lt2,points:"159.67 445.87 239.48 366.05 319.31 286.24 0.03 286.24 159.67 445.87"})]})]})};var h1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},AL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],u=t[n++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},zA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,u=a?t[i+1]:0,h=i+2<t.length,g=h?t[i+2]:0,m=s>>2,w=(s&3)<<4|u>>4;let T=(u&15)<<2|g>>6,I=g&63;h||(I=64,a||(T=64)),r.push(n[m],n[w],n[T],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):AL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const g=i<t.length?n[t.charAt(i)]:64;++i;const w=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||u==null||g==null||w==null)throw new bL;const T=s<<2|u>>4;if(r.push(T),g!==64){const I=u<<4&240|g>>2;if(r.push(I),w!==64){const j=g<<6&192|w;r.push(j)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const PL=function(t){const e=jA(t);return zA.encodeByteArray(e,!0)},ag=function(t){return PL(t).replace(/\./g,"")},$A=function(t){try{return zA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function lg(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!RL(n)||(t[n]=lg(t[n],e[n]));return t}function RL(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL=()=>kL().__FIREBASE_DEFAULTS__,DL=()=>{if(typeof process>"u"||typeof h1>"u")return;const t=h1.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},OL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$A(t[1]);return e&&JSON.parse(e)},k0=()=>{try{return NL()||DL()||OL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qA=()=>{var t;return(t=k0())===null||t===void 0?void 0:t.config},ML=t=>{var e;return(e=k0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LL=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),u="";return[ag(JSON.stringify(n)),ag(JSON.stringify(a)),u].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tn())}function N0(){var t;const e=(t=k0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BL(){return typeof self=="object"&&self.self===self}function HA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function D0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GA(){const t=tn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function UL(){return!N0()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sh(){try{return typeof indexedDB=="object"}catch{return!1}}function jL(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL="FirebaseError";class mr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=zL,Object.setPrototypeOf(this,mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ya.prototype.create)}}class Ya{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?$L(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new mr(i,u,r)}}function $L(t,e){return t.replace(qL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const qL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function HL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Pv(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(f1(s)&&f1(a)){if(!Pv(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function f1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Dl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function dc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function WA(t,e){const n=new GL(t,e);return n.subscribe.bind(n)}class GL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");WL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=jm),i.error===void 0&&(i.error=jm),i.complete===void 0&&(i.complete=jm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function WL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function jm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(t){return t&&t._delegate?t._delegate:t}class rs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new LL;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(YL(e))try{this.getOrInitializeService({instanceIdentifier:ia})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ia){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ia){return this.instances.has(e)}getOptions(e=ia){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:QL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ia){return this.component?this.component.multipleInstances?e:ia:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function QL(t){return t===ia?void 0:t}function YL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new KL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0=[];var ct;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ct||(ct={}));const KA={debug:ct.DEBUG,verbose:ct.VERBOSE,info:ct.INFO,warn:ct.WARN,error:ct.ERROR,silent:ct.SILENT},JL=ct.INFO,ZL={[ct.DEBUG]:"log",[ct.VERBOSE]:"log",[ct.INFO]:"info",[ct.WARN]:"warn",[ct.ERROR]:"error"},eV=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=ZL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fp{constructor(e){this.name=e,this._logLevel=JL,this._logHandler=eV,this._userLogHandler=null,O0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?KA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ct.DEBUG,...e),this._logHandler(this,ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ct.VERBOSE,...e),this._logHandler(this,ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ct.INFO,...e),this._logHandler(this,ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ct.WARN,...e),this._logHandler(this,ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ct.ERROR,...e),this._logHandler(this,ct.ERROR,...e)}}function tV(t){O0.forEach(e=>{e.setLogLevel(t)})}function nV(t,e){for(const n of O0){let r=null;e&&e.level&&(r=KA[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...a)=>{const u=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&t({level:ct[s].toLowerCase(),message:u,args:a,type:i.name})}}}const rV=(t,e)=>e.some(n=>t instanceof n);let g1,p1;function iV(){return g1||(g1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sV(){return p1||(p1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const QA=new WeakMap,Rv=new WeakMap,YA=new WeakMap,zm=new WeakMap,M0=new WeakMap;function oV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(vo(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&QA.set(n,t)}).catch(()=>{}),M0.set(e,t),e}function aV(t){if(Rv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Rv.set(t,e)}let kv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||YA.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lV(t){kv=t(kv)}function uV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($m(this),e,...n);return YA.set(r,e.sort?e.sort():[e]),vo(r)}:sV().includes(t)?function(...e){return t.apply($m(this),e),vo(QA.get(this))}:function(...e){return vo(t.apply($m(this),e))}}function cV(t){return typeof t=="function"?uV(t):(t instanceof IDBTransaction&&aV(t),rV(t,iV())?new Proxy(t,kv):t)}function vo(t){if(t instanceof IDBRequest)return oV(t);if(zm.has(t))return zm.get(t);const e=cV(t);return e!==t&&(zm.set(t,e),M0.set(e,t)),e}const $m=t=>M0.get(t);function hV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),u=vo(a);return r&&a.addEventListener("upgradeneeded",h=>{r(vo(a.result),h.oldVersion,h.newVersion,vo(a.transaction),h)}),n&&a.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),u.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),u}const dV=["get","getKey","getAll","getAllKeys","count"],fV=["put","add","delete","clear"],qm=new Map;function m1(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qm.get(e))return qm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=fV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||dV.includes(n)))return;const s=async function(a,...u){const h=this.transaction(a,i?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(await Promise.all([g[n](...u),i&&h.done]))[0]};return qm.set(e,s),s}lV(t=>({...t,get:(e,n,r)=>m1(e,n)||t.get(e,n,r),has:(e,n)=>!!m1(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(pV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function pV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nv="@firebase/app",_1="0.9.24";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=new fp("@firebase/app"),mV="@firebase/app-compat",_V="@firebase/analytics-compat",vV="@firebase/analytics",yV="@firebase/app-check-compat",wV="@firebase/app-check",EV="@firebase/auth",IV="@firebase/auth-compat",TV="@firebase/database",SV="@firebase/database-compat",xV="@firebase/functions",CV="@firebase/functions-compat",AV="@firebase/installations",bV="@firebase/installations-compat",PV="@firebase/messaging",RV="@firebase/messaging-compat",kV="@firebase/performance",NV="@firebase/performance-compat",DV="@firebase/remote-config",OV="@firebase/remote-config-compat",MV="@firebase/storage",LV="@firebase/storage-compat",VV="@firebase/firestore",FV="@firebase/firestore-compat",BV="firebase",UV="10.7.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To="[DEFAULT]",jV={[Nv]:"fire-core",[mV]:"fire-core-compat",[vV]:"fire-analytics",[_V]:"fire-analytics-compat",[wV]:"fire-app-check",[yV]:"fire-app-check-compat",[EV]:"fire-auth",[IV]:"fire-auth-compat",[TV]:"fire-rtdb",[SV]:"fire-rtdb-compat",[xV]:"fire-fn",[CV]:"fire-fn-compat",[AV]:"fire-iid",[bV]:"fire-iid-compat",[PV]:"fire-fcm",[RV]:"fire-fcm-compat",[kV]:"fire-perf",[NV]:"fire-perf-compat",[DV]:"fire-rc",[OV]:"fire-rc-compat",[MV]:"fire-gcs",[LV]:"fire-gcs-compat",[VV]:"fire-fst",[FV]:"fire-fst-compat","fire-js":"fire-js",[BV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=new Map,oh=new Map;function ug(t,e){try{t.container.addComponent(e)}catch(n){Oa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function XA(t,e){t.container.addOrOverwriteComponent(e)}function xo(t){const e=t.name;if(oh.has(e))return Oa.debug(`There were multiple attempts to register component ${e}.`),!1;oh.set(e,t);for(const n of So.values())ug(n,t);return!0}function JA(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zV(t,e,n=To){JA(t,e).clearInstance(n)}function $V(){oh.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},xs=new Ya("app","Firebase",qV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HV=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xs.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo=UV;function L0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:To,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw xs.create("bad-app-name",{appName:String(i)});if(n||(n=qA()),!n)throw xs.create("no-options");const s=So.get(i);if(s){if(Pv(n,s.options)&&Pv(r,s.config))return s;throw xs.create("duplicate-app",{appName:i})}const a=new XL(i);for(const h of oh.values())a.addComponent(h);const u=new HV(n,r,a);return So.set(i,u),u}function GV(t=To){const e=So.get(t);if(!e&&t===To&&qA())return L0();if(!e)throw xs.create("no-app",{appName:t});return e}function WV(){return Array.from(So.values())}async function ZA(t){const e=t.name;So.has(e)&&(So.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function es(t,e,n){var r;let i=(r=jV[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Oa.warn(u.join(" "));return}xo(new rs(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function eb(t,e){if(t!==null&&typeof t!="function")throw xs.create("invalid-log-argument");nV(t,e)}function tb(t){tV(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV="firebase-heartbeat-database",QV=1,ah="firebase-heartbeat-store";let Hm=null;function nb(){return Hm||(Hm=hV(KV,QV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ah)}}}).catch(t=>{throw xs.create("idb-open",{originalErrorMessage:t.message})})),Hm}async function YV(t){try{return await(await nb()).transaction(ah).objectStore(ah).get(rb(t))}catch(e){if(e instanceof mr)Oa.warn(e.message);else{const n=xs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Oa.warn(n.message)}}}async function v1(t,e){try{const r=(await nb()).transaction(ah,"readwrite");await r.objectStore(ah).put(e,rb(t)),await r.done}catch(n){if(n instanceof mr)Oa.warn(n.message);else{const r=xs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Oa.warn(r.message)}}}function rb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV=1024,JV=30*24*60*60*1e3;class ZV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tF(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=y1();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const u=new Date(a.date).valueOf();return Date.now()-u<=JV}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=y1(),{heartbeatsToSend:r,unsentEntries:i}=eF(this._heartbeatsCache.heartbeats),s=ag(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function y1(){return new Date().toISOString().substring(0,10)}function eF(t,e=XV){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),w1(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),w1(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sh()?jL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await YV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return v1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return v1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function w1(t){return ag(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t){xo(new rs("platform-logger",e=>new gV(e),"PRIVATE")),xo(new rs("heartbeat",e=>new ZV(e),"PRIVATE")),es(Nv,_1,t),es(Nv,_1,"esm2017"),es("fire-js","")}nF("");const rF=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:mr,SDK_VERSION:Uo,_DEFAULT_ENTRY_NAME:To,_addComponent:ug,_addOrOverwriteComponent:XA,_apps:So,_clearComponents:$V,_components:oh,_getProvider:JA,_registerComponent:xo,_removeServiceInstance:zV,deleteApp:ZA,getApp:GV,getApps:WV,initializeApp:L0,onLog:eb,registerVersion:es,setLogLevel:tb},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e,n){this._delegate=e,this.firebase=n,ug(e,new rs("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),ZA(this._delegate)))}_getService(e,n=To){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=To){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){ug(this._delegate,e)}_addOrOverwriteComponent(e){XA(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},E1=new Ya("app-compat","Firebase",sF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:es,setLogLevel:tb,onLog:eb,apps:null,SDK_VERSION:Uo,INTERNAL:{registerComponent:u,removeApp:r,useAsService:h,modularAPIs:rF}};n.default=n,Object.defineProperty(n,"apps",{get:a});function r(g){delete e[g]}function i(g){if(g=g||To,!d1(e,g))throw E1.create("no-app",{appName:g});return e[g]}i.App=t;function s(g,m={}){const w=L0(g,m);if(d1(e,w.name))return e[w.name];const T=new t(w,n);return e[w.name]=T,T}function a(){return Object.keys(e).map(g=>e[g])}function u(g){const m=g.name,w=m.replace("-compat","");if(xo(g)&&g.type==="PUBLIC"){const T=(I=i())=>{if(typeof I[w]!="function")throw E1.create("invalid-app-argument",{appName:m});return I[w]()};g.serviceProps!==void 0&&lg(T,g.serviceProps),n[w]=T,t.prototype[w]=function(...I){return this._getService.bind(this,m).apply(this,g.multipleInstances?I:[])}}return g.type==="PUBLIC"?n[w]:null}function h(g,m){return m==="serverAuth"?null:m}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(){const t=oF(iF);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:ib,extendNamespace:e,createSubscribe:WA,ErrorFactory:Ya,deepExtend:lg});function e(n){lg(t,n)}return t}const aF=ib();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=new fp("@firebase/app-compat"),lF="@firebase/app-compat",uF="0.2.24";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(t){es(lF,uF,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(BL()&&self.firebase!==void 0){I1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&I1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const jt=aF;cF();var hF="firebase",dF="10.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt.registerVersion(hF,dF,"app-compat");const Ku={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ol={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function sb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gF=fF,pF=sb,ob=new Ya("auth","Firebase",sb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=new fp("@firebase/auth");function mF(t,...e){cg.logLevel<=ct.WARN&&cg.warn(`Auth (${Uo}): ${t}`,...e)}function wf(t,...e){cg.logLevel<=ct.ERROR&&cg.error(`Auth (${Uo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(t,...e){throw V0(t,...e)}function Hn(t,...e){return V0(t,...e)}function ab(t,e,n){const r=Object.assign(Object.assign({},pF()),{[e]:n});return new Ya("auth","Firebase",r).create(e,{appName:t.name})}function xu(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Kn(t,"argument-error"),ab(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function V0(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return ob.create(t,...e)}function Ie(t,e,...n){if(!t)throw V0(e,...n)}function Gi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wf(e),new Error(e)}function Ri(t,e){t||Gi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function F0(){return T1()==="http:"||T1()==="https:"}function T1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(F0()||HA()||"connection"in navigator)?navigator.onLine:!0}function vF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ri(n>e,"Short delay should be less than long delay!"),this.isMobile=FL()||D0()}get(){return _F()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(t,e){Ri(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF=new Gh(3e4,6e4);function cn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function hn(t,e,n,r,i={}){return ub(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const u=Su(Object.assign({key:t.config.apiKey},a)).slice(1),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode),lb.fetch()(cb(t,t.config.apiHost,n,u),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function ub(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},yF),e);try{const i=new IF(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw fc(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const u=s.ok?a.errorMessage:a.error.message,[h,g]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw fc(t,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw fc(t,"email-already-in-use",a);if(h==="USER_DISABLED")throw fc(t,"user-disabled",a);const m=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw ab(t,m,g);Kn(t,m)}}catch(i){if(i instanceof mr)throw i;Kn(t,"network-request-failed",{message:String(i)})}}async function Fs(t,e,n,r,i={}){const s=await hn(t,e,n,r,i);return"mfaPendingCredential"in s&&Kn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function cb(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?B0(t.config,i):`${t.config.apiScheme}://${i}`}function EF(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class IF{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Hn(this.auth,"network-request-failed")),wF.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Hn(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(t){return t!==void 0&&t.getResponse!==void 0}function x1(t){return t!==void 0&&t.enterprise!==void 0}class TF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return EF(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SF(t){return(await hn(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function xF(t,e){return hn(t,"GET","/v2/recaptchaConfig",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CF(t,e){return hn(t,"POST","/v1/accounts:delete",e)}async function AF(t,e){return hn(t,"POST","/v1/accounts:update",e)}async function bF(t,e){return hn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function PF(t,e=!1){const n=We(t),r=await n.getIdToken(e),i=gp(r);Ie(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:kc(Gm(i.auth_time)),issuedAtTime:kc(Gm(i.iat)),expirationTime:kc(Gm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Gm(t){return Number(t)*1e3}function gp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return wf("JWT malformed, contained fewer than 3 sections"),null;try{const i=$A(n);return i?JSON.parse(i):(wf("Failed to decode base64 JWT payload"),null)}catch(i){return wf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function RF(t){const e=gp(t);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ns(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof mr&&kF(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function kF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ns(t,bF(n,{idToken:r}));Ie(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?MF(s.providerUserInfo):[],u=OF(t.providerData,a),h=t.isAnonymous,g=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),m=h?g:!1,w={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new hb(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(t,w)}async function DF(t){const e=We(t);await uh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OF(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function MF(t){return t.map(e=>{var{providerId:n}=e,r=ks(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LF(t,e){const n=await ub(t,{},async()=>{const r=Su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=cb(t,i,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",lb.fetch()(a,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function VF(t,e){return hn(t,"POST","/v2/accounts:revokeToken",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):RF(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return Ie(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await LF(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new ch;return r&&(Ie(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ie(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ie(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ch,this.toJSON())}_performRefresh(){return Gi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(t,e){Ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Sa{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=ks(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new NF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hb(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ns(this,this.stsTokenManager.getToken(this.auth,e));return Ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return PF(this,e)}reload(){return DF(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Sa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await uh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ns(this,CF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,a,u,h,g,m;const w=(r=n.displayName)!==null&&r!==void 0?r:void 0,T=(i=n.email)!==null&&i!==void 0?i:void 0,I=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,j=(a=n.photoURL)!==null&&a!==void 0?a:void 0,z=(u=n.tenantId)!==null&&u!==void 0?u:void 0,X=(h=n._redirectEventId)!==null&&h!==void 0?h:void 0,V=(g=n.createdAt)!==null&&g!==void 0?g:void 0,B=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:U,emailVerified:J,isAnonymous:re,providerData:te,stsTokenManager:ae}=n;Ie(U&&ae,e,"internal-error");const ne=ch.fromJSON(this.name,ae);Ie(typeof U=="string",e,"internal-error"),Gs(w,e.name),Gs(T,e.name),Ie(typeof J=="boolean",e,"internal-error"),Ie(typeof re=="boolean",e,"internal-error"),Gs(I,e.name),Gs(j,e.name),Gs(z,e.name),Gs(X,e.name),Gs(V,e.name),Gs(B,e.name);const me=new Sa({uid:U,auth:e,email:T,emailVerified:J,displayName:w,isAnonymous:re,photoURL:j,phoneNumber:I,tenantId:z,stsTokenManager:ne,createdAt:V,lastLoginAt:B});return te&&Array.isArray(te)&&(me.providerData=te.map(pe=>Object.assign({},pe))),X&&(me._redirectEventId=X),me}static async _fromIdTokenResponse(e,n,r=!1){const i=new ch;i.updateFromServerResponse(n);const s=new Sa({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await uh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1=new Map;function qr(t){Ri(t instanceof Function,"Expected a class definition");let e=C1.get(t);return e?(Ri(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,C1.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}db.type="NONE";const ou=db;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(t,e,n){return`firebase:${t}:${e}:${n}`}class ql{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=xa(this.userKey,i.apiKey,s),this.fullPersistenceKey=xa("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Sa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ql(qr(ou),e,r);const i=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let s=i[0]||qr(ou);const a=xa(r,e.config.apiKey,e.name);let u=null;for(const g of n)try{const m=await g._get(a);if(m){const w=Sa._fromJSON(e,m);g!==s&&(u=w),s=g;break}}catch{}const h=i.filter(g=>g._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new ql(s,e,r):(s=h[0],u&&await s._set(a,u.toJSON()),await Promise.all(n.map(async g=>{if(g!==s)try{await g._remove(a)}catch{}})),new ql(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mb(e))return"Blackberry";if(_b(e))return"Webos";if(U0(e))return"Safari";if((e.includes("chrome/")||gb(e))&&!e.includes("edge/"))return"Chrome";if(Wh(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function fb(t=tn()){return/firefox\//i.test(t)}function U0(t=tn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gb(t=tn()){return/crios\//i.test(t)}function pb(t=tn()){return/iemobile/i.test(t)}function Wh(t=tn()){return/android/i.test(t)}function mb(t=tn()){return/blackberry/i.test(t)}function _b(t=tn()){return/webos/i.test(t)}function Cu(t=tn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function FF(t=tn()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function BF(t=tn()){var e;return Cu(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function UF(){return GA()&&document.documentMode===10}function vb(t=tn()){return Cu(t)||Wh(t)||_b(t)||mb(t)||/windows phone/i.test(t)||pb(t)}function jF(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(t,e=[]){let n;switch(t){case"Browser":n=A1(tn());break;case"Worker":n=`${A1(tn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Uo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,u)=>{try{const h=e(s);a(h)}catch(h){u(h)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $F(t,e={}){return hn(t,"GET","/v2/passwordPolicy",cn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=6;class HF{constructor(e){var n,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:qF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,a,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(n=h.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b1(this),this.idTokenSubscription=new b1(this),this.beforeStateQueue=new zF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ob,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qr(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ql.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===u)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await uh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?We(e):null;return n&&Ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(qr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $F(this),n=new HF(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ya("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await VF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qr(e)||this._popupRedirectResolver;Ie(n,this,"argument-error"),this.redirectPersistenceManager=await ql.create(this,[qr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const h=e.addObserver(n,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(n);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&mF(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function an(t){return We(t)}class b1{constructor(e){this.auth=e,this.observer=null,this.addObserver=WA(n=>this.observer=n)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function j0(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Hn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",WF().appendChild(r)})}function wb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const KF="https://www.google.com/recaptcha/enterprise.js?render=",QF="recaptcha-enterprise",YF="NO_RECAPTCHA";class XF{constructor(e){this.type=QF,this.auth=an(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,u)=>{xF(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const g=new TF(h);return s.tenantId==null?s._agentRecaptchaConfig=g:s._tenantRecaptchaConfigs[s.tenantId]=g,a(g.siteKey)}}).catch(h=>{u(h)})})}function i(s,a,u){const h=window.grecaptcha;x1(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(g=>{a(g)}).catch(()=>{a(YF)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(u=>{if(!n&&x1(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}j0(KF+u).then(()=>{i(u,s,a)}).catch(h=>{a(h)})}}).catch(u=>{a(u)})})}}async function P1(t,e,n,r=!1){const i=new XF(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function hh(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await P1(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await P1(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(s)})}function JF(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(qr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function ZF(t,e,n){const r=an(t);Ie(r._canInitEmulator,r,"emulator-config-failed"),Ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=Eb(e),{host:a,port:u}=e5(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||t5()}function Eb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function e5(t){const e=Eb(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:R1(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:R1(a)}}}function R1(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function t5(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gi("not implemented")}_getIdTokenResponse(e){return Gi("not implemented")}_linkToIdToken(e,n){return Gi("not implemented")}_getReauthenticationResolver(e){return Gi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ib(t,e){return hn(t,"POST","/v1/accounts:resetPassword",cn(t,e))}async function n5(t,e){return hn(t,"POST","/v1/accounts:update",e)}async function r5(t,e){return hn(t,"POST","/v1/accounts:signUp",e)}async function i5(t,e){return hn(t,"POST","/v1/accounts:update",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s5(t,e){return Fs(t,"POST","/v1/accounts:signInWithPassword",cn(t,e))}async function pp(t,e){return hn(t,"POST","/v1/accounts:sendOobCode",cn(t,e))}async function o5(t,e){return pp(t,e)}async function a5(t,e){return pp(t,e)}async function l5(t,e){return pp(t,e)}async function u5(t,e){return pp(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c5(t,e){return Fs(t,"POST","/v1/accounts:signInWithEmailLink",cn(t,e))}async function h5(t,e){return Fs(t,"POST","/v1/accounts:signInWithEmailLink",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh extends Au{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new dh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new dh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hh(e,n,"signInWithPassword",s5);case"emailLink":return c5(e,{email:this._email,oobCode:this._password});default:Kn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hh(e,r,"signUpPassword",r5);case"emailLink":return h5(e,{idToken:n,email:this._email,oobCode:this._password});default:Kn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cs(t,e){return Fs(t,"POST","/v1/accounts:signInWithIdp",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5="http://localhost";class is extends Au{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new is(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Kn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=ks(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new is(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Cs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Cs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Cs(e,n)}buildRequest(){const e={requestUri:d5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Su(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f5(t,e){return hn(t,"POST","/v1/accounts:sendVerificationCode",cn(t,e))}async function g5(t,e){return Fs(t,"POST","/v1/accounts:signInWithPhoneNumber",cn(t,e))}async function p5(t,e){const n=await Fs(t,"POST","/v1/accounts:signInWithPhoneNumber",cn(t,e));if(n.temporaryProof)throw fc(t,"account-exists-with-different-credential",n);return n}const m5={USER_NOT_FOUND:"user-not-found"};async function _5(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Fs(t,"POST","/v1/accounts:signInWithPhoneNumber",cn(t,n),m5)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends Au{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Ca({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Ca({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return g5(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return p5(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return _5(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Ca({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v5(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function y5(t){const e=Dl(dc(t)).link,n=e?Dl(dc(e)).deep_link_id:null,r=Dl(dc(t)).deep_link_id;return(r?Dl(dc(r)).link:null)||r||n||e||t}class mp{constructor(e){var n,r,i,s,a,u;const h=Dl(dc(e)),g=(n=h.apiKey)!==null&&n!==void 0?n:null,m=(r=h.oobCode)!==null&&r!==void 0?r:null,w=v5((i=h.mode)!==null&&i!==void 0?i:null);Ie(g&&m&&w,"argument-error"),this.apiKey=g,this.operation=w,this.code=m,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=y5(e);try{return new mp(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.providerId=jo.PROVIDER_ID}static credential(e,n){return dh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=mp.parseLink(n);return Ie(r,"argument-error"),dh._fromEmailAndCode(e,r.code,r.tenantId)}}jo.PROVIDER_ID="password";jo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends Bs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Hl extends bu{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return Ie("providerId"in n&&"signInMethod"in n,"argument-error"),is._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Ie(e.idToken||e.accessToken,"argument-error"),is._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Hl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Hl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:u}=e;if(!r&&!i&&!n&&!s||!u)return null;try{return new Hl(u)._credential({idToken:n,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends bu{constructor(){super("facebook.com")}static credential(e){return is._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ji.credential(e.oauthAccessToken)}catch{return null}}}ji.FACEBOOK_SIGN_IN_METHOD="facebook.com";ji.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return is._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return zi.credential(n,r)}catch{return null}}}zi.GOOGLE_SIGN_IN_METHOD="google.com";zi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends bu{constructor(){super("github.com")}static credential(e){return is._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.GITHUB_SIGN_IN_METHOD="github.com";$i.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w5="http://localhost";class au extends Au{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Cs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Cs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Cs(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new au(r,s)}static _create(e,n){return new au(e,n)}buildRequest(){return{requestUri:w5,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5="saml.";class hg extends Bs{constructor(e){Ie(e.startsWith(E5),"argument-error"),super(e)}static credentialFromResult(e){return hg.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return hg.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=au.fromJSON(e);return Ie(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return au._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends bu{constructor(){super("twitter.com")}static credential(e,n){return is._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return qi.credential(n,r)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(t,e){return Fs(t,"POST","/v1/accounts:signUp",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Sa._fromIdTokenResponse(e,r,i),a=k1(r);return new hi({user:s,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=k1(r);return new hi({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function k1(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I5(t){var e;const n=an(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new hi({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Tb(n,{returnSecureToken:!0}),i=await hi._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg extends mr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,dg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new dg(e,n,r,i)}}function Sb(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?dg._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xb(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T5(t,e){const n=We(t);await _p(!0,n,e);const{providerUserInfo:r}=await AF(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=xb(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function z0(t,e,n=!1){const r=await Ns(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return hi._forOperation(t,"link",r)}async function _p(t,e,n){await uh(e);const r=xb(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";Ie(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cb(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Ns(t,Sb(r,i,e,t),n);Ie(s.idToken,r,"internal-error");const a=gp(s.idToken);Ie(a,r,"internal-error");const{sub:u}=a;return Ie(t.uid===u,r,"user-mismatch"),hi._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Kn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ab(t,e,n=!1){const r="signIn",i=await Sb(t,r,e),s=await hi._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function vp(t,e){return Ab(an(t),e)}async function bb(t,e){const n=We(t);return await _p(!1,n,e.providerId),z0(n,e)}async function Pb(t,e){return Cb(We(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S5(t,e){return Fs(t,"POST","/v1/accounts:signInWithCustomToken",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x5(t,e){const n=an(t),r=await S5(n,{token:e,returnSecureToken:!0}),i=await hi._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?$0._fromServerResponse(e,n):"totpInfo"in n?q0._fromServerResponse(e,n):Kn(e,"internal-error")}}class $0 extends Kh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new $0(n)}}class q0 extends Kh{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new q0(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t,e,n){var r;Ie(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),Ie(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Ie(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Ie(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H0(t){const e=an(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function C5(t,e,n){const r=an(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&yp(r,i,n),await hh(r,i,"getOobCode",a5)}async function A5(t,e,n){await Ib(We(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&H0(t),r})}async function b5(t,e){await i5(We(t),{oobCode:e})}async function Rb(t,e){const n=We(t),r=await Ib(n,{oobCode:e}),i=r.requestType;switch(Ie(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ie(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ie(r.mfaInfo,n,"internal-error");default:Ie(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Kh._fromServerResponse(an(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function P5(t,e){const{data:n}=await Rb(We(t),e);return n.email}async function R5(t,e,n){const r=an(t),a=await hh(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Tb).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&H0(t),h}),u=await hi._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function k5(t,e,n){return vp(We(t),jo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&H0(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N5(t,e,n){const r=an(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,u){Ie(u.handleCodeInApp,r,"argument-error"),u&&yp(r,a,u)}s(i,n),await hh(r,i,"getOobCode",l5)}function D5(t,e){const n=mp.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function O5(t,e,n){const r=We(t),i=jo.credentialWithLink(e,n||lh());return Ie(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),vp(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M5(t,e){return hn(t,"POST","/v1/accounts:createAuthUri",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L5(t,e){const n=F0()?lh():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await M5(We(t),r);return i||[]}async function V5(t,e){const n=We(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&yp(n.auth,i,e);const{email:s}=await o5(n.auth,i);s!==t.email&&await t.reload()}async function F5(t,e,n){const r=We(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&yp(r.auth,s,n);const{email:a}=await u5(r.auth,s);a!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5(t,e){return hn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U5(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=We(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await Ns(r,B5(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const u=r.providerData.find(({providerId:h})=>h==="password");u&&(u.displayName=r.displayName,u.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function j5(t,e){return kb(We(t),e,null)}function z5(t,e){return kb(We(t),null,e)}async function kb(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const a=await Ns(t,n5(r,s));await t._updateTokensIfNecessary(a,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const a=(n=(e=gp(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(a){const u=a!=="anonymous"&&a!=="custom"?a:null;return new Gl(s,u)}}if(!r)return null;switch(r){case"facebook.com":return new q5(s,i);case"github.com":return new H5(s,i);case"google.com":return new G5(s,i);case"twitter.com":return new W5(s,i,t.screenName||null);case"custom":case"anonymous":return new Gl(s,null);default:return new Gl(s,r,i)}}class Gl{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class Nb extends Gl{constructor(e,n,r,i){super(e,n,r),this.username=i}}class q5 extends Gl{constructor(e,n){super(e,"facebook.com",n)}}class H5 extends Nb{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class G5 extends Gl{constructor(e,n){super(e,"google.com",n)}}class W5 extends Nb{constructor(e,n,r){super(e,"twitter.com",n,r)}}function K5(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:$5(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new ma("enroll",e,n)}static _fromMfaPendingCredential(e){return new ma("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return ma._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return ma._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=an(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(u=>Kh._fromServerResponse(r,u));Ie(i.mfaPendingCredential,r,"internal-error");const a=ma._fromMfaPendingCredential(i.mfaPendingCredential);return new G0(a,s,async u=>{const h=await u._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const g=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(n.operationType){case"signIn":const m=await hi._fromIdTokenResponse(r,n.operationType,g);return await r._updateCurrentUser(m.user),m;case"reauthenticate":return Ie(n.user,r,"internal-error"),hi._forOperation(n.user,n.operationType,g);default:Kn(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function Q5(t,e){var n;const r=We(t),i=e;return Ie(e.customData.operationType,r,"argument-error"),Ie((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),G0._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(t,e){return hn(t,"POST","/v2/accounts/mfaEnrollment:start",cn(t,e))}function X5(t,e){return hn(t,"POST","/v2/accounts/mfaEnrollment:finalize",cn(t,e))}function J5(t,e){return hn(t,"POST","/v2/accounts/mfaEnrollment:withdraw",cn(t,e))}class W0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Kh._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new W0(e)}async getSession(){return ma._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await Ns(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Ns(this.user,J5(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Wm=new WeakMap;function Z5(t){const e=We(t);return Wm.has(e)||Wm.set(e,W0._fromUser(e)),Wm.get(e)}const fg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(fg,"1"),this.storage.removeItem(fg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(){const t=tn();return U0(t)||Cu(t)}const t4=1e3,n4=10;class Ob extends Db{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=e4()&&jF(),this.fallbackToPolling=vb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,u,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);UF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,n4):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},t4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ob.type="LOCAL";const K0=Ob;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb extends Db{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Mb.type="SESSION";const Ma=Mb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r4(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new wp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(a).map(async g=>g(n.origin,s)),h=await r4(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,h)=>{const g=Qh("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(w){const T=w;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(T.data.response);break;default:clearTimeout(m),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(){return window}function s4(t){wn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(){return typeof wn().WorkerGlobalScope<"u"&&typeof wn().importScripts=="function"}async function o4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function a4(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function l4(){return Q0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb="firebaseLocalStorageDb",u4=1,gg="firebaseLocalStorage",Vb="fbase_key";class Yh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Ep(t,e){return t.transaction([gg],e?"readwrite":"readonly").objectStore(gg)}function c4(){const t=indexedDB.deleteDatabase(Lb);return new Yh(t).toPromise()}function Dv(){const t=indexedDB.open(Lb,u4);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(gg,{keyPath:Vb})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(gg)?e(r):(r.close(),await c4(),e(await Dv()))})})}async function N1(t,e,n){const r=Ep(t,!0).put({[Vb]:e,value:n});return new Yh(r).toPromise()}async function h4(t,e){const n=Ep(t,!1).get(e),r=await new Yh(n).toPromise();return r===void 0?null:r.value}function D1(t,e){const n=Ep(t,!0).delete(e);return new Yh(n).toPromise()}const d4=800,f4=3;class Fb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>f4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Q0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wp._getInstance(l4()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new i4(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||a4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dv();return await N1(e,fg,"1"),await D1(e,fg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>N1(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>h4(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>D1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ep(i,!1).getAll();return new Yh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),d4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Fb.type="LOCAL";const fh=Fb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(t,e){return hn(t,"POST","/v2/accounts/mfaSignIn:start",cn(t,e))}function p4(t,e){return hn(t,"POST","/v2/accounts/mfaSignIn:finalize",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=500,_4=6e4,Hd=1e12;class v4{constructor(e){this.auth=e,this.counter=Hd,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new y4(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||Hd;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||Hd;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||Hd;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class y4{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Ie(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=w4(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},_4)},m4))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function w4(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km=wb("rcb"),E4=new Gh(3e4,6e4),I4="https://www.google.com/recaptcha/api.js?";class T4{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=wn().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return Ie(S4(n),e,"argument-error"),this.shouldResolveImmediately(n)&&S1(wn().grecaptcha)?Promise.resolve(wn().grecaptcha):new Promise((r,i)=>{const s=wn().setTimeout(()=>{i(Hn(e,"network-request-failed"))},E4.get());wn()[Km]=()=>{wn().clearTimeout(s),delete wn()[Km];const u=wn().grecaptcha;if(!u||!S1(u)){i(Hn(e,"internal-error"));return}const h=u.render;u.render=(g,m)=>{const w=h(g,m);return this.counter++,w},this.hostLanguage=n,r(u)};const a=`${I4}?${Su({onload:Km,render:"explicit",hl:n})}`;j0(a).catch(()=>{clearTimeout(s),i(Hn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=wn().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function S4(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class x4{async load(e){return new v4(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb="recaptcha",C4={theme:"light",type:"image"};let A4=class{constructor(e,n,r=Object.assign({},C4)){this.parameters=r,this.type=Bb,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=an(e),this.isInvisible=this.parameters.size==="invisible",Ie(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;Ie(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new x4:new T4,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Ie(!this.parameters.sitekey,this.auth,"argument-error"),Ie(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ie(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=wn()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){Ie(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ie(F0()&&!Q0(),this.auth,"internal-error"),await b4(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await SF(this.auth);Ie(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ie(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function b4(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Ca._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function P4(t,e,n){const r=an(t),i=await Ip(r,e,We(n));return new Y0(i,s=>vp(r,s))}async function R4(t,e,n){const r=We(t);await _p(!1,r,"phone");const i=await Ip(r.auth,e,We(n));return new Y0(i,s=>bb(r,s))}async function k4(t,e,n){const r=We(t),i=await Ip(r.auth,e,We(n));return new Y0(i,s=>Pb(r,s))}async function Ip(t,e,n){var r;const i=await n.verify();try{Ie(typeof i=="string",t,"argument-error"),Ie(n.type===Bb,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return Ie(a.type==="enroll",t,"internal-error"),(await Y5(t,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{Ie(a.type==="signin",t,"internal-error");const u=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return Ie(u,t,"missing-multi-factor-info"),(await g4(t,{mfaPendingCredential:a.credential,mfaEnrollmentId:u,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await f5(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{n._reset()}}async function N4(t,e){await z0(We(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let La=class Ef{constructor(e){this.providerId=Ef.PROVIDER_ID,this.auth=an(e)}verifyPhoneNumber(e,n){return Ip(this.auth,e,We(n))}static credential(e,n){return Ca._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Ef.credentialFromTaggedObject(n)}static credentialFromError(e){return Ef.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Ca._fromTokenResponse(n,r):null}};La.PROVIDER_ID="phone";La.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t,e){return e?qr(e):(Ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0 extends Au{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Cs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Cs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Cs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function D4(t){return Ab(t.auth,new X0(t),t.bypassAuthState)}function O4(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),Cb(n,new X0(t),t.bypassAuthState)}async function M4(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),z0(n,new X0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return D4;case"linkViaPopup":case"linkViaRedirect":return M4;case"reauthViaPopup":case"reauthViaRedirect":return O4;default:Kn(this.auth,"internal-error")}}resolve(e){Ri(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ri(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4=new Gh(2e3,1e4);async function V4(t,e,n){const r=an(t);xu(t,e,Bs);const i=Xa(r,n);return new ws(r,"signInViaPopup",e,i).executeNotNull()}async function F4(t,e,n){const r=We(t);xu(r.auth,e,Bs);const i=Xa(r.auth,n);return new ws(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function B4(t,e,n){const r=We(t);xu(r.auth,e,Bs);const i=Xa(r.auth,n);return new ws(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class ws extends Ub{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,ws.currentPopupAction&&ws.currentPopupAction.cancel(),ws.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){Ri(this.filter.length===1,"Popup operations only handle one event");const e=Qh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Hn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Hn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ws.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,L4.get())};e()}}ws.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U4="pendingRedirect",Nc=new Map;class j4 extends Ub{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Nc.get(this.auth._key());if(!e){try{const r=await z4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Nc.set(this.auth._key(),e)}return this.bypassAuthState||Nc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function z4(t,e){const n=zb(e),r=jb(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function J0(t,e){return jb(t)._set(zb(e),"true")}function $4(){Nc.clear()}function Z0(t,e){Nc.set(t._key(),e)}function jb(t){return qr(t._redirectPersistence)}function zb(t){return xa(U4,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(t,e,n){return H4(t,e,n)}async function H4(t,e,n){const r=an(t);xu(t,e,Bs),await r._initializationPromise;const i=Xa(r,n);return await J0(i,r),i._openRedirect(r,e,"signInViaRedirect")}function G4(t,e,n){return W4(t,e,n)}async function W4(t,e,n){const r=We(t);xu(r.auth,e,Bs),await r.auth._initializationPromise;const i=Xa(r.auth,n);await J0(i,r.auth);const s=await $b(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function K4(t,e,n){return Q4(t,e,n)}async function Q4(t,e,n){const r=We(t);xu(r.auth,e,Bs),await r.auth._initializationPromise;const i=Xa(r.auth,n);await _p(!1,r,e.providerId),await J0(i,r.auth);const s=await $b(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function Y4(t,e){return await an(t)._initializationPromise,Tp(t,e,!1)}async function Tp(t,e,n=!1){const r=an(t),i=Xa(r,e),a=await new j4(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function $b(t){const e=Qh(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=10*60*1e3;class qb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!J4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Hb(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Hn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=X4&&this.cachedEventUids.clear(),this.cachedEventUids.has(O1(e))}saveEventToCache(e){this.cachedEventUids.add(O1(e)),this.lastProcessedEventTime=Date.now()}}function O1(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Hb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function J4(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gb(t,e={}){return hn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,e3=/^https?/;async function t3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Gb(t);for(const n of e)try{if(n3(n))return}catch{}Kn(t,"unauthorized-domain")}function n3(t){const e=lh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!e3.test(n))return!1;if(Z4.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=new Gh(3e4,6e4);function M1(){const t=wn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function i3(t){return new Promise((e,n)=>{var r,i,s;function a(){M1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{M1(),n(Hn(t,"network-request-failed"))},timeout:r3.get()})}if(!((i=(r=wn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=wn().gapi)===null||s===void 0)&&s.load)a();else{const u=wb("iframefcb");return wn()[u]=()=>{gapi.load?a():n(Hn(t,"network-request-failed"))},j0(`https://apis.google.com/js/api.js?onload=${u}`).catch(h=>n(h))}}).catch(e=>{throw If=null,e})}let If=null;function s3(t){return If=If||i3(t),If}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3=new Gh(5e3,15e3),a3="__/auth/iframe",l3="emulator/auth/iframe",u3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function h3(t){const e=t.config;Ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?B0(e,l3):`https://${t.config.authDomain}/${a3}`,r={apiKey:e.apiKey,appName:t.name,v:Uo},i=c3.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Su(r).slice(1)}`}async function d3(t){const e=await s3(t),n=wn().gapi;return Ie(n,t,"internal-error"),e.open({where:document.body,url:h3(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:u3,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=Hn(t,"network-request-failed"),u=wn().setTimeout(()=>{s(a)},o3.get());function h(){wn().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},g3=500,p3=600,m3="_blank",_3="http://localhost";class L1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function v3(t,e,n,r=g3,i=p3){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const h=Object.assign(Object.assign({},f3),{width:r.toString(),height:i.toString(),top:s,left:a}),g=tn().toLowerCase();n&&(u=gb(g)?m3:n),fb(g)&&(e=e||_3,h.scrollbars="yes");const m=Object.entries(h).reduce((T,[I,j])=>`${T}${I}=${j},`,"");if(BF(g)&&u!=="_self")return y3(e||"",u),new L1(null);const w=window.open(e||"",u,m);Ie(w,t,"popup-blocked");try{w.focus()}catch{}return new L1(w)}function y3(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3="__/auth/handler",E3="emulator/auth/handler",I3=encodeURIComponent("fac");async function Ov(t,e,n,r,i,s){Ie(t.config.authDomain,t,"auth-domain-config-required"),Ie(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Uo,eventId:i};if(e instanceof Bs){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",HL(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,w]of Object.entries(s||{}))a[m]=w}if(e instanceof bu){const m=e.getScopes().filter(w=>w!=="");m.length>0&&(a.scopes=m.join(","))}t.tenantId&&(a.tid=t.tenantId);const u=a;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const h=await t._getAppCheckToken(),g=h?`#${I3}=${encodeURIComponent(h)}`:"";return`${T3(t)}?${Su(u).slice(1)}${g}`}function T3({config:t}){return t.emulator?B0(t,E3):`https://${t.authDomain}/${w3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm="webStorageSupport";class S3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ma,this._completeRedirectFn=Tp,this._overrideRedirectResult=Z0}async _openPopup(e,n,r,i){var s;Ri((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Ov(e,n,r,lh(),i);return v3(e,a,Qh())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Ov(e,n,r,lh(),i);return s4(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Ri(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await d3(e),r=new qb(e);return n.register("authEvent",i=>(Ie(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qm,{type:Qm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Qm];a!==void 0&&n(!!a),Kn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=t3(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return vb()||U0()||Cu()}}const x3=S3;class C3{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Gi("unexpected MultiFactorSessionType")}}}class ew extends C3{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ew(e)}_finalizeEnroll(e,n,r){return X5(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return p4(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Wb{constructor(){}static assertion(e){return ew._fromCredential(e)}}Wb.FACTOR_ID="phone";var V1="@firebase/auth",F1="1.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function P3(t){xo(new rs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Ie(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yb(t)},g=new GF(r,i,s,h);return JF(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),xo(new rs("auth-internal",e=>{const n=an(e.getProvider("auth").getImmediate());return(r=>new A3(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),es(V1,F1,b3(t)),es(V1,F1,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3=5*60;ML("authIdTokenMaxAge");P3("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=2e3;async function N3(t,e,n){var r;const{BuildInfo:i}=Va();Ri(e.sessionId,"AuthEvent did not contain a session ID");const s=await V3(e.sessionId),a={};return Cu()?a.ibi=i.packageName:Wh()?a.apn=i.packageName:Kn(t,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,Ov(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function D3(t){const{BuildInfo:e}=Va(),n={};Cu()?n.iosBundleId=e.packageName:Wh()?n.androidPackageName=e.packageName:Kn(t,"operation-not-supported-in-this-environment"),await Gb(t,n)}function O3(t){const{cordova:e}=Va();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,FF()?"_blank":"_system","location=yes"),n(i)})})}async function M3(t,e,n){const{cordova:r}=Va();let i=()=>{};try{await new Promise((s,a)=>{let u=null;function h(){var w;s();const T=(w=r.plugins.browsertab)===null||w===void 0?void 0:w.close;typeof T=="function"&&T(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function g(){u||(u=window.setTimeout(()=>{a(Hn(t,"redirect-cancelled-by-user"))},k3))}function m(){(document==null?void 0:document.visibilityState)==="visible"&&g()}e.addPassiveListener(h),document.addEventListener("resume",g,!1),Wh()&&document.addEventListener("visibilitychange",m,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",g,!1),document.removeEventListener("visibilitychange",m,!1),u&&window.clearTimeout(u)}})}finally{i()}}function L3(t){var e,n,r,i,s,a,u,h,g,m;const w=Va();Ie(typeof((e=w==null?void 0:w.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ie(typeof((n=w==null?void 0:w.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ie(typeof((s=(i=(r=w==null?void 0:w.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ie(typeof((h=(u=(a=w==null?void 0:w.cordova)===null||a===void 0?void 0:a.plugins)===null||u===void 0?void 0:u.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ie(typeof((m=(g=w==null?void 0:w.cordova)===null||g===void 0?void 0:g.InAppBrowser)===null||m===void 0?void 0:m.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function V3(t){const e=F3(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function F3(t){if(Ri(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=20;class U3 extends qb{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function j3(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:q3(),postBody:null,tenantId:t.tenantId,error:Hn(t,"no-auth-event")}}function z3(t,e){return Mv()._set(Lv(t),e)}async function B1(t){const e=await Mv()._get(Lv(t));return e&&await Mv()._remove(Lv(t)),e}function $3(t,e){var n,r;const i=G3(e);if(i.includes("/__/auth/callback")){const s=Tf(i),a=s.firebaseError?H3(decodeURIComponent(s.firebaseError)):null,u=(r=(n=a==null?void 0:a.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],h=u?Hn(u):null;return h?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function q3(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<B3;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Mv(){return qr(K0)}function Lv(t){return xa("authEvent",t.config.apiKey,t.name)}function H3(t){try{return JSON.parse(t)}catch{return null}}function G3(t){const e=Tf(t),n=e.link?decodeURIComponent(e.link):void 0,r=Tf(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Tf(i).link||i||r||n||t}function Tf(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Dl(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3=500;class K3{constructor(){this._redirectPersistence=Ma,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Tp,this._overrideRedirectResult=Z0}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new U3(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Kn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){L3(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),$4(),await this._originValidation(e);const a=j3(e,r,i);await z3(e,a);const u=await N3(e,a,n),h=await O3(u);return M3(e,s,h)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=D3(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Va(),a=setTimeout(async()=>{await B1(e),n.onEvent(U1())},W3),u=async m=>{clearTimeout(a);const w=await B1(e);let T=null;w&&(m!=null&&m.url)&&(T=$3(w,m.url)),n.onEvent(T||U1())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,u);const h=i,g=`${s.packageName.toLowerCase()}://`;Va().handleOpenURL=async m=>{if(m.toLowerCase().startsWith(g)&&u({url:m}),typeof h=="function")try{h(m)}catch(w){console.error(w)}}}}const Q3=K3;function U1(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Hn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y3(t,e){an(t)._logFramework(e)}var X3="@firebase/auth-compat",J3="0.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3=1e3;function Dc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function eB(){return Dc()==="http:"||Dc()==="https:"}function Kb(t=tn()){return!!((Dc()==="file:"||Dc()==="ionic:"||Dc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function tB(){return D0()||N0()}function nB(){return GA()&&(document==null?void 0:document.documentMode)===11}function rB(t=tn()){return/Edge\/\d+/.test(t)}function iB(t=tn()){return nB()||rB(t)}function Qb(){try{const t=self.localStorage,e=Qh();if(t)return t.setItem(e,"1"),t.removeItem(e),iB()?sh():!0}catch{return tw()&&sh()}return!1}function tw(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Ym(){return(eB()||HA()||Kb())&&!tB()&&Qb()&&!tw()}function Yb(){return Kb()&&typeof document<"u"}async function sB(){return Yb()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},Z3);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function oB(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur={LOCAL:"local",NONE:"none",SESSION:"session"},Qu=Ie,Xb="persistence";function aB(t,e){if(Qu(Object.values(Ur).includes(e),t,"invalid-persistence-type"),D0()){Qu(e!==Ur.SESSION,t,"unsupported-persistence-type");return}if(N0()){Qu(e===Ur.NONE,t,"unsupported-persistence-type");return}if(tw()){Qu(e===Ur.NONE||e===Ur.LOCAL&&sh(),t,"unsupported-persistence-type");return}Qu(e===Ur.NONE||Qb(),t,"unsupported-persistence-type")}async function Vv(t){await t._initializationPromise;const e=Jb(),n=xa(Xb,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function lB(t,e){const n=Jb();if(!n)return[];const r=xa(Xb,t,e);switch(n.getItem(r)){case Ur.NONE:return[ou];case Ur.LOCAL:return[fh,Ma];case Ur.SESSION:return[Ma];default:return[]}}function Jb(){var t;try{return((t=oB())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB=Ie;class so{constructor(){this.browserResolver=qr(x3),this.cordovaResolver=qr(Q3),this.underlyingResolver=null,this._redirectPersistence=Ma,this._completeRedirectFn=Tp,this._overrideRedirectResult=Z0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Yb()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return uB(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await sB();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(t){return t.unwrap()}function cB(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(t){return eP(t)}function dB(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new fB(t,Q5(t,e))}else if(r){const i=eP(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function eP(t){const{_tokenResponse:e}=t instanceof mr?t.customData:t;if(!e)return null;if(!(t instanceof mr)&&"temporaryProof"in e&&"phoneNumber"in e)return La.credentialFromResult(t);const n=e.providerId;if(!n||n===Ku.PASSWORD)return null;let r;switch(n){case Ku.GOOGLE:r=zi;break;case Ku.FACEBOOK:r=ji;break;case Ku.GITHUB:r=$i;break;case Ku.TWITTER:r=qi;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:u,nonce:h}=e;return!s&&!a&&!i&&!u?null:u?n.startsWith("saml.")?au._create(n,u):is._fromParams({providerId:n,signInMethod:n,pendingToken:u,idToken:i,accessToken:s}):new Hl(n).credential({idToken:i,accessToken:s,rawNonce:h})}return t instanceof mr?r.credentialFromError(t):r.credentialFromResult(t)}function Sr(t,e){return e.catch(n=>{throw n instanceof mr&&dB(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:hB(n),additionalUserInfo:K5(n),user:Sp.getOrCreate(i)}})}async function Fv(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>Sr(t,n.confirm(r))}}class fB{constructor(e,n){this.resolver=n,this.auth=cB(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Sr(Zb(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sp=class gc{constructor(e){this._delegate=e,this.multiFactor=Z5(e)}static getOrCreate(e){return gc.USER_MAP.has(e)||gc.USER_MAP.set(e,new gc(e)),gc.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Sr(this.auth,bb(this._delegate,e))}async linkWithPhoneNumber(e,n){return Fv(this.auth,R4(this._delegate,e,n))}async linkWithPopup(e){return Sr(this.auth,B4(this._delegate,e,so))}async linkWithRedirect(e){return await Vv(an(this.auth)),K4(this._delegate,e,so)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Sr(this.auth,Pb(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Fv(this.auth,k4(this._delegate,e,n))}reauthenticateWithPopup(e){return Sr(this.auth,F4(this._delegate,e,so))}async reauthenticateWithRedirect(e){return await Vv(an(this.auth)),G4(this._delegate,e,so)}sendEmailVerification(e){return V5(this._delegate,e)}async unlink(e){return await T5(this._delegate,e),this}updateEmail(e){return j5(this._delegate,e)}updatePassword(e){return z5(this._delegate,e)}updatePhoneNumber(e){return N4(this._delegate,e)}updateProfile(e){return U5(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return F5(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Sp.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu=Ie;class Bv{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Yu(r,"invalid-api-key",{appName:e.name}),Yu(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?so:void 0;this._delegate=n.initialize({options:{persistence:gB(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(gF),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Sp.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){ZF(this._delegate,e,n)}applyActionCode(e){return b5(this._delegate,e)}checkActionCode(e){return Rb(this._delegate,e)}confirmPasswordReset(e,n){return A5(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Sr(this._delegate,R5(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return L5(this._delegate,e)}isSignInWithEmailLink(e){return D5(this._delegate,e)}async getRedirectResult(){Yu(Ym(),this._delegate,"operation-not-supported-in-this-environment");const e=await Y4(this._delegate,so);return e?Sr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){Y3(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:a}=j1(e,n,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:a}=j1(e,n,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,n){return N5(this._delegate,e,n)}sendPasswordResetEmail(e,n){return C5(this._delegate,e,n||void 0)}async setPersistence(e){aB(this._delegate,e);let n;switch(e){case Ur.SESSION:n=Ma;break;case Ur.LOCAL:n=await qr(fh)._isAvailable()?fh:K0;break;case Ur.NONE:n=ou;break;default:return Kn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Sr(this._delegate,I5(this._delegate))}signInWithCredential(e){return Sr(this._delegate,vp(this._delegate,e))}signInWithCustomToken(e){return Sr(this._delegate,x5(this._delegate,e))}signInWithEmailAndPassword(e,n){return Sr(this._delegate,k5(this._delegate,e,n))}signInWithEmailLink(e,n){return Sr(this._delegate,O5(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Fv(this._delegate,P4(this._delegate,e,n))}async signInWithPopup(e){return Yu(Ym(),this._delegate,"operation-not-supported-in-this-environment"),Sr(this._delegate,V4(this._delegate,e,so))}async signInWithRedirect(e){return Yu(Ym(),this._delegate,"operation-not-supported-in-this-environment"),await Vv(this._delegate),q4(this._delegate,e,so)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return P5(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Bv.Persistence=Ur;function j1(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:a=>i(a&&Sp.getOrCreate(a)),error:e,complete:n}}function gB(t,e){const n=lB(t,e);if(typeof self<"u"&&!n.includes(fh)&&n.push(fh),typeof window<"u")for(const r of[K0,Ma])n.includes(r)||n.push(r);return n.includes(ou)||n.push(ou),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(){this.providerId="phone",this._delegate=new La(Zb(jt.auth()))}static credential(e,n){return La.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}nw.PHONE_SIGN_IN_METHOD=La.PHONE_SIGN_IN_METHOD;nw.PROVIDER_ID=La.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pB=Ie;class mB{constructor(e,n,r=jt.app()){var i;pB((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new A4(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B="auth-compat";function vB(t){t.INTERNAL.registerComponent(new rs(_B,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Bv(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ol.EMAIL_SIGNIN,PASSWORD_RESET:ol.PASSWORD_RESET,RECOVER_EMAIL:ol.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ol.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ol.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ol.VERIFY_EMAIL}},EmailAuthProvider:jo,FacebookAuthProvider:ji,GithubAuthProvider:$i,GoogleAuthProvider:zi,OAuthProvider:Hl,SAMLAuthProvider:hg,PhoneAuthProvider:nw,PhoneMultiFactorGenerator:Wb,RecaptchaVerifier:mB,TwitterAuthProvider:qi,Auth:Bv,AuthCredential:Au,Error:mr}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(X3,J3)}vB(jt);var yB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},De,rw=rw||{},tt=yB||self;function xp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Xh(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function wB(t){return Object.prototype.hasOwnProperty.call(t,Xm)&&t[Xm]||(t[Xm]=++EB)}var Xm="closure_uid_"+(1e9*Math.random()>>>0),EB=0;function IB(t,e,n){return t.call.apply(t.bind,arguments)}function TB(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function rr(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?rr=IB:rr=TB,rr.apply(null,arguments)}function Gd(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ln(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var a=Array(arguments.length-2),u=2;u<arguments.length;u++)a[u-2]=arguments[u];return e.prototype[i].apply(r,a)}}function zo(){this.s=this.s,this.o=this.o}var SB=0;zo.prototype.s=!1;zo.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),SB!=0)&&wB(this)};zo.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const tP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function iw(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function z1(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(xp(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let a=0;a<s;a++)t[i+a]=r[a]}else t.push(r)}}function ir(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ir.prototype.h=function(){this.defaultPrevented=!0};var xB=function(){if(!tt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};tt.addEventListener("test",n,e),tt.removeEventListener("test",n,e)}catch{}return t}();function gh(t){return/^[\s\xa0]*$/.test(t)}function Cp(){var t=tt.navigator;return t&&(t=t.userAgent)?t:""}function Hi(t){return Cp().indexOf(t)!=-1}function sw(t){return sw[" "](t),t}sw[" "]=function(){};function CB(t,e){var n=v6;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var AB=Hi("Opera"),lu=Hi("Trident")||Hi("MSIE"),nP=Hi("Edge"),Uv=nP||lu,rP=Hi("Gecko")&&!(Cp().toLowerCase().indexOf("webkit")!=-1&&!Hi("Edge"))&&!(Hi("Trident")||Hi("MSIE"))&&!Hi("Edge"),bB=Cp().toLowerCase().indexOf("webkit")!=-1&&!Hi("Edge");function iP(){var t=tt.document;return t?t.documentMode:void 0}var jv;e:{var Jm="",Zm=function(){var t=Cp();if(rP)return/rv:([^\);]+)(\)|;)/.exec(t);if(nP)return/Edge\/([\d\.]+)/.exec(t);if(lu)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(bB)return/WebKit\/(\S+)/.exec(t);if(AB)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Zm&&(Jm=Zm?Zm[1]:""),lu){var e_=iP();if(e_!=null&&e_>parseFloat(Jm)){jv=String(e_);break e}}jv=Jm}var zv;if(tt.document&&lu){var $1=iP();zv=$1||parseInt(jv,10)||void 0}else zv=void 0;var PB=zv;function ph(t,e){if(ir.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(rP){e:{try{sw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:RB[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ph.$.h.call(this)}}Ln(ph,ir);var RB={2:"touch",3:"pen",4:"mouse"};ph.prototype.h=function(){ph.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Jh="closure_listenable_"+(1e6*Math.random()|0),kB=0;function NB(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++kB,this.fa=this.ia=!1}function Ap(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function ow(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function DB(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function sP(t){const e={};for(const n in t)e[n]=t[n];return e}const q1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<q1.length;s++)n=q1[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bp(t){this.src=t,this.g={},this.h=0}bp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var a=qv(t,e,r,i);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new NB(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function $v(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=tP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ap(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function qv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var aw="closure_lm_"+(1e6*Math.random()|0),t_={};function aP(t,e,n,r,i){if(r&&r.once)return uP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)aP(t,e[s],n,r,i);return null}return n=cw(n),t&&t[Jh]?t.O(e,n,Xh(r)?!!r.capture:!!r,i):lP(t,e,n,!1,r,i)}function lP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var a=Xh(i)?!!i.capture:!!i,u=uw(t);if(u||(t[aw]=u=new bp(t)),n=u.add(e,n,r,a,s),n.proxy)return n;if(r=OB(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)xB||(i=a),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(hP(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function OB(){function t(n){return e.call(t.src,t.listener,n)}const e=MB;return t}function uP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)uP(t,e[s],n,r,i);return null}return n=cw(n),t&&t[Jh]?t.P(e,n,Xh(r)?!!r.capture:!!r,i):lP(t,e,n,!0,r,i)}function cP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)cP(t,e[s],n,r,i);else r=Xh(r)?!!r.capture:!!r,n=cw(n),t&&t[Jh]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=qv(s,n,r,i),-1<n&&(Ap(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=uw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=qv(e,n,r,i)),(n=-1<t?e[t]:null)&&lw(n))}function lw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Jh])$v(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(hP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=uw(e))?($v(n,t),n.h==0&&(n.src=null,e[aw]=null)):Ap(t)}}}function hP(t){return t in t_?t_[t]:t_[t]="on"+t}function MB(t,e){if(t.fa)t=!0;else{e=new ph(e,this);var n=t.listener,r=t.la||t.src;t.ia&&lw(t),t=n.call(r,e)}return t}function uw(t){return t=t[aw],t instanceof bp?t:null}var n_="__closure_events_fn_"+(1e9*Math.random()>>>0);function cw(t){return typeof t=="function"?t:(t[n_]||(t[n_]=function(e){return t.handleEvent(e)}),t[n_])}function On(){zo.call(this),this.i=new bp(this),this.S=this,this.J=null}Ln(On,zo);On.prototype[Jh]=!0;On.prototype.removeEventListener=function(t,e,n,r){cP(this,t,e,n,r)};function Gn(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new ir(e,t);else if(e instanceof ir)e.target=e.target||t;else{var i=e;e=new ir(r,t),oP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=e.g=n[s];i=Wd(a,r,!0,e)&&i}if(a=e.g=t,i=Wd(a,r,!0,e)&&i,i=Wd(a,r,!1,e)&&i,n)for(s=0;s<n.length;s++)a=e.g=n[s],i=Wd(a,r,!1,e)&&i}On.prototype.N=function(){if(On.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ap(n[r]);delete t.g[e],t.h--}}this.J=null};On.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};On.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Wd(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==n){var u=a.listener,h=a.la||a.src;a.ia&&$v(t.i,a),i=u.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var hw=tt.JSON.stringify;class LB{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function VB(){var t=dw;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class FB{constructor(){this.h=this.g=null}add(e,n){const r=dP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var dP=new LB(()=>new BB,t=>t.reset());class BB{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function UB(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function jB(t){tt.setTimeout(()=>{throw t},0)}let mh,_h=!1,dw=new FB,fP=()=>{const t=tt.Promise.resolve(void 0);mh=()=>{t.then(zB)}};var zB=()=>{for(var t;t=VB();){try{t.h.call(t.g)}catch(n){jB(n)}var e=dP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}_h=!1};function Pp(t,e){On.call(this),this.h=t||1,this.g=e||tt,this.j=rr(this.qb,this),this.l=Date.now()}Ln(Pp,On);De=Pp.prototype;De.ga=!1;De.T=null;De.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Gn(this,"tick"),this.ga&&(fw(this),this.start()))}};De.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function fw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}De.N=function(){Pp.$.N.call(this),fw(this),delete this.g};function gw(t,e,n){if(typeof t=="function")n&&(t=rr(t,n));else if(t&&typeof t.handleEvent=="function")t=rr(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:tt.setTimeout(t,e||0)}function gP(t){t.g=gw(()=>{t.g=null,t.i&&(t.i=!1,gP(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class $B extends zo{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:gP(this)}N(){super.N(),this.g&&(tt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vh(t){zo.call(this),this.h=t,this.g={}}Ln(vh,zo);var H1=[];function pP(t,e,n,r){Array.isArray(n)||(n&&(H1[0]=n.toString()),n=H1);for(var i=0;i<n.length;i++){var s=aP(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function mP(t){ow(t.g,function(e,n){this.g.hasOwnProperty(n)&&lw(e)},t),t.g={}}vh.prototype.N=function(){vh.$.N.call(this),mP(this)};vh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Rp(){this.g=!0}Rp.prototype.Ea=function(){this.g=!1};function qB(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var a="",u=s.split("&"),h=0;h<u.length;h++){var g=u[h].split("=");if(1<g.length){var m=g[0];g=g[1];var w=m.split("_");a=2<=w.length&&w[1]=="type"?a+(m+"="+g+"&"):a+(m+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+a})}function HB(t,e,n,r,i,s,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+a})}function Ol(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+WB(t,n)+(r?" "+r:"")})}function GB(t,e){t.info(function(){return"TIMEOUT: "+e})}Rp.prototype.info=function(){};function WB(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return hw(n)}catch{return e}}var Ja={},G1=null;function kp(){return G1=G1||new On}Ja.Ta="serverreachability";function _P(t){ir.call(this,Ja.Ta,t)}Ln(_P,ir);function yh(t){const e=kp();Gn(e,new _P(e))}Ja.STAT_EVENT="statevent";function vP(t,e){ir.call(this,Ja.STAT_EVENT,t),this.stat=e}Ln(vP,ir);function fr(t){const e=kp();Gn(e,new vP(e,t))}Ja.Ua="timingevent";function yP(t,e){ir.call(this,Ja.Ua,t),this.size=e}Ln(yP,ir);function Zh(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return tt.setTimeout(function(){t()},e)}var Np={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},wP={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function pw(){}pw.prototype.h=null;function W1(t){return t.h||(t.h=t.i())}function EP(){}var ed={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function mw(){ir.call(this,"d")}Ln(mw,ir);function _w(){ir.call(this,"c")}Ln(_w,ir);var Hv;function Dp(){}Ln(Dp,pw);Dp.prototype.g=function(){return new XMLHttpRequest};Dp.prototype.i=function(){return{}};Hv=new Dp;function td(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new vh(this),this.P=KB,t=Uv?125:void 0,this.V=new Pp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new IP}function IP(){this.i=null,this.g="",this.h=!1}var KB=45e3,TP={},Gv={};De=td.prototype;De.setTimeout=function(t){this.P=t};function Wv(t,e,n){t.L=1,t.A=Mp(Ds(e)),t.u=n,t.S=!0,SP(t,null)}function SP(t,e){t.G=Date.now(),nd(t),t.B=Ds(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),NP(n.i,"t",r),t.o=0,n=t.l.J,t.h=new IP,t.g=ZP(t.l,n?e:null,!t.u),0<t.O&&(t.M=new $B(rr(t.Pa,t,t.g),t.O)),pP(t.U,t.g,"readystatechange",t.nb),e=t.I?sP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),yh(),qB(t.j,t.v,t.B,t.m,t.W,t.u)}De.nb=function(t){t=t.target;const e=this.M;e&&Wi(t)==3?e.l():this.Pa(t)};De.Pa=function(t){try{if(t==this.g)e:{const m=Wi(this.g);var e=this.g.Ia();const w=this.g.da();if(!(3>m)&&(m!=3||Uv||this.g&&(this.h.h||this.g.ja()||X1(this.g)))){this.J||m!=4||e==7||(e==8||0>=w?yh(3):yh(2)),Op(this);var n=this.g.da();this.ca=n;t:if(xP(this)){var r=X1(this.g);t="";var i=r.length,s=Wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_a(this),Oc(this);var a="";break t}this.h.i=new tt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,HB(this.j,this.v,this.B,this.m,this.W,m,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var u,h=this.g;if((u=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!gh(u)){var g=u;break t}}g=null}if(n=g)Ol(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Kv(this,n);else{this.i=!1,this.s=3,fr(12),_a(this),Oc(this);break e}}this.S?(CP(this,m,a),Uv&&this.i&&m==3&&(pP(this.U,this.V,"tick",this.mb),this.V.start())):(Ol(this.j,this.m,a,null),Kv(this,a)),m==4&&_a(this),this.i&&!this.J&&(m==4?QP(this.l,this):(this.i=!1,nd(this)))}else p6(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.s=3,fr(12)):(this.s=0,fr(13)),_a(this),Oc(this)}}}catch{}finally{}};function xP(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function CP(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=QB(t,n),i==Gv){e==4&&(t.s=4,fr(14),r=!1),Ol(t.j,t.m,null,"[Incomplete Response]");break}else if(i==TP){t.s=4,fr(15),Ol(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ol(t.j,t.m,i,null),Kv(t,i);xP(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,fr(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Tw(e),e.M=!0,fr(11))):(Ol(t.j,t.m,n,"[Invalid Chunked Response]"),_a(t),Oc(t))}De.mb=function(){if(this.g){var t=Wi(this.g),e=this.g.ja();this.o<e.length&&(Op(this),CP(this,t,e),this.i&&t!=4&&nd(this))}};function QB(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Gv:(n=Number(e.substring(n,r)),isNaN(n)?TP:(r+=1,r+n>e.length?Gv:(e=e.slice(r,r+n),t.o=r+n,e)))}De.cancel=function(){this.J=!0,_a(this)};function nd(t){t.Y=Date.now()+t.P,AP(t,t.P)}function AP(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Zh(rr(t.lb,t),e)}function Op(t){t.C&&(tt.clearTimeout(t.C),t.C=null)}De.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(GB(this.j,this.B),this.L!=2&&(yh(),fr(17)),_a(this),this.s=2,Oc(this)):AP(this,this.Y-t)};function Oc(t){t.l.H==0||t.J||QP(t.l,t)}function _a(t){Op(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,fw(t.V),mP(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Kv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Qv(n.i,t))){if(!t.K&&Qv(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)_g(n),Bp(n);else break e;Iw(n),fr(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Zh(rr(n.ib,n),6e3));if(1>=MP(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else va(n,11)}else if((t.K||n.g==t)&&_g(n),!gh(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let g=i[e];if(n.V=g[0],g=g[1],n.H==2)if(g[0]=="c"){n.K=g[1],n.pa=g[2];const m=g[3];m!=null&&(n.ra=m,n.l.info("VER="+n.ra));const w=g[4];w!=null&&(n.Ga=w,n.l.info("SVER="+n.Ga));const T=g[5];T!=null&&typeof T=="number"&&0<T&&(r=1.5*T,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const I=t.g;if(I){const j=I.g?I.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(j){var s=r.i;s.g||j.indexOf("spdy")==-1&&j.indexOf("quic")==-1&&j.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(vw(s,s.h),s.h=null))}if(r.F){const z=I.g?I.g.getResponseHeader("X-HTTP-Session-Id"):null;z&&(r.Da=z,zt(r.I,r.F,z))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=JP(r,r.J?r.pa:null,r.Y),a.K){LP(r.i,a);var u=a,h=r.L;h&&u.setTimeout(h),u.C&&(Op(u),nd(u)),r.g=a}else WP(r);0<n.j.length&&Up(n)}else g[0]!="stop"&&g[0]!="close"||va(n,7);else n.H==3&&(g[0]=="stop"||g[0]=="close"?g[0]=="stop"?va(n,7):Ew(n):g[0]!="noop"&&n.h&&n.h.Aa(g),n.A=0)}}yh(4)}catch{}}function YB(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(xp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function XB(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(xp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function bP(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(xp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=XB(t),r=YB(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var PP=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function JB(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Aa(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Aa){this.h=t.h,pg(this,t.j),this.s=t.s,this.g=t.g,mg(this,t.m),this.l=t.l;var e=t.i,n=new wh;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),K1(this,n),this.o=t.o}else t&&(e=String(t).match(PP))?(this.h=!1,pg(this,e[1]||"",!0),this.s=pc(e[2]||""),this.g=pc(e[3]||"",!0),mg(this,e[4]),this.l=pc(e[5]||"",!0),K1(this,e[6]||"",!0),this.o=pc(e[7]||"")):(this.h=!1,this.i=new wh(null,this.h))}Aa.prototype.toString=function(){var t=[],e=this.j;e&&t.push(mc(e,Q1,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(mc(e,Q1,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(mc(n,n.charAt(0)=="/"?t6:e6,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",mc(n,r6)),t.join("")};function Ds(t){return new Aa(t)}function pg(t,e,n){t.j=n?pc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function mg(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function K1(t,e,n){e instanceof wh?(t.i=e,i6(t.i,t.h)):(n||(e=mc(e,n6)),t.i=new wh(e,t.h))}function zt(t,e,n){t.i.set(e,n)}function Mp(t){return zt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function pc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function mc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,ZB),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ZB(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Q1=/[#\/\?@]/g,e6=/[#\?:]/g,t6=/[#\?]/g,n6=/[#\?@]/g,r6=/#/g;function wh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function $o(t){t.g||(t.g=new Map,t.h=0,t.i&&JB(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}De=wh.prototype;De.add=function(t,e){$o(this),this.i=null,t=Pu(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function RP(t,e){$o(t),e=Pu(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function kP(t,e){return $o(t),e=Pu(t,e),t.g.has(e)}De.forEach=function(t,e){$o(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};De.ta=function(){$o(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};De.Z=function(t){$o(this);let e=[];if(typeof t=="string")kP(this,t)&&(e=e.concat(this.g.get(Pu(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};De.set=function(t,e){return $o(this),this.i=null,t=Pu(this,t),kP(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};De.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function NP(t,e,n){RP(t,e),0<n.length&&(t.i=null,t.g.set(Pu(t,e),iw(n)),t.h+=n.length)}De.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),t.push(i)}}return this.i=t.join("&")};function Pu(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function i6(t,e){e&&!t.j&&($o(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(RP(this,r),NP(this,i,n))},t)),t.j=e}var s6=class{constructor(t,e){this.g=t,this.map=e}};function DP(t){this.l=t||o6,tt.PerformanceNavigationTiming?(t=tt.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(tt.g&&tt.g.Ka&&tt.g.Ka()&&tt.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var o6=10;function OP(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function MP(t){return t.h?1:t.g?t.g.size:0}function Qv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function vw(t,e){t.g?t.g.add(e):t.h=e}function LP(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}DP.prototype.cancel=function(){if(this.i=VP(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function VP(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return iw(t.i)}var a6=class{stringify(t){return tt.JSON.stringify(t,void 0)}parse(t){return tt.JSON.parse(t,void 0)}};function l6(){this.g=new a6}function u6(t,e,n){const r=n||"";try{bP(t,function(i,s){let a=i;Xh(i)&&(a=hw(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function c6(t,e){const n=new Rp;if(tt.Image){const r=new Image;r.onload=Gd(Kd,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Gd(Kd,n,r,"TestLoadImage: error",!1,e),r.onabort=Gd(Kd,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Gd(Kd,n,r,"TestLoadImage: timeout",!1,e),tt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Kd(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Lp(t){this.l=t.ec||null,this.j=t.ob||!1}Ln(Lp,pw);Lp.prototype.g=function(){return new Vp(this.l,this.j)};Lp.prototype.i=function(t){return function(){return t}}({});function Vp(t,e){On.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=yw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ln(Vp,On);var yw=0;De=Vp.prototype;De.open=function(t,e){if(this.readyState!=yw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Eh(this)};De.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||tt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};De.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,rd(this)),this.readyState=yw};De.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Eh(this)),this.g&&(this.readyState=3,Eh(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof tt.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;FP(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function FP(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}De.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?rd(this):Eh(this),this.readyState==3&&FP(this)}};De.Za=function(t){this.g&&(this.response=this.responseText=t,rd(this))};De.Ya=function(t){this.g&&(this.response=t,rd(this))};De.ka=function(){this.g&&rd(this)};function rd(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Eh(t)}De.setRequestHeader=function(t,e){this.v.append(t,e)};De.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};De.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Eh(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Vp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var h6=tt.JSON.parse;function ln(t){On.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=BP,this.L=this.M=!1}Ln(ln,On);var BP="",d6=/^https?$/i,f6=["POST","PUT"];De=ln.prototype;De.Oa=function(t){this.M=t};De.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Hv.g(),this.C=this.u?W1(this.u):W1(Hv),this.g.onreadystatechange=rr(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Y1(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=tt.FormData&&t instanceof tt.FormData,!(0<=tP(f6,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{zP(this),0<this.B&&((this.L=g6(this.g))?(this.g.timeout=this.B,this.g.ontimeout=rr(this.ua,this)):this.A=gw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Y1(this,s)}};function g6(t){return lu&&typeof t.timeout=="number"&&t.ontimeout!==void 0}De.ua=function(){typeof rw<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Gn(this,"timeout"),this.abort(8))};function Y1(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,UP(t),Fp(t)}function UP(t){t.F||(t.F=!0,Gn(t,"complete"),Gn(t,"error"))}De.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Gn(this,"complete"),Gn(this,"abort"),Fp(this))};De.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Fp(this,!0)),ln.$.N.call(this)};De.La=function(){this.s||(this.G||this.v||this.l?jP(this):this.kb())};De.kb=function(){jP(this)};function jP(t){if(t.h&&typeof rw<"u"&&(!t.C[1]||Wi(t)!=4||t.da()!=2)){if(t.v&&Wi(t)==4)gw(t.La,0,t);else if(Gn(t,"readystatechange"),Wi(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var i=String(t.I).match(PP)[1]||null;!i&&tt.self&&tt.self.location&&(i=tt.self.location.protocol.slice(0,-1)),r=!d6.test(i?i.toLowerCase():"")}n=r}if(n)Gn(t,"complete"),Gn(t,"success");else{t.m=6;try{var s=2<Wi(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",UP(t)}}finally{Fp(t)}}}}function Fp(t,e){if(t.g){zP(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Gn(t,"ready");try{n.onreadystatechange=r}catch{}}}function zP(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(tt.clearTimeout(t.A),t.A=null)}De.isActive=function(){return!!this.g};function Wi(t){return t.g?t.g.readyState:0}De.da=function(){try{return 2<Wi(this)?this.g.status:-1}catch{return-1}};De.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};De.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),h6(e)}};function X1(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case BP:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function p6(t){const e={};t=(t.g&&2<=Wi(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(gh(t[r]))continue;var n=UB(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}DB(e,function(r){return r.join(", ")})}De.Ia=function(){return this.m};De.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function $P(t){let e="";return ow(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function ww(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=$P(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):zt(t,e,n))}function Xu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qP(t){this.Ga=0,this.j=[],this.l=new Rp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Xu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Xu("baseRetryDelayMs",5e3,t),this.hb=Xu("retryDelaySeedMs",1e4,t),this.eb=Xu("forwardChannelMaxRetries",2,t),this.xa=Xu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new DP(t&&t.concurrentRequestLimit),this.Ja=new l6,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}De=qP.prototype;De.ra=8;De.H=1;function Ew(t){if(HP(t),t.H==3){var e=t.W++,n=Ds(t.I);if(zt(n,"SID",t.K),zt(n,"RID",e),zt(n,"TYPE","terminate"),id(t,n),e=new td(t,t.l,e),e.L=2,e.A=Mp(Ds(n)),n=!1,tt.navigator&&tt.navigator.sendBeacon)try{n=tt.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&tt.Image&&(new Image().src=e.A,n=!0),n||(e.g=ZP(e.l,null),e.g.ha(e.A)),e.G=Date.now(),nd(e)}XP(t)}function Bp(t){t.g&&(Tw(t),t.g.cancel(),t.g=null)}function HP(t){Bp(t),t.u&&(tt.clearTimeout(t.u),t.u=null),_g(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&tt.clearTimeout(t.m),t.m=null)}function Up(t){if(!OP(t.i)&&!t.m){t.m=!0;var e=t.Na;mh||fP(),_h||(mh(),_h=!0),dw.add(e,t),t.C=0}}function m6(t,e){return MP(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Zh(rr(t.Na,t,e),YP(t,t.C)),t.C++,!0)}De.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new td(this,this.l,t);let s=this.s;if(this.U&&(s?(s=sP(s),oP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=GP(this,i,e),n=Ds(this.I),zt(n,"RID",t),zt(n,"CVER",22),this.F&&zt(n,"X-HTTP-Session-Id",this.F),id(this,n),s&&(this.O?e="headers="+encodeURIComponent(String($P(s)))+"&"+e:this.o&&ww(n,this.o,s)),vw(this.i,i),this.bb&&zt(n,"TYPE","init"),this.P?(zt(n,"$req",e),zt(n,"SID","null"),i.aa=!0,Wv(i,n,null)):Wv(i,n,e),this.H=2}}else this.H==3&&(t?J1(this,t):this.j.length==0||OP(this.i)||J1(this))};function J1(t,e){var n;e?n=e.m:n=t.W++;const r=Ds(t.I);zt(r,"SID",t.K),zt(r,"RID",n),zt(r,"AID",t.V),id(t,r),t.o&&t.s&&ww(r,t.o,t.s),n=new td(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=GP(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),vw(t.i,n),Wv(n,r,e)}function id(t,e){t.na&&ow(t.na,function(n,r){zt(e,r,n)}),t.h&&bP({},function(n,r){zt(e,r,n)})}function GP(t,e,n){n=Math.min(t.j.length,n);var r=t.h?rr(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const a=["count="+n];s==-1?0<n?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let u=!0;for(let h=0;h<n;h++){let g=i[h].g;const m=i[h].map;if(g-=s,0>g)s=Math.max(0,i[h].g-100),u=!1;else try{u6(m,a,"req"+g+"_")}catch{r&&r(m)}}if(u){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function WP(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;mh||fP(),_h||(mh(),_h=!0),dw.add(e,t),t.A=0}}function Iw(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Zh(rr(t.Ma,t),YP(t,t.A)),t.A++,!0)}De.Ma=function(){if(this.u=null,KP(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Zh(rr(this.jb,this),t)}};De.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,fr(10),Bp(this),KP(this))};function Tw(t){t.B!=null&&(tt.clearTimeout(t.B),t.B=null)}function KP(t){t.g=new td(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ds(t.wa);zt(e,"RID","rpc"),zt(e,"SID",t.K),zt(e,"AID",t.V),zt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&zt(e,"TO",t.qa),zt(e,"TYPE","xmlhttp"),id(t,e),t.o&&t.s&&ww(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Mp(Ds(e)),n.u=null,n.S=!0,SP(n,t)}De.ib=function(){this.v!=null&&(this.v=null,Bp(this),Iw(this),fr(19))};function _g(t){t.v!=null&&(tt.clearTimeout(t.v),t.v=null)}function QP(t,e){var n=null;if(t.g==e){_g(t),Tw(t),t.g=null;var r=2}else if(Qv(t.i,e))n=e.F,LP(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=kp(),Gn(r,new yP(r,n)),Up(t)}else WP(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&m6(t,e)||r==2&&Iw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:va(t,5);break;case 4:va(t,10);break;case 3:va(t,6);break;default:va(t,2)}}}function YP(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function va(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=rr(t.pb,t);n||(n=new Aa("//www.google.com/images/cleardot.gif"),tt.location&&tt.location.protocol=="http"||pg(n,"https"),Mp(n)),c6(n.toString(),r)}else fr(2);t.H=0,t.h&&t.h.za(e),XP(t),HP(t)}De.pb=function(t){t?(this.l.info("Successfully pinged google.com"),fr(2)):(this.l.info("Failed to ping google.com"),fr(1))};function XP(t){if(t.H=0,t.ma=[],t.h){const e=VP(t.i);(e.length!=0||t.j.length!=0)&&(z1(t.ma,e),z1(t.ma,t.j),t.i.i.length=0,iw(t.j),t.j.length=0),t.h.ya()}}function JP(t,e,n){var r=n instanceof Aa?Ds(n):new Aa(n);if(r.g!="")e&&(r.g=e+"."+r.g),mg(r,r.m);else{var i=tt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Aa(null);r&&pg(s,r),e&&(s.g=e),i&&mg(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&zt(r,n,e),zt(r,"VER",t.ra),id(t,r),r}function ZP(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new ln(new Lp({ob:n})):new ln(t.va),e.Oa(t.J),e}De.isActive=function(){return!!this.h&&this.h.isActive(this)};function eR(){}De=eR.prototype;De.Ba=function(){};De.Aa=function(){};De.za=function(){};De.ya=function(){};De.isActive=function(){return!0};De.Va=function(){};function vg(){if(lu&&!(10<=Number(PB)))throw Error("Environmental error: no available transport.")}vg.prototype.g=function(t,e){return new Kr(t,e)};function Kr(t,e){On.call(this),this.g=new qP(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!gh(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!gh(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ru(this)}Ln(Kr,On);Kr.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;fr(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=JP(t,null,t.Y),Up(t)};Kr.prototype.close=function(){Ew(this.g)};Kr.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=hw(t),t=n);e.j.push(new s6(e.fb++,t)),e.H==3&&Up(e)};Kr.prototype.N=function(){this.g.h=null,delete this.j,Ew(this.g),delete this.g,Kr.$.N.call(this)};function tR(t){mw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ln(tR,mw);function nR(){_w.call(this),this.status=1}Ln(nR,_w);function Ru(t){this.g=t}Ln(Ru,eR);Ru.prototype.Ba=function(){Gn(this.g,"a")};Ru.prototype.Aa=function(t){Gn(this.g,new tR(t))};Ru.prototype.za=function(t){Gn(this.g,new nR)};Ru.prototype.ya=function(){Gn(this.g,"b")};function _6(){this.blockSize=-1}function ki(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ln(ki,_6);ki.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function r_(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],a=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}ki.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)r_(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){r_(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){r_(this,r),i=0;break}}this.h=i,this.i+=e};ki.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Pt(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var v6={};function Sw(t){return-128<=t&&128>t?CB(t,function(e){return new Pt([e|0],0>e?-1:0)}):new Pt([t|0],0>t?-1:0)}function Ki(t){if(isNaN(t)||!isFinite(t))return Wl;if(0>t)return zn(Ki(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Yv;return new Pt(e,0)}function rR(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return zn(rR(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ki(Math.pow(e,8)),r=Wl,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),a=parseInt(t.substring(i,i+s),e);8>s?(s=Ki(Math.pow(e,s)),r=r.R(s).add(Ki(a))):(r=r.R(n),r=r.add(Ki(a)))}return r}var Yv=4294967296,Wl=Sw(0),Xv=Sw(1),Z1=Sw(16777216);De=Pt.prototype;De.ea=function(){if(si(this))return-zn(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Yv+r)*e,e*=Yv}return t};De.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Es(this))return"0";if(si(this))return"-"+zn(this).toString(t);for(var e=Ki(Math.pow(t,6)),n=this,r="";;){var i=wg(n,e).g;n=yg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Es(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};De.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Es(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function si(t){return t.h==-1}De.X=function(t){return t=yg(this,t),si(t)?-1:Es(t)?0:1};function zn(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Pt(n,~t.h).add(Xv)}De.abs=function(){return si(this)?zn(this):this};De.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new Pt(n,n[n.length-1]&-2147483648?-1:0)};function yg(t,e){return t.add(zn(e))}De.R=function(t){if(Es(this)||Es(t))return Wl;if(si(this))return si(t)?zn(this).R(zn(t)):zn(zn(this).R(t));if(si(t))return zn(this.R(zn(t)));if(0>this.X(Z1)&&0>t.X(Z1))return Ki(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,u=t.D(i)>>>16,h=t.D(i)&65535;n[2*r+2*i]+=a*h,Qd(n,2*r+2*i),n[2*r+2*i+1]+=s*h,Qd(n,2*r+2*i+1),n[2*r+2*i+1]+=a*u,Qd(n,2*r+2*i+1),n[2*r+2*i+2]+=s*u,Qd(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Pt(n,0)};function Qd(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ju(t,e){this.g=t,this.h=e}function wg(t,e){if(Es(e))throw Error("division by zero");if(Es(t))return new Ju(Wl,Wl);if(si(t))return e=wg(zn(t),e),new Ju(zn(e.g),zn(e.h));if(si(e))return e=wg(t,zn(e)),new Ju(zn(e.g),e.h);if(30<t.g.length){if(si(t)||si(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Xv,r=e;0>=r.X(t);)n=eT(n),r=eT(r);var i=al(n,1),s=al(r,1);for(r=al(r,2),n=al(n,2);!Es(r);){var a=s.add(r);0>=a.X(t)&&(i=i.add(n),s=a),r=al(r,1),n=al(n,1)}return e=yg(t,i.R(e)),new Ju(i,e)}for(i=Wl;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ki(n),a=s.R(e);si(a)||0<a.X(t);)n-=r,s=Ki(n),a=s.R(e);Es(s)&&(s=Xv),i=i.add(s),t=yg(t,a)}return new Ju(i,t)}De.gb=function(t){return wg(this,t).h};De.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Pt(n,this.h&t.h)};De.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Pt(n,this.h|t.h)};De.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Pt(n,this.h^t.h)};function eT(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Pt(n,t.h)}function al(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Pt(i,t.h)}vg.prototype.createWebChannel=vg.prototype.g;Kr.prototype.send=Kr.prototype.u;Kr.prototype.open=Kr.prototype.m;Kr.prototype.close=Kr.prototype.close;Np.NO_ERROR=0;Np.TIMEOUT=8;Np.HTTP_ERROR=6;wP.COMPLETE="complete";EP.EventType=ed;ed.OPEN="a";ed.CLOSE="b";ed.ERROR="c";ed.MESSAGE="d";On.prototype.listen=On.prototype.O;ln.prototype.listenOnce=ln.prototype.P;ln.prototype.getLastError=ln.prototype.Sa;ln.prototype.getLastErrorCode=ln.prototype.Ia;ln.prototype.getStatus=ln.prototype.da;ln.prototype.getResponseJson=ln.prototype.Wa;ln.prototype.getResponseText=ln.prototype.ja;ln.prototype.send=ln.prototype.ha;ln.prototype.setWithCredentials=ln.prototype.Oa;ki.prototype.digest=ki.prototype.l;ki.prototype.reset=ki.prototype.reset;ki.prototype.update=ki.prototype.j;Pt.prototype.add=Pt.prototype.add;Pt.prototype.multiply=Pt.prototype.R;Pt.prototype.modulo=Pt.prototype.gb;Pt.prototype.compare=Pt.prototype.X;Pt.prototype.toNumber=Pt.prototype.ea;Pt.prototype.toString=Pt.prototype.toString;Pt.prototype.getBits=Pt.prototype.D;Pt.fromNumber=Ki;Pt.fromString=rR;var y6=function(){return new vg},w6=function(){return kp()},i_=Np,E6=wP,I6=Ja,tT={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Yd=EP,T6=ln,S6=ki,Kl=Pt,x6={};const nT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kn.UNAUTHENTICATED=new kn(null),kn.GOOGLE_CREDENTIALS=new kn("google-credentials-uid"),kn.FIRST_PARTY=new kn("first-party-uid"),kn.MOCK_USER=new kn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ku="10.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=new fp("@firebase/firestore");function ml(){return Co.logLevel}function C6(t){Co.setLogLevel(t)}function ve(t,...e){if(Co.logLevel<=ct.DEBUG){const n=e.map(xw);Co.debug(`Firestore (${ku}): ${t}`,...n)}}function mn(t,...e){if(Co.logLevel<=ct.ERROR){const n=e.map(xw);Co.error(`Firestore (${ku}): ${t}`,...n)}}function Ni(t,...e){if(Co.logLevel<=ct.WARN){const n=e.map(xw);Co.warn(`Firestore (${ku}): ${t}`,...n)}}function xw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t="Unexpected state"){const e=`FIRESTORE (${ku}) INTERNAL ASSERTION FAILED: `+t;throw mn(e),new Error(e)}function Ue(t,e){t||Le()}function A6(t,e){t||Le()}function Ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _e extends mr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class b6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(kn.UNAUTHENTICATED))}shutdown(){}}class P6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class R6{constructor(e){this.t=e,this.currentUser=kn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve();let s=new Dn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string"),new iR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string"),new kn(e)}}class k6{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=kn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class N6{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new k6(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(kn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class D6{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,ve("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ue(typeof n.token=="string"),this.R=n.token,new D6(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=M6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function st(t,e){return t<e?-1:t>e?1:0}function uu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function oR(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new _e(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new _e(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new _e(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _e(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Yt.fromMillis(Date.now())}static fromDate(e){return Yt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Yt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ze(e)}static min(){return new ze(new Yt(0,0))}static max(){return new ze(new Yt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,n,r){n===void 0?n=0:n>e.length&&Le(),r===void 0?r=e.length-n:r>e.length-n&&Le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ih.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ih?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class vt extends Ih{construct(e,n,r){return new vt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new _e(ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new vt(n)}static emptyPath(){return new vt([])}}const L6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kt extends Ih{construct(e,n,r){return new Kt(e,n,r)}static isValidIdentifier(e){return L6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Kt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new _e(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new _e(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new _e(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new _e(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kt(n)}static emptyPath(){return new Kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(vt.fromString(e))}static fromName(e){return new be(vt.fromString(e).popFirst(5))}static empty(){return new be(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return vt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new vt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Jv(t){return t.fields.find(e=>e.kind===2)}function sa(t){return t.fields.filter(e=>e.kind!==2)}Eg.UNKNOWN_ID=-1;class Sf{constructor(e,n){this.fieldPath=e,this.kind=n}}class Th{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Th(0,Qr.min())}}function aR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ze.fromTimestamp(r===1e9?new Yt(n+1,0):new Yt(n,r));return new Qr(i,be.empty(),e)}function lR(t){return new Qr(t.readTime,t.key,-1)}class Qr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Qr(ze.min(),be.empty(),-1)}static max(){return new Qr(ze.max(),be.empty(),-1)}}function Cw(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=be.comparator(t.documentKey,e.documentKey),n!==0?n:st(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qo(t){if(t.code!==ce.FAILED_PRECONDITION||t.message!==uR)throw t;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new oe((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof oe?n:oe.resolve(n)}catch(n){return oe.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):oe.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):oe.reject(n)}static resolve(e){return new oe((n,r)=>{n(e)})}static reject(e){return new oe((n,r)=>{r(e)})}static waitFor(e){return new oe((n,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&n()},h=>r(h))}),a=!0,s===i&&n()})}static or(e){let n=oe.resolve(!1);for(const r of e)n=n.next(i=>i?oe.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new oe((r,i)=>{const s=e.length,a=new Array(s);let u=0;for(let h=0;h<s;h++){const g=h;n(e[g]).next(m=>{a[g]=m,++u,u===s&&r(a)},m=>i(m))}})}static doWhile(e,n){return new oe((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Dn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Mc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Aw(r.target.error);this.V.reject(new Mc(e,i))}}static open(e,n,r,i){try{return new jp(n,e.transaction(i,r))}catch(s){throw new Mc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ve("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new F6(n)}}class xi{constructor(e,n,r){this.name=e,this.version=n,this.p=r,xi.S(tn())===12.2&&mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ve("SimpleDb","Removing database:",e),aa(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!sh())return!1;if(xi.C())return!0;const e=tn(),n=xi.S(e),r=0<n&&n<10,i=xi.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=x6)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(ve("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;n(a)},i.onblocked=()=>{r(new Mc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new _e(ce.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new _e(ce.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Mc(e,a))},i.onupgradeneeded=s=>{ve("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{ve("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const u=jp.open(this.db,e,s?"readonly":"readwrite",r),h=i(u).next(g=>(u.g(),g)).catch(g=>(u.abort(g),oe.reject(g))).toPromise();return h.catch(()=>{}),await u.m,h}catch(u){const h=u,g=h.name!=="FirebaseError"&&a<3;if(ve("SimpleDb","Transaction failed with error:",h.message,"Retrying:",g),this.close(),!g)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class V6{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return aa(this.k.delete())}}class Mc extends _e{constructor(e,n){super(ce.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ho(t){return t.name==="IndexedDbTransactionError"}class F6{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ve("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(ve("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),aa(r)}add(e){return ve("SimpleDb","ADD",this.store.name,e,e),aa(this.store.add(e))}get(e){return aa(this.store.get(e)).next(n=>(n===void 0&&(n=null),ve("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return ve("SimpleDb","DELETE",this.store.name,e),aa(this.store.delete(e))}count(){return ve("SimpleDb","COUNT",this.store.name),aa(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,u)=>{s.push(u)}).next(()=>s)}{const i=this.store.getAll(r.range);return new oe((s,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{s(u.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new oe((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,n){ve("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,u)=>u.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new oe((r,i)=>{n.onerror=s=>{const a=Aw(s.target.error);i(a)},n.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(u=>{u?a.continue():r()}):r()}})}G(e,n){const r=[];return new oe((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const u=a.target.result;if(!u)return void i();const h=new V6(u),g=n(u.primaryKey,u.value,h);if(g instanceof oe){const m=g.catch(w=>(h.done(),oe.reject(w)));r.push(m)}h.isDone?i():h.$===null?u.continue():u.continue(h.$)}}).next(()=>oe.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function aa(t){return new oe((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Aw(r.target.error);n(i)}})}let rT=!1;function Aw(t){const e=xi.S(tn());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new _e("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rT||(rT=!0,setTimeout(()=>{throw r},0)),r}}return t}class B6{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){ve("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{ve("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(n){Ho(n)?ve("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await qo(n)}await this.ee(6e4)})}}class U6{constructor(e,n){this.localStore=e,this.persistence=n}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))}ne(e,n){const r=new Set;let i=n,s=!0;return oe.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return ve("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(u=>{i-=u,r.add(a)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(u=>(ve("IndexBackiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>a.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const a=lR(s);Cw(a,r)>0&&(r=a)}),new Qr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}Rr._e=-1;function sd(t){return t==null}function Sh(t){return t===0&&1/t==-1/0}function hR(t){return typeof t=="number"&&Number.isInteger(t)&&!Sh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=iT(e)),e=j6(t.get(n),e);return iT(e)}function j6(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function iT(t){return t+""}function Qi(t){const e=t.length;if(Ue(e>=2),e===2)return Ue(t.charAt(0)===""&&t.charAt(1)===""),vt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const a=t.indexOf("",s);switch((a<0||a>n)&&Le(),t.charAt(a+1)){case"":const u=t.substring(s,a);let h;i.length===0?h=u:(i+=u,h=i,i=""),r.push(h);break;case"":i+=t.substring(s,a),i+="\0";break;case"":i+=t.substring(s,a+1);break;default:Le()}s=a+2}return new vt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xf(t,e){return[t,_r(e)]}function dR(t,e,n){return[t,_r(e),n]}const z6={},$6=["prefixPath","collectionGroup","readTime","documentId"],q6=["prefixPath","collectionGroup","documentId"],H6=["collectionGroup","readTime","prefixPath","documentId"],G6=["canonicalId","targetId"],W6=["targetId","path"],K6=["path","targetId"],Q6=["collectionId","parent"],Y6=["indexId","uid"],X6=["uid","sequenceNumber"],J6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Z6=["indexId","uid","orderedDocumentKey"],e9=["userId","collectionPath","documentId"],t9=["userId","collectionPath","largestBatchId"],n9=["userId","collectionGroup","largestBatchId"],fR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],r9=[...fR,"documentOverlays"],gR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],pR=gR,i9=[...pR,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv extends cR{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function Vn(t,e){const n=Ne(t);return xi.M(n.ae,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Za(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n){this.comparator=e,this.root=n||jn.EMPTY}insert(e,n){return new Vt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jn.BLACK,null,null))}remove(e){return new Vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xd(this.root,e,this.comparator,!0)}}class Xd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??jn.RED,this.left=i??jn.EMPTY,this.right=s??jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new jn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return jn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const e=this.left.check();if(e!==this.right.check())throw Le();return e+(this.isRed()?0:1)}}jn.EMPTY=null,jn.RED=!0,jn.BLACK=!1;jn.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(e,n,r,i,s){return this}insert(e,n,r){return new jn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.comparator=e,this.data=new Vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new aT(this.data.getIterator())}getIteratorFrom(e){return new aT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Dt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Dt(this.comparator);return n.data=e,n}}class aT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ll(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.fields=e,e.sort(Kt.comparator)}static empty(){return new kr([])}unionWith(e){let n=new Dt(Kt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new kr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return uu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s9(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _R("Invalid base64 string: "+s):s}}(e);return new Sn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Sn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sn.EMPTY_BYTE_STRING=new Sn("");const o9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ao(t){if(Ue(!!t),typeof t=="string"){let e=0;const n=o9.exec(t);if(Ue(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:sn(t.seconds),nanos:sn(t.nanos)}}function sn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bo(t){return typeof t=="string"?Sn.fromBase64String(t):Sn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function bw(t){const e=t.mapValue.fields.__previous_value__;return zp(e)?bw(e):e}function xh(t){const e=Ao(t.mapValue.fields.__local_write_time__.timestampValue);return new Yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{constructor(e,n,r,i,s,a,u,h,g){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=g}}class Po{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Po("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Po&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Cf={nullValue:"NULL_VALUE"};function Fa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zp(t)?4:vR(t)?9007199254740991:10:Le()}function ss(t,e){if(t===e)return!0;const n=Fa(t);if(n!==Fa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xh(t).isEqual(xh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ao(i.timestampValue),u=Ao(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return bo(i.bytesValue).isEqual(bo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return sn(i.geoPointValue.latitude)===sn(s.geoPointValue.latitude)&&sn(i.geoPointValue.longitude)===sn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return sn(i.integerValue)===sn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=sn(i.doubleValue),u=sn(s.doubleValue);return a===u?Sh(a)===Sh(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return uu(t.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:return function(i,s){const a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(oT(a)!==oT(u))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!ss(a[h],u[h])))return!1;return!0}(t,e);default:return Le()}}function Ch(t,e){return(t.values||[]).find(n=>ss(n,e))!==void 0}function Ro(t,e){if(t===e)return 0;const n=Fa(t),r=Fa(e);if(n!==r)return st(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return st(t.booleanValue,e.booleanValue);case 2:return function(s,a){const u=sn(s.integerValue||s.doubleValue),h=sn(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return lT(t.timestampValue,e.timestampValue);case 4:return lT(xh(t),xh(e));case 5:return st(t.stringValue,e.stringValue);case 6:return function(s,a){const u=bo(s),h=bo(a);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const u=s.split("/"),h=a.split("/");for(let g=0;g<u.length&&g<h.length;g++){const m=st(u[g],h[g]);if(m!==0)return m}return st(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const u=st(sn(s.latitude),sn(a.latitude));return u!==0?u:st(sn(s.longitude),sn(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){const u=s.values||[],h=a.values||[];for(let g=0;g<u.length&&g<h.length;++g){const m=Ro(u[g],h[g]);if(m)return m}return st(u.length,h.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===oo.mapValue&&a===oo.mapValue)return 0;if(s===oo.mapValue)return 1;if(a===oo.mapValue)return-1;const u=s.fields||{},h=Object.keys(u),g=a.fields||{},m=Object.keys(g);h.sort(),m.sort();for(let w=0;w<h.length&&w<m.length;++w){const T=st(h[w],m[w]);if(T!==0)return T;const I=Ro(u[h[w]],g[m[w]]);if(I!==0)return I}return st(h.length,m.length)}(t.mapValue,e.mapValue);default:throw Le()}}function lT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return st(t,e);const n=Ao(t),r=Ao(e),i=st(n.seconds,r.seconds);return i!==0?i:st(n.nanos,r.nanos)}function cu(t){return ey(t)}function ey(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ao(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return bo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return be.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=ey(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${ey(n.fields[a])}`;return i+"}"}(t.mapValue):Le()}function Ba(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ty(t){return!!t&&"integerValue"in t}function Ah(t){return!!t&&"arrayValue"in t}function uT(t){return!!t&&"nullValue"in t}function cT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Af(t){return!!t&&"mapValue"in t}function Lc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Za(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Lc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function vR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function l9(t){return"nullValue"in t?Cf:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ba(Po.empty(),be.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Le()}function u9(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ba(Po.empty(),be.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?oo:Le()}function hT(t,e){const n=Ro(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function dT(t,e){const n=Ro(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.value=e}static empty(){return new $n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Af(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lc(n)}setAll(e){let n=Kt.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const h=this.getFieldsMap(n);this.applyChanges(h,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=Lc(a):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Af(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Af(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Za(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new $n(Lc(this.value))}}function yR(t){const e=[];return Za(t.fields,(n,r)=>{const i=new Kt([n]);if(Af(r)){const s=yR(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new kr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,n,r,i,s,a,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new $t(e,0,ze.min(),ze.min(),ze.min(),$n.empty(),0)}static newFoundDocument(e,n,r,i){return new $t(e,1,n,ze.min(),r,i,0)}static newNoDocument(e,n){return new $t(e,2,n,ze.min(),ze.min(),$n.empty(),0)}static newUnknownDocument(e,n){return new $t(e,3,n,ze.min(),ze.min(),$n.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ze.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ze.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e,n){this.position=e,this.inclusive=n}}function fT(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=be.comparator(be.fromName(a.referenceValue),n.key):r=Ro(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function gT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ss(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n="asc"){this.field=e,this.dir=n}}function c9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{}class dt extends wR{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new h9(e,n,r):n==="array-contains"?new g9(e,r):n==="in"?new CR(e,r):n==="not-in"?new p9(e,r):n==="array-contains-any"?new m9(e,r):new dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new d9(e,r):new f9(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ro(n,this.value)):n!==null&&Fa(this.value)===Fa(n)&&this.matchesComparison(Ro(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class At extends wR{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new At(e,n)}matches(e){return hu(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function hu(t){return t.op==="and"}function ny(t){return t.op==="or"}function Pw(t){return ER(t)&&hu(t)}function ER(t){for(const e of t.filters)if(e instanceof At)return!1;return!0}function ry(t){if(t instanceof dt)return t.field.canonicalString()+t.op.toString()+cu(t.value);if(Pw(t))return t.filters.map(e=>ry(e)).join(",");{const e=t.filters.map(n=>ry(n)).join(",");return`${t.op}(${e})`}}function IR(t,e){return t instanceof dt?function(r,i){return i instanceof dt&&r.op===i.op&&r.field.isEqual(i.field)&&ss(r.value,i.value)}(t,e):t instanceof At?function(r,i){return i instanceof At&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&IR(a,i.filters[u]),!0):!1}(t,e):void Le()}function TR(t,e){const n=t.filters.concat(e);return At.create(n,t.op)}function SR(t){return t instanceof dt?function(n){return`${n.field.canonicalString()} ${n.op} ${cu(n.value)}`}(t):t instanceof At?function(n){return n.op.toString()+" {"+n.getFilters().map(SR).join(" ,")+"}"}(t):"Filter"}class h9 extends dt{constructor(e,n,r){super(e,n,r),this.key=be.fromName(r.referenceValue)}matches(e){const n=be.comparator(e.key,this.key);return this.matchesComparison(n)}}class d9 extends dt{constructor(e,n){super(e,"in",n),this.keys=xR("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class f9 extends dt{constructor(e,n){super(e,"not-in",n),this.keys=xR("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xR(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>be.fromName(r.referenceValue))}class g9 extends dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ah(n)&&Ch(n.arrayValue,this.value)}}class CR extends dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ch(this.value.arrayValue,n)}}class p9 extends dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ch(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ch(this.value.arrayValue,n)}}class m9 extends dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ah(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ch(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9{constructor(e,n=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ce=null}}function iy(t,e=null,n=[],r=[],i=null,s=null,a=null){return new _9(t,e,n,r,i,s,a)}function Ua(t){const e=Ne(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ry(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),sd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>cu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>cu(r)).join(",")),e.ce=n}return e.ce}function od(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!c9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!IR(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gT(t.startAt,e.startAt)&&gT(t.endAt,e.endAt)}function Ig(t){return be.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Tg(t,e){return t.filters.filter(n=>n instanceof dt&&n.field.isEqual(e))}function pT(t,e,n){let r=Cf,i=!0;for(const s of Tg(t,e)){let a=Cf,u=!0;switch(s.op){case"<":case"<=":a=l9(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,u=!1;break;case"!=":case"not-in":a=Cf}hT({value:r,inclusive:i},{value:a,inclusive:u})<0&&(r=a,i=u)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const a=n.position[s];hT({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function mT(t,e,n){let r=oo,i=!0;for(const s of Tg(t,e)){let a=oo,u=!0;switch(s.op){case">=":case">":a=u9(s.value),u=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,u=!1;break;case"!=":case"not-in":a=oo}dT({value:r,inclusive:i},{value:a,inclusive:u})>0&&(r=a,i=u)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const a=n.position[s];dT({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,n=null,r=[],i=[],s=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function AR(t,e,n,r,i,s,a,u){return new Us(t,e,n,r,i,s,a,u)}function Nu(t){return new Us(t)}function _T(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Rw(t){return t.collectionGroup!==null}function Ql(t){const e=Ne(t);if(e.le===null){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Dt(Kt.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(g=>{g.isInequality()&&(u=u.add(g.field))})}),u})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new bh(s,r))}),n.has(Kt.keyField().canonicalString())||e.le.push(new bh(Kt.keyField(),r))}return e.le}function vr(t){const e=Ne(t);return e.he||(e.he=v9(e,Ql(t))),e.he}function v9(t,e){if(t.limitType==="F")return iy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new bh(i.field,s)});const n=t.endAt?new ko(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ko(t.startAt.position,t.startAt.inclusive):null;return iy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function sy(t,e){const n=t.filters.concat([e]);return new Us(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Sg(t,e,n){return new Us(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ad(t,e){return od(vr(t),vr(e))&&t.limitType===e.limitType}function bR(t){return`${Ua(vr(t))}|lt:${t.limitType}`}function _l(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>SR(i)).join(", ")}]`),sd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>cu(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>cu(i)).join(",")),`Target(${r})`}(vr(t))}; limitType=${t.limitType})`}function ld(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):be.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Ql(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){const g=fT(a,u,h);return a.inclusive?g<=0:g<0}(r.startAt,Ql(r),i)||r.endAt&&!function(a,u,h){const g=fT(a,u,h);return a.inclusive?g>=0:g>0}(r.endAt,Ql(r),i))}(t,e)}function PR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function RR(t){return(e,n)=>{let r=!1;for(const i of Ql(t)){const s=y9(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function y9(t,e,n){const r=t.field.isKeyField()?be.comparator(e.key,n.key):function(s,a,u){const h=a.data.field(s),g=u.data.field(s);return h!==null&&g!==null?Ro(h,g):Le()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Za(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return mR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9=new Vt(be.comparator);function Nr(){return w9}const kR=new Vt(be.comparator);function _c(...t){let e=kR;for(const n of t)e=e.insert(n.key,n);return e}function NR(t){let e=kR;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Yi(){return Vc()}function DR(){return Vc()}function Vc(){return new Go(t=>t.toString(),(t,e)=>t.isEqual(e))}const E9=new Vt(be.comparator),I9=new Dt(be.comparator);function at(...t){let e=I9;for(const n of t)e=e.add(n);return e}const T9=new Dt(st);function kw(){return T9}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sh(e)?"-0":e}}function MR(t){return{integerValue:""+t}}function LR(t,e){return hR(e)?MR(e):OR(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(){this._=void 0}}function S9(t,e,n){return t instanceof du?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&zp(s)&&(s=bw(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof ja?FR(t,e):t instanceof za?BR(t,e):function(i,s){const a=VR(i,s),u=vT(a)+vT(i.Ie);return ty(a)&&ty(i.Ie)?MR(u):OR(i.serializer,u)}(t,e)}function x9(t,e,n){return t instanceof ja?FR(t,e):t instanceof za?BR(t,e):n}function VR(t,e){return t instanceof fu?function(r){return ty(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class du extends $p{}class ja extends $p{constructor(e){super(),this.elements=e}}function FR(t,e){const n=UR(e);for(const r of t.elements)n.some(i=>ss(i,r))||n.push(r);return{arrayValue:{values:n}}}class za extends $p{constructor(e){super(),this.elements=e}}function BR(t,e){let n=UR(e);for(const r of t.elements)n=n.filter(i=>!ss(i,r));return{arrayValue:{values:n}}}class fu extends $p{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function vT(t){return sn(t.integerValue||t.doubleValue)}function UR(t){return Ah(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,n){this.field=e,this.transform=n}}function C9(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ja&&i instanceof ja||r instanceof za&&i instanceof za?uu(r.elements,i.elements,ss):r instanceof fu&&i instanceof fu?ss(r.Ie,i.Ie):r instanceof du&&i instanceof du}(t.transform,e.transform)}class A9{constructor(e,n){this.version=e,this.transformResults=n}}class Qt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Qt}static exists(e){return new Qt(void 0,e)}static updateTime(e){return new Qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qp{}function jR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ou(t.key,Qt.none()):new Du(t.key,t.data,Qt.none());{const n=t.data,r=$n.empty();let i=new Dt(Kt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new js(t.key,r,new kr(i.toArray()),Qt.none())}}function b9(t,e,n){t instanceof Du?function(i,s,a){const u=i.value.clone(),h=wT(i.fieldTransforms,s,a.transformResults);u.setAll(h),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof js?function(i,s,a){if(!bf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const u=wT(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(zR(i)),h.setAll(u),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Fc(t,e,n,r){return t instanceof Du?function(s,a,u,h){if(!bf(s.precondition,a))return u;const g=s.value.clone(),m=ET(s.fieldTransforms,h,a);return g.setAll(m),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null}(t,e,n,r):t instanceof js?function(s,a,u,h){if(!bf(s.precondition,a))return u;const g=ET(s.fieldTransforms,h,a),m=a.data;return m.setAll(zR(s)),m.setAll(g),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(w=>w.field))}(t,e,n,r):function(s,a,u){return bf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function P9(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=VR(r.transform,i||null);s!=null&&(n===null&&(n=$n.empty()),n.set(r.field,s))}return n||null}function yT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&uu(r,i,(s,a)=>C9(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Du extends qp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class js extends qp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function zR(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function wT(t,e,n){const r=new Map;Ue(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,x9(a,u,n[i]))}return r}function ET(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,S9(s,a,e))}return r}class Ou extends qp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Nw extends qp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&b9(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=DR();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let u=this.applyToLocalView(a,s.mutatedFields);u=n.has(i.key)?null:u;const h=jR(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(ze.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),at())}isEqual(e){return this.batchId===e.batchId&&uu(this.mutations,e.mutations,(n,r)=>yT(n,r))&&uu(this.baseMutations,e.baseMutations,(n,r)=>yT(n,r))}}class Ow{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ue(e.mutations.length===r.length);let i=function(){return E9}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Ow(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,_t;function $R(t){switch(t){default:return Le();case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0}}function qR(t){if(t===void 0)return mn("GRPC error has no .code"),ce.UNKNOWN;switch(t){case yn.OK:return ce.OK;case yn.CANCELLED:return ce.CANCELLED;case yn.UNKNOWN:return ce.UNKNOWN;case yn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case yn.INTERNAL:return ce.INTERNAL;case yn.UNAVAILABLE:return ce.UNAVAILABLE;case yn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case yn.NOT_FOUND:return ce.NOT_FOUND;case yn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case yn.ABORTED:return ce.ABORTED;case yn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case yn.DATA_LOSS:return ce.DATA_LOSS;default:return Le()}}(_t=yn||(yn={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k9=new Kl([4294967295,4294967295],0);function IT(t){const e=HR().encode(t),n=new S6;return n.update(e),new Uint8Array(n.digest())}function TT(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Kl([n,r],0),new Kl([i,s],0)]}class Lw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new vc(`Invalid padding: ${n}`);if(r<0)throw new vc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new vc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new vc(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Kl.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Kl.fromNumber(r)));return i.compare(k9)===1&&(i=new Kl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=IT(e),[r,i]=TT(n);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Lw(s,i,n);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Te===0)return;const n=IT(e),[r,i]=TT(n);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class vc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,hd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new cd(ze.min(),i,new Vt(st),Nr(),at())}}class hd{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hd(r,n,at(),at(),at())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class GR{constructor(e,n){this.targetId=e,this.fe=n}}class WR{constructor(e,n,r=Sn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ST{constructor(){this.ge=0,this.pe=CT(),this.ye=Sn.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=at(),n=at(),r=at();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Le()}}),new hd(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=CT()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Ue(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class N9{constructor(e){this.Le=e,this.ke=new Map,this.qe=Nr(),this.Qe=xT(),this.Ke=new Vt(st)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:Le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(Ig(s))if(r===0){const a=new be(s.path);this.We(n,a,$t.newNoDocument(a,ze.min()))}else Ue(r===1);else{const a=this.Ze(n);if(a!==r){const u=this.Xe(e),h=u?this.et(u,e,a):1;if(h!==0){this.He(n);const g=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,g)}}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,u;try{a=bo(r).toUint8Array()}catch(h){if(h instanceof _R)return Ni("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Lw(a,i,s)}catch(h){return Ni(h instanceof vc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Te===0?null:u}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Le.nt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,a)=>{const u=this.Ye(a);if(u){if(s.current&&Ig(u.target)){const h=new be(u.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,$t.newNoDocument(h,e))}s.De&&(n.set(a,s.ve()),s.Fe())}});let r=at();this.Qe.forEach((s,a)=>{let u=!0;a.forEachWhile(h=>{const g=this.Ye(h);return!g||g.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new cd(e,n,this.Ke,this.qe,r);return this.qe=Nr(),this.Qe=xT(),this.Ke=new Vt(st),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new ST,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Dt(st),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||ve("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new ST),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function xT(){return new Vt(be.comparator)}function CT(){return new Vt(be.comparator)}const D9={asc:"ASCENDING",desc:"DESCENDING"},O9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},M9={and:"AND",or:"OR"};class L9{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function oy(t,e){return t.useProto3Json||sd(e)?e:{value:e}}function gu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function KR(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function V9(t,e){return gu(t,e.toTimestamp())}function vn(t){return Ue(!!t),ze.fromTimestamp(function(n){const r=Ao(n);return new Yt(r.seconds,r.nanos)}(t))}function Vw(t,e){return function(r){return new vt(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function QR(t){const e=vt.fromString(t);return Ue(i2(e)),e}function Ph(t,e){return Vw(t.databaseId,e.path)}function ts(t,e){const n=QR(e);if(n.get(1)!==t.databaseId.projectId)throw new _e(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new _e(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new be(XR(n))}function ay(t,e){return Vw(t.databaseId,e)}function YR(t){const e=QR(t);return e.length===4?vt.emptyPath():XR(e)}function Rh(t){return new vt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function XR(t){return Ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function AT(t,e,n){return{name:Ph(t,e),fields:n.value.mapValue.fields}}function JR(t,e,n){const r=ts(t,e.name),i=vn(e.updateTime),s=e.createTime?vn(e.createTime):ze.min(),a=new $n({mapValue:{fields:e.fields}}),u=$t.newFoundDocument(r,i,s,a);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function F9(t,e){return"found"in e?function(r,i){Ue(!!i.found),i.found.name,i.found.updateTime;const s=ts(r,i.found.name),a=vn(i.found.updateTime),u=i.found.createTime?vn(i.found.createTime):ze.min(),h=new $n({mapValue:{fields:i.found.fields}});return $t.newFoundDocument(s,a,u,h)}(t,e):"missing"in e?function(r,i){Ue(!!i.missing),Ue(!!i.readTime);const s=ts(r,i.missing),a=vn(i.readTime);return $t.newNoDocument(s,a)}(t,e):Le()}function B9(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Le()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(g,m){return g.useProto3Json?(Ue(m===void 0||typeof m=="string"),Sn.fromBase64String(m||"")):(Ue(m===void 0||m instanceof Uint8Array),Sn.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(g){const m=g.code===void 0?ce.UNKNOWN:qR(g.code);return new _e(m,g.message||"")}(a);n=new WR(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ts(t,r.document.name),s=vn(r.document.updateTime),a=r.document.createTime?vn(r.document.createTime):ze.min(),u=new $n({mapValue:{fields:r.document.fields}}),h=$t.newFoundDocument(i,s,a,u),g=r.targetIds||[],m=r.removedTargetIds||[];n=new Pf(g,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ts(t,r.document),s=r.readTime?vn(r.readTime):ze.min(),a=$t.newNoDocument(i,s),u=r.removedTargetIds||[];n=new Pf([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ts(t,r.document),s=r.removedTargetIds||[];n=new Pf([],s,i,null)}else{if(!("filter"in e))return Le();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new R9(i,s),u=r.targetId;n=new GR(u,a)}}return n}function kh(t,e){let n;if(e instanceof Du)n={update:AT(t,e.key,e.value)};else if(e instanceof Ou)n={delete:Ph(t,e.key)};else if(e instanceof js)n={update:AT(t,e.key,e.data),updateMask:H9(e.fieldMask)};else{if(!(e instanceof Nw))return Le();n={verify:Ph(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const u=a.transform;if(u instanceof du)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ja)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof za)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof fu)return{fieldPath:a.field.canonicalString(),increment:u.Ie};throw Le()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:V9(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Le()}(t,e.precondition)),n}function ly(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Qt.updateTime(vn(s.updateTime)):s.exists!==void 0?Qt.exists(s.exists):Qt.none()}(e.currentDocument):Qt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,u){let h=null;if("setToServerValue"in u)Ue(u.setToServerValue==="REQUEST_TIME"),h=new du;else if("appendMissingElements"in u){const m=u.appendMissingElements.values||[];h=new ja(m)}else if("removeAllFromArray"in u){const m=u.removeAllFromArray.values||[];h=new za(m)}else"increment"in u?h=new fu(a,u.increment):Le();const g=Kt.fromServerFormat(u.fieldPath);return new ud(g,h)}(t,i)):[];if(e.update){e.update.name;const i=ts(t,e.update.name),s=new $n({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const g=h.fieldPaths||[];return new kr(g.map(m=>Kt.fromServerFormat(m)))}(e.updateMask);return new js(i,s,a,n,r)}return new Du(i,s,n,r)}if(e.delete){const i=ts(t,e.delete);return new Ou(i,n)}if(e.verify){const i=ts(t,e.verify);return new Nw(i,n)}return Le()}function U9(t,e){return t&&t.length>0?(Ue(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?vn(i.updateTime):vn(s);return a.isEqual(ze.min())&&(a=vn(s)),new A9(a,i.transformResults||[])}(n,e))):[]}function ZR(t,e){return{documents:[ay(t,e.path)]}}function e2(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=ay(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ay(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return r2(At.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(g=>function(w){return{field:vl(w.field),direction:z9(w.dir)}}(g))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const a=oy(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),n}function t2(t){let e=YR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ue(r===1);const m=n.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];n.where&&(s=function(w){const T=n2(w);return T instanceof At&&Pw(T)?T.getFilters():[T]}(n.where));let a=[];n.orderBy&&(a=function(w){return w.map(T=>function(j){return new bh(yl(j.field),function(X){switch(X){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(j.direction))}(T))}(n.orderBy));let u=null;n.limit&&(u=function(w){let T;return T=typeof w=="object"?w.value:w,sd(T)?null:T}(n.limit));let h=null;n.startAt&&(h=function(w){const T=!!w.before,I=w.values||[];return new ko(I,T)}(n.startAt));let g=null;return n.endAt&&(g=function(w){const T=!w.before,I=w.values||[];return new ko(I,T)}(n.endAt)),AR(e,i,a,s,u,"F",h,g)}function j9(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function n2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=yl(n.unaryFilter.field);return dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=yl(n.unaryFilter.field);return dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=yl(n.unaryFilter.field);return dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=yl(n.unaryFilter.field);return dt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(t):t.fieldFilter!==void 0?function(n){return dt.create(yl(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return At.create(n.compositeFilter.filters.map(r=>n2(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le()}}(n.compositeFilter.op))}(t):Le()}function z9(t){return D9[t]}function $9(t){return O9[t]}function q9(t){return M9[t]}function vl(t){return{fieldPath:t.canonicalString()}}function yl(t){return Kt.fromServerFormat(t.fieldPath)}function r2(t){return t instanceof dt?function(n){if(n.op==="=="){if(cT(n.value))return{unaryFilter:{field:vl(n.field),op:"IS_NAN"}};if(uT(n.value))return{unaryFilter:{field:vl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(cT(n.value))return{unaryFilter:{field:vl(n.field),op:"IS_NOT_NAN"}};if(uT(n.value))return{unaryFilter:{field:vl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vl(n.field),op:$9(n.op),value:n.value}}}(t):t instanceof At?function(n){const r=n.getFilters().map(i=>r2(i));return r.length===1?r[0]:{compositeFilter:{op:q9(n.op),filters:r}}}(t):Le()}function H9(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function i2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n,r,i,s=ze.min(),a=ze.min(),u=Sn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Is(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Is(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Is(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Is(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e){this.ut=e}}function G9(t,e){let n;if(e.document)n=JR(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=be.fromSegments(e.noDocument.path),i=qa(e.noDocument.readTime);n=$t.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le();{const r=be.fromSegments(e.unknownDocument.path),i=qa(e.unknownDocument.version);n=$t.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Yt(i[0],i[1]);return ze.fromTimestamp(s)}(e.readTime)),n}function bT(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:xg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:Ph(s,a.key),fields:a.data.value.mapValue.fields,updateTime:gu(s,a.version.toTimestamp()),createTime:gu(s,a.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:$a(e.version)};else{if(!e.isUnknownDocument())return Le();r.unknownDocument={path:n.path.toArray(),version:$a(e.version)}}return r}function xg(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function $a(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function qa(t){const e=new Yt(t.seconds,t.nanoseconds);return ze.fromTimestamp(e)}function la(t,e){const n=(e.baseMutations||[]).map(s=>ly(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const u=e.mutations[s+1];a.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>ly(t.ut,s)),i=Yt.fromMillis(e.localWriteTimeMs);return new Dw(e.batchId,i,n,r)}function yc(t){const e=qa(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?qa(t.lastLimboFreeSnapshotVersion):ze.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return Ue(s.documents.length===1),vr(Nu(YR(s.documents[0])))}(t.query):function(s){return vr(t2(s))}(t.query),new Is(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Sn.fromBase64String(t.resumeToken))}function o2(t,e){const n=$a(e.snapshotVersion),r=$a(e.lastLimboFreeSnapshotVersion);let i;i=Ig(e.target)?ZR(t.ut,e.target):e2(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ua(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Fw(t){const e=t2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sg(e,e.limit,"L"):e}function s_(t,e){return new Mw(e.largestBatchId,ly(t.ut,e.overlayMutation))}function PT(t,e){const n=e.path.lastSegment();return[t,_r(e.path.popLast()),n]}function RT(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:$a(r.readTime),documentKey:_r(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W9{getBundleMetadata(e,n){return kT(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:qa(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return kT(e).put(function(i){return{bundleId:i.id,createTime:$a(vn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return NT(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:Fw(s.bundledQuery),readTime:qa(s.readTime)}}(r)})}saveNamedQuery(e,n){return NT(e).put(function(i){return{name:i.name,readTime:$a(vn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function kT(t){return Vn(t,"bundles")}function NT(t){return Vn(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){const r=n.uid||"";return new Hp(e,r)}getOverlay(e,n){return Zu(e).get(PT(this.userId,n)).next(r=>r?s_(this.serializer,r):null)}getOverlays(e,n){const r=Yi();return oe.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,a)=>{const u=new Mw(n,a);i.push(this.lt(e,u))}),oe.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(_r(a.getCollectionPath())));const s=[];return i.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Zu(e).H("collectionPathOverlayIndex",u))}),oe.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Yi(),s=_r(n),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Zu(e).W("collectionPathOverlayIndex",a).next(u=>{for(const h of u){const g=s_(this.serializer,h);i.set(g.getKey(),g)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Yi();let a;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Zu(e).Y({index:"collectionGroupOverlayIndex",range:u},(h,g,m)=>{const w=s_(this.serializer,g);s.size()<i||w.largestBatchId===a?(s.set(w.getKey(),w),a=w.largestBatchId):m.done()}).next(()=>s)}lt(e,n){return Zu(e).put(function(i,s,a){const[u,h,g]=PT(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:g,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:kh(i.ut,a.mutation)}}(this.serializer,this.userId,n))}}function Zu(t){return Vn(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(sn(e.integerValue));else if("doubleValue"in e){const r=sn(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Sh(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(bo(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?vR(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):Le()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),be.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}ua.St=new ua;function K9(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function DT(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=K9(255&r[s]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class Q9{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=DT(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=DT(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Y9{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class X9{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class ec{constructor(){this.Wt=new Q9,this.Gt=new Y9(this.Wt),this.zt=new X9(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new ca(this.indexId,this.documentKey,this.arrayValue,r)}}function Ws(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=OT(t.arrayValue,e.arrayValue),n!==0?n:(n=OT(t.directionalValue,e.directionalValue),n!==0?n:be.comparator(t.documentKey,e.documentKey)))}function OT(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e){this.Jt=new Dt((n,r)=>Kt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Ue(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=Jv(e);if(n!==void 0&&!this.tn(n))return!1;const r=sa(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const u=this.Jt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const h=r[s];if(!this.nn(u,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const u=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],u))return!1}return!0}sn(){if(this.Xt)return null;let e=new Dt(Kt.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Sf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Sf(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Sf(r.field,r.dir==="asc"?0:1)));return new Eg(Eg.UNKNOWN_ID,this.collectionId,n,Th.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(t){var e,n;if(Ue(t instanceof dt||t instanceof At),t instanceof dt){if(t instanceof CR){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>dt.create(t.field,"==",s)))||[];return At.create(i,"or")}return t}const r=t.filters.map(i=>a2(i));return At.create(r,t.op)}function J9(t){if(t.getFilters().length===0)return[];const e=hy(a2(t));return Ue(l2(e)),uy(e)||cy(e)?[e]:e.getFilters()}function uy(t){return t instanceof dt}function cy(t){return t instanceof At&&Pw(t)}function l2(t){return uy(t)||cy(t)||function(n){if(n instanceof At&&ny(n)){for(const r of n.getFilters())if(!uy(r)&&!cy(r))return!1;return!0}return!1}(t)}function hy(t){if(Ue(t instanceof dt||t instanceof At),t instanceof dt)return t;if(t.filters.length===1)return hy(t.filters[0]);const e=t.filters.map(r=>hy(r));let n=At.create(e,t.op);return n=Cg(n),l2(n)?n:(Ue(n instanceof At),Ue(hu(n)),Ue(n.filters.length>1),n.filters.reduce((r,i)=>Bw(r,i)))}function Bw(t,e){let n;return Ue(t instanceof dt||t instanceof At),Ue(e instanceof dt||e instanceof At),n=t instanceof dt?e instanceof dt?function(i,s){return At.create([i,s],"and")}(t,e):LT(t,e):e instanceof dt?LT(e,t):function(i,s){if(Ue(i.filters.length>0&&s.filters.length>0),hu(i)&&hu(s))return TR(i,s.getFilters());const a=ny(i)?i:s,u=ny(i)?s:i,h=a.filters.map(g=>Bw(g,u));return At.create(h,"or")}(t,e),Cg(n)}function LT(t,e){if(hu(e))return TR(e,t.getFilters());{const n=e.filters.map(r=>Bw(t,r));return At.create(n,"or")}}function Cg(t){if(Ue(t instanceof dt||t instanceof At),t instanceof dt)return t;const e=t.getFilters();if(e.length===1)return Cg(e[0]);if(ER(t))return t;const n=e.map(i=>Cg(i)),r=[];return n.forEach(i=>{i instanceof dt?r.push(i):i instanceof At&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:At.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z9{constructor(){this.on=new Uw}addToCollectionParentIndex(e,n){return this.on.add(n),oe.resolve()}getCollectionParents(e,n){return oe.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return oe.resolve()}deleteFieldIndex(e,n){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,n){return oe.resolve()}getDocumentsMatchingTarget(e,n){return oe.resolve(null)}getIndexType(e,n){return oe.resolve(0)}getFieldIndexes(e,n){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,n){return oe.resolve(Qr.min())}getMinOffsetFromCollectionGroup(e,n){return oe.resolve(Qr.min())}updateCollectionGroup(e,n,r){return oe.resolve()}updateIndexEntries(e,n){return oe.resolve()}}class Uw{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Dt(vt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Dt(vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new Uint8Array(0);class eU{constructor(e,n){this.user=e,this.databaseId=n,this._n=new Uw,this.an=new Go(r=>Ua(r),(r,i)=>od(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:_r(i)};return VT(e).put(s)}return oe.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[oR(n),""],!1,!0);return VT(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==n)break;r.push(Qi(a.parent))}return r})}addFieldIndex(e,n){const r=tc(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const a=cl(e);return s.next(u=>{a.put(RT(u,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=tc(e),i=cl(e),s=ul(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=tc(e),r=ul(e),i=cl(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return oe.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new MT(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=ul(e);let i=!0;const s=new Map;return oe.forEach(this.un(n),a=>this.cn(e,a).next(u=>{i&&(i=!!u),s.set(a,u)})).next(()=>{if(i){let a=at();const u=[];return oe.forEach(s,(h,g)=>{ve("IndexedDbIndexManager",`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(J=>`${J.fieldPath}:${J.kind}`).join(",")}`}(h)} to execute ${Ua(n)}`);const m=function(U,J){const re=Jv(J);if(re===void 0)return null;for(const te of Tg(U,re.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null}(g,h),w=function(U,J){const re=new Map;for(const te of sa(J))for(const ae of Tg(U,te.fieldPath))switch(ae.op){case"==":case"in":re.set(te.fieldPath.canonicalString(),ae.value);break;case"not-in":case"!=":return re.set(te.fieldPath.canonicalString(),ae.value),Array.from(re.values())}return null}(g,h),T=function(U,J){const re=[];let te=!0;for(const ae of sa(J)){const ne=ae.kind===0?pT(U,ae.fieldPath,U.startAt):mT(U,ae.fieldPath,U.startAt);re.push(ne.value),te&&(te=ne.inclusive)}return new ko(re,te)}(g,h),I=function(U,J){const re=[];let te=!0;for(const ae of sa(J)){const ne=ae.kind===0?mT(U,ae.fieldPath,U.endAt):pT(U,ae.fieldPath,U.endAt);re.push(ne.value),te&&(te=ne.inclusive)}return new ko(re,te)}(g,h),j=this.ln(h,g,T),z=this.ln(h,g,I),X=this.hn(h,g,w),V=this.Pn(h.indexId,m,j,T.inclusive,z,I.inclusive,X);return oe.forEach(V,B=>r.j(B,n.limit).next(U=>{U.forEach(J=>{const re=be.fromSegments(J.documentKey);a.has(re)||(a=a.add(re),u.push(re))})}))}).next(()=>u)}return oe.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=J9(At.create(e.filters,"and")).map(r=>iy(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,a,u){const h=(n!=null?n.length:1)*Math.max(r.length,s.length),g=h/(n!=null?n.length:1),m=[];for(let w=0;w<h;++w){const T=n?this.In(n[w/g]):Jd,I=this.Tn(e,T,r[w%g],i),j=this.En(e,T,s[w%g],a),z=u.map(X=>this.Tn(e,T,X,!0));m.push(...this.createRange(I,j,z))}return m}Tn(e,n,r,i){const s=new ca(e,be.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new ca(e,be.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new MT(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const u of s)r.en(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(e,n){let r=2;const i=this.un(n);return oe.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let g=new Dt(Kt.comparator),m=!1;for(const w of h.filters)for(const T of w.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?m=!0:g=g.add(T.field));for(const w of h.orderBy)w.field.isKeyField()||(g=g.add(w.field));return g.size+(m?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){const r=new ec;for(const i of sa(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);ua.St.ht(s,a)}return r.Ut()}In(e){const n=new ec;return ua.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new ec;return ua.St.ht(Ba(this.databaseId,n),r.jt(function(s){const a=sa(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new ec);let s=0;for(const a of sa(e)){const u=r[s++];for(const h of i)if(this.Rn(n,a.fieldPath)&&Ah(u))i=this.Vn(i,a,u);else{const g=h.jt(a.kind);ua.St.ht(u,g)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const u of i){const h=new ec;h.seed(u.Ut()),ua.St.ht(a,h.jt(n.kind)),s.push(h)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof dt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=tc(e),i=cl(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const a=[];return oe.forEach(s,u=>i.get([u.indexId,this.uid]).next(h=>{a.push(function(m,w){const T=w?new Th(w.sequenceNumber,new Qr(qa(w.readTime),new be(Qi(w.documentKey)),w.largestBatchId)):Th.empty(),I=m.fields.map(([j,z])=>new Sf(Kt.fromServerFormat(j),z));return new Eg(m.indexId,m.collectionGroup,I,T)}(u,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:st(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=tc(e),s=cl(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>oe.forEach(u,h=>s.put(RT(h.indexId,this.user,a,r)))))}updateIndexEntries(e,n){const r=new Map;return oe.forEach(n,(i,s)=>{const a=r.get(i.collectionGroup);return(a?oe.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),oe.forEach(u,h=>this.gn(e,i,h).next(g=>{const m=this.pn(s,h);return g.isEqual(m)?oe.resolve():this.yn(e,s,h,g,m)}))))})}wn(e,n,r,i){return ul(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return ul(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=ul(e);let s=new Dt(Ws);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(a,u)=>{s=s.add(new ca(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>s)}pn(e,n){let r=new Dt(Ws);const i=this.dn(n,e);if(i==null)return r;const s=Jv(n);if(s!=null){const a=e.data.field(s.fieldPath);if(Ah(a))for(const u of a.arrayValue.values||[])r=r.add(new ca(n.indexId,e.key,this.In(u),i))}else r=r.add(new ca(n.indexId,e.key,Jd,i));return r}yn(e,n,r,i,s){ve("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(h,g,m,w,T){const I=h.getIterator(),j=g.getIterator();let z=ll(I),X=ll(j);for(;z||X;){let V=!1,B=!1;if(z&&X){const U=m(z,X);U<0?B=!0:U>0&&(V=!0)}else z!=null?B=!0:V=!0;V?(w(X),X=ll(j)):B?(T(z),z=ll(I)):(z=ll(I),X=ll(j))}}(i,s,Ws,u=>{a.push(this.wn(e,n,r,u))},u=>{a.push(this.Sn(e,n,r,u))}),oe.waitFor(a)}fn(e){let n=1;return cl(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,u)=>Ws(a,u)).filter((a,u,h)=>!u||Ws(a,h[u-1])!==0);const i=[];i.push(e);for(const a of r){const u=Ws(a,e),h=Ws(a,n);if(u===0)i[0]=e.Ht();else if(u>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(n);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const u=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Jd,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Jd,[]];s.push(IDBKeyRange.bound(u,h))}return s}bn(e,n){return Ws(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(FT)}getMinOffset(e,n){return oe.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||Le())).next(FT)}}function VT(t){return Vn(t,"collectionParents")}function ul(t){return Vn(t,"indexEntries")}function tc(t){return Vn(t,"indexConfiguration")}function cl(t){return Vn(t,"indexState")}function FT(t){Ue(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Cw(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Qr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class xr{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new xr(e,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],a=IDBKeyRange.only(n.batchId);let u=0;const h=r.Y({range:a},(m,w,T)=>(u++,T.delete()));s.push(h.next(()=>{Ue(u===1)}));const g=[];for(const m of n.mutations){const w=dR(e,m.key.path,n.batchId);s.push(i.delete(w)),g.push(m.key)}return oe.waitFor(s).next(()=>g)}function Ag(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Le();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xr.DEFAULT_COLLECTION_PERCENTILE=10,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xr.DEFAULT=new xr(41943040,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xr.DISABLED=new xr(-1,0,0);class Gp{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){Ue(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Gp(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ks(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=wl(e),a=Ks(e);return a.add({}).next(u=>{Ue(typeof u=="number");const h=new Dw(u,n,r,i),g=function(I,j,z){const X=z.baseMutations.map(B=>kh(I.ut,B)),V=z.mutations.map(B=>kh(I.ut,B));return{userId:j,batchId:z.batchId,localWriteTimeMs:z.localWriteTime.toMillis(),baseMutations:X,mutations:V}}(this.serializer,this.userId,h),m=[];let w=new Dt((T,I)=>st(T.canonicalString(),I.canonicalString()));for(const T of i){const I=dR(this.userId,T.key.path,u);w=w.add(T.key.path.popLast()),m.push(a.put(g)),m.push(s.put(I,z6))}return w.forEach(T=>{m.push(this.indexManager.addToCollectionParentIndex(e,T))}),e.addOnCommittedListener(()=>{this.Dn[u]=h.keys()}),oe.waitFor(m).next(()=>h)})}lookupMutationBatch(e,n){return Ks(e).get(n).next(r=>r?(Ue(r.userId===this.userId),la(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?oe.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ks(e).Y({index:"userMutationsIndex",range:i},(a,u,h)=>{u.userId===this.userId&&(Ue(u.batchId>=r),s=la(this.serializer,u)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ks(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ks(e).W("userMutationsIndex",n).next(r=>r.map(i=>la(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=xf(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return wl(e).Y({range:i},(a,u,h)=>{const[g,m,w]=a,T=Qi(m);if(g===this.userId&&n.path.isEqual(T))return Ks(e).get(w).next(I=>{if(!I)throw Le();Ue(I.userId===this.userId),s.push(la(this.serializer,I))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Dt(st);const i=[];return n.forEach(s=>{const a=xf(this.userId,s.path),u=IDBKeyRange.lowerBound(a),h=wl(e).Y({range:u},(g,m,w)=>{const[T,I,j]=g,z=Qi(I);T===this.userId&&s.path.isEqual(z)?r=r.add(j):w.done()});i.push(h)}),oe.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=xf(this.userId,r),a=IDBKeyRange.lowerBound(s);let u=new Dt(st);return wl(e).Y({range:a},(h,g,m)=>{const[w,T,I]=h,j=Qi(T);w===this.userId&&r.isPrefixOf(j)?j.length===i&&(u=u.add(I)):m.done()}).next(()=>this.vn(e,u))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ks(e).get(s).next(a=>{if(a===null)throw Le();Ue(a.userId===this.userId),r.push(la(this.serializer,a))}))}),oe.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return u2(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),oe.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return oe.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return wl(e).Y({range:r},(s,a,u)=>{if(s[0]===this.userId){const h=Qi(s[1]);i.push(h)}else u.done()}).next(()=>{Ue(i.length===0)})})}containsKey(e,n){return c2(e,this.userId,n)}Mn(e){return h2(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function c2(t,e,n){const r=xf(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return wl(t).Y({range:s,J:!0},(u,h,g)=>{const[m,w,T]=u;m===e&&w===i&&(a=!0),g.done()}).next(()=>a)}function Ks(t){return Vn(t,"mutations")}function wl(t){return Vn(t,"documentMutations")}function h2(t){return Vn(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Ha(0)}static Nn(){return new Ha(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new Ha(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>ze.fromTimestamp(new Yt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>hl(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(Ue(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return hl(e).Y((a,u)=>{const h=yc(u);h.sequenceNumber<=n&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>oe.waitFor(s)).next(()=>i)}forEachTarget(e,n){return hl(e).Y((r,i)=>{const s=yc(i);n(s)})}Bn(e){return UT(e).get("targetGlobalKey").next(n=>(Ue(n!==null),n))}Ln(e,n){return UT(e).put("targetGlobalKey",n)}kn(e,n){return hl(e).put(o2(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ua(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return hl(e).Y({range:i,index:"queryTargetsIndex"},(a,u,h)=>{const g=yc(u);od(n,g.target)&&(s=g,h.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=eo(e);return n.forEach(a=>{const u=_r(a.path);i.push(s.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,a))}),oe.waitFor(i)}removeMatchingKeys(e,n,r){const i=eo(e);return oe.forEach(n,s=>{const a=_r(s.path);return oe.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=eo(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=eo(e);let s=at();return i.Y({range:r,J:!0},(a,u,h)=>{const g=Qi(a[1]),m=new be(g);s=s.add(m)}).next(()=>s)}containsKey(e,n){const r=_r(n.path),i=IDBKeyRange.bound([r],[oR(r)],!1,!0);let s=0;return eo(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,u],h,g)=>{a!==0&&(s++,g.done())}).next(()=>s>0)}_t(e,n){return hl(e).get(n).next(r=>r?yc(r):null)}}function hl(t){return Vn(t,"targets")}function UT(t){return Vn(t,"targetGlobal")}function eo(t){return Vn(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT([t,e],[n,r]){const i=st(t,n);return i===0?st(e,r):i}class nU{constructor(e){this.Qn=e,this.buffer=new Dt(jT),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();jT(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class rU{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){ve("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ho(n)?ve("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await qo(n)}await this.Gn(3e5)})}}class iU{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return oe.resolve(Rr._e);const r=new nU(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(BT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),BT):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,a,u,h,g;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,a=Date.now(),this.nthSequenceNumber(e,i))).next(w=>(r=w,u=Date.now(),this.removeTargets(e,r,n))).next(w=>(s=w,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(w=>(g=Date.now(),ml()<=ct.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(h-u)+`ms
	Removed ${w} documents in `+(g-h)+`ms
Total Duration: ${g-m}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:w})))}}function sU(t,e){return new iU(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e,n){this.db=e,this.garbageCollector=sU(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return Zd(e,r)}removeReference(e,n,r){return Zd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Zd(e,n)}Xn(e,n){return function(i,s){let a=!1;return h2(i).Z(u=>c2(i,u,s).next(h=>(h&&(a=!0),oe.resolve(!h)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,u)=>{if(u<=n){const h=this.Xn(e,a).next(g=>{if(!g)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,ze.min()),eo(e).delete(function(w){return[0,_r(w.path)]}(a))))});i.push(h)}}).next(()=>oe.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Zd(e,n)}Zn(e,n){const r=eo(e);let i,s=Rr._e;return r.Y({index:"documentTargetsIndex"},([a,u],{path:h,sequenceNumber:g})=>{a===0?(s!==Rr._e&&n(new be(Qi(i)),s),s=g,i=h):s=Rr._e}).next(()=>{s!==Rr._e&&n(new be(Qi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Zd(t,e){return eo(t).put(function(r,i){return{targetId:0,path:_r(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(){this.changes=new Go(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,$t.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?oe.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ta(e).put(r)}removeEntry(e,n,r){return ta(e).delete(function(s,a){const u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],xg(a),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=$t.newInvalidDocument(n);return ta(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(nc(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:$t.newInvalidDocument(n)};return ta(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(nc(n))},(i,s)=>{r={document:this.tr(n,s),size:Ag(s)}}).next(()=>r)}getEntries(e,n){let r=Nr();return this.rr(e,n,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,n){let r=Nr(),i=new Vt(be.comparator);return this.rr(e,n,(s,a)=>{const u=this.tr(s,a);r=r.insert(s,u),i=i.insert(s,Ag(a))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return oe.resolve();let i=new Dt(qT);n.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(nc(i.first()),nc(i.last())),a=i.getIterator();let u=a.getNext();return ta(e).Y({index:"documentKeyIndex",range:s},(h,g,m)=>{const w=be.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;u&&qT(u,w)<0;)r(u,null),u=a.getNext();u&&u.isEqual(w)&&(r(u,g),u=a.hasNext()?a.getNext():null),u?m.U(nc(u)):m.done()}).next(()=>{for(;u;)r(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const a=n.path,u=[a.popLast().toArray(),a.lastSegment(),xg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ta(e).W(IDBKeyRange.bound(u,h,!0)).next(g=>{s==null||s.incrementDocumentReadCount(g.length);let m=Nr();for(const w of g){const T=this.tr(be.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);T.isFoundDocument()&&(ld(n,T)||i.has(T.key))&&(m=m.insert(T.key,T))}return m})}getAllFromCollectionGroup(e,n,r,i){let s=Nr();const a=$T(n,r),u=$T(n,Qr.max());return ta(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,u,!0)},(h,g,m)=>{const w=this.tr(be.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);s=s.insert(w.key,w),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new lU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return zT(e).get("remoteDocumentGlobalKey").next(n=>(Ue(!!n),n))}er(e,n){return zT(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=G9(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ze.min())))return r}return $t.newInvalidDocument(e)}}function f2(t){return new aU(t)}class lU extends d2{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Go(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Dt((s,a)=>st(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const u=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,u.readTime)),a.isValidDocument()){const h=bT(this._r.serializer,a);i=i.add(s.path.popLast());const g=Ag(h);r+=g-u.size,n.push(this._r.addEntry(e,s,h))}else if(r-=u.size,this.trackRemovals){const h=bT(this._r.serializer,a.convertToNoDocument(ze.min()));n.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),oe.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function zT(t){return Vn(t,"remoteDocumentGlobal")}function ta(t){return Vn(t,"remoteDocumentsV14")}function nc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $T(t,e){const n=e.documentKey.path.toArray();return[t,xg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function qT(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=st(n[s],r[s]),i)return i;return i=st(n.length,r.length),i||(i=st(n[n.length-2],r[r.length-2]),i||st(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Fc(r.mutation,i,kr.empty(),Yt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,at()).next(()=>r))}getLocalViewOfDocuments(e,n,r=at()){const i=Yi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=_c();return s.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Yi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,at()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,r,i){let s=Nr();const a=Vc(),u=function(){return Vc()}();return n.forEach((h,g)=>{const m=r.get(g.key);i.has(g.key)&&(m===void 0||m.mutation instanceof js)?s=s.insert(g.key,g):m!==void 0?(a.set(g.key,m.mutation.getFieldMask()),Fc(m.mutation,g,m.mutation.getFieldMask(),Yt.now())):a.set(g.key,kr.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((g,m)=>a.set(g,m)),n.forEach((g,m)=>{var w;return u.set(g,new uU(m,(w=a.get(g))!==null&&w!==void 0?w:null))}),u))}recalculateAndSaveOverlays(e,n){const r=Vc();let i=new Vt((a,u)=>a-u),s=at();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(h=>{const g=n.get(h);if(g===null)return;let m=r.get(h)||kr.empty();m=u.applyToLocalView(g,m),r.set(h,m);const w=(i.get(u.batchId)||at()).add(h);i=i.insert(u.batchId,w)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),g=h.key,m=h.value,w=DR();m.forEach(T=>{if(!s.has(T)){const I=jR(n.get(T),r.get(T));I!==null&&w.set(T,I),s=s.add(T)}}),a.push(this.documentOverlayCache.saveOverlays(e,g,w))}return oe.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return be.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Rw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):oe.resolve(Yi());let u=-1,h=s;return a.next(g=>oe.forEach(g,(m,w)=>(u<w.largestBatchId&&(u=w.largestBatchId),s.get(m)?oe.resolve():this.remoteDocumentCache.getEntry(e,m).next(T=>{h=h.insert(m,T)}))).next(()=>this.populateOverlays(e,g,s)).next(()=>this.computeViews(e,h,g,at())).next(m=>({batchId:u,changes:NR(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new be(n)).next(r=>{let i=_c();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=_c();return this.indexManager.getCollectionParents(e,s).next(u=>oe.forEach(u,h=>{const g=function(w,T){return new Us(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(n,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,g,r,i).next(m=>{m.forEach((w,T)=>{a=a.insert(w,T)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((h,g)=>{const m=g.getKey();a.get(m)===null&&(a=a.insert(m,$t.newInvalidDocument(m)))});let u=_c();return a.forEach((h,g)=>{const m=s.get(h);m!==void 0&&Fc(m.mutation,g,kr.empty(),Yt.now()),ld(n,g)&&(u=u.insert(h,g))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cU{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return oe.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:vn(i.createTime)}}(n)),oe.resolve()}getNamedQuery(e,n){return oe.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:Fw(i.bundledQuery),readTime:vn(i.readTime)}}(n)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(){this.overlays=new Vt(be.comparator),this.lr=new Map}getOverlay(e,n){return oe.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Yi();return oe.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),oe.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),oe.resolve()}getOverlaysForCollection(e,n,r){const i=Yi(),s=n.length+1,a=new be(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const h=u.getNext().value,g=h.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return oe.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Vt((g,m)=>g-m);const a=this.overlays.getIterator();for(;a.hasNext();){const g=a.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>r){let m=s.get(g.largestBatchId);m===null&&(m=Yi(),s=s.insert(g.largestBatchId,m)),m.set(g.getKey(),g)}}const u=Yi(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((g,m)=>u.set(g,m)),!(u.size()>=i)););return oe.resolve(u)}lt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Mw(n,r));let s=this.lr.get(n);s===void 0&&(s=at(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(){this.hr=new Dt(Pn.Pr),this.Ir=new Dt(Pn.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Pn(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Pn(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new be(new vt([])),r=new Pn(n,e),i=new Pn(n,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new be(new vt([])),r=new Pn(n,e),i=new Pn(n,e+1);let s=at();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new Pn(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Pn{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return be.comparator(e.key,n.key)||st(e.gr,n.gr)}static Tr(e,n){return st(e.gr,n.gr)||be.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Dt(Pn.Pr)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Dw(s,n,r,i);this.mutationQueue.push(a);for(const u of i)this.yr=this.yr.add(new Pn(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return oe.resolve(a)}lookupMutationBatch(e,n){return oe.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Sr(r),s=i<0?0:i;return oe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Pn(n,0),i=new Pn(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const u=this.wr(a.gr);s.push(u)}),oe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Dt(st);return n.forEach(i=>{const s=new Pn(i,0),a=new Pn(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],u=>{r=r.add(u.gr)})}),oe.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;be.isDocumentKey(s)||(s=s.child(""));const a=new Pn(new be(s),0);let u=new Dt(st);return this.yr.forEachWhile(h=>{const g=h.key.path;return!!r.isPrefixOf(g)&&(g.length===i&&(u=u.add(h.gr)),!0)},a),oe.resolve(this.br(u))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ue(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return oe.forEach(n.mutations,i=>{const s=new Pn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Pn(n,0),i=this.yr.firstAfterOrEqual(r);return oe.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e){this.Cr=e,this.docs=function(){return new Vt(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return oe.resolve(r?r.document.mutableCopy():$t.newInvalidDocument(n))}getEntries(e,n){let r=Nr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():$t.newInvalidDocument(i))}),oe.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Nr();const a=n.path,u=new be(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:g,value:{document:m}}=h.getNext();if(!a.isPrefixOf(g.path))break;g.path.length>a.length+1||Cw(lR(m),r)<=0||(i.has(m.key)||ld(n,m))&&(s=s.insert(m.key,m.mutableCopy()))}return oe.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Le()}vr(e,n){return oe.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new gU(this)}getSize(e){return oe.resolve(this.size)}}class gU extends d2{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),oe.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e){this.persistence=e,this.Fr=new Go(n=>Ua(n),od),this.lastRemoteSnapshotVersion=ze.min(),this.highestTargetId=0,this.Mr=0,this.Or=new jw,this.targetCount=0,this.Nr=Ha.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),oe.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Ha(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,oe.resolve()}updateTargetData(e,n){return this.kn(n),oe.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),oe.waitFor(s).next(()=>i)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return oe.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),oe.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),oe.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),oe.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return oe.resolve(r)}containsKey(e,n){return oe.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,n){this.Br={},this.overlays={},this.Lr=new Rr(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new pU(this),this.indexManager=new Z9,this.remoteDocumentCache=function(i){return new fU(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new s2(n),this.Kr=new cU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new hU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new dU(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){ve("MemoryPersistence","Starting transaction:",e);const i=new mU(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return oe.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class mU extends cR{constructor(e){super(),this.currentSequenceNumber=e}}class Wp{constructor(e){this.persistence=e,this.Gr=new jw,this.zr=null}static jr(e){return new Wp(e)}get Hr(){if(this.zr)return this.zr;throw Le()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),oe.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),oe.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),oe.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.Hr,r=>{const i=be.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,ze.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return oe.or([()=>oe.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e){this.serializer=e}N(e,n,r,i){const s=new jp("createOrUpgrade",n);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",sT,{unique:!0}),h.createObjectStore("documentMutations")}(e),HT(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=oe.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),HT(e)),a=a.next(()=>function(h){const g=h.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ze.min().toTimestamp(),targetCount:0};return g.put("targetGlobalKey",m)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,g){return g.store("mutations").W().next(m=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",sT,{unique:!0});const w=g.store("mutations"),T=m.map(I=>w.put(I));return oe.waitFor(T)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const g=h.createObjectStore("documentOverlays",{keyPath:e9});g.createIndex("collectionPathOverlayIndex",t9,{unique:!1}),g.createIndex("collectionGroupOverlayIndex",n9,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const g=h.createObjectStore("remoteDocumentsV14",{keyPath:$6});g.createIndex("documentKeyIndex",q6),g.createIndex("collectionGroupIndex",H6)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:Y6}).createIndex("sequenceNumberIndex",X6,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:J6}).createIndex("documentKeyIndex",Z6,{unique:!1})}(e))),a}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Ag(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>oe.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(u=>oe.forEach(u,h=>{Ue(h.userId===s.userId);const g=la(this.serializer,h);return u2(e,s.userId,g).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,u)=>{const h=new vt(a),g=function(w){return[0,_r(w)]}(h);s.push(n.get(g).next(m=>m?oe.resolve():(w=>n.put({targetId:0,path:_r(w),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>oe.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:Q6});const r=n.store("collectionParents"),i=new Uw,s=a=>{if(i.add(a)){const u=a.lastSegment(),h=a.popLast();return r.put({collectionId:u,parent:_r(h)})}};return n.store("remoteDocuments").Y({J:!0},(a,u)=>{const h=new vt(a);return s(h.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([a,u,h],g)=>{const m=Qi(u);return s(m.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=yc(i),a=o2(this.serializer,s);return n.put(a)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const u=n.store("remoteDocumentsV14"),h=function(w){return w.document?new be(vt.fromString(w.document.name).popFirst(5)):w.noDocument?be.fromSegments(w.noDocument.path):w.unknownDocument?be.fromSegments(w.unknownDocument.path):Le()}(a).path.toArray(),g={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(u.put(g))}).next(()=>oe.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=f2(this.serializer),s=new p2(Wp.jr,this.serializer.ut);return r.W().next(a=>{const u=new Map;return a.forEach(h=>{var g;let m=(g=u.get(h.userId))!==null&&g!==void 0?g:at();la(this.serializer,h).keys().forEach(w=>m=m.add(w)),u.set(h.userId,m)}),oe.forEach(u,(h,g)=>{const m=new kn(g),w=Hp.ct(this.serializer,m),T=s.getIndexManager(m),I=Gp.ct(m,this.serializer,T,s.referenceDelegate);return new g2(i,I,w,T).recalculateAndSaveOverlaysForDocumentKeys(new Zv(n,Rr._e),h).next()})})}}function HT(t){t.createObjectStore("targetDocuments",{keyPath:W6}).createIndex("documentTargetsIndex",K6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",G6,{unique:!0}),t.createObjectStore("targetGlobal")}const o_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class zw{constructor(e,n,r,i,s,a,u,h,g,m,w=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=a,this.document=u,this.oi=g,this._i=m,this.ai=w,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=T=>Promise.resolve(),!zw.D())throw new _e(ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oU(this,i),this.Ii=n+"main",this.serializer=new s2(h),this.Ti=new xi(this.Ii,this.ai,new _U(this.serializer)),this.qr=new tU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=f2(this.serializer),this.Kr=new W9,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,m===!1&&mn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _e(ce.FAILED_PRECONDITION,o_);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Rr(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ef(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Ho(e))return ve("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ve("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return rc(e).get("owner").next(n=>oe.resolve(this.wi(n)))}Si(e){return ef(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Vn(n,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(u=>s.indexOf(u)===-1);return oe.forEach(a,u=>r.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const n of e)this.Ei.removeItem(this.vi(n.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?oe.resolve(!0):rc(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new _e(ce.FAILED_PRECONDITION,o_);return!1}}return!(!this.networkEnabled||!this.inForeground)||ef(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||a&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ve("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Zv(e,Rr._e);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>ef(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Gp.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new eU(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Hp.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){ve("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(h){return h===15?i9:h===14?pR:h===13?gR:h===12?r9:h===11?fR:void Le()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,u=>(a=new Zv(u,this.Lr?this.Lr.next():Rr._e),n==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw mn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new _e(ce.FAILED_PRECONDITION,uR);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Li(e){return rc(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new _e(ce.FAILED_PRECONDITION,o_)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return rc(e).put("owner",n)}static D(){return xi.D()}pi(e){const n=rc(e);return n.get("owner").next(r=>this.wi(r)?(ve("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):oe.resolve())}Di(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;UL()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return ve("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){mn("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function rc(t){return Vn(t,"owner")}function ef(t){return Vn(t,"clientMetadata")}function $w(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=at(),i=at();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new qw(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new vU;return this.Hi(e,n,a).next(u=>{if(s.result=u,this.$i)return this.Ji(e,n,a,u.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(ml()<=ct.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",_l(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),oe.resolve()):(ml()<=ct.DEBUG&&ve("QueryEngine","Query:",_l(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(ml()<=ct.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",_l(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vr(n))):oe.resolve())}zi(e,n){if(_T(n))return oe.resolve(null);let r=vr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Sg(n,null,"F"),r=vr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=at(...s);return this.Gi.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{const g=this.Yi(n,u);return this.Zi(n,g,a,h.readTime)?this.zi(e,Sg(n,null,"F")):this.Xi(e,g,n,h)}))})))}ji(e,n,r,i){return _T(n)||i.isEqual(ze.min())?oe.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(n,s);return this.Zi(n,a,r,i)?oe.resolve(null):(ml()<=ct.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_l(n)),this.Xi(e,a,n,aR(i,-1)).next(u=>u))})}Yi(e,n){let r=new Dt(RR(e));return n.forEach((i,s)=>{ld(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return ml()<=ct.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",_l(n)),this.Gi.getDocumentsMatchingQuery(e,n,Qr.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Vt(st),this.ns=new Go(s=>Ua(s),od),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new g2(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function _2(t,e,n,r){return new yU(t,e,n,r)}async function v2(t,e){const n=Ne(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],u=[];let h=at();for(const g of i){a.push(g.batchId);for(const m of g.mutations)h=h.add(m.key)}for(const g of s){u.push(g.batchId);for(const m of g.mutations)h=h.add(m.key)}return n.localDocuments.getDocuments(r,h).next(g=>({_s:g,removedBatchIds:a,addedBatchIds:u}))})})}function wU(t,e){const n=Ne(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(u,h,g,m){const w=g.batch,T=w.keys();let I=oe.resolve();return T.forEach(j=>{I=I.next(()=>m.getEntry(h,j)).next(z=>{const X=g.docVersions.get(j);Ue(X!==null),z.version.compareTo(X)<0&&(w.applyToRemoteDocument(z,g),z.isValidDocument()&&(z.setReadTime(g.commitVersion),m.addEntry(z)))})}),I.next(()=>u.mutationQueue.removeMutationBatch(h,w))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=at();for(let g=0;g<u.mutationResults.length;++g)u.mutationResults[g].transformResults.length>0&&(h=h.add(u.batch.mutations[g].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function y2(t){const e=Ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function EU(t,e){const n=Ne(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const u=[];e.targetChanges.forEach((m,w)=>{const T=i.get(w);if(!T)return;u.push(n.qr.removeMatchingKeys(s,m.removedDocuments,w).next(()=>n.qr.addMatchingKeys(s,m.addedDocuments,w)));let I=T.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(w)!==null?I=I.withResumeToken(Sn.EMPTY_BYTE_STRING,ze.min()).withLastLimboFreeSnapshotVersion(ze.min()):m.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(m.resumeToken,r)),i=i.insert(w,I),function(z,X,V){return z.resumeToken.approximateByteSize()===0||X.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(T,I,m)&&u.push(n.qr.updateTargetData(s,I))});let h=Nr(),g=at();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,m))}),u.push(w2(s,a,e.documentUpdates).next(m=>{h=m.us,g=m.cs})),!r.isEqual(ze.min())){const m=n.qr.getLastRemoteSnapshotVersion(s).next(w=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(m)}return oe.waitFor(u).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,h,g)).next(()=>h)}).then(s=>(n.ts=i,s))}function w2(t,e,n){let r=at(),i=at();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=Nr();return n.forEach((u,h)=>{const g=s.get(u);h.isFoundDocument()!==g.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(ze.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!g.isValidDocument()||h.version.compareTo(g.version)>0||h.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):ve("LocalStore","Ignoring outdated watch update for ",u,". Current version:",g.version," Watch version:",h.version)}),{us:a,cs:i}})}function IU(t,e){const n=Ne(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pu(t,e){const n=Ne(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,oe.resolve(i)):n.qr.allocateTargetId(r).next(a=>(i=new Is(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function mu(t,e,n){const r=Ne(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ho(a))throw a;ve("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function bg(t,e,n){const r=Ne(t);let i=ze.min(),s=at();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,g,m){const w=Ne(h),T=w.ns.get(m);return T!==void 0?oe.resolve(w.ts.get(T)):w.qr.getTargetData(g,m)}(r,a,vr(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,u.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,n?i:ze.min(),n?s:at())).next(u=>(T2(r,PR(e),u),{documents:u,ls:s})))}function E2(t,e){const n=Ne(t),r=Ne(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function I2(t,e){const n=Ne(t),r=n.rs.get(e)||ze.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,aR(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(T2(n,e,i),i))}function T2(t,e,n){let r=t.rs.get(e)||ze.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}async function TU(t,e,n,r){const i=Ne(t);let s=at(),a=Nr();for(const g of n){const m=e.hs(g.metadata.name);g.document&&(s=s.add(m));const w=e.Ps(g);w.setReadTime(e.Is(g.metadata.readTime)),a=a.insert(m,w)}const u=i.ss.newChangeBuffer({trackRemovals:!0}),h=await pu(i,function(m){return vr(Nu(vt.fromString(`__bundle__/docs/${m}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",g=>w2(g,u,a).next(m=>(u.apply(g),m)).next(m=>i.qr.removeMatchingKeysForTargetId(g,h.targetId).next(()=>i.qr.addMatchingKeys(g,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(g,m.us,m.cs)).next(()=>m.us)))}async function SU(t,e,n=at()){const r=await pu(t,vr(Fw(e.bundledQuery))),i=Ne(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=vn(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const u=r.withResumeToken(Sn.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(u.targetId,u),i.qr.updateTargetData(s,u).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function GT(t,e){return`firestore_clients_${t}_${e}`}function WT(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function a_(t,e){return`firestore_targets_${t}_${e}`}class Pg{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new _e(i.error.code,i.error.message))),a?new Pg(e,n,i.state,s):(mn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new _e(r.error.code,r.error.message))),s?new Bc(e,r.state,i):(mn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Rg{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=kw();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=hR(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new Rg(e,s):(mn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Hw{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Hw(n.clientId,n.onlineState):(mn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class dy{constructor(){this.activeTargetIds=kw()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class l_{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Vt(st),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=GT(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new dy),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(GT(this.persistenceKey,r));if(i){const s=Rg.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const n=this.storage.getItem(this.Cs);if(n){const r=this.Ms(n);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(a_(this.persistenceKey,e));if(r){const i=Bc.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(a_(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ve("SharedClientState","READ",e,n),n}setItem(e,n){ve("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){ve("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const n=e;if(n.storageArea===this.storage){if(ve("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void mn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){const r=this.Ks(n.key);return this.$s(r,null)}{const r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){const r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){const r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){const r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){const r=function(s){let a=Rr._e;if(s!=null)try{const u=JSON.parse(s);Ue(typeof u=="number"),a=u}catch(u){mn("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(n.newValue);r!==Rr._e&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){const r=this.Hs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new Pg(this.currentUser,e,n,r),s=WT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=WT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){const n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){const i=a_(this.persistenceKey,e),s=new Bc(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return Rg.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Pg.Ts(new kn(s),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return Bc.Ts(i,n)}Ms(e){return Hw.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);ve("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],u=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||u.push(h)}),this.syncEngine.Xs(a,u).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=kw();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class S2{constructor(){this.eo=new dy,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new dy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){ve("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){ve("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tf=null;function u_(){return tf===null?tf=function(){return 268435456+Math.round(2147483648*Math.random())}():tf++,"0x"+tf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr="WebChannelConnection";class bU extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,a){const u=u_(),h=this.So(n,r);ve("RestConnection",`Sending RPC '${n}' ${u}:`,h,i);const g={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(g,s,a),this.Do(n,h,g,i).then(m=>(ve("RestConnection",`Received RPC '${n}' ${u}: `,m),m),m=>{throw Ni("RestConnection",`RPC '${n}' ${u} failed with error: `,m,"url: ",h,"request:",i),m})}Co(n,r,i,s,a,u){return this.wo(n,r,i,s,a)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ku}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}So(n,r){const i=CU[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=u_();return new Promise((a,u)=>{const h=new T6;h.setWithCredentials(!0),h.listenOnce(E6.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case i_.NO_ERROR:const m=h.getResponseJson();ve(tr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),a(m);break;case i_.TIMEOUT:ve(tr,`RPC '${e}' ${s} timed out`),u(new _e(ce.DEADLINE_EXCEEDED,"Request time out"));break;case i_.HTTP_ERROR:const w=h.getStatus();if(ve(tr,`RPC '${e}' ${s} failed with status:`,w,"response text:",h.getResponseText()),w>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const I=T==null?void 0:T.error;if(I&&I.status&&I.message){const j=function(X){const V=X.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(V)>=0?V:ce.UNKNOWN}(I.status);u(new _e(j,I.message))}else u(new _e(ce.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new _e(ce.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{ve(tr,`RPC '${e}' ${s} completed.`)}});const g=JSON.stringify(i);ve(tr,`RPC '${e}' ${s} sending request:`,i),h.send(n,"POST",g,r,15)})}vo(e,n,r){const i=u_(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=y6(),u=w6(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(h.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;const m=s.join("");ve(tr,`Creating RPC '${e}' stream ${i}: ${m}`,h);const w=a.createWebChannel(m,h);let T=!1,I=!1;const j=new AU({co:X=>{I?ve(tr,`Not sending because RPC '${e}' stream ${i} is closed:`,X):(T||(ve(tr,`Opening RPC '${e}' stream ${i} transport.`),w.open(),T=!0),ve(tr,`RPC '${e}' stream ${i} sending:`,X),w.send(X))},lo:()=>w.close()}),z=(X,V,B)=>{X.listen(V,U=>{try{B(U)}catch(J){setTimeout(()=>{throw J},0)}})};return z(w,Yd.EventType.OPEN,()=>{I||ve(tr,`RPC '${e}' stream ${i} transport opened.`)}),z(w,Yd.EventType.CLOSE,()=>{I||(I=!0,ve(tr,`RPC '${e}' stream ${i} transport closed`),j.Ro())}),z(w,Yd.EventType.ERROR,X=>{I||(I=!0,Ni(tr,`RPC '${e}' stream ${i} transport errored:`,X),j.Ro(new _e(ce.UNAVAILABLE,"The operation could not be completed")))}),z(w,Yd.EventType.MESSAGE,X=>{var V;if(!I){const B=X.data[0];Ue(!!B);const U=B,J=U.error||((V=U[0])===null||V===void 0?void 0:V.error);if(J){ve(tr,`RPC '${e}' stream ${i} received error:`,J);const re=J.status;let te=function(me){const pe=yn[me];if(pe!==void 0)return qR(pe)}(re),ae=J.message;te===void 0&&(te=ce.INTERNAL,ae="Unknown error status: "+re+" with message "+J.message),I=!0,j.Ro(new _e(te,ae)),w.close()}else ve(tr,`RPC '${e}' stream ${i} received:`,B),j.Vo(B)}}),z(u,I6.STAT_EVENT,X=>{X.stat===tT.PROXY?ve(tr,`RPC '${e}' stream ${i} detected buffering proxy`):X.stat===tT.NOPROXY&&ve(tr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{j.Ao()},0),j}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(){return typeof window<"u"?window:null}function Rf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t){return new L9(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,n,r,i,s,a,u,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Gw(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,n){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===ce.RESOURCE_EXHAUSTED?(mn(n.toString()),mn("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(n)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new _e(ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return ve("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(ve("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PU extends C2{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=B9(this.serializer,e),r=function(s){if(!("targetChange"in s))return ze.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ze.min():a.readTime?vn(a.readTime):ze.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=Rh(this.serializer),n.addTarget=function(s,a){let u;const h=a.target;if(u=Ig(h)?{documents:ZR(s,h)}:{query:e2(s,h)},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=KR(s,a.resumeToken);const g=oy(s,a.expectedCount);g!==null&&(u.expectedCount=g)}else if(a.snapshotVersion.compareTo(ze.min())>0){u.readTime=gu(s,a.snapshotVersion.toTimestamp());const g=oy(s,a.expectedCount);g!==null&&(u.expectedCount=g)}return u}(this.serializer,e);const r=j9(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=Rh(this.serializer),n.removeTarget=e,this.e_(n)}}class RU extends C2{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=U9(e.writeResults,e.commitTime),r=vn(e.commitTime);return this.listener.I_(r,n)}return Ue(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Rh(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>kh(this.serializer,r))};this.e_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new _e(ce.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new _e(ce.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,n,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new _e(ce.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class NU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(mn(n),this.f_=!1):ve("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{Wo(this)&&(ve("RemoteStore","Restarting streams for network reachability change."),await async function(h){const g=Ne(h);g.C_.add(4),await Mu(g),g.M_.set("Unknown"),g.C_.delete(4),await fd(g)}(this))})}),this.M_=new NU(r,i)}}async function fd(t){if(Wo(t))for(const e of t.v_)await e(!0)}async function Mu(t){for(const e of t.v_)await e(!1)}function Kp(t,e){const n=Ne(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),Qw(n)?Kw(n):Vu(n).Ho()&&Ww(n,e))}function Nh(t,e){const n=Ne(t),r=Vu(n);n.D_.delete(e),r.Ho()&&A2(n,e),n.D_.size===0&&(r.Ho()?r.Zo():Wo(n)&&n.M_.set("Unknown"))}function Ww(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ze.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Vu(t).u_(e)}function A2(t,e){t.x_.Oe(e),Vu(t).c_(e)}function Kw(t){t.x_=new N9({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Vu(t).start(),t.M_.g_()}function Qw(t){return Wo(t)&&!Vu(t).jo()&&t.D_.size>0}function Wo(t){return Ne(t).C_.size===0}function b2(t){t.x_=void 0}async function OU(t){t.D_.forEach((e,n)=>{Ww(t,e)})}async function MU(t,e){b2(t),Qw(t)?(t.M_.w_(e),Kw(t)):t.M_.set("Unknown")}async function LU(t,e,n){if(t.M_.set("Online"),e instanceof WR&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const u of s.targetIds)i.D_.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.D_.delete(u),i.x_.removeTarget(u))}(t,e)}catch(r){ve("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await kg(t,r)}else if(e instanceof Pf?t.x_.$e(e):e instanceof GR?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(ze.min()))try{const r=await y2(t.localStore);n.compareTo(r)>=0&&await function(s,a){const u=s.x_.it(a);return u.targetChanges.forEach((h,g)=>{if(h.resumeToken.approximateByteSize()>0){const m=s.D_.get(g);m&&s.D_.set(g,m.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,g)=>{const m=s.D_.get(h);if(!m)return;s.D_.set(h,m.withResumeToken(Sn.EMPTY_BYTE_STRING,m.snapshotVersion)),A2(s,h);const w=new Is(m.target,h,g,m.sequenceNumber);Ww(s,w)}),s.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){ve("RemoteStore","Failed to raise snapshot:",r),await kg(t,r)}}async function kg(t,e,n){if(!Ho(e))throw e;t.C_.add(1),await Mu(t),t.M_.set("Offline"),n||(n=()=>y2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ve("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await fd(t)})}function P2(t,e){return e().catch(n=>kg(t,n,e))}async function Lu(t){const e=Ne(t),n=No(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;VU(e);)try{const i=await IU(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,FU(e,i)}catch(i){await kg(e,i)}R2(e)&&k2(e)}function VU(t){return Wo(t)&&t.b_.length<10}function FU(t,e){t.b_.push(e);const n=No(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function R2(t){return Wo(t)&&!No(t).jo()&&t.b_.length>0}function k2(t){No(t).start()}async function BU(t){No(t).E_()}async function UU(t){const e=No(t);for(const n of t.b_)e.P_(n.mutations)}async function jU(t,e,n){const r=t.b_.shift(),i=Ow.from(r,e,n);await P2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Lu(t)}async function zU(t,e){e&&No(t).h_&&await async function(r,i){if(function(a){return $R(a)&&a!==ce.ABORTED}(i.code)){const s=r.b_.shift();No(r).Yo(),await P2(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Lu(r)}}(t,e),R2(t)&&k2(t)}async function QT(t,e){const n=Ne(t);n.asyncQueue.verifyOperationInProgress(),ve("RemoteStore","RemoteStore received new credentials");const r=Wo(n);n.C_.add(3),await Mu(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await fd(n)}async function fy(t,e){const n=Ne(t);e?(n.C_.delete(2),await fd(n)):e||(n.C_.add(2),await Mu(n),n.M_.set("Unknown"))}function Vu(t){return t.O_||(t.O_=function(n,r,i){const s=Ne(n);return s.A_(),new PU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:OU.bind(null,t),Io:MU.bind(null,t),a_:LU.bind(null,t)}),t.v_.push(async e=>{e?(t.O_.Yo(),Qw(t)?Kw(t):t.M_.set("Unknown")):(await t.O_.stop(),b2(t))})),t.O_}function No(t){return t.N_||(t.N_=function(n,r,i){const s=Ne(n);return s.A_(),new RU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:BU.bind(null,t),Io:zU.bind(null,t),T_:UU.bind(null,t),I_:jU.bind(null,t)}),t.v_.push(async e=>{e?(t.N_.Yo(),await Lu(t)):(await t.N_.stop(),t.b_.length>0&&(ve("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))})),t.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,u=new Yw(e,n,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _e(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fu(t,e){if(mn("AsyncQueue",`${e}: ${t}`),Ho(t))return new _e(ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||be.comparator(n.key,r.key):(n,r)=>be.comparator(n.key,r.key),this.keyedMap=_c(),this.sortedSet=new Vt(this.comparator)}static emptySet(e){return new Yl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Yl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Yl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(){this.B_=new Vt(be.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):Le():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class _u{constructor(e,n,r,i,s,a,u,h,g){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=g}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new _u(e,n,Yl.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ad(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(){this.k_=void 0,this.listeners=[]}}class qU{constructor(){this.queries=new Go(e=>bR(e),ad),this.onlineState="Unknown",this.q_=new Set}}async function Xw(t,e){const n=Ne(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new $U),i)try{s.k_=await n.onListen(r)}catch(a){const u=Fu(a,`Initialization of query '${_l(e.query)}' failed`);return void e.onError(u)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&Zw(n)}async function Jw(t,e){const n=Ne(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function HU(t,e){const n=Ne(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const u of a.listeners)u.K_(i)&&(r=!0);a.k_=i}}r&&Zw(n)}function GU(t,e,n){const r=Ne(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function Zw(t){t.q_.forEach(e=>{e.next()})}class eE{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new _u(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=_u.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e){this.serializer=e}hs(e){return ts(this.serializer,e)}Ps(e){return e.metadata.exists?JR(this.serializer,e.document,!1):$t.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return vn(e)}}class KU{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=N2(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=vt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new XT(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const u=(n.get(a)||at()).add(s);n.set(a,u)}}return n}async complete(){const e=await TU(this.localStore,new XT(this.serializer),this.documents,this.X_.id),n=this.ta(this.documents);for(const r of this.queries)await SU(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function N2(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.key=e}}class O2{constructor(e){this.key=e}}class M2{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=at(),this.mutatedKeys=at(),this._a=RR(e),this.aa=new Yl(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new YT,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,g=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,w)=>{const T=i.get(m),I=ld(this.query,w)?w:null,j=!!T&&this.mutatedKeys.has(T.key),z=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let X=!1;T&&I?T.data.isEqual(I.data)?j!==z&&(r.track({type:3,doc:I}),X=!0):this.ha(T,I)||(r.track({type:2,doc:I}),X=!0,(h&&this._a(I,h)>0||g&&this._a(I,g)<0)&&(u=!0)):!T&&I?(r.track({type:0,doc:I}),X=!0):T&&!I&&(r.track({type:1,doc:T}),X=!0,(h||g)&&(u=!0)),X&&(I?(a=a.add(I),s=z?s.add(m):s.delete(m)):(a=a.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{aa:a,la:r,Zi:u,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((m,w)=>function(I,j){const z=X=>{switch(X){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return z(I)-z(j)}(m.type,w.type)||this._a(m.doc,w.doc)),this.Pa(r),i=i!=null&&i;const u=n&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,g=h!==this.sa;return this.sa=h,a.length!==0||g?{snapshot:new _u(this.query,e.aa,s,a,e.mutatedKeys,h===0,g,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:u}:{Ta:u}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new YT,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=at(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new O2(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new D2(r))}),n}da(e){this.ia=e.ls,this.oa=at();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return _u.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class QU{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class YU{constructor(e){this.key=e,this.Ra=!1}}class XU{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new Go(u=>bR(u),ad),this.fa=new Map,this.ga=new Set,this.pa=new Vt(be.comparator),this.ya=new Map,this.wa=new jw,this.Sa={},this.ba=new Map,this.Da=Ha.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function JU(t,e){const n=sE(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await pu(n.localStore,vr(e)),u=n.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await tE(n,e,r,u==="current",a.resumeToken),n.isPrimaryClient&&Kp(n.remoteStore,a)}return i}async function tE(t,e,n,r,i){t.va=(w,T,I)=>async function(z,X,V,B){let U=X.view.ca(V);U.Zi&&(U=await bg(z.localStore,X.query,!1).then(({documents:ae})=>X.view.ca(ae,U)));const J=B&&B.targetChanges.get(X.targetId),re=B&&B.targetMismatches.get(X.targetId)!=null,te=X.view.applyChanges(U,z.isPrimaryClient,J,re);return gy(z,X.targetId,te.Ta),te.snapshot}(t,w,T,I);const s=await bg(t.localStore,e,!0),a=new M2(e,s.ls),u=a.ca(s.documents),h=hd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),g=a.applyChanges(u,t.isPrimaryClient,h);gy(t,n,g.Ta);const m=new QU(e,n,a);return t.ma.set(e,m),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),g.snapshot}async function ZU(t,e){const n=Ne(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!ad(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await mu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Nh(n.remoteStore,r.targetId),vu(n,r.targetId)}).catch(qo)):(vu(n,r.targetId),await mu(n.localStore,r.targetId,!0))}async function ej(t,e,n){const r=oE(t);try{const i=await function(a,u){const h=Ne(a),g=Yt.now(),m=u.reduce((I,j)=>I.add(j.key),at());let w,T;return h.persistence.runTransaction("Locally write mutations","readwrite",I=>{let j=Nr(),z=at();return h.ss.getEntries(I,m).next(X=>{j=X,j.forEach((V,B)=>{B.isValidDocument()||(z=z.add(V))})}).next(()=>h.localDocuments.getOverlayedDocuments(I,j)).next(X=>{w=X;const V=[];for(const B of u){const U=P9(B,w.get(B.key).overlayedDocument);U!=null&&V.push(new js(B.key,U,yR(U.value.mapValue),Qt.exists(!0)))}return h.mutationQueue.addMutationBatch(I,g,V,u)}).next(X=>{T=X;const V=X.applyToLocalDocumentSet(w,z);return h.documentOverlayCache.saveOverlays(I,X.batchId,V)})}).then(()=>({batchId:T.batchId,changes:NR(w)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let g=a.Sa[a.currentUser.toKey()];g||(g=new Vt(st)),g=g.insert(u,h),a.Sa[a.currentUser.toKey()]=g}(r,i.batchId,n),await zs(r,i.changes),await Lu(r.remoteStore)}catch(i){const s=Fu(i,"Failed to persist write");n.reject(s)}}async function L2(t,e){const n=Ne(t);try{const r=await EU(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.ya.get(s);a&&(Ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?Ue(a.Ra):i.removedDocuments.size>0&&(Ue(a.Ra),a.Ra=!1))}),await zs(n,r,e)}catch(r){await qo(r)}}function JT(t,e,n){const r=Ne(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.ma.forEach((s,a)=>{const u=a.view.Q_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){const h=Ne(a);h.onlineState=u;let g=!1;h.queries.forEach((m,w)=>{for(const T of w.listeners)T.Q_(u)&&(g=!0)}),g&&Zw(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tj(t,e,n){const r=Ne(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Vt(be.comparator);a=a.insert(s,$t.newNoDocument(s,ze.min()));const u=at().add(s),h=new cd(ze.min(),new Map,new Vt(st),a,u);await L2(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),iE(r)}else await mu(r.localStore,e,!1).then(()=>vu(r,e,n)).catch(qo)}async function nj(t,e){const n=Ne(t),r=e.batch.batchId;try{const i=await wU(n.localStore,e);rE(n,r,null),nE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await zs(n,i)}catch(i){await qo(i)}}async function rj(t,e,n){const r=Ne(t);try{const i=await function(a,u){const h=Ne(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let m;return h.mutationQueue.lookupMutationBatch(g,u).next(w=>(Ue(w!==null),m=w.keys(),h.mutationQueue.removeMutationBatch(g,w))).next(()=>h.mutationQueue.performConsistencyCheck(g)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(g,m,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,m)).next(()=>h.localDocuments.getDocuments(g,m))})}(r.localStore,e);rE(r,e,n),nE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await zs(r,i)}catch(i){await qo(i)}}async function ij(t,e){const n=Ne(t);Wo(n.remoteStore)||ve("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const u=Ne(a);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=Fu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function nE(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function rE(t,e,n){const r=Ne(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function vu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||V2(t,r)})}function V2(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);n!==null&&(Nh(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),iE(t))}function gy(t,e,n){for(const r of n)r instanceof D2?(t.wa.addReference(r.key,e),sj(t,r)):r instanceof O2?(ve("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||V2(t,r.key)):Le()}function sj(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(ve("SyncEngine","New document in limbo: "+n),t.ga.add(r),iE(t))}function iE(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new be(vt.fromString(e)),r=t.Da.next();t.ya.set(r,new YU(n)),t.pa=t.pa.insert(n,r),Kp(t.remoteStore,new Is(vr(Nu(n.path)),r,"TargetPurposeLimboResolution",Rr._e))}}async function zs(t,e,n){const r=Ne(t),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((u,h)=>{a.push(r.va(h,e,n).then(g=>{if((g||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,g!=null&&g.fromCache?"not-current":"current"),g){i.push(g);const m=qw.Qi(h.targetId,g);s.push(m)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,g){const m=Ne(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>oe.forEach(g,T=>oe.forEach(T.ki,I=>m.persistence.referenceDelegate.addReference(w,T.targetId,I)).next(()=>oe.forEach(T.qi,I=>m.persistence.referenceDelegate.removeReference(w,T.targetId,I)))))}catch(w){if(!Ho(w))throw w;ve("LocalStore","Failed to update sequence numbers: "+w)}for(const w of g){const T=w.targetId;if(!w.fromCache){const I=m.ts.get(T),j=I.snapshotVersion,z=I.withLastLimboFreeSnapshotVersion(j);m.ts=m.ts.insert(T,z)}}}(r.localStore,s))}async function oj(t,e){const n=Ne(t);if(!n.currentUser.isEqual(e)){ve("SyncEngine","User change. New user:",e.toKey());const r=await v2(n.localStore,e);n.currentUser=e,function(s,a){s.ba.forEach(u=>{u.forEach(h=>{h.reject(new _e(ce.CANCELLED,a))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zs(n,r._s)}}function aj(t,e){const n=Ne(t),r=n.ya.get(e);if(r&&r.Ra)return at().add(r.key);{let i=at();const s=n.fa.get(e);if(!s)return i;for(const a of s){const u=n.ma.get(a);i=i.unionWith(u.view.ua)}return i}}async function lj(t,e){const n=Ne(t),r=await bg(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&gy(n,e.targetId,i.Ta),i}async function uj(t,e){const n=Ne(t);return I2(n.localStore,e).then(r=>zs(n,r))}async function cj(t,e,n,r){const i=Ne(t),s=await function(u,h){const g=Ne(u),m=Ne(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",w=>m.Cn(w,h).next(T=>T?g.localDocuments.getDocuments(w,T):oe.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Lu(i.remoteStore):n==="acknowledged"||n==="rejected"?(rE(i,e,r||null),nE(i,e),function(u,h){Ne(Ne(u).mutationQueue).Fn(h)}(i.localStore,e)):Le(),await zs(i,s)):ve("SyncEngine","Cannot apply mutation batch with id: "+e)}async function hj(t,e){const n=Ne(t);if(sE(n),oE(n),e===!0&&n.Ca!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await ZT(n,r.toArray());n.Ca=!0,await fy(n.remoteStore,!0);for(const s of i)Kp(n.remoteStore,s)}else if(e===!1&&n.Ca!==!1){const r=[];let i=Promise.resolve();n.fa.forEach((s,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(vu(n,a),mu(n.localStore,a,!0))),Nh(n.remoteStore,a)}),await i,await ZT(n,r),function(a){const u=Ne(a);u.ya.forEach((h,g)=>{Nh(u.remoteStore,g)}),u.wa.Vr(),u.ya=new Map,u.pa=new Vt(be.comparator)}(n),n.Ca=!1,await fy(n.remoteStore,!1)}}async function ZT(t,e,n){const r=Ne(t),i=[],s=[];for(const a of e){let u;const h=r.fa.get(a);if(h&&h.length!==0){u=await pu(r.localStore,vr(h[0]));for(const g of h){const m=r.ma.get(g),w=await lj(r,m);w.snapshot&&s.push(w.snapshot)}}else{const g=await E2(r.localStore,a);u=await pu(r.localStore,g),await tE(r,F2(g),a,!1,u.resumeToken)}i.push(u)}return r.Va.a_(s),i}function F2(t){return AR(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dj(t){return function(n){return Ne(Ne(n).persistence).Bi()}(Ne(t).localStore)}async function fj(t,e,n,r){const i=Ne(t);if(i.Ca)return void ve("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const a=await I2(i.localStore,PR(s[0])),u=cd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Sn.EMPTY_BYTE_STRING);await zs(i,a,u);break}case"rejected":await mu(i.localStore,e,!0),vu(i,e,r);break;default:Le()}}async function gj(t,e,n){const r=sE(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){ve("SyncEngine","Adding an already active target "+i);continue}const s=await E2(r.localStore,i),a=await pu(r.localStore,s);await tE(r,F2(s),a.targetId,!1,a.resumeToken),Kp(r.remoteStore,a)}for(const i of n)r.fa.has(i)&&await mu(r.localStore,i,!1).then(()=>{Nh(r.remoteStore,i),vu(r,i)}).catch(qo)}}function sE(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=L2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tj.bind(null,e),e.Va.a_=HU.bind(null,e.eventManager),e.Va.Fa=GU.bind(null,e.eventManager),e}function oE(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rj.bind(null,e),e}function pj(t,e,n){const r=Ne(t);(async function(s,a,u){try{const h=await a.getMetadata();if(await function(I,j){const z=Ne(I),X=vn(j.createTime);return z.persistence.runTransaction("hasNewerBundle","readonly",V=>z.Kr.getBundleMetadata(V,j.id)).then(V=>!!V&&V.createTime.compareTo(X)>=0)}(s.localStore,h))return await a.close(),u._completeWith(function(I){return{taskState:"Success",documentsLoaded:I.totalDocuments,bytesLoaded:I.totalBytes,totalDocuments:I.totalDocuments,totalBytes:I.totalBytes}}(h)),Promise.resolve(new Set);u._updateProgress(N2(h));const g=new KU(h,s.localStore,a.serializer);let m=await a.Ma();for(;m;){const T=await g.ea(m);T&&u._updateProgress(T),m=await a.Ma()}const w=await g.complete();return await zs(s,w.ra,void 0),await function(I,j){const z=Ne(I);return z.persistence.runTransaction("Save bundle","readwrite",X=>z.Kr.saveBundleMetadata(X,j))}(s.localStore,h),u._completeWith(w.progress),Promise.resolve(w.na)}catch(h){return Ni("SyncEngine",`Loading bundle failed with ${h}`),u._failWith(h),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class py{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=dd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return _2(this.persistence,new m2,e.initialUser,this.serializer)}createPersistence(e){return new p2(Wp.jr,this.serializer)}createSharedClientState(e){return new S2}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class B2 extends py{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await oE(this.xa.syncEngine),await Lu(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return _2(this.persistence,new m2,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new rU(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new U6(n,this.persistence);return new B6(e.asyncQueue,r)}createPersistence(e){const n=$w(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?xr.withCacheSize(this.cacheSizeBytes):xr.DEFAULT;return new zw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,x2(),Rf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new S2}}class mj extends B2{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xa.syncEngine;this.sharedClientState instanceof l_&&(this.sharedClientState.syncEngine={Ys:cj.bind(null,n),Zs:fj.bind(null,n),Xs:gj.bind(null,n),Bi:dj.bind(null,n),Js:uj.bind(null,n)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await hj(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=x2();if(!l_.D(n))throw new _e(ce.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=$w(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new l_(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class aE{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>JT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oj.bind(null,this.syncEngine),await fy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qU}()}createDatastore(e){const n=dd(e.databaseInfo.databaseId),r=function(s){return new bU(s)}(e.databaseInfo);return function(s,a,u,h){return new kU(s,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,u){return new DU(r,i,s,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>JT(this.syncEngine,n,0),function(){return KT.D()?new KT:new xU}())}createSyncEngine(e,n){return function(i,s,a,u,h,g,m){const w=new XU(i,s,a,u,h,g);return m&&(w.Ca=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=Ne(n);ve("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await Mu(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):mn("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Dn,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const n=this.La.decode(e),r=Number(n);isNaN(r)&&this.Qa(`length string (${n}) is not valid number`);const i=await this.Ka(r);return new WU(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e===123)}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const n=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new _e(ce.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,s){const a=Ne(i),u=Rh(a.serializer)+"/documents",h={documents:s.map(T=>Ph(a.serializer,T))},g=await a.Co("BatchGetDocuments",u,h,s.length),m=new Map;g.forEach(T=>{const I=F9(a.serializer,T);m.set(I.key.toString(),I)});const w=[];return s.forEach(T=>{const I=m.get(T.toString());Ue(!!I),w.push(I)}),w}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ou(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=be.fromPath(r);this.mutations.push(new Nw(i,this.precondition(i)))}),await async function(r,i){const s=Ne(r),a=Rh(s.serializer)+"/documents",u={writes:i.map(h=>kh(s.serializer,h))};await s.wo("Commit",a,u)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Le();n=ze.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new _e(ce.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ze.min())?Qt.exists(!1):Qt.updateTime(n):Qt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ze.min()))throw new _e(ce.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qt.updateTime(n)}return Qt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new Gw(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new vj(this.datastore),n=this.za(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const n=this.updateFunction(e);return!sd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!$R(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=kn.UNAUTHENTICATED,this.clientId=sR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{ve("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(ve("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _e(ce.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Fu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function kf(t,e){t.asyncQueue.verifyOperationInProgress(),ve("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await v2(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function my(t,e){t.asyncQueue.verifyOperationInProgress();const n=await lE(t);ve("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>QT(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>QT(e.remoteStore,s)),t._onlineComponents=e}function U2(t){return t.name==="FirebaseError"?t.code===ce.FAILED_PRECONDITION||t.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function lE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ve("FirestoreClient","Using user provided OfflineComponentProvider");try{await kf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!U2(n))throw n;Ni("Error using user provided cache. Falling back to memory cache: "+n),await kf(t,new py)}}else ve("FirestoreClient","Using default OfflineComponentProvider"),await kf(t,new py);return t._offlineComponents}async function Yp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ve("FirestoreClient","Using user provided OnlineComponentProvider"),await my(t,t._uninitializedComponentsProvider._online)):(ve("FirestoreClient","Using default OnlineComponentProvider"),await my(t,new aE))),t._onlineComponents}function j2(t){return lE(t).then(e=>e.persistence)}function uE(t){return lE(t).then(e=>e.localStore)}function z2(t){return Yp(t).then(e=>e.remoteStore)}function cE(t){return Yp(t).then(e=>e.syncEngine)}function Ej(t){return Yp(t).then(e=>e.datastore)}async function yu(t){const e=await Yp(t),n=e.eventManager;return n.onListen=JU.bind(null,e.syncEngine),n.onUnlisten=ZU.bind(null,e.syncEngine),n}function Ij(t){return t.asyncQueue.enqueue(async()=>{const e=await j2(t),n=await z2(t);return e.setNetworkEnabled(!0),function(i){const s=Ne(i);return s.C_.delete(0),fd(s)}(n)})}function Tj(t){return t.asyncQueue.enqueue(async()=>{const e=await j2(t),n=await z2(t);return e.setNetworkEnabled(!1),async function(i){const s=Ne(i);s.C_.add(0),await Mu(s),s.M_.set("Offline")}(n)})}function Sj(t,e){const n=new Dn;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const u=await function(g,m){const w=Ne(g);return w.persistence.runTransaction("read document","readonly",T=>w.localDocuments.getDocument(T,m))}(i,s);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new _e(ce.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const h=Fu(u,`Failed to get document '${s} from cache`);a.reject(h)}}(await uE(t),e,n)),n.promise}function $2(t,e,n={}){const r=new Dn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,u,h,g){const m=new Qp({next:T=>{a.enqueueAndForget(()=>Jw(s,w));const I=T.docs.has(u);!I&&T.fromCache?g.reject(new _e(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&T.fromCache&&h&&h.source==="server"?g.reject(new _e(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),w=new eE(Nu(u.path),m,{includeMetadataChanges:!0,J_:!0});return Xw(s,w)}(await yu(t),t.asyncQueue,e,n,r)),r.promise}function xj(t,e){const n=new Dn;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const u=await bg(i,s,!0),h=new M2(s,u.ls),g=h.ca(u.documents),m=h.applyChanges(g,!1);a.resolve(m.snapshot)}catch(u){const h=Fu(u,`Failed to execute query '${s} against cache`);a.reject(h)}}(await uE(t),e,n)),n.promise}function q2(t,e,n={}){const r=new Dn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,u,h,g){const m=new Qp({next:T=>{a.enqueueAndForget(()=>Jw(s,w)),T.fromCache&&h.source==="server"?g.reject(new _e(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),w=new eE(u,m,{includeMetadataChanges:!0,J_:!0});return Xw(s,w)}(await yu(t),t.asyncQueue,e,n,r)),r.promise}function Cj(t,e){const n=new Qp(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){Ne(i).q_.add(s),s.next()}(await yu(t),n)),()=>{n.Na(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){Ne(i).q_.delete(s)}(await yu(t),n))}}function Aj(t,e,n,r){const i=function(a,u){let h;return h=typeof a=="string"?HR().encode(a):a,function(m,w){return new _j(m,w)}(function(m,w){if(m instanceof Uint8Array)return eS(m,w);if(m instanceof ArrayBuffer)return eS(new Uint8Array(m),w);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),u)}(n,dd(e));t.asyncQueue.enqueueAndForget(async()=>{pj(await cE(t),i,r)})}function bj(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=Ne(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await uE(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hE(t,e,n){if(!n)throw new _e(ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function G2(t,e,n,r){if(e===!0&&r===!0)throw new _e(ce.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nS(t){if(!be.isDocumentKey(t))throw new _e(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rS(t){if(be.isDocumentKey(t))throw new _e(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Xp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Le()}function Et(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new _e(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Xp(t);throw new _e(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function W2(t,e){if(e<=0)throw new _e(ce.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new _e(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new _e(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}G2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=H2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new _e(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new _e(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new _e(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iS({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new _e(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new _e(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new b6;switch(r.type){case"firstParty":return new N6(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new _e(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=tS.get(n);r&&(ve("ComponentProvider","Removing Datastore"),tS.delete(n),r.terminate())}(this),Promise.resolve()}}function Pj(t,e,n,r={}){var i;const s=(t=Et(t,gd))._getSettings(),a=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Ni("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=kn.MOCK_USER;else{u=VL(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new _e(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new kn(g)}t._authCredentials=new P6(new iR(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yr=class K2{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new K2(this.firestore,e,this._query)}},Zt=class Q2{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Q2(this.firestore,e,this._key)}},yo=class Y2 extends yr{constructor(e,n,r){super(e,n,Nu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new be(e))}withConverter(e){return new Y2(this.firestore,e,this._path)}};function X2(t,e,...n){if(t=We(t),hE("collection","path",e),t instanceof gd){const r=vt.fromString(e,...n);return rS(r),new yo(t,null,r)}{if(!(t instanceof Zt||t instanceof yo))throw new _e(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(vt.fromString(e,...n));return rS(r),new yo(t.firestore,null,r)}}function Rj(t,e){if(t=Et(t,gd),hE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new _e(ce.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new yr(t,null,function(r){return new Us(vt.emptyPath(),r)}(e))}function Ng(t,e,...n){if(t=We(t),arguments.length===1&&(e=sR.newId()),hE("doc","path",e),t instanceof gd){const r=vt.fromString(e,...n);return nS(r),new Zt(t,null,new be(r))}{if(!(t instanceof Zt||t instanceof yo))throw new _e(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(vt.fromString(e,...n));return nS(r),new Zt(t.firestore,t instanceof yo?t.converter:null,new be(r))}}function J2(t,e){return t=We(t),e=We(e),(t instanceof Zt||t instanceof yo)&&(e instanceof Zt||e instanceof yo)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Z2(t,e){return t=We(t),e=We(e),t instanceof yr&&e instanceof yr&&t.firestore===e.firestore&&ad(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Gw(this,"async_queue_retry"),this.iu=()=>{const n=Rf();n&&ve("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=Rf();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=Rf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new Dn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Ho(e))throw e;ve("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw mn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=Yw.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Le()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function _y(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Nj{constructor(){this._progressObserver={},this._taskCompletionResolver=new Dn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dj=-1;let un=class extends gd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new kj}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ek(this),this._firestoreClient.terminate()}};function Fn(t){return t._firestoreClient||ek(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function ek(t){var e,n,r;const i=t._freezeSettings(),s=function(u,h,g,m){return new a9(u,h,g,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,H2(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new wj(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Oj(t,e){nk(t=Et(t,un));const n=Fn(t);if(n._uninitializedComponentsProvider)throw new _e(ce.FAILED_PRECONDITION,"SDK cache is already specified.");Ni("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new aE;return tk(n,i,new B2(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function Mj(t){nk(t=Et(t,un));const e=Fn(t);if(e._uninitializedComponentsProvider)throw new _e(ce.FAILED_PRECONDITION,"SDK cache is already specified.");Ni("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new aE;return tk(e,r,new mj(r,n.cacheSizeBytes))}function tk(t,e,n){const r=new Dn;return t.asyncQueue.enqueue(async()=>{try{await kf(t,n),await my(t,e),r.resolve()}catch(i){const s=i;if(!U2(s))throw s;Ni("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function Lj(t){if(t._initialized&&!t._terminated)throw new _e(ce.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Dn;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!xi.D())return Promise.resolve();const i=r+"main";await xi.delete(i)}($w(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function Vj(t){return function(n){const r=new Dn;return n.asyncQueue.enqueueAndForget(async()=>ij(await cE(n),r)),r.promise}(Fn(t=Et(t,un)))}function Fj(t){return Ij(Fn(t=Et(t,un)))}function Bj(t){return Tj(Fn(t=Et(t,un)))}function Uj(t,e){const n=Fn(t=Et(t,un)),r=new Nj;return Aj(n,t._databaseId,e,r),r}function jj(t,e){return bj(Fn(t=Et(t,un)),e).then(n=>n?new yr(t,null,n.query):null)}function nk(t){if(t._initialized||t._terminated)throw new _e(ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new os(Sn.fromBase64String(e))}catch(n){throw new _e(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new os(Sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new _e(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new _e(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new _e(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=/^__.*__$/;class $j{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new js(e,this.data,this.fieldMask,n,this.fieldTransforms):new Du(e,this.data,n,this.fieldTransforms)}}class rk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new js(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ik(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Zp{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Zp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return Dg(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(ik(this.Iu)&&zj.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class qj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||dd(e)}pu(e,n,r,i=!1){return new Zp({Iu:e,methodName:n,gu:r,path:Kt.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tl(t){const e=t._freezeSettings(),n=dd(t._databaseId);return new qj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function em(t,e,n,r,i,s={}){const a=t.pu(s.merge||s.mergeFields?2:0,e,n,i);pE("Data must be an object, but it was:",a,r);const u=ak(r,a);let h,g;if(s.merge)h=new kr(a.fieldMask),g=a.fieldTransforms;else if(s.mergeFields){const m=[];for(const w of s.mergeFields){const T=vy(e,w,n);if(!a.contains(T))throw new _e(ce.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);uk(m,T)||m.push(T)}h=new kr(m),g=a.fieldTransforms.filter(w=>h.covers(w.field))}else h=null,g=a.fieldTransforms;return new $j(new $n(u),h,g)}class pd extends el{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pd}}function sk(t,e,n){return new Zp({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class dE extends el{_toFieldTransform(e){return new ud(e.path,new du)}isEqual(e){return e instanceof dE}}class Hj extends el{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=sk(this,e,!0),r=this.yu.map(s=>nl(s,n)),i=new ja(r);return new ud(e.path,i)}isEqual(e){return this===e}}class Gj extends el{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=sk(this,e,!0),r=this.yu.map(s=>nl(s,n)),i=new za(r);return new ud(e.path,i)}isEqual(e){return this===e}}class Wj extends el{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new fu(e.serializer,LR(e.serializer,this.wu));return new ud(e.path,n)}isEqual(e){return this===e}}function fE(t,e,n,r){const i=t.pu(1,e,n);pE("Data must be an object, but it was:",i,r);const s=[],a=$n.empty();Za(r,(h,g)=>{const m=mE(e,h,n);g=We(g);const w=i.Ru(m);if(g instanceof pd)s.push(m);else{const T=nl(g,w);T!=null&&(s.push(m),a.set(m,T))}});const u=new kr(s);return new rk(a,u,i.fieldTransforms)}function gE(t,e,n,r,i,s){const a=t.pu(1,e,n),u=[vy(e,r,n)],h=[i];if(s.length%2!=0)throw new _e(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<s.length;T+=2)u.push(vy(e,s[T])),h.push(s[T+1]);const g=[],m=$n.empty();for(let T=u.length-1;T>=0;--T)if(!uk(g,u[T])){const I=u[T];let j=h[T];j=We(j);const z=a.Ru(I);if(j instanceof pd)g.push(I);else{const X=nl(j,z);X!=null&&(g.push(I),m.set(I,X))}}const w=new kr(g);return new rk(m,w,a.fieldTransforms)}function ok(t,e,n,r=!1){return nl(n,t.pu(r?4:3,e))}function nl(t,e){if(lk(t=We(t)))return pE("Unsupported field value:",e,t),ak(t,e);if(t instanceof el)return function(r,i){if(!ik(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const u of r){let h=nl(u,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=We(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return LR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Yt.fromDate(r);return{timestampValue:gu(i.serializer,s)}}if(r instanceof Yt){const s=new Yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:gu(i.serializer,s)}}if(r instanceof Jp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof os)return{bytesValue:KR(i.serializer,r._byteString)};if(r instanceof Zt){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vw(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${Xp(r)}`)}(t,e)}function ak(t,e){const n={};return mR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Za(t,(r,i)=>{const s=nl(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function lk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Yt||t instanceof Jp||t instanceof os||t instanceof Zt||t instanceof el)}function pE(t,e,n){if(!lk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Xp(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function vy(t,e,n){if((e=We(e))instanceof Do)return e._internalPath;if(typeof e=="string")return mE(t,e);throw Dg("Field path arguments must be of type string or ",t,!1,void 0,n)}const Kj=new RegExp("[~\\*/\\[\\]]");function mE(t,e,n){if(e.search(Kj)>=0)throw Dg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Do(...e.split("."))._internalPath}catch{throw Dg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dg(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new _e(ce.INVALID_ARGUMENT,u+t+h)}function uk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Qj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(tm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Qj extends Dh{data(){return super.data()}}function tm(t,e){return typeof e=="string"?mE(t,e):e instanceof Do?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new _e(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _E{}class md extends _E{}function Qs(t,e,...n){let r=[];e instanceof _E&&r.push(e),r=r.concat(n),function(s){const a=s.filter(h=>h instanceof vE).length,u=s.filter(h=>h instanceof nm).length;if(a>1||a>0&&u>0)throw new _e(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class nm extends md{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new nm(e,n,r)}_apply(e){const n=this._parse(e);return dk(e._query,n),new yr(e.firestore,e.converter,sy(e._query,n))}_parse(e){const n=tl(e.firestore);return function(s,a,u,h,g,m,w){let T;if(g.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new _e(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){oS(w,m);const I=[];for(const j of w)I.push(sS(h,s,j));T={arrayValue:{values:I}}}else T=sS(h,s,w)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||oS(w,m),T=ok(u,a,w,m==="in"||m==="not-in");return dt.create(g,m,T)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Yj(t,e,n){const r=e,i=tm("where",t);return nm._create(i,r,n)}class vE extends _E{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new vE(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:At.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const u=s.getFlattenedFilters();for(const h of u)dk(a,h),a=sy(a,h)}(e._query,n),new yr(e.firestore,e.converter,sy(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yE extends md{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new yE(e,n)}_apply(e){const n=function(i,s,a){if(i.startAt!==null)throw new _e(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new _e(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bh(s,a)}(e._query,this._field,this._direction);return new yr(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new Us(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Xj(t,e="asc"){const n=e,r=tm("orderBy",t);return yE._create(r,n)}class rm extends md{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new rm(e,n,r)}_apply(e){return new yr(e.firestore,e.converter,Sg(e._query,this._limit,this._limitType))}}function Jj(t){return W2("limit",t),rm._create("limit",t,"F")}function Zj(t){return W2("limitToLast",t),rm._create("limitToLast",t,"L")}class im extends md{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new im(e,n,r)}_apply(e){const n=hk(e,this.type,this._docOrFields,this._inclusive);return new yr(e.firestore,e.converter,function(i,s){return new Us(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function ez(...t){return im._create("startAt",t,!0)}function tz(...t){return im._create("startAfter",t,!1)}class sm extends md{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new sm(e,n,r)}_apply(e){const n=hk(e,this.type,this._docOrFields,this._inclusive);return new yr(e.firestore,e.converter,function(i,s){return new Us(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function nz(...t){return sm._create("endBefore",t,!1)}function rz(...t){return sm._create("endAt",t,!0)}function hk(t,e,n,r){if(n[0]=We(n[0]),n[0]instanceof Dh)return function(s,a,u,h,g){if(!h)throw new _e(ce.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const m=[];for(const w of Ql(s))if(w.field.isKeyField())m.push(Ba(a,h.key));else{const T=h.data.field(w.field);if(zp(T))throw new _e(ce.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const I=w.field.canonicalString();throw new _e(ce.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${I}' (used as the orderBy) does not exist.`)}m.push(T)}return new ko(m,g)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=tl(t.firestore);return function(a,u,h,g,m,w){const T=a.explicitOrderBy;if(m.length>T.length)throw new _e(ce.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const I=[];for(let j=0;j<m.length;j++){const z=m[j];if(T[j].field.isKeyField()){if(typeof z!="string")throw new _e(ce.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof z}`);if(!Rw(a)&&z.indexOf("/")!==-1)throw new _e(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${z}' contains a slash.`);const X=a.path.child(vt.fromString(z));if(!be.isDocumentKey(X))throw new _e(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${X}' is not because it contains an odd number of segments.`);const V=new be(X);I.push(Ba(u,V))}else{const X=ok(h,g,z);I.push(X)}}return new ko(I,w)}(t._query,t.firestore._databaseId,i,e,n,r)}}function sS(t,e,n){if(typeof(n=We(n))=="string"){if(n==="")throw new _e(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rw(e)&&n.indexOf("/")!==-1)throw new _e(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(vt.fromString(n));if(!be.isDocumentKey(r))throw new _e(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ba(t,new be(r))}if(n instanceof Zt)return Ba(t,n._key);throw new _e(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xp(n)}.`)}function oS(t,e){if(!Array.isArray(t)||t.length===0)throw new _e(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dk(t,e){const n=function(i,s){for(const a of i)for(const u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new _e(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _e(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class wE{convertValue(e,n="none"){switch(Fa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Za(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Jp(sn(e.latitude),sn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=bw(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(xh(e));default:return null}}convertTimestamp(e){const n=Ao(e);return new Yt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=vt.fromString(e);Ue(i2(r));const i=new Po(r.get(1),r.get(3)),s=new be(r.popFirst(5));return i.isEqual(n)||mn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function om(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class iz extends wE{constructor(e){super(),this.firestore=e}convertBytes(e){return new os(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Os=class extends Dh{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Uc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(tm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Uc=class extends Os{data(e={}){return super.data(e)}},Oo=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ya(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Uc(this._firestore,this._userDataWriter,r.key,r,new ya(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new _e(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{const h=new Uc(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ya(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const h=new Uc(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ya(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let g=-1,m=-1;return u.type!==0&&(g=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),m=a.indexOf(u.doc.key)),{type:sz(u.type),doc:h,oldIndex:g,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function sz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}function fk(t,e){return t instanceof Os&&e instanceof Os?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Oo&&e instanceof Oo&&t._firestore===e._firestore&&Z2(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oz(t){t=Et(t,Zt);const e=Et(t.firestore,un);return $2(Fn(e),t._key).then(n=>EE(e,t,n))}class rl extends wE{constructor(e){super(),this.firestore=e}convertBytes(e){return new os(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,n)}}function az(t){t=Et(t,Zt);const e=Et(t.firestore,un),n=Fn(e),r=new rl(e);return Sj(n,t._key).then(i=>new Os(e,r,t._key,i,new ya(i!==null&&i.hasLocalMutations,!0),t.converter))}function lz(t){t=Et(t,Zt);const e=Et(t.firestore,un);return $2(Fn(e),t._key,{source:"server"}).then(n=>EE(e,t,n))}function uz(t){t=Et(t,yr);const e=Et(t.firestore,un),n=Fn(e),r=new rl(e);return ck(t._query),q2(n,t._query).then(i=>new Oo(e,r,t,i))}function cz(t){t=Et(t,yr);const e=Et(t.firestore,un),n=Fn(e),r=new rl(e);return xj(n,t._query).then(i=>new Oo(e,r,t,i))}function hz(t){t=Et(t,yr);const e=Et(t.firestore,un),n=Fn(e),r=new rl(e);return q2(n,t._query,{source:"server"}).then(i=>new Oo(e,r,t,i))}function aS(t,e,n){t=Et(t,Zt);const r=Et(t.firestore,un),i=om(t.converter,e,n);return _d(r,[em(tl(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Qt.none())])}function lS(t,e,n,...r){t=Et(t,Zt);const i=Et(t.firestore,un),s=tl(i);let a;return a=typeof(e=We(e))=="string"||e instanceof Do?gE(s,"updateDoc",t._key,e,n,r):fE(s,"updateDoc",t._key,e),_d(i,[a.toMutation(t._key,Qt.exists(!0))])}function dz(t){return _d(Et(t.firestore,un),[new Ou(t._key,Qt.none())])}function fz(t,e){const n=Et(t.firestore,un),r=Ng(t),i=om(t.converter,e);return _d(n,[em(tl(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Qt.exists(!1))]).then(()=>r)}function gk(t,...e){var n,r,i;t=We(t);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||_y(e[a])||(s=e[a],a++);const u={includeMetadataChanges:s.includeMetadataChanges};if(_y(e[a])){const w=e[a];e[a]=(n=w.next)===null||n===void 0?void 0:n.bind(w),e[a+1]=(r=w.error)===null||r===void 0?void 0:r.bind(w),e[a+2]=(i=w.complete)===null||i===void 0?void 0:i.bind(w)}let h,g,m;if(t instanceof Zt)g=Et(t.firestore,un),m=Nu(t._key.path),h={next:w=>{e[a]&&e[a](EE(g,t,w))},error:e[a+1],complete:e[a+2]};else{const w=Et(t,yr);g=Et(w.firestore,un),m=w._query;const T=new rl(g);h={next:I=>{e[a]&&e[a](new Oo(g,T,w,I))},error:e[a+1],complete:e[a+2]},ck(t._query)}return function(T,I,j,z){const X=new Qp(z),V=new eE(I,X,j);return T.asyncQueue.enqueueAndForget(async()=>Xw(await yu(T),V)),()=>{X.Na(),T.asyncQueue.enqueueAndForget(async()=>Jw(await yu(T),V))}}(Fn(g),m,u,h)}function gz(t,e){return Cj(Fn(t=Et(t,un)),_y(e)?e:{next:e})}function _d(t,e){return function(r,i){const s=new Dn;return r.asyncQueue.enqueueAndForget(async()=>ej(await cE(r),i,s)),s.promise}(Fn(t),e)}function EE(t,e,n){const r=n.docs.get(e._key),i=new rl(t);return new Os(t,i,e._key,r,new ya(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mz=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=tl(e)}set(e,n,r){this._verifyNotCommitted();const i=to(e,this._firestore),s=om(i.converter,n,r),a=em(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Qt.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=to(e,this._firestore);let a;return a=typeof(n=We(n))=="string"||n instanceof Do?gE(this._dataReader,"WriteBatch.update",s._key,n,r,i):fE(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(a.toMutation(s._key,Qt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=to(e,this._firestore);return this._mutations=this._mutations.concat(new Ou(n._key,Qt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _e(ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function to(t,e){if((t=We(t)).firestore!==e)throw new _e(ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _z=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=tl(n)}get(n){const r=to(n,this._firestore),i=new iz(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Le();const a=s[0];if(a.isFoundDocument())return new Dh(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Dh(this._firestore,i,r._key,null,r.converter);throw Le()})}set(n,r,i){const s=to(n,this._firestore),a=om(s.converter,r,i),u=em(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,u),this}update(n,r,i,...s){const a=to(n,this._firestore);let u;return u=typeof(r=We(r))=="string"||r instanceof Do?gE(this._dataReader,"Transaction.update",a._key,r,i,s):fE(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,u),this}delete(n){const r=to(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=to(e,this._firestore),r=new rl(this._firestore);return super.get(e).then(i=>new Os(this._firestore,r,n._key,i._document,new ya(!1,!1),n.converter))}};function vz(t,e,n){t=Et(t,un);const r=Object.assign(Object.assign({},pz),n);return function(s){if(s.maxAttempts<1)throw new _e(ce.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,u){const h=new Dn;return s.asyncQueue.enqueueAndForget(async()=>{const g=await Ej(s);new yj(s.asyncQueue,g,u,a,h).run()}),h.promise}(Fn(t),i=>e(new _z(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yz(){return new pd("deleteField")}function wz(){return new dE("serverTimestamp")}function Ez(...t){return new Hj("arrayUnion",t)}function Iz(...t){return new Gj("arrayRemove",t)}function Tz(t){return new Wj("increment",t)}(function(e,n=!0){(function(i){ku=i})(Uo),xo(new rs("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),u=new un(new R6(r.getProvider("auth-internal")),new O6(r.getProvider("app-check-internal")),function(g,m){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new _e(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Po(g.options.projectId,m)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),es(nT,"4.4.0",e),es(nT,"4.4.0","esm2017")})();const Sz="@firebase/firestore-compat",xz="0.3.23";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new _e("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(){if(typeof Uint8Array>"u")throw new _e("unimplemented","Uint8Arrays are not available in this environment.")}function cS(){if(!s9())throw new _e("unimplemented","Blobs are unavailable in Firestore in this environment.")}let pk=class yy{constructor(e){this._delegate=e}static fromBase64String(e){return cS(),new yy(os.fromBase64String(e))}static fromUint8Array(e){return uS(),new yy(os.fromUint8Array(e))}toBase64(){return cS(),this._delegate.toBase64()}toUint8Array(){return uS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(t){return Cz(t,["next","error","complete"])}function Cz(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{enableIndexedDbPersistence(e,n){return Oj(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return Mj(e._delegate)}clearIndexedDbPersistence(e){return Lj(e._delegate)}}class mk{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Po||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ni("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){Pj(this._delegate,e,n,r)}enableNetwork(){return Fj(this._delegate)}disableNetwork(){return Bj(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,G2("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Vj(this._delegate)}onSnapshotsInSync(e){return gz(this._delegate,e)}get app(){if(!this._appCompat)throw new _e("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new wu(this,X2(this._delegate,e))}catch(n){throw hr(n,"collection()","Firestore.collection()")}}doc(e){try{return new ai(this,Ng(this._delegate,e))}catch(n){throw hr(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new cr(this,Rj(this._delegate,e))}catch(n){throw hr(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return vz(this._delegate,n=>e(new _k(this,n)))}batch(){return Fn(this._delegate),new vk(new mz(this._delegate,e=>_d(this._delegate,e)))}loadBundle(e){return Uj(this._delegate,e)}namedQuery(e){return jj(this._delegate,e).then(n=>n?new cr(this,n):null)}}class am extends wE{constructor(e){super(),this.firestore=e}convertBytes(e){return new pk(new os(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return ai.forKey(n,this.firestore,null)}}function bz(t){C6(t)}class _k{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new am(e)}get(e){const n=wa(e);return this._delegate.get(n).then(r=>new Oh(this._firestore,new Os(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=wa(e);return r?(IE("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=wa(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=wa(e);return this._delegate.delete(n),this}}class vk{constructor(e){this._delegate=e}set(e,n,r){const i=wa(e);return r?(IE("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=wa(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=wa(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Ga{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new Uc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Mh(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Ga.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Ga(e,new am(e),n),i.set(n,s)),s}}Ga.INSTANCES=new WeakMap;class ai{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new am(e)}static forPath(e,n,r){if(e.length%2!==0)throw new _e("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ai(n,new Zt(n._delegate,r,new be(e)))}static forKey(e,n,r){return new ai(n,new Zt(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new wu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new wu(this.firestore,X2(this._delegate,e))}catch(n){throw hr(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=We(e),e instanceof Zt?J2(this._delegate,e):!1}set(e,n){n=IE("DocumentReference.set",n);try{return n?aS(this._delegate,e,n):aS(this._delegate,e)}catch(r){throw hr(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?lS(this._delegate,e):lS(this._delegate,e,n,...r)}catch(i){throw hr(i,"updateDoc()","DocumentReference.update()")}}delete(){return dz(this._delegate)}onSnapshot(...e){const n=yk(e),r=wk(e,i=>new Oh(this.firestore,new Os(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return gk(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=az(this._delegate):(e==null?void 0:e.source)==="server"?n=lz(this._delegate):n=oz(this._delegate),n.then(r=>new Oh(this.firestore,new Os(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ai(this.firestore,e?this._delegate.withConverter(Ga.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function hr(t,e,n){return t.message=t.message.replace(e,n),t}function yk(t){for(const e of t)if(typeof e=="object"&&!wy(e))return e;return{}}function wk(t,e){var n,r;let i;return wy(t[0])?i=t[0]:wy(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Oh{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new ai(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return fk(this._delegate,e._delegate)}}class Mh extends Oh{data(e){const n=this._delegate.data(e);return this._delegate._converter||A6(n!==void 0),n}}class cr{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new am(e)}where(e,n,r){try{return new cr(this.firestore,Qs(this._delegate,Yj(e,n,r)))}catch(i){throw hr(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new cr(this.firestore,Qs(this._delegate,Xj(e,n)))}catch(r){throw hr(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new cr(this.firestore,Qs(this._delegate,Jj(e)))}catch(n){throw hr(n,"limit()","Query.limit()")}}limitToLast(e){try{return new cr(this.firestore,Qs(this._delegate,Zj(e)))}catch(n){throw hr(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new cr(this.firestore,Qs(this._delegate,ez(...e)))}catch(n){throw hr(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new cr(this.firestore,Qs(this._delegate,tz(...e)))}catch(n){throw hr(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new cr(this.firestore,Qs(this._delegate,nz(...e)))}catch(n){throw hr(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new cr(this.firestore,Qs(this._delegate,rz(...e)))}catch(n){throw hr(n,"endAt()","Query.endAt()")}}isEqual(e){return Z2(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=cz(this._delegate):(e==null?void 0:e.source)==="server"?n=hz(this._delegate):n=uz(this._delegate),n.then(r=>new Ey(this.firestore,new Oo(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=yk(e),r=wk(e,i=>new Ey(this.firestore,new Oo(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return gk(this._delegate,n,r)}withConverter(e){return new cr(this.firestore,e?this._delegate.withConverter(Ga.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Pz{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Mh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ey{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new cr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Mh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Pz(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Mh(this._firestore,r))})}isEqual(e){return fk(this._delegate,e._delegate)}}class wu extends cr{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ai(this.firestore,e):null}doc(e){try{return e===void 0?new ai(this.firestore,Ng(this._delegate)):new ai(this.firestore,Ng(this._delegate,e))}catch(n){throw hr(n,"doc()","CollectionReference.doc()")}}add(e){return fz(this._delegate,e).then(n=>new ai(this.firestore,n))}isEqual(e){return J2(this._delegate,e._delegate)}withConverter(e){return new wu(this.firestore,e?this._delegate.withConverter(Ga.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function wa(t){return Et(t,Zt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(...e){this._delegate=new Do(...e)}static documentId(){return new TE(Kt.keyField().canonicalString())}isEqual(e){return e=We(e),e instanceof Do?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this._delegate=e}static serverTimestamp(){const e=wz();return e._methodName="FieldValue.serverTimestamp",new ha(e)}static delete(){const e=yz();return e._methodName="FieldValue.delete",new ha(e)}static arrayUnion(...e){const n=Ez(...e);return n._methodName="FieldValue.arrayUnion",new ha(n)}static arrayRemove(...e){const n=Iz(...e);return n._methodName="FieldValue.arrayRemove",new ha(n)}static increment(e){const n=Tz(e);return n._methodName="FieldValue.increment",new ha(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz={Firestore:mk,GeoPoint:Jp,Timestamp:Yt,Blob:pk,Transaction:_k,WriteBatch:vk,DocumentReference:ai,DocumentSnapshot:Oh,Query:cr,QueryDocumentSnapshot:Mh,QuerySnapshot:Ey,CollectionReference:wu,FieldPath:TE,FieldValue:ha,setLogLevel:bz,CACHE_SIZE_UNLIMITED:Dj};function kz(t,e){t.INTERNAL.registerComponent(new rs("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Rz)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(t){kz(t,(e,n)=>new mk(e,n,new Az)),t.registerVersion(Sz,xz)}Nz(jt);jt.initializeApp({apiKey:"AIzaSyAHOemftrTSOUjtoA6K3VR2hkOU5H-ScSI",authDomain:"amstangram.firebaseapp.com",databaseURL:"https://amstangram.firebaseio.com",projectId:"amstangram",storageBucket:"amstangram.appspot.com",messagingSenderId:"1075176148116",appId:"1:1075176148116:web:e61e6512cd983a75533881",measurementId:"G-PLH3BSWLM2"});const Dz=t=>{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},Oz=t=>{let e=t.length,n,r;for(;e!==0;)r=Math.floor(Math.random()*e),e-=1,n=t[e],t[e]=t[r],t[r]=n;return t},Mz=as(fe,{css:{fontSize:3,p:2,borderRadius:1,bg:"notificationBackground",color:"dialogText",animation:`${ni/2}ms fadeIn both`,boxShadow:"0px 0px 10px #00000080"}}),gi=G.createContext(null),Lz=({children:t})=>{const e=G.useRef(),[n,r]=G.useState(null),i=G.useCallback(s=>{r(a=>(a&&clearTimeout(a.timeoutId),{content:s,timeoutId:setTimeout(()=>{r(null)},2e3)}))},[]);return R.jsxs(gi.Provider,{value:i,children:[t,n&&T0.createPortal(R.jsx(fe,{css:{position:"fixed",top:0,left:0,bottom:0,right:0,pointerEvents:"none",alignItems:"center",justifyContent:"center"},children:R.jsx(Mz,{ref:e,children:n.content})}),document.getElementById("notificationContainer"))]})},Qn=G.createContext(null),Vz=({children:t})=>{const[e,n]=G.useState(void 0),[r,i]=G.useState(null),[s,a]=G.useState(!1);G.useEffect(()=>{e!==void 0&&r!==null&&a(!0)},[e,r]),G.useEffect(()=>jt.auth().onAuthStateChanged(async T=>{if(!T)n(null);else{const j=(await jt.firestore().collection("users").doc(T.uid).get()).data();n({uid:T.uid,...j,firebaseUser:T})}}),[]),G.useEffect(()=>jt.firestore().collection("users").onSnapshot(T=>{const I={};for(const j of T.docs){const z=j.data();I[j.id]=z}i(I)}),[]);const u=G.useCallback(async(w,T)=>{await w.firebaseUser.updateProfile({displayName:T}),await jt.firestore().collection("users").doc(w.uid).update({username:T}),n({...w,username:T})},[]),h=G.useCallback(async(w,T,I)=>{const j=jt.auth.EmailAuthProvider.credential(w.firebaseUser.email,T);await w.firebaseUser.reauthenticateWithCredential(j),await w.firebaseUser.updatePassword(I)},[]),g=G.useCallback(async(w,T,I)=>{const j=jt.auth.EmailAuthProvider.credential(w.firebaseUser.email,I);await w.firebaseUser.reauthenticateWithCredential(j),await w.firebaseUser.updateEmail(T)},[]),m=G.useMemo(()=>({initialized:s,currentUser:e,usersMetadata:r,updateUsername:u,updatePassword:h,updateEmail:g}),[s,e,r,u,h,g]);return R.jsx(Qn.Provider,{value:m,children:t})},Ms={current:!0},Nt=50*Math.SQRT2/6/Math.SQRT2,hS=function(t){return t*Math.PI/180},Fz=function(t){return t*180/Math.PI},Lh=function(t){if(t<0)for(;t<0;)t+=360;else if(t>=360)for(;t>=360;)t-=360;return t},Ii=function(t,e){return Math.abs(t-e)<1e-12},Bz=function(t,e,n){return Math.abs(t-e)<n},Iy=function(t,e){return!Ii(t,e)},lm=function(t,e,n){t=t.sort(e);for(var r=[t[0]],i=1;i<t.length;i++)r.push(t[i]),e(t[i],t[i-1])===0&&(r.pop(),n||r.pop());return r};class Pe{constructor(e,n){this.coeffInt=e,this.coeffSqrt=n}dup(){return new Pe(this.coeffInt,this.coeffSqrt)}toFloat(){return this.coeffInt+this.coeffSqrt*Math.SQRT2}eq(e){return Ms.current?this.coeffInt===e.coeffInt&&this.coeffSqrt===e.coeffSqrt:Ii(this.coeffInt,e.coeffInt)&&Ii(this.coeffSqrt,e.coeffSqrt)}sameSign(e){var n=new Pe(0,0);return n.compare(this)===n.compare(e)}compare(e){if(this.eq(e))return 0;var n=this.toFloat(),r=e.toFloat();return n<r?-1:1}distance(e){var n=this.dup();return n.subtract(e),n.abs()}closeNumbers(e,n){return Bz(this.toFloat(),e.toFloat(),n)}isZero(){return Ms.current?this.coeffInt===0&&this.coeffSqrt===0:Ii(this.coeffInt,0)&&Ii(this.coeffSqrt,0)}add(e){return this.coeffInt+=e.coeffInt,this.coeffSqrt+=e.coeffSqrt,this}subtract(e){return this.coeffInt-=e.coeffInt,this.coeffSqrt-=e.coeffSqrt,this}multiply(e){var n=this.coeffInt;return this.coeffInt=n*e.coeffInt+2*this.coeffSqrt*e.coeffSqrt,this.coeffSqrt=n*e.coeffSqrt+this.coeffSqrt*e.coeffInt,this}div(e){var n=e.coeffInt*e.coeffInt-2*e.coeffSqrt*e.coeffSqrt;if(!Ii(n,0)){var r=this.coeffInt;return this.coeffInt=r*e.coeffInt-2*this.coeffSqrt*e.coeffSqrt,this.coeffSqrt=this.coeffSqrt*e.coeffInt-r*e.coeffSqrt,this}}neg(){return this.coeffInt=-this.coeffInt,this.coeffSqrt=-this.coeffSqrt,this}abs(){return this.toFloat()<0&&(this.coeffInt=-this.coeffInt,this.coeffSqrt=-this.coeffSqrt),this}scale(e){if(Ii(e,0)){console.log("Scaling by 0 is not possible!"),console.log(JSON.stringify(this));return}return this.coeffInt*=e,this.coeffSqrt*=e,this}}function Qe(t,e){typeof t>"u"?this.x=new Pe(0,0):this.x=t,typeof e>"u"?this.y=new Pe(0,0):this.y=e}Qe.prototype.dup=function(){return new Qe(this.x.dup(),this.y.dup())};Qe.prototype.toFloatX=function(){return this.x.toFloat()};Qe.prototype.toFloatY=function(){return this.y.toFloat()};Qe.prototype.compare=function(t){var e=this.x.compare(t.x),n=this.y.compare(t.y);return e!=0?e:n};Qe.prototype.compareYX=function(t){var e=this.x.compare(t.x),n=this.y.compare(t.y);return n!=0?n:e};Qe.prototype.multipleOf=function(t){var e=this.x.sameSign(t.x),n=this.y.sameSign(t.y);if(!(e&&n))return!1;if(this.x.isZero()&&t.x.isZero())return this.y.isZero()&&t.y.isZero()?!0:n;if(this.y.isZero()&&t.y.isZero())return e;var r=this.x.dup().div(t.x),i=this.y.dup().div(t.y);return typeof r>"u"||typeof i>"u"?(console.log("Undefined"),console.log(this.x.coeffInt+","+this.x.coeffSqrt+" - "+this.y.coeffInt+","+this.y.coeffSqrt),console.log(t.x.coeffInt+","+t.x.coeffSqrt+" - "+t.y.coeffInt+","+t.y.coeffSqrt),!1):r.eq(i)};const um=function(t,e){return t.compare(e)},Uz=function(t,e){return t.compareYX(e)};Qe.prototype.eq=function(t){return this.x.eq(t.x)&&this.y.eq(t.y)};Qe.prototype.isZero=function(){return this.x.isZero()&&this.y.isZero()};Qe.prototype.length=function(){return Math.sqrt(this.dotProduct(this).toFloat())};Qe.prototype.neg=function(){return this.x.neg(),this.y.neg(),this};Qe.prototype.angle=function(){if(this.isZero())return 0;var t=Math.atan2(this.toFloatY(),this.toFloatX());return t=Lh(Fz(t)),Math.round(t)};Qe.prototype.distance=function(t){var e=t.dup().subtract(this);return e.length()};Qe.prototype.angleTo=function(t){if(this.isZero())return t.angle();if(t.isZero())return this.angle();var e=360-(t.angle()-this.angle());return e=Lh(e),e};Qe.prototype.add=function(t){return this.x.add(t.x),this.y.add(t.y),this};Qe.prototype.middle=function(t){var e=new Qe;return e.add(this),e.add(t),e.scale(.5),e};Qe.prototype.subtract=function(t){return this.x.subtract(t.x),this.y.subtract(t.y),this};Qe.prototype.normalize=function(){var t=this.length();return Iy(t,0)&&(this.x.scale(1/t),this.y.scale(1/t)),this};Qe.prototype.dotProduct=function(t){return this.x.dup().multiply(t.x).add(this.y.dup().multiply(t.y))};Qe.prototype.determinant=function(t){return this.x.dup().multiply(t.y).subtract(this.y.dup().multiply(t.x))};Qe.prototype.transform=function(t){if(t.length!=3){console.log("Matrix seems to have the wrong dimension!");return}var e=new Pe(1,0),n=this.dup();this.x=n.x.dup().multiply(t[0][0]),this.x.add(n.y.dup().multiply(t[0][1])),this.x.add(e.dup().multiply(t[0][2])),this.y=n.x.dup().multiply(t[1][0]),this.y.add(n.y.dup().multiply(t[1][1])),this.y.add(e.dup().multiply(t[1][2]));var r=e.dup();return e=n.x.dup().multiply(t[2][0]),e.add(n.y.dup().multiply(t[2][1])),e.add(r.dup().multiply(t[2][2])),Iy(e,1)&&Iy(e,0)&&(this.x.div(e),this.y.div(e)),this};Qe.prototype.translate=function(t,e){var n=[[new Pe(1,0),new Pe(0,0),t],[new Pe(0,0),new Pe(1,0),e],[new Pe(0,0),new Pe(0,0),new Pe(1,0)]];return this.transform(n)};Qe.prototype.rotate=function(t){t=Lh(t);var e,n;t%45!=0?(e=new Pe(Math.cos(hS(t)),0),n=new Pe(Math.sin(hS(t)),0)):(t%90!=0?(e=new Pe(0,.5),n=new Pe(0,.5)):t%180!=0?(e=new Pe(0,0),n=new Pe(1,0)):(e=new Pe(1,0),n=new Pe(0,0)),t>180&&t<360&&n.neg(),t>90&&t<270&&e.neg());var r=[[e,n.dup().neg(),new Pe(0,0)],[n,e,new Pe(0,0)],[new Pe(0,0),new Pe(0,0),new Pe(1,0)]];return this.transform(r),this};Qe.prototype.scale=function(t){if(Ii(0,t)){console.log("Attempt to scale by 0!"),console.log(JSON.stringify(this));return}return this.x.scale(t),this.y.scale(t),this};const Ts=function(t,e,n){var r=t.dup().subtract(n).determinant(e.dup().subtract(n));return r.isZero()?0:r.toFloat()>0?1:-1},jz=function(t,e,n){for(var r=[],i=[],s=0;s<t.length;s++)t[s].eq(e)&&r.push(s),t[s].eq(n)&&i.push(s);return r.length>=2&&i.length>=2};function on(t,e){if(t==="undefined"?this.point1=new Qe:this.point1=t,e==="undefined"?this.point2=new Qe:this.point2=e,!this.point1.isZero()&&!this.point2.isZero()||this.point2.isZero()&&!this.point1.isZero()){var n=this.point1.compare(this.point2);if(n===1){var r=this.point1;this.point1=this.point2,this.point2=r}}}on.prototype.dup=function(){return new on(this.point1.dup(),this.point2.dup())};on.prototype.length=function(){return this.point1.distance(this.point2)};on.prototype.direction=function(){return this.point2.dup().subtract(this.point1)};on.prototype.lineParameters=function(){var t=[];if(this.point1.x.eq(this.point2.x))t[0]=1,t[1]=0,t[2]=this.point1.x.dup().neg().toFloat();else if(this.point1.y.eq(this.point2.y))t[0]=0,t[1]=1,t[2]=this.point1.y.dup().neg().toFloat();else{var e=this.direction();t[0]=e.toFloatX()/e.toFloatY(),t[1]=-1,t[2]=this.point2.determinant(this.point1).toFloat()/e.toFloatX()}return t};on.prototype.eq=function(t){return this.point1.eq(t.point1)&&this.point2.eq(t.point2)||this.point2.eq(t.point1)&&this.point1.eq(t.point2)};on.prototype.compare=function(t){var e=this.point1.compare(t.point1),n=this.point2.compare(t.point2);if(e==="undefined"||n==="undefined"){console.log("Comparison between the segments is not possible!");return}return e!=0?e:n};on.prototype.split=function(t){if(t.length===0)return[this];t=t.sort(um);var e=[];e[0]=new on(this.point1,t[0]);var n;for(n=1;n<t.length;n++)e[n]=new on(t[n-1],t[n]);return e[n]=new on(t[n-1],this.point2),e};on.prototype.projectedParameter=function(t){if(this.point1.eq(this.point2))return 1;var e=t.dup().subtract(this.point1),n=this.direction(),r=e.dotProduct(n).toFloat()/n.dotProduct(n).toFloat();return r};on.prototype.onSegment=function(t){if(t.eq(this.point1)||t.eq(this.point2)||this.point1.eq(this.point2))return!1;if(Ts(this.point1,this.point2,t)===0){var e=this.projectedParameter(t);return e>=0&&e<=1}return!1};on.prototype.onSegmentIncludingEndpoints=function(t){if(t.eq(this.point1)||t.eq(this.point2)||this.point1.eq(this.point2))return!0;if(Ts(this.point1,this.point2,t)===0){var e=this.projectedParameter(t);return e>=0&&e<=1}return!1};on.prototype.intersectsOrientations=function(t){var e=Ts(this.point1,this.point2,t.point1),n=Ts(this.point1,this.point2,t.point2),r=Ts(t.point1,t.point2,this.point1),i=Ts(t.point1,t.point2,this.point2);return e!=n&&r!=i};on.prototype.intersectsIncludingSegment=function(t){return this.point1.eq(t.point1)||this.point2.eq(t.point1)||this.point1.eq(t.point2)||this.point2.eq(t.point2)?!1:this.intersectsOrientations(t)};on.prototype.intersects=function(t){return this.onSegmentIncludingEndpoints(t.point1)||this.onSegmentIncludingEndpoints(t.point2)||t.onSegmentIncludingEndpoints(this.point1)||t.onSegmentIncludingEndpoints(this.point2)?!1:this.intersectsOrientations(t)};on.prototype.angleTo=function(t){var e,n;if(this.point1.eq(t.point1))e=this.direction(),n=t.direction();else if(this.point1.eq(t.point2))e=this.direction(),n=t.direction().scale(-1);else if(this.point2.eq(t.point1))e=this.direction().scale(-1),n=t.direction();else if(this.point2.eq(t.point2))e=this.direction().scale(-1),n=t.direction().scale(-1);else return;return e.angleTo(n)};const Ek=function(t,e){return t.compare(e)},et=[],Dr=[],oa=[];for(var ic=0;ic<=5;ic++)Dr[ic]=[],et[ic]=[],oa[ic]=[];et[0][0]=[new Qe(new Pe(0,12*Nt),new Pe(0,0)),new Qe(new Pe(0,0),new Pe(0,12*Nt))];et[1][0]=[new Qe(new Pe(12*Nt,0),new Pe(0,0)),new Qe(new Pe(0,0),new Pe(12*Nt,0))];et[2][0]=[new Qe(new Pe(0,6*Nt),new Pe(0,0)),new Qe(new Pe(0,0),new Pe(0,6*Nt))];et[3][0]=[new Qe(new Pe(0,6*Nt),new Pe(0,0)),new Qe(new Pe(0,6*Nt),new Pe(0,6*Nt)),new Qe(new Pe(0,0),new Pe(0,6*Nt))];et[4][0]=[new Qe(new Pe(12*Nt,0),new Pe(0,0)),new Qe(new Pe(18*Nt,0),new Pe(6*Nt,0)),new Qe(new Pe(6*Nt,0),new Pe(6*Nt,0))];et[5][0]=[new Qe(new Pe(12*Nt,0),new Pe(0,0)),new Qe(new Pe(18*Nt,0),new Pe(-6*Nt,0)),new Qe(new Pe(6*Nt,0),new Pe(-6*Nt,0))];for(var Me=0;Me<=5;Me++){for(var c_=new Qe,br=0;br<et[Me][0].length;br++)c_.add(et[Me][0][br]);c_.scale(1/(et[Me][0].length+1)),Dr[Me][0]=[],Dr[Me][0][0]=c_}for(Me=0;Me<=1;Me++){var dS=et[Me][0][0].dup().add(et[Me][0][1]).scale(.5),Ml=et[Me][0][0].dup().add(dS),Ll=et[Me][0][1].dup().add(dS);if(Ml.scale(1/et[Me][0].length),Dr[Me][0][1]=Ml,Ll.scale(1/et[Me][0].length),Dr[Me][0][2]=Ll,Me===0){var zz=et[Me][0][0].dup().scale(.5),$z=et[Me][0][1].dup().scale(.5),fS=zz.add($z);fS.scale(1/et[Me][0].length),fS.scale(1/et[Me][0].length)}}for(Me=3;Me<=5;Me++){for(Ml=new Qe,Ll=new Qe,br=0;br<et[Me][0].length;br++)br!=et[Me][0].length-1&&Ml.add(et[Me][0][br]),Ll.add(et[Me][0][br]);Ml.scale(1/et[Me][0].length),Dr[Me][0][1]=Ml,Ll.scale(1/et[Me][0].length),Dr[Me][0][2]=Ll}var gS=[[new Pe(0,.5),new Pe(0,-.5),new Pe(0,0)],[new Pe(0,.5),new Pe(0,.5),new Pe(0,0)],[new Pe(0,0),new Pe(0,0),new Pe(1,0)]];for(Me=0;Me<=5;Me++)for(var It=0;It<7;It++){et[Me][It+1]=[],Dr[Me][It+1]=[];for(var br=0;br<Dr[Me][It].length;br++)Dr[Me][It+1][br]=Dr[Me][It][br].dup().transform(gS);for(var nf=0;nf<et[Me][0].length;nf++)et[Me][It+1][nf]=et[Me][It][nf].dup().transform(gS)}for(Me=0;Me<=5;Me++)for(It=0;It<=7;It++)if(oa[Me][It]=[],oa[Me][It][0]=[et[Me][It][0].dup(),et[Me][It][Me<3?1:2].dup()],oa[Me][It][1]=[et[Me][It][0].dup().neg(),et[Me][It][0].dup().neg().add(et[Me][It][1].dup())],Me<3)oa[Me][It][2]=[et[Me][It][1].dup().neg(),et[Me][It][1].dup().neg().add(et[Me][It][0].dup())];else{var pS=et[Me][It][1].dup().neg();oa[Me][It][2]=[et[Me][It][0].dup().add(pS),et[Me][It][2].dup().add(pS)],oa[Me][It][3]=[et[Me][It][2].dup().neg(),et[Me][It][2].dup().neg().add(et[Me][It][1].dup())]}const qz=new Pe(576*Nt,0);function Ls(t,e,n){this.tanType=t,this.anchor=e,this.orientation=n,!(typeof Ms>"u")&&Ms.current&&(this.points=this.getPoints(),this.segments=this.getSegments(),this.insidePoints=this.getInsidePoints())}Ls.prototype.dup=function(){return new Ls(this.tanType,this.anchor.dup(),this.orientation)};var Hz=[96,48,24,48,48,48].map(t=>t*Nt);Ls.prototype.area=function(){return Hz[this.tanType]};Ls.prototype.getPoints=function(){if(Ms.current&&typeof this.points<"u")return this.points;var t=[];t[0]=this.anchor.dup();for(var e=et[this.tanType][this.orientation],n=0;n<e.length;n++){var r=this.anchor.dup();r.add(e[n]),t[n+1]=r}return t};Ls.prototype.getSegments=function(){if(Ms.current&&typeof this.segments<"u")return this.segments;for(var t=[],e=this.getPoints(),n=0;n<e.length-1;n++)t[n]=new on(e[n],e[n+1]);return t[n]=new on(e[n],e[0]),t};Ls.prototype.center=function(){return this.anchor.dup().add(Dr[this.tanType][this.orientation][0])};Ls.prototype.getInsidePoints=function(){if(Ms.current&&typeof this.insidePoints<"u")return this.insidePoints;for(var t=[],e=Dr[this.tanType][this.orientation].length,n=0;n<e;n++)t.push(this.anchor.dup().add(Dr[this.tanType][this.orientation][n]));return t};Ls.prototype.toSVG=function(){for(var t=this.getPoints(),e="",n=0;n<t.length;n++)e+=t[n].toFloatX()+", "+t[n].toFloatY()+" ";return e};const SE=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n].getPoints();e=e.concat(r)}return e=lm(e,um,!0),e},Og=function(t){for(var e=new Pe(0,0),n=0;n<t.length-1;n++)e.add(t[n].determinant(t[n+1]));return e.add(t[n].determinant(t[0])),e.abs(),e.scale(.5)},Ik=function(t,e){for(var n=0;n<e.length;n++){var r=Kz(t,e[n]);if(r===-1)return!1}return!0},Gz=function(t,e){for(var n=[],r,i=0;i<e.length;i++){r=e[i].getSegments();for(var s=0;s<r.length;s++){for(var a=[],u=0;u<t.length;u++)r[s].onSegment(t[u])&&a.push(t[u]);n=n.concat(r[s].split(a))}}return n=lm(n,Ek,!1),n},Tk=function(t,e){for(var n=360,r=-1,i=0;i<e.length;i++){var s=e[i].angleTo(t);s<n&&(r=i,n=s)}return[r,n]},Sk=function(t,e){for(var n=0,r=-1,i=0;i<e.length;i++){var s=e[i].angleTo(t);s>n&&(r=i,n=s)}return[r,n]},xk=function(t,e,n,r,i){if(!(t.length===0||e.length===0)){t.sort(um);var s=t[0],a=s.dup();a.subtract(new Qe(new Pe(0,0),new Pe(1,0)));var u=[];u.push(s);var h=new on(a,s),g=!0;do{var m=e.filter(function(j){return!h.eq(j)&&(j.point1.eq(s)||j.point2.eq(s))}),w;g?w=Sk(h,m):w=n(h,m);var T=w[0],I=w[1];if(T===-1)break;I===180&&!g&&i&&u.pop(),m[T].point1.eq(s)?(u.push(m[T].point2),s=m[T].point2):(u.push(m[T].point1),s=m[T].point1),h=m[T],e=e.filter(function(j){return!h.eq(j)}),g&&(g=!1)}while(!s.eq(t[0])||!Ik(u,t)&&!r);return u.pop(),[u,e]}},Wz=function(t,e,n){if(!(t.length===0||e.length===0)){for(var r=e.length*2,i=0;r!=i;){r=e.length*2;for(var s=[],a=0;a<e.length;a++)s.push(e[a].point1),s.push(e[a].point2);e=e.filter(function(u){return jz(s,u.point1,u.point2)}),i=e.length*2}return t=lm(s,um,!0),xk(t,e,Tk,!0,n)}},Ty=function(t,e){var n=[],r=0,i=SE(t),s=Gz(i,t),a=xk(i,s,Sk,!1,e);n[r]=a[0],s=a[1];var u=Og(n[0]);for(console.log("console "+JSON.stringify(u));!u.eq(qz)&&u.toFloat()>40001||!Ik(n[0],i);){if(r++,a=Wz(i,s,Tk),typeof a>"u")return;n[r]=a[0],s=a[1],u.subtract(Og(n[r]))}return n},Ck=function(t,e){typeof e>"u"?e=SE(t):e=e[0];for(var n=new Pe(100*Nt,0),r=new Pe(100*Nt,0),i=new Pe(-100*Nt,0),s=new Pe(-100*Nt,0),a=0;a<e.length;a++){var u=e[a].x,h=e[a].y;u.compare(n)<0&&(n=u),h.compare(r)<0&&(r=h),u.compare(i)>0&&(i=u),h.compare(s)>0&&(s=h)}return[n,r,i,s]},Kz=function(t,e){for(var n=0,r=0;r<t.length;r++){var i=t[r],s=r===t.length-1?t[0]:t[r+1];if(e.eq(i)||e.eq(s)||new on(i,s).onSegment(e))return 0;t[r].y.compare(e.y)<=0?s.y.compare(e.y)===1&&Ts(s,e,i)>0&&n++:s.y.compare(e.y)<=0&&Ts(s,e,i)<0&&n--}return n===0?-1:1};var Qz=0,Yz=[1,1,2,6,24,120,720,5040,40320];function vd(t,e){this.outlineVertices=0,this.outerOutlineVertices=0,this.numHoles=0,this.holeArea=0,this.holeVertices=0,this.holeType=0,this.perimeter=0,this.longestEdge=0,this.shortestEdge=0,this.rangeX=0,this.rangeY=0,this.convexPercentage=0,this.convexHullArea=0,this.symmetry=0,this.hangingPieces=0,this.matchedEdges=0,this.matchedVertices=0,this.computeEvaluation(t,e)}vd.prototype.getValue=function(t){var e;switch(Qz){case 0:e=1-this.convexPercentage;break;case 1:e=this.outlineVertices;break;case 2:e=this.outerOutlineVertices;break;case 3:e=this.perimeter;break;case 4:e=-this.matchedVertices;break;case 5:e=(this.outerOutlineVertices-3)/26+1-this.convexPercentage;default:e=0}return e};vd.prototype.computeConvexHullLess3Points=function(t){return t.length<=1||t[0].eq(t[1])&&t.pop(),t};vd.prototype.computeConvexHull=function(t,e){if(t.length<=2)return this.computeConvexHullLess3Points(t);t=t.sort(function(s,a){var u=Lh(s.dup().subtract(e).angle()),h=Lh(a.dup().subtract(e).angle()),g=Ii(u,h),m=s.distance(e),w=a.distance(e);return g&&Ii(m,w)?0:!g&&u<h||g&&m<w?-1:1});for(var n=[t[0]],r=1;r<t.length-1;r++)n.push(t[r]),Ii(t[r].dup().subtract(e).angle(),t[r+1].dup().subtract(e).angle())&&n.pop();if(n.push(t[r]),n.length<=2)return this.computeConvexHullLess3Points(n);var i=[];for(i.push(n[0]),i.push(n[1]),r=2;r<n.length;r++){for(;i.length>1&&Ts(i[i.length-1],n[r],i[i.length-2])<=0;)i.pop();i.push(n[r])}return i};var mS=function(t){return function(e,n){var r=e.y.distance(t.y),i=n.y.distance(t.y),s=r.compare(i);return s===0?e.x.compare(n.x):s}},_S=function(t){return function(e,n){var r=e.x.distance(t.x),i=n.x.distance(t.x),s=r.compare(i);return s===0?e.y.compare(n.y):s}};vd.prototype.computeEvaluation=function(t,e){this.outerOutlineVertices=e[0].length,this.numHoles=e.length-1;for(var n=0;n<e.length;n++)n!=0&&(this.holeArea+=Og(e[n]).toFloat(),this.holeVertices+=e[n].length),this.outlineVertices+=e[n].length;this.longestEdge=-1,this.shortestEdge=60*Nt;for(var r,i=0;i<e[0].length;i++)i!=e[0].length-1?r=e[0][i].distance(e[0][i+1]):r=e[0][i].distance(e[0][0]),r>this.longestEdge&&(this.longestEdge=r),r<this.shortestEdge&&(this.shortestEdge=r),this.perimeter+=r;for(var s=Ty(t,!1)[0],i=0;i<s[0].length;i++)s[i].eq(s[i+1])&&this.hangingPieces++;for(var n=1;n<s.length;n++){for(var a=!1,u=0;u<s[n].length;u++){for(var i=0;i<s[0].length;i++)a=a||s[0][i].eq(s[n][u]);if(a)break}switch(this.holeType){case 0:a?this.holeType=2:this.holeType=1;break;case 1:a&&(this.holeType=3);break;case 2:a||(this.holeType=3);break}}var h=Ck(t,e);this.rangeX=h[2].dup().subtract(h[0]).toFloat(),this.rangeY=h[3].dup().subtract(h[1]).toFloat();var g=new Qe;g.x=h[0].dup().add(h[2]).scale(.5),g.y=h[1].dup().add(h[3]).scale(.5);var m=[],w=[],T=[],I=[];for(i=0;i<e[0].length;i++){var j=e[0][i].x.compare(g.x),z=e[0][i].y.compare(g.y);j<0?T.push(e[0][i]):j>0&&I.push(e[0][i]),z<0?m.push(e[0][i]):z>0&&w.push(e[0][i])}m.sort(mS(g)),w.sort(mS(g)),T.sort(_S(g)),I.sort(_S(g));var X=!1;if(m.length==w.length){for(ne=0;ne<m.length;ne++)if(!m[ne].x.eq(w[ne].x)||!m[ne].y.distance(g.y).eq(w[ne].y.distance(g.y))){X=!0;break}}else X=!0;if(X||this.symmetry++,X=!1,T.length==I.length){for(ne=0;ne<T.length;ne++)if(!T[ne].y.eq(I[ne].y)||!T[ne].x.distance(g.x).eq(I[ne].x.distance(g.x))){X=!0;break}}else X=!0;X||this.symmetry++;var V=SE(t),B=[];for(ne=0;ne<V.length;ne++)B.push(0);for(var U=[],J,re=0;re<t.length;re++){J=t[re].getSegments();for(var te=0;te<J.length;te++){for(var ae=[],ne=0;ne<V.length;ne++)J[te].onSegment(V[ne])&&ae.push(V[ne]),(J[te].point1.eq(V[ne])||J[te].point2.eq(V[ne]))&&B[ne]++;U=U.concat(J[te].split(ae))}}for(var ne=0;ne<V.length;ne++)B[ne]/=2,B[ne]>1&&(this.matchedVertices+=Yz[B[ne]-1]);var me=U.length;U=lm(U,Ek,!1),this.matchedEdges=(me-U.length)/2;var pe=this.computeConvexHull(e[0],V.sort(Uz)[0]);this.convexHullArea=Og(pe).toFloat(),this.convexPercentage=576*Nt/this.convexHullArea};let Xz=class{constructor(e){this.tans=e.sort(function(n,r){return n.tanType-r.tanType}),this.outline=Ty(this.tans,!0),typeof this.outline<"u"&&(this.evaluation=new vd(this.tans,this.outline))}center(){var e=new Qe,n=Ck(this.tans,this.outline);return e.x=n[0].dup().add(n[2]).scale(.5),e.y=n[1].dup().add(n[3]).scale(.5),e}positionCentered(){var e=new Qe(new Pe(this.evaluation.rangeX/2,0),new Pe(this.evaluation.rangeY/2,0));e.subtract(this.center());for(var n=0;n<this.tans.length;n++)this.tans[n].anchor.translate(e.x,e.y);this.outline=Ty(this.tans,!0)}toSVGOutline(){for(var e="M "+this.outline[0][0].toFloatX()+", "+this.outline[0][0].toFloatY()+" ",n=1;n<this.outline[0].length;n++)e+="L "+this.outline[0][n].toFloatX()+", "+this.outline[0][n].toFloatY()+" ";e+="Z ";for(var r=1;r<this.outline.length;r++){e+="M "+this.outline[r][0].toFloatX()+", "+this.outline[r][0].toFloatY()+" ";for(var n=1;n<this.outline[r].length;n++)e+="L "+this.outline[r][n].toFloatX()+", "+this.outline[r][n].toFloatY()+" ";e+="Z"}return e}};var Jz=function(t){for(var e=JSON.parse(t),n=[],r=0;r<7;r++){var i=e[r],s=new Qe(new Pe(i.anchor.x.coeffInt,i.anchor.x.coeffSqrt),new Pe(i.anchor.y.coeffInt,i.anchor.y.coeffSqrt));n.push(new Ls(i.tanType,s,i.orientation))}return new Xz(n)};const Ko=G.createContext([]),Zz=({children:t})=>{const{currentUser:e}=G.useContext(Qn),[n,r]=G.useState(null);G.useEffect(()=>{const s=new Worker(new URL("/static/project/assets/generator-3tQ9ksN6.js",import.meta.url),{type:"module"}),a=[];return s.onmessage=function(u){var h=u.data;typeof h=="string"?h==="Worker started!"?(Ms.current=!0,console.log("Worker said: ",h)):h==="Generating done!"?r(a.map((g,m)=>(g.positionCentered(),{id:m,approved:!0,category:"geometric",emoji:"ðŸ‘´",length:g.evaluation.perimeter,edges:g.evaluation.outlineVertices,height:g.evaluation.rangeY,width:g.evaluation.rangeX,path:g.toSVGOutline()}))):h.startsWith("console")?console.log("Log from worker",h):(Ms.current=!1,a.push(Jz(h))):console.log("Worker said: ","Generated!")},s.postMessage(1e3),()=>s.terminate()},[]);const i=G.useMemo(()=>{if(!n)return{initialized:!1,approvedTangrams:null,pendingTangrams:null,approvedTangramsByCategory:null};const s=[],a=[];for(const u of n)u.approved?s.push(u):e&&(e.isAdmin||u.uid===e.uid)&&a.push(u);return{initialized:!0,approvedTangrams:s,pendingTangrams:a}},[e,n]);return R.jsx(Ko.Provider,{value:i,children:t})},Fr=G.createContext(null),e8=({children:t})=>{const e=nn(),n=G.useContext(gi),{currentUser:r}=G.useContext(Qn),{approvedTangrams:i}=G.useContext(Ko),[s,a]=G.useState(null),[u,h]=G.useState(null),[g,m]=G.useState(null),[w,T]=G.useState(0),[I,j]=G.useState(!1);G.useEffect(()=>{s&&u&&j(!0)},[s,u]),G.useEffect(()=>jt.firestore().collection("stats").onSnapshot(ne=>{const me={},pe={};for(const rt of ne.docs){const Ve=rt.id,xe=rt.data();me[Ve]||(me[Ve]={},pe[Ve]={});for(const we in xe)me[Ve][we]=xe[we].completed,pe[Ve][we]=xe[we].starred}a(me),h(pe)}),[]);const z=G.useCallback(ae=>!r||!u[ae]?!1:u[ae][r.uid]===!0,[r,u]),X=G.useCallback(ae=>!r||!s[ae]?!1:s[ae][r.uid]!==void 0,[r,s]),V=G.useCallback(ae=>{let ne=`${window.location.origin}/?tangrams=${ae.map(({id:me})=>me).join(",")}`;r&&(ne+=`&uid=${r.uid}`),Dz(ne),n(e.formatMessage({id:"Challenge link copied to clipboard"}))},[n,r,e]),B=G.useCallback(()=>{T(ae=>ae+1)},[]),U=G.useCallback(ae=>{const ne=ae?({id:pe,edges:rt},{id:Ve,edges:xe})=>{const we=X(pe),it=X(Ve);return!we&&!it?xe-rt:we-it}:({id:pe},{id:rt})=>{const Ve=X(pe),xe=X(rt);return Ve-xe},me=Oz([...i]).sort(ne);m(me)},[i,X]),J=G.useCallback(async(ae,ne)=>{r&&i.some(me=>me.id===ae.id)&&!X(ae.id)&&await jt.firestore().collection("stats").doc(ae.id).set({[r.uid]:{completed:ne}},{merge:!0})},[i,r,X]),re=G.useCallback(async ae=>{if(r&&i.some(ne=>ne.id===ae.id)){const ne=z(ae.id);await jt.firestore().collection("stats").doc(ae.id).set({[r.uid]:{starred:!ne}},{merge:!0})}},[i,r,z]),te=G.useMemo(()=>({initialized:I,requestSave:B,saveRequestId:w,playlist:g,setPlaylist:m,shareTangrams:V,startRandomPlaylist:U,tangramsCompletedBy:s,tangramsStarredBy:u,toggleTangramStar:re,markTangramAsComplete:J,isTangramCompleted:X,isTangramStarred:z}),[I,B,w,g,V,U,s,u,re,J,X,z]);return R.jsx(Fr.Provider,{value:te,children:t})};var Ak={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},vS=Ct.createContext&&Ct.createContext(Ak),wo=function(){return wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},wo.apply(this,arguments)},t8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function bk(t){return t&&t.map(function(e,n){return Ct.createElement(e.tag,wo({key:n},e.attr),bk(e.child))})}function Ir(t){return function(e){return Ct.createElement(n8,wo({attr:wo({},t.attr)},e),bk(t.child))}}function n8(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,a=t8(t,["attr","size","title"]),u=i||n.size||"1em",h;return n.className&&(h=n.className),t.className&&(h=(h?h+" ":"")+t.className),Ct.createElement("svg",wo({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:h,style:wo(wo({color:t.color||n.color},n.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),s&&Ct.createElement("title",null,s),t.children)};return vS!==void 0?Ct.createElement(vS.Consumer,null,function(n){return e(n)}):e(Ak)}function Pk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"}},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"}}]})(t)}function r8(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(t)}function Rk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"}},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"}}]})(t)}function kk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(t)}function i8(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}}]})(t)}function s8(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"}}]})(t)}function Nk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(t)}function Dk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(t)}function Ok(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"}},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"}},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"}}]})(t)}function Mo(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(t)}function o8(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"}},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"}},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"}},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}}]})(t)}function Mk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(t)}function a8(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"path",attr:{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"}}]})(t)}function l8(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"line",attr:{x1:"23",y1:"9",x2:"17",y2:"15"}},{tag:"line",attr:{x1:"17",y1:"9",x2:"23",y2:"15"}}]})(t)}function Lk(t){return Ir({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(t)}const u8="modulepreload",c8=function(t){return"/static/project/"+t},yS={},h8=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=c8(s),s in yS)return;yS[s]=!0;const a=s.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(!!r)for(let m=i.length-1;m>=0;m--){const w=i[m];if(w.href===s&&(!a||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${u}`))return;const g=document.createElement("link");if(g.rel=a?"stylesheet":u8,a||(g.as="script",g.crossOrigin=""),g.href=s,document.head.appendChild(g),a)return new Promise((m,w)=>{g.addEventListener("load",m),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};function Mg(){return Mg=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mg.apply(this,arguments)}function d8(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function f8(t){G.useEffect(t,[])}function dl(t,e){e===void 0&&(e={});var n=e,r=n.volume,i=r===void 0?1:r,s=n.playbackRate,a=s===void 0?1:s,u=n.soundEnabled,h=u===void 0?!0:u,g=n.interrupt,m=g===void 0?!1:g,w=n.onload,T=d8(n,["id","volume","playbackRate","soundEnabled","interrupt","onload"]),I=Ct.useRef(null),j=Ct.useRef(!1),z=Ct.useState(null),X=z[0],V=z[1],B=Ct.useState(null),U=B[0],J=B[1],re=function(){typeof w=="function"&&w.call(this),j.current&&V(this.duration()*1e3),J(this)};f8(function(){return h8(()=>import("./howler-qYrDWyw5.js").then(pe=>pe.h),__vite__mapDeps([])).then(function(pe){if(!j.current){var rt;I.current=(rt=pe.Howl)!==null&&rt!==void 0?rt:pe.default.Howl,j.current=!0,new I.current(Mg({src:Array.isArray(t)?t:[t],volume:i,rate:a,onload:re},T))}}),function(){j.current=!1}}),Ct.useEffect(function(){I.current&&U&&J(new I.current(Mg({src:Array.isArray(t)?t:[t],volume:i,onload:re},T)))},[JSON.stringify(t)]),Ct.useEffect(function(){U&&(U.volume(i),U.rate(a))},[i,a]);var te=Ct.useCallback(function(pe){typeof pe>"u"&&(pe={}),!(!U||!h&&!pe.forceSoundEnabled)&&(m&&U.stop(),pe.playbackRate&&U.rate(pe.playbackRate),U.play(pe.id))},[U,h,m]),ae=Ct.useCallback(function(pe){U&&U.stop(pe)},[U]),ne=Ct.useCallback(function(pe){U&&U.pause(pe)},[U]),me=[te,{sound:U,stop:ae,pause:ne,duration:X}];return me}const g8="/static/project/assets/star-wql4oqhK.wav",wS="/static/project/assets/button-J_WJeIQM.wav",p8="/static/project/assets/card-xj0x2Eh2.wav",m8="/static/project/assets/pop-DwoHE_6m.wav",_8="/static/project/assets/victory-gnOqf9qL.wav",pi=G.createContext([!0,()=>{}]),v8=({children:t})=>{const[e,n]=G.useState(!0),[r]=dl(g8,{soundEnabled:e}),[i]=dl(wS,{soundEnabled:e}),[s]=dl(wS,{soundEnabled:e}),[a]=dl(p8,{soundEnabled:e}),[u]=dl(m8,{soundEnabled:e}),[h]=dl(_8,{soundEnabled:e});G.useEffect(()=>{n(window.localStorage.getItem("sound")!=="off")},[]);const g=G.useCallback(()=>{const w=!e;n(w),window.localStorage.setItem("sound",w?"on":"off")},[e]),m=G.useMemo(()=>({soundEnabled:e,toggleSound:g,playButton:i,playToggle:s,playCard:a,playStar:r,playTangram:u,playVictory:h}),[e,g,i,s,a,r,u,h]);return R.jsx(pi.Provider,{value:m,children:t})},xE=Bh("button",({css:t,onClick:e,mute:n,...r})=>{const{playButton:i}=G.useContext(pi);return{css:{borderRadius:2,minWidth:0,minHeight:0,flex:"none",fontFamily:"inherit",fontWeight:"bolder",border:"none",fontSize:"inherit",color:"inherit",background:"none",cursor:"pointer",p:3,"&:disabled":{opacity:.3,cursor:"not-allowed"},"&:focus":{outline:"none"},...t},onClick:s=>{n||i(),e&&e(s)},...r}}),y8=as(xE,{css:{border:"2px solid",borderRadius:2}}),w8=as(xE,{css:{border:"2px solid",color:"errorText"}}),gr=as(xE,({css:t,...e})=>({css:{animation:`${Lf({0:{bg:"pieces.lt2"},14:{bg:"pieces.rh"},28:{bg:"pieces.st2"},42:{bg:"pieces.mt1"},57:{bg:"pieces.st1"},71:{bg:"pieces.lt1"},85:{bg:"pieces.sq"},100:{bg:"pieces.lt2"}})} 20s linear infinite both`,color:"#FFFFFFDD",...t},...e})),cm=({uid:t,size:e="badge",css:n,onClick:r,...i})=>{const{playButton:s}=G.useContext(pi),a=G.useContext(Di),u=G.useMemo(()=>{const h=Object.values(a.colors.pieces);return h[t.charCodeAt(0)%h.length].slice(1)},[a,t]);return R.jsx(fe,{as:"img",src:`https://api.dicebear.com/7.x/croodles-neutral/svg?seed=${t}&backgroundColor=${encodeURIComponent(u)}`,css:{m:"2px",boxShadow:`0 0 0 2px ${a.colors.dialogText}`,borderRadius:"50%",backgroundColor:u,size:e,...n},onClick:r?h=>{s(),r(h)}:void 0,...i})},E8=(t,e)=>{const[n,r]=G.useState(null),i=u=>{if(n&&u.touches&&u.touches.length!==1)clearTimeout(n.timeoutId);else{const h=u.touches?u.touches.item(0):u;r({timeoutId:setTimeout(t,e),startEvent:{clientX:h.clientX,clientY:h.clientY}})}},s=u=>{if(!n)return;let h=u.touches?u.touches.item(0):u;Math.sqrt(Math.pow(h.clientX-n.startEvent.clientX,2)+Math.pow(h.clientY-n.startEvent.clientY,2))>10&&clearTimeout(n.timeoutId)},a=()=>{n&&clearTimeout(n.timeoutId)};return{onMouseDown:i,onMouseUp:a,onMouseMove:s,onMouseLeave:a,onTouchStart:i,onTouchEnd:a,onTouchMove:s}},I8=t=>t.edges>16?0:t.edges>8?1:2,yd=({showStroke:t,tangram:e,completed:n,selected:r,css:i,onBadgeClick:s,onClick:a,onLongPress:u,hideBadge:h,...g})=>{const{path:m,width:w,height:T,uid:I,approved:j,emoji:z}=e,X=G.useMemo(()=>I8(e),[e]),{playCard:V}=G.useContext(pi),U=G.useContext(Di).colors.difficulties[X],J=G.useCallback(()=>{u&&u(e)},[u,e]),re=E8(J,1e3);return R.jsx(fe,{css:i,onClick:a?()=>{V(),a(e)}:void 0,...re,...g,children:R.jsxs(fe,{css:{opacity:I&&j===!1?.5:1,borderRadius:5,boxShadow:r?`0px 0px 0px 4px ${U}`:"0px 0px 0px 1px rgba(0, 0, 0, 0.1)",m:1,bg:"background",transition:`background-color ${Of}ms`,p:3,textAlign:"center",position:"relative",cursor:a||u?"pointer":void 0,width:128,height:178},deps:[U,r,I,j],children:[R.jsx(fe,{as:"svg",css:{flex:"1",justifyContent:"center",fill:U,stroke:t?"lime":void 0,strokeWidth:t?8:void 0},deps:[t,U],viewBox:`0 0 ${w} ${T}`,dangerouslySetInnerHTML:{__html:`<path d="${m}" />`}}),n&&R.jsx(fe,{css:{position:"absolute",top:1,left:1,fontSize:"30px"},children:z}),I&&!h&&R.jsx(cm,{uid:I,css:{position:"absolute",bottom:1,right:1,cursor:s?"pointer":void 0},onClick:s?te=>{te.stopPropagation(),s(I)}:void 0})]})})},ls=({children:t,title:e,onClose:n,big:r,css:i,...s})=>{const{playButton:a}=G.useContext(pi);return T0.createPortal(R.jsx(fe,{onClick:n,css:{position:"fixed",top:0,left:0,right:0,bottom:0,bg:"#00000080",alignItems:"center",justifyContent:"center",animation:`${ni/2}ms fadeIn ease both`,p:3},children:R.jsxs(fe,{css:{flex:"0 1 auto",bg:"dialogBackground",color:"dialogText",borderRadius:3,transition:`background-color ${Of}ms, color ${Of}ms`,fontSize:3,p:3,gap:3,maxWidth:"95vw",width:r?"568px":"400px"},onClick:u=>u.stopPropagation(),children:[R.jsxs(fe,{css:{flexDirection:"row",gap:3,alignItems:"center",justifyContent:"space-between",zIndex:1},children:[e,R.jsx(fe,{as:Lk,css:{cursor:"pointer",size:"badge",ml:e?void 0:"auto"},onClick:()=>{a(),n()}})]}),R.jsx(fe,{css:{overflow:"auto",flex:"1",maxWidth:"100%",...i},...s,children:t})]})}),document.getElementById("dialogContainer"))},Ze=Bh("div",{css:{display:"inline",minWidth:0,minHeight:0,flex:"none"}}),Or=as(Ze,{css:{fontSize:2,color:"errorText"}}),_s=as(Ze,{css:{fontSize:2,opacity:.75}}),Gr=as(Ze,{css:{fontSize:4,fontWeight:"bolder"}}),fl=as(Ze,{css:{fontSize:3,fontWeight:"bold"}}),ES=Bh("a",{css:{cursor:"pointer",textDecoration:"underline",color:"inherit","&:visited":{color:"inherit"}}}),bi=as(Ze,{css:{cursor:"pointer",textDecoration:"underline"}}),Cr=({icon:t,css:e})=>R.jsx(Ze,{as:t,css:{position:"relative",top:"0.1em",size:"0.9em",...e}}),T8=({uid:t,tangrams:e,deferred:n})=>{const r=nn(),{usersMetadata:i}=G.useContext(Qn);G.useContext(Fr);const s=i[t]?i[t].username:null;return R.jsxs(ls,{big:!0,title:R.jsx(Gr,{children:s?r.formatMessage({id:"{username} challenged you"},{username:s}):r.formatMessage({id:"Rise to the challenge"},{username:s})}),onClose:()=>n.reject(gn),css:{gap:3,overflow:"initial",maxWidth:"568px"},children:[R.jsx(fe,{css:{flex:"1",overflow:"auto",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",m:-1},children:e.map(a=>R.jsx(yd,{selected:!0,tangram:a,css:{m:1}},a.id))}),R.jsx(gr,{onClick:()=>{n.resolve()},children:r.formatMessage({id:"Let's go!"})})]})},S8=(t,e)=>e.edges===t.edges?e.length-t.length:e.edges-t.edges,x8=(t,e)=>wc.indexOf(t.emoji)-wc.indexOf(e.emoji),C8=(t,e)=>Ec.indexOf(t.emoji)-Ec.indexOf(e.emoji),_n=Bh("input",{type:"text",css:{color:"inherit",fontFamily:"inherit",fontWeight:"bolder",fontSize:"inherit",bg:"inputBackground",border:"none",borderRadius:2,borderColor:"currentColor",p:2,"&:disabled":{opacity:.5,cursor:"not-allowed"},"&:focus":{outline:"none"}}}),A8=as(fe,({css:t,...e})=>({css:{p:3,alignItems:"center",position:"sticky",top:0,zIndex:1,background:`linear-gradient(0deg, rgba(0,0,0,0) 0%, ${G.useContext(Di).colors.dialogBackground} 50%)`,...t},...e})),b8=({deferred:t})=>{const e=nn(),{currentUser:n}=G.useContext(Qn),{pendingTangrams:r,approvedTangrams:i}=G.useContext(Ko),{showProfile:s,showTangram:a}=G.useContext(Id),{setPlaylist:u,shareTangrams:h,startRandomPlaylist:g,isTangramCompleted:m,isTangramStarred:w}=G.useContext(Fr),[T,I]=G.useState([]),[j,z]=G.useState(()=>{const te=window.localStorage.getItem("selectedGalleryFilter");return["all","uncompleted","starred","pending"].includes(te)?te:"all"}),X=te=>{z(te.target.value),window.localStorage.setItem("selectedGalleryFilter",te.target.value)},V=G.useCallback(te=>{I(ae=>ae.some(ne=>ne.id===te.id)?ae.filter(ne=>ne.id!==te.id):[...ae,te])},[]),B=()=>{T.length?u(T):g(),t.resolve()},U=()=>t.reject(gn),J=G.useMemo(()=>{const te=j==="pending"?r:i,ae={};for(const me of te)j==="uncompleted"&&m(me.id)||j==="starred"&&!w(me.id)||(ae[me.category]||(ae[me.category]=[]),ae[me.category].push(me));const ne={};for(const me of Object.keys(ae).sort())ne[me]=ae[me].sort(me==="letters"?C8:me==="digits"?x8:S8);return ne},[r,i,j,m,w]),re=Object.keys(J);return R.jsx(R.Fragment,{children:R.jsx(ls,{big:!0,title:R.jsx(Gr,{children:e.formatMessage({id:"Tangram gallery"})}),css:{gap:3,width:"568px"},onClose:U,children:R.jsxs(R.Fragment,{children:[R.jsxs(_n,{as:"select",value:j,onChange:X,children:[R.jsx("option",{value:"all",children:e.formatMessage({id:"All tangrams"})}),R.jsx("option",{value:"uncompleted",children:e.formatMessage({id:"Uncompleted tangrams"})}),R.jsx("option",{value:"starred",children:e.formatMessage({id:"â˜… Starred tangrams"})}),R.jsx("option",{value:"pending",children:e.formatMessage({id:"Pending approbation tangrams"})})]}),R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:3},children:re.length===0?R.jsx(fe,{css:{gap:3,alignItems:"center"},children:j==="uncompleted"?R.jsxs(R.Fragment,{children:[R.jsx(Ze,{css:{fontSize:"8em"},children:"ðŸ¾"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(fl,{css:{textAlign:"center"},children:R.jsx(xt,{id:"You've completed all tangrams"})}),R.jsx(_s,{children:R.jsx(xt,{id:"Come back later for more or create your own tangrams"})})]})]}):j==="pending"?n&&n.isAdmin?R.jsxs(R.Fragment,{children:[R.jsx(Ze,{css:{fontSize:"8em"},children:"ðŸ‘®"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(fl,{css:{textAlign:"center"},children:R.jsx(xt,{id:"No tangram left to approve"})}),R.jsx(_s,{children:R.jsx(xt,{id:"Good job moderator {username}!",values:{username:n.username}})})]})]}):R.jsxs(R.Fragment,{children:[R.jsx(Ze,{css:{fontSize:"8em"},children:"ðŸ‘"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(fl,{css:{textAlign:"center"},children:R.jsx(xt,{id:"All your tangrams have been approved"})}),R.jsx(_s,{children:R.jsx(xt,{id:"Create more tangrams and earn <starIcon></starIcon>",values:{starIcon:()=>R.jsx(Cr,{icon:Mo,css:{fill:"currentColor"}})}})})]})]}):j==="starred"?R.jsxs(R.Fragment,{children:[R.jsx(Ze,{css:{fontSize:"8em"},children:"ðŸŒƒ"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(fl,{css:{textAlign:"center"},children:R.jsx(xt,{id:"No starred tangrams yet"})}),R.jsx(_s,{children:R.jsx(xt,{id:"Press <starIcon></starIcon> to star a tangram and show your love",values:{starIcon:()=>R.jsx(Cr,{icon:Mo,css:{fill:"currentColor"}})}})})]})]}):R.jsxs(R.Fragment,{children:[R.jsx(Ze,{css:{fontSize:"8em"},children:"ðŸ¤·"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(fl,{css:{textAlign:"center"},children:R.jsx(xt,{id:"Nothing to see here"})}),R.jsx(_s,{children:R.jsx(xt,{id:"Something might have gone wrong"})})]})]})},"noresult"):R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:3},children:re.map(te=>R.jsxs(fe,{children:[R.jsx(A8,{children:R.jsx(fl,{children:e.formatMessage({id:te})})}),R.jsx(fe,{css:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 136px)",gridColumnGap:2,gridRowGap:2,justifyContent:"center",justifyItems:"center",alignItems:"center"},children:J[te].map(ae=>R.jsx(yd,{showStroke:j==="pending"&&n&&n.isAdmin,tangram:ae,completed:m(ae.id),selected:T.some(ne=>ne.id===ae.id),onClick:V,onBadgeClick:s,onLongPress:a},ae.id))})]},te))},"results")}),R.jsxs(fe,{css:{flexDirection:"row",gap:2},children:[R.jsx(gr,{onClick:B,css:{flex:"1"},children:T.length===0?e.formatMessage({id:"Play now!"}):T.length===1?e.formatMessage({id:"Start 1 tangram!"}):e.formatMessage({id:"Start {count} tangrams!"},{count:T.length})}),R.jsx(gr,{disabled:T.length===0,onClick:()=>h(T),children:R.jsx(fe,{as:Ok,css:{size:"icon",m:"-2px"}})})]})]})})})},P8=({deferred:t})=>{const e=nn(),{showProfile:n}=G.useContext(Id),{currentUser:r,usersMetadata:i}=G.useContext(Qn),{approvedTangrams:s}=G.useContext(Ko),{tangramsStarredBy:a,tangramsCompletedBy:u}=G.useContext(Fr),[h,g]=G.useState(()=>{const j=window.localStorage.getItem("selectedLeaderboard");return["stars","completed","created"].includes(j)?j:"stars"}),m=j=>{g(j.target.value),window.localStorage.setItem("selectedLeaderboard",j.target.value)},w=j=>{n(j)},T=G.useMemo(()=>{const j={},z={},X={};for(const{id:V,uid:B}of s){z[B]||(z[B]=0,j[B]=0);for(const U in a[V])U!==B&&a[V][U]&&(j[B]+=1);z[B]+=1;for(const U in u[V])X[U]||(X[U]=0),X[U]+=1}return Object.keys(i).map(V=>{const B=i[V];return{uid:V,...B,stars:j[V]||0,completed:X[V]||0,created:z[V]||0}})},[s,a,u,i]),I=G.useMemo(()=>{if(T)return T.sort((j,z)=>z[h]-j[h])},[T,h]);return R.jsx(ls,{title:R.jsx(Gr,{children:e.formatMessage({id:"Leaderboard"})}),onClose:()=>t.reject(gn),css:{gap:3},children:R.jsxs(R.Fragment,{children:[R.jsxs(_n,{as:"select",value:h,onChange:m,children:[R.jsx("option",{value:"stars",children:e.formatMessage({id:"Stars earned"})}),R.jsx("option",{value:"completed",children:e.formatMessage({id:"Completed tangrams"})}),R.jsx("option",{value:"created",children:e.formatMessage({id:"Created tangrams"})})]}),R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:2},children:I.map(({uid:j,username:z,...X},V)=>R.jsxs(fe,{css:{flexDirection:"row",gap:2,alignItems:"center",fontSize:V===0?"1.6em":V===1?"1.4em":V===2?"1.2em":void 0},deps:[V],children:[R.jsx(cm,{uid:j,size:"badge",onClick:()=>w(j)}),R.jsx(Ze,{css:{flex:"1",fontWeight:r&&r.uid===j?"bold":void 0},deps:[r,j],children:z}),R.jsxs(Ze,{children:[X[h],h==="stars"&&R.jsxs(R.Fragment,{children:[" ",R.jsx(Cr,{icon:Mo,css:{fill:"currentColor"}})]})]})]},j))})]})})};var wd=t=>t.type==="checkbox",Vl=t=>t instanceof Date,dr=t=>t==null;const Vk=t=>typeof t=="object";var xn=t=>!dr(t)&&!Array.isArray(t)&&Vk(t)&&!Vl(t),R8=t=>xn(t)&&t.target?wd(t.target)?t.target.checked:t.target.value:t,k8=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,N8=(t,e)=>t.has(k8(e)),D8=t=>{const e=t.constructor&&t.constructor.prototype;return xn(e)&&e.hasOwnProperty("isPrototypeOf")},CE=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ds(t){let e;const n=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(CE&&(t instanceof Blob||t instanceof FileList))&&(n||xn(t)))if(e=n?[]:{},!n&&!D8(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=ds(t[r]));else return t;return e}var Ed=t=>Array.isArray(t)?t.filter(Boolean):[],fn=t=>t===void 0,je=(t,e,n)=>{if(!e||!xn(t))return n;const r=Ed(e.split(/[,[\].]+?/)).reduce((i,s)=>dr(i)?i:i[s],t);return fn(r)||r===t?fn(t[e])?n:t[e]:r},no=t=>typeof t=="boolean";const IS={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Si={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},hs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};Ct.createContext(null);var O8=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const a=s;return e._proxyFormState[a]!==Si.all&&(e._proxyFormState[a]=!r||Si.all),n&&(n[a]=!0),t[a]}});return i},ti=t=>xn(t)&&!Object.keys(t).length,M8=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return ti(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(a=>e[a]===(!r||Si.all))},h_=t=>Array.isArray(t)?t:[t];function L8(t){const e=Ct.useRef(t);e.current=t,Ct.useEffect(()=>{const n=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{n&&n.unsubscribe()}},[t.disabled])}var Xi=t=>typeof t=="string",V8=(t,e,n,r,i)=>Xi(t)?(r&&e.watch.add(t),je(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),je(n,s))):(r&&(e.watchAll=!0),n),AE=t=>/^\w*$/.test(t),Fk=t=>Ed(t.replace(/["|']|\]/g,"").split(/\.|\[/));function Gt(t,e,n){let r=-1;const i=AE(e)?[e]:Fk(e),s=i.length,a=s-1;for(;++r<s;){const u=i[r];let h=n;if(r!==a){const g=t[u];h=xn(g)||Array.isArray(g)?g:isNaN(+i[r+1])?{}:[]}t[u]=h,t=t[u]}return t}var F8=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},TS=t=>({isOnSubmit:!t||t===Si.onSubmit,isOnBlur:t===Si.onBlur,isOnChange:t===Si.onChange,isOnAll:t===Si.all,isOnTouch:t===Si.onTouched}),SS=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const Nf=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=je(t,i);if(s){const{_f:a,...u}=s;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],i)&&!r)break;if(a.ref&&e(a.ref,a.name)&&!r)break}else xn(u)&&Nf(u,e)}}};var B8=(t,e,n)=>{const r=Ed(je(t,n));return Gt(r,"root",e[n]),Gt(t,n,r),t},bE=t=>t.type==="file",ao=t=>typeof t=="function",Lg=t=>{if(!CE)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Df=t=>Xi(t),PE=t=>t.type==="radio",Vg=t=>t instanceof RegExp;const xS={value:!1,isValid:!1},CS={value:!0,isValid:!0};var Bk=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!fn(t[0].attributes.value)?fn(t[0].value)||t[0].value===""?CS:{value:t[0].value,isValid:!0}:CS:xS}return xS};const AS={isValid:!1,value:null};var Uk=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,AS):AS;function bS(t,e,n="validate"){if(Df(t)||Array.isArray(t)&&t.every(Df)||no(t)&&!t)return{type:n,message:Df(t)?t:"",ref:e}}var gl=t=>xn(t)&&!Vg(t)?t:{value:t,message:""},PS=async(t,e,n,r,i)=>{const{ref:s,refs:a,required:u,maxLength:h,minLength:g,min:m,max:w,pattern:T,validate:I,name:j,valueAsNumber:z,mount:X,disabled:V}=t._f,B=je(e,j);if(!X||V)return{};const U=a?a[0]:s,J=Ve=>{r&&U.reportValidity&&(U.setCustomValidity(no(Ve)?"":Ve||""),U.reportValidity())},re={},te=PE(s),ae=wd(s),ne=te||ae,me=(z||bE(s))&&fn(s.value)&&fn(B)||Lg(s)&&s.value===""||B===""||Array.isArray(B)&&!B.length,pe=F8.bind(null,j,n,re),rt=(Ve,xe,we,it=hs.maxLength,he=hs.minLength)=>{const lt=Ve?xe:we;re[j]={type:Ve?it:he,message:lt,ref:s,...pe(Ve?it:he,lt)}};if(i?!Array.isArray(B)||!B.length:u&&(!ne&&(me||dr(B))||no(B)&&!B||ae&&!Bk(a).isValid||te&&!Uk(a).isValid)){const{value:Ve,message:xe}=Df(u)?{value:!!u,message:u}:gl(u);if(Ve&&(re[j]={type:hs.required,message:xe,ref:U,...pe(hs.required,xe)},!n))return J(xe),re}if(!me&&(!dr(m)||!dr(w))){let Ve,xe;const we=gl(w),it=gl(m);if(!dr(B)&&!isNaN(B)){const he=s.valueAsNumber||B&&+B;dr(we.value)||(Ve=he>we.value),dr(it.value)||(xe=he<it.value)}else{const he=s.valueAsDate||new Date(B),lt=Oe=>new Date(new Date().toDateString()+" "+Oe),Ce=s.type=="time",Te=s.type=="week";Xi(we.value)&&B&&(Ve=Ce?lt(B)>lt(we.value):Te?B>we.value:he>new Date(we.value)),Xi(it.value)&&B&&(xe=Ce?lt(B)<lt(it.value):Te?B<it.value:he<new Date(it.value))}if((Ve||xe)&&(rt(!!Ve,we.message,it.message,hs.max,hs.min),!n))return J(re[j].message),re}if((h||g)&&!me&&(Xi(B)||i&&Array.isArray(B))){const Ve=gl(h),xe=gl(g),we=!dr(Ve.value)&&B.length>+Ve.value,it=!dr(xe.value)&&B.length<+xe.value;if((we||it)&&(rt(we,Ve.message,xe.message),!n))return J(re[j].message),re}if(T&&!me&&Xi(B)){const{value:Ve,message:xe}=gl(T);if(Vg(Ve)&&!B.match(Ve)&&(re[j]={type:hs.pattern,message:xe,ref:s,...pe(hs.pattern,xe)},!n))return J(xe),re}if(I){if(ao(I)){const Ve=await I(B,e),xe=bS(Ve,U);if(xe&&(re[j]={...xe,...pe(hs.validate,xe.message)},!n))return J(xe.message),re}else if(xn(I)){let Ve={};for(const xe in I){if(!ti(Ve)&&!n)break;const we=bS(await I[xe](B,e),U,xe);we&&(Ve={...we,...pe(xe,we.message)},J(we.message),n&&(re[j]=Ve))}if(!ti(Ve)&&(re[j]={ref:U,...Ve},!n))return re}}return J(!0),re};function U8(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=fn(t)?r++:t[e[r++]];return t}function j8(t){for(const e in t)if(t.hasOwnProperty(e)&&!fn(t[e]))return!1;return!0}function Bn(t,e){const n=Array.isArray(e)?e:AE(e)?[e]:Fk(e),r=n.length===1?t:U8(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(xn(r)&&ti(r)||Array.isArray(r)&&j8(r))&&Bn(t,n.slice(0,-1)),t}function d_(){let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}}var Fg=t=>dr(t)||!Vk(t);function Ea(t,e){if(Fg(t)||Fg(e))return t===e;if(Vl(t)&&Vl(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n){const s=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const a=e[i];if(Vl(s)&&Vl(a)||xn(s)&&xn(a)||Array.isArray(s)&&Array.isArray(a)?!Ea(s,a):s!==a)return!1}}return!0}var jk=t=>t.type==="select-multiple",z8=t=>PE(t)||wd(t),f_=t=>Lg(t)&&t.isConnected,zk=t=>{for(const e in t)if(ao(t[e]))return!0;return!1};function Bg(t,e={}){const n=Array.isArray(t);if(xn(t)||n)for(const r in t)Array.isArray(t[r])||xn(t[r])&&!zk(t[r])?(e[r]=Array.isArray(t[r])?[]:{},Bg(t[r],e[r])):dr(t[r])||(e[r]=!0);return e}function $k(t,e,n){const r=Array.isArray(t);if(xn(t)||r)for(const i in t)Array.isArray(t[i])||xn(t[i])&&!zk(t[i])?fn(e)||Fg(n[i])?n[i]=Array.isArray(t[i])?Bg(t[i],[]):{...Bg(t[i])}:$k(t[i],dr(e)?{}:e[i],n[i]):n[i]=!Ea(t[i],e[i]);return n}var g_=(t,e)=>$k(t,e,Bg(e)),qk=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>fn(t)?t:e?t===""?NaN:t&&+t:n&&Xi(t)?new Date(t):r?r(t):t;function p_(t){const e=t.ref;if(!(t.refs?t.refs.every(n=>n.disabled):e.disabled))return bE(e)?e.files:PE(e)?Uk(t.refs).value:jk(e)?[...e.selectedOptions].map(({value:n})=>n):wd(e)?Bk(t.refs).value:qk(fn(e.value)?t.ref.value:e.value,t)}var $8=(t,e,n,r)=>{const i={};for(const s of t){const a=je(e,s);a&&Gt(i,s,a._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},sc=t=>fn(t)?t:Vg(t)?t.source:xn(t)?Vg(t.value)?t.value.source:t.value:t,q8=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function RS(t,e,n){const r=je(t,n);if(r||AE(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),a=je(e,s),u=je(t,s);if(a&&!Array.isArray(a)&&n!==s)return{name:n};if(u&&u.type)return{name:s,error:u};i.pop()}return{name:n}}var H8=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,G8=(t,e)=>!Ed(je(t,e)).length&&Bn(t,e);const W8={mode:Si.onSubmit,reValidateMode:Si.onChange,shouldFocusError:!0};function K8(t={},e){let n={...W8,...t},r={submitCount:0,isDirty:!1,isLoading:ao(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{},disabled:!1},i={},s=xn(n.defaultValues)||xn(n.values)?ds(n.defaultValues||n.values)||{}:{},a=n.shouldUnregister?{}:ds(s),u={action:!1,mount:!1,watch:!1},h={mount:new Set,unMount:new Set,array:new Set,watch:new Set},g,m=0;const w={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},T={values:d_(),array:d_(),state:d_()},I=t.resetOptions&&t.resetOptions.keepDirtyValues,j=TS(n.mode),z=TS(n.reValidateMode),X=n.criteriaMode===Si.all,V=Z=>se=>{clearTimeout(m),m=setTimeout(Z,se)},B=async Z=>{if(w.isValid||Z){const se=n.resolver?ti((await me()).errors):await rt(i,!0);se!==r.isValid&&T.state.next({isValid:se})}},U=Z=>w.isValidating&&T.state.next({isValidating:Z}),J=(Z,se=[],ge,Ae,ke=!0,de=!0)=>{if(Ae&&ge){if(u.action=!0,de&&Array.isArray(je(i,Z))){const o=ge(je(i,Z),Ae.argA,Ae.argB);ke&&Gt(i,Z,o)}if(de&&Array.isArray(je(r.errors,Z))){const o=ge(je(r.errors,Z),Ae.argA,Ae.argB);ke&&Gt(r.errors,Z,o),G8(r.errors,Z)}if(w.touchedFields&&de&&Array.isArray(je(r.touchedFields,Z))){const o=ge(je(r.touchedFields,Z),Ae.argA,Ae.argB);ke&&Gt(r.touchedFields,Z,o)}w.dirtyFields&&(r.dirtyFields=g_(s,a)),T.state.next({name:Z,isDirty:xe(Z,se),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Gt(a,Z,se)},re=(Z,se)=>{Gt(r.errors,Z,se),T.state.next({errors:r.errors})},te=(Z,se,ge,Ae)=>{const ke=je(i,Z);if(ke){const de=je(a,Z,fn(ge)?je(s,Z):ge);fn(de)||Ae&&Ae.defaultChecked||se?Gt(a,Z,se?de:p_(ke._f)):he(Z,de),u.mount&&B()}},ae=(Z,se,ge,Ae,ke)=>{let de=!1,o=!1;const l={name:Z};if(!ge||Ae){w.isDirty&&(o=r.isDirty,r.isDirty=l.isDirty=xe(),de=o!==l.isDirty);const c=Ea(je(s,Z),se);o=je(r.dirtyFields,Z),c?Bn(r.dirtyFields,Z):Gt(r.dirtyFields,Z,!0),l.dirtyFields=r.dirtyFields,de=de||w.dirtyFields&&o!==!c}if(ge){const c=je(r.touchedFields,Z);c||(Gt(r.touchedFields,Z,ge),l.touchedFields=r.touchedFields,de=de||w.touchedFields&&c!==ge)}return de&&ke&&T.state.next(l),de?l:{}},ne=(Z,se,ge,Ae)=>{const ke=je(r.errors,Z),de=w.isValid&&no(se)&&r.isValid!==se;if(t.delayError&&ge?(g=V(()=>re(Z,ge)),g(t.delayError)):(clearTimeout(m),g=null,ge?Gt(r.errors,Z,ge):Bn(r.errors,Z)),(ge?!Ea(ke,ge):ke)||!ti(Ae)||de){const o={...Ae,...de&&no(se)?{isValid:se}:{},errors:r.errors,name:Z};r={...r,...o},T.state.next(o)}U(!1)},me=async Z=>n.resolver(a,n.context,$8(Z||h.mount,i,n.criteriaMode,n.shouldUseNativeValidation)),pe=async Z=>{const{errors:se}=await me(Z);if(Z)for(const ge of Z){const Ae=je(se,ge);Ae?Gt(r.errors,ge,Ae):Bn(r.errors,ge)}else r.errors=se;return se},rt=async(Z,se,ge={valid:!0})=>{for(const Ae in Z){const ke=Z[Ae];if(ke){const{_f:de,...o}=ke;if(de){const l=h.array.has(de.name),c=await PS(ke,a,X,n.shouldUseNativeValidation&&!se,l);if(c[de.name]&&(ge.valid=!1,se))break;!se&&(je(c,de.name)?l?B8(r.errors,c,de.name):Gt(r.errors,de.name,c[de.name]):Bn(r.errors,de.name))}o&&await rt(o,se,ge)}}return ge.valid},Ve=()=>{for(const Z of h.unMount){const se=je(i,Z);se&&(se._f.refs?se._f.refs.every(ge=>!f_(ge)):!f_(se._f.ref))&&Cn(Z)}h.unMount=new Set},xe=(Z,se)=>(Z&&se&&Gt(a,Z,se),!Ea(Tt(),s)),we=(Z,se,ge)=>V8(Z,h,{...u.mount?a:fn(se)?s:Xi(Z)?{[Z]:se}:se},ge,se),it=Z=>Ed(je(u.mount?a:s,Z,t.shouldUnregister?je(s,Z,[]):[])),he=(Z,se,ge={})=>{const Ae=je(i,Z);let ke=se;if(Ae){const de=Ae._f;de&&(!de.disabled&&Gt(a,Z,qk(se,de)),ke=Lg(de.ref)&&dr(se)?"":se,jk(de.ref)?[...de.ref.options].forEach(o=>o.selected=ke.includes(o.value)):de.refs?wd(de.ref)?de.refs.length>1?de.refs.forEach(o=>(!o.defaultChecked||!o.disabled)&&(o.checked=Array.isArray(ke)?!!ke.find(l=>l===o.value):ke===o.value)):de.refs[0]&&(de.refs[0].checked=!!ke):de.refs.forEach(o=>o.checked=o.value===ke):bE(de.ref)?de.ref.value="":(de.ref.value=ke,de.ref.type||T.values.next({name:Z,values:{...a}})))}(ge.shouldDirty||ge.shouldTouch)&&ae(Z,ke,ge.shouldTouch,ge.shouldDirty,!0),ge.shouldValidate&&Je(Z)},lt=(Z,se,ge)=>{for(const Ae in se){const ke=se[Ae],de=`${Z}.${Ae}`,o=je(i,de);(h.array.has(Z)||!Fg(ke)||o&&!o._f)&&!Vl(ke)?lt(de,ke,ge):he(de,ke,ge)}},Ce=(Z,se,ge={})=>{const Ae=je(i,Z),ke=h.array.has(Z),de=ds(se);Gt(a,Z,de),ke?(T.array.next({name:Z,values:{...a}}),(w.isDirty||w.dirtyFields)&&ge.shouldDirty&&T.state.next({name:Z,dirtyFields:g_(s,a),isDirty:xe(Z,de)})):Ae&&!Ae._f&&!dr(de)?lt(Z,de,ge):he(Z,de,ge),SS(Z,h)&&T.state.next({...r}),T.values.next({name:Z,values:{...a}}),!u.mount&&e()},Te=async Z=>{const se=Z.target;let ge=se.name,Ae=!0;const ke=je(i,ge),de=()=>se.type?p_(ke._f):R8(Z),o=l=>{Ae=Number.isNaN(l)||l===je(a,ge,l)};if(ke){let l,c;const d=de(),f=Z.type===IS.BLUR||Z.type===IS.FOCUS_OUT,p=!q8(ke._f)&&!n.resolver&&!je(r.errors,ge)&&!ke._f.deps||H8(f,je(r.touchedFields,ge),r.isSubmitted,z,j),v=SS(ge,h,f);Gt(a,ge,d),f?(ke._f.onBlur&&ke._f.onBlur(Z),g&&g(0)):ke._f.onChange&&ke._f.onChange(Z);const _=ae(ge,d,f,!1),y=!ti(_)||v;if(!f&&T.values.next({name:ge,type:Z.type,values:{...a}}),p)return w.isValid&&B(),y&&T.state.next({name:ge,...v?{}:_});if(!f&&v&&T.state.next({...r}),U(!0),n.resolver){const{errors:E}=await me([ge]);if(o(d),Ae){const A=RS(r.errors,i,ge),b=RS(E,i,A.name||ge);l=b.error,ge=b.name,c=ti(E)}}else l=(await PS(ke,a,X,n.shouldUseNativeValidation))[ge],o(d),Ae&&(l?c=!1:w.isValid&&(c=await rt(i,!0)));Ae&&(ke._f.deps&&Je(ke._f.deps),ne(ge,c,l,_))}},Oe=(Z,se)=>{if(je(r.errors,se)&&Z.focus)return Z.focus(),1},Je=async(Z,se={})=>{let ge,Ae;const ke=h_(Z);if(U(!0),n.resolver){const de=await pe(fn(Z)?Z:ke);ge=ti(de),Ae=Z?!ke.some(o=>je(de,o)):ge}else Z?(Ae=(await Promise.all(ke.map(async de=>{const o=je(i,de);return await rt(o&&o._f?{[de]:o}:o)}))).every(Boolean),!(!Ae&&!r.isValid)&&B()):Ae=ge=await rt(i);return T.state.next({...!Xi(Z)||w.isValid&&ge!==r.isValid?{}:{name:Z},...n.resolver||!Z?{isValid:ge}:{},errors:r.errors,isValidating:!1}),se.shouldFocus&&!Ae&&Nf(i,Oe,Z?ke:h.mount),Ae},Tt=Z=>{const se={...s,...u.mount?a:{}};return fn(Z)?se:Xi(Z)?je(se,Z):Z.map(ge=>je(se,ge))},ot=(Z,se)=>({invalid:!!je((se||r).errors,Z),isDirty:!!je((se||r).dirtyFields,Z),isTouched:!!je((se||r).touchedFields,Z),error:je((se||r).errors,Z)}),Ft=Z=>{Z&&h_(Z).forEach(se=>Bn(r.errors,se)),T.state.next({errors:Z?r.errors:{}})},Xe=(Z,se,ge)=>{const Ae=(je(i,Z,{_f:{}})._f||{}).ref;Gt(r.errors,Z,{...se,ref:Ae}),T.state.next({name:Z,errors:r.errors,isValid:!1}),ge&&ge.shouldFocus&&Ae&&Ae.focus&&Ae.focus()},dn=(Z,se)=>ao(Z)?T.values.subscribe({next:ge=>Z(we(void 0,se),ge)}):we(Z,se,!0),Cn=(Z,se={})=>{for(const ge of Z?h_(Z):h.mount)h.mount.delete(ge),h.array.delete(ge),se.keepValue||(Bn(i,ge),Bn(a,ge)),!se.keepError&&Bn(r.errors,ge),!se.keepDirty&&Bn(r.dirtyFields,ge),!se.keepTouched&&Bn(r.touchedFields,ge),!n.shouldUnregister&&!se.keepDefaultValue&&Bn(s,ge);T.values.next({values:{...a}}),T.state.next({...r,...se.keepDirty?{isDirty:xe()}:{}}),!se.keepIsValid&&B()},us=({disabled:Z,name:se,field:ge,fields:Ae,value:ke})=>{if(no(Z)){const de=Z?void 0:fn(ke)?p_(ge?ge._f:je(Ae,se)._f):ke;Gt(a,se,de),ae(se,de,!1,!1,!0)}},kt=(Z,se={})=>{let ge=je(i,Z);const Ae=no(se.disabled);return Gt(i,Z,{...ge||{},_f:{...ge&&ge._f?ge._f:{ref:{name:Z}},name:Z,mount:!0,...se}}),h.mount.add(Z),ge?us({field:ge,disabled:se.disabled,name:Z}):te(Z,!0,se.value),{...Ae?{disabled:se.disabled}:{},...n.progressive?{required:!!se.required,min:sc(se.min),max:sc(se.max),minLength:sc(se.minLength),maxLength:sc(se.maxLength),pattern:sc(se.pattern)}:{},name:Z,onChange:Te,onBlur:Te,ref:ke=>{if(ke){kt(Z,se),ge=je(i,Z);const de=fn(ke.value)&&ke.querySelectorAll&&ke.querySelectorAll("input,select,textarea")[0]||ke,o=z8(de),l=ge._f.refs||[];if(o?l.find(c=>c===de):de===ge._f.ref)return;Gt(i,Z,{_f:{...ge._f,...o?{refs:[...l.filter(f_),de,...Array.isArray(je(s,Z))?[{}]:[]],ref:{type:de.type,name:Z}}:{ref:de}}}),te(Z,!1,void 0,de)}else ge=je(i,Z,{}),ge._f&&(ge._f.mount=!1),(n.shouldUnregister||se.shouldUnregister)&&!(N8(h.array,Z)&&u.action)&&h.unMount.add(Z)}}},Ht=()=>n.shouldFocusError&&Nf(i,Oe,h.mount),Ot=Z=>{no(Z)&&(T.state.next({disabled:Z}),Nf(i,se=>{se.disabled=Z},0,!1))},Qo=(Z,se)=>async ge=>{ge&&(ge.preventDefault&&ge.preventDefault(),ge.persist&&ge.persist());let Ae=ds(a);if(T.state.next({isSubmitting:!0}),n.resolver){const{errors:ke,values:de}=await me();r.errors=ke,Ae=de}else await rt(i);Bn(r.errors,"root"),ti(r.errors)?(T.state.next({errors:{}}),await Z(Ae,ge)):(se&&await se({...r.errors},ge),Ht(),setTimeout(Ht)),T.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ti(r.errors),submitCount:r.submitCount+1,errors:r.errors})},or=(Z,se={})=>{je(i,Z)&&(fn(se.defaultValue)?Ce(Z,je(s,Z)):(Ce(Z,se.defaultValue),Gt(s,Z,se.defaultValue)),se.keepTouched||Bn(r.touchedFields,Z),se.keepDirty||(Bn(r.dirtyFields,Z),r.isDirty=se.defaultValue?xe(Z,je(s,Z)):xe()),se.keepError||(Bn(r.errors,Z),w.isValid&&B()),T.state.next({...r}))},Zr=(Z,se={})=>{const ge=Z?ds(Z):s,Ae=ds(ge),ke=Z&&!ti(Z)?Ae:s;if(se.keepDefaultValues||(s=ge),!se.keepValues){if(se.keepDirtyValues||I)for(const de of h.mount)je(r.dirtyFields,de)?Gt(ke,de,je(a,de)):Ce(de,je(ke,de));else{if(CE&&fn(Z))for(const de of h.mount){const o=je(i,de);if(o&&o._f){const l=Array.isArray(o._f.refs)?o._f.refs[0]:o._f.ref;if(Lg(l)){const c=l.closest("form");if(c){c.reset();break}}}}i={}}a=t.shouldUnregister?se.keepDefaultValues?ds(s):{}:ds(ke),T.array.next({values:{...ke}}),T.values.next({values:{...ke}})}h={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!u.mount&&e(),u.mount=!w.isValid||!!se.keepIsValid,u.watch=!!t.shouldUnregister,T.state.next({submitCount:se.keepSubmitCount?r.submitCount:0,isDirty:se.keepDirty?r.isDirty:!!(se.keepDefaultValues&&!Ea(Z,s)),isSubmitted:se.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:se.keepDirtyValues?r.dirtyFields:se.keepDefaultValues&&Z?g_(s,Z):{},touchedFields:se.keepTouched?r.touchedFields:{},errors:se.keepErrors?r.errors:{},isSubmitSuccessful:se.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},ei=(Z,se)=>Zr(ao(Z)?Z(a):Z,se);return{control:{register:kt,unregister:Cn,getFieldState:ot,handleSubmit:Qo,setError:Xe,_executeSchema:me,_getWatch:we,_getDirty:xe,_updateValid:B,_removeUnmounted:Ve,_updateFieldArray:J,_updateDisabledField:us,_getFieldArray:it,_reset:Zr,_resetDefaultValues:()=>ao(n.defaultValues)&&n.defaultValues().then(Z=>{ei(Z,n.resetOptions),T.state.next({isLoading:!1})}),_updateFormState:Z=>{r={...r,...Z}},_disableForm:Ot,_subjects:T,_proxyFormState:w,get _fields(){return i},get _formValues(){return a},get _state(){return u},set _state(Z){u=Z},get _defaultValues(){return s},get _names(){return h},set _names(Z){h=Z},get _formState(){return r},set _formState(Z){r=Z},get _options(){return n},set _options(Z){n={...n,...Z}}},trigger:Je,register:kt,handleSubmit:Qo,watch:dn,setValue:Ce,getValues:Tt,reset:ei,resetField:or,clearErrors:Ft,unregister:Cn,setError:Xe,setFocus:(Z,se={})=>{const ge=je(i,Z),Ae=ge&&ge._f;if(Ae){const ke=Ae.refs?Ae.refs[0]:Ae.ref;ke.focus&&(ke.focus(),se.shouldSelect&&ke.select())}},getFieldState:ot}}function il(t={}){const e=Ct.useRef(),n=Ct.useRef(),[r,i]=Ct.useState({isDirty:!1,isValidating:!1,isLoading:ao(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},disabled:!1,defaultValues:ao(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...K8(t,()=>i(a=>({...a}))),formState:r});const s=e.current.control;return s._options=t,L8({subject:s._subjects.state,next:a=>{M8(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),Ct.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),Ct.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==r.isDirty&&s._subjects.state.next({isDirty:a})}},[s,r.isDirty]),Ct.useEffect(()=>{t.values&&!Ea(t.values,n.current)?(s._reset(t.values,s._options.resetOptions),n.current=t.values):s._resetDefaultValues()},[t.values,s]),Ct.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=O8(r,s),e.current}const Q8=({setTab:t})=>{const e=nn(),n=G.useContext(gi),{handleSubmit:r,register:i,setError:s,formState:a}=il(),u=G.useCallback(async({email:h})=>{try{await jt.auth().sendPasswordResetEmail(h),t("signin"),n(e.formatMessage({id:"Reset password email sent"}))}catch(g){switch(g.code){case"auth/invalid-email":case"auth/user-not-found":case"auth/user-disabled":s("email",{type:"invalid",message:e.formatMessage({id:"Unknown email address"})});break;default:n(e.formatMessage({id:"An error occured, please retry later"},{email:h}))}}},[s,e,n,t]);return R.jsxs(fe,{as:"form",name:"reset",onSubmit:r(u),css:{gap:4},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:e.formatMessage({id:"Email address"})}),R.jsx(_n,{type:"email",...i("email",{required:e.formatMessage({id:"Email address is required"})})}),a.errors.email&&R.jsx(Or,{children:a.errors.email.message})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(gr,{type:"submit",disabled:a.isSubmitting,children:e.formatMessage({id:"Send the reset mail!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:()=>t("signin"),children:e.formatMessage({id:"Back"})})})]})]})},Y8=({onSignUp:t,setTab:e})=>{const n=nn(),{handleSubmit:r,register:i,watch:s,setError:a,formState:u}=il(),h=s("password"),g=G.useCallback(async({email:m,username:w,password:T})=>{try{const{user:I}=await jt.auth().createUserWithEmailAndPassword(m,T),j={username:w,signupDate:Date.now()};await jt.firestore().collection("users").doc(I.uid).set(j),t({uid:I.uid,...j,firebaseUser:I})}catch(I){switch(I.code){case"auth/weak-password":a("password",{type:"weakPassword",message:n.formatMessage({id:"Password is too weak"})});break;case"auth/email-already-in-use":a("email",{type:"alreadyExists",message:n.formatMessage({id:"Email address already in use"})});break;case"auth/invalid-email":a("email",{type:"invalid",message:n.formatMessage({id:"Invalid email address"})});break;default:return}}},[t,a,n]);return R.jsxs(fe,{as:"form",name:"signup",autoComplete:"off",onSubmit:r(g),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Username"})}),R.jsx(_n,{...i("username",{required:n.formatMessage({id:"Username is required"})})}),u.errors.username&&R.jsx(Or,{children:u.errors.username.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Email address"})}),R.jsx(_n,{type:"email",...i("email",{required:n.formatMessage({id:"Email address is required"})})}),u.errors.email&&R.jsx(Or,{children:u.errors.email.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(_n,{autoComplete:"new-password",type:"password",...i("password",{required:n.formatMessage({id:"Password is required"})})}),u.errors.password&&R.jsx(Or,{children:u.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Confirm password"})}),R.jsx(_n,{autoComplete:"off",type:"password",...i("passwordConfirm",{required:"Password is required",validate:m=>m===h||n.formatMessage({id:"Passwords must match"})})}),u.errors.passwordConfirm&&R.jsx(Or,{children:u.errors.passwordConfirm.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(gr,{disabled:u.isSubmitting,type:"submit",children:n.formatMessage({id:"Sign me up!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:()=>e("signin"),children:n.formatMessage({id:"I already have an account"})})})]})]})},X8=({onSignIn:t,setTab:e})=>{const n=nn(),{handleSubmit:r,register:i,setError:s,formState:a}=il(),u=G.useCallback(async({email:h,password:g})=>{try{const{user:m}=await jt.auth().signInWithEmailAndPassword(h,g),T=(await jt.firestore().collection("users").doc(m.uid).get()).data();t({uid:m.uid,...T,firebaseUser:m})}catch(m){switch(m.code){case"auth/invalid-email":case"auth/user-not-found":case"auth/user-disabled":s("email",{type:"invalid",message:n.formatMessage({id:"Unknown email address"})});break;case"auth/wrong-password":s("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:return}}},[t,s,n]);return R.jsxs(fe,{as:"form",name:"signin",onSubmit:r(u),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Email address"})}),R.jsx(_n,{type:"email",...i("email",{required:n.formatMessage({id:"Email address is required"})})}),a.errors.email&&R.jsx(Or,{children:a.errors.email.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(_n,{type:"password",...i("password",{required:n.formatMessage({id:"Password is required"})})}),a.errors.password&&R.jsx(Or,{children:a.errors.password.message}),R.jsx(bi,{css:{alignSelf:"flex-end",fontSize:2},onClick:()=>e("reset"),children:n.formatMessage({id:"Forgot password?"})})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(gr,{type:"submit",disabled:a.isSubmitting,children:n.formatMessage({id:"Sign me in!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:()=>e("signup"),children:n.formatMessage({id:"I don't have an account"})})})]})]})},J8=({deferred:t})=>{const e=nn(),n=G.useContext(gi),[r,i]=G.useState("signup"),s=a=>{t.resolve(a),n(e.formatMessage({id:"Logged in as {username}"},{username:a.username}))};return R.jsx(ls,{title:r==="signup"?R.jsx(Gr,{children:e.formatMessage({id:"Create your account"})}):r==="signin"?R.jsx(Gr,{children:e.formatMessage({id:"Connect to your account"})}):R.jsx(Gr,{children:e.formatMessage({id:"Reset your password"})}),onClose:()=>t.reject(gn),children:r==="signup"?R.jsx(Y8,{onSignUp:s,setTab:i}):r==="signin"?R.jsx(X8,{onSignIn:s,setTab:i}):R.jsx(Q8,{setTab:i})})},Z8={Amstangram:"Amstangram",Language:"Language",en:"English",fr:"French",Theme:"Theme","Logged in as {username}":"Logged in as {username}",Settings:"Settings",Difficulty:"Difficulty",Easy:"Easy",Hard:"Hard","Tangram approved":"Tangram approved","You can't save an invalid tangram":"You can't save an invalid tangram","You can't save such an easy tangram":"You can't save such an easy tangram","Tangram submitted for review":"Tangram submitted for review","Logged out":"Logged out","Tangram gallery":"Tangram gallery","All tangrams":"All tangrams","Uncompleted tangrams":"Uncompleted tangrams","â˜… Starred tangrams":"â˜… Starred tangrams","Pending approbation tangrams":"Pending approbation tangrams","You've completed all tangrams":"You've completed all tangrams","Come back later for more or create your own tangrams":"Come back later for more or create your own tangrams","No tangram left to approve":"No tangram left to approve","Good job moderator {username}!":"Good job moderator {username}!","All your tangrams have been approved":"All your tangrams have been approved","Create more tangrams and earn <starIcon></starIcon>":"Create more tangrams and earn <starIcon></starIcon>","No starred tangrams yet":"No starred tangrams yet","Press <starIcon></starIcon> to star a tangram and show your love":"Press <starIcon></starIcon> to star a tangram and show your love","Nothing to see here":"Nothing to see here","Something might have gone wrong":"Something might have gone wrong","Play now!":"Play now !","Start 1 tangram!":"Start 1 tangram !","Start {count} tangrams!":"Start {count} tangrams !","Password is too weak":"Password is too weak","Email address already in use":"Email address already in use","Invalid email address":"Invalid email address","Email address":"Email address","Email address is required":"Email address is required",Username:"Username","Username is required":"Username is required",Password:"Password","Password is required":"Password is required","Confirm password":"Confirm password","Passwords must match":"Passwords must match","Sign me up!":"Sign me up!","I already have an account":"I already have an account","Unknown email address":"Unknown email address","Incorrect password":"Incorrect password","Sign me in!":"Sign me in!","I don't have an account":"I don't have an account","Create your account":"Create your account","Connect to your account":"Connect to your account","A moderator will have to approve your tangram. It can be deleted or edited at any time.":"A moderator will have to approve your tangram.<br></br>It can be deleted or edited at any time.","Submit your tangram":"Submit your tangram","Edit your tangram":"Edit your tangram",Path:"Path","Invalid path":"Invalid path",Category:"Category","Victory emoji":"Victory emoji","Leave empty for random emoji":"Leave empty for random emoji",Order:"Order","Submit!":"Submit!","Edit!":"Edit!","Or delete tangram":"Or delete tangram",animals:"Animals",geometric:"Geometric",digits:"Digits",letters:"Alphabet",people:"People",stuff:"Stuff","Joined {signupDate}":"Joined {signupDate}","Log out":"Log out","Are you sure you want to log out?":"Are you sure you want to log out?","Change email address":"Change email address","Change username":"Change username","Change password":"Change password",Back:"Back","Confirm new password":"Confirm new password","New password":"New password","Current password":"Current password","Password changed successfuly":"Password changed successfuly","New username":"New username","Username updated successfuly":"Username updated successfuly","Email address updated successfuly":"Email address updated successfuly","New email address":"New email address","An error occured, please retry later":"An error occured, please retry later",Sounds:"Sounds","Are you sure you want to delete this tangram?":"Are you sure you want to delete this tangram?","Tangram deleted successfuly":"Tangram deleted successfuly","Tangram modified successfuly":"Tangram modified successfuly","Challenge link copied to clipboard":"Challenge link copied to clipboard","{username} challenged you":"{username} challenged you","Rise to the challenge":"Rise to the challenge","Let's go!":"Let's go!",Leaderboard:"Leaderboard","Completed {completed}/{total} tangrams":"Completed {completed}/{total} tangrams","Created {created} tangrams":"Created {created} tangrams","Earned {stars}":"Earned {stars} <starIcon></starIcon>","Stars earned":"Stars earned","Completed tangrams":"Completed tangrams","Created tangrams":"Created tangrams","Random tip":"Random tip","Got it!":"Got it!","Welcome to Amstangram":"Welcome to Amstangram","tips.welcome":"Reproduce the black shape by moving the pieces, you can rotate a piece by pressing it.<br></br><br></br>Have fun !","tips.menu":"You can access the tangram gallery {galleryIcon}, settings {settingsIcon} and more by pressing {menuIcon}","tips.account1":"You can create an account by pressing {accountIcon} in the menu {menuIcon}","tips.account2":"Signup in order to save your progression and create your very own tangrams","tips.gallery":"You can create your own tangram playlist by selecting tangrams in the gallery {galleryIcon}","tips.share":"You can share playlist with your friends by pressing {shareIcon} in the gallery {galleryIcon}","tips.create":"You can create your own tangrams by pressing {createIcon} in the menu {menuIcon}","tips.stars":"Did you liked this tangram?<br></br>Give a star to its creator by pressing {starIcon}","tips.difficulty":"Having it too easy?<br></br>You can change difficulty by pressing {settingsIcon} in the menu {menuIcon}","tips.theme":"Too bright for your eyes?<br></br>You can toggle dark mode by pressing {settingsIcon} in the menu {menuIcon}","tips.sound":"Too much noise?<br></br>You can disable sounds by pressing {settingsIcon} in the menu {menuIcon}","tips.card":"You can acces tangram details or edit your own tangrams by long pressing a card in the gallery {galleryIcon}","tips.leaderboard":"Check the leaderboard to see who's the best by pressing {leaderboardIcon} in the menu {menuIcon}","tips.particles":"Disable particle effects by pressing {settingsIcon} in the menu {menuIcon}. It can improve performances.","I don't want to see tips anymore":"I don't want to see tips anymore","Show tips":"Show tips","Show particles":"Show particles",Yes:"Yes",No:"No","Reset tips":"Reset tips","Tips reseted successfuly":"Tips reseted successfuly","Loading...":"Loading...",Approve:"Approve",Next:"Next",Quit:"Quit","See my profile":"See my profile","Log in":"Log in","Save tangram":"Save tangram","Contact ðŸ’Œ":"Contact ðŸ’Œ","A word about Amstangram":"A word about Amstangram","Version {code}":"Version {code}","Forgot password?":"Forgot password?","Reset your password":"Reset your password","Send the reset mail!":"Send the reset mail!","Reset password email sent":"Reset password email sent"},e$={Amstangram:"Amstangram",Language:"Langage",en:"Anglais",fr:"Francais",Theme:"ThÃ¨me","Logged in as {username}":"ConnectÃ© en tant que {username}",Settings:"RÃ©glages",Difficulty:"DifficultÃ©",Easy:"Facile",Hard:"Difficile","Tangram approved":"Tangram approuvÃ©","You can't save an invalid tangram":"Tangram invalide","You can't save such an easy tangram":"Tangram trop facile","Tangram submitted for review":"Tangram soumis pour vÃ©rification","Logged out":"DÃ©connectÃ©.e","Tangram gallery":"Galerie des tangrams","All tangrams":"Tous les tangrams","Uncompleted tangrams":"Tangrams non complÃ©tÃ©s","â˜… Starred tangrams":"Tangrams Ã©toilÃ©s â˜…","Pending approbation tangrams":"Tangrams en attente d'approbation","You've completed all tangrams":"Tu as complÃ©tÃ© tous les tangrams","Come back later for more or create your own tangrams":"Reviens plus tard ou crÃ©Ã©s tes propres tangrams","No tangram left to approve":"Il ne reste plus de tangram Ã  approuver","Good job moderator {username}!":"Bon boulot modÃ©rateur {username} !","All your tangrams have been approved":"Tous tes tangrams ont Ã©tÃ© approuvÃ©s","Create more tangrams and earn <starIcon></starIcon>":"CrÃ©Ã©s d'autres tangrams et gagne des <starIcon></starIcon>","No starred tangrams yet":"Tu n'as pas encore donnÃ© d'Ã©toile","Press <starIcon></starIcon> to star a tangram and show your love":"Appuie sur <starIcon></starIcon> pour donner une Ã©toile et montrer que tu aimes un tangram","Nothing to see here":"Rien Ã  voir","Something might have gone wrong":"Il semble y avoir un problÃ¨me","Play now!":"Commencer Ã  jouer !","Start 1 tangram!":"Lancer 1 tangram","Start {count} tangrams!":"Lancer {count} tangrams","Password is too weak":"Mot de passe trop faible","Email address already in use":"Adresse email dÃ©jÃ  prise","Invalid email address":"Adresse email invalide","Email address":"Adresse Email","Email address is required":"Adresse email requise",Username:"Nom d'utilisateur","Username is required":"Nom d'utilisateur requis",Password:"Mot de passe","Password is required":"Mot de passe requis","Confirm password":"Confirmer le mot de passe","Passwords must match":"Les mots de passe doivent correspondre","Sign me up!":"Je crÃ©Ã© mon compte !","I already have an account":"J'ai dÃ©jÃ  un compte","Unknown email address":"Adresse email inconnu","Incorrect password":"Mot de passe incorrect","Sign me in!":"Je me connecte !","I don't have an account":"Je n'ai pas de compte","Create your account":"CrÃ©er un compte","Connect to your account":"Se connecter","Submit your tangram":"Envoyer votre tangram","Edit your tangram":"Ã‰diter votre tangram",Category:"CatÃ©gorie",Path:"Chemin","Invalid path":"Chemin invalide","Victory emoji":"Emoji de succÃ¨s","Leave empty for random emoji":"Laisser vide pour un emoji au hasard",Order:"Ordre","A moderator will have to approve your tangram. It can be deleted or edited at any time.":"Un modÃ©rateur doit approuver votre tangram.<br></br>Il peut Ãªtre supprimÃ© ou modifiÃ© n'importe quand.","Submit!":"Envoyer !","Edit!":"Ã‰diter !","Or delete tangram":"Ou supprimer le tangram",animals:"Animaux",geometric:"GÃ©omÃ©trique",digits:"Chiffres",letters:"Alphabet",people:"Personnes",stuff:"Trucs","Joined {signupDate}":"Inscrit le {signupDate}","Log out":"Se dÃ©connecter","Are you sure you want to log out?":"Es-tu sÃ»r.e de vouloir te dÃ©connecter ?","Change email address":"Modifier l'adresse email","Change username":"Modifier le nom d'utilisateur","Change password":"Modifier le mot de passe",Back:"Retour","Confirm new password":"Confirmer le nouveau mot de passe","New password":"Nouveau mot de passe","Current password":"Mot de passe actuel","Password changed successfuly":"Mot de passe changÃ© avec succÃ©s","New username":"Nouveau nom d'utilisateur","Username updated successfuly":"Nom d'utilisateur changÃ© avec succÃ©s","Email address updated successfuly":"Adresse email changÃ© avec succÃ©s","New email address":"Nouvelle adresse email","An error occured, please retry later":"Une erreur est survenue, veuillez rÃ©essayer plus tard",Sounds:"Sons","Are you sure you want to delete this tangram?":"Es-tu sÃ»r.e de vouloir supprimer ce tangram ?","Tangram deleted successfuly":"Tangram supprimÃ© avec succÃ©s","Tangram modified successfuly":"Tangram modifiÃ© avec succÃ©s","Challenge link copied to clipboard":"Lien de dÃ©fi copiÃ© dans le presse papier","{username} challenged you":"{username} te met au dÃ©fi","Rise to the challenge":"Relevez le dÃ©fi","Let's go!":"C'est parti !",Leaderboard:"Classement","Completed {completed}/{total} tangrams":"{completed}/{total} tangrams complÃ©tÃ©s","Created {created} tangrams":"{created} tangrams crÃ©Ã©s","Earned {stars}":"{stars} <starIcon></starIcon> gagnÃ©es","Stars earned":"Ã‰toiles gagnÃ©es","Completed tangrams":"Tangrams complÃ©tÃ©s","Created tangrams":"Tangrams crÃ©Ã©s","Random tip":"Astuce","Got it!":"J'ai compris !","Welcome to Amstangram":"Bienvenue sur Amstangram","tips.welcome":"Reproduis la forme noire en dÃ©plaÃ§ant les piÃ¨ces, tu peux faire tourner une piÃ¨ce en appuyant dessus.<br></br><br></br>Amuse-toi bien !","tips.menu":"Tu peux accÃ©der Ã  la galerie des tangrams {galleryIcon}, aux rÃ©glages {settingsIcon} et plus encore en appuyant sur {menuIcon}","tips.account1":"CrÃ©er ton compte utilisateur en appuyant sur {accountIcon} dans le menu {menuIcon}","tips.account2":"CrÃ©er ton compte utilisateur pour sauvegarder ta progression crÃ©er tes propres tangrams","tips.gallery":"Tu peux crÃ©er ta propre playlist en sÃ©lectionnant les tangrams dans la galerie {galleryIcon}","tips.share":"Tu peux partager ta playlist avec tes amis en appuyant sur {shareIcon} dans la galerie {galleryIcon}","tips.create":"Tu peux crÃ©er tes propres tangrams en appuyant sur {createIcon} dans le menu {menuIcon}","tips.stars":"T'as aimÃ© ce tangram ?<br></br>Envoie une Ã©toile Ã  son crÃ©ateur en appuyant sur {starIcon}","tips.difficulty":"Trop facile pour toi ?<br></br>Essayes le mode difficile en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.theme":"Envie de passer du cÃ´tÃ© obscur ?<br></br>Tu peux activer le mode sombre en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.sound":"Trop de bruits ?<br></br>Tu peux dÃ©sactiver les sons en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.card":"Tu peux accÃ©der aux dÃ©tails d'un tangram ou mÃªme Ã©diter les tiens en faisant un appui long sur une carte dans la galerie {galleryIcon}","tips.leaderboard":"Jette un oeil au classement pour savoir qui est le meilleur en appuyant sur {leaderboardIcon} dans le menu {menuIcon}","tips.particles":"DÃ©sactive les effets de particule en appuyant sur {settingsIcon} dans le menu {menuIcon}. Cela peut amÃ©liorer les performances.","I don't want to see tips anymore":"Je ne veux plus voir les astuces","Show tips":"Afficher les astuces","Show particles":"Afficher les particles",Yes:"Oui",No:"Non","Reset tips":"RÃ©initialiser les astuces","Tips reseted successfuly":"Astuces rÃ©initilisÃ©es avec succÃ©s","Loading...":"Chargement...",Approve:"Approuver",Next:"Suivant",Quit:"Quitter","See my profile":"Voir mon profil","Log in":"Se connecter","Save tangram":"Sauvegarder le tangram","Contact ðŸ’Œ":"Contact ðŸ’Œ","A word about Amstangram":"Quelques mots Ã  propos d'Amstangram","Version {code}":"Version {code}","Forgot password?":"Mot de passe oubliÃ© ?","Reset your password":"RÃ©initialiser le mot de passe","Send the reset mail!":"Envoyer le mail de rÃ©initialisation","Reset password email sent":"Email de rÃ©initialisation envoyÃ©"},t$={en:Z8,fr:e$},RE="fr",Sy=["en","fr"],kE=G.createContext({language:RE,setLanguage:()=>{}}),n$=()=>{const t=localStorage.getItem("language");if(Sy.includes(t))return t;const e=navigator.languages;for(const n of e){const r=Sy.find(i=>n.includes(i));if(r)return r}return RE},r$=({children:t})=>{const[e,n]=G.useState(RE);G.useEffect(()=>{const i=n$();n(i)},[]);const r=G.useMemo(()=>({language:e,setLanguage:i=>{n(i),localStorage.setItem("language",i)}}),[e]);return R.jsx(xL,{locale:e,messages:t$[e],onError:console.warn,children:R.jsx(kE.Provider,{value:r,children:t})})},i$=({currentUser:t,onClose:e})=>{const n=nn(),{updateEmail:r}=G.useContext(Qn),i=G.useContext(gi),{handleSubmit:s,register:a,setError:u,formState:h}=il(),g=G.useCallback(async({password:m,newEmail:w})=>{try{await r(t,m,w),i(n.formatMessage({id:"Email address updated successfuly"})),e()}catch(T){switch(T.code){case"auth/email-already-in-use":u("newEmail",{type:"alreadyExists",message:n.formatMessage({id:"Email address already in use"})});break;case"auth/invalid-email":u("newEmail",{type:"invalid",message:n.formatMessage({id:"Invalid email address"})});break;case"auth/wrong-password":u("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:throw i(n.formatMessage({id:"An error occured, please retry later"})),T}}},[t,r,u,e,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(g),css:{flex:"1",gap:4},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(_n,{type:"password",...a("password",{required:n.formatMessage({id:"Password is required"})})}),h.errors.password&&R.jsx(Or,{children:h.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New email address"})}),R.jsx(_n,{type:"email",...a("newEmail",{required:n.formatMessage({id:"Email address is required"})})}),h.errors.newEmail&&R.jsx(Or,{children:h.errors.newEmail.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(gr,{disabled:h.isSubmitting,type:"submit",children:n.formatMessage({id:"Change email address"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},s$=({currentUser:t,onClose:e})=>{const n=nn(),{updateUsername:r}=G.useContext(Qn),i=G.useContext(gi),{handleSubmit:s,register:a,formState:u}=il(),h=G.useCallback(async({newUsername:g})=>{try{await r(t,g),i(n.formatMessage({id:"Username updated successfuly"})),e()}catch(m){throw i(n.formatMessage({id:"An error occured, please retry later"})),m}},[t,r,e,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(h),css:{flex:"1",gap:4},children:[R.jsx(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New username"})}),R.jsx(_n,{type:"text",...a("newUsername",{required:n.formatMessage({id:"Username is required"})})}),u.errors.newUsername&&R.jsx(Or,{children:u.errors.newUsername.message})]})}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(gr,{disabled:u.isSubmitting,type:"submit",children:n.formatMessage({id:"Change username"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},o$=({currentUser:t,onClose:e})=>{const n=nn(),{updateUsername:r}=G.useContext(Qn),i=G.useContext(gi),{handleSubmit:s,register:a,watch:u,setError:h,formState:g}=il(),m=u("newPassword"),w=G.useCallback(async({password:T,newPassword:I})=>{try{await r(t,T,I),i(n.formatMessage({id:"Password changed successfuly"})),e()}catch(j){switch(j.code){case"auth/weak-password":h("newPassword",{type:"weakPassword",message:n.formatMessage({id:"Password is too weak"})});break;case"auth/wrong-password":h("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:i(n.formatMessage({id:"An error occured, please retry later"}));return}}},[t,r,e,h,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(w),css:{flex:"1",gap:4},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Current password"})}),R.jsx(_n,{type:"password",...a("password",{required:n.formatMessage({id:"Password is required"})})}),g.errors.password&&R.jsx(Or,{children:g.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New password"})}),R.jsx(_n,{type:"password",autoComplete:"new-password",...a("newPassword",{required:n.formatMessage({id:"Password is required"})})}),g.errors.newPassword&&R.jsx(Or,{children:g.errors.newPassword.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Confirm new password"})}),R.jsx(_n,{type:"password",...a("newPasswordConfirm",{required:"Password is required",validate:T=>T===m||n.formatMessage({id:"Passwords must match"})})}),g.errors.newPasswordConfirm&&R.jsx(Or,{children:g.errors.newPasswordConfirm.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(gr,{disabled:g.isSubmitting,type:"submit",children:n.formatMessage({id:"Change password"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},a$=({uid:t,deferred:e})=>{const n=nn(),r=G.useContext(gi),{language:i}=G.useContext(kE),{currentUser:s,usersMetadata:a}=G.useContext(Qn),{username:u,signupDate:h}=a[t],[g,m]=G.useState(!1),[w,T]=G.useState(!1),[I,j]=G.useState(!1),{approvedTangrams:z}=G.useContext(Ko),{tangramsStarredBy:X,tangramsCompletedBy:V}=G.useContext(Fr),{stars:B,completed:U,created:J}=G.useMemo(()=>{let te=0,ae=0,ne=0;for(const me of z){if(me.uid===t){ae++;for(const pe in X[me.id])pe!==t&&X[me.id][pe]&&(te+=1)}for(const pe in V[me.id])pe===t&&(ne+=1)}return{stars:te,completed:ne,created:ae}},[z,V,X,t]),re=async()=>{window.confirm(n.formatMessage({id:"Are you sure you want to log out?"}))&&(await jt.auth().signOut(),e.reject(gn),r(n.formatMessage({id:"Logged out"})))};return R.jsx(ls,{onClose:()=>e.reject(gn),css:{overflow:"auto",pt:4,mt:-4,gap:3},children:g?R.jsx(i$,{currentUser:s,onClose:()=>m(!1)}):w?R.jsx(s$,{currentUser:s,onClose:()=>T(!1)}):I?R.jsx(o$,{currentUser:s,onClose:()=>j(!1)}):R.jsxs(fe,{css:{gap:4,mt:-4},children:[R.jsxs(fe,{css:{gap:3,alignItems:"center"},children:[R.jsx(cm,{uid:t,size:"badgeBig"}),R.jsx(Gr,{children:u}),R.jsxs(fe,{css:{gap:2,fontSize:2,alignItems:"center"},children:[s&&t===s.uid&&R.jsx(Ze,{children:s.firebaseUser.email}),R.jsx(Ze,{children:n.formatMessage({id:"Joined {signupDate}"},{signupDate:new Intl.DateTimeFormat(i).format(h)})}),R.jsx(Ze,{children:n.formatMessage({id:"Completed {completed}/{total} tangrams"},{completed:U,total:z.length})}),R.jsx(Ze,{children:n.formatMessage({id:"Created {created} tangrams"},{created:J})}),R.jsx(Ze,{children:R.jsx(xt,{id:"Earned {stars}",values:{stars:B,starIcon:()=>R.jsx(Cr,{icon:Mo,css:{fill:"currentColor"}})}})})]})]}),s&&s.uid===t&&R.jsxs(R.Fragment,{children:[R.jsxs(fe,{css:{gap:3,alignItems:"center"},children:[R.jsx(bi,{onClick:()=>m(!0),children:n.formatMessage({id:"Change email address"})}),R.jsx(bi,{onClick:()=>T(!0),children:n.formatMessage({id:"Change username"})}),R.jsx(bi,{onClick:()=>j(!0),children:n.formatMessage({id:"Change password"})})]}),R.jsx(w8,{onClick:re,children:n.formatMessage({id:"Log out"})})]})]})})},kS=["ðŸ’ª","ðŸ”¥","ðŸ˜±","ðŸ˜Ž","ðŸŽ‰","ðŸ¥‡","ðŸš€","ðŸ‘Œ","ðŸ‘","ðŸ˜µ"],NS=()=>kS[Math.floor(Math.random()*kS.length)];var Hk={exports:{}};const l$={},u$=Object.freeze(Object.defineProperty({__proto__:null,default:l$},Symbol.toStringTag,{value:"Module"})),DS=oN(u$);/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, JÃ¼rg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 JÃ¼rg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(t){(function(e,n){e=e||DS;var r=e.window,i=e.document,s=new function(){var o=/^(statics|enumerable|beans|preserve)$/,l=[],c=l.slice,d=Object.create,f=Object.getOwnPropertyDescriptor,p=Object.defineProperty,v=l.forEach||function(C,S){for(var k=0,M=this.length;k<M;k++)C.call(S,this[k],k,this)},_=function(C,S){for(var k in this)this.hasOwnProperty(k)&&C.call(S,this[k],k,this)},y=Object.assign||function(C){for(var S=1,k=arguments.length;S<k;S++){var M=arguments[S];for(var F in M)M.hasOwnProperty(F)&&(C[F]=M[F])}return C},E=function(C,S,k){if(C){var M=f(C,"length");(M&&typeof M.value=="number"?v:_).call(C,S,k=k||C)}return k};function A(C,S,k,M,F){var N={};function D($,q){q=q||(q=f(S,$))&&(q.get?q:q.value),typeof q=="string"&&q[0]==="#"&&(q=C[q.substring(1)]||q);var H=typeof q=="function",W=q,Q=F||H&&!q.base?q&&q.get?$ in C:C[$]:null,K;(!F||!Q)&&(H&&Q&&(q.base=Q),H&&M!==!1&&(K=$.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(N[K[3].toLowerCase()+K[4]]=K[2]),(!W||H||!W.get||typeof W.get!="function"||!b.isPlainObject(W))&&(W={value:W,writable:!0}),(f(C,$)||{configurable:!0}).configurable&&(W.configurable=!0,W.enumerable=k??!K),p(C,$,W))}if(S){for(var x in S)S.hasOwnProperty(x)&&!o.test(x)&&D(x);for(var x in N){var P=N[x],O=C["set"+P],L=C["get"+P]||O&&C["is"+P];L&&(M===!0||L.length===0)&&D(x,{get:L,set:O})}}return C}function b(){for(var C=0,S=arguments.length;C<S;C++){var k=arguments[C];k&&y(this,k)}return this}return A(b,{inject:function(C){if(C){var S=C.statics===!0?C:C.statics,k=C.beans,M=C.preserve;S!==C&&A(this.prototype,C,C.enumerable,k,M),A(this,S,null,k,M)}for(var F=1,N=arguments.length;F<N;F++)this.inject(arguments[F]);return this},extend:function(){for(var C=this,S,k,M=0,F,N=arguments.length;M<N&&!(S&&k);M++)F=arguments[M],S=S||F.initialize,k=k||F.prototype;return S=S||function(){C.apply(this,arguments)},k=S.prototype=k||d(this.prototype),p(k,"constructor",{value:S,writable:!0,configurable:!0}),A(S,this),arguments.length&&this.inject.apply(S,arguments),S.base=C,S}}).inject({enumerable:!1,initialize:b,set:b,inject:function(){for(var C=0,S=arguments.length;C<S;C++){var k=arguments[C];k&&A(this,k,k.enumerable,k.beans,k.preserve)}return this},extend:function(){var C=d(this);return C.inject.apply(C,arguments)},each:function(C,S){return E(this,C,S)},clone:function(){return new this.constructor(this)},statics:{set:y,each:E,create:d,define:p,describe:f,clone:function(C){return y(new C.constructor,C)},isPlainObject:function(C){var S=C!=null&&C.constructor;return S&&(S===Object||S===b||S.name==="Object")},pick:function(C,S){return C!==n?C:S},slice:function(C,S,k){return c.call(C,S,k)}}})};t.exports=s,s.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+s.each(this,function(o,l){if(!/^_/.test(l)){var c=typeof o;this.push(l+": "+(c==="number"?m.instance.number(o):c==="string"?"'"+o+"'":o))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(o){return s.importJSON(o,this)},exportJSON:function(o){return s.exportJSON(this,o)},toJSON:function(){return s.serialize(this)},set:function(o,l){return o&&s.filter(this,o,l,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function o(){var l=o.base.apply(this,arguments),c=l.prototype._class;return c&&!s.exports[c]&&(s.exports[c]=l),l},equals:function(o,l){if(o===l)return!0;if(o&&o.equals)return o.equals(l);if(l&&l.equals)return l.equals(o);if(o&&l&&typeof o=="object"&&typeof l=="object"){if(Array.isArray(o)&&Array.isArray(l)){var c=o.length;if(c!==l.length)return!1;for(;c--;)if(!s.equals(o[c],l[c]))return!1}else{var d=Object.keys(o),c=d.length;if(c!==Object.keys(l).length)return!1;for(;c--;){var f=d[c];if(!(l.hasOwnProperty(f)&&s.equals(o[f],l[f])))return!1}}return!0}return!1},read:function(o,l,c,d){if(this===s){var f=this.peek(o,l);return o.__index++,f}var p=this.prototype,v=p._readIndex,_=l||v&&o.__index||0,y=o.length,E=o[_];if(d=d||y-_,E instanceof this||c&&c.readNull&&E==null&&d<=1)return v&&(o.__index=_+1),E&&c&&c.clone?E.clone():E;if(E=s.create(p),v&&(E.__read=!0),E=E.initialize.apply(E,_>0||_+d<y?s.slice(o,_,_+d):o)||E,v){o.__index=_+E.__read;var A=E.__filtered;A&&(o.__filtered=A,E.__filtered=n),E.__read=n}return E},peek:function(o,l){return o[o.__index=l||o.__index||0]},remain:function(o){return o.length-(o.__index||0)},readList:function(o,l,c,d){for(var f=[],p,v=l||0,_=d?v+d:o.length,y=v;y<_;y++)f.push(Array.isArray(p=o[y])?this.read(p,0,c):this.read(o,y,c,1));return f},readNamed:function(o,l,c,d,f){var p=this.getNamed(o,l),v=p!==n;if(v){var _=o.__filtered;if(!_){var y=this.getSource(o);_=o.__filtered=s.create(y),_.__unfiltered=y}_[l]=n}return this.read(v?[p]:o,c,d,f)},readSupported:function(o,l){var c=this.getSource(o),d=this,f=!1;return c&&Object.keys(c).forEach(function(p){if(p in l){var v=d.readNamed(o,p);v!==n&&(l[p]=v),f=!0}}),f},getSource:function(o){var l=o.__source;if(l===n){var c=o.length===1&&o[0];l=o.__source=c&&s.isPlainObject(c)?c:null}return l},getNamed:function(o,l){var c=this.getSource(o);if(c)return l?c[l]:o.__filtered||c},hasNamed:function(o,l){return!!this.getNamed(o,l)},filter:function(o,l,c,d){var f;function p(A){if(!(c&&A in c)&&!(f&&A in f)){var b=l[A];b!==n&&(o[A]=b)}}if(d){for(var v={},_=0,y,E=d.length;_<E;_++)(y=d[_])in l&&(p(y),v[y]=!0);f=v}return Object.keys(l.__unfiltered||l).forEach(p),o},isPlainValue:function(o,l){return s.isPlainObject(o)||Array.isArray(o)||l&&typeof o=="string"},serialize:function(o,l,c,d){l=l||{};var f=!d,p;if(f&&(l.formatter=new m(l.precision),d={length:0,definitions:{},references:{},add:function(b,C){var S="#"+b._id,k=this.references[S];if(!k){this.length++;var M=C.call(b),F=b._class;F&&M[0]!==F&&M.unshift(F),this.definitions[S]=M,k=this.references[S]=[S]}return k}}),o&&o._serialize){p=o._serialize(l,d);var v=o._class;v&&!o._compactSerialize&&(f||!c)&&p[0]!==v&&p.unshift(v)}else if(Array.isArray(o)){p=[];for(var _=0,y=o.length;_<y;_++)p[_]=s.serialize(o[_],l,c,d)}else if(s.isPlainObject(o)){p={};for(var E=Object.keys(o),_=0,y=E.length;_<y;_++){var A=E[_];p[A]=s.serialize(o[A],l,c,d)}}else typeof o=="number"?p=l.formatter.number(o,l.precision):p=o;return f&&d.length>0?[["dictionary",d.definitions],p]:p},deserialize:function(o,l,c,d,f){var p=o,v=!c,_=v&&o&&o.length&&o[0][0]==="dictionary";if(c=c||{},Array.isArray(o)){var y=o[0],E=y==="dictionary";if(o.length==1&&/^#/.test(y))return c.dictionary[y];y=s.exports[y],p=[];for(var A=y?1:0,b=o.length;A<b;A++)p.push(s.deserialize(o[A],l,c,E,_));if(y){var C=p;l?p=l(y,C,v||f):p=new y(C)}}else if(s.isPlainObject(o)){p={},d&&(c.dictionary=p);for(var S in o)p[S]=s.deserialize(o[S],l,c)}return _?p[1]:p},exportJSON:function(o,l){var c=s.serialize(o,l);return l&&l.asString==!1?c:JSON.stringify(c)},importJSON:function(o,l){return s.deserialize(typeof o=="string"?JSON.parse(o):o,function(c,d,f){var p=f&&l&&l.constructor===c,v=p?l:s.create(c.prototype);if(d.length===1&&v instanceof te&&(p||!(v instanceof ne))){var _=d[0];s.isPlainObject(_)&&(_.insert=!1,p&&(d=d.concat([te.INSERT])))}return(p?v.set:c).apply(v,d),p&&(l=null),v})},push:function(o,l){var c=l.length;if(c<4096)o.push.apply(o,l);else{var d=o.length;o.length+=c;for(var f=0;f<c;f++)o[d+f]=l[f]}return o},splice:function(o,l,c,d){var f=l&&l.length,p=c===n;c=p?o.length:c,c>o.length&&(c=o.length);for(var v=0;v<f;v++)l[v]._index=c+v;if(p)return s.push(o,l),[];var _=[c,d];l&&s.push(_,l);for(var y=o.splice.apply(o,_),v=0,E=y.length;v<E;v++)y[v]._index=n;for(var v=c+f,E=o.length;v<E;v++)o[v]._index=v;return y},capitalize:function(o){return o.replace(/\b[a-z]/g,function(l){return l.toUpperCase()})},camelize:function(o){return o.replace(/-(.)/g,function(l,c){return c.toUpperCase()})},hyphenate:function(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function(o,l){if(typeof o!="string")s.each(o,function(p,v){this.on(v,p)},this);else{var c=this._eventTypes,d=c&&c[o],f=this._callbacks=this._callbacks||{};f=f[o]=f[o]||[],f.indexOf(l)===-1&&(f.push(l),d&&d.install&&f.length===1&&d.install.call(this,o))}return this},off:function(o,l){if(typeof o!="string"){s.each(o,function(v,_){this.off(_,v)},this);return}var c=this._eventTypes,d=c&&c[o],f=this._callbacks&&this._callbacks[o],p;return f&&(!l||(p=f.indexOf(l))!==-1&&f.length===1?(d&&d.uninstall&&d.uninstall.call(this,o),delete this._callbacks[o]):p!==-1&&f.splice(p,1)),this},once:function(o,l){return this.on(o,function c(){l.apply(this,arguments),this.off(o,c)})},emit:function(o,l){var c=this._callbacks&&this._callbacks[o];if(!c)return!1;var d=s.slice(arguments,1),f=l&&l.target&&!l.currentTarget;c=c.slice(),f&&(l.currentTarget=this);for(var p=0,v=c.length;p<v;p++)if(c[p].apply(this,d)==!1){l&&l.stop&&l.stop();break}return f&&delete l.currentTarget,!0},responds:function(o){return!!(this._callbacks&&this._callbacks[o])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(o){var l=this._eventTypes,c=this._callbacks,d=o?"install":"uninstall";if(l){for(var f in c)if(c[f].length>0){var p=l[f],v=p&&p[d];v&&v.call(this,f)}}},statics:{inject:function o(l){var c=l._events;if(c){var d={};s.each(c,function(f,p){var v=typeof f=="string",_=v?f:p,y=s.capitalize(_),E=_.substring(2).toLowerCase();d[E]=v?{}:f,_="_"+_,l["get"+y]=function(){return this[_]},l["set"+y]=function(A){var b=this[_];b&&this.off(E,b),A&&this.on(E,A),this[_]=A}}),l._eventTypes=d}return o.base.apply(this,arguments)}}},u=s.extend({_class:"PaperScope",initialize:function o(){de=this,this.settings=new s({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=o._id++,o._scopes[this._id]=this;var l=o.prototype;if(!this.support){var c=se.getContext(1,1)||{};l.support={nativeDash:"setLineDash"in c||"mozDash"in c,nativeBlendModes:ge.nativeModes},se.release(c)}if(!this.agent){var d=e.navigator.userAgent.toLowerCase(),f=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(d)||[])[0],p=f==="darwin"?"mac":f,v=l.agent=l.browser={platform:p};p&&(v[p]=!0),d.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(_,y,E,A,b){if(!v.chrome){var C=y==="opera"?A:/^(node|trident)$/.test(y)?b:E;v.version=C,v.versionNumber=parseFloat(C),y={trident:"msie",jsdom:"node"}[y]||y,v.name=y,v[y]=!0}}),v.chrome&&delete v.webkit,v.atom&&delete v.chrome}},version:"0.12.17",getView:function(){var o=this.project;return o&&o._view},getPaper:function(){return this},execute:function(o,l){},install:function(o){var l=this;s.each(["project","view","tool"],function(d){s.define(o,d,{configurable:!0,get:function(){return l[d]}})});for(var c in this)!/^_/.test(c)&&this[c]&&(o[c]=this[c])},setup:function(o){return de=this,this.project=new re(o),this},createCanvas:function(o,l){return se.getCanvas(o,l)},activate:function(){de=this},clear:function(){for(var o=this.projects,l=this.tools,c=o.length-1;c>=0;c--)o[c].remove();for(var c=l.length-1;c>=0;c--)l[c].remove()},remove:function(){this.clear(),delete u._scopes[this._id]},statics:new function(){function o(l){return l+="Attribute",function(c,d){return c[l](d)||c[l]("data-paper-"+d)}}return{_scopes:{},_id:0,get:function(l){return this._scopes[l]||null},getAttribute:o("get"),hasAttribute:o("has")}}}),h=s.extend(a,{initialize:function(o){this._scope=de,this._index=this._scope[this._list].push(this)-1,(o||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var o=this._scope[this._reference];return o&&o!==this&&o.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",o),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(s.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),g={findItemBoundsCollisions:function(o,l,c){function d(v){for(var _=new Array(v.length),y=0;y<v.length;y++){var E=v[y].getBounds();_[y]=[E.left,E.top,E.right,E.bottom]}return _}var f=d(o),p=!l||l===o?f:d(l);return this.findBoundsCollisions(f,p,c||0)},findCurveBoundsCollisions:function(o,l,c,d){function f(C){for(var S=Math.min,k=Math.max,M=new Array(C.length),F=0;F<C.length;F++){var N=C[F];M[F]=[S(N[0],N[2],N[4],N[6]),S(N[1],N[3],N[5],N[7]),k(N[0],N[2],N[4],N[6]),k(N[1],N[3],N[5],N[7])]}return M}var p=f(o),v=!l||l===o?p:f(l);if(d){for(var _=this.findBoundsCollisions(p,v,c||0,!1,!0),y=this.findBoundsCollisions(p,v,c||0,!0,!0),E=[],A=0,b=_.length;A<b;A++)E[A]={hor:_[A],ver:y[A]};return E}return this.findBoundsCollisions(p,v,c||0)},findBoundsCollisions:function(o,l,c,d,f){var p=!l||o===l,v=p?o:o.concat(l),_=o.length,y=v.length;function E(Se,Re,Ye){for(var He=0,qe=Se.length;He<qe;){var $e=qe+He>>>1;v[Se[$e]][Re]<Ye?He=$e+1:qe=$e}return He-1}for(var A=d?1:0,b=A+2,C=d?0:1,S=C+2,k=new Array(y),M=0;M<y;M++)k[M]=M;k.sort(function(Se,Re){return v[Se][A]-v[Re][A]});for(var F=[],N=new Array(_),M=0;M<y;M++){var D=k[M],x=v[D],P=p?D:D-_,O=D<_,L=p||!O,$=O?[]:null;if(F.length){var q=E(F,b,x[A]-c)+1;if(F.splice(0,q),p&&f){$=$.concat(F);for(var H=0;H<F.length;H++){var W=F[H];N[W].push(P)}}else for(var Q=x[S],K=x[C],H=0;H<F.length;H++){var W=F[H],Y=v[W],ee=W<_,ie=p||W>=_;(f||(O&&ie||L&&ee)&&Q>=Y[C]-c&&K<=Y[S]+c)&&(O&&ie&&$.push(p?W:W-_),L&&ee&&N[W].push(P))}}if(O&&(o===l&&$.push(D),N[D]=$),F.length){var le=x[b],ue=E(F,b,le);F.splice(ue+1,0,D)}else F.push(D)}for(var M=0;M<N.length;M++){var Ee=N[M];Ee&&Ee.sort(function(Re,Ye){return Re-Ye})}return N}},m=s.extend({initialize:function(o){this.precision=s.pick(o,5),this.multiplier=Math.pow(10,this.precision)},number:function(o){return this.precision<16?Math.round(o*this.multiplier)/this.multiplier:o},pair:function(o,l,c){return this.number(o)+(c||",")+this.number(l)},point:function(o,l){return this.number(o.x)+(l||",")+this.number(o.y)},size:function(o,l){return this.number(o.width)+(l||",")+this.number(o.height)},rectangle:function(o,l){return this.point(o,l)+(l||",")+this.size(o,l)}});m.instance=new m;var w=new function(){var o=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],l=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],c=Math.abs,d=Math.sqrt,f=Math.pow,p=Math.log2||function(b){return Math.log(b)*Math.LOG2E},v=1e-12,_=112e-18;function y(b,C,S){return b<C?C:b>S?S:b}function E(b,C,S){function k(q){var H=q*134217729,W=q-H,Q=W+H,K=q-Q;return[Q,K]}var M=C*C-b*S,F=C*C+b*S;if(c(M)*3<F){var N=k(b),D=k(C),x=k(S),P=C*C,O=D[0]*D[0]-P+2*D[0]*D[1]+D[1]*D[1],L=b*S,$=N[0]*x[0]-L+N[0]*x[1]+N[1]*x[0]+N[1]*x[1];M=P-L+(O-$)}return M}function A(){var b=Math.max.apply(Math,arguments);return b&&(b<1e-8||b>1e8)?f(2,-Math.round(p(b))):0}return{EPSILON:v,MACHINE_EPSILON:_,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(d(2)-1)/3,isZero:function(b){return b>=-v&&b<=v},isMachineZero:function(b){return b>=-_&&b<=_},clamp:y,integrate:function(b,C,S,k){for(var M=o[k-2],F=l[k-2],N=(S-C)*.5,D=N+C,x=0,P=k+1>>1,O=k&1?F[x++]*b(D):0;x<P;){var L=N*M[x];O+=F[x++]*(b(D+L)+b(D-L))}return N*O},findRoot:function(b,C,S,k,M,F,N){for(var D=0;D<F;D++){var x=b(S),P=x/C(S),O=S-P;if(c(P)<N){S=O;break}x>0?(M=S,S=O<=k?(k+M)*.5:O):(k=S,S=O>=M?(k+M)*.5:O)}return y(S,k,M)},solveQuadratic:function(b,C,S,k,M,F){var N,D=1/0;if(c(b)<v){if(c(C)<v)return c(S)<v?-1:0;N=-S/C}else{C*=-.5;var x=E(b,C,S);if(x&&c(x)<_){var P=A(c(b),c(C),c(S));P&&(b*=P,C*=P,S*=P,x=E(b,C,S))}if(x>=-_){var O=x<0?0:d(x),L=C+(C<0?-O:O);L===0?(N=S/b,D=-N):(N=L/b,D=S/L)}}var $=0,q=M==null,H=M-v,W=F+v;return isFinite(N)&&(q||N>H&&N<W)&&(k[$++]=q?N:y(N,M,F)),D!==N&&isFinite(D)&&(q||D>H&&D<W)&&(k[$++]=q?D:y(D,M,F)),$},solveCubic:function(b,C,S,k,M,F,N){var D=A(c(b),c(C),c(S),c(k)),x,P,O,L,$;D&&(b*=D,C*=D,S*=D,k*=D);function q(ue){x=ue;var Ee=b*x;P=Ee+C,O=P*x+S,L=(Ee+P)*x+O,$=O*x+k}if(c(b)<v)b=C,P=S,O=k,x=1/0;else if(c(k)<v)P=C,O=S,x=0;else{q(-(C/b)/3);var H=$/b,W=f(c(H),1/3),Q=H<0?-1:1,K=-L/b,Y=K>0?1.324717957244746*Math.max(W,d(K)):W,ee=x-Q*Y;if(ee!==x){do q(ee),ee=L===0?x:x-$/L/(1+_);while(Q*ee>Q*x);c(b)*x*x>c(k/x)&&(O=-k/x,P=(O-S)/x)}}var ie=w.solveQuadratic(b,P,O,M,F,N),le=F==null;return isFinite(x)&&(ie===0||ie>0&&x!==M[0]&&x!==M[1])&&(le||x>F-v&&x<N+v)&&(M[ie++]=le?x:y(x,F,N)),ie}}},T={_id:1,_pools:{},get:function(o){if(o){var l=this._pools[o];return l||(l=this._pools[o]={_id:1}),l._id++}else return this._id++}},I=s.extend({_class:"Point",_readIndex:!0,initialize:function(l,c){var d=typeof l,f=this.__read,p=0;if(d==="number"){var v=typeof c=="number";this._set(l,v?c:l),f&&(p=v?2:1)}else if(d==="undefined"||l===null)this._set(0,0),f&&(p=l===null?1:0);else{var _=d==="string"?l.split(/[\s,]+/)||[]:l;p=1,Array.isArray(_)?this._set(+_[0],+(_.length>1?_[1]:_[0])):"x"in _?this._set(_.x||0,_.y||0):"width"in _?this._set(_.width||0,_.height||0):"angle"in _?(this._set(_.length||0,0),this.setAngle(_.angle||0)):(this._set(0,0),p=0)}return f&&(this.__read=p),this},set:"#initialize",_set:function(o,l){return this.x=o,this.y=l,this},equals:function(o){return this===o||o&&(this.x===o.x&&this.y===o.y||Array.isArray(o)&&this.x===o[0]&&this.y===o[1])||!1},clone:function(){return new I(this.x,this.y)},toString:function(){var o=m.instance;return"{ x: "+o.number(this.x)+", y: "+o.number(this.y)+" }"},_serialize:function(o){var l=o.formatter;return[l.number(this.x),l.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(o){if(this.isZero()){var l=this._angle||0;this._set(Math.cos(l)*o,Math.sin(l)*o)}else{var c=o/this.getLength();w.isZero(c)&&this.getAngle(),this._set(this.x*c,this.y*c)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(o){this.setAngleInRadians.call(this,o*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var o=I.read(arguments),l=this.getLength()*o.getLength();if(w.isZero(l))return NaN;var c=this.dot(o)/l;return Math.acos(c<-1?-1:c>1?1:c)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(o){if(this._angle=o,!this.isZero()){var l=this.getLength();this._set(Math.cos(o)*l,Math.sin(o)*l)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var o=I.read(arguments);return Math.atan2(this.cross(o),this.dot(o))*180/Math.PI},getDistance:function(){var o=arguments,l=I.read(o),c=l.x-this.x,d=l.y-this.y,f=c*c+d*d,p=s.read(o);return p?f:Math.sqrt(f)},normalize:function(o){o===n&&(o=1);var l=this.getLength(),c=l!==0?o/l:0,d=new I(this.x*c,this.y*c);return c>=0&&(d._angle=this._angle),d},rotate:function(o,l){if(o===0)return this.clone();o=o*Math.PI/180;var c=l?this.subtract(l):this,d=Math.sin(o),f=Math.cos(o);return c=new I(c.x*f-c.y*d,c.x*d+c.y*f),l?c.add(l):c},transform:function(o){return o?o._transformPoint(this):this},add:function(){var o=I.read(arguments);return new I(this.x+o.x,this.y+o.y)},subtract:function(){var o=I.read(arguments);return new I(this.x-o.x,this.y-o.y)},multiply:function(){var o=I.read(arguments);return new I(this.x*o.x,this.y*o.y)},divide:function(){var o=I.read(arguments);return new I(this.x/o.x,this.y/o.y)},modulo:function(){var o=I.read(arguments);return new I(this.x%o.x,this.y%o.y)},negate:function(){return new I(-this.x,-this.y)},isInside:function(){return V.read(arguments).contains(this)},isClose:function(){var o=arguments,l=I.read(o),c=s.read(o);return this.getDistance(l)<=c},isCollinear:function(){var o=I.read(arguments);return I.isCollinear(this.x,this.y,o.x,o.y)},isColinear:"#isCollinear",isOrthogonal:function(){var o=I.read(arguments);return I.isOrthogonal(this.x,this.y,o.x,o.y)},isZero:function(){var o=w.isZero;return o(this.x)&&o(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(o){return this.x*(o>1&&o<4?-1:1)>=0&&this.y*(o>2?-1:1)>=0},dot:function(){var o=I.read(arguments);return this.x*o.x+this.y*o.y},cross:function(){var o=I.read(arguments);return this.x*o.y-this.y*o.x},project:function(){var o=I.read(arguments),l=o.isZero()?0:this.dot(o)/o.dot(o);return new I(o.x*l,o.y*l)},statics:{min:function(){var o=arguments,l=I.read(o),c=I.read(o);return new I(Math.min(l.x,c.x),Math.min(l.y,c.y))},max:function(){var o=arguments,l=I.read(o),c=I.read(o);return new I(Math.max(l.x,c.x),Math.max(l.y,c.y))},random:function(){return new I(Math.random(),Math.random())},isCollinear:function(o,l,c,d){return Math.abs(o*d-l*c)<=Math.sqrt((o*o+l*l)*(c*c+d*d))*1e-8},isOrthogonal:function(o,l,c,d){return Math.abs(o*c+l*d)<=Math.sqrt((o*o+l*l)*(c*c+d*d))*1e-8}}},s.each(["round","ceil","floor","abs"],function(o){var l=Math[o];this[o]=function(){return new I(l(this.x),l(this.y))}},{})),j=I.extend({initialize:function(l,c,d,f){this._x=l,this._y=c,this._owner=d,this._setter=f},_set:function(o,l,c){return this._x=o,this._y=l,c||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(o){this._x=o,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(o){this._y=o,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(o){this._owner._changeSelection(this._getSelection(),o)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),z=s.extend({_class:"Size",_readIndex:!0,initialize:function(l,c){var d=typeof l,f=this.__read,p=0;if(d==="number"){var v=typeof c=="number";this._set(l,v?c:l),f&&(p=v?2:1)}else if(d==="undefined"||l===null)this._set(0,0),f&&(p=l===null?1:0);else{var _=d==="string"?l.split(/[\s,]+/)||[]:l;p=1,Array.isArray(_)?this._set(+_[0],+(_.length>1?_[1]:_[0])):"width"in _?this._set(_.width||0,_.height||0):"x"in _?this._set(_.x||0,_.y||0):(this._set(0,0),p=0)}return f&&(this.__read=p),this},set:"#initialize",_set:function(o,l){return this.width=o,this.height=l,this},equals:function(o){return o===this||o&&(this.width===o.width&&this.height===o.height||Array.isArray(o)&&this.width===o[0]&&this.height===o[1])||!1},clone:function(){return new z(this.width,this.height)},toString:function(){var o=m.instance;return"{ width: "+o.number(this.width)+", height: "+o.number(this.height)+" }"},_serialize:function(o){var l=o.formatter;return[l.number(this.width),l.number(this.height)]},add:function(){var o=z.read(arguments);return new z(this.width+o.width,this.height+o.height)},subtract:function(){var o=z.read(arguments);return new z(this.width-o.width,this.height-o.height)},multiply:function(){var o=z.read(arguments);return new z(this.width*o.width,this.height*o.height)},divide:function(){var o=z.read(arguments);return new z(this.width/o.width,this.height/o.height)},modulo:function(){var o=z.read(arguments);return new z(this.width%o.width,this.height%o.height)},negate:function(){return new z(-this.width,-this.height)},isZero:function(){var o=w.isZero;return o(this.width)&&o(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(o,l){return new z(Math.min(o.width,l.width),Math.min(o.height,l.height))},max:function(o,l){return new z(Math.max(o.width,l.width),Math.max(o.height,l.height))},random:function(){return new z(Math.random(),Math.random())}}},s.each(["round","ceil","floor","abs"],function(o){var l=Math[o];this[o]=function(){return new z(l(this.width),l(this.height))}},{})),X=z.extend({initialize:function(l,c,d,f){this._width=l,this._height=c,this._owner=d,this._setter=f},_set:function(o,l,c){return this._width=o,this._height=l,c||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(o){this._width=o,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(o){this._height=o,this._owner[this._setter](this)}}),V=s.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(l,c,d,f){var p=arguments,v=typeof l,_;if(v==="number"?(this._set(l,c,d,f),_=4):v==="undefined"||l===null?(this._set(0,0,0,0),_=l===null?1:0):p.length===1&&(Array.isArray(l)?(this._set.apply(this,l),_=1):l.x!==n||l.width!==n?(this._set(l.x||0,l.y||0,l.width||0,l.height||0),_=1):l.from===n&&l.to===n&&(this._set(0,0,0,0),s.readSupported(p,this)&&(_=1))),_===n){var y=I.readNamed(p,"from"),E=s.peek(p),A=y.x,b=y.y,C,S;if(E&&E.x!==n||s.hasNamed(p,"to")){var k=I.readNamed(p,"to");C=k.x-A,S=k.y-b,C<0&&(A=k.x,C=-C),S<0&&(b=k.y,S=-S)}else{var M=z.read(p);C=M.width,S=M.height}this._set(A,b,C,S),_=p.__index}var F=p.__filtered;return F&&(this.__filtered=F),this.__read&&(this.__read=_),this},set:"#initialize",_set:function(o,l,c,d){return this.x=o,this.y=l,this.width=c,this.height=d,this},clone:function(){return new V(this.x,this.y,this.width,this.height)},equals:function(o){var l=s.isPlainValue(o)?V.read(arguments):o;return l===this||l&&this.x===l.x&&this.y===l.y&&this.width===l.width&&this.height===l.height||!1},toString:function(){var o=m.instance;return"{ x: "+o.number(this.x)+", y: "+o.number(this.y)+", width: "+o.number(this.width)+", height: "+o.number(this.height)+" }"},_serialize:function(o){var l=o.formatter;return[l.number(this.x),l.number(this.y),l.number(this.width),l.number(this.height)]},getPoint:function(o){var l=o?I:j;return new l(this.x,this.y,this,"setPoint")},setPoint:function(){var o=I.read(arguments);this.x=o.x,this.y=o.y},getSize:function(o){var l=o?z:X;return new l(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var o=z.read(arguments),l=this._sx,c=this._sy,d=o.width,f=o.height;l&&(this.x+=(this.width-d)*l),c&&(this.y+=(this.height-f)*c),this.width=d,this.height=f,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(o){if(!this._fw){var l=o-this.x;this.width-=this._sx===.5?l*2:l}this.x=o,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(o){if(!this._fh){var l=o-this.y;this.height-=this._sy===.5?l*2:l}this.y=o,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(o){if(!this._fw){var l=o-this.x;this.width=this._sx===.5?l*2:l}this.x=o-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(o){if(!this._fh){var l=o-this.y;this.height=this._sy===.5?l*2:l}this.y=o-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(o){this._fw||this._sx===.5?this.x=o-this.width/2:(this._sx&&(this.x+=(o-this.x)*2*this._sx),this.width=(o-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(o){this._fh||this._sy===.5?this.y=o-this.height/2:(this._sy&&(this.y+=(o-this.y)*2*this._sy),this.height=(o-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(o){var l=o?I:j;return new l(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var o=I.read(arguments);return this.setCenterX(o.x),this.setCenterY(o.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(o){return o&&o.width!==n||(Array.isArray(o)?o:arguments).length===4?this._containsRectangle(V.read(arguments)):this._containsPoint(I.read(arguments))},_containsPoint:function(o){var l=o.x,c=o.y;return l>=this.x&&c>=this.y&&l<=this.x+this.width&&c<=this.y+this.height},_containsRectangle:function(o){var l=o.x,c=o.y;return l>=this.x&&c>=this.y&&l+o.width<=this.x+this.width&&c+o.height<=this.y+this.height},intersects:function(){var o=V.read(arguments),l=s.read(arguments)||0;return o.x+o.width>this.x-l&&o.y+o.height>this.y-l&&o.x<this.x+this.width+l&&o.y<this.y+this.height+l},intersect:function(){var o=V.read(arguments),l=Math.max(this.x,o.x),c=Math.max(this.y,o.y),d=Math.min(this.x+this.width,o.x+o.width),f=Math.min(this.y+this.height,o.y+o.height);return new V(l,c,d-l,f-c)},unite:function(){var o=V.read(arguments),l=Math.min(this.x,o.x),c=Math.min(this.y,o.y),d=Math.max(this.x+this.width,o.x+o.width),f=Math.max(this.y+this.height,o.y+o.height);return new V(l,c,d-l,f-c)},include:function(){var o=I.read(arguments),l=Math.min(this.x,o.x),c=Math.min(this.y,o.y),d=Math.max(this.x+this.width,o.x),f=Math.max(this.y+this.height,o.y);return new V(l,c,d-l,f-c)},expand:function(){var o=z.read(arguments),l=o.width,c=o.height;return new V(this.x-l/2,this.y-c/2,this.width+l,this.height+c)},scale:function(o,l){return this.expand(this.width*o-this.width,this.height*(l===n?o:l)-this.height)}},s.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(o,l){var c=o.join(""),d=/^[RL]/.test(c);l>=4&&(o[1]+=d?"Y":"X");var f=o[d?0:1],p=o[d?1:0],v="get"+f,_="get"+p,y="set"+f,E="set"+p,A="get"+c,b="set"+c;this[A]=function(C){var S=C?I:j;return new S(this[v](),this[_](),this,b)},this[b]=function(){var C=I.read(arguments);this[y](C.x),this[E](C.y)}},{beans:!0})),B=V.extend({initialize:function(l,c,d,f,p,v){this._set(l,c,d,f,!0),this._owner=p,this._setter=v},_set:function(o,l,c,d,f){return this._x=o,this._y=l,this._width=c,this._height=d,f||this._owner[this._setter](this),this}},new function(){var o=V.prototype;return s.each(["x","y","width","height"],function(l){var c=s.capitalize(l),d="_"+l;this["get"+c]=function(){return this[d]},this["set"+c]=function(f){this[d]=f,this._dontNotify||this._owner[this._setter](this)}},s.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(l){var c="set"+l;this[c]=function(){this._dontNotify=!0,o[c].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(l){var c=this._owner;c._changeSelection&&c._changeSelection(2,l)}}))}),U=s.extend({_class:"Matrix",initialize:function o(l,c){var d=arguments,f=d.length,p=!0;if(f>=6?this._set.apply(this,d):f===1||f===2?l instanceof o?this._set(l._a,l._b,l._c,l._d,l._tx,l._ty,c):Array.isArray(l)?this._set.apply(this,c?l.concat([c]):l):p=!1:f?p=!1:this.reset(),!p)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(o,l,c,d,f,p,v){return this._a=o,this._b=l,this._c=c,this._d=d,this._tx=f,this._ty=p,v||this._changed(),this},_serialize:function(o,l){return s.serialize(this.getValues(),o,!0,l)},_changed:function(){var o=this._owner;o&&(o._applyMatrix?o.transform(null,!0):o._changed(25))},clone:function(){return new U(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(o){return o===this||o&&this._a===o._a&&this._b===o._b&&this._c===o._c&&this._d===o._d&&this._tx===o._tx&&this._ty===o._ty},toString:function(){var o=m.instance;return"[["+[o.number(this._a),o.number(this._c),o.number(this._tx)].join(", ")+"], ["+[o.number(this._b),o.number(this._d),o.number(this._ty)].join(", ")+"]]"},reset:function(o){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,o||this._changed(),this},apply:function(o,l){var c=this._owner;return c?(c.transform(null,s.pick(o,!0),l),this.isIdentity()):!1},translate:function(){var o=I.read(arguments),l=o.x,c=o.y;return this._tx+=l*this._a+c*this._c,this._ty+=l*this._b+c*this._d,this._changed(),this},scale:function(){var o=arguments,l=I.read(o),c=I.read(o,0,{readNull:!0});return c&&this.translate(c),this._a*=l.x,this._b*=l.x,this._c*=l.y,this._d*=l.y,c&&this.translate(c.negate()),this._changed(),this},rotate:function(o){o*=Math.PI/180;var l=I.read(arguments,1),c=l.x,d=l.y,f=Math.cos(o),p=Math.sin(o),v=c-c*f+d*p,_=d-c*p-d*f,y=this._a,E=this._b,A=this._c,b=this._d;return this._a=f*y+p*A,this._b=f*E+p*b,this._c=-p*y+f*A,this._d=-p*E+f*b,this._tx+=v*y+_*A,this._ty+=v*E+_*b,this._changed(),this},shear:function(){var o=arguments,l=I.read(o),c=I.read(o,0,{readNull:!0});c&&this.translate(c);var d=this._a,f=this._b;return this._a+=l.y*this._c,this._b+=l.y*this._d,this._c+=l.x*d,this._d+=l.x*f,c&&this.translate(c.negate()),this._changed(),this},skew:function(){var o=arguments,l=I.read(o),c=I.read(o,0,{readNull:!0}),d=Math.PI/180,f=new I(Math.tan(l.x*d),Math.tan(l.y*d));return this.shear(f,c)},append:function(o,l){if(o){var c=this._a,d=this._b,f=this._c,p=this._d,v=o._a,_=o._c,y=o._b,E=o._d,A=o._tx,b=o._ty;this._a=v*c+y*f,this._c=_*c+E*f,this._b=v*d+y*p,this._d=_*d+E*p,this._tx+=A*c+b*f,this._ty+=A*d+b*p,l||this._changed()}return this},prepend:function(o,l){if(o){var c=this._a,d=this._b,f=this._c,p=this._d,v=this._tx,_=this._ty,y=o._a,E=o._c,A=o._b,b=o._d,C=o._tx,S=o._ty;this._a=y*c+E*d,this._c=y*f+E*p,this._b=A*c+b*d,this._d=A*f+b*p,this._tx=y*v+E*_+C,this._ty=A*v+b*_+S,l||this._changed()}return this},appended:function(o){return this.clone().append(o)},prepended:function(o){return this.clone().prepend(o)},invert:function(){var o=this._a,l=this._b,c=this._c,d=this._d,f=this._tx,p=this._ty,v=o*d-l*c,_=null;return v&&!isNaN(v)&&isFinite(f)&&isFinite(p)&&(this._a=d/v,this._b=-l/v,this._c=-c/v,this._d=o/v,this._tx=(c*p-d*f)/v,this._ty=(l*f-o*p)/v,_=this),_},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new U(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var o=this._a*this._d-this._c*this._b;return o&&!isNaN(o)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(o,l,c){return arguments.length<3?this._transformPoint(I.read(arguments)):this._transformCoordinates(o,l,c)},_transformPoint:function(o,l,c){var d=o.x,f=o.y;return l||(l=new I),l._set(d*this._a+f*this._c+this._tx,d*this._b+f*this._d+this._ty,c)},_transformCoordinates:function(o,l,c){for(var d=0,f=2*c;d<f;d+=2){var p=o[d],v=o[d+1];l[d]=p*this._a+v*this._c+this._tx,l[d+1]=p*this._b+v*this._d+this._ty}return l},_transformCorners:function(o){var l=o.x,c=o.y,d=l+o.width,f=c+o.height,p=[l,c,d,c,d,f,l,f];return this._transformCoordinates(p,p,4)},_transformBounds:function(o,l,c){for(var d=this._transformCorners(o),f=d.slice(0,2),p=f.slice(),v=2;v<8;v++){var _=d[v],y=v&1;_<f[y]?f[y]=_:_>p[y]&&(p[y]=_)}return l||(l=new V),l._set(f[0],f[1],p[0]-f[0],p[1]-f[1],c)},inverseTransform:function(){return this._inverseTransform(I.read(arguments))},_inverseTransform:function(o,l,c){var d=this._a,f=this._b,p=this._c,v=this._d,_=this._tx,y=this._ty,E=d*v-f*p,A=null;if(E&&!isNaN(E)&&isFinite(_)&&isFinite(y)){var b=o.x-this._tx,C=o.y-this._ty;l||(l=new I),A=l._set((b*v-C*p)/E,(C*d-b*f)/E,c)}return A},decompose:function(){var o=this._a,l=this._b,c=this._c,d=this._d,f=o*d-l*c,p=Math.sqrt,v=Math.atan2,_=180/Math.PI,y,E,A;if(o!==0||l!==0){var b=p(o*o+l*l);y=Math.acos(o/b)*(l>0?1:-1),E=[b,f/b],A=[v(o*c+l*d,b*b),0]}else if(c!==0||d!==0){var C=p(c*c+d*d);y=Math.asin(c/C)*(d>0?1:-1),E=[f/C,C],A=[0,v(o*c+l*d,C*C)]}else y=0,A=E=[0,0];return{translation:this.getTranslation(),rotation:y*_,scaling:new I(E),skewing:new I(A[0]*_,A[1]*_)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new I(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(o){this.isIdentity()||o.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},s.each(["a","b","c","d","tx","ty"],function(o){var l=s.capitalize(o),c="_"+o;this["get"+l]=function(){return this[c]},this["set"+l]=function(d){this[c]=d,this._changed()}},{})),J=s.extend({_class:"Line",initialize:function(l,c,d,f,p){var v=!1;arguments.length>=4?(this._px=l,this._py=c,this._vx=d,this._vy=f,v=p):(this._px=l.x,this._py=l.y,this._vx=c.x,this._vy=c.y,v=d),v||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new I(this._px,this._py)},getVector:function(){return new I(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(o,l){return J.intersect(this._px,this._py,this._vx,this._vy,o._px,o._py,o._vx,o._vy,!0,l)},getSide:function(o,l){return J.getSide(this._px,this._py,this._vx,this._vy,o.x,o.y,!0,l)},getDistance:function(o){return Math.abs(this.getSignedDistance(o))},getSignedDistance:function(o){return J.getSignedDistance(this._px,this._py,this._vx,this._vy,o.x,o.y,!0)},isCollinear:function(o){return I.isCollinear(this._vx,this._vy,o._vx,o._vy)},isOrthogonal:function(o){return I.isOrthogonal(this._vx,this._vy,o._vx,o._vy)},statics:{intersect:function(o,l,c,d,f,p,v,_,y,E){y||(c-=o,d-=l,v-=f,_-=p);var A=c*_-d*v;if(!w.isMachineZero(A)){var b=o-f,C=l-p,S=(v*C-_*b)/A,k=(c*C-d*b)/A,M=1e-12,F=-M,N=1+M;if(E||F<S&&S<N&&F<k&&k<N)return E||(S=S<=0?0:S>=1?1:S),new I(o+S*c,l+S*d)}},getSide:function(o,l,c,d,f,p,v,_){v||(c-=o,d-=l);var y=f-o,E=p-l,A=y*d-E*c;return!_&&w.isMachineZero(A)&&(A=(y*c+y*c)/(c*c+d*d),A>=0&&A<=1&&(A=0)),A<0?-1:A>0?1:0},getSignedDistance:function(o,l,c,d,f,p,v){return v||(c-=o,d-=l),c===0?d>0?f-o:o-f:d===0?c<0?p-l:l-p:((f-o)*d-(p-l)*c)/(d>c?d*Math.sqrt(1+c*c/(d*d)):c*Math.sqrt(1+d*d/(c*c)))},getDistance:function(o,l,c,d,f,p,v){return Math.abs(J.getSignedDistance(o,l,c,d,f,p,v))}}}),re=h.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(l){h.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new us(null,null,this),this._view=Ot.create(this,l||se.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(o,l){return s.serialize(this._children,o,!0,l)},_changed:function(o,l){if(o&1){var c=this._view;c&&(c._needsUpdate=!0,!c._requested&&c._autoUpdate&&c.requestUpdate())}var d=this._changes;if(d&&l){var f=this._changesById,p=l._id,v=f[p];v?v.flags|=o:d.push(f[p]={item:l,flags:o})}},clear:function(){for(var o=this._children,l=o.length-1;l>=0;l--)o[l].remove()},isEmpty:function(){return!this._children.length},remove:function o(){return o.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(o){this._currentStyle.set(o)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new ne({project:this,insert:!0})},getSymbolDefinitions:function(){var o=[],l={};return this.getItems({class:rt,match:function(c){var d=c._definition,f=d._id;return l[f]||(l[f]=!0,o.push(d)),!1}}),o},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var o=this._selectionItems,l=[];for(var c in o){var d=o[c],f=d._selection;f&1&&d.isInserted()?l.push(d):f||this._updateSelection(d)}return l},_updateSelection:function(o){var l=o._id,c=this._selectionItems;o._selection?c[l]!==o&&(this._selectionCount++,c[l]=o):c[l]===o&&(this._selectionCount--,delete c[l])},selectAll:function(){for(var o=this._children,l=0,c=o.length;l<c;l++)o[l].setFullySelected(!0)},deselectAll:function(){var o=this._selectionItems;for(var l in o)o[l].setFullySelected(!1)},addLayer:function(o){return this.insertLayer(n,o)},insertLayer:function(o,l){if(l instanceof ne){l._remove(!1,!0),s.splice(this._children,[l],o,0),l._setProject(this,!0);var c=l._name;c&&l.setName(c),this._changes&&l._changed(5),this._activeLayer||(this._activeLayer=l)}else l=null;return l},_insertItem:function(o,l,c){return l=this.insertLayer(o,l)||(this._activeLayer||this._insertItem(n,new ne(te.NO_INSERT),!0)).insertChild(o,l),c&&l.activate&&l.activate(),l},getItems:function(o){return te._getItems(this,o)},getItem:function(o){return te._getItems(this,o,null,null,!0)[0]||null},importJSON:function(o){this.activate();var l=this._activeLayer;return s.importJSON(o,l&&l.isEmpty()&&l)},removeOn:function(o){var l=this._removeSets;if(l){o==="mouseup"&&(l.mousedrag=null);var c=l[o];if(c){for(var d in c){var f=c[d];for(var p in l){var v=l[p];v&&v!=c&&delete v[f._id]}f.remove()}l[o]=null}}},draw:function(o,l,c){this._updateVersion++,o.save(),l.applyToContext(o);for(var d=this._children,f=new s({offset:new I(0,0),pixelRatio:c,viewMatrix:l.isIdentity()?null:l,matrices:[new U],updateMatrix:!0}),p=0,v=d.length;p<v;p++)d[p].draw(o,f);if(o.restore(),this._selectionCount>0){o.save(),o.strokeWidth=1;var _=this._selectionItems,y=this._scope.settings.handleSize,E=this._updateVersion;for(var A in _)_[A]._drawSelection(o,l,y,_,E);o.restore()}}}),te=s.extend(a,{statics:{extend:function o(l){return l._serializeFields&&(l._serializeFields=s.set({},this.prototype._serializeFields,l._serializeFields)),o.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new U,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var o=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return s.each(o,function(l){this._events[l]={install:function(c){this.getView()._countItemEvent(c,1)},uninstall:function(c){this.getView()._countItemEvent(c,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:o}})},{initialize:function(){},_initialize:function(o,l){var c=o&&s.isPlainObject(o),d=c&&o.internal===!0,f=this._matrix=new U,p=c&&o.project||de.project,v=de.settings;return this._id=d?null:T.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&v.applyMatrix,l&&f.translate(l),f._owner=this,this._style=new us(p._currentStyle,this,p),d||c&&o.insert==!1||!v.insertItems&&!(c&&o.insert==!0)?this._setProject(p):(c&&o.parent||p)._insertItem(n,this,!0),c&&o!==te.NO_INSERT&&o!==te.INSERT&&this.set(o,{internal:!0,insert:!0,project:!0,parent:!0}),c},_serialize:function(o,l){var c={},d=this;function f(p){for(var v in p){var _=d[v];s.equals(_,v==="leading"?p.fontSize*1.2:p[v])||(c[v]=s.serialize(_,o,v!=="data",l))}}return f(this._serializeFields),this instanceof ae||f(this._style._defaults),[this._class,c]},_changed:function(o){var l=this._symbol,c=this._parent||l,d=this._project;o&8&&(this._bounds=this._position=this._decomposed=n),o&16&&(this._globalMatrix=n),c&&o&72&&te._clearBoundsCache(c),o&2&&te._clearBoundsCache(this),d&&d._changed(o,this),l&&l._changed(o)},getId:function(){return this._id},getName:function(){return this._name},setName:function(o){if(this._name&&this._removeNamed(),o===+o+"")throw new Error("Names consisting only of numbers are not supported.");var l=this._getOwner();if(o&&l){var c=l._children,d=l._namedChildren;(d[o]=d[o]||[]).push(this),o in c||(c[o]=this)}this._name=o||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(o){this.getStyle().set(o)}},s.each(["locked","visible","blendMode","opacity","guide"],function(o){var l=s.capitalize(o),c="_"+o,d={locked:256,visible:265};this["get"+l]=function(){return this[c]},this["set"+l]=function(f){f!=this[c]&&(this[c]=f,this._changed(d[o]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(o){if(o!==this._selection){this._selection=o;var l=this._project;l&&(l._updateSelection(this),this._changed(257))}},_changeSelection:function(o,l){var c=this._selection;this.setSelection(l?c|o:c&~o)},isSelected:function(){if(this._selectChildren){for(var o=this._children,l=0,c=o.length;l<c;l++)if(o[l].isSelected())return!0}return!!(this._selection&1)},setSelected:function(o){if(this._selectChildren)for(var l=this._children,c=0,d=l.length;c<d;c++)l[c].setSelected(o);this._changeSelection(1,o)},isFullySelected:function(){var o=this._children,l=!!(this._selection&1);if(o&&l){for(var c=0,d=o.length;c<d;c++)if(!o[c].isFullySelected())return!1;return!0}return l},setFullySelected:function(o){var l=this._children;if(l)for(var c=0,d=l.length;c<d;c++)l[c].setFullySelected(o);this._changeSelection(1,o)},isClipMask:function(){return this._clipMask},setClipMask:function(o){this._clipMask!=(o=!!o)&&(this._clipMask=o,o&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(o){this._data=o},getPosition:function(o){var l=o?I:j,c=this._position||(this._position=this._getPositionFromBounds());return new l(c.x,c.y,this,"setPosition")},setPosition:function(){this.translate(I.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(o){return this._pivot?this._matrix._transformPoint(this._pivot):(o||this.getBounds()).getCenter(!0)},getPivot:function(){var o=this._pivot;return o?new j(o.x,o.y,this,"setPivot"):null},setPivot:function(){this._pivot=I.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},s.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(o,l){this[l]=function(c){return this.getBounds(c,o)}},{beans:!0,getBounds:function(o,l){var c=l||o instanceof U,d=s.set({},c?l:o,this._boundsOptions);(!d.stroke||this.getStrokeScaling())&&(d.cacheItem=this);var f=this._getCachedBounds(c&&o,d).rect;return arguments.length?f:new B(f.x,f.y,f.width,f.height,this,"setBounds")},setBounds:function(){var o=V.read(arguments),l=this.getBounds(),c=this._matrix,d=new U,f=o.getCenter();d.translate(f),(o.width!=l.width||o.height!=l.height)&&(c.isInvertible()||(c.set(c._backup||new U().translate(c.getTranslation())),l=this.getBounds()),d.scale(l.width!==0?o.width/l.width:0,l.height!==0?o.height/l.height:0)),f=l.getCenter(),d.translate(-f.x,-f.y),this.transform(d)},_getBounds:function(o,l){var c=this._children;return!c||!c.length?new V:(te._updateBoundsCache(this,l.cacheItem),te._getBounds(c,o,l))},_getBoundsCacheKey:function(o,l){return[o.stroke?1:0,o.handle?1:0,l?1:0].join("")},_getCachedBounds:function(o,l,c){o=o&&o._orNullIfIdentity();var d=l.internal&&!c,f=l.cacheItem,p=d?null:this._matrix._orNullIfIdentity(),v=f&&(!o||o.equals(p))&&this._getBoundsCacheKey(l,d),_=this._bounds;if(te._updateBoundsCache(this._parent||this._symbol,f),v&&_&&v in _){var y=_[v];return{rect:y.rect.clone(),nonscaling:y.nonscaling}}var E=this._getBounds(o||p,l),A=E.rect||E,b=this._style,C=E.nonscaling||b.hasStroke()&&!b.getStrokeScaling();if(v){_||(this._bounds=_={});var y=_[v]={rect:A.clone(),nonscaling:C,internal:d}}return{rect:A,nonscaling:C}},_getStrokeMatrix:function(o,l){var c=this.getStrokeScaling()?null:l&&l.internal?this:this._parent||this._symbol&&this._symbol._item,d=c?c.getViewMatrix().invert():o;return d&&d._shiftless()},statics:{_updateBoundsCache:function(o,l){if(o&&l){var c=l._id,d=o._boundsCache=o._boundsCache||{ids:{},list:[]};d.ids[c]||(d.list.push(l),d.ids[c]=l)}},_clearBoundsCache:function(o){var l=o._boundsCache;if(l){o._bounds=o._position=o._boundsCache=n;for(var c=0,d=l.list,f=d.length;c<f;c++){var p=d[c];p!==o&&(p._bounds=p._position=n,p._boundsCache&&te._clearBoundsCache(p))}}},_getBounds:function(o,l,c){var d=1/0,f=-d,p=d,v=f,_=!1;c=c||{};for(var y=0,E=o.length;y<E;y++){var A=o[y];if(A._visible&&!A.isEmpty(!0)){var b=A._getCachedBounds(l&&l.appended(A._matrix),c,!0),C=b.rect;d=Math.min(C.x,d),p=Math.min(C.y,p),f=Math.max(C.x+C.width,f),v=Math.max(C.y+C.height,v),b.nonscaling&&(_=!0)}}return{rect:isFinite(d)?new V(d,p,f-d,v-p):new V,nonscaling:_}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var o=this._decompose();return o?o.rotation:0},setRotation:function(o){var l=this.getRotation();if(l!=null&&o!=null){var c=this._decomposed;this.rotate(o-l),c&&(c.rotation=o,this._decomposed=c)}},getScaling:function(){var o=this._decompose(),l=o&&o.scaling;return new j(l?l.x:1,l?l.y:1,this,"setScaling")},setScaling:function(){var o=this.getScaling(),l=I.read(arguments,0,{clone:!0,readNull:!0});if(o&&l&&!o.equals(l)){var c=this.getRotation(),d=this._decomposed,f=new U,p=w.isZero;if(p(o.x)||p(o.y))f.translate(d.translation),c&&f.rotate(c),f.scale(l.x,l.y),this._matrix.set(f);else{var v=this.getPosition(!0);f.translate(v),c&&f.rotate(c),f.scale(l.x/o.x,l.y/o.y),c&&f.rotate(-c),f.translate(v.negate()),this.transform(f)}d&&(d.scaling=l,this._decomposed=d)}},getMatrix:function(){return this._matrix},setMatrix:function(){var o=this._matrix;o.set.apply(o,arguments)},getGlobalMatrix:function(o){var l=this._globalMatrix;if(l)for(var c=this._parent,d=[];c;){if(!c._globalMatrix){l=null;for(var f=0,p=d.length;f<p;f++)d[f]._globalMatrix=null;break}d.push(c),c=c._parent}if(!l){l=this._globalMatrix=this._matrix.clone();var c=this._parent;c&&l.prepend(c.getGlobalMatrix(!0))}return o?l:l.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(o){(this._applyMatrix=this._canApplyMatrix&&!!o)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(o,l){if(this._project!==o){this._project&&this._installEvents(!1),this._project=o;for(var c=this._children,d=0,f=c&&c.length;d<f;d++)c[d]._setProject(o);l=!0}l&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function o(l){o.base.call(this,l);for(var c=this._children,d=0,f=c&&c.length;d<f;d++)c[d]._installEvents(l)},getLayer:function(){for(var o=this;o=o._parent;)if(o instanceof ne)return o;return null},getParent:function(){return this._parent},setParent:function(o){return o.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(o){this.removeChildren(),this.addChildren(o)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var o=this._getOwner();return o&&o._children[this._index+1]||null},getPreviousSibling:function(){var o=this._getOwner();return o&&o._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(o){return o===this||o&&this._class===o._class&&this._style.equals(o._style)&&this._matrix.equals(o._matrix)&&this._locked===o._locked&&this._visible===o._visible&&this._blendMode===o._blendMode&&this._opacity===o._opacity&&this._clipMask===o._clipMask&&this._guide===o._guide&&this._equals(o)||!1},_equals:function(o){return s.equals(this._children,o._children)},clone:function(o){var l=new this.constructor(te.NO_INSERT),c=this._children,d=s.pick(o?o.insert:n,o===n||o===!0),f=s.pick(o?o.deep:n,!0);c&&l.copyAttributes(this),(!c||f)&&l.copyContent(this),c||l.copyAttributes(this),d&&l.insertAbove(this);var p=this._name,v=this._parent;if(p&&v){for(var c=v._children,_=p,y=1;c[p];)p=_+" "+y++;p!==_&&l.setName(p)}return l},copyContent:function(o){for(var l=o._children,c=0,d=l&&l.length;c<d;c++)this.addChild(l[c].clone(!1),!0)},copyAttributes:function(o,l){this.setStyle(o._style);for(var c=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],d=0,f=c.length;d<f;d++){var p=c[d];o.hasOwnProperty(p)&&(this[p]=o[p])}l||this._matrix.set(o._matrix,!0),this.setApplyMatrix(o._applyMatrix),this.setPivot(o._pivot),this.setSelection(o._selection);var v=o._data,_=o._name;this._data=v?s.clone(v):null,_&&this.setName(_)},rasterize:function(o,l){var c,d,f;s.isPlainObject(o)?(c=o.resolution,d=o.insert,f=o.raster):(c=o,d=l),f||(f=new pe(te.NO_INSERT));var p=this.getStrokeBounds(),v=(c||this.getView().getResolution())/72,_=p.getTopLeft().floor(),y=p.getBottomRight().ceil(),E=new z(y.subtract(_)),A=E.multiply(v);if(f.setSize(A,!0),!A.isZero()){var b=f.getContext(!0),C=new U().scale(v).translate(_.negate());b.save(),C.applyToContext(b),this.draw(b,new s({matrices:[C]})),b.restore()}return f._matrix.set(new U().translate(_.add(E.divide(2))).scale(1/v)),(d===n||d)&&f.insertAbove(this),f},contains:function(){var o=this._matrix;return o.isInvertible()&&!!this._contains(o._inverseTransform(I.read(arguments)))},_contains:function(o){var l=this._children;if(l){for(var c=l.length-1;c>=0;c--)if(l[c].contains(o))return!0;return!1}return o.isInside(this.getInternalBounds())},isInside:function(){return V.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Te.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(o,l){return o instanceof te?this._asPathItem().getIntersections(o._asPathItem(),null,l,!0).length>0:!1}},new function(){function o(){var d=arguments;return this._hitTest(I.read(d),xe.getOptions(d))}function l(){var d=arguments,f=I.read(d),p=xe.getOptions(d),v=[];return this._hitTest(f,new s({all:v},p)),v}function c(d,f,p,v){var _=this._children;if(_)for(var y=_.length-1;y>=0;y--){var E=_[y],A=E!==v&&E._hitTest(d,f,p);if(A&&!f.all)return A}return null}return re.inject({hitTest:o,hitTestAll:l,_hitTest:c}),{hitTest:o,hitTestAll:l,_hitTestChildren:c}},{_hitTest:function(o,l,c){if(this._locked||!this._visible||this._guide&&!l.guides||this.isEmpty())return null;var d=this._matrix,f=c?c.appended(d):this.getGlobalMatrix().prepend(this.getView()._matrix),p=Math.max(l.tolerance,1e-12),v=l._tolerancePadding=new z(Te._getStrokePadding(p,d._shiftless().invert()));if(o=d._inverseTransform(o),!o||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(v.multiply(2))._containsPoint(o))return null;var _=!(l.guides&&!this._guide||l.selected&&!this.isSelected()||l.type&&l.type!==s.hyphenate(this._class)||l.class&&!(this instanceof l.class)),y=l.match,E=this,A,b;function C(x){return x&&y&&!y(x)&&(x=null),x&&l.all&&l.all.push(x),x}function S(x,P){var O=P?A["get"+P]():E.getPosition();if(o.subtract(O).divide(v).length<=1)return new xe(x,E,{name:P?s.hyphenate(P):x,point:O})}var k=l.position,M=l.center,F=l.bounds;if(_&&this._parent&&(k||M||F)){if((M||F)&&(A=this.getInternalBounds()),b=k&&S("position")||M&&S("center","Center"),!b&&F)for(var N=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],D=0;D<8&&!b;D++)b=S("bounds",N[D]);b=C(b)}return b||(b=this._hitTestChildren(o,l,f)||_&&C(this._hitTestSelf(o,l,f,this.getStrokeScaling()?null:f._shiftless().invert()))||null),b&&b.point&&(b.point=d.transform(b.point)),b},_hitTestSelf:function(o,l){if(l.fill&&this.hasFill()&&this._contains(o))return new xe("fill",this)},matches:function(o,l){function c(v,_){for(var y in v)if(v.hasOwnProperty(y)){var E=v[y],A=_[y];if(s.isPlainObject(E)&&s.isPlainObject(A)){if(!c(E,A))return!1}else if(!s.equals(E,A))return!1}return!0}var d=typeof o;if(d==="object"){for(var f in o)if(o.hasOwnProperty(f)&&!this.matches(f,o[f]))return!1;return!0}else{if(d==="function")return o(this);if(o==="match")return l(this);var p=/^(empty|editable)$/.test(o)?this["is"+s.capitalize(o)]():o==="type"?s.hyphenate(this._class):this[o];if(o==="class"){if(typeof l=="function")return this instanceof l;p=this._class}if(typeof l=="function")return!!l(p);if(l){if(l.test)return l.test(p);if(s.isPlainObject(l))return c(l,p)}return s.equals(p,l)}},getItems:function(o){return te._getItems(this,o,this._matrix)},getItem:function(o){return te._getItems(this,o,this._matrix,null,!0)[0]||null},statics:{_getItems:function o(l,c,d,f,p){if(!f){var v=typeof c=="object"&&c,_=v&&v.overlapping,y=v&&v.inside,E=_||y,C=E&&V.read([E]);f={items:[],recursive:v&&v.recursive!==!1,inside:!!y,overlapping:!!_,rect:C,path:_&&new Te.Rectangle({rectangle:C,insert:!1})},v&&(c=s.filter({},c,{recursive:!0,inside:!0,overlapping:!0}))}var A=l._children,b=f.items,C=f.rect;d=C&&(d||new U);for(var S=0,k=A&&A.length;S<k;S++){var M=A[S],F=d&&d.appended(M._matrix),N=!0;if(C){var E=M.getBounds(F);if(!C.intersects(E))continue;C.contains(E)||f.overlapping&&(E.contains(C)||f.path.intersects(M,F))||(N=!1)}if(N&&M.matches(c)&&(b.push(M),p)||(f.recursive!==!1&&o(M,c,F,f,p),p&&b.length>0))break}return b}}},{importJSON:function(o){var l=s.importJSON(o,this);return l!==this?this.addChild(l):l},addChild:function(o){return this.insertChild(n,o)},insertChild:function(o,l){var c=l?this.insertChildren(o,[l]):null;return c&&c[0]},addChildren:function(o){return this.insertChildren(this._children.length,o)},insertChildren:function(o,l){var c=this._children;if(c&&l&&l.length>0){l=s.slice(l);for(var d={},f=l.length-1;f>=0;f--){var p=l[f],v=p&&p._id;!p||d[v]?l.splice(f,1):(p._remove(!1,!0),d[v]=!0)}s.splice(c,l,o,0);for(var _=this._project,y=_._changes,f=0,E=l.length;f<E;f++){var p=l[f],A=p._name;p._parent=this,p._setProject(_,!0),A&&p.setName(A),y&&p._changed(5)}this._changed(11)}else l=null;return l},_insertItem:"#insertChild",_insertAt:function(o,l){var c=o&&o._getOwner(),d=o!==this&&c?this:null;return d&&(d._remove(!1,!0),c._insertItem(o._index+l,d)),d},insertAbove:function(o){return this._insertAt(o,1)},insertBelow:function(o){return this._insertAt(o,0)},sendToBack:function(){var o=this._getOwner();return o?o._insertItem(0,this):null},bringToFront:function(){var o=this._getOwner();return o?o._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(o){return this.insertChild(0,o)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(o){return o._insertItem(n,this)},copyTo:function(o){return this.clone(!1).addTo(o)},reduce:function(o){var l=this._children;if(l&&l.length===1){var c=l[0].reduce(o);return this._parent?(c.insertAbove(this),this.remove()):c.remove(),c}return this},_removeNamed:function(){var o=this._getOwner();if(o){var l=o._children,c=o._namedChildren,d=this._name,f=c[d],p=f?f.indexOf(this):-1;p!==-1&&(l[d]==this&&delete l[d],f.splice(p,1),f.length?l[d]=f[0]:delete c[d])}},_remove:function(o,l){var c=this._getOwner(),d=this._project,f=this._index;return this._style&&this._style._dispose(),c?(this._name&&this._removeNamed(),f!=null&&(d._activeLayer===this&&(d._activeLayer=this.getNextSibling()||this.getPreviousSibling()),s.splice(c._children,null,f,1)),this._installEvents(!1),o&&d._changes&&this._changed(5),l&&c._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(o){var l=o&&o.insertBelow(this);return l&&this.remove(),l},removeChildren:function(o,l){if(!this._children)return null;o=o||0,l=s.pick(l,this._children.length);for(var c=s.splice(this._children,null,o,l-o),d=c.length-1;d>=0;d--)c[d]._remove(!0,!1);return c.length>0&&this._changed(11),c},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var o=0,l=this._children.length;o<l;o++)this._children[o]._index=o;this._changed(11)}},isEmpty:function(o){var l=this._children,c=l?l.length:0;if(o){for(var d=0;d<c;d++)if(!l[d].isEmpty(o))return!1;return!0}return!c},isEditable:function(){for(var o=this;o;){if(!o._visible||o._locked)return!1;o=o._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(o){function l(v){var _=[];do _.unshift(v);while(v=v._parent);return _}for(var c=l(this),d=l(o),f=0,p=Math.min(c.length,d.length);f<p;f++)if(c[f]!=d[f])return c[f]._index<d[f]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(o){return this._getOrder(o)===-1},isBelow:function(o){return this._getOrder(o)===1},isParent:function(o){return this._parent===o},isChild:function(o){return o&&o._parent===this},isDescendant:function(o){for(var l=this;l=l._parent;)if(l===o)return!0;return!1},isAncestor:function(o){return o?o.isDescendant(this):!1},isSibling:function(o){return this._parent===o._parent},isGroupedWith:function(o){for(var l=this._parent;l;){if(l._parent&&/^(Group|Layer|CompoundPath)$/.test(l._class)&&o.isDescendant(l))return!0;l=l._parent}return!1}},s.each(["rotate","scale","shear","skew"],function(o){var l=o==="rotate";this[o]=function(){var c=arguments,d=(l?s:I).read(c),f=I.read(c,0,{readNull:!0});return this.transform(new U()[o](d,f||this.getPosition(!0)))}},{translate:function(){var o=new U;return this.transform(o.translate.apply(o,arguments))},transform:function(o,l,c){var d=this._matrix,f=o&&!o.isIdentity(),p=c&&this._canApplyMatrix||this._applyMatrix&&(f||!d.isIdentity()||l&&this._children);if(!f&&!p)return this;if(f){!o.isInvertible()&&d.isInvertible()&&(d._backup=d.getValues()),d.prepend(o,!0);var v=this._style,_=v.getFillColor(!0),y=v.getStrokeColor(!0);_&&_.transform(o),y&&y.transform(o)}if(p&&(p=this._transformContent(d,l,c))){var E=this._pivot;E&&d._transformPoint(E,E,!0),d.reset(!0),c&&this._canApplyMatrix&&(this._applyMatrix=!0)}var A=this._bounds,b=this._position;(f||p)&&this._changed(25);var C=f&&A&&o.decompose();if(C&&C.skewing.isZero()&&C.rotation%90===0){for(var S in A){var k=A[S];if(k.nonscaling)delete A[S];else if(p||!k.internal){var M=k.rect;o._transformBounds(M,M)}}this._bounds=A;var F=A[this._getBoundsCacheKey(this._boundsOptions||{})];F&&(this._position=this._getPositionFromBounds(F.rect))}else f&&b&&this._pivot&&(this._position=o._transformPoint(b,b));return this},_transformContent:function(o,l,c){var d=this._children;if(d){for(var f=0,p=d.length;f<p;f++)d[f].transform(o,l,c);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(I.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(I.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(I.read(arguments))},localToParent:function(){return this._matrix._transformPoint(I.read(arguments))},fitBounds:function(o,l){o=V.read(arguments);var c=this.getBounds(),d=c.height/c.width,f=o.height/o.width,p=(l?d>f:d<f)?o.width/c.width:o.height/c.height,v=new V(new I,new z(c.width*p,c.height*p));v.setCenter(o.getCenter()),this.setBounds(v)}}),{_setStyles:function(o,l,c){var d=this._style,f=this._matrix;if(d.hasFill()&&(o.fillStyle=d.getFillColor().toCanvasStyle(o,f)),d.hasStroke()){o.strokeStyle=d.getStrokeColor().toCanvasStyle(o,f),o.lineWidth=d.getStrokeWidth();var p=d.getStrokeJoin(),v=d.getStrokeCap(),_=d.getMiterLimit();if(p&&(o.lineJoin=p),v&&(o.lineCap=v),_&&(o.miterLimit=_),de.support.nativeDash){var y=d.getDashArray(),E=d.getDashOffset();y&&y.length&&("setLineDash"in o?(o.setLineDash(y),o.lineDashOffset=E):(o.mozDash=y,o.mozDashOffset=E))}}if(d.hasShadow()){var A=l.pixelRatio||1,b=c._shiftless().prepend(new U().scale(A,A)),C=b.transform(new I(d.getShadowBlur(),0)),S=b.transform(this.getShadowOffset());o.shadowColor=d.getShadowColor().toCanvasStyle(o),o.shadowBlur=C.getLength(),o.shadowOffsetX=S.x,o.shadowOffsetY=S.y}},draw:function(o,l,c){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var d=l.matrices,f=l.viewMatrix,p=this._matrix,v=d[d.length-1].appended(p);if(v.isInvertible()){f=f?f.appended(v):v,d.push(v),l.updateMatrix&&(this._globalMatrix=v);var _=this._blendMode,y=w.clamp(this._opacity,0,1),E=_==="normal",A=ge.nativeModes[_],b=E&&y===1||l.dontStart||l.clip||(A||E&&y<1)&&this._canComposite(),C=l.pixelRatio||1,S,k,M;if(!b){var F=this.getStrokeBounds(f);if(!F.width||!F.height){d.pop();return}M=l.offset,k=l.offset=F.getTopLeft().floor(),S=o,o=se.getContext(F.getSize().ceil().add(1).multiply(C)),C!==1&&o.scale(C,C)}o.save();var N=c?c.appended(p):this._canScaleStroke&&!this.getStrokeScaling(!0)&&f,D=!b&&l.clipItem,x=!N||D;if(b?(o.globalAlpha=y,A&&(o.globalCompositeOperation=_)):x&&o.translate(-k.x,-k.y),x&&(b?p:f).applyToContext(o),D&&l.clipItem.draw(o,l.extend({clip:!0})),N){o.setTransform(C,0,0,C,0,0);var P=l.offset;P&&o.translate(-P.x,-P.y)}this._draw(o,l,f,N),o.restore(),d.pop(),l.clip&&!l.dontFinish&&o.clip(this.getFillRule()),b||(ge.process(_,o,S,y,k.subtract(M).multiply(C)),se.release(o),l.offset=M)}}},_isUpdated:function(o){var l=this._parent;if(l instanceof Oe)return l._isUpdated(o);var c=this._updateVersion===o;return!c&&l&&l._visible&&l._isUpdated(o)&&(this._updateVersion=o,c=!0),c},_drawSelection:function(o,l,c,d,f){var p=this._selection,v=p&1,_=p&2||v&&this._selectBounds,y=p&4;if(this._drawSelected||(v=!1),(v||_||y)&&this._isUpdated(f)){var E,A=this.getSelectedColor(!0)||(E=this.getLayer())&&E.getSelectedColor(!0),b=l.appended(this.getGlobalMatrix(!0)),C=c/2;if(o.strokeStyle=o.fillStyle=A?A.toCanvasStyle(o):"#009dec",v&&this._drawSelected(o,b,d),y){var S=this.getPosition(!0),k=this._parent,M=k?k.localToGlobal(S):S,F=M.x,N=M.y;o.beginPath(),o.arc(F,N,C,0,Math.PI*2,!0),o.stroke();for(var D=[[0,-1],[1,0],[0,1],[-1,0]],x=C,P=c+1,O=0;O<4;O++){var L=D[O],$=L[0],q=L[1];o.moveTo(F+$*x,N+q*x),o.lineTo(F+$*P,N+q*P),o.stroke()}}if(_){var H=b._transformCorners(this.getInternalBounds());o.beginPath();for(var O=0;O<8;O++)o[O?"lineTo":"moveTo"](H[O],H[++O]);o.closePath(),o.stroke();for(var O=0;O<8;O++)o.fillRect(H[O]-C,H[++O]-C,c,c)}}},_canComposite:function(){return!1}},s.each(["down","drag","up","move"],function(o){this["removeOn"+s.capitalize(o)]=function(){var l={};return l[o]=!0,this.removeOn(l)}},{removeOn:function(o){for(var l in o)if(o[l]){var c="mouse"+l,d=this._project,f=d._removeSets=d._removeSets||{};f[c]=f[c]||{},f[c][this._id]=this}return this}}),{tween:function(o,l,c){c||(c=l,l=o,o=null,c||(c=l,l=null));var d=c&&c.easing,f=c&&c.start,p=c!=null&&(typeof c=="number"?c:c.duration),v=new Td(this,o,l,p,d,f);function _(y){v._handleFrame(y.time*1e3),v.running||this.off("frame",_)}return p&&this.on("frame",_),v},tweenTo:function(o,l){return this.tween(null,o,l)},tweenFrom:function(o,l){return this.tween(o,null,l)}}),ae=te.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(l){this._children=[],this._namedChildren={},this._initialize(l)||this.addChildren(Array.isArray(l)?l:arguments)},_changed:function o(l){o.base.call(this,l),l&2050&&(this._clipItem=n)},_getClipItem:function(){var o=this._clipItem;if(o===n){o=null;for(var l=this._children,c=0,d=l.length;c<d;c++)if(l[c]._clipMask){o=l[c];break}this._clipItem=o}return o},isClipped:function(){return!!this._getClipItem()},setClipped:function(o){var l=this.getFirstChild();l&&l.setClipMask(o)},_getBounds:function o(l,c){var d=this._getClipItem();return d?d._getCachedBounds(d._matrix.prepended(l),s.set({},c,{stroke:!1})):o.base.call(this,l,c)},_hitTestChildren:function o(l,c,d){var f=this._getClipItem();return(!f||f.contains(l))&&o.base.call(this,l,c,d,f)},_draw:function(o,l){var c=l.clip,d=!c&&this._getClipItem();l=l.extend({clipItem:d,clip:!1}),c?(o.beginPath(),l.dontStart=l.dontFinish=!0):d&&d.draw(o,l.extend({clip:!0}));for(var f=this._children,p=0,v=f.length;p<v;p++){var _=f[p];_!==d&&_.draw(o,l)}}}),ne=ae.extend({_class:"Layer",initialize:function(){ae.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function o(){return this._parent?o.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),me=te.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(l,c){this._initialize(l,c)},_equals:function(o){return this._type===o._type&&this._size.equals(o._size)&&s.equals(this._radius,o._radius)},copyContent:function(o){this.setType(o._type),this.setSize(o._size),this.setRadius(o._radius)},getType:function(){return this._type},setType:function(o){this._type=o},getShape:"#getType",setShape:"#setType",getSize:function(){var o=this._size;return new X(o.width,o.height,this,"setSize")},setSize:function(){var o=z.read(arguments);if(!this._size)this._size=o.clone();else if(!this._size.equals(o)){var l=this._type,c=o.width,d=o.height;l==="rectangle"?this._radius.set(z.min(this._radius,o.divide(2).abs())):l==="circle"?(c=d=(c+d)/2,this._radius=c/2):l==="ellipse"&&this._radius._set(c/2,d/2),this._size._set(c,d),this._changed(9)}},getRadius:function(){var o=this._radius;return this._type==="circle"?o:new X(o.width,o.height,this,"setRadius")},setRadius:function(o){var l=this._type;if(l==="circle"){if(o===this._radius)return;var c=o*2;this._radius=o,this._size._set(c,c)}else if(o=z.read(arguments),!this._radius)this._radius=o.clone();else{if(this._radius.equals(o))return;if(this._radius.set(o),l==="rectangle"){var c=z.max(this._size,o.multiply(2));this._size.set(c)}else l==="ellipse"&&this._size._set(o.width*2,o.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(o){var l=new Te[s.capitalize(this._type)]({center:new I,size:this._size,radius:this._radius,insert:!1});return l.copyAttributes(this),de.settings.applyMatrix&&l.setApplyMatrix(!0),(o===n||o)&&l.insertAbove(this),l},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(o,l,c,d){var f=this._style,p=f.hasFill(),v=f.hasStroke(),_=l.dontFinish||l.clip,y=!d;if(p||v||_){var E=this._type,A=this._radius,b=E==="circle";if(l.dontStart||o.beginPath(),y&&b)o.arc(0,0,A,0,Math.PI*2,!0);else{var C=b?A:A.width,S=b?A:A.height,k=this._size,M=k.width,F=k.height;if(y&&E==="rectangle"&&C===0&&S===0)o.rect(-M/2,-F/2,M,F);else{var N=M/2,D=F/2,x=1-.5522847498307936,P=C*x,O=S*x,L=[-N,-D+S,-N,-D+O,-N+P,-D,-N+C,-D,N-C,-D,N-P,-D,N,-D+O,N,-D+S,N,D-S,N,D-O,N-P,D,N-C,D,-N+C,D,-N+P,D,-N,D-O,-N,D-S];d&&d.transform(L,L,32),o.moveTo(L[0],L[1]),o.bezierCurveTo(L[2],L[3],L[4],L[5],L[6],L[7]),N!==C&&o.lineTo(L[8],L[9]),o.bezierCurveTo(L[10],L[11],L[12],L[13],L[14],L[15]),D!==S&&o.lineTo(L[16],L[17]),o.bezierCurveTo(L[18],L[19],L[20],L[21],L[22],L[23]),N!==C&&o.lineTo(L[24],L[25]),o.bezierCurveTo(L[26],L[27],L[28],L[29],L[30],L[31])}}o.closePath()}!_&&(p||v)&&(this._setStyles(o,l,c),p&&(o.fill(f.getFillRule()),o.shadowColor="rgba(0,0,0,0)"),v&&o.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(o,l){var c=new V(this._size).setCenter(0,0),d=this._style,f=l.stroke&&d.hasStroke()&&d.getStrokeWidth();return o&&(c=o._transformBounds(c)),f?c.expand(Te._getStrokePadding(f,this._getStrokeMatrix(o,l))):c}},new function(){function o(c,d,f){var p=c._radius;if(!p.isZero())for(var v=c._size.divide(2),_=1;_<=4;_++){var y=new I(_>1&&_<4?-1:1,_>2?-1:1),E=y.multiply(v),A=E.subtract(y.multiply(p)),b=new V(f?E.add(y.multiply(f)):E,A);if(b.contains(d))return{point:A,quadrant:_}}}function l(c,d,f,p){var v=c.divide(d);return(!p||v.isInQuadrant(p))&&v.subtract(v.normalize()).multiply(d).divide(f).length<=1}return{_contains:function c(d){if(this._type==="rectangle"){var f=o(this,d);return f?d.subtract(f.point).divide(this._radius).getLength()<=1:c.base.call(this,d)}else return d.divide(this.size).getLength()<=.5},_hitTestSelf:function c(d,f,p,v){var _=!1,y=this._style,E=f.stroke&&y.hasStroke(),A=f.fill&&y.hasFill();if(E||A){var b=this._type,C=this._radius,S=E?y.getStrokeWidth()/2:0,k=f._tolerancePadding.add(Te._getStrokePadding(S,!y.getStrokeScaling()&&v));if(b==="rectangle"){var M=k.multiply(2),F=o(this,d,M);if(F)_=l(d.subtract(F.point),C,k,F.quadrant);else{var N=new V(this._size).setCenter(0,0),D=N.expand(M),x=N.expand(M.negate());_=D._containsPoint(d)&&!x._containsPoint(d)}}else _=l(d,C,k)}return _?new xe(E?"stroke":"fill",this):c.base.apply(this,arguments)}}},{statics:new function(){function o(l,c,d,f,p){var v=s.create(me.prototype);return v._type=l,v._size=d,v._radius=f,v._initialize(s.getNamed(p),c),v}return{Circle:function(){var l=arguments,c=I.readNamed(l,"center"),d=s.readNamed(l,"radius");return o("circle",c,new z(d*2),d,l)},Rectangle:function(){var l=arguments,c=V.readNamed(l,"rectangle"),d=z.min(z.readNamed(l,"radius"),c.getSize(!0).divide(2));return o("rectangle",c.getCenter(!0),c.getSize(!0),d,l)},Ellipse:function(){var l=arguments,c=me._readEllipse(l),d=c.radius;return o("ellipse",c.center,d.multiply(2),d,l)},_readEllipse:function(l){var c,d;if(s.hasNamed(l,"radius"))c=I.readNamed(l,"center"),d=z.readNamed(l,"radius");else{var f=V.readNamed(l,"rectangle");c=f.getCenter(!0),d=f.getSize(!0).divide(2)}return{center:c,radius:d}}}}}),pe=te.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(l,c){if(!this._initialize(l,c!==n&&I.read(arguments))){var d,f=typeof l,p=f==="string"?i.getElementById(l):f==="object"?l:null;if(p&&p!==te.NO_INSERT){if(p.getContext||p.naturalHeight!=null)d=p;else if(p){var v=z.read(arguments);v.isZero()||(d=se.getCanvas(v))}}d?this.setImage(d):this.setSource(l)}this._size||(this._size=new z,this._loaded=!1)},_equals:function(o){return this.getSource()===o.getSource()},copyContent:function(o){var l=o._image,c=o._canvas;if(l)this._setImage(l);else if(c){var d=se.getCanvas(o._size);d.getContext("2d").drawImage(c,0,0),this._setImage(d)}this._crossOrigin=o._crossOrigin},getSize:function(){var o=this._size;return new X(o?o.width:0,o?o.height:0,this,"setSize")},setSize:function(o,l){var c=z.read(arguments);if(c.equals(this._size))l&&this.clear();else if(c.width>0&&c.height>0){var d=!l&&this.getElement();this._setImage(se.getCanvas(c)),d&&this.getContext(!0).drawImage(d,0,0,c.width,c.height)}else this._canvas&&se.release(this._canvas),this._size=c.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(o){this.setSize(o,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(o){this.setSize(this.getWidth(),o)},getLoaded:function(){return this._loaded},isEmpty:function(){var o=this._size;return!o||o.width===0&&o.height===0},getResolution:function(){var o=this._matrix,l=new I(0,0).transform(o),c=new I(1,0).transform(o).subtract(l),d=new I(0,1).transform(o).subtract(l);return new z(72/c.getLength(),72/d.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(o){var l=this;function c(d){var f=l.getView(),p=d&&d.type||"load";f&&l.responds(p)&&(de=f._scope,l.emit(p,new or(d)))}this._setImage(o),this._loaded?setTimeout(c,0):o&&Ht.add(o,{load:function(d){l._setImage(o),c(d)},error:c})},_setImage:function(o){this._canvas&&se.release(this._canvas),o&&o.getContext?(this._image=null,this._canvas=o,this._loaded=!0):(this._image=o,this._canvas=null,this._loaded=!!(o&&o.src&&o.complete)),this._size=new z(o?o.naturalWidth||o.width:0,o?o.naturalHeight||o.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var o=se.getContext(this._size);try{this._image&&o.drawImage(this._image,0,0),this._canvas=o.canvas}catch{se.release(o)}}return this._canvas},setCanvas:"#setImage",getContext:function(o){return this._context||(this._context=this.getCanvas().getContext("2d")),o&&(this._image=null,this._changed(1025)),this._context},setContext:function(o){this._context=o},getSource:function(){var o=this._image;return o&&o.src||this.toDataURL()},setSource:function(o){var l=new e.Image,c=this._crossOrigin;c&&(l.crossOrigin=c),o&&(l.src=o),this.setImage(l)},getCrossOrigin:function(){var o=this._image;return o&&o.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(o){this._crossOrigin=o;var l=this._image;l&&(l.crossOrigin=o)},getSmoothing:function(){return this._smoothing},setSmoothing:function(o){this._smoothing=typeof o=="string"?o:o?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var o=V.read(arguments),l=se.getContext(o.getSize());return l.drawImage(this.getCanvas(),o.x,o.y,o.width,o.height,0,0,o.width,o.height),l.canvas},getSubRaster:function(){var o=V.read(arguments),l=new pe(te.NO_INSERT);return l._setImage(this.getSubCanvas(o)),l.translate(o.getCenter().subtract(this.getSize().divide(2))),l._matrix.prepend(this._matrix),l.insertAbove(this),l},toDataURL:function(){var o=this._image,l=o&&o.src;if(/^data:/.test(l))return l;var c=this.getCanvas();return c?c.toDataURL.apply(c,arguments):null},drawImage:function(o){var l=I.read(arguments,1);this.getContext(!0).drawImage(o,l.x,l.y)},getAverageColor:function(o){var l,c;if(o?o instanceof Ce?(c=o,l=o.getBounds()):typeof o=="object"&&("width"in o?l=new V(o):"x"in o&&(l=new V(o.x-.5,o.y-.5,1,1))):l=this.getBounds(),!l)return null;var d=32,f=Math.min(l.width,d),p=Math.min(l.height,d),v=pe._sampleContext;v?v.clearRect(0,0,d+1,d+1):v=pe._sampleContext=se.getContext(new z(d)),v.save();var _=new U().scale(f/l.width,p/l.height).translate(-l.x,-l.y);_.applyToContext(v),c&&c.draw(v,new s({clip:!0,matrices:[_]})),this._matrix.applyToContext(v);var y=this.getElement(),E=this._size;y&&v.drawImage(y,-E.width/2,-E.height/2),v.restore();for(var A=v.getImageData(.5,.5,Math.ceil(f),Math.ceil(p)).data,b=[0,0,0],C=0,S=0,k=A.length;S<k;S+=4){var M=A[S+3];C+=M,M/=255,b[0]+=A[S]*M,b[1]+=A[S+1]*M,b[2]+=A[S+2]*M}for(var S=0;S<3;S++)b[S]/=C;return C?Xe.read(b):null},getPixel:function(){var o=I.read(arguments),l=this.getContext().getImageData(o.x,o.y,1,1).data;return new Xe("rgb",[l[0]/255,l[1]/255,l[2]/255],l[3]/255)},setPixel:function(){var o=arguments,l=I.read(o),c=Xe.read(o),d=c._convert("rgb"),f=c._alpha,p=this.getContext(!0),v=p.createImageData(1,1),_=v.data;_[0]=d[0]*255,_[1]=d[1]*255,_[2]=d[2]*255,_[3]=f!=null?f*255:255,p.putImageData(v,l.x,l.y)},clear:function(){var o=this._size;this.getContext(!0).clearRect(0,0,o.width+1,o.height+1)},createImageData:function(){var o=z.read(arguments);return this.getContext().createImageData(o.width,o.height)},getImageData:function(){var o=V.read(arguments);return o.isEmpty()&&(o=new V(this._size)),this.getContext().getImageData(o.x,o.y,o.width,o.height)},putImageData:function(o){var l=I.read(arguments,1);this.getContext(!0).putImageData(o,l.x,l.y)},setImageData:function(o){this.setSize(o),this.getContext(!0).putImageData(o,0,0)},_getBounds:function(o,l){var c=new V(this._size).setCenter(0,0);return o?o._transformBounds(c):c},_hitTestSelf:function(o){if(this._contains(o)){var l=this;return new xe("pixel",l,{offset:o.add(l._size.divide(2)).round(),color:{get:function(){return l.getPixel(this.offset)}}})}},_draw:function(o,l,c){var d=this.getElement();if(d&&d.width>0&&d.height>0){o.globalAlpha=w.clamp(this._opacity,0,1),this._setStyles(o,l,c);var f=this._smoothing,p=f==="off";kt.setPrefixed(o,p?"imageSmoothingEnabled":"imageSmoothingQuality",p?!1:f),o.drawImage(d,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),rt=te.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(l,c){this._initialize(l,c!==n&&I.read(arguments,1))||this.setDefinition(l instanceof Ve?l:new Ve(l))},_equals:function(o){return this._definition===o._definition},copyContent:function(o){this.setDefinition(o._definition)},getDefinition:function(){return this._definition},setDefinition:function(o){this._definition=o,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(o,l){var c=this._definition._item;return c._getCachedBounds(c._matrix.prepended(o),l)},_hitTestSelf:function(o,l,c){var d=l.extend({all:!1}),f=this._definition._item._hitTest(o,d,c);return f&&(f.item=this),f},_draw:function(o,l){this._definition._item.draw(o,l)}}),Ve=s.extend({_class:"SymbolDefinition",initialize:function(l,c){this._id=T.get(),this.project=de.project,l&&this.setItem(l,c)},_serialize:function(o,l){return l.add(this,function(){return s.serialize([this._class,this._item],o,!1,l)})},_changed:function(o){o&8&&te._clearBoundsCache(this),o&1&&this.project._changed(o)},getItem:function(){return this._item},setItem:function(o,l){o._symbol&&(o=o.clone()),this._item&&(this._item._symbol=null),this._item=o,o.remove(),o.setSelected(!1),l||o.setPosition(new I),o._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(o){return new rt(this,o)},clone:function(){return new Ve(this._item.clone(!1))},equals:function(o){return o===this||o&&this._item.equals(o._item)||!1}}),xe=s.extend({_class:"HitResult",initialize:function(l,c,d){this.type=l,this.item=c,d&&this.inject(d)},statics:{getOptions:function(o){var l=o&&s.read(o);return new s({type:null,tolerance:de.settings.hitTolerance,fill:!l,stroke:!l,segments:!l,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},l)}}}),we=s.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(l,c,d,f,p,v){var _=arguments.length,y,E,A,b;_>0&&(l==null||typeof l=="object"?_===1&&l&&"point"in l?(y=l.point,E=l.handleIn,A=l.handleOut,b=l.selection):(y=l,E=c,A=d,b=f):(y=[l,c],E=d!==n?[d,f]:null,A=p!==n?[p,v]:null)),new it(y,this,"_point"),new it(E,this,"_handleIn"),new it(A,this,"_handleOut"),b&&this.setSelection(b)},_serialize:function(o,l){var c=this._point,d=this._selection,f=d||this.hasHandles()?[c,this._handleIn,this._handleOut]:c;return d&&f.push(d),s.serialize(f,o,!0,l)},_changed:function(o){var l=this._path;if(l){var c=l._curves,d=this._index,f;c&&((!o||o===this._point||o===this._handleIn)&&(f=d>0?c[d-1]:l._closed?c[c.length-1]:null)&&f._changed(),(!o||o===this._point||o===this._handleOut)&&(f=c[d])&&f._changed()),l._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(I.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(I.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(I.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var o=this._handleIn,l=this._handleOut;return!o.isZero()&&!l.isZero()&&o.isCollinear(l)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(o){var l=this._selection,c=this._path;this._selection=o=o||0,c&&o!==l&&(c._updateSelection(this,l,o),c._changed(257))},_changeSelection:function(o,l){var c=this._selection;this.setSelection(l?c|o:c&~o)},isSelected:function(){return!!(this._selection&7)},setSelected:function(o){this._changeSelection(7,o)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var o=this._path,l=this._index;return o?(l>0&&!o._closed&&l===o._segments.length-1&&l--,o.getCurves()[l]||null):null},getLocation:function(){var o=this.getCurve();return o?new lt(o,this===o._segment1?0:1):null},getNext:function(){var o=this._path&&this._path._segments;return o&&(o[this._index+1]||this._path._closed&&o[0])||null},smooth:function(o,l,c){var d=o||{},f=d.type,p=d.factor,v=this.getPrevious(),_=this.getNext(),y=(v||this)._point,E=this._point,A=(_||this)._point,b=y.getDistance(E),C=E.getDistance(A);if(!f||f==="catmull-rom"){var S=p===n?.5:p,k=Math.pow(b,S),M=k*k,F=Math.pow(C,S),N=F*F;if(!l&&v){var D=2*N+3*F*k+M,x=3*F*(F+k);this.setHandleIn(x!==0?new I((N*y._x+D*E._x-M*A._x)/x-E._x,(N*y._y+D*E._y-M*A._y)/x-E._y):new I)}if(!c&&_){var D=2*M+3*k*F+N,x=3*k*(k+F);this.setHandleOut(x!==0?new I((M*A._x+D*E._x-N*y._x)/x-E._x,(M*A._y+D*E._y-N*y._y)/x-E._y):new I)}}else if(f==="geometric"){if(v&&_){var P=y.subtract(A),O=p===n?.4:p,L=O*b/(b+C);l||this.setHandleIn(P.multiply(L)),c||this.setHandleOut(P.multiply(L-O))}}else throw new Error("Smoothing method '"+f+"' not supported.")},getPrevious:function(){var o=this._path&&this._path._segments;return o&&(o[this._index-1]||this._path._closed&&o[o.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var o=this._path;return o&&this._index===o._segments.length-1||!1},reverse:function(){var o=this._handleIn,l=this._handleOut,c=o.clone();o.set(l),l.set(c)},reversed:function(){return new we(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new we(this._point,this._handleIn,this._handleOut)},equals:function(o){return o===this||o&&this._class===o._class&&this._point.equals(o._point)&&this._handleIn.equals(o._handleIn)&&this._handleOut.equals(o._handleOut)||!1},toString:function(){var o=["point: "+this._point];return this._handleIn.isZero()||o.push("handleIn: "+this._handleIn),this._handleOut.isZero()||o.push("handleOut: "+this._handleOut),"{ "+o.join(", ")+" }"},transform:function(o){this._transformCoordinates(o,new Array(6),!0),this._changed()},interpolate:function(o,l,c){var d=1-c,f=c,p=o._point,v=l._point,_=o._handleIn,y=l._handleIn,E=l._handleOut,A=o._handleOut;this._point._set(d*p._x+f*v._x,d*p._y+f*v._y,!0),this._handleIn._set(d*_._x+f*y._x,d*_._y+f*y._y,!0),this._handleOut._set(d*A._x+f*E._x,d*A._y+f*E._y,!0),this._changed()},_transformCoordinates:function(o,l,c){var d=this._point,f=!c||!this._handleIn.isZero()?this._handleIn:null,p=!c||!this._handleOut.isZero()?this._handleOut:null,v=d._x,_=d._y,y=2;return l[0]=v,l[1]=_,f&&(l[y++]=f._x+v,l[y++]=f._y+_),p&&(l[y++]=p._x+v,l[y++]=p._y+_),o&&(o._transformCoordinates(l,l,y/2),v=l[0],_=l[1],c?(d._x=v,d._y=_,y=2,f&&(f._x=l[y++]-v,f._y=l[y++]-_),p&&(p._x=l[y++]-v,p._y=l[y++]-_)):(f||(l[y++]=v,l[y++]=_),p||(l[y++]=v,l[y++]=_))),l}}),it=I.extend({initialize:function(l,c,d){var f,p,v;if(!l)f=p=0;else if((f=l[0])!==n)p=l[1];else{var _=l;(f=_.x)===n&&(_=I.read(arguments),f=_.x),p=_.y,v=_.selected}this._x=f,this._y=p,this._owner=c,c[d]=this,v&&this.setSelected(!0)},_set:function(o,l){return this._x=o,this._y=l,this._owner._changed(this),this},getX:function(){return this._x},setX:function(o){this._x=o,this._owner._changed(this)},getY:function(){return this._y},setY:function(o){this._y=o,this._owner._changed(this)},isZero:function(){var o=w.isZero;return o(this._x)&&o(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(o){this._owner._changeSelection(this._getSelection(),o)},_getSelection:function(){var o=this._owner;return this===o._point?1:this===o._handleIn?2:this===o._handleOut?4:0}}),he=s.extend({_class:"Curve",beans:!0,initialize:function(l,c,d,f,p,v,_,y){var E=arguments.length,A,b,C,S,k,M;E===3?(this._path=l,A=c,b=d):E?E===1?"segment1"in l?(A=new we(l.segment1),b=new we(l.segment2)):"point1"in l?(C=l.point1,k=l.handle1,M=l.handle2,S=l.point2):Array.isArray(l)&&(C=[l[0],l[1]],S=[l[6],l[7]],k=[l[2]-l[0],l[3]-l[1]],M=[l[4]-l[6],l[5]-l[7]]):E===2?(A=new we(l),b=new we(c)):E===4?(C=l,k=c,M=d,S=f):E===8&&(C=[l,c],S=[_,y],k=[d-l,f-c],M=[p-_,v-y]):(A=new we,b=new we),this._segment1=A||new we(C,null,k),this._segment2=b||new we(S,M,null)},_serialize:function(o,l){return s.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],o,!0,l)},_changed:function(){this._length=this._bounds=n},clone:function(){return new he(this._segment1,this._segment2)},toString:function(){var o=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||o.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||o.push("handle2: "+this._segment2._handleIn),o.push("point2: "+this._segment2._point),"{ "+o.join(", ")+" }"},classify:function(){return he.classify(this.getValues())},remove:function(){var o=!1;if(this._path){var l=this._segment2,c=l._handleOut;o=l.remove(),o&&this._segment1._handleOut.set(c)}return o},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(I.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(I.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(I.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(I.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var o=this._path&&this._path._curves;return o&&(o[this._segment1._index+1]||this._path._closed&&o[0])||null},getPrevious:function(){var o=this._path&&this._path._curves;return o&&(o[this._segment1._index-1]||this._path._closed&&o[o.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var o=this._path;return o&&this._segment1._index===o._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(o){this.getPoint1().setSelected(o),this.getHandle1().setSelected(o),this.getHandle2().setSelected(o),this.getPoint2().setSelected(o)},getValues:function(o){return he.getValues(this._segment1,this._segment2,o)},getPoints:function(){for(var o=this.getValues(),l=[],c=0;c<8;c+=2)l.push(new I(o[c],o[c+1]));return l}},{getLength:function(){return this._length==null&&(this._length=he.getLength(this.getValues(),0,1)),this._length},getArea:function(){return he.getArea(this.getValues())},getLine:function(){return new J(this._segment1._point,this._segment2._point)},getPart:function(o,l){return new he(he.getPart(this.getValues(),o,l))},getPartLength:function(o,l){return he.getLength(this.getValues(),o,l)},divideAt:function(o){return this.divideAtTime(o&&o.curve===this?o.time:this.getTimeAt(o))},divideAtTime:function(o,l){var c=1e-8,d=1-c,f=null;if(o>=c&&o<=d){var p=he.subdivide(this.getValues(),o),v=p[0],_=p[1],y=l||this.hasHandles(),E=this._segment1,A=this._segment2,b=this._path;y&&(E._handleOut._set(v[2]-v[0],v[3]-v[1]),A._handleIn._set(_[4]-_[6],_[5]-_[7]));var C=v[6],S=v[7],k=new we(new I(C,S),y&&new I(v[4]-C,v[5]-S),y&&new I(_[2]-C,_[3]-S));b?(b.insert(E._index+1,k),f=this.getNext()):(this._segment2=k,this._changed(),f=new he(k,A))}return f},splitAt:function(o){var l=this._path;return l?l.splitAt(o):null},splitAtTime:function(o){return this.splitAt(this.getLocationAtTime(o))},divide:function(o,l){return this.divideAtTime(o===n?.5:l?o:this.getTimeAt(o))},split:function(o,l){return this.splitAtTime(o===n?.5:l?o:this.getTimeAt(o))},reversed:function(){return new he(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(o,l,c,d){var f=o._point,p=o._handleOut,v=l._handleIn,_=l._point,y=f.x,E=f.y,A=_.x,b=_.y,C=d?[y,E,y,E,A,b,A,b]:[y,E,y+p._x,E+p._y,A+v._x,b+v._y,A,b];return c&&c._transformCoordinates(C,C,4),C},subdivide:function(o,l){var c=o[0],d=o[1],f=o[2],p=o[3],v=o[4],_=o[5],y=o[6],E=o[7];l===n&&(l=.5);var A=1-l,b=A*c+l*f,C=A*d+l*p,S=A*f+l*v,k=A*p+l*_,M=A*v+l*y,F=A*_+l*E,N=A*b+l*S,D=A*C+l*k,x=A*S+l*M,P=A*k+l*F,O=A*N+l*x,L=A*D+l*P;return[[c,d,b,C,N,D,O,L],[O,L,x,P,M,F,y,E]]},getMonoCurves:function(o,l){var c=[],d=l?0:1,f=o[d+0],p=o[d+2],v=o[d+4],_=o[d+6];if(f>=p==p>=v&&p>=v==v>=_||he.isStraight(o))c.push(o);else{var y=3*(p-v)-f+_,E=2*(f+v)-4*p,A=p-f,b=1e-8,C=1-b,S=[],k=w.solveQuadratic(y,E,A,S,b,C);if(!k)c.push(o);else{S.sort();var M=S[0],F=he.subdivide(o,M);c.push(F[0]),k>1&&(M=(S[1]-M)/(1-M),F=he.subdivide(F[1],M),c.push(F[0])),c.push(F[1])}}return c},solveCubic:function(o,l,c,d,f,p){var v=o[l],_=o[l+2],y=o[l+4],E=o[l+6],A=0;if(!(v<c&&E<c&&_<c&&y<c||v>c&&E>c&&_>c&&y>c)){var b=3*(_-v),C=3*(y-_)-b,S=E-v-b-C;A=w.solveCubic(S,C,b,v-c,d,f,p)}return A},getTimeOf:function(o,l){var c=new I(o[0],o[1]),d=new I(o[6],o[7]),f=1e-12,p=1e-7,v=l.isClose(c,f)?0:l.isClose(d,f)?1:null;if(v===null)for(var _=[l.x,l.y],y=[],E=0;E<2;E++)for(var A=he.solveCubic(o,E,_[E],y,0,1),b=0;b<A;b++){var C=y[b];if(l.isClose(he.getPoint(o,C),p))return C}return l.isClose(c,p)?0:l.isClose(d,p)?1:null},getNearestTime:function(o,l){if(he.isStraight(o)){var c=o[0],d=o[1],f=o[6],p=o[7],v=f-c,_=p-d,y=v*v+_*_;if(y===0)return 0;var E=((l.x-c)*v+(l.y-d)*_)/y;return E<1e-12?0:E>.999999999999?1:he.getTimeOf(o,new I(c+E*v,d+E*_))}var A=100,b=1/0,C=0;function S(F){if(F>=0&&F<=1){var N=l.getDistance(he.getPoint(o,F),!0);if(N<b)return b=N,C=F,!0}}for(var k=0;k<=A;k++)S(k/A);for(var M=1/(A*2);M>1e-8;)!S(C-M)&&!S(C+M)&&(M/=2);return C},getPart:function(o,l,c){var d=l>c;if(d){var f=l;l=c,c=f}return l>0&&(o=he.subdivide(o,l)[1]),c<1&&(o=he.subdivide(o,(c-l)/(1-l))[0]),d?[o[6],o[7],o[4],o[5],o[2],o[3],o[0],o[1]]:o},isFlatEnough:function(o,l){var c=o[0],d=o[1],f=o[2],p=o[3],v=o[4],_=o[5],y=o[6],E=o[7],A=3*f-2*c-y,b=3*p-2*d-E,C=3*v-2*y-c,S=3*_-2*E-d;return Math.max(A*A,C*C)+Math.max(b*b,S*S)<=16*l*l},getArea:function(o){var l=o[0],c=o[1],d=o[2],f=o[3],p=o[4],v=o[5],_=o[6],y=o[7];return 3*((y-c)*(d+p)-(_-l)*(f+v)+f*(l-p)-d*(c-v)+y*(p+l/3)-_*(v+c/3))/20},getBounds:function(o){for(var l=o.slice(0,2),c=l.slice(),d=[0,0],f=0;f<2;f++)he._addBounds(o[f],o[f+2],o[f+4],o[f+6],f,0,l,c,d);return new V(l[0],l[1],c[0]-l[0],c[1]-l[1])},_addBounds:function(o,l,c,d,f,p,v,_,y){function E(O,L){var $=O-L,q=O+L;$<v[f]&&(v[f]=$),q>_[f]&&(_[f]=q)}p/=2;var A=v[f]+p,b=_[f]-p;if(o<A||l<A||c<A||d<A||o>b||l>b||c>b||d>b)if(l<o!=l<d&&c<o!=c<d)E(o,0),E(d,0);else{var C=3*(l-c)-o+d,S=2*(o+c)-4*l,k=l-o,M=w.solveQuadratic(C,S,k,y),F=1e-8,N=1-F;E(d,0);for(var D=0;D<M;D++){var x=y[D],P=1-x;F<=x&&x<=N&&E(P*P*P*o+3*P*P*x*l+3*P*x*x*c+x*x*x*d,p)}}}}},s.each(["getBounds","getStrokeBounds","getHandleBounds"],function(o){this[o]=function(){this._bounds||(this._bounds={});var l=this._bounds[o];return l||(l=this._bounds[o]=Te[o]([this._segment1,this._segment2],!1,this._path)),l.clone()}},{}),s.each({isStraight:function(o,l,c,d){if(l.isZero()&&c.isZero())return!0;var f=d.subtract(o);if(f.isZero())return!1;if(f.isCollinear(l)&&f.isCollinear(c)){var p=new J(o,d),v=1e-7;if(p.getDistance(o.add(l))<v&&p.getDistance(d.add(c))<v){var _=f.dot(f),y=f.dot(l)/_,E=f.dot(c)/_;return y>=0&&y<=1&&E<=0&&E>=-1}}return!1},isLinear:function(o,l,c,d){var f=d.subtract(o).divide(3);return l.equals(f)&&c.negate().equals(f)}},function(o,l){this[l]=function(c){var d=this._segment1,f=this._segment2;return o(d._point,d._handleOut,f._handleIn,f._point,c)},this.statics[l]=function(c,d){var f=c[0],p=c[1],v=c[6],_=c[7];return o(new I(f,p),new I(c[2]-f,c[3]-p),new I(c[4]-v,c[5]-_),new I(v,_),d)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(o){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(o||0)},isCollinear:function(o){return o&&this.isStraight()&&o.isStraight()&&this.getLine().isCollinear(o.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(o,l){return this.getLocationAtTime(l?o:this.getTimeAt(o))},getLocationAtTime:function(o){return o!=null&&o>=0&&o<=1?new lt(this,o):null},getTimeAt:function(o,l){return he.getTimeAt(this.getValues(),o,l)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var o=I.read(arguments);return o.isZero()?[]:he.getTimesWithTangent(this.getValues(),o)},getOffsetAtTime:function(o){return this.getPartLength(0,o)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(I.read(arguments)))},getOffsetOf:function(){var o=this.getLocationOf.apply(this,arguments);return o?o.getOffset():null},getTimeOf:function(){return he.getTimeOf(this.getValues(),I.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var o=I.read(arguments),l=this.getValues(),c=he.getNearestTime(l,o),d=he.getPoint(l,c);return new lt(this,c,d,null,o.getDistance(d))},getNearestPoint:function(){var o=this.getNearestLocation.apply(this,arguments);return o&&o.getPoint()}},new function(){var o=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return s.each(o,function(l){this[l+"At"]=function(c,d){var f=this.getValues();return he[l](f,d?c:he.getTimeAt(f,c))},this[l+"AtTime"]=function(c){return he[l](this.getValues(),c)}},{statics:{_evaluateMethods:o}})},new function(){function o(d){var f=d[0],p=d[1],v=d[2],_=d[3],y=d[4],E=d[5],A=d[6],b=d[7],C=9*(v-y)+3*(A-f),S=6*(f+y)-12*v,k=3*(v-f),M=9*(_-E)+3*(b-p),F=6*(p+E)-12*_,N=3*(_-p);return function(D){var x=(C*D+S)*D+k,P=(M*D+F)*D+N;return Math.sqrt(x*x+P*P)}}function l(d,f){return Math.max(2,Math.min(16,Math.ceil(Math.abs(f-d)*32)))}function c(d,f,p,v){if(f==null||f<0||f>1)return null;var _=d[0],y=d[1],E=d[2],A=d[3],b=d[4],C=d[5],S=d[6],k=d[7],M=w.isZero;M(E-_)&&M(A-y)&&(E=_,A=y),M(b-S)&&M(C-k)&&(b=S,C=k);var F=3*(E-_),N=3*(b-E)-F,D=S-_-F-N,x=3*(A-y),P=3*(C-A)-x,O=k-y-x-P,L,$;if(p===0)L=f===0?_:f===1?S:((D*f+N)*f+F)*f+_,$=f===0?y:f===1?k:((O*f+P)*f+x)*f+y;else{var q=1e-8,H=1-q;if(f<q?(L=F,$=x):f>H?(L=3*(S-b),$=3*(k-C)):(L=(3*D*f+2*N)*f+F,$=(3*O*f+2*P)*f+x),v){L===0&&$===0&&(f<q||f>H)&&(L=b-E,$=C-A);var W=Math.sqrt(L*L+$*$);W&&(L/=W,$/=W)}if(p===3){var b=6*D*f+2*N,C=6*O*f+2*P,Q=Math.pow(L*L+$*$,3/2);L=Q!==0?(L*C-$*b)/Q:0,$=0}}return p===2?new I($,-L):new I(L,$)}return{statics:{classify:function(d){var f=d[0],p=d[1],v=d[2],_=d[3],y=d[4],E=d[5],A=d[6],b=d[7],C=f*(b-E)+p*(y-A)+A*E-b*y,S=v*(p-b)+_*(A-f)+f*b-p*A,k=y*(_-p)+E*(f-v)+v*p-_*f,M=3*k,F=M-S,N=F-S+C,D=Math.sqrt(N*N+F*F+M*M),x=D!==0?1/D:0,P=w.isZero,O="serpentine";N*=x,F*=x,M*=x;function L(W,Q,K){var Y=Q!==n,ee=Y&&Q>0&&Q<1,ie=Y&&K>0&&K<1;return Y&&(!(ee||ie)||W==="loop"&&!(ee&&ie))&&(W="arch",ee=ie=!1),{type:W,roots:ee||ie?ee&&ie?Q<K?[Q,K]:[K,Q]:[ee?Q:K]:null}}if(P(N))return P(F)?L(P(M)?"line":"quadratic"):L(O,M/(3*F));var $=3*F*F-4*N*M;if(P($))return L("cusp",F/(2*N));var q=$>0?Math.sqrt($/3):Math.sqrt(-$),H=2*N;return L($>0?O:"loop",(F+q)/H,(F-q)/H)},getLength:function(d,f,p,v){if(f===n&&(f=0),p===n&&(p=1),he.isStraight(d)){var _=d;p<1&&(_=he.subdivide(_,p)[0],f/=p),f>0&&(_=he.subdivide(_,f)[1]);var y=_[6]-_[0],E=_[7]-_[1];return Math.sqrt(y*y+E*E)}return w.integrate(v||o(d),f,p,l(f,p))},getTimeAt:function(d,f,p){if(p===n&&(p=f<0?1:0),f===0)return p;var v=Math.abs,_=1e-12,y=f>0,E=y?p:0,A=y?1:p,b=o(d),C=he.getLength(d,E,A,b),S=v(f)-C;if(v(S)<_)return y?A:E;if(S>_)return null;var k=f/C,M=0;function F(N){return M+=w.integrate(b,p,N,l(p,N)),p=N,M-f}return w.findRoot(F,b,p+k,E,A,32,1e-12)},getPoint:function(d,f){return c(d,f,0,!1)},getTangent:function(d,f){return c(d,f,1,!0)},getWeightedTangent:function(d,f){return c(d,f,1,!1)},getNormal:function(d,f){return c(d,f,2,!0)},getWeightedNormal:function(d,f){return c(d,f,2,!1)},getCurvature:function(d,f){return c(d,f,3,!1).x},getPeaks:function(d){var f=d[0],p=d[1],v=d[2],_=d[3],y=d[4],E=d[5],A=d[6],b=d[7],C=-f+3*v-3*y+A,S=3*f-6*v+3*y,k=-3*f+3*v,M=-p+3*_-3*E+b,F=3*p-6*_+3*E,N=-3*p+3*_,D=1e-8,x=1-D,P=[];return w.solveCubic(9*(C*C+M*M),9*(C*S+F*M),2*(S*S+F*F)+3*(k*C+N*M),k*S+F*N,P,D,x),P.sort()}}}},new function(){function o(S,k,M,F,N,D,x){var P=!x&&M.getPrevious()===N,O=!x&&M!==N&&M.getNext()===N,L=1e-8,$=1-L;if(F!==null&&F>=(P?L:0)&&F<=(O?$:1)&&D!==null&&D>=(O?L:0)&&D<=(P?$:1)){var q=new lt(M,F,null,x),H=new lt(N,D,null,x);q._intersection=H,H._intersection=q,(!k||k(q))&&lt.insert(S,q,!0)}}function l(S,k,M,F,N,D,x,P,O,L,$,q,H){if(++O>=4096||++P>=40)return O;var W=1e-9,Q=k[0],K=k[1],Y=k[6],ee=k[7],ie=J.getSignedDistance,le=ie(Q,K,Y,ee,k[2],k[3]),ue=ie(Q,K,Y,ee,k[4],k[5]),Ee=le*ue>0?3/4:4/9,Se=Ee*Math.min(0,le,ue),Re=Ee*Math.max(0,le,ue),Ye=ie(Q,K,Y,ee,S[0],S[1]),He=ie(Q,K,Y,ee,S[2],S[3]),qe=ie(Q,K,Y,ee,S[4],S[5]),$e=ie(Q,K,Y,ee,S[6],S[7]),nt=c(Ye,He,qe,$e),Ke=nt[0],St=nt[1],ut,pt;if(le===0&&ue===0&&Ye===0&&He===0&&qe===0&&$e===0||(ut=d(Ke,St,Se,Re))==null||(pt=d(Ke.reverse(),St.reverse(),Se,Re))==null)return O;var yt=L+($-L)*ut,ht=L+($-L)*pt;if(Math.max(H-q,ht-yt)<W){var Yn=(yt+ht)/2,Xn=(q+H)/2;o(N,D,x?F:M,x?Xn:Yn,x?M:F,x?Yn:Xn)}else{S=he.getPart(S,ut,pt);var Tr=H-q;if(pt-ut>.8)if(ht-yt>Tr){var An=he.subdivide(S,.5),Yn=(yt+ht)/2;O=l(k,An[0],F,M,N,D,!x,P,O,q,H,yt,Yn),O=l(k,An[1],F,M,N,D,!x,P,O,q,H,Yn,ht)}else{var An=he.subdivide(k,.5),Xn=(q+H)/2;O=l(An[0],S,F,M,N,D,!x,P,O,q,Xn,yt,ht),O=l(An[1],S,F,M,N,D,!x,P,O,Xn,H,yt,ht)}else Tr===0||Tr>=W?O=l(k,S,F,M,N,D,!x,P,O,q,H,yt,ht):O=l(S,k,M,F,N,D,x,P,O,yt,ht,q,H)}return O}function c(S,k,M,F){var N=[0,S],D=[1/3,k],x=[2/3,M],P=[1,F],O=k-(2*S+F)/3,L=M-(S+2*F)/3,$;if(O*L<0)$=[[N,D,P],[N,x,P]];else{var q=O/L;$=[q>=2?[N,D,P]:q<=.5?[N,x,P]:[N,D,x,P],[N,P]]}return(O||L)<0?$.reverse():$}function d(S,k,M,F){return S[0][1]<M?f(S,!0,M):k[0][1]>F?f(k,!1,F):S[0][0]}function f(S,k,M){for(var F=S[0][0],N=S[0][1],D=1,x=S.length;D<x;D++){var P=S[D][0],O=S[D][1];if(k?O>=M:O<=M)return O===M?P:F+(M-N)*(P-F)/(O-N);F=P,N=O}return null}function p(S,k,M,F,N){var D=w.isZero;if(D(F)&&D(N)){var x=he.getTimeOf(S,new I(k,M));return x===null?[]:[x]}for(var P=Math.atan2(-N,F),O=Math.sin(P),L=Math.cos(P),$=[],q=[],H=0;H<8;H+=2){var W=S[H]-k,Q=S[H+1]-M;$.push(W*L-Q*O,W*O+Q*L)}return he.solveCubic($,1,0,q,0,1),q}function v(S,k,M,F,N,D,x){for(var P=k[0],O=k[1],L=k[6],$=k[7],q=p(S,P,O,L-P,$-O),H=0,W=q.length;H<W;H++){var Q=q[H],K=he.getPoint(S,Q),Y=he.getTimeOf(k,K);Y!==null&&o(N,D,x?F:M,x?Y:Q,x?M:F,x?Q:Y)}}function _(S,k,M,F,N,D){var x=J.intersect(S[0],S[1],S[6],S[7],k[0],k[1],k[6],k[7]);x&&o(N,D,M,he.getTimeOf(S,x),F,he.getTimeOf(k,x))}function y(S,k,M,F,N,D){var x=1e-12,P=Math.min,O=Math.max;if(O(S[0],S[2],S[4],S[6])+x>P(k[0],k[2],k[4],k[6])&&P(S[0],S[2],S[4],S[6])-x<O(k[0],k[2],k[4],k[6])&&O(S[1],S[3],S[5],S[7])+x>P(k[1],k[3],k[5],k[7])&&P(S[1],S[3],S[5],S[7])-x<O(k[1],k[3],k[5],k[7])){var L=b(S,k);if(L)for(var $=0;$<2;$++){var q=L[$];o(N,D,M,q[0],F,q[1],!0)}else{var H=he.isStraight(S),W=he.isStraight(k),Q=H&&W,K=H&&!W,Y=N.length;if((Q?_:H||W?v:l)(K?k:S,K?S:k,K?F:M,K?M:F,N,D,K,0,0,0,1,0,1),!Q||N.length===Y)for(var $=0;$<4;$++){var ee=$>>1,ie=$&1,le=ee*6,ue=ie*6,Ee=new I(S[le],S[le+1]),Se=new I(k[ue],k[ue+1]);Ee.isClose(Se,x)&&o(N,D,M,ee,F,ie)}}}return N}function E(S,k,M,F){var N=he.classify(S);if(N.type==="loop"){var D=N.roots;o(M,F,k,D[0],k,D[1])}return M}function A(S,k,M,F,N,D){var x=1e-7,P=!k;P&&(k=S);for(var O=S.length,L=k.length,$=new Array(O),q=P?$:new Array(L),H=[],W=0;W<O;W++)$[W]=S[W].getValues(F);if(!P)for(var W=0;W<L;W++)q[W]=k[W].getValues(N);for(var Q=g.findCurveBoundsCollisions($,q,x),K=0;K<O;K++){var Y=S[K],ee=$[K];P&&E(ee,Y,H,M);var ie=Q[K];if(ie)for(var le=0;le<ie.length;le++){if(D&&H.length)return H;var ue=ie[le];if(!P||ue>K){var Ee=k[ue],Se=q[ue];y(ee,Se,Y,Ee,H,M)}}}return H}function b(S,k){function M($e){var nt=$e[6]-$e[0],Ke=$e[7]-$e[1];return nt*nt+Ke*Ke}var F=Math.abs,N=J.getDistance,D=1e-8,x=1e-7,P=he.isStraight(S),O=he.isStraight(k),L=P&&O,$=M(S)<M(k),q=$?k:S,H=$?S:k,W=q[0],Q=q[1],K=q[6]-W,Y=q[7]-Q;if(N(W,Q,K,Y,H[0],H[1],!0)<x&&N(W,Q,K,Y,H[6],H[7],!0)<x)!L&&N(W,Q,K,Y,q[2],q[3],!0)<x&&N(W,Q,K,Y,q[4],q[5],!0)<x&&N(W,Q,K,Y,H[2],H[3],!0)<x&&N(W,Q,K,Y,H[4],H[5],!0)<x&&(P=O=L=!0);else if(L)return null;if(P^O)return null;for(var ee=[S,k],ie=[],le=0;le<4&&ie.length<2;le++){var ue=le&1,Ee=ue^1,Se=le>>1,Re=he.getTimeOf(ee[ue],new I(ee[Ee][Se?6:0],ee[Ee][Se?7:1]));if(Re!=null){var Ye=ue?[Se,Re]:[Re,Se];(!ie.length||F(Ye[0]-ie[0][0])>D&&F(Ye[1]-ie[0][1])>D)&&ie.push(Ye)}if(le>2&&!ie.length)break}if(ie.length!==2)ie=null;else if(!L){var He=he.getPart(S,ie[0][0],ie[1][0]),qe=he.getPart(k,ie[0][1],ie[1][1]);(F(qe[2]-He[2])>x||F(qe[3]-He[3])>x||F(qe[4]-He[4])>x||F(qe[5]-He[5])>x)&&(ie=null)}return ie}function C(S,k){var M=S[0],F=S[1],N=S[2],D=S[3],x=S[4],P=S[5],O=S[6],L=S[7],$=k.normalize(),q=$.x,H=$.y,W=3*O-9*x+9*N-3*M,Q=3*L-9*P+9*D-3*F,K=6*x-12*N+6*M,Y=6*P-12*D+6*F,ee=3*N-3*M,ie=3*D-3*F,le=2*W*H-2*Q*q,ue=[];if(Math.abs(le)<w.CURVETIME_EPSILON){var Ee=W*ie-Q*ee,le=W*Y-Q*K;if(le!=0){var Se=-Ee/le;Se>=0&&Se<=1&&ue.push(Se)}}else{var Re=(K*K-4*W*ee)*H*H+(-2*K*Y+4*Q*ee+4*W*ie)*q*H+(Y*Y-4*Q*ie)*q*q,Ye=K*H-Y*q;if(Re>=0&&le!=0){var He=Math.sqrt(Re),qe=-(Ye+He)/le,$e=(-Ye+He)/le;qe>=0&&qe<=1&&ue.push(qe),$e>=0&&$e<=1&&ue.push($e)}}return ue}return{getIntersections:function(S){var k=this.getValues(),M=S&&S!==this&&S.getValues();return M?y(k,M,this,S,[]):E(k,this,[])},statics:{getOverlaps:b,getIntersections:A,getCurveLineIntersections:p,getTimesWithTangent:C}}}),lt=s.extend({_class:"CurveLocation",initialize:function(l,c,d,f,p){if(c>=.99999999){var v=l.getNext();v&&(c=0,l=v)}this._setCurve(l),this._time=c,this._point=d||l.getPointAtTime(c),this._overlap=f,this._distance=p,this._intersection=this._next=this._previous=null},_setPath:function(o){this._path=o,this._version=o?o._version:0},_setCurve:function(o){this._setPath(o._path),this._curve=o,this._segment=null,this._segment1=o._segment1,this._segment2=o._segment2},_setSegment:function(o){var l=o.getCurve();l?this._setCurve(l):(this._setPath(o._path),this._segment1=o,this._segment2=null),this._segment=o,this._time=o===this._segment1?0:1,this._point=o._point.clone()},getSegment:function(){var o=this._segment;if(!o){var l=this.getCurve(),c=this.getTime();c===0?o=l._segment1:c===1?o=l._segment2:c!=null&&(o=l.getPartLength(0,c)<l.getPartLength(c,1)?l._segment1:l._segment2),this._segment=o}return o},getCurve:function(){var o=this._path,l=this;o&&o._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function c(d){var f=d&&d.getCurve();if(f&&(l._time=f.getTimeOf(l._point))!=null)return l._setCurve(f),f}return this._curve||c(this._segment)||c(this._segment1)||c(this._segment2.getPrevious())},getPath:function(){var o=this.getCurve();return o&&o._path},getIndex:function(){var o=this.getCurve();return o&&o.getIndex()},getTime:function(){var o=this.getCurve(),l=this._time;return o&&l==null?this._time=o.getTimeOf(this._point):l},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var o=this._offset;if(o==null){o=0;var l=this.getPath(),c=this.getIndex();if(l&&c!=null)for(var d=l.getCurves(),f=0;f<c;f++)o+=d[f].getLength();this._offset=o+=this.getCurveOffset()}return o},getCurveOffset:function(){var o=this._curveOffset;if(o==null){var l=this.getCurve(),c=this.getTime();this._curveOffset=o=c!=null&&l&&l.getPartLength(0,c)}return o},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var o=this.getCurve(),l=o&&o.divideAtTime(this.getTime());return l&&this._setSegment(l._segment1),l},split:function(){var o=this.getCurve(),l=o._path,c=o&&o.splitAtTime(this.getTime());return c&&this._setSegment(l.getLastSegment()),c},equals:function(o,l){var c=this===o;if(!c&&o instanceof lt){var d=this.getCurve(),f=o.getCurve(),p=d._path,v=f._path;if(p===v){var _=Math.abs,y=1e-7,E=_(this.getOffset()-o.getOffset()),A=!l&&this._intersection,b=!l&&o._intersection;c=(E<y||p&&_(p.getLength()-E)<y)&&(!A&&!b||A&&b&&A.equals(b,!0))}}return c},toString:function(){var o=[],l=this.getPoint(),c=m.instance;l&&o.push("point: "+l);var d=this.getIndex();d!=null&&o.push("index: "+d);var f=this.getTime();return f!=null&&o.push("time: "+c.number(f)),this._distance!=null&&o.push("distance: "+c.number(this._distance)),"{ "+o.join(", ")+" }"},isTouching:function(){var o=this._intersection;if(o&&this.getTangent().isCollinear(o.getTangent())){var l=this.getCurve(),c=o.getCurve();return!(l.isStraight()&&c.isStraight()&&l.getLine().intersect(c.getLine()))}return!1},isCrossing:function(){var o=this._intersection;if(!o)return!1;var l=this.getTime(),c=o.getTime(),d=1e-8,f=1-d,p=l>=d&&l<=f,v=c>=d&&c<=f;if(p&&v)return!this.isTouching();var _=this.getCurve(),y=_&&l<d?_.getPrevious():_,E=o.getCurve(),A=E&&c<d?E.getPrevious():E;if(l>f&&(_=_.getNext()),c>f&&(E=E.getNext()),!y||!_||!A||!E)return!1;var b=[];function C(q,H){var W=q.getValues(),Q=he.classify(W).roots||he.getPeaks(W),K=Q.length,Y=he.getLength(W,H&&K?Q[K-1]:0,!H&&K?Q[0]:1);b.push(K?Y:Y/32)}function S(q,H,W){return H<W?q>H&&q<W:q>H||q<W}p||(C(y,!0),C(_,!1)),v||(C(A,!0),C(E,!1));var k=this.getPoint(),M=Math.min.apply(Math,b),F=p?_.getTangentAtTime(l):_.getPointAt(M).subtract(k),N=p?F.negate():y.getPointAt(-M).subtract(k),D=v?E.getTangentAtTime(c):E.getPointAt(M).subtract(k),x=v?D.negate():A.getPointAt(-M).subtract(k),P=N.getAngle(),O=F.getAngle(),L=x.getAngle(),$=D.getAngle();return!!(p?S(P,L,$)^S(O,L,$)&&S(P,$,L)^S(O,$,L):S(L,P,O)^S($,P,O)&&S(L,O,P)^S($,O,P))},hasOverlap:function(){return!!this._overlap}},s.each(he._evaluateMethods,function(o){var l=o+"At";this[o]=function(){var c=this.getCurve(),d=this.getTime();return d!=null&&c&&c[l](d,!0)}},{preserve:!0}),new function(){function o(l,c,d){var f=l.length,p=0,v=f-1;function _(k,M){for(var F=k+M;F>=-1&&F<=f;F+=M){var N=l[(F%f+f)%f];if(!c.getPoint().isClose(N.getPoint(),1e-7))break;if(c.equals(N))return N}return null}for(;p<=v;){var y=p+v>>>1,E=l[y],A;if(d&&(A=c.equals(E)?E:_(y,-1)||_(y,1)))return c._overlap&&(A._overlap=A._intersection._overlap=!0),A;var b=c.getPath(),C=E.getPath(),S=b!==C?b._id-C._id:c.getIndex()+c.getTime()-(E.getIndex()+E.getTime());S<0?v=y-1:p=y+1}return l.splice(p,0,c),c}return{statics:{insert:o,expand:function(l){for(var c=l.slice(),d=l.length-1;d>=0;d--)o(c,l[d]._intersection,!1);return c}}}}),Ce=te.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(o){var l,c,d;if(s.isPlainObject(o)?(c=o.segments,l=o.pathData):Array.isArray(o)?c=o:typeof o=="string"&&(l=o),c){var f=c[0];d=f&&Array.isArray(f[0])}else l&&(d=(l.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(l));var p=d?Oe:Te;return new p(o)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(o){this.isClockwise()!=(o=!!o)&&this.reverse()},setPathData:function(o){var l=o&&o.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),c,d=!1,f,p,v=new I,_=new I;function y(x,P){var O=+c[x];return d&&(O+=v[P]),O}function E(x){return new I(y(x,"x"),y(x+1,"y"))}this.clear();for(var A=0,b=l&&l.length;A<b;A++){var C=l[A],S=C[0],k=S.toLowerCase();c=C.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var M=c&&c.length;switch(d=S===k,f==="z"&&!/[mz]/.test(k)&&this.moveTo(v),k){case"m":case"l":for(var F=k==="m",N=0;N<M;N+=2)this[F?"moveTo":"lineTo"](v=E(N)),F&&(_=v,F=!1);p=v;break;case"h":case"v":var D=k==="h"?"x":"y";v=v.clone();for(var N=0;N<M;N++)v[D]=y(N,D),this.lineTo(v);p=v;break;case"c":for(var N=0;N<M;N+=6)this.cubicCurveTo(E(N),p=E(N+2),v=E(N+4));break;case"s":for(var N=0;N<M;N+=4)this.cubicCurveTo(/[cs]/.test(f)?v.multiply(2).subtract(p):v,p=E(N),v=E(N+2)),f=k;break;case"q":for(var N=0;N<M;N+=4)this.quadraticCurveTo(p=E(N),v=E(N+2));break;case"t":for(var N=0;N<M;N+=2)this.quadraticCurveTo(p=/[qt]/.test(f)?v.multiply(2).subtract(p):v,v=E(N)),f=k;break;case"a":for(var N=0;N<M;N+=7)this.arcTo(v=E(N+5),new z(+c[N],+c[N+1]),+c[N+2],+c[N+4],+c[N+3]);break;case"z":this.closePath(1e-12),v=_;break}f=k}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(o){var l=o.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(o):{};return l.onPath||!!(this.getFillRule()==="evenodd"?l.windingL&1||l.windingR&1:l.winding)},getIntersections:function(o,l,c,d){var f=this===o||!o,p=this._matrix._orNullIfIdentity(),v=f?p:(c||o._matrix)._orNullIfIdentity();return f||this.getBounds(p).intersects(o.getBounds(v),1e-12)?he.getIntersections(this.getCurves(),!f&&o.getCurves(),l,p,v,d):[]},getCrossings:function(o){return this.getIntersections(o,function(l){return l.isCrossing()})},getNearestLocation:function(){for(var o=I.read(arguments),l=this.getCurves(),c=1/0,d=null,f=0,p=l.length;f<p;f++){var v=l[f].getNearestLocation(o);v._distance<c&&(c=v._distance,d=v)}return d},getNearestPoint:function(){var o=this.getNearestLocation.apply(this,arguments);return o&&o.getPoint()},interpolate:function(o,l,c){var d=!this._children,f=d?"_segments":"_children",p=o[f],v=l[f],_=this[f];if(!p||!v||p.length!==v.length)throw new Error("Invalid operands in interpolate() call: "+o+", "+l);var y=_.length,E=v.length;if(y<E)for(var A=d?we:Te,b=y;b<E;b++)this.add(new A);else y>E&&this[d?"removeSegments":"removeChildren"](E,y);for(var b=0;b<E;b++)_[b].interpolate(p[b],v[b],c);d&&(this.setClosed(o._closed),this._changed(9))},compare:function(o){var l=!1;if(o){var c=this._children||[this],d=o._children?o._children.slice():[o],f=c.length,p=d.length,v=[],_=0;l=!0;for(var y=g.findItemBoundsCollisions(c,d,w.GEOMETRIC_EPSILON),E=f-1;E>=0&&l;E--){var A=c[E];l=!1;var b=y[E];if(b)for(var C=b.length-1;C>=0&&!l;C--)A.compare(d[b[C]])&&(v[b[C]]||(v[b[C]]=!0,_++),l=!0)}l=l&&_===p}return l}}),Te=Ce.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(l){this._closed=!1,this._segments=[],this._version=0;var c=arguments,d=Array.isArray(l)?typeof l[0]=="object"?l:c:l&&l.size===n&&(l.x!==n||l.point!==n)?c:null;d&&d.length>0?this.setSegments(d):(this._curves=n,this._segmentSelection=0,!d&&typeof l=="string"&&(this.setPathData(l),l=null)),this._initialize(!d&&l)},_equals:function(o){return this._closed===o._closed&&s.equals(this._segments,o._segments)},copyContent:function(o){this.setSegments(o._segments),this._closed=o._closed},_changed:function o(l){if(o.base.call(this,l),l&8){if(this._length=this._area=n,l&32)this._version++;else if(this._curves)for(var c=0,d=this._curves.length;c<d;c++)this._curves[c]._changed()}else l&64&&(this._bounds=n)},getStyle:function(){var o=this._parent;return(o instanceof Oe?o:this)._style},getSegments:function(){return this._segments},setSegments:function(o){var l=this.isFullySelected(),c=o&&o.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,c){var d=o[c-1];typeof d=="boolean"&&(this.setClosed(d),c--),this._add(we.readList(o,0,{},c))}l&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var o=this._curves,l=this._segments;if(!o){var c=this._countCurves();o=this._curves=new Array(c);for(var d=0;d<c;d++)o[d]=new he(this,l[d],l[d+1]||l[0])}return o},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var o=this.getCurves();return o[o.length-1]},isClosed:function(){return this._closed},setClosed:function(o){if(this._closed!=(o=!!o)){if(this._closed=o,this._curves){var l=this._curves.length=this._countCurves();o&&(this._curves[l-1]=new he(this,this._segments[l-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(o,l){var c=this._segments,d=c.length,f=new m(l),p=new Array(6),v=!0,_,y,E,A,b,C,S,k,M=[];function F(D,x){if(D._transformCoordinates(o,p),_=p[0],y=p[1],v)M.push("M"+f.pair(_,y)),v=!1;else if(b=p[2],C=p[3],b===_&&C===y&&S===E&&k===A){if(!x){var P=_-E,O=y-A;M.push(P===0?"v"+f.number(O):O===0?"h"+f.number(P):"l"+f.pair(P,O))}}else M.push("c"+f.pair(S-E,k-A)+" "+f.pair(b-E,C-A)+" "+f.pair(_-E,y-A));E=_,A=y,S=p[4],k=p[5]}if(!d)return"";for(var N=0;N<d;N++)F(c[N]);return this._closed&&d>0&&(F(c[0],!0),M.push("z")),M.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(o){for(var l=this._segments,c=new Array(6),d=0,f=l.length;d<f;d++)l[d]._transformCoordinates(o,c,!0);return!0},_add:function(o,v){for(var c=this._segments,d=this._curves,f=o.length,p=v==null,v=p?c.length:v,_=0;_<f;_++){var y=o[_];y._path&&(y=o[_]=y.clone()),y._path=this,y._index=v+_,y._selection&&this._updateSelection(y,0,y._selection)}if(p)s.push(c,o);else{c.splice.apply(c,[v,0].concat(o));for(var _=v+f,E=c.length;_<E;_++)c[_]._index=_}if(d){var A=this._countCurves(),b=v>0&&v+f-1===A?v-1:v,C=b,S=Math.min(b+f,A);o._curves&&(d.splice.apply(d,[b,0].concat(o._curves)),C+=o._curves.length);for(var _=C;_<S;_++)d.splice(_,0,new he(this,null,null));this._adjustCurves(b,S)}return this._changed(41),o},_adjustCurves:function(o,l){for(var c=this._segments,d=this._curves,f,p=o;p<l;p++)f=d[p],f._path=this,f._segment1=c[p],f._segment2=c[p+1]||c[0],f._changed();(f=d[this._closed&&!o?c.length-1:o-1])&&(f._segment2=c[o]||c[0],f._changed()),(f=d[l])&&(f._segment1=c[l],f._changed())},_countCurves:function(){var o=this._segments.length;return!this._closed&&o>0?o-1:o},add:function(o){var l=arguments;return l.length>1&&typeof o!="number"?this._add(we.readList(l)):this._add([we.read(l)])[0]},insert:function(o,l){var c=arguments;return c.length>2&&typeof l!="number"?this._add(we.readList(c,1),o):this._add([we.read(c,1)],o)[0]},addSegment:function(){return this._add([we.read(arguments)])[0]},insertSegment:function(o){return this._add([we.read(arguments,1)],o)[0]},addSegments:function(o){return this._add(we.readList(o))},insertSegments:function(o,l){return this._add(we.readList(l),o)},removeSegment:function(o){return this.removeSegments(o,o+1)[0]||null},removeSegments:function(o,l,c){o=o||0,l=s.pick(l,this._segments.length);var d=this._segments,f=this._curves,p=d.length,v=d.splice(o,l-o),_=v.length;if(!_)return v;for(var y=0;y<_;y++){var E=v[y];E._selection&&this._updateSelection(E,E._selection,0),E._index=E._path=null}for(var y=o,A=d.length;y<A;y++)d[y]._index=y;if(f){for(var b=o>0&&l===p+(this._closed?1:0)?o-1:o,f=f.splice(b,_),y=f.length-1;y>=0;y--)f[y]._path=null;c&&(v._curves=f.slice(1)),this._adjustCurves(b,b)}return this._changed(41),v},clear:"#removeSegments",hasHandles:function(){for(var o=this._segments,l=0,c=o.length;l<c;l++)if(o[l].hasHandles())return!0;return!1},clearHandles:function(){for(var o=this._segments,l=0,c=o.length;l<c;l++)o[l].clearHandles()},getLength:function(){if(this._length==null){for(var o=this.getCurves(),l=0,c=0,d=o.length;c<d;c++)l+=o[c].getLength();this._length=l}return this._length},getArea:function(){var o=this._area;if(o==null){var l=this._segments,c=this._closed;o=0;for(var d=0,f=l.length;d<f;d++){var p=d+1===f;o+=he.getArea(he.getValues(l[d],l[p?0:d+1],null,p&&!c))}this._area=o}return o},isFullySelected:function(){var o=this._segments.length;return this.isSelected()&&o>0&&this._segmentSelection===o*7},setFullySelected:function(o){o&&this._selectSegments(!0),this.setSelected(o)},setSelection:function o(l){l&1||this._selectSegments(!1),o.base.call(this,l)},_selectSegments:function(o){var l=this._segments,c=l.length,d=o?7:0;this._segmentSelection=d*c;for(var f=0;f<c;f++)l[f]._selection=d},_updateSelection:function(o,l,c){o._selection=c;var d=this._segmentSelection+=c-l;d>0&&this.setSelected(!0)},divideAt:function(o){var l=this.getLocationAt(o),c;return l&&(c=l.getCurve().divideAt(l.getCurveOffset()))?c._segment1:null},splitAt:function(o){var l=this.getLocationAt(o),c=l&&l.index,d=l&&l.time,f=1e-8,p=1-f;d>p&&(c++,d=0);var v=this.getCurves();if(c>=0&&c<v.length){d>=f&&v[c++].divideAtTime(d);var _=this.removeSegments(c,this._segments.length,!0),y;return this._closed?(this.setClosed(!1),y=this):(y=new Te(te.NO_INSERT),y.insertAbove(this),y.copyAttributes(this)),y._add(_,0),this.addSegment(_[0]),y}return null},split:function(o,l){var c,d=l===n?o:(c=this.getCurves()[o])&&c.getLocationAtTime(l);return d!=null?this.splitAt(d):null},join:function(o,l){var c=l||0;if(o&&o!==this){var d=o._segments,f=this.getLastSegment(),p=o.getLastSegment();if(!p)return this;f&&f._point.isClose(p._point,c)&&o.reverse();var v=o.getFirstSegment();if(f&&f._point.isClose(v._point,c))f.setHandleOut(v._handleOut),this._add(d.slice(1));else{var _=this.getFirstSegment();_&&_._point.isClose(v._point,c)&&o.reverse(),p=o.getLastSegment(),_&&_._point.isClose(p._point,c)?(_.setHandleIn(p._handleIn),this._add(d.slice(0,d.length-1),0)):this._add(d.slice())}o._closed&&this._add([d[0]]),o.remove()}var y=this.getFirstSegment(),E=this.getLastSegment();return y!==E&&y._point.isClose(E._point,c)&&(y.setHandleIn(E._handleIn),E.remove(),this.setClosed(!0)),this},reduce:function(o){for(var l=this.getCurves(),c=o&&o.simplify,d=c?1e-7:0,f=l.length-1;f>=0;f--){var p=l[f];!p.hasHandles()&&(!p.hasLength(d)||c&&p.isCollinear(p.getNext()))&&p.remove()}return this},reverse:function(){this._segments.reverse();for(var o=0,l=this._segments.length;o<l;o++){var c=this._segments[o],d=c._handleIn;c._handleIn=c._handleOut,c._handleOut=d,c._index=o}this._curves=null,this._changed(9)},flatten:function(o){for(var l=new Je(this,o||.25,256,!0),c=l.parts,d=c.length,f=[],p=0;p<d;p++)f.push(new we(c[p].curve.slice(0,2)));!this._closed&&d>0&&f.push(new we(c[d-1].curve.slice(6))),this.setSegments(f)},simplify:function(o){var l=new Tt(this).fit(o||2.5);return l&&this.setSegments(l),!!l},smooth:function(o){var l=this,c=o||{},d=c.type||"asymmetric",f=this._segments,p=f.length,v=this._closed;function _(Ke,St){var ut=Ke&&Ke.index;if(ut!=null){var pt=Ke.path;if(pt&&pt!==l)throw new Error(Ke._class+" "+ut+" of "+pt+" is not part of "+l);St&&Ke instanceof he&&ut++}else ut=typeof Ke=="number"?Ke:St;return Math.min(ut<0&&v?ut%p:ut<0?ut+p:ut,p-1)}var y=v&&c.from===n&&c.to===n,E=_(c.from,0),A=_(c.to,p-1);if(E>A)if(v)E-=p;else{var b=E;E=A,A=b}if(/^(?:asymmetric|continuous)$/.test(d)){var C=d==="asymmetric",S=Math.min,k=A-E+1,M=k-1,F=y?S(k,4):1,N=F,D=F,x=[];if(v||(N=S(1,E),D=S(1,p-A-1)),M+=N+D,M<=1)return;for(var P=0,O=E-N;P<=M;P++,O++)x[P]=f[(O<0?O+p:O)%p]._point;for(var L=x[0]._x+2*x[1]._x,$=x[0]._y+2*x[1]._y,q=2,H=M-1,W=[L],Q=[$],K=[q],Y=[],ee=[],P=1;P<M;P++){var ie=P<H,le=ie||C?1:2,ue=ie?4:C?2:7,Ee=ie?4:C?3:8,Se=ie?2:C?0:1,Re=le/q;q=K[P]=ue-Re,L=W[P]=Ee*x[P]._x+Se*x[P+1]._x-Re*L,$=Q[P]=Ee*x[P]._y+Se*x[P+1]._y-Re*$}Y[H]=W[H]/K[H],ee[H]=Q[H]/K[H];for(var P=M-2;P>=0;P--)Y[P]=(W[P]-Y[P+1])/K[P],ee[P]=(Q[P]-ee[P+1])/K[P];Y[M]=(3*x[M]._x-Y[H])/2,ee[M]=(3*x[M]._y-ee[H])/2;for(var P=N,Ye=M-D,O=E;P<=Ye;P++,O++){var He=f[O<0?O+p:O],qe=He._point,$e=Y[P]-qe._x,nt=ee[P]-qe._y;(y||P<Ye)&&He.setHandleOut($e,nt),(y||P>N)&&He.setHandleIn(-$e,-nt)}}else for(var P=E;P<=A;P++)f[P<0?P+p:P].smooth(c,!y&&P===E,!y&&P===A)},toShape:function(o){if(!this._closed)return null;var l=this._segments,c,d,f,p;function v(C,S){var k=l[C],M=k.getNext(),F=l[S],N=F.getNext();return k._handleOut.isZero()&&M._handleIn.isZero()&&F._handleOut.isZero()&&N._handleIn.isZero()&&M._point.subtract(k._point).isCollinear(N._point.subtract(F._point))}function _(C){var S=l[C],k=S.getPrevious(),M=S.getNext();return k._handleOut.isZero()&&S._handleIn.isZero()&&S._handleOut.isZero()&&M._handleIn.isZero()&&S._point.subtract(k._point).isOrthogonal(M._point.subtract(S._point))}function y(C){var S=l[C],k=S.getNext(),M=S._handleOut,F=k._handleIn,N=.5522847498307936;if(M.isOrthogonal(F)){var D=S._point,x=k._point,P=new J(D,M,!0).intersect(new J(x,F,!0),!0);return P&&w.isZero(M.getLength()/P.subtract(D).getLength()-N)&&w.isZero(F.getLength()/P.subtract(x).getLength()-N)}return!1}function E(C,S){return l[C]._point.getDistance(l[S]._point)}if(!this.hasHandles()&&l.length===4&&v(0,2)&&v(1,3)&&_(1)?(c=me.Rectangle,d=new z(E(0,3),E(0,1)),p=l[1]._point.add(l[2]._point).divide(2)):l.length===8&&y(0)&&y(2)&&y(4)&&y(6)&&v(1,5)&&v(3,7)?(c=me.Rectangle,d=new z(E(1,6),E(0,3)),f=d.subtract(new z(E(0,7),E(1,2))).divide(2),p=l[3]._point.add(l[4]._point).divide(2)):l.length===4&&y(0)&&y(1)&&y(2)&&y(3)&&(w.isZero(E(0,2)-E(1,3))?(c=me.Circle,f=E(0,2)/2):(c=me.Ellipse,f=new z(E(2,0)/2,E(3,1)/2)),p=l[1]._point),c){var A=this.getPosition(!0),b=new c({center:A,size:d,radius:f,insert:!1});return b.copyAttributes(this,!0),b._matrix.prepend(this._matrix),b.rotate(p.subtract(A).getAngle()+90),(o===n||o)&&b.insertAbove(this),b}return null},toPath:"#clone",compare:function o(l){if(!l||l instanceof Oe)return o.base.call(this,l);var c=this.getCurves(),d=l.getCurves(),f=c.length,p=d.length;if(!f||!p)return f==p;for(var v=c[0].getValues(),_=[],y=0,E,A=0,b,C=0;C<p;C++){var F=d[C].getValues();_.push(F);var S=he.getOverlaps(v,F);if(S){E=!C&&S[0][0]>0?p-1:C,b=S[0][1];break}}for(var k=Math.abs,M=1e-8,F=_[E],N;v&&F;){var S=he.getOverlaps(v,F);if(S){var D=S[0][0];if(k(D-A)<M){A=S[1][0],A===1&&(v=++y<f?c[y].getValues():null,A=0);var x=S[0][1];if(k(x-b)<M){if(N||(N=[E,x]),b=S[1][1],b===1&&(++E>=p&&(E=0),F=_[E]||d[E].getValues(),b=0),!v)return N[0]===E&&N[1]===b;continue}}}break}return!1},_hitTestSelf:function(o,l,c,d){var f=this,p=this.getStyle(),v=this._segments,_=v.length,y=this._closed,E=l._tolerancePadding,A=E,b,C,S,k,M,F,N=l.stroke&&p.hasStroke(),D=l.fill&&p.hasFill(),x=l.curves,P=N?p.getStrokeWidth()/2:D&&l.tolerance>0||x?0:null;P!==null&&(P>0?(b=p.getStrokeJoin(),C=p.getStrokeCap(),S=p.getMiterLimit(),A=A.add(Te._getStrokePadding(P,d))):b=C="round");function O(Y,ee){return o.subtract(Y).divide(ee).length<=1}function L(Y,ee,ie){if(!l.selected||ee.isSelected()){var le=Y._point;if(ee!==le&&(ee=ee.add(le)),O(ee,A))return new xe(ie,f,{segment:Y,point:ee})}}function $(Y,ee){return(ee||l.segments)&&L(Y,Y._point,"segment")||!ee&&l.handles&&(L(Y,Y._handleIn,"handle-in")||L(Y,Y._handleOut,"handle-out"))}function q(Y){k.add(Y)}function H(Y){var ee=y||Y._index>0&&Y._index<_-1;if((ee?b:C)==="round")return O(Y._point,A);if(k=new Te({internal:!0,closed:!0}),ee?Y.isSmooth()||Te._addBevelJoin(Y,b,P,S,null,d,q,!0):C==="square"&&Te._addSquareCap(Y,C,P,null,d,q,!0),!k.isEmpty()){var ie;return k.contains(o)||(ie=k.getNearestLocation(o))&&O(ie.getPoint(),E)}}if(l.ends&&!l.segments&&!y){if(F=$(v[0],!0)||$(v[_-1],!0))return F}else if(l.segments||l.handles){for(var W=0;W<_;W++)if(F=$(v[W]))return F}if(P!==null){if(M=this.getNearestLocation(o),M){var Q=M.getTime();Q===0||Q===1&&_>1?H(M.getSegment())||(M=null):O(M.getPoint(),A)||(M=null)}if(!M&&b==="miter"&&_>1)for(var W=0;W<_;W++){var K=v[W];if(o.getDistance(K._point)<=S*P&&H(K)){M=K.getLocation();break}}}return!M&&D&&this._contains(o)||M&&!N&&!x?new xe("fill",this):M?new xe(N?"stroke":"curve",this,{location:M,point:M.getPoint()}):null}},s.each(he._evaluateMethods,function(o){this[o+"At"]=function(l){var c=this.getLocationAt(l);return c&&c[o]()}},{beans:!1,getLocationOf:function(){for(var o=I.read(arguments),l=this.getCurves(),c=0,d=l.length;c<d;c++){var f=l[c].getLocationOf(o);if(f)return f}return null},getOffsetOf:function(){var o=this.getLocationOf.apply(this,arguments);return o?o.getOffset():null},getLocationAt:function(o){if(typeof o=="number"){for(var l=this.getCurves(),c=0,d=0,f=l.length;d<f;d++){var p=c,v=l[d];if(c+=v.getLength(),c>o)return v.getLocationAt(o-p)}if(l.length>0&&o<=this.getLength())return new lt(l[l.length-1],1)}else if(o&&o.getPath&&o.getPath()===this)return o;return null},getOffsetsWithTangent:function(){var o=I.read(arguments);if(o.isZero())return[];for(var l=[],c=0,d=this.getCurves(),f=0,p=d.length;f<p;f++){for(var v=d[f],_=v.getTimesWithTangent(o),y=0,E=_.length;y<E;y++){var A=c+v.getOffsetAtTime(_[y]);l.indexOf(A)<0&&l.push(A)}c+=v.length}return l}}),new function(){function o(c,d,f,p){if(p<=0)return;var v=p/2,_=p-2,y=v-1,E=new Array(6),A,b;function C(D){var x=E[D],P=E[D+1];(A!=x||b!=P)&&(c.beginPath(),c.moveTo(A,b),c.lineTo(x,P),c.stroke(),c.beginPath(),c.arc(x,P,v,0,Math.PI*2,!0),c.fill())}for(var S=0,k=d.length;S<k;S++){var M=d[S],F=M._selection;if(M._transformCoordinates(f,E),A=E[0],b=E[1],F&2&&C(2),F&4&&C(4),c.fillRect(A-v,b-v,p,p),_>0&&!(F&1)){var N=c.fillStyle;c.fillStyle="#ffffff",c.fillRect(A-y,b-y,_,_),c.fillStyle=N}}}function l(c,d,f){var p=d._segments,v=p.length,_=new Array(6),y=!0,E,A,b,C,S,k,M,F;function N(x){if(f)x._transformCoordinates(f,_),E=_[0],A=_[1];else{var P=x._point;E=P._x,A=P._y}if(y)c.moveTo(E,A),y=!1;else{if(f)S=_[2],k=_[3];else{var O=x._handleIn;S=E+O._x,k=A+O._y}S===E&&k===A&&M===b&&F===C?c.lineTo(E,A):c.bezierCurveTo(M,F,S,k,E,A)}if(b=E,C=A,f)M=_[4],F=_[5];else{var O=x._handleOut;M=b+O._x,F=C+O._y}}for(var D=0;D<v;D++)N(p[D]);d._closed&&v>0&&N(p[0])}return{_draw:function(c,d,f,p){var v=d.dontStart,_=d.dontFinish||d.clip,y=this.getStyle(),E=y.hasFill(),A=y.hasStroke(),b=y.getDashArray(),C=!de.support.nativeDash&&A&&b&&b.length;v||c.beginPath(),(E||A&&!C||_)&&(l(c,this,p),this._closed&&c.closePath());function S(x){return b[(x%C+C)%C]}if(!_&&(E||A)&&(this._setStyles(c,d,f),E&&(c.fill(y.getFillRule()),c.shadowColor="rgba(0,0,0,0)"),A)){if(C){v||c.beginPath();for(var k=new Je(this,.25,32,!1,p),M=k.length,F=-y.getDashOffset(),N,D=0;F>0;)F-=S(D--)+S(D--);for(;F<M;)N=F+S(D++),(F>0||N>0)&&k.drawPart(c,Math.max(F,0),Math.max(N,0)),F=N+S(D++)}c.stroke()}},_drawSelected:function(c,d){c.beginPath(),l(c,this,d),c.stroke(),o(c,this._segments,d,de.settings.handleSize)}}},new function(){function o(l){var c=l._segments;if(!c.length)throw new Error("Use a moveTo() command first");return c[c.length-1]}return{moveTo:function(){var l=this._segments;l.length===1&&this.removeSegment(0),l.length||this._add([new we(I.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new we(I.read(arguments))])},cubicCurveTo:function(){var l=arguments,c=I.read(l),d=I.read(l),f=I.read(l),p=o(this);p.setHandleOut(c.subtract(p._point)),this._add([new we(f,d.subtract(f))])},quadraticCurveTo:function(){var l=arguments,c=I.read(l),d=I.read(l),f=o(this)._point;this.cubicCurveTo(c.add(f.subtract(c).multiply(1/3)),c.add(d.subtract(c).multiply(1/3)),d)},curveTo:function(){var l=arguments,c=I.read(l),d=I.read(l),f=s.pick(s.read(l),.5),p=1-f,v=o(this)._point,_=c.subtract(v.multiply(p*p)).subtract(d.multiply(f*f)).divide(2*f*p);if(_.isNaN())throw new Error("Cannot put a curve through points with parameter = "+f);this.quadraticCurveTo(_,d)},arcTo:function(){var l=arguments,c=Math.abs,d=Math.sqrt,f=o(this),p=f._point,v=I.read(l),_,y=s.peek(l),E=s.pick(y,!0),A,b,C,S;if(typeof E=="boolean")var k=p.add(v).divide(2),_=k.add(k.subtract(p).rotate(E?-90:90));else if(s.remain(l)<=2)_=v,v=I.read(l);else if(!p.equals(v)){var M=z.read(l),F=w.isZero;if(F(M.width)||F(M.height))return this.lineTo(v);var N=s.read(l),E=!!s.read(l),D=!!s.read(l),k=p.add(v).divide(2),x=p.subtract(k).rotate(-N),P=x.x,O=x.y,L=c(M.width),$=c(M.height),q=L*L,H=$*$,W=P*P,Q=O*O,K=d(W/q+Q/H);if(K>1&&(L*=K,$*=K,q=L*L,H=$*$),K=(q*H-q*Q-H*W)/(q*Q+H*W),c(K)<1e-12&&(K=0),K<0)throw new Error("Cannot create an arc with the given arguments");A=new I(L*O/$,-$*P/L).multiply((D===E?-1:1)*d(K)).rotate(N).add(k),S=new U().translate(A).rotate(N).scale(L,$),C=S._inverseTransform(p),b=C.getDirectedAngle(S._inverseTransform(v)),!E&&b>0?b-=360:E&&b<0&&(b+=360)}if(_){var Y=new J(p.add(_).divide(2),_.subtract(p).rotate(90),!0),ee=new J(_.add(v).divide(2),v.subtract(_).rotate(90),!0),ie=new J(p,v),le=ie.getSide(_);if(A=Y.intersect(ee,!0),!A){if(!le)return this.lineTo(v);throw new Error("Cannot create an arc with the given arguments")}C=p.subtract(A),b=C.getDirectedAngle(v.subtract(A));var ue=ie.getSide(A,!0);ue===0?b=le*c(b):le===ue&&(b+=b<0?360:-360)}if(b){for(var Ee=1e-5,Se=c(b),Re=Se>=360?4:Math.ceil((Se-Ee)/90),Ye=b/Re,He=Ye*Math.PI/360,qe=4/3*Math.sin(He)/(1+Math.cos(He)),$e=[],nt=0;nt<=Re;nt++){var x=v,Ke=null;if(nt<Re&&(Ke=C.rotate(90).multiply(qe),S?(x=S._transformPoint(C),Ke=S._transformPoint(C.add(Ke)).subtract(x)):x=A.add(C)),!nt)f.setHandleOut(Ke);else{var St=C.rotate(-90).multiply(qe);S&&(St=S._transformPoint(C.add(St)).subtract(x)),$e.push(new we(x,St,Ke))}C=C.rotate(Ye)}this._add($e)}},lineBy:function(){var l=I.read(arguments),c=o(this)._point;this.lineTo(c.add(l))},curveBy:function(){var l=arguments,c=I.read(l),d=I.read(l),f=s.read(l),p=o(this)._point;this.curveTo(p.add(c),p.add(d),f)},cubicCurveBy:function(){var l=arguments,c=I.read(l),d=I.read(l),f=I.read(l),p=o(this)._point;this.cubicCurveTo(p.add(c),p.add(d),p.add(f))},quadraticCurveBy:function(){var l=arguments,c=I.read(l),d=I.read(l),f=o(this)._point;this.quadraticCurveTo(f.add(c),f.add(d))},arcBy:function(){var l=arguments,c=o(this)._point,d=c.add(I.read(l)),f=s.pick(s.peek(l),!0);typeof f=="boolean"?this.arcTo(d,f):this.arcTo(d,c.add(I.read(l)))},closePath:function(l){this.setClosed(!0),this.join(this,l)}}},{_getBounds:function(o,l){var c=l.handle?"getHandleBounds":l.stroke?"getStrokeBounds":"getBounds";return Te[c](this._segments,this._closed,this,o,l)},statics:{getBounds:function(o,l,c,d,f,p){var v=o[0];if(!v)return new V;var _=new Array(6),y=v._transformCoordinates(d,new Array(6)),E=y.slice(0,2),A=E.slice(),b=new Array(2);function C(M){M._transformCoordinates(d,_);for(var F=0;F<2;F++)he._addBounds(y[F],y[F+4],_[F+2],_[F],F,p?p[F]:0,E,A,b);var N=y;y=_,_=N}for(var S=1,k=o.length;S<k;S++)C(o[S]);return l&&C(v),new V(E[0],E[1],A[0]-E[0],A[1]-E[1])},getStrokeBounds:function(o,l,c,d,f){var p=c.getStyle(),v=p.hasStroke(),_=p.getStrokeWidth(),y=v&&c._getStrokeMatrix(d,f),E=v&&Te._getStrokePadding(_,y),A=Te.getBounds(o,l,c,d,f,E);if(!v)return A;var b=_/2,C=p.getStrokeJoin(),S=p.getStrokeCap(),k=p.getMiterLimit(),M=new V(new z(E));function F(L){A=A.include(L)}function N(L){A=A.unite(M.setCenter(L._point.transform(d)))}function D(L,$){$==="round"||L.isSmooth()?N(L):Te._addBevelJoin(L,$,b,k,d,y,F)}function x(L,$){$==="round"?N(L):Te._addSquareCap(L,$,b,d,y,F)}var P=o.length-(l?0:1);if(P>0){for(var O=1;O<P;O++)D(o[O],C);l?D(o[0],C):(x(o[0],S),x(o[o.length-1],S))}return A},_getStrokePadding:function(o,l){if(!l)return[o,o];var c=new I(o,0).transform(l),d=new I(0,o).transform(l),f=c.getAngleInRadians(),p=c.getLength(),v=d.getLength(),_=Math.sin(f),y=Math.cos(f),E=Math.tan(f),A=Math.atan2(v*E,p),b=Math.atan2(v,E*p);return[Math.abs(p*Math.cos(A)*y+v*Math.sin(A)*_),Math.abs(v*Math.sin(b)*y+p*Math.cos(b)*_)]},_addBevelJoin:function(o,l,c,d,f,p,v,_){var y=o.getCurve(),E=y.getPrevious(),A=y.getPoint1().transform(f),b=E.getNormalAtTime(1).multiply(c).transform(p),C=y.getNormalAtTime(0).multiply(c).transform(p),S=b.getDirectedAngle(C);if((S<0||S>=180)&&(b=b.negate(),C=C.negate()),_&&v(A),v(A.add(b)),l==="miter"){var k=new J(A.add(b),new I(-b.y,b.x),!0).intersect(new J(A.add(C),new I(-C.y,C.x),!0),!0);k&&A.getDistance(k)<=d*c&&v(k)}v(A.add(C))},_addSquareCap:function(o,l,c,d,f,p,v){var _=o._point.transform(d),y=o.getLocation(),E=y.getNormal().multiply(y.getTime()===0?c:-c).transform(f);l==="square"&&(v&&(p(_.subtract(E)),p(_.add(E))),_=_.add(E.rotate(-90))),p(_.add(E)),p(_.subtract(E))},getHandleBounds:function(o,l,c,d,f){var p=c.getStyle(),v=f.stroke&&p.hasStroke(),_,y;if(v){var E=c._getStrokeMatrix(d,f),A=p.getStrokeWidth()/2,b=A;p.getStrokeJoin()==="miter"&&(b=A*p.getMiterLimit()),p.getStrokeCap()==="square"&&(b=Math.max(b,A*Math.SQRT2)),_=Te._getStrokePadding(A,E),y=Te._getStrokePadding(b,E)}for(var C=new Array(6),S=1/0,k=-S,M=S,F=k,N=0,D=o.length;N<D;N++){var x=o[N];x._transformCoordinates(d,C);for(var P=0;P<6;P+=2){var O=P?_:y,L=O?O[0]:0,$=O?O[1]:0,q=C[P],H=C[P+1],W=q-L,Q=q+L,K=H-$,Y=H+$;W<S&&(S=W),Q>k&&(k=Q),K<M&&(M=K),Y>F&&(F=Y)}}return new V(S,M,k-S,F-M)}}});Te.inject({statics:new function(){var o=.5522847498307936,l=[new we([-1,0],[0,o],[0,-o]),new we([0,-1],[-o,0],[o,0]),new we([1,0],[0,-o],[0,o]),new we([0,1],[o,0],[-o,0])];function c(f,p,v){var _=s.getNamed(v),y=new Te(_&&(_.insert==!0?te.INSERT:_.insert==!1?te.NO_INSERT:null));return y._add(f),y._closed=p,y.set(_,te.INSERT)}function d(f,p,v){for(var _=new Array(4),y=0;y<4;y++){var E=l[y];_[y]=new we(E._point.multiply(p).add(f),E._handleIn.multiply(p),E._handleOut.multiply(p))}return c(_,!0,v)}return{Line:function(){var f=arguments;return c([new we(I.readNamed(f,"from")),new we(I.readNamed(f,"to"))],!1,f)},Circle:function(){var f=arguments,p=I.readNamed(f,"center"),v=s.readNamed(f,"radius");return d(p,new z(v),f)},Rectangle:function(){var f=arguments,p=V.readNamed(f,"rectangle"),v=z.readNamed(f,"radius",0,{readNull:!0}),_=p.getBottomLeft(!0),y=p.getTopLeft(!0),E=p.getTopRight(!0),A=p.getBottomRight(!0),b;if(!v||v.isZero())b=[new we(_),new we(y),new we(E),new we(A)];else{v=z.min(v,p.getSize(!0).divide(2));var C=v.width,S=v.height,k=C*o,M=S*o;b=[new we(_.add(C,0),null,[-k,0]),new we(_.subtract(0,S),[0,M]),new we(y.add(0,S),null,[0,-M]),new we(y.add(C,0),[-k,0],null),new we(E.subtract(C,0),null,[k,0]),new we(E.add(0,S),[0,-M],null),new we(A.subtract(0,S),null,[0,M]),new we(A.subtract(C,0),[k,0])]}return c(b,!0,f)},RoundRectangle:"#Rectangle",Ellipse:function(){var f=arguments,p=me._readEllipse(f);return d(p.center,p.radius,f)},Oval:"#Ellipse",Arc:function(){var f=arguments,p=I.readNamed(f,"from"),v=I.readNamed(f,"through"),_=I.readNamed(f,"to"),y=s.getNamed(f),E=new Te(y&&y.insert==!1&&te.NO_INSERT);return E.moveTo(p),E.arcTo(v,_),E.set(y)},RegularPolygon:function(){for(var f=arguments,p=I.readNamed(f,"center"),v=s.readNamed(f,"sides"),_=s.readNamed(f,"radius"),y=360/v,E=v%3===0,A=new I(0,E?-_:_),b=E?-1:.5,C=new Array(v),S=0;S<v;S++)C[S]=new we(p.add(A.rotate((S+b)*y)));return c(C,!0,f)},Star:function(){for(var f=arguments,p=I.readNamed(f,"center"),v=s.readNamed(f,"points")*2,_=s.readNamed(f,"radius1"),y=s.readNamed(f,"radius2"),E=360/v,A=new I(0,-1),b=new Array(v),C=0;C<v;C++)b[C]=new we(p.add(A.rotate(E*C).multiply(C%2?y:_)));return c(b,!0,f)}}}});var Oe=Ce.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(l){this._children=[],this._namedChildren={},this._initialize(l)||(typeof l=="string"?this.setPathData(l):this.addChildren(Array.isArray(l)?l:arguments))},insertChildren:function o(l,c){var d=c,f=d[0];f&&typeof f[0]=="number"&&(d=[d]);for(var p=c.length-1;p>=0;p--){var v=d[p];d===c&&!(v instanceof Te)&&(d=s.slice(d)),Array.isArray(v)?d[p]=new Te({segments:v,insert:!1}):v instanceof Oe&&(d.splice.apply(d,[p,1].concat(v.removeChildren())),v.remove())}return o.base.call(this,l,d)},reduce:function o(l){for(var c=this._children,d=c.length-1;d>=0;d--){var f=c[d].reduce(l);f.isEmpty()&&f.remove()}if(!c.length){var f=new Te(te.NO_INSERT);return f.copyAttributes(this),f.insertAbove(this),this.remove(),f}return o.base.call(this)},isClosed:function(){for(var o=this._children,l=0,c=o.length;l<c;l++)if(!o[l]._closed)return!1;return!0},setClosed:function(o){for(var l=this._children,c=0,d=l.length;c<d;c++)l[c].setClosed(o)},getFirstSegment:function(){var o=this.getFirstChild();return o&&o.getFirstSegment()},getLastSegment:function(){var o=this.getLastChild();return o&&o.getLastSegment()},getCurves:function(){for(var o=this._children,l=[],c=0,d=o.length;c<d;c++)s.push(l,o[c].getCurves());return l},getFirstCurve:function(){var o=this.getFirstChild();return o&&o.getFirstCurve()},getLastCurve:function(){var o=this.getLastChild();return o&&o.getLastCurve()},getArea:function(){for(var o=this._children,l=0,c=0,d=o.length;c<d;c++)l+=o[c].getArea();return l},getLength:function(){for(var o=this._children,l=0,c=0,d=o.length;c<d;c++)l+=o[c].getLength();return l},getPathData:function(o,l){for(var c=this._children,d=[],f=0,p=c.length;f<p;f++){var v=c[f],_=v._matrix;d.push(v.getPathData(o&&!_.isIdentity()?o.appended(_):o,l))}return d.join("")},_hitTestChildren:function o(l,c,d){return o.base.call(this,l,c.class===Te||c.type==="path"?c:s.set({},c,{fill:!1}),d)},_draw:function(o,l,c,d){var f=this._children;if(f.length){l=l.extend({dontStart:!0,dontFinish:!0}),o.beginPath();for(var p=0,v=f.length;p<v;p++)f[p].draw(o,l,d);if(!l.clip){this._setStyles(o,l,c);var _=this._style;_.hasFill()&&(o.fill(_.getFillRule()),o.shadowColor="rgba(0,0,0,0)"),_.hasStroke()&&o.stroke()}}},_drawSelected:function(o,l,c){for(var d=this._children,f=0,p=d.length;f<p;f++){var v=d[f],_=v._matrix;c[v._id]||v._drawSelected(o,_.isIdentity()?l:l.appended(_))}}},new function(){function o(l,c){var d=l._children;if(c&&!d.length)throw new Error("Use a moveTo() command first");return d[d.length-1]}return s.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(l){this[l]=function(){var c=o(this,!0);c[l].apply(c,arguments)}},{moveTo:function(){var l=o(this),c=l&&l.isEmpty()?l:new Te(te.NO_INSERT);c!==l&&this.addChild(c),c.moveTo.apply(c,arguments)},moveBy:function(){var l=o(this,!0),c=l&&l.getLastSegment(),d=I.read(arguments);this.moveTo(c?d.add(c._point):d)},closePath:function(l){o(this,!0).closePath(l)}})},s.each(["reverse","flatten","simplify","smooth"],function(o){this[o]=function(l){for(var c=this._children,d,f=0,p=c.length;f<p;f++)d=c[f][o](l)||d;return d}},{}));Ce.inject(new function(){var o=Math.min,l=Math.max,c=Math.abs,d={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function f(N){return N._children||[N]}function p(N,D){var x=N.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(D){for(var P=f(x),O=0,L=P.length;O<L;O++){var N=P[O];!N._closed&&!N.isEmpty()&&(N.closePath(1e-12),N.getFirstSegment().setHandleIn(0,0),N.getLastSegment().setHandleOut(0,0))}x=x.resolveCrossings().reorient(x.getFillRule()==="nonzero",!0)}return x}function v(N,D,x,P,O){var L=new Oe(te.NO_INSERT);return L.addChildren(N,!0),L=L.reduce({simplify:D}),O&&O.insert==!1||L.insertAbove(P&&x.isSibling(P)&&x.getIndex()<P.getIndex()?P:x),L.copyAttributes(x,!0),L}function _(N){return N.hasOverlap()||N.isCrossing()}function y(N,D,x,P){if(P&&(P.trace==!1||P.stroke)&&/^(subtract|intersect)$/.test(x))return E(N,D,x);var O=p(N,!0),L=D&&N!==D&&p(D,!0),$=d[x];$[x]=!0,L&&($.subtract||$.exclude)^(L.isClockwise()^O.isClockwise())&&L.reverse();var q=S(lt.expand(O.getIntersections(L,_))),H=f(O),W=L&&f(L),Q=[],K=[],Y;function ee(Ke){for(var St=0,ut=Ke.length;St<ut;St++){var pt=Ke[St];s.push(Q,pt._segments),s.push(K,pt.getCurves()),pt._overlapsOnly=!0}}function ie(Ke){for(var St=[],ut=0,pt=Ke&&Ke.length;ut<pt;ut++)St.push(K[Ke[ut]]);return St}if(q.length){ee(H),W&&ee(W);for(var le=new Array(K.length),ue=0,Ee=K.length;ue<Ee;ue++)le[ue]=K[ue].getValues();for(var Se=g.findCurveBoundsCollisions(le,le,0,!0),Re={},ue=0;ue<K.length;ue++){var Ye=K[ue],He=Ye._path._id,qe=Re[He]=Re[He]||{};qe[Ye.getIndex()]={hor:ie(Se[ue].hor),ver:ie(Se[ue].ver)}}for(var ue=0,Ee=q.length;ue<Ee;ue++)M(q[ue]._segment,O,L,Re,$);for(var ue=0,Ee=Q.length;ue<Ee;ue++){var $e=Q[ue],nt=$e._intersection;$e._winding||M($e,O,L,Re,$),nt&&nt._overlap||($e._path._overlapsOnly=!1)}Y=F(Q,$)}else Y=C(W?H.concat(W):H.slice(),function(Ke){return!!$[Ke]});return v(Y,!0,N,D,P)}function E(N,D,x){var P=p(N),O=p(D),L=P.getIntersections(O,_),$=x==="subtract",q=x==="divide",H={},W=[];function Q(ee){if(!H[ee._id]&&(q||O.contains(ee.getPointAt(ee.getLength()/2))^$))return W.unshift(ee),H[ee._id]=!0}for(var K=L.length-1;K>=0;K--){var Y=L[K].split();Y&&(Q(Y)&&Y.getFirstSegment().setHandleIn(0,0),P.getLastSegment().setHandleOut(0,0))}return Q(P),v(W,!1,N,D)}function A(N,D){for(var x=N;x;){if(x===D)return;x=x._previous}for(;N._next&&N._next!==D;)N=N._next;if(!N._next){for(;D._previous;)D=D._previous;N._next=D,D._previous=N}}function b(N){for(var D=N.length-1;D>=0;D--)N[D].clearHandles()}function C(N,D,x){var P=N&&N.length;if(P){var O=s.each(N,function(Se,Re){this[Se._id]={container:null,winding:Se.isClockwise()?1:-1,index:Re}},{}),L=N.slice().sort(function(Se,Re){return c(Re.getArea())-c(Se.getArea())}),$=L[0],q=g.findItemBoundsCollisions(L,null,w.GEOMETRIC_EPSILON);x==null&&(x=$.isClockwise());for(var H=0;H<P;H++){var W=L[H],Q=O[W._id],K=0,Y=q[H];if(Y){for(var ee=null,ie=Y.length-1;ie>=0;ie--)if(Y[ie]<H){ee=ee||W.getInteriorPoint();var le=L[Y[ie]];if(le.contains(ee)){var ue=O[le._id];K=ue.winding,Q.winding+=K,Q.container=ue.exclude?ue.container:le;break}}}if(D(Q.winding)===D(K))Q.exclude=!0,N[Q.index]=null;else{var Ee=Q.container;W.setClockwise(Ee?!Ee.isClockwise():x)}}}return N}function S(N,D,x){var P=D&&[],O=1e-8,L=1-O,$=!1,q=x||[],H=x&&{},W,Q,K;function Y(St){return St._path._id+"."+St._segment1._index}for(var ee=(x&&x.length)-1;ee>=0;ee--){var ie=x[ee];ie._path&&(H[Y(ie)]=!0)}for(var ee=N.length-1;ee>=0;ee--){var le=N[ee],ue=le._time,Ee=ue,Se=D&&!D(le),ie=le._curve,Re;if(ie&&(ie!==Q?($=!ie.hasHandles()||H&&H[Y(ie)],W=[],K=null,Q=ie):K>=O&&(ue/=K)),Se){W&&W.push(le);continue}else D&&P.unshift(le);if(K=Ee,ue<O)Re=ie._segment1;else if(ue>L)Re=ie._segment2;else{var Ye=ie.divideAtTime(ue,!0);$&&q.push(ie,Ye),Re=Ye._segment1;for(var He=W.length-1;He>=0;He--){var qe=W[He];qe._time=(qe._time-ue)/(1-ue)}}le._setSegment(Re);var $e=Re._intersection,nt=le._intersection;if($e){A($e,nt);for(var Ke=$e;Ke;)A(Ke._intersection,$e),Ke=Ke._next}else Re._intersection=nt}return x||b(q),P||N}function k(N,D,x,P,O){var L=Array.isArray(D)?D:D[x?"hor":"ver"],$=x?1:0,q=$^1,H=[N.x,N.y],W=H[$],Q=H[q],K=1e-9,Y=1e-6,ee=W-K,ie=W+K,le=0,ue=0,Ee=0,Se=0,Re=!1,Ye=!1,He=1,qe=[],$e,nt;function Ke(Mt){var bn=Mt[q+0],mi=Mt[q+6];if(!(Q<o(bn,mi)||Q>l(bn,mi))){var Jn=Mt[$+0],$s=Mt[$+2],Bu=Mt[$+4],qs=Mt[$+6];if(bn===mi){(Jn<ie&&qs>ee||qs<ie&&Jn>ee)&&(Re=!0);return}var Jo=Q===bn?0:Q===mi||ee>l(Jn,$s,Bu,qs)||ie<o(Jn,$s,Bu,qs)?1:he.solveCubic(Mt,q,Q,qe,0,1)>0?qe[0]:1,_i=Jo===0?Jn:Jo===1?qs:he.getPoint(Mt,Jo)[x?"y":"x"],Oi=bn>mi?1:-1,Sd=$e[q]>$e[q+6]?1:-1,Zo=$e[$+6];return Q!==bn?(_i<ee?Ee+=Oi:_i>ie?Se+=Oi:Re=!0,_i>W-Y&&_i<W+Y&&(He/=2)):(Oi!==Sd?Jn<ee?Ee+=Oi:Jn>ie&&(Se+=Oi):Jn!=Zo&&(Zo<ie&&_i>ie?(Se+=Oi,Re=!0):Zo>ee&&_i<ee&&(Ee+=Oi,Re=!0)),He/=4),$e=Mt,!O&&_i>ee&&_i<ie&&he.getTangent(Mt,Jo)[x?"x":"y"]===0&&k(N,D,!x,P,!0)}}function St(Mt){var bn=Mt[q+0],mi=Mt[q+2],Jn=Mt[q+4],$s=Mt[q+6];if(Q<=l(bn,mi,Jn,$s)&&Q>=o(bn,mi,Jn,$s)){for(var Bu=Mt[$+0],qs=Mt[$+2],Jo=Mt[$+4],_i=Mt[$+6],Oi=ee>l(Bu,qs,Jo,_i)||ie<o(Bu,qs,Jo,_i)?[Mt]:he.getMonoCurves(Mt,x),Sd,Zo=0,Xk=Oi.length;Zo<Xk;Zo++)if(Sd=Ke(Oi[Zo]))return Sd}}for(var ut=0,pt=L.length;ut<pt;ut++){var yt=L[ut],ht=yt._path,Yn=yt.getValues(),Xn;if((!ut||L[ut-1]._path!==ht)&&($e=null,ht._closed||(nt=he.getValues(ht.getLastCurve().getSegment2(),yt.getSegment1(),null,!P),nt[q]!==nt[q+6]&&($e=nt)),!$e)){$e=Yn;for(var Tr=ht.getLastCurve();Tr&&Tr!==yt;){var An=Tr.getValues();if(An[q]!==An[q+6]){$e=An;break}Tr=Tr.getPrevious()}}if(Xn=St(Yn))return Xn;if(ut+1===pt||L[ut+1]._path!==ht){if(nt&&(Xn=St(nt)))return Xn;Re&&!Ee&&!Se&&(Ee=Se=ht.isClockwise(P)^x?1:-1),le+=Ee,ue+=Se,Ee=Se=0,Re&&(Ye=!0,Re=!1),nt=null}}return le=c(le),ue=c(ue),{winding:l(le,ue),windingL:le,windingR:ue,quality:He,onPath:Ye}}function M(N,D,x,P,O){var L=[],$=N,q=0,K;do{var H=N.getCurve();if(H){var W=H.getLength();L.push({segment:N,curve:H,length:W}),q+=W}N=N.getNext()}while(N&&!N._intersection&&N!==$);for(var Q=[.5,.25,.75],K={winding:0,quality:-1},Y=.001,ee=1-Y,ie=0;ie<Q.length&&K.quality<.5;ie++)for(var W=q*Q[ie],le=0,ue=L.length;le<ue;le++){var Ee=L[le],Se=Ee.length;if(W<=Se){var H=Ee.curve,Re=H._path,Ye=Re._parent,He=Ye instanceof Oe?Ye:Re,qe=w.clamp(H.getTimeAt(W),Y,ee),$e=H.getPointAtTime(qe),nt=c(H.getTangentAtTime(qe).y)<Math.SQRT1_2,Ke=null;if(O.subtract&&x){var St=He===D?x:D,ut=St._getWinding($e,nt,!0);if(He===D&&ut.winding||He===x&&!ut.winding){if(ut.quality<1)continue;Ke={winding:0,quality:1}}}Ke=Ke||k($e,P[Re._id][H.getIndex()],nt,!0),Ke.quality>K.quality&&(K=Ke);break}W-=Se}for(var le=L.length-1;le>=0;le--)L[le].segment._winding=K}function F(N,D){var x=[],P;function O(pt){var yt;return!!(pt&&!pt._visited&&(!D||D[(yt=pt._winding||{}).winding]&&!(D.unite&&yt.winding===2&&yt.windingL&&yt.windingR)))}function L(pt){if(pt){for(var yt=0,ht=P.length;yt<ht;yt++)if(pt===P[yt])return!0}return!1}function $(pt){for(var yt=pt._segments,ht=0,Yn=yt.length;ht<Yn;ht++)yt[ht]._visited=!0}function q(pt,yt){var ht=pt._intersection,Yn=ht,Xn=[];yt&&(P=[pt]);function Tr(An,Mt){for(;An&&An!==Mt;){var bn=An._segment,mi=bn&&bn._path;if(mi){var Jn=bn.getNext()||mi.getFirstSegment(),$s=Jn._intersection;bn!==pt&&(L(bn)||L(Jn)||Jn&&O(bn)&&(O(Jn)||$s&&O($s._segment)))&&Xn.push(bn),yt&&P.push(bn)}An=An._next}}if(ht){for(Tr(ht);ht&&ht._previous;)ht=ht._previous;Tr(ht,Yn)}return Xn}N.sort(function(pt,yt){var ht=pt._intersection,Yn=yt._intersection,Xn=!!(ht&&ht._overlap),Tr=!!(Yn&&Yn._overlap),An=pt._path,Mt=yt._path;return Xn^Tr?Xn?1:-1:!ht^!Yn?ht?1:-1:An!==Mt?An._id-Mt._id:pt._index-yt._index});for(var H=0,W=N.length;H<W;H++){var Q=N[H],K=O(Q),Y=null,ee=!1,ie=!0,le=[],ue,Ee,Se;if(K&&Q._path._overlapsOnly){var Re=Q._path,Ye=Q._intersection._segment._path;Re.compare(Ye)&&(Re.getArea()&&x.push(Re.clone(!1)),$(Re),$(Ye),K=!1)}for(;K;){var He=!Y,qe=q(Q,He),$e=qe.shift(),ee=!He&&(L(Q)||L($e)),nt=!ee&&$e;if(He&&(Y=new Te(te.NO_INSERT),ue=null),ee){(Q.isFirst()||Q.isLast())&&(ie=Q._path._closed),Q._visited=!0;break}if(nt&&ue&&(le.push(ue),ue=null),ue||(nt&&qe.push(Q),ue={start:Y._segments.length,crossings:qe,visited:Ee=[],handleIn:Se}),nt&&(Q=$e),!O(Q)){Y.removeSegments(ue.start);for(var Ke=0,St=Ee.length;Ke<St;Ke++)Ee[Ke]._visited=!1;Ee.length=0;do Q=ue&&ue.crossings.shift(),(!Q||!Q._path)&&(Q=null,ue=le.pop(),ue&&(Ee=ue.visited,Se=ue.handleIn));while(ue&&!O(Q));if(!Q)break}var ut=Q.getNext();Y.add(new we(Q._point,Se,ut&&Q._handleOut)),Q._visited=!0,Ee.push(Q),Q=ut||Q._path.getFirstSegment(),Se=ut&&ut._handleIn}ee&&(ie&&(Y.getFirstSegment().setHandleIn(Se),Y.setClosed(ie)),Y.getArea()!==0&&x.push(Y))}return x}return{_getWinding:function(N,D,x){return k(N,this.getCurves(),D,x)},unite:function(N,D){return y(this,N,"unite",D)},intersect:function(N,D){return y(this,N,"intersect",D)},subtract:function(N,D){return y(this,N,"subtract",D)},exclude:function(N,D){return y(this,N,"exclude",D)},divide:function(N,D){return D&&(D.trace==!1||D.stroke)?E(this,N,"divide"):v([this.subtract(N,D),this.intersect(N,D)],!0,this,N,D)},resolveCrossings:function(){var N=this._children,D=N||[this];function x(ue,Ee){var Se=ue&&ue._intersection;return Se&&Se._overlap&&Se._path===Ee}var P=!1,O=!1,L=this.getIntersections(null,function(ue){return ue.hasOverlap()&&(P=!0)||ue.isCrossing()&&(O=!0)}),$=P&&O&&[];if(L=lt.expand(L),P)for(var q=S(L,function(ue){return ue.hasOverlap()},$),H=q.length-1;H>=0;H--){var W=q[H],Q=W._path,K=W._segment,Y=K.getPrevious(),ee=K.getNext();x(Y,Q)&&x(ee,Q)&&(K.remove(),Y._handleOut._set(0,0),ee._handleIn._set(0,0),Y!==K&&!Y.getCurve().hasLength()&&(ee._handleIn.set(Y._handleIn),Y.remove()))}O&&(S(L,P&&function(ue){var Ee=ue.getCurve(),Se=ue.getSegment(),Re=ue._intersection,Ye=Re._curve,He=Re._segment;if(Ee&&Ye&&Ee._path&&Ye._path)return!0;Se&&(Se._intersection=null),He&&(He._intersection=null)},$),$&&b($),D=F(s.each(D,function(ue){s.push(this,ue._segments)},[])));var ie=D.length,le;return ie>1&&N?(D!==N&&this.setChildren(D),le=this):ie===1&&!N&&(D[0]!==this&&this.setSegments(D[0].removeSegments()),le=this),le||(le=new Oe(te.NO_INSERT),le.addChildren(D),le=le.reduce(),le.copyAttributes(this),this.replaceWith(le)),le},reorient:function(N,D){var x=this._children;return x&&x.length?this.setChildren(C(this.removeChildren(),function(P){return!!(N?P:P&1)},D)):D!==n&&this.setClockwise(D),this},getInteriorPoint:function(){var N=this.getBounds(),D=N.getCenter(!0);if(!this.contains(D)){for(var x=this.getCurves(),P=D.y,O=[],L=[],$=0,q=x.length;$<q;$++){var H=x[$].getValues(),W=H[1],Q=H[3],K=H[5],Y=H[7];if(P>=o(W,Q,K,Y)&&P<=l(W,Q,K,Y))for(var ee=he.getMonoCurves(H),ie=0,le=ee.length;ie<le;ie++){var ue=ee[ie],Ee=ue[1],Se=ue[7];if(Ee!==Se&&(P>=Ee&&P<=Se||P>=Se&&P<=Ee)){var Re=P===Ee?ue[0]:P===Se?ue[6]:he.solveCubic(ue,1,P,L,0,1)===1?he.getPoint(ue,L[0]).x:(ue[0]+ue[6])/2;O.push(Re)}}}O.length>1&&(O.sort(function(Ye,He){return Ye-He}),D.x=(O[0]+O[1])/2)}return D}}});var Je=s.extend({_class:"PathFlattener",initialize:function(o,l,c,d,f){var p=[],v=[],_=0,y=1/(c||32),E=o._segments,A=E[0],b;function C(F,N){var D=he.getValues(F,N,f);p.push(D),S(D,F._index,0,1)}function S(F,N,D,x){if(x-D>y&&!(d&&he.isStraight(F))&&!he.isFlatEnough(F,l||.25)){var P=he.subdivide(F,.5),O=(D+x)/2;S(P[0],N,D,O),S(P[1],N,O,x)}else{var L=F[6]-F[0],$=F[7]-F[1],q=Math.sqrt(L*L+$*$);q>0&&(_+=q,v.push({offset:_,curve:F,index:N,time:x}))}}for(var k=1,M=E.length;k<M;k++)b=E[k],C(A,b),A=b;o._closed&&C(b||A,E[0]),this.curves=p,this.parts=v,this.length=_,this.index=0},_get:function(o){for(var l=this.parts,c=l.length,d,f=this.index;d=f,!(!f||l[--f].offset<o););for(;d<c;d++){var p=l[d];if(p.offset>=o){this.index=d;var v=l[d-1],_=v&&v.index===p.index?v.time:0,y=v?v.offset:0;return{index:p.index,time:_+(p.time-_)*(o-y)/(p.offset-y)}}}return{index:l[c-1].index,time:1}},drawPart:function(o,l,c){for(var d=this._get(l),f=this._get(c),p=d.index,v=f.index;p<=v;p++){var _=he.getPart(this.curves[p],p===d.index?d.time:0,p===f.index?f.time:1);p===d.index&&o.moveTo(_[0],_[1]),o.bezierCurveTo.apply(o,_.slice(2))}}},s.each(he._evaluateMethods,function(o){this[o+"At"]=function(l){var c=this._get(l);return he[o](this.curves[c.index],c.time)}},{})),Tt=s.extend({initialize:function(o){for(var l=this.points=[],c=o._segments,d=o._closed,f=0,p,v=c.length;f<v;f++){var _=c[f].point;(!p||!p.equals(_))&&l.push(p=_.clone())}d&&(l.unshift(l[l.length-1]),l.push(l[1])),this.closed=d},fit:function(o){var l=this.points,c=l.length,d=null;return c>0&&(d=[new we(l[0])],c>1&&(this.fitCubic(d,o,0,c-1,l[1].subtract(l[0]),l[c-2].subtract(l[c-1])),this.closed&&(d.shift(),d.pop()))),d},fitCubic:function(o,l,c,d,f,p){var v=this.points;if(d-c===1){var _=v[c],y=v[d],E=_.getDistance(y)/3;this.addCurve(o,[_,_.add(f.normalize(E)),y.add(p.normalize(E)),y]);return}for(var A=this.chordLengthParameterize(c,d),b=Math.max(l,l*l),C,S=!0,k=0;k<=4;k++){var M=this.generateBezier(c,d,A,f,p),F=this.findMaxError(c,d,M,A);if(F.error<l&&S){this.addCurve(o,M);return}if(C=F.index,F.error>=b)break;S=this.reparameterize(c,d,A,M),b=F.error}var N=v[C-1].subtract(v[C+1]);this.fitCubic(o,l,c,C,f,N),this.fitCubic(o,l,C,d,N.negate(),p)},addCurve:function(o,l){var c=o[o.length-1];c.setHandleOut(l[1].subtract(l[0])),o.push(new we(l[3],l[2].subtract(l[3])))},generateBezier:function(o,l,c,d,f){for(var p=1e-12,v=Math.abs,_=this.points,y=_[o],E=_[l],A=[[0,0],[0,0]],b=[0,0],C=0,S=l-o+1;C<S;C++){var k=c[C],M=1-k,F=3*k*M,N=M*M*M,D=F*M,x=F*k,P=k*k*k,O=d.normalize(D),L=f.normalize(x),$=_[o+C].subtract(y.multiply(N+D)).subtract(E.multiply(x+P));A[0][0]+=O.dot(O),A[0][1]+=O.dot(L),A[1][0]=A[0][1],A[1][1]+=L.dot(L),b[0]+=O.dot($),b[1]+=L.dot($)}var q=A[0][0]*A[1][1]-A[1][0]*A[0][1],H,W;if(v(q)>p){var Q=A[0][0]*b[1]-A[1][0]*b[0],K=b[0]*A[1][1]-b[1]*A[0][1];H=K/q,W=Q/q}else{var Y=A[0][0]+A[0][1],ee=A[1][0]+A[1][1];H=W=v(Y)>p?b[0]/Y:v(ee)>p?b[1]/ee:0}var ie=E.getDistance(y),le=p*ie,ue,Ee;if(H<le||W<le)H=W=ie/3;else{var Se=E.subtract(y);ue=d.normalize(H),Ee=f.normalize(W),ue.dot(Se)-Ee.dot(Se)>ie*ie&&(H=W=ie/3,ue=Ee=null)}return[y,y.add(ue||d.normalize(H)),E.add(Ee||f.normalize(W)),E]},reparameterize:function(o,l,c,d){for(var f=o;f<=l;f++)c[f-o]=this.findRoot(d,this.points[f],c[f-o]);for(var f=1,p=c.length;f<p;f++)if(c[f]<=c[f-1])return!1;return!0},findRoot:function(o,l,c){for(var d=[],f=[],p=0;p<=2;p++)d[p]=o[p+1].subtract(o[p]).multiply(3);for(var p=0;p<=1;p++)f[p]=d[p+1].subtract(d[p]).multiply(2);var v=this.evaluate(3,o,c),_=this.evaluate(2,d,c),y=this.evaluate(1,f,c),E=v.subtract(l),A=_.dot(_)+E.dot(y);return w.isMachineZero(A)?c:c-E.dot(_)/A},evaluate:function(o,l,c){for(var d=l.slice(),f=1;f<=o;f++)for(var p=0;p<=o-f;p++)d[p]=d[p].multiply(1-c).add(d[p+1].multiply(c));return d[0]},chordLengthParameterize:function(o,l){for(var c=[0],d=o+1;d<=l;d++)c[d-o]=c[d-o-1]+this.points[d].getDistance(this.points[d-1]);for(var d=1,f=l-o;d<=f;d++)c[d]/=c[f];return c},findMaxError:function(o,l,c,d){for(var f=Math.floor((l-o+1)/2),p=0,v=o+1;v<l;v++){var _=this.evaluate(3,c,d[v-o]),y=_.subtract(this.points[v]),E=y.x*y.x+y.y*y.y;E>=p&&(p=E,f=v)}return{error:p,index:f}}}),ot=te.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(l){this._content="",this._lines=[];var c=l&&s.isPlainObject(l)&&l.x===n&&l.y===n;this._initialize(c&&l,!c&&I.read(arguments))},_equals:function(o){return this._content===o._content},copyContent:function(o){this.setContent(o._content)},getContent:function(){return this._content},setContent:function(o){this._content=""+o,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Ft=ot.extend({_class:"PointText",initialize:function(){ot.apply(this,arguments)},getPoint:function(){var o=this._matrix.getTranslation();return new j(o.x,o.y,this,"setPoint")},setPoint:function(){var o=I.read(arguments);this.translate(o.subtract(this._matrix.getTranslation()))},_draw:function(o,l,c){if(this._content){this._setStyles(o,l,c);var d=this._lines,f=this._style,p=f.hasFill(),v=f.hasStroke(),_=f.getLeading(),y=o.shadowColor;o.font=f.getFontStyle(),o.textAlign=f.getJustification();for(var E=0,A=d.length;E<A;E++){o.shadowColor=y;var b=d[E];p&&(o.fillText(b,0,0),o.shadowColor="rgba(0,0,0,0)"),v&&o.strokeText(b,0,0),o.translate(0,_)}}},_getBounds:function(o,l){var c=this._style,d=this._lines,f=d.length,p=c.getJustification(),v=c.getLeading(),_=this.getView().getTextWidth(c.getFontStyle(),d),y=0;p!=="left"&&(y-=_/(p==="center"?2:1));var E=new V(y,f?-.75*v:0,_,f*v);return o?o._transformBounds(E,E):E}}),Xe=s.extend(new function(){var o={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},l={},c={transparent:[0,0,0,0]},d;function f(_){var y=_.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||_.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),E="rgb",A;if(y){var b=y[4]?4:3;A=new Array(b);for(var C=0;C<b;C++){var S=y[C+1];A[C]=parseInt(S.length==1?S+S:S,16)/255}}else if(y=_.match(/^(rgb|hsl)a?\((.*)\)$/)){E=y[1],A=y[2].trim().split(/[,\s]+/g);for(var k=E==="hsl",C=0,M=Math.min(A.length,4);C<M;C++){var F=A[C],S=parseFloat(F);if(k)if(C===0){var N=F.match(/([a-z]*)$/)[1];S*={turn:360,rad:180/Math.PI,grad:.9}[N]||1}else C<3&&(S/=100);else C<3&&(S/=/%$/.test(F)?100:255);A[C]=S}}else{var D=c[_];if(!D)if(r){d||(d=se.getContext(1,1,{willReadFrequently:!0}),d.globalCompositeOperation="copy"),d.fillStyle="rgba(0,0,0,0)",d.fillStyle=_,d.fillRect(0,0,1,1);var x=d.getImageData(0,0,1,1).data;D=c[_]=[x[0]/255,x[1]/255,x[2]/255]}else D=[0,0,0];A=D.slice()}return[E,A]}var p=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],v={"rgb-hsb":function(_,y,E){var A=Math.max(_,y,E),b=Math.min(_,y,E),C=A-b,S=C===0?0:(A==_?(y-E)/C+(y<E?6:0):A==y?(E-_)/C+2:(_-y)/C+4)*60;return[S,A===0?0:C/A,A]},"hsb-rgb":function(_,y,E){_=(_/60%6+6)%6;var b=Math.floor(_),A=_-b,b=p[b],C=[E,E*(1-y),E*(1-y*A),E*(1-y*(1-A))];return[C[b[0]],C[b[1]],C[b[2]]]},"rgb-hsl":function(_,y,E){var A=Math.max(_,y,E),b=Math.min(_,y,E),C=A-b,S=C===0,k=S?0:(A==_?(y-E)/C+(y<E?6:0):A==y?(E-_)/C+2:(_-y)/C+4)*60,M=(A+b)/2,F=S?0:M<.5?C/(A+b):C/(2-A-b);return[k,F,M]},"hsl-rgb":function(_,y,E){if(_=(_/360%1+1)%1,y===0)return[E,E,E];for(var A=[_+1/3,_,_-1/3],b=E<.5?E*(1+y):E+y-E*y,C=2*E-b,S=[],k=0;k<3;k++){var M=A[k];M<0&&(M+=1),M>1&&(M-=1),S[k]=6*M<1?C+(b-C)*6*M:2*M<1?b:3*M<2?C+(b-C)*(2/3-M)*6:C}return S},"rgb-gray":function(_,y,E){return[_*.2989+y*.587+E*.114]},"gray-rgb":function(_){return[_,_,_]},"gray-hsb":function(_){return[0,0,_]},"gray-hsl":function(_){return[0,0,_]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return s.each(o,function(_,y){l[y]=[],s.each(_,function(E,A){var b=s.capitalize(E),C=/^(hue|saturation)$/.test(E),S=l[y][A]=y==="gradient"?E==="gradient"?function(k){var M=this._components[0];return k=dn.read(Array.isArray(k)?k:arguments,0,{readNull:!0}),M!==k&&(M&&M._removeOwner(this),k&&k._addOwner(this)),k}:function(){return I.read(arguments,0,{readNull:E==="highlight",clone:!0})}:function(k){return k==null||isNaN(k)?0:+k};this["get"+b]=function(){return this._type===y||C&&/^hs[bl]$/.test(this._type)?this._components[A]:this._convert(y)[A]},this["set"+b]=function(k){this._type!==y&&!(C&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(y),this._properties=o[y],this._type=y),this._components[A]=S.call(this,k),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function _(y){var E=arguments,A=this.__read,b=0,C,S,k,M;Array.isArray(y)&&(E=y,y=E[0]);var F=y!=null&&typeof y;if(F==="string"&&y in o&&(C=y,y=E[1],Array.isArray(y)?(S=y,k=E[2]):(A&&(b=1),E=s.slice(E,1),F=typeof y)),!S){if(M=F==="number"?E:F==="object"&&y.length!=null?y:null,M){C||(C=M.length>=3?"rgb":"gray");var N=o[C].length;k=M[N],A&&(b+=M===arguments?N+(k!=null?1:0):1),M.length>N&&(M=s.slice(M,0,N))}else if(F==="string"){var D=f(y);C=D[0],S=D[1],S.length===4&&(k=S[3],S.length--)}else if(F==="object")if(y.constructor===_){if(C=y._type,S=y._components.slice(),k=y._alpha,C==="gradient")for(var x=1,P=S.length;x<P;x++){var O=S[x];O&&(S[x]=O.clone())}}else if(y.constructor===dn)C="gradient",M=E;else{C="hue"in y?"lightness"in y?"hsl":"hsb":"gradient"in y||"stops"in y||"radial"in y?"gradient":"gray"in y?"gray":"rgb";var L=o[C],$=l[C];this._components=S=[];for(var x=0,P=L.length;x<P;x++){var q=y[L[x]];q==null&&!x&&C==="gradient"&&"stops"in y&&(q={stops:y.stops,radial:y.radial}),q=$[x].call(this,q),q!=null&&(S[x]=q)}k=y.alpha}A&&C&&(b=1)}if(this._type=C||"rgb",!S){this._components=S=[];for(var $=l[this._type],x=0,P=$.length;x<P;x++){var q=$[x].call(this,M&&M[x]);q!=null&&(S[x]=q)}}return this._components=S,this._properties=o[this._type],this._alpha=k,A&&(this.__read=b),this},set:"#initialize",_serialize:function(_,y){var E=this.getComponents();return s.serialize(/^(gray|rgb)$/.test(this._type)?E:[this._type].concat(E),_,!0,y)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(_){var y;return this._type===_?this._components.slice():(y=v[this._type+"-"+_])?y.apply(this,this._components):v["rgb-"+_].apply(this,v[this._type+"-rgb"].apply(this,this._components))},convert:function(_){return new Xe(_,this._convert(_),this._alpha)},getType:function(){return this._type},setType:function(_){this._components=this._convert(_),this._properties=o[_],this._type=_},getComponents:function(){var _=this._components.slice();return this._alpha!=null&&_.push(this._alpha),_},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(_){this._alpha=_==null?null:Math.min(Math.max(_,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(_){var y=s.isPlainValue(_,!0)?Xe.read(arguments):_;return y===this||y&&this._class===y._class&&this._type===y._type&&this.getAlpha()===y.getAlpha()&&s.equals(this._components,y._components)||!1},toString:function(){for(var _=this._properties,y=[],E=this._type==="gradient",A=m.instance,b=0,C=_.length;b<C;b++){var S=this._components[b];S!=null&&y.push(_[b]+": "+(E?S:A.number(S)))}return this._alpha!=null&&y.push("alpha: "+A.number(this._alpha)),"{ "+y.join(", ")+" }"},toCSS:function(_){var y=this._convert("rgb"),E=_||this._alpha==null?1:this._alpha;function A(b){return Math.round((b<0?0:b>1?1:b)*255)}return y=[A(y[0]),A(y[1]),A(y[2])],E<1&&y.push(E<0?0:E),_?"#"+((1<<24)+(y[0]<<16)+(y[1]<<8)+y[2]).toString(16).slice(1):(y.length==4?"rgba(":"rgb(")+y.join(",")+")"},toCanvasStyle:function(_,y){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var E=this._components,A=E[0],b=A._stops,C=E[1],S=E[2],k=E[3],M=y&&y.inverted(),F;if(M&&(C=M._transformPoint(C),S=M._transformPoint(S),k&&(k=M._transformPoint(k))),A._radial){var N=S.getDistance(C);if(k){var D=k.subtract(C);D.getLength()>N&&(k=C.add(D.normalize(N-.1)))}var x=k||C;F=_.createRadialGradient(x.x,x.y,0,C.x,C.y,N)}else F=_.createLinearGradient(C.x,C.y,S.x,S.y);for(var P=0,O=b.length;P<O;P++){var L=b[P],$=L._offset;F.addColorStop($??P/(O-1),L._color.toCanvasStyle())}return this._canvasStyle=F},transform:function(_){if(this._type==="gradient"){for(var y=this._components,E=1,A=y.length;E<A;E++){var b=y[E];_._transformPoint(b,b,!0)}this._changed()}},statics:{_types:o,random:function(){var _=Math.random;return new Xe(_(),_(),_())},_setOwner:function(_,y,E){return _&&(_._owner&&y&&_._owner!==y&&(_=_.clone()),!_._owner^!y&&(_._owner=y||null,_._setter=E||null)),_}}})},new function(){var o={add:function(l,c){return l+c},subtract:function(l,c){return l-c},multiply:function(l,c){return l*c},divide:function(l,c){return l/c}};return s.each(o,function(l,c){this[c]=function(d){d=Xe.read(arguments);for(var f=this._type,p=this._components,v=d._convert(f),_=0,y=p.length;_<y;_++)v[_]=l(p[_],v[_]);return new Xe(f,v,this._alpha!=null?l(this._alpha,d.getAlpha()):null)}},{})}),dn=s.extend({_class:"Gradient",initialize:function(l,c){this._id=T.get(),l&&s.isPlainObject(l)&&(this.set(l),l=c=null),this._stops==null&&this.setStops(l||["white","black"]),this._radial==null&&this.setRadial(typeof c=="string"&&c==="radial"||c||!1)},_serialize:function(o,l){return l.add(this,function(){return s.serialize([this._stops,this._radial],o,!0,l)})},_changed:function(){for(var o=0,l=this._owners&&this._owners.length;o<l;o++)this._owners[o]._changed()},_addOwner:function(o){this._owners||(this._owners=[]),this._owners.push(o)},_removeOwner:function(o){var l=this._owners?this._owners.indexOf(o):-1;l!=-1&&(this._owners.splice(l,1),this._owners.length||(this._owners=n))},clone:function(){for(var o=[],l=0,c=this._stops.length;l<c;l++)o[l]=this._stops[l].clone();return new dn(o,this._radial)},getStops:function(){return this._stops},setStops:function(o){if(o.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var l=this._stops;if(l)for(var c=0,d=l.length;c<d;c++)l[c]._owner=n;l=this._stops=Cn.readList(o,0,{clone:!0});for(var c=0,d=l.length;c<d;c++)l[c]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(o){this._radial=o,this._changed()},equals:function(o){if(o===this)return!0;if(o&&this._class===o._class){var l=this._stops,c=o._stops,d=l.length;if(d===c.length){for(var f=0;f<d;f++)if(!l[f].equals(c[f]))return!1;return!0}}return!1}}),Cn=s.extend({_class:"GradientStop",initialize:function(l,c){var d=l,f=c;typeof l=="object"&&c===n&&(Array.isArray(l)&&typeof l[0]!="number"?(d=l[0],f=l[1]):("color"in l||"offset"in l||"rampPoint"in l)&&(d=l.color,f=l.offset||l.rampPoint||0)),this.setColor(d),this.setOffset(f)},clone:function(){return new Cn(this._color.clone(),this._offset)},_serialize:function(o,l){var c=this._color,d=this._offset;return s.serialize(d==null?[c]:[c,d],o,!0,l)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(o){this._offset=o,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Xe._setOwner(this._color,null),this._color=Xe._setOwner(Xe.read(arguments,0),this,"setColor"),this._changed()},equals:function(o){return o===this||o&&this._class===o._class&&this._color.equals(o._color)&&this._offset==o._offset||!1}}),us=s.extend(new function(){var o={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new I,selectedColor:null},l=s.set({},o,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),c=s.set({},l,{fillColor:new Xe}),d={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},f={beans:!0},p={_class:"Style",beans:!0,initialize:function(_,y,E){this._values={},this._owner=y,this._project=y&&y._project||E||de.project,this._defaults=!y||y instanceof ae?l:y instanceof ot?c:o,_&&this.set(_)}};return s.each(l,function(v,_){var y=/Color$/.test(_),E=_==="shadowOffset",A=s.capitalize(_),b=d[_],C="set"+A,S="get"+A;p[C]=function(k){var M=this._owner,F=M&&M._children,N=F&&F.length>0&&!(M instanceof Oe);if(N)for(var D=0,x=F.length;D<x;D++)F[D]._style[C](k);if((_==="selectedColor"||!N)&&_ in this._defaults){var P=this._values[_];P!==k&&(y&&(P&&(Xe._setOwner(P,null),P._canvasStyle=null),k&&k.constructor===Xe&&(k=Xe._setOwner(k,M,N&&C))),this._values[_]=k,M&&M._changed(b||129))}},p[S]=function(k){var M=this._owner,F=M&&M._children,N=F&&F.length>0&&!(M instanceof Oe),D;if(N&&!k)for(var x=0,P=F.length;x<P;x++){var O=F[x]._style[S]();if(!x)D=O;else if(!s.equals(D,O))return n}else if(_ in this._defaults){var D=this._values[_];if(D===n)D=this._defaults[_],D&&D.clone&&(D=D.clone());else{var L=y?Xe:E?I:null;L&&!(D&&D.constructor===L)&&(this._values[_]=D=L.read([D],0,{readNull:!0,clone:!0}))}}return D&&y&&(D=Xe._setOwner(D,M,N&&C)),D},f[S]=function(k){return this._style[S](k)},f[C]=function(k){this._style[C](k)}}),s.each({Font:"FontFamily",WindingRule:"FillRule"},function(v,_){var y="get"+_,E="set"+_;p[y]=f[y]="#get"+v,p[E]=f[E]="#set"+v}),te.inject(f),p},{set:function(o){var l=o instanceof us,c=l?o._values:o;if(c){for(var d in c)if(d in this._defaults){var f=c[d];this[d]=f&&l&&f.clone?f.clone():f}}},equals:function(o){function l(c,d,f){var p=c._values,v=d._values,_=d._defaults;for(var y in p){var E=p[y],A=v[y];if(!(f&&y in v)&&!s.equals(E,A===n?_[y]:A))return!1}return!0}return o===this||o&&this._class===o._class&&l(this,o)&&l(o,this,!0)||!1},_dispose:function(){var o;o=this.getFillColor(),o&&(o._canvasStyle=null),o=this.getStrokeColor(),o&&(o._canvasStyle=null),o=this.getShadowColor(),o&&(o._canvasStyle=null)},hasFill:function(){var o=this.getFillColor();return!!o&&o.alpha>0},hasStroke:function(){var o=this.getStrokeColor();return!!o&&o.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var o=this.getShadowColor();return!!o&&o.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var o=this.getFontSize();return this.getFontWeight()+" "+o+(/[a-z]/i.test(o+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function o(){var l=o.base.call(this),c=this.getFontSize();return/pt|em|%|px/.test(c)&&(c=this.getView().getPixelSize(c)),l??c*1.2}}),kt=new function(){function o(l,c,d,f){for(var p=["","webkit","moz","Moz","ms","o"],v=c[0].toUpperCase()+c.substring(1),_=0;_<6;_++){var y=p[_],E=y?y+v:c;if(E in l){if(d)l[E]=f;else return l[E];break}}}return{getStyles:function(l){var c=l&&l.nodeType!==9?l.ownerDocument:l,d=c&&c.defaultView;return d&&d.getComputedStyle(l,"")},getBounds:function(l,c){var d=l.ownerDocument,f=d.body,p=d.documentElement,v;try{v=l.getBoundingClientRect()}catch{v={left:0,top:0,width:0,height:0}}var _=v.left-(p.clientLeft||f.clientLeft||0),y=v.top-(p.clientTop||f.clientTop||0);if(!c){var E=d.defaultView;_+=E.pageXOffset||p.scrollLeft||f.scrollLeft,y+=E.pageYOffset||p.scrollTop||f.scrollTop}return new V(_,y,v.width,v.height)},getViewportBounds:function(l){var c=l.ownerDocument,d=c.defaultView,f=c.documentElement;return new V(0,0,d.innerWidth||f.clientWidth,d.innerHeight||f.clientHeight)},getOffset:function(l,c){return kt.getBounds(l,c).getPoint()},getSize:function(l){return kt.getBounds(l,!0).getSize()},isInvisible:function(l){return kt.getSize(l).equals(new z(0,0))},isInView:function(l){return!kt.isInvisible(l)&&kt.getViewportBounds(l).intersects(kt.getBounds(l,!0))},isInserted:function(l){return i.body.contains(l)},getPrefixed:function(l,c){return l&&o(l,c)},setPrefixed:function(l,c,d){if(typeof c=="object")for(var f in c)o(l,f,!0,c[f]);else o(l,c,!0,d)}}},Ht={add:function(o,l){if(o)for(var c in l)for(var d=l[c],f=c.split(/[\s,]+/g),p=0,v=f.length;p<v;p++){var _=f[p],y=o===i&&(_==="touchstart"||_==="touchmove")?{passive:!1}:!1;o.addEventListener(_,d,y)}},remove:function(o,l){if(o)for(var c in l)for(var d=l[c],f=c.split(/[\s,]+/g),p=0,v=f.length;p<v;p++)o.removeEventListener(f[p],d,!1)},getPoint:function(o){var l=o.targetTouches?o.targetTouches.length?o.targetTouches[0]:o.changedTouches[0]:o;return new I(l.pageX||l.clientX+i.documentElement.scrollLeft,l.pageY||l.clientY+i.documentElement.scrollTop)},getTarget:function(o){return o.target||o.srcElement},getRelatedTarget:function(o){return o.relatedTarget||o.toElement},getOffset:function(o,l){return Ht.getPoint(o).subtract(kt.getOffset(l||Ht.getTarget(o)))}};Ht.requestAnimationFrame=new function(){var o=kt.getPrefixed(r,"requestAnimationFrame"),l=!1,c=[],d;function f(){var p=c;c=[];for(var v=0,_=p.length;v<_;v++)p[v]();l=o&&c.length,l&&o(f)}return function(p){c.push(p),o?l||(o(f),l=!0):d||(d=setInterval(f,1e3/60))}};var Ot=s.extend(a,{_class:"View",initialize:function o(l,c){function d(b){return c[b]||parseInt(c.getAttribute(b),10)}function f(){var b=kt.getSize(c);return b.isNaN()||b.isZero()?new z(d("width"),d("height")):b}var p;if(r&&c){this._id=c.getAttribute("id"),this._id==null&&c.setAttribute("id",this._id="paper-view-"+o._id++),Ht.add(c,this._viewEvents);var v="none";if(kt.setPrefixed(c.style,{userDrag:v,userSelect:v,touchCallout:v,contentZooming:v,tapHighlightColor:"rgba(0,0,0,0)"}),u.hasAttribute(c,"resize")){var _=this;Ht.add(r,this._windowEvents={resize:function(){_.setViewSize(f())}})}if(p=f(),u.hasAttribute(c,"stats")&&typeof Stats<"u"){this._stats=new Stats;var y=this._stats.domElement,E=y.style,A=kt.getOffset(c);E.position="absolute",E.left=A.x+"px",E.top=A.y+"px",i.body.appendChild(y)}}else p=new z(c),c=null;this._project=l,this._scope=l._scope,this._element=c,this._pixelRatio||(this._pixelRatio=r&&r.devicePixelRatio||1),this._setElementSize(p.width,p.height),this._viewSize=p,o._views.push(this),o._viewsById[this._id]=this,(this._matrix=new U)._owner=this,o._focused||(o._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!de.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Ot._focused===this&&(Ot._focused=null),Ot._views.splice(Ot._views.indexOf(this),1),delete Ot._viewsById[this._id];var o=this._project;return o._view===this&&(o._view=null),Ht.remove(this._element,this._viewEvents),Ht.remove(r,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:s.each(te._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(o){this[o]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(o){this._autoUpdate=o,o&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var o=this;Ht.requestAnimationFrame(function(){if(o._requested=!1,o._animate){o.requestUpdate();var l=o._element;(!kt.getPrefixed(i,"hidden")||u.getAttribute(l,"keepalive")==="true")&&kt.isInView(l)&&o._handleFrame()}o._autoUpdate&&o.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){de=this._scope;var o=Date.now()/1e3,l=this._last?o-this._last:0;this._last=o,this.emit("frame",new s({delta:l,time:this._time+=l,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(o,l){var c=this._frameItems;l?(c[o._id]={item:o,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete c[o._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(o){for(var l in this._frameItems){var c=this._frameItems[l];c.item.emit("frame",new s(o,{time:c.time+=o.delta,count:c.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var o=this._viewSize;return new X(o.width,o.height,this,"setViewSize")},setViewSize:function(){var o=z.read(arguments),l=o.subtract(this._viewSize);l.isZero()||(this._setElementSize(o.width,o.height),this._viewSize.set(o),this._changed(),this.emit("resize",{size:o,delta:l}),this._autoUpdate&&this.update())},_setElementSize:function(o,l){var c=this._element;c&&(c.width!==o&&(c.width=o),c.height!==l&&(c.height=l))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new V(new I,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return kt.isInView(this._element)},isInserted:function(){return kt.isInserted(this._element)},getPixelSize:function(o){var l=this._element,c;if(l){var d=l.parentNode,f=i.createElement("div");f.style.fontSize=o,d.appendChild(f),c=parseFloat(kt.getStyles(f).fontSize),d.removeChild(f)}else c=parseFloat(c);return c},getTextWidth:function(o,l){return 0}},s.each(["rotate","scale","shear","skew"],function(o){var l=o==="rotate";this[o]=function(){var c=arguments,d=(l?s:I).read(c),f=I.read(c,0,{readNull:!0});return this.transform(new U()[o](d,f||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var o=new U;return this.transform(o.translate.apply(o,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var o=I.read(arguments);this.translate(this.getCenter().subtract(o))},getZoom:function(){var o=this._decompose().scaling;return(o.x+o.y)/2},setZoom:function(o){this.transform(new U().scale(o/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(o){var l=this.getRotation();l!=null&&o!=null&&this.rotate(o-l)},getScaling:function(){var o=this._decompose().scaling;return new j(o.x,o.y,this,"setScaling")},setScaling:function(){var o=this.getScaling(),l=I.read(arguments,0,{clone:!0,readNull:!0});o&&l&&this.scale(l.x/o.x,l.y/o.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var o=this._matrix;o.set.apply(o,arguments)},transform:function(o){this._matrix.append(o)},scrollBy:function(){this.translate(I.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(I.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(I.read(arguments))},getEventPoint:function(o){return this.viewToProject(Ht.getOffset(o,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(o,l){i&&typeof l=="string"&&(l=i.getElementById(l));var c=r?Qo:Ot;return new c(o,l)}}},new function(){if(!r)return;var o,l,c=!1,d=!1;function f(K){var Y=Ht.getTarget(K);return Y.getAttribute&&Ot._viewsById[Y.getAttribute("id")]}function p(){var K=Ot._focused;if(!K||!K.isVisible()){for(var Y=0,ee=Ot._views.length;Y<ee;Y++)if((K=Ot._views[Y]).isVisible()){Ot._focused=l=K;break}}}function v(K,Y,ee){K._handleMouseEvent("mousemove",Y,ee)}var _=r.navigator,y,E,A;_.pointerEnabled||_.msPointerEnabled?(y="pointerdown MSPointerDown",E="pointermove MSPointerMove",A="pointerup pointercancel MSPointerUp MSPointerCancel"):(y="touchstart",E="touchmove",A="touchend touchcancel","ontouchstart"in r&&_.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(y+=" mousedown",E+=" mousemove",A+=" mouseup"));var b={},C={mouseout:function(K){var Y=Ot._focused,ee=Ht.getRelatedTarget(K);if(Y&&(!ee||ee.nodeName==="HTML")){var ie=Ht.getOffset(K,Y._element),le=ie.x,ue=Math.abs,Ee=ue(le),Se=1<<25,Re=Ee-Se;ie.x=ue(Re)<Ee?Re*(le<0?-1:1):le,v(Y,K,Y.viewToProject(ie))}},scroll:p};b[y]=function(K){var Y=Ot._focused=f(K);c||(c=!0,Y._handleMouseEvent("mousedown",K))},C[E]=function(K){var Y=Ot._focused;if(!d){var ee=f(K);ee?Y!==ee&&(Y&&v(Y,K),o||(o=Y),Y=Ot._focused=l=ee):l&&l===Y&&(o&&!o.isInserted()&&(o=null),Y=Ot._focused=o,o=null,p())}Y&&v(Y,K)},C[y]=function(){d=!0},C[A]=function(K){var Y=Ot._focused;Y&&c&&Y._handleMouseEvent("mouseup",K),d=c=!1},Ht.add(i,C),Ht.add(r,{load:p});var S=!1,k=!1,M={doubleclick:"click",mousedrag:"mousemove"},F=!1,N,D,x,P,O,L,$,q;function H(K,Y,ee,ie,le,ue,Ee){var Se=!1,Re;function Ye(He,qe){if(He.responds(qe)){if(Re||(Re=new Yo(qe,ie,le,Y||He,ue?le.subtract(ue):null)),He.emit(qe,Re)&&(S=!0,Re.prevented&&(k=!0),Re.stopped))return Se=!0}else{var $e=M[qe];if($e)return Ye(He,$e)}}for(;K&&K!==Ee&&!Ye(K,ee);)K=K._parent;return Se}function W(K,Y,ee,ie,le,ue){return K._project.removeOn(ee),k=S=!1,O&&H(O,null,ee,ie,le,ue)||Y&&Y!==O&&!Y.isDescendant(O)&&H(Y,null,ee==="mousedrag"?"mousemove":ee,ie,le,ue,O)||H(K,O||Y||K,ee,ie,le,ue)}var Q={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:b,_handleMouseEvent:function(K,Y,ee){var ie=this._itemEvents,le=ie.native[K],ue=K==="mousemove",Ee=this._scope.tool,Se=this;function Re(St){return ie.virtual[St]||Se.responds(St)||Ee&&Ee.responds(St)}ue&&c&&Re("mousedrag")&&(K="mousedrag"),ee||(ee=this.getEventPoint(Y));var Ye=this.getBounds().contains(ee),He=le&&Ye&&Se._project.hitTest(ee,{tolerance:0,fill:!0,stroke:!0}),qe=He&&He.item||null,$e=!1,nt={};if(nt[K.substr(5)]=!0,le&&qe!==P&&(P&&H(P,null,"mouseleave",Y,ee),qe&&H(qe,null,"mouseenter",Y,ee),P=qe),F^Ye&&(H(this,null,Ye?"mouseenter":"mouseleave",Y,ee),$e=!0),(Ye||nt.drag)&&!ee.equals(D)&&(W(this,qe,ue?K:"mousemove",Y,ee,D),$e=!0),F=Ye,nt.down&&Ye||nt.up&&N){if(W(this,qe,K,Y,ee,N),nt.down){if(q=qe===L&&Date.now()-$<300,x=L=qe,!k&&qe){for(var Ke=qe;Ke&&!Ke.responds("mousedrag");)Ke=Ke._parent;Ke&&(O=qe)}N=ee}else nt.up&&(!k&&qe===x&&($=Date.now(),W(this,qe,q?"doubleclick":"click",Y,ee,N),q=!1),x=O=null);F=!1,$e=!0}D=ee,$e&&Ee&&(S=Ee._handleMouseEvent(K,Y,ee,nt)||S),Y.cancelable!==!1&&(S&&!nt.move||nt.down&&Re("mouseup"))&&Y.preventDefault()},_handleKeyEvent:function(K,Y,ee,ie){var le=this._scope,ue=le.tool,Ee;function Se(Re){Re.responds(K)&&(de=le,Re.emit(K,Ee=Ee||new Zr(K,Y,ee,ie)))}this.isVisible()&&(Se(this),ue&&ue.responds(K)&&Se(ue))},_countItemEvent:function(K,Y){var ee=this._itemEvents,ie=ee.native,le=ee.virtual;for(var ue in Q)ie[ue]=(ie[ue]||0)+(Q[ue][K]||0)*Y;le[K]=(le[K]||0)+Y},statics:{updateFocus:p,_resetState:function(){c=d=S=F=!1,o=l=N=D=x=P=O=L=$=q=null}}}}),Qo=Ot.extend({_class:"CanvasView",initialize:function(l,c){if(!(c instanceof r.HTMLCanvasElement)){var d=z.read(arguments,1);if(d.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+s.slice(arguments,1));c=se.getCanvas(d)}var f=this._context=c.getContext("2d");if(f.save(),this._pixelRatio=1,!/^off|false$/.test(u.getAttribute(c,"hidpi"))){var p=r.devicePixelRatio||1,v=kt.getPrefixed(f,"backingStorePixelRatio")||1;this._pixelRatio=p/v}Ot.call(this,l,c),this._needsUpdate=!0},remove:function o(){return this._context.restore(),o.base.call(this)},_setElementSize:function o(l,c){var d=this._pixelRatio;if(o.base.call(this,l*d,c*d),d!==1){var f=this._element,p=this._context;if(!u.hasAttribute(f,"resize")){var v=f.style;v.width=l+"px",v.height=c+"px"}p.restore(),p.save(),p.scale(d,d)}},getContext:function(){return this._context},getPixelSize:function o(l){var c=de.agent,d;if(c&&c.firefox)d=o.base.call(this,l);else{var f=this._context,p=f.font;f.font=l+" serif",d=parseFloat(f.font),f.font=p}return d},getTextWidth:function(o,l){var c=this._context,d=c.font,f=0;c.font=o;for(var p=0,v=l.length;p<v;p++)f=Math.max(f,c.measureText(l[p]).width);return c.font=d,f},update:function(){if(!this._needsUpdate)return!1;var o=this._project,l=this._context,c=this._viewSize;return l.clearRect(0,0,c.width+1,c.height+1),o&&o.draw(l,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),or=s.extend({_class:"Event",initialize:function(l){this.event=l,this.type=l&&l.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return ei.modifiers}}),Zr=or.extend({_class:"KeyEvent",initialize:function(l,c,d,f){this.type=l,this.event=c,this.key=d,this.character=f},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),ei=new function(){var o={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},l={tab:"	",space:" ",enter:"\r"},c={},d={},f,p,v=new s({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var E=de&&de.agent;return E&&E.mac?this.meta:this.control}}});function _(E){var A=E.key||E.keyIdentifier;return A=/^U\+/.test(A)?String.fromCharCode(parseInt(A.substr(2),16)):/^Arrow[A-Z]/.test(A)?A.substr(5):A==="Unidentified"||A===n?String.fromCharCode(E.keyCode):A,o[A]||(A.length>1?s.hyphenate(A):A.toLowerCase())}function y(E,A,b,C){var S=Ot._focused,k;if(c[A]=E,E?d[A]=b:delete d[A],A.length>1&&(k=s.camelize(A))in v){v[k]=E;var M=de&&de.agent;if(k==="meta"&&M&&M.mac)if(E)f={};else{for(var F in f)F in d&&y(!1,F,f[F],C);f=null}}else E&&f&&(f[A]=b);S&&S._handleKeyEvent(E?"keydown":"keyup",C,A,b)}return Ht.add(i,{keydown:function(E){var A=_(E),b=de&&de.agent;A.length>1||b&&b.chrome&&(E.altKey||b.mac&&E.metaKey||!b.mac&&E.ctrlKey)?y(!0,A,l[A]||(A.length>1?"":A),E):p=A},keypress:function(E){if(p){var A=_(E),b=E.charCode,C=b>=32?String.fromCharCode(b):A.length>1?"":A;A!==p&&(A=C.toLowerCase()),y(!0,A,C,E),p=null}},keyup:function(E){var A=_(E);A in d&&y(!1,A,d[A],E)}}),Ht.add(r,{blur:function(E){for(var A in d)y(!1,A,d[A],E)}}),{modifiers:v,isDown:function(E){return!!c[E]}}},Yo=or.extend({_class:"MouseEvent",initialize:function(l,c,d,f,p){this.type=l,this.event=c,this.point=d,this.target=f,this.delta=p},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Xo=or.extend({_class:"ToolEvent",_item:null,initialize:function(l,c,d){this.tool=l,this.type=c,this.event=d},_choosePoint:function(o,l){return o||(l?l.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(o){this._point=o},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(o){this._lastPoint=o},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(o){this._downPoint=o},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(o){this._middlePoint=o},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(o){this._delta=o},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(o){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=o},getItem:function(){if(!this._item){var o=this.tool._scope.project.hitTest(this.getPoint());if(o){for(var l=o.item,c=l._parent;/^(Group|CompoundPath)$/.test(c._class);)l=c,c=c._parent;this._item=l}}return this._item},setItem:function(o){this._item=o},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}});h.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(l){h.call(this),this._moveCount=-1,this._downCount=-1,this.set(l)},getMinDistance:function(){return this._minDistance},setMinDistance:function(o){this._minDistance=o,o!=null&&this._maxDistance!=null&&o>this._maxDistance&&(this._maxDistance=o)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(o){this._maxDistance=o,this._minDistance!=null&&o!=null&&o<this._minDistance&&(this._minDistance=o)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(o){this._minDistance=this._maxDistance=o},_handleMouseEvent:function(o,l,c,d){de=this._scope,d.drag&&!this.responds(o)&&(o="mousemove");var f=d.move||d.drag,p=this.responds(o),v=this.minDistance,_=this.maxDistance,y=!1,E=this;function A(C,S){var k=c,M=f?E._point:E._downPoint||k;if(f){if(E._moveCount>=0&&k.equals(M))return!1;if(M&&(C!=null||S!=null)){var F=k.subtract(M),N=F.getLength();if(N<(C||0))return!1;S&&(k=M.add(F.normalize(Math.min(N,S))))}E._moveCount++}return E._point=k,E._lastPoint=M||k,d.down&&(E._moveCount=-1,E._downPoint=k,E._downCount++),!0}function b(){p&&(y=E.emit(o,new Xo(E,o,l))||y)}if(d.down)A(),b();else if(d.up)A(null,_),b();else if(p)for(;A(v,_);)b();return y}});var Td=s.extend(a,{_class:"Tween",statics:{easings:new s({linear:function(o){return o},easeInQuad:function(o){return o*o},easeOutQuad:function(o){return o*(2-o)},easeInOutQuad:function(o){return o<.5?2*o*o:-1+2*(2-o)*o},easeInCubic:function(o){return o*o*o},easeOutCubic:function(o){return--o*o*o+1},easeInOutCubic:function(o){return o<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1},easeInQuart:function(o){return o*o*o*o},easeOutQuart:function(o){return 1- --o*o*o*o},easeInOutQuart:function(o){return o<.5?8*o*o*o*o:1-8*--o*o*o*o},easeInQuint:function(o){return o*o*o*o*o},easeOutQuint:function(o){return 1+--o*o*o*o*o},easeInOutQuint:function(o){return o<.5?16*o*o*o*o*o:1+16*--o*o*o*o*o}})},initialize:function o(l,c,d,f,p,v){this.object=l;var _=typeof p,y=_==="function";this.type=y?_:_==="string"?p:"linear",this.easing=y?p:o.easings[this.type],this.duration=f,this.running=!1,this._then=null,this._startTime=null;var E=c||d;this._keys=E?Object.keys(E):[],this._parsedKeys=this._parseKeys(this._keys),this._from=E&&this._getState(c),this._to=E&&this._getState(d),v!==!1&&this.start()},then:function(o){return this._then=o,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(o){if(this.running){o>=1&&(o=1,this.running=!1);for(var l=this.easing(o),c=this._keys,d=function(A){return typeof A=="function"?A(l,o):A},f=0,p=c&&c.length;f<p;f++){var v=c[f],_=d(this._from[v]),y=d(this._to[v]),E=_&&y&&_.__add&&y.__add?y.__subtract(_).__multiply(l).__add(_):(y-_)*l+_;this._setProperty(this._parsedKeys[v],E)}this.responds("update")&&this.emit("update",new s({progress:o,factor:l})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(o){var l=this._startTime,c=l?(o-l)/this.duration:0;l||(this._startTime=o),this.update(c)},_getState:function(o){for(var l=this._keys,c={},d=0,f=l.length;d<f;d++){var p=l[d],v=this._parsedKeys[p],_=this._getProperty(v),y;if(o){var E=this._resolveValue(_,o[p]);this._setProperty(v,E),y=this._getProperty(v),y=y&&y.clone?y.clone():y,this._setProperty(v,_)}else y=_&&_.clone?_.clone():_;c[p]=y}return c},_resolveValue:function(o,l){if(l){if(Array.isArray(l)&&l.length===2){var c=l[0];return c&&c.match&&c.match(/^[+\-\*\/]=/)?this._calculate(o,c[0],l[1]):l}else if(typeof l=="string"){var d=l.match(/^[+\-*/]=(.*)/);if(d){var f=JSON.parse(d[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(o,l[0],f)}}}return l},_calculate:function(o,l,c){return de.PaperScript.calculateBinary(o,l,c)},_parseKeys:function(o){for(var l={},c=0,d=o.length;c<d;c++){var f=o[c],p=f.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");l[f]=p.split("/")}return l},_getProperty:function(o,l){for(var c=this.object,d=0,f=o.length-(l||0);d<f&&c;d++)c=c[o[d]];return c},_setProperty:function(o,l){var c=this._getProperty(o,1);c&&(c[o[o.length-1]]=l)}}),Z={request:function(o){var l=new e.XMLHttpRequest;return l.open((o.method||"get").toUpperCase(),o.url,s.pick(o.async,!0)),o.mimeType&&l.overrideMimeType(o.mimeType),l.onload=function(){var c=l.status;c===0||c===200?o.onLoad&&o.onLoad.call(l,l.responseText):l.onerror()},l.onerror=function(){var c=l.status,d='Could not load "'+o.url+'" (Status: '+c+")";if(o.onError)o.onError(d,c);else throw new Error(d)},l.send(null)}},se=s.exports.CanvasProvider={canvases:[],getCanvas:function(o,l,c){if(!r)return null;var d,f=!0;typeof o=="object"&&(l=o.height,o=o.width),this.canvases.length?d=this.canvases.pop():(d=i.createElement("canvas"),f=!1);var p=d.getContext("2d",c||{});if(!p)throw new Error("Canvas "+d+" is unable to provide a 2D context.");return d.width===o&&d.height===l?f&&p.clearRect(0,0,o+1,l+1):(d.width=o,d.height=l),p.save(),d},getContext:function(o,l,c){var d=this.getCanvas(o,l,c);return d?d.getContext("2d",c||{}):null},release:function(o){var l=o&&o.canvas?o.canvas:o;l&&l.getContext&&(l.getContext("2d").restore(),this.canvases.push(l))}},ge=new function(){var o=Math.min,l=Math.max,c=Math.abs,d,f,p,v,_,y,E,A,b,C,S;function k(O,L,$){return .2989*O+.587*L+.114*$}function M(O,L,$,W){var H=W-k(O,L,$);b=O+H,C=L+H,S=$+H;var W=k(b,C,S),Q=o(b,C,S),K=l(b,C,S);if(Q<0){var Y=W-Q;b=W+(b-W)*W/Y,C=W+(C-W)*W/Y,S=W+(S-W)*W/Y}if(K>255){var ee=255-W,ie=K-W;b=W+(b-W)*ee/ie,C=W+(C-W)*ee/ie,S=W+(S-W)*ee/ie}}function F(O,L,$){return l(O,L,$)-o(O,L,$)}function N(O,L,$,q){var H=[O,L,$],W=l(O,L,$),Q=o(O,L,$),K;Q=Q===O?0:Q===L?1:2,W=W===O?0:W===L?1:2,K=o(Q,W)===0?l(Q,W)===1?2:1:0,H[W]>H[Q]?(H[K]=(H[K]-H[Q])*q/(H[W]-H[Q]),H[W]=q):H[K]=H[W]=0,H[Q]=0,b=H[0],C=H[1],S=H[2]}var D={multiply:function(){b=_*d/255,C=y*f/255,S=E*p/255},screen:function(){b=_+d-_*d/255,C=y+f-y*f/255,S=E+p-E*p/255},overlay:function(){b=_<128?2*_*d/255:255-2*(255-_)*(255-d)/255,C=y<128?2*y*f/255:255-2*(255-y)*(255-f)/255,S=E<128?2*E*p/255:255-2*(255-E)*(255-p)/255},"soft-light":function(){var O=d*_/255;b=O+_*(255-(255-_)*(255-d)/255-O)/255,O=f*y/255,C=O+y*(255-(255-y)*(255-f)/255-O)/255,O=p*E/255,S=O+E*(255-(255-E)*(255-p)/255-O)/255},"hard-light":function(){b=d<128?2*d*_/255:255-2*(255-d)*(255-_)/255,C=f<128?2*f*y/255:255-2*(255-f)*(255-y)/255,S=p<128?2*p*E/255:255-2*(255-p)*(255-E)/255},"color-dodge":function(){b=_===0?0:d===255?255:o(255,255*_/(255-d)),C=y===0?0:f===255?255:o(255,255*y/(255-f)),S=E===0?0:p===255?255:o(255,255*E/(255-p))},"color-burn":function(){b=_===255?255:d===0?0:l(0,255-(255-_)*255/d),C=y===255?255:f===0?0:l(0,255-(255-y)*255/f),S=E===255?255:p===0?0:l(0,255-(255-E)*255/p)},darken:function(){b=_<d?_:d,C=y<f?y:f,S=E<p?E:p},lighten:function(){b=_>d?_:d,C=y>f?y:f,S=E>p?E:p},difference:function(){b=_-d,b<0&&(b=-b),C=y-f,C<0&&(C=-C),S=E-p,S<0&&(S=-S)},exclusion:function(){b=_+d*(255-_-_)/255,C=y+f*(255-y-y)/255,S=E+p*(255-E-E)/255},hue:function(){N(d,f,p,F(_,y,E)),M(b,C,S,k(_,y,E))},saturation:function(){N(_,y,E,F(d,f,p)),M(b,C,S,k(_,y,E))},luminosity:function(){M(_,y,E,k(d,f,p))},color:function(){M(d,f,p,k(_,y,E))},add:function(){b=o(_+d,255),C=o(y+f,255),S=o(E+p,255)},subtract:function(){b=l(_-d,0),C=l(y-f,0),S=l(E-p,0)},average:function(){b=(_+d)/2,C=(y+f)/2,S=(E+p)/2},negation:function(){b=255-c(255-d-_),C=255-c(255-f-y),S=255-c(255-p-E)}},x=this.nativeModes=s.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(O){this[O]=!0},{}),P=se.getContext(1,1,{willReadFrequently:!0});P&&(s.each(D,function(O,L){var $=L==="darken",q=!1;P.save();try{P.fillStyle=$?"#300":"#a00",P.fillRect(0,0,1,1),P.globalCompositeOperation=L,P.globalCompositeOperation===L&&(P.fillStyle=$?"#a00":"#300",P.fillRect(0,0,1,1),q=P.getImageData(0,0,1,1).data[0]!==$?170:51)}catch{}P.restore(),x[L]=q}),se.release(P)),this.process=function(O,L,$,q,H){var W=L.canvas,Q=O==="normal";if(Q||x[O])$.save(),$.setTransform(1,0,0,1,0,0),$.globalAlpha=q,Q||($.globalCompositeOperation=O),$.drawImage(W,H.x,H.y),$.restore();else{var K=D[O];if(!K)return;for(var Y=$.getImageData(H.x,H.y,W.width,W.height),ee=Y.data,ie=L.getImageData(0,0,W.width,W.height).data,le=0,ue=ee.length;le<ue;le+=4){d=ie[le],_=ee[le],f=ie[le+1],y=ee[le+1],p=ie[le+2],E=ee[le+2],v=ie[le+3],A=ee[le+3],K();var Ee=v*q/255,Se=1-Ee;ee[le]=Ee*b+Se*_,ee[le+1]=Ee*C+Se*y,ee[le+2]=Ee*S+Se*E,ee[le+3]=v*q+Se*A}$.putImageData(Y,H.x,H.y)}}},Ae=new function(){var o="http://www.w3.org/2000/svg",l="http://www.w3.org/2000/xmlns",c="http://www.w3.org/1999/xlink",d={href:c,xlink:l,xmlns:l+"/","xmlns:xlink":l+"/"};function f(_,y,E){return v(i.createElementNS(o,_),y,E)}function p(_,y){var E=d[y],A=E?_.getAttributeNS(E,y):_.getAttribute(y);return A==="null"?null:A}function v(_,y,E){for(var A in y){var b=y[A],C=d[A];typeof b=="number"&&E&&(b=E.number(b)),C?_.setAttributeNS(C,A,b):_.setAttribute(A,b)}return _}return{svg:o,xmlns:l,xlink:c,create:f,get:p,set:v}},ke=s.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(o,l){return!l&&(o instanceof Ce||o instanceof me||o instanceof ot)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(o,l){var c=s.capitalize(l),d=o[2];this[l]={type:o[1],property:l,attribute:o[0],toSVG:d,fromSVG:d&&s.each(d,function(f,p){this[f]=p},{}),exportFilter:o[3],get:"get"+c,set:"set"+c}},{});new function(){var o;function l(D,x,P){var O=new s,L=D.getTranslation();if(x){var $;D.isInvertible()?(D=D._shiftless(),$=D._inverseTransform(L),L=null):$=new I,O[P?"cx":"x"]=$.x,O[P?"cy":"y"]=$.y}if(!D.isIdentity()){var q=D.decompose();if(q){var H=[],W=q.rotation,Q=q.scaling,K=q.skewing;L&&!L.isZero()&&H.push("translate("+o.point(L)+")"),W&&H.push("rotate("+o.number(W)+")"),(!w.isZero(Q.x-1)||!w.isZero(Q.y-1))&&H.push("scale("+o.point(Q)+")"),K.x&&H.push("skewX("+o.number(K.x)+")"),K.y&&H.push("skewY("+o.number(K.y)+")"),O.transform=H.join(" ")}else O.transform="matrix("+D.getValues().join(",")+")"}return O}function c(D,x){for(var P=l(D._matrix),O=D._children,L=Ae.create("g",P,o),$=0,q=O.length;$<q;$++){var H=O[$],W=F(H,x);if(W)if(H.isClipMask()){var Q=Ae.create("clipPath");Q.appendChild(W),k(H,Q,"clip"),Ae.set(L,{"clip-path":"url(#"+Q.id+")"})}else L.appendChild(W)}return L}function d(D,x){var P=l(D._matrix,!0),O=D.getSize(),L=D.getImage();return P.x-=O.width/2,P.y-=O.height/2,P.width=O.width,P.height=O.height,P.href=x.embedImages==!1&&L&&L.src||D.toDataURL(),Ae.create("image",P,o)}function f(D,x){var P=x.matchShapes;if(P){var O=D.toShape(!1);if(O)return p(O)}var L=D._segments,$=L.length,q,H=l(D._matrix);if(P&&$>=2&&!D.hasHandles())if($>2){q=D._closed?"polygon":"polyline";for(var W=[],Q=0;Q<$;Q++)W.push(o.point(L[Q]._point));H.points=W.join(" ")}else{q="line";var K=L[0]._point,Y=L[1]._point;H.set({x1:K.x,y1:K.y,x2:Y.x,y2:Y.y})}else q="path",H.d=D.getPathData(null,x.precision);return Ae.create(q,H,o)}function p(D){var x=D._type,P=D._radius,O=l(D._matrix,!0,x!=="rectangle");if(x==="rectangle"){x="rect";var L=D._size,$=L.width,q=L.height;O.x-=$/2,O.y-=q/2,O.width=$,O.height=q,P.isZero()&&(P=null)}return P&&(x==="circle"?O.r=P:(O.rx=P.width,O.ry=P.height)),Ae.create(x,O,o)}function v(D,x){var P=l(D._matrix),O=D.getPathData(null,x.precision);return O&&(P.d=O),Ae.create("path",P,o)}function _(D,x){var P=l(D._matrix,!0),O=D._definition,L=S(O,"symbol"),$=O._item,q=$.getStrokeBounds();return L||(L=Ae.create("symbol",{viewBox:o.rectangle(q)}),L.appendChild(F($,x)),k(O,L,"symbol")),P.href="#"+L.id,P.x+=q.x,P.y+=q.y,P.width=q.width,P.height=q.height,P.overflow="visible",Ae.create("use",P,o)}function y(D){var x=S(D,"color");if(!x){var P=D.getGradient(),O=P._radial,L=D.getOrigin(),$=D.getDestination(),q;if(O){q={cx:L.x,cy:L.y,r:L.getDistance($)};var H=D.getHighlight();H&&(q.fx=H.x,q.fy=H.y)}else q={x1:L.x,y1:L.y,x2:$.x,y2:$.y};q.gradientUnits="userSpaceOnUse",x=Ae.create((O?"radial":"linear")+"Gradient",q,o);for(var W=P._stops,Q=0,K=W.length;Q<K;Q++){var Y=W[Q],ee=Y._color,ie=ee.getAlpha(),le=Y._offset;q={offset:le??Q/(K-1)},ee&&(q["stop-color"]=ee.toCSS(!0)),ie<1&&(q["stop-opacity"]=ie),x.appendChild(Ae.create("stop",q,o))}k(D,x,"color")}return"url(#"+x.id+")"}function E(D){var x=Ae.create("text",l(D._matrix,!0),o);return x.textContent=D._content,x}var A={Group:c,Layer:c,Raster:d,Path:f,Shape:p,CompoundPath:v,SymbolItem:_,PointText:E};function b(D,x,P){var O={},L=!P&&D.getParent(),$=[];return D._name!=null&&(O.id=D._name),s.each(ke,function(q){var H=q.get,W=q.type,Q=D[H]();if(q.exportFilter?q.exportFilter(D,Q):!L||!s.equals(L[H](),Q)){if(W==="color"&&Q!=null){var K=Q.getAlpha();K<1&&(O[q.attribute+"-opacity"]=K)}W==="style"?$.push(q.attribute+": "+Q):O[q.attribute]=Q==null?"none":W==="color"?Q.gradient?y(Q):Q.toCSS(!0):W==="array"?Q.join(","):W==="lookup"?q.toSVG[Q]:Q}}),$.length&&(O.style=$.join(";")),O.opacity===1&&delete O.opacity,D._visible||(O.visibility="hidden"),Ae.set(x,O,o)}var C;function S(D,x){return C||(C={ids:{},svgs:{}}),D&&C.svgs[x+"-"+(D._id||D.__id||(D.__id=T.get("svg")))]}function k(D,x,P){C||S();var O=C.ids[P]=(C.ids[P]||0)+1;x.id=P+"-"+O,C.svgs[P+"-"+(D._id||D.__id)]=x}function M(D,x){var P=D,O=null;if(C){P=D.nodeName.toLowerCase()==="svg"&&D;for(var L in C.svgs)O||(P||(P=Ae.create("svg"),P.appendChild(D)),O=P.insertBefore(Ae.create("defs"),P.firstChild)),O.appendChild(C.svgs[L]);C=null}return x.asString?new e.XMLSerializer().serializeToString(P):P}function F(D,x,P){var O=A[D._class],L=O&&O(D,x);if(L){var $=x.onExport;$&&(L=$(D,L,x)||L);var q=JSON.stringify(D._data);q&&q!=="{}"&&q!=="null"&&L.setAttribute("data-paper-data",q)}return L&&b(D,L,P)}function N(D){return D||(D={}),o=new m(D.precision),D}te.inject({exportSVG:function(D){return D=N(D),M(F(this,D,!0),D)}}),re.inject({exportSVG:function(D){D=N(D);var x=this._children,P=this.getView(),O=s.pick(D.bounds,"view"),L=D.matrix||O==="view"&&P._matrix,$=L&&U.read([L]),q=O==="view"?new V([0,0],P.getViewSize()):O==="content"?te._getBounds(x,$,{stroke:!0}).rect:V.read([O],0,{readNull:!0}),H={version:"1.1",xmlns:Ae.svg,"xmlns:xlink":Ae.xlink};q&&(H.width=q.width,H.height=q.height,(q.x||q.x===0||q.y||q.y===0)&&(H.viewBox=o.rectangle(q)));var W=Ae.create("svg",H,o),Q=W;$&&!$.isIdentity()&&(Q=W.appendChild(Ae.create("g",l($),o)));for(var K=0,Y=x.length;K<Y;K++)Q.appendChild(F(x[K],D,!0));return M(W,D)}})},new function(){var o={},l;function c(x,P,O,L,$,q){var H=Ae.get(x,P)||q,W=H==null?L?null:O?"":0:O?H:parseFloat(H);return/%\s*$/.test(H)?W/100*($?1:l[/x|^width/.test(P)?"width":"height"]):W}function d(x,P,O,L,$,q,H){return P=c(x,P||"x",!1,L,$,q),O=c(x,O||"y",!1,L,$,H),L&&(P==null||O==null)?null:new I(P,O)}function f(x,P,O,L,$){return P=c(x,P||"width",!1,L,$),O=c(x,O||"height",!1,L,$),L&&(P==null||O==null)?null:new z(P,O)}function p(x,P,O){return x==="none"?null:P==="number"?parseFloat(x):P==="array"?x?x.split(/[\s,]+/g).map(parseFloat):[]:P==="color"?F(x)||x:P==="lookup"?O[x]:x}function v(x,P,O,L){var $=x.childNodes,q=P==="clippath",H=P==="defs",W=new ae,Q=W._project,K=Q._currentStyle,Y=[];if(!q&&!H&&(W=M(W,x,L),Q._currentStyle=W._style.clone()),L)for(var ee=x.querySelectorAll("defs"),ie=0,le=ee.length;ie<le;ie++)N(ee[ie],O,!1);for(var ie=0,le=$.length;ie<le;ie++){var ue=$[ie],Ee;ue.nodeType===1&&!/^defs$/i.test(ue.nodeName)&&(Ee=N(ue,O,!1))&&!(Ee instanceof Ve)&&Y.push(Ee)}return W.addChildren(Y),q&&(W=M(W.reduce(),x,L)),Q._currentStyle=K,(q||H)&&(W.remove(),W=null),W}function _(x,P){for(var O=x.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),L=[],$=0,q=O.length;$<q;$+=2)L.push(new I(parseFloat(O[$]),parseFloat(O[$+1])));var H=new Te(L);return P==="polygon"&&H.closePath(),H}function y(x){return Ce.create(x.getAttribute("d"))}function E(x,P){var O=(c(x,"href",!0)||"").substring(1),L=P==="radialgradient",$;if(O)$=o[O].getGradient(),$._radial^L&&($=$.clone(),$._radial=L);else{for(var q=x.childNodes,H=[],W=0,Q=q.length;W<Q;W++){var K=q[W];K.nodeType===1&&H.push(M(new Cn,K))}$=new dn(H,L)}var Y,ee,ie,le=c(x,"gradientUnits",!0)!=="userSpaceOnUse";L?(Y=d(x,"cx","cy",!1,le,"50%","50%"),ee=Y.add(c(x,"r",!1,!1,le,"50%"),0),ie=d(x,"fx","fy",!0,le)):(Y=d(x,"x1","y1",!1,le,"0%","0%"),ee=d(x,"x2","y2",!1,le,"100%","0%"));var ue=M(new Xe($,Y,ee,ie),x);return ue._scaleToBounds=le,null}var A={"#document":function(x,P,O,L){for(var $=x.childNodes,q=0,H=$.length;q<H;q++){var W=$[q];if(W.nodeType===1)return N(W,O,L)}},g:v,svg:v,clippath:v,polygon:_,polyline:_,path:y,lineargradient:E,radialgradient:E,image:function(x){var P=new pe(c(x,"href",!0));return P.on("load",function(){var O=f(x);this.setSize(O);var L=d(x).add(O.divide(2));this._matrix.append(new U().translate(L))}),P},symbol:function(x,P,O,L){return new Ve(v(x,P,O,L),!0)},defs:v,use:function(x){var P=(c(x,"href",!0)||"").substring(1),O=o[P],L=d(x);return O?O instanceof Ve?O.place(L):O.clone().translate(L):null},circle:function(x){return new me.Circle(d(x,"cx","cy"),c(x,"r"))},ellipse:function(x){return new me.Ellipse({center:d(x,"cx","cy"),radius:f(x,"rx","ry")})},rect:function(x){return new me.Rectangle(new V(d(x),f(x)),f(x,"rx","ry"))},line:function(x){return new Te.Line(d(x,"x1","y1"),d(x,"x2","y2"))},text:function(x){var P=new Ft(d(x).add(d(x,"dx","dy")));return P.setContent(x.textContent.trim()||""),P},switch:v};function b(x,P,O,L){if(x.transform){for(var $=(L.getAttribute(O)||"").split(/\)\s*/g),q=new U,H=0,W=$.length;H<W;H++){var Q=$[H];if(!Q)break;for(var K=Q.split(/\(\s*/),Y=K[0],ee=K[1].split(/[\s,]+/g),ie=0,le=ee.length;ie<le;ie++)ee[ie]=parseFloat(ee[ie]);switch(Y){case"matrix":q.append(new U(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]));break;case"rotate":q.rotate(ee[0],ee[1]||0,ee[2]||0);break;case"translate":q.translate(ee[0],ee[1]||0);break;case"scale":q.scale(ee);break;case"skewX":q.skew(ee[0],0);break;case"skewY":q.skew(0,ee[0]);break}}x.transform(q)}}function C(x,P,O){var L=O==="fill-opacity"?"getFillColor":"getStrokeColor",$=x[L]&&x[L]();$&&$.setAlpha(parseFloat(P))}var S=s.set(s.each(ke,function(x){this[x.attribute]=function(P,O){if(P[x.set]&&(P[x.set](p(O,x.type,x.fromSVG)),x.type==="color")){var L=P[x.get]();if(L&&L._scaleToBounds){var $=P.getBounds();L.transform(new U().translate($.getPoint()).scale($.getSize()))}}}},{}),{id:function(x,P){o[P]=x,x.setName&&x.setName(P)},"clip-path":function(x,P){var O=F(P);if(O)if(O=O.clone(),O.setClipMask(!0),x instanceof ae)x.insertChild(0,O);else return new ae(O,x)},gradientTransform:b,transform:b,"fill-opacity":C,"stroke-opacity":C,visibility:function(x,P){x.setVisible&&x.setVisible(P==="visible")},display:function(x,P){x.setVisible&&x.setVisible(P!==null)},"stop-color":function(x,P){x.setColor&&x.setColor(P)},"stop-opacity":function(x,P){x._color&&x._color.setAlpha(parseFloat(P))},offset:function(x,P){if(x.setOffset){var O=P.match(/(.*)%$/);x.setOffset(O?O[1]/100:parseFloat(P))}},viewBox:function(x,P,O,L,$){var q=new V(p(P,"array")),H=f(L,null,null,!0),W,Q;if(x instanceof ae){var K=H?H.divide(q.getSize()):1,Q=new U().scale(K).translate(q.getPoint().negate());W=x}else x instanceof Ve&&(H&&q.setSize(H),W=x._item);if(W){if(k(L,"overflow",$)!=="visible"){var Y=new me.Rectangle(q);Y.setClipMask(!0),W.addChild(Y)}Q&&W.transform(Q)}}});function k(x,P,O){var L=x.attributes[P],$=L&&L.value;if(!$&&x.style){var q=s.camelize(P);$=x.style[q],!$&&O.node[q]!==O.parent[q]&&($=O.node[q])}return $?$==="none"?null:$:n}function M(x,P,O){var L=P.parentNode,$={node:kt.getStyles(P)||{},parent:!O&&!/^defs$/i.test(L.tagName)&&kt.getStyles(L)||{}};return s.each(S,function(q,H){var W=k(P,H,$);x=W!==n&&q(x,W,H,P,$)||x}),x}function F(x){var P=x&&x.match(/\((?:["'#]*)([^"')]+)/),O=P&&P[1],L=O&&o[r?O.replace(r.location.href.split("#")[0]+"#",""):O];return L&&L._scaleToBounds&&(L=L.clone(),L._scaleToBounds=!0),L}function N(x,P,O){var L=x.nodeName.toLowerCase(),$=L!=="#document",q=i.body,H,W,Q;O&&$&&(l=de.getView().getSize(),l=f(x,null,null,!0)||l,H=Ae.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),W=x.parentNode,Q=x.nextSibling,H.appendChild(x),q.appendChild(H));var K=de.settings,Y=K.applyMatrix,ee=K.insertItems;K.applyMatrix=!1,K.insertItems=!1;var ie=A[L],le=ie&&ie(x,L,P,O)||null;if(K.insertItems=ee,K.applyMatrix=Y,le){$&&!(le instanceof ae)&&(le=M(le,x,O));var ue=P.onImport,Ee=$&&x.getAttribute("data-paper-data");ue&&(le=ue(x,le,P)||le),P.expandShapes&&le instanceof me&&(le.remove(),le=le.toPath()),Ee&&(le._data=JSON.parse(Ee))}return H&&(q.removeChild(H),W&&(Q?W.insertBefore(x,Q):W.appendChild(x))),O&&(o={},le&&s.pick(P.applyMatrix,Y)&&le.matrix.apply(!0,!0)),le}function D(x,P,O){if(!x)return null;P=typeof P=="function"?{onLoad:P}:P||{};var L=de,$=null;function q(K){try{var Y=typeof K=="object"?K:new e.DOMParser().parseFromString(K.trim(),"image/svg+xml");if(!Y.nodeName)throw Y=null,new Error("Unsupported SVG source: "+x);de=L,$=N(Y,P,!0),(!P||P.insert!==!1)&&O._insertItem(n,$);var ee=P.onLoad;ee&&ee($,K)}catch(ie){H(ie)}}function H(K,Y){var ee=P.onError;if(ee)ee(K,Y);else throw new Error(K)}if(typeof x=="string"&&!/^[\s\S]*</.test(x)){var W=i.getElementById(x);W?q(W):Z.request({url:x,async:!0,onLoad:q,onError:H})}else if(typeof File<"u"&&x instanceof File){var Q=new FileReader;return Q.onload=function(){q(Q.result)},Q.onerror=function(){H(Q.error)},Q.readAsText(x)}else q(x);return $}te.inject({importSVG:function(x,P){return D(x,P,this)}}),re.inject({importSVG:function(x,P){return this.activate(),D(x,P,this)}})};var de=new(u.inject(s.exports,{Base:s,Numerical:w,Key:ei,DomEvent:Ht,DomElement:kt,document:i,window:r,Symbol:Ve,PlacedSymbol:rt}));return de.agent.node&&DS(de),typeof n=="function"&&n.amd?n("paper",de):t&&(t.exports=de),de}).call(sN,typeof self=="object"?self:null)})(Hk);var c$=Hk.exports;const Ge=US(c$),h$=t=>{const e=Ge.project.importSVG(`<path d="${t}" />`,{applyMatrix:!0,insert:!1}),n={path:e.exportSVG().getAttribute("d"),edges:e.curves.length,height:Math.round(e.bounds.height),width:Math.round(e.bounds.width),length:Math.round(e.length)};if(e.remove(),n.edges<3||n.edges>23)throw new Error("Invalid path");return n},d$=({tangram:t,deferred:e})=>{const{tangramsStarredBy:n}=G.useContext(Fr),r=G.useMemo(()=>{let i=0;for(const s in n[t.id])n[t.id][s]&&(i+=1);return i},[t,n]);return R.jsx(ls,{onClose:()=>e.reject(gn),css:{gap:3},children:R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1",alignItems:"center"},children:[R.jsx(yd,{selected:!0,tangram:t}),R.jsx(Ze,{css:{fontSize:2},children:R.jsx(xt,{id:"Earned {stars}",values:{stars:r,starIcon:()=>R.jsx(Cr,{icon:Mo,css:{fill:"currentColor"}})}})})]})})},f$=({tangram:t,deferred:e})=>{const n=nn(),r=G.useContext(gi),{currentUser:i}=G.useContext(Qn),[s,a]=G.useState(()=>({...t})),{tangramsStarredBy:u}=G.useContext(Fr),h=i&&!t.id,g=G.useMemo(()=>({path:t.path,category:t.category,emoji:t.category!=="digits"&&t.category!=="letters"?t.emoji:NS(),letterIndex:t.category==="letters"?Ec.indexOf(t.emoji):void 0,digitIndex:t.category==="digits"?wc.indexOf(t.emoji):void 0}),[t]),{handleSubmit:m,register:w,watch:T,setError:I,clearErrors:j,formState:z}=il({defaultValues:g}),{path:X,category:V,emoji:B,letterIndex:U,digitIndex:J}=T();G.useEffect(()=>{try{const ne=h$(X);a(me=>({...me,...ne})),j("path")}catch{I("path",{type:"invalid",message:n.formatMessage({id:"Invalid path"})})}},[X,I,j,n]),G.useEffect(()=>{const ne=V==="letters"?Ec[U]:V==="digits"?wc[J]:B||NS();a(me=>({...me,emoji:ne}))},[V,B,U,J]),G.useEffect(()=>{a(ne=>({...ne,category:V}))},[V]);const re=async()=>{window.confirm(n.formatMessage({id:"Are you sure you want to delete this tangram?"}))&&(await jt.firestore().collection("tangrams").doc(t.id).delete(),r(n.formatMessage({id:"Tangram deleted successfuly"})),e.resolve())},te=async()=>{h?(await jt.firestore().collection("tangrams").add({...s,uid:i.uid,approved:!1}),r(n.formatMessage({id:"Tangram submitted for review"}))):(await jt.firestore().collection("tangrams").doc(t.id).update(s),r(n.formatMessage({id:"Tangram modified successfuly"}))),e.resolve()},ae=G.useMemo(()=>{if(!t.approved)return 0;let ne=0;for(const me in u[t.id])u[t.id][me]&&(ne+=1);return ne},[t,u]);return R.jsxs(ls,{title:R.jsx(Gr,{children:h?n.formatMessage({id:"Submit your tangram"}):n.formatMessage({id:"Edit your tangram"})}),onClose:()=>e.reject(gn),as:"form",onSubmit:m(te),css:{gap:3},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsx(yd,{showStroke:i.isAdmin,selected:!0,completed:!0,tangram:s,css:{alignSelf:"center"}}),t.approved&&R.jsx(Ze,{css:{alignSelf:"center",fontSize:2},children:R.jsx(xt,{id:"Earned {stars}",values:{stars:ae,starIcon:()=>R.jsx(Cr,{icon:Mo,css:{fill:"currentColor"}})}})}),h&&!i.isAdmin&&R.jsx(_s,{children:R.jsx(xt,{id:"A moderator will have to approve your tangram. It can be deleted or edited at any time.",values:{br:()=>R.jsx("br",{})}})}),i&&i.isAdmin&&R.jsx(R.Fragment,{children:R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Path"})}),R.jsx(_n,{as:"textarea",...w("path")}),z.errors.path&&R.jsx(Or,{children:z.errors.path.message})]})}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Category"})}),R.jsx(_n,{as:"select",...w("category"),children:iN.map(ne=>R.jsx("option",{value:ne,children:n.formatMessage({id:ne})},ne))})]}),V==="digits"?R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(_n,{as:"select",...w("digitIndex"),children:wc.map((ne,me)=>R.jsx("option",{value:me,children:ne},me))})]}):V==="letters"?R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(_n,{as:"select",...w("letterIndex"),children:Ec.map((ne,me)=>R.jsx("option",{value:me,children:ne},me))})]}):R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(_n,{...w("emoji")}),R.jsx(_s,{children:n.formatMessage({id:"Leave empty for random emoji"})})]})]}),R.jsx(gr,{type:"submit",children:h?n.formatMessage({id:"Submit!"}):n.formatMessage({id:"Edit!"})}),!h&&R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(bi,{onClick:re,children:n.formatMessage({id:"Or delete tangram"})})})]})},g$=({tangram:t,deferred:e})=>{const{currentUser:n}=G.useContext(Qn);return n&&(n.isAdmin||!t.id||t.uid===n.uid)?R.jsx(f$,{tangram:t,deferred:e}):R.jsx(d$,{tangram:t,deferred:e})};class gs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}const Gk=G.createContext([!0,()=>{}]),NE=()=>G.useContext(Gk),p$=({children:t})=>{const[e,n]=G.useState(!0);G.useEffect(()=>{const s=window.localStorage.getItem("showBackgroundPattern");if(s===null){n(!0);return}try{const a=JSON.parse(s);n(!!JSON.parse(a))}catch{window.localStorage.removeItem("showBackgroundPattern")}},[]);const r=G.useCallback(()=>{const s=!e;n(s),window.localStorage.setItem("showBackgroundPattern",JSON.stringify(s))},[e]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(Gk.Provider,{value:i,children:t})},Wk=G.createContext(["",()=>{}]),Kk=()=>G.useContext(Wk),OS="css-system-theme",MS={breakpoints:{s:"40em",m:"52em",l:"64em"},space:[0,4,8,16,32,64,128,256,512],sizes:{menu:40,inline:16,logo:128,icon:24,badge:32,badgeBig:86},borderWidths:{loader:8},radii:[0,4,8,16,32],fontSizes:[10,12,14,18,22,30,46,62,70]},rf={light:{...MS,colors:{pieces:{st1:"#FECA57",st2:"#48DBFB",mt1:"#1DD1A1",lt1:"#FF6B6B",lt2:"#8557E0",sq:"#FF9FF3",rh:"#54A0FF"},difficulties:["#10ac84","#2e86de","#ee5253"],shape:"#121212",background:"#fff",dialogBackground:"#d9d9d9",dialogText:"#303030",inputBackground:"#fff",errorText:"#bd0808",notificationBackground:"#FFFFFFdd"}},dark:{...MS,colors:{pieces:{st1:"#CE9518",st2:"#1CACCB",mt1:"#0CA57C",lt1:"#C33B3B",lt2:"#5C2DB9",sq:"#C95EBC",rh:"#2E75CF"},difficulties:["#0b8767","#1a6cbd","#ce3737"],shape:"#595959",background:"#15141a",dialogBackground:"#383838",dialogText:"#d8d8d8",inputBackground:"#595959",errorText:"#e63c3c",notificationBackground:"#000000dd"}}},m$="light",_$=({children:t})=>{const[e,n]=G.useState(m$);G.useEffect(()=>{const s=window.localStorage.getItem(OS);rf[s]&&n(s)},[]);const r=G.useCallback(s=>{rf[s]&&(n(s),window.localStorage.setItem(OS,s))},[rf]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(Wk.Provider,{value:i,children:R.jsx(Di.Provider,{value:rf[e],children:t})})},DE=G.createContext(),v$=({deferred:t,tip:{id:e,title:n=R.jsx(Gr,{children:R.jsx(xt,{id:"Random tip"})}),content:r}})=>{const i=nn(),[s,a]=G.useState(!1);return R.jsxs(ls,{onClose:()=>t.reject(gn),title:n,css:{gap:3},children:[r,R.jsx(gr,{onClick:()=>t.resolve(s),children:i.formatMessage({id:"Got it!"})}),e!=="welcome"&&R.jsxs(fe,{as:"label",css:{gap:1,flexDirection:"row",cursor:"pointer",alignItems:"flex-end"},children:[R.jsx("input",{type:"checkbox",checked:s,onChange:()=>a(!s)}),R.jsx(Ze,{as:"small",children:i.formatMessage({id:"I don't want to see tips anymore"})})]})]})},ar={settingsIcon:R.jsx(Cr,{icon:Dk}),accountIcon:R.jsx(Cr,{icon:Mk}),menuIcon:R.jsx(Cr,{icon:kk}),galleryIcon:R.jsx(Cr,{icon:Rk}),shareIcon:R.jsx(Cr,{icon:Ok}),createIcon:R.jsx(Cr,{icon:Nk}),leaderboardIcon:R.jsx(Cr,{icon:Pk}),starIcon:R.jsx(Cr,{icon:Mo}),br:()=>R.jsx("br",{})},y$=[{id:"particles",predicate:({particles:t})=>t,content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.particles",values:ar})})},{id:"menu",content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.menu",values:ar})})},{id:"gallery",content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.gallery",values:ar})})},{id:"difficulty",predicate:({showBackgroundPattern:t})=>t,content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.difficulty",values:ar})})},{id:"theme",predicate:({themeKey:t})=>t!=="dark",content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.theme",values:ar})})},{id:"sound",predicate:({soundEnabled:t})=>t,content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.sound",values:ar})})},{id:"account1",predicate:({currentUser:t})=>!t,content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.account1",values:ar})})},{id:"account2",predicate:({currentUser:t})=>!t,content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.account2",values:ar})})},{id:"stars",predicate:({currentUser:t})=>t,content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.stars",values:ar})})},{id:"create",predicate:({currentUser:t,approvedTangrams:e,isTangramCompleted:n})=>{if(t){let r=0;for(const{id:i}of e)if(n(i)&&(r+=1,r===10))return!0}return!1},content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.create",values:ar})})},{id:"share",content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.share",values:ar})})},{id:"card",content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.card",values:ar})})},{id:"leaderboard",content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.leaderboard",values:ar})})}],w$=({children:t})=>{const e=nn(),n=G.useContext(gi),[r,i]=G.useState(null),[s,a]=G.useState(!0),{soundEnabled:u}=G.useContext(pi),[h]=Kk(),[g]=NE(),{currentUser:m}=G.useContext(Qn),{approvedTangrams:w}=G.useContext(Ko),{isTangramCompleted:T}=G.useContext(Fr);G.useEffect(()=>{a(window.localStorage.getItem("hideTips")===null)},[]),G.useEffect(()=>{s?window.localStorage.removeItem("hideTips"):window.localStorage.setItem("hideTips",!0)},[s]);const I=()=>{let J=[];const re=localStorage.getItem("seenTips");if(re)try{const te=JSON.parse(re);if(!Array.isArray(te))throw new Error("Invalid data for seenTips : "+te);J=te}catch{localStorage.removeItem("seenTips")}return J},j=G.useCallback(J=>{const re=I(),te=new gs;return i({deferred:te,tip:J}),te.promise.then(ae=>{ae&&a(!1)}).finally(()=>{localStorage.setItem("seenTips",JSON.stringify([...re,J.id])),i(null)})},[]),z=G.useCallback(()=>{!s||I().includes("welcome")||(!m||!w.some(re=>T(re.id)))&&j({id:"welcome",title:R.jsx(Gr,{children:R.jsx(xt,{id:"Welcome to Amstangram",values:ar})}),content:R.jsx(Ze,{css:{textAlign:"justify"},children:R.jsx(xt,{id:"tips.welcome",values:ar})})})},[j,s,m,w,T]),X=G.useCallback(()=>{if(!s)return;const J=I(),re=y$.filter(({id:ae,predicate:ne=()=>!0})=>!J.includes(ae)&&ne({themeKey:h,showBackgroundPattern:g,currentUser:m,approvedTangrams:w,isTangramCompleted:T,soundEnabled:u}));if(!re.length)return;const te=re[0];j(te)},[j,w,T,h,m,g,u,s]),V=G.useCallback(()=>{a(J=>!J)},[]),B=G.useCallback(()=>{a(!0),window.localStorage.removeItem("seenTips"),n(e.formatMessage({id:"Tips reseted successfuly"}))},[n,e]),U=G.useMemo(()=>({showRandomTip:X,showWelcome:z,tipsEnabled:s,toggleTips:V,resetTips:B}),[X,z,s,V,B]);return R.jsxs(DE.Provider,{value:U,children:[t,r&&R.jsx(v$,{...r})]})},sf=20,oc=({leftComponent:t,leftValue:e,rightComponent:n,rightValue:r,value:i,onChange:s,invertSounds:a})=>{const{playToggle:u,soundEnabled:h}=G.useContext(pi),g=G.useContext(Di),m=G.useMemo(()=>i===r?"right":"left",[i,r]),w=()=>{a?h||u({forceSoundEnabled:!0}):u()},T=()=>{s((m==="left"?"right":"left")==="right"?r:e),w()},I=j=>{j!==m&&(s(j==="right"?r:e),w())};return R.jsxs(fe,{css:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:3},children:[R.jsx(fe,{css:{cursor:"pointer",flex:"1",alignItems:"flex-end"},onClick:()=>I("left"),children:t}),R.jsx(fe,{onClick:T,css:{cursor:"pointer",position:"relative",bg:"inputBackground",width:`${2*sf}px`,height:`${sf}px`,borderRadius:"99999px"},children:R.jsx(fe,{css:{position:"absolute",size:`${sf}px`,borderRadius:"99999px",bg:"dialogText",boxShadow:`0 0 0 2px ${g.colors.inputBackground}`,transition:"left 250ms ease-in-out"},style:{left:m==="left"?0:sf}})}),R.jsx(fe,{css:{cursor:"pointer",flex:"1",alignItems:"flex-start"},onClick:()=>I("right"),children:n})]})},Qk=G.createContext([!0,()=>{}]),Yk=()=>G.useContext(Qk),E$=({children:t})=>{const[e,n]=G.useState(!0);G.useEffect(()=>{const s=window.localStorage.getItem("showParticles");if(s===null){n(!0);return}try{const a=JSON.parse(s);n(!!JSON.parse(a))}catch{window.localStorage.removeItem("showParticles")}},[]);const r=G.useCallback(()=>{const s=!e;n(s),window.localStorage.setItem("showParticles",JSON.stringify(s))},[e]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(Qk.Provider,{value:i,children:t})},I$=({deferred:t})=>{const{soundEnabled:e,toggleSound:n}=G.useContext(pi),{tipsEnabled:r,toggleTips:i,resetTips:s}=G.useContext(DE),[a,u]=NE(),[h,g]=Yk(),{language:m,setLanguage:w}=G.useContext(kE),T=nn(),[I,j]=Kk(),z=X=>{w(X.target.value)};return R.jsxs(ls,{title:R.jsx(Gr,{children:T.formatMessage({id:"Settings"})}),onClose:()=>t.reject(gn),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Language"})}),R.jsx(_n,{as:"select",onChange:z,value:m,children:Sy.map(X=>R.jsx("option",{value:X,children:T.formatMessage({id:X})},X))})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Difficulty"})}),R.jsx(oc,{value:a,onChange:u,leftComponent:R.jsx(Ze,{children:T.formatMessage({id:"Easy"})}),leftValue:!0,rightComponent:R.jsx(Ze,{children:T.formatMessage({id:"Hard"})}),rightValue:!1})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Theme"})}),R.jsx(oc,{value:I,onChange:j,leftComponent:R.jsx(fe,{as:o8,css:{size:"icon"}}),leftValue:"light",rightComponent:R.jsx(fe,{as:i8,css:{size:"icon"}}),rightValue:"dark"})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Sounds"})}),R.jsx(oc,{invertSounds:!0,value:e,onChange:n,leftComponent:R.jsx(fe,{as:l8,css:{size:"icon"}}),leftValue:!1,rightComponent:R.jsx(fe,{as:a8,css:{size:"icon"}}),rightValue:!0})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Show particles"})}),R.jsx(oc,{value:h,onChange:g,leftComponent:R.jsx(Ze,{children:T.formatMessage({id:"Yes"})}),leftValue:!0,rightComponent:R.jsx(Ze,{children:T.formatMessage({id:"No"})}),rightValue:!1})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Show tips"})}),R.jsx(oc,{value:r,onChange:i,leftComponent:R.jsx(Ze,{children:T.formatMessage({id:"Yes"})}),leftValue:!0,rightComponent:R.jsx(Ze,{children:T.formatMessage({id:"No"})}),rightValue:!1})]})]}),R.jsx(y8,{onClick:s,children:T.formatMessage({id:"Reset tips"})})]})},Id=G.createContext(),T$=({children:t})=>{const{initialized:e}=G.useContext(Qn),{playlist:n,setPlaylist:r,startRandomPlaylist:i,initialized:s}=G.useContext(Fr),{initialized:a,approvedTangrams:u}=G.useContext(Ko),[h,g]=G.useState(!1),[m,w]=G.useState(null),T=G.useCallback(async it=>{const he=new gs;w({uid:it,deferred:he});try{await he.promise}catch(lt){if(lt!==gn)throw lt}finally{w(null)}},[]),[I,j]=G.useState(null),z=G.useCallback(async()=>{const it=new gs;j(it);try{await it.promise}catch(he){if(he!==gn)throw he}finally{j(null)}},[]),[X,V]=G.useState(null),B=G.useCallback(async()=>{const it=new gs;V(it);try{await it.promise}catch(he){if(he!==gn)throw he}finally{V(null)}},[]),[U,J]=G.useState(null),re=G.useCallback(async()=>{const it=new gs;J(it);try{await it.promise}catch(he){if(he!==gn)throw he}finally{J(null)}},[]),[te,ae]=G.useState(null),ne=G.useCallback(async it=>{const he=new gs;ae({deferred:he,tangram:it});try{await he.promise}catch(lt){if(lt!==gn)throw lt}finally{ae(null)}},[]),[me,pe]=G.useState(null),rt=G.useCallback(async()=>{const it=new gs;pe(it);try{await it.promise}catch(he){if(he!==gn)throw he}finally{pe(null)}},[]),[Ve,xe]=G.useState(null);G.useEffect(()=>{(async()=>{if(a&&s&&e&&!h){let he=!1;if(!n&&window.location.search){const lt=new URLSearchParams(window.location.search);if(lt.has("tangrams")){const Ce=lt.get("tangrams").split(","),Te=lt.get("uid"),Oe=u.filter(Je=>Ce.includes(Je.id));if(Oe.length){window.history.replaceState({},document.title,window.location.origin);const Je=new gs;xe({deferred:Je,tangrams:Oe,uid:Te});try{await Je.promise,he=!0,r(Oe)}catch(Tt){if(Tt!==gn)throw Tt}finally{xe(null)}}}}he||i(!0),g(!0)}})()},[a,s,e,h]);const we=G.useMemo(()=>({showProfile:T,showLeaderboard:z,showGallery:B,showLogin:re,showTangram:ne,showSettings:rt}),[T,z,B,re,ne,rt]);return R.jsxs(Id.Provider,{value:we,children:[t,U&&R.jsx(J8,{deferred:U}),X&&R.jsx(b8,{deferred:X}),te&&R.jsx(g$,{...te}),m&&R.jsx(a$,{...m}),I&&R.jsx(P8,{deferred:I}),Ve&&R.jsx(T8,{...Ve}),me&&R.jsx(I$,{deferred:me})]})},pl=({action:t,icon:e,text:n})=>{const{playButton:r}=G.useContext(pi);return R.jsxs(fe,{css:{alignItems:"center",flexDirection:"row",gap:3,cursor:"pointer",py:3},onClick:()=>{r(),t()},children:[R.jsx(fe,{as:e,css:{size:"icon"}}),R.jsx(Ze,{css:{fontSize:3},children:n})]})},S$=()=>{const{playlist:t,saveRequestId:e}=G.useContext(Fr),{currentUser:n}=G.useContext(Qn),{playButton:r}=G.useContext(pi),i=nn(),{showLeaderboard:s,showGallery:a,showLogin:u,showProfile:h,showSettings:g}=G.useContext(Id),[m,w]=G.useState();G.useEffect(()=>{m&&m.reject(gn)},[t,e]);const{requestSave:T}=G.useContext(Fr),I=async()=>{r();const X=new gs;w(X);try{await X.promise}catch(V){if(V!==gn)throw V}finally{w(null)}},j=Lf({0:{color:"pieces.lt2"},14:{color:"pieces.rh"},28:{color:"pieces.st2"},42:{color:"pieces.mt1"},57:{color:"pieces.st1"},71:{color:"pieces.lt1"},85:{color:"pieces.sq"},100:{color:"pieces.lt2"}}),z=Lf({from:{transform:"translate(0, 0)"},to:{transform:"translate(30px, -30px)"}});return R.jsxs(R.Fragment,{children:[R.jsx(fe,{css:{position:"fixed",top:3,left:3,animation:`${j} 20s linear infinite both`},children:R.jsx(fe,{as:kk,css:{size:"menu",cursor:"pointer"},onClick:I})}),m&&R.jsxs(ls,{onClose:()=>m.reject(gn),title:R.jsxs(fe,{css:{flexDirection:"row",gap:3,alignItems:"center"},children:[R.jsx(UA,{css:{size:"badge",ml:"-2px",mr:"-6px",overflow:"visible","& > g":{animation:`${z} ${ni}ms ${__}ms ease both`}}}),R.jsx(Gr,{children:i.formatMessage({id:"Amstangram"})})]}),css:{gap:3,overflow:"initial"},children:[R.jsxs(fe,{children:[n?R.jsx(pl,{action:()=>h(n.uid),icon:()=>R.jsx(cm,{css:{mx:-1},uid:n.uid,size:"badge"}),text:i.formatMessage({id:"See my profile"})}):R.jsx(pl,{action:u,icon:Mk,text:i.formatMessage({id:"Log in"})}),R.jsx(pl,{action:a,icon:Rk,text:i.formatMessage({id:"Tangram gallery"})}),R.jsx(pl,{action:T,icon:Nk,text:i.formatMessage({id:"Save tangram"})}),R.jsx(pl,{action:s,icon:Pk,text:i.formatMessage({id:"Leaderboard"})}),R.jsx(pl,{action:g,icon:Dk,text:i.formatMessage({id:"Settings"})})]}),R.jsxs(fe,{css:{flexDirection:"row",alignItems:"baseline",justifyContent:"space-between"},children:[R.jsx(_s,{as:ES,href:`mailto:millagou.benjamin@gmail.com?subject=${i.formatMessage({id:"A word about Amstangram"})}`,target:"_blank",rel:"noopener, noreferrer",children:i.formatMessage({id:"Contact ðŸ’Œ"})}),R.jsx(_s,{as:ES,href:"https://github.com/myagoo/amstangram",target:"_blank",rel:"noopener, noreferrer",children:i.formatMessage({id:"Version {code}"},{code:"âœ¨.ðŸ¥¸.ðŸš€"})})]})]})]})},Vh=(t,e)=>{const n=new window.ClipperLib.ClipperOffset,r=new window.ClipperLib.Paths;if(n.AddPaths([t.map(({x:i,y:s})=>({X:i,Y:s}))],window.ClipperLib.JoinType.jtMiter,window.ClipperLib.EndType.etClosedPolygon),n.MiterLimit=0,n.ArcTolerance=0,n.Execute(r,e),r.length)return r[0].map(({X:i,Y:s})=>new Ge.Point(i,s))},x$=t=>{const e=t[1].getDistance(t[2]),n=t[0].getDistance(t[2]),r=t[0].getDistance(t[1]),i=e+n+r,s=(t[0].x*e+t[1].x*n+t[2].x*r)/i,a=(t[0].y*e+t[1].y*n+t[2].y*r)/i;return new Ge.Point(s,a)},ac=(t,e)=>{const n=[new Ge.Point(0,0),new Ge.Point(t*2,0),new Ge.Point(t,t)],r=new Ge.Path({name:"display",segments:n,closed:!0}),i=new Ge.Path({name:"collision",segments:Vh(n,-da),closed:!0}),s=new Ge.Path({name:"insetBorder",segments:Vh(n,-ms),closed:!0,strokeWidth:ms}),a=x$(n),u=new Ge.Point(Ge.view.center.x+a.x-r.bounds.width/2,Ge.view.center.y+a.y-r.bounds.height/2);return new Ge.Group({children:[r,i,s],position:Ge.view.center,pivot:u,data:{id:e,collisions:new Set},applyMatrix:!0})},C$=(t,e)=>{const n=[new Ge.Point(0,0),new Ge.Point(t*2,0),new Ge.Point(t*3,t),new Ge.Point(t,t)],r=new Ge.Path({name:"display",segments:n,closed:!0}),i=new Ge.Path({name:"collision",segments:Vh(n,-da),closed:!0,strokeWidth:da}),s=new Ge.Path({name:"insetBorder",segments:Vh(n,-ms),closed:!0,strokeWidth:ms});return new Ge.Group({children:[r,i,s],position:Ge.view.center,data:{id:e,collisions:new Set},applyMatrix:!0})},A$=(t,e)=>{const n=new Ge.Path.Rectangle({name:"display",point:[0,0],size:[t,t]}),r=new Ge.Path.Rectangle({name:"collision",point:[da,da],size:[t-da*2,t-da*2]}),i=new Ge.Path.Rectangle({name:"insetBorder",point:[ms,ms],size:[t-ms*2,t-ms*2],strokeWidth:ms});return new Ge.Group({children:[n,r,i],position:Ge.view.center,data:{id:e,collisions:new Set},applyMatrix:!0,rotation:Math.round(Math.random()*7)*45})},b$=()=>{const t=Jk,e=Math.sqrt(Math.pow(t,2)*2),n=Math.sqrt(Math.pow(e,2)*2);return new Ge.Group([ac(t,"st1"),ac(t,"st2"),ac(e,"mt1"),ac(n,"lt1"),ac(n,"lt2"),A$(e,"sq"),C$(t,"rh")])},P$=(t,e)=>{let n;for(const h of t.children){const g=h.children.display;n?n=n.unite(g,{insert:!1}):n=g}n.scale(1/e),n.position=new Ge.Point(n.bounds.width/2,n.bounds.height/2);const r=n.exportSVG().getAttribute("d"),i=n.curves.length,s=Math.round(n.bounds.width),a=Math.round(n.bounds.height),u=Math.round(n.length);return n.remove(),{width:s,height:a,length:u,path:r,edges:i}},LS=(t,e,n)=>{const r={x:n.x-e.x,y:n.y-e.y},i={x:t.x-e.x,y:t.y-e.y},s=r.x*r.x+r.y*r.y;let a=i.x*r.x+i.y*r.y;const u=Math.min(1,Math.max(0,a/s));return a=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x),new Ge.Point(e.x+r.x*u,e.y+r.y*u)},VS=(t,e,n)=>{for(const r of e)for(const{point:i}of r.segments)for(const{point:s}of t.segments){const a=s.getDistance(i);a<n.distance&&(n.distance=a,n.shape=r,n.vector=i.subtract(s))}if(!n.vector)for(const r of e){for(const{point:i}of t.segments)for(const{point:s,next:{point:a}}of r.segments){const u=LS(i,s,a),h=u.getDistance(i);h<n.distance&&(n.distance=h,n.vector=u.subtract(i),n.shape=r,n.segment=[s,a],n.point=i)}for(const{point:i}of r.segments)for(const{point:s,next:{point:a}}of t.segments){const u=LS(i,s,a),h=u.getDistance(i);h<n.distance&&(n.distance=h,n.vector=i.subtract(u),n.shape=t,n.segment=[s,a])}}return n},FS=(t,e,n)=>{if(n.segment){let r=n.maxDistance,i;const[s,a]=n.segment,u=Math.atan2(a.y-s.y,a.x-s.x),h=Math.atan2(s.y-a.y,s.x-a.x);for(const g of[u,h])for(const{point:m}of t.segments){if(m===n.point)continue;const w=m.add(n.vector),T=new Ge.Point(w.x+n.maxDistance*Math.cos(g),w.y+n.maxDistance*Math.sin(g)),I=new Ge.Path.Line({from:w,to:T,insert:!1});for(const j of e){const z=I.getIntersections(j);for(const{point:X}of z){const V=X.subtract(w).add(n.vector);V.length<n.maxDistance&&V.length<=r&&(r=V.length,i=V)}}}i&&(n.vector=i)}},R$=(t,e,n,r)=>{let i={maxDistance:t,distance:t};return VS(e,n,i),r&&VS(e,r,i),FS(e,n.filter(s=>s.shape!==i.shape),i),r&&FS(e,r,i),i.vector},k$=(t,e,n)=>{let r=t;for(const i of e.children){if(i.data.collisions.size>0)return;r=r.unite(new Ge.Path({segments:Vh(i.children.display.segments.map(({point:s})=>s),-n),closed:!0,insert:!1}),{insert:!1})}return Math.round(r.length*1e3)===Math.round(t.length*1e3)},N$=t=>{for(const e of t.children)if(e.data.collisions.size>0)return!1;return!0},of=(t,e)=>{const n=t.pivot?t.pivot.subtract(t.bounds.center):new Ge.Point;t.bounds.x<0&&(t.position.x=t.bounds.width/2+n.x),t.bounds.y<0&&(t.position.y=t.bounds.height/2+n.y),t.bounds.x+t.bounds.width>e.width/window.devicePixelRatio&&(t.position.x=e.width/window.devicePixelRatio-t.bounds.width/2+n.x),t.bounds.y+t.bounds.height>e.height/window.devicePixelRatio&&(t.position.y=e.height/window.devicePixelRatio-t.bounds.height/2+n.y)},D$=(t,e)=>{const n=new Ge.Point(Ge.project.view.bounds.width,Ge.project.view.bounds.height).subtract(ME*2);if(t.position=Ge.Point.random().multiply(n).add(ME),t.data.id==="rh"){const r=Math.round(Math.random()*3)*45;t.rotation=r,t.data.rotation=r}else t.rotation=Math.round(Math.random()*7)*45},BS=(t,e)=>e.segments.every(n=>t.contains(n.point)),m_=(t,e)=>{for(const r of e.children){if(r===t)continue;const i=t.children.collision,s=r.children.collision;i.intersects(s)||BS(i,s)||BS(s,i)?(t.data.collisions.add(r.data.id),r.data.collisions.add(t.data.id)):(t.data.collisions.delete(r.data.id),r.data.collisions.delete(t.data.id))}let n=!0;for(const r of e.children)r.data.collisions.size>0?(n=!1,r.children.display.opacity=Zk):r.children.display.opacity=1;return n},O$=({tangram:t,onStop:e,onNext:n,onApprove:r,onStarToggle:i})=>{const s=nn(),[a,u]=G.useState(!1),{playStar:h}=G.useContext(pi),{tangramsStarredBy:g,isTangramStarred:m}=G.useContext(Fr),w=G.useMemo(()=>{let z=0;for(const X in g[t.id])g[t.id][X]&&(z+=1);return z},[t,g]),T=m(t.id),I=Lf({0:{opacity:"0",transform:"rotate(0) scale(0)"},100:{opacity:1,transform:`rotate(${360*5}deg) scale(1)`}}),j=()=>{setTimeout(()=>u(!0),1e3)};return R.jsx(fe,{css:{position:"absolute",top:0,left:0,right:0,bottom:0,alignItems:"center",justifyContent:"center",gap:3},children:R.jsxs(fe,{css:{position:"relative"},children:[R.jsx(fe,{onAnimationEnd:j,css:{textShadow:"0px 5px 10px #00000080",fontSize:"30vmin",animation:`2000ms ${I} cubic-bezier(.6,1.56,.58,.92) forwards`},children:t.emoji},"emojiSpin"),a&&R.jsxs(fe,{css:{mt:3,position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",flexDirection:"row",gap:3,animation:`${ni}ms fadeIn ease both`},children:[r&&R.jsxs(fe,{as:gr,onClick:r,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:r8,css:{size:"icon"}}),R.jsx(Ze,{children:s.formatMessage({id:"Approve"})})]}),i&&R.jsxs(fe,{as:gr,mute:!0,onClick:()=>{h(),i()},css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(Ze,{children:w}),R.jsx(fe,{as:Mo,css:{size:"icon",fill:T?"currentColor":void 0},deps:[T]})]}),n?R.jsxs(fe,{as:gr,onClick:n,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:s8,css:{size:"icon"}}),R.jsx(Ze,{children:s.formatMessage({id:"Next"})})]}):R.jsxs(fe,{as:gr,onClick:e,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:Lk,css:{size:"icon"}}),R.jsx(Ze,{children:s.formatMessage({id:"Quit"})})]})]})]})})},M$=()=>{const t=nn(),{showRandomTip:e,showWelcome:n}=G.useContext(DE),{showLogin:r,showTangram:i}=G.useContext(Id),{playTangram:s,playVictory:a}=G.useContext(pi),u=G.useRef();u.current={tangram:s,victory:a};const{currentUser:h}=G.useContext(Qn),g=G.useRef();g.current=h;const m=G.useContext(Di),w=G.useContext(gi),[T]=NE(),[I]=Yk(),{saveRequestId:j,playlist:z,setPlaylist:X,markTangramAsComplete:V,toggleTangramStar:B}=G.useContext(Fr),U=G.useRef();U.current=V;const[J,re]=G.useState(0),[te,ae]=G.useState(!1),ne=G.useRef(),me=G.useRef(),pe=G.useRef(),rt=G.useRef(),Ve=G.useRef(),xe=G.useRef(),we=G.useRef(),it=G.useRef(),he=G.useMemo(()=>z&&z[J],[z,J]),lt=()=>{ae(!1),re(J+1),e()},Ce=()=>{ae(!1),X(null),e()},Te=async()=>{await jt.firestore().collection("tangrams").doc(he.id).update({approved:!0}),w(t.formatMessage({id:"Tangram approved"}))};return G.useEffect(()=>{re(0)},[z]),G.useEffect(()=>{if(j){if(!N$(pe.current)){w(t.formatMessage({id:"You can't save an invalid tangram"}));return}const Oe=P$(pe.current,me.current);if(Oe.edges===23){w(t.formatMessage({id:"You can't save such an easy tangram"}));return}(async()=>{h||await r(),await i(Oe)})()}},[j]),G.useEffect(()=>{const Oe=()=>{if(ne.current&&pe.current)for(const Je of pe.current.children)of(Je,ne.current)};return window.addEventListener("resize",Oe),()=>window.removeEventListener("resize",Oe)},[]),G.useLayoutEffect(()=>{const Oe=Date.now(),Je=ot=>{let Ft=null,Xe=null,dn=null,Cn=null;const us=or=>{document.activeElement===ne.current&&(document.body.style.cursor="pointer")},kt=or=>{document.body.style.cursor="default"},Ht=or=>{dn=Date.now(),Cn=or.point,Ft=or.point.subtract(ot.position),Xe=ot.clone({insert:!1,deep:!0}),ot.bringToFront()},Ot=or=>{document.body.style.cursor="move";const ei=or.point.subtract(ot.position).subtract(Ft);Xe.position=ot.position.add(ei);const Yo=Xe.children["display 1"],Xo=pe.current.children.filter(se=>se!==ot).map(({children:se})=>se.display),Td=we.current&&xe.current?xe.current.children?xe.current.children:[xe.current]:null,Z=R$(OE,Yo,Xo,Td);Z&&(Xe.position.x+=Z.x,Xe.position.y+=Z.y),of(Xe,ne.current),ot.position=Xe.position,m_(ot,pe.current)},Qo=or=>{if(document.body.style.cursor="pointer",or.point.subtract(Cn).length<OE&&Date.now()-dn<nN&&(ot.rotation+=45,ot.data.id==="rh"&&(ot.data.rotation+=45,ot.data.rotation===180&&(ot.data.rotation=0,ot.scale(-1,1))),u.current.tangram(),of(ot,ne.current),m_(ot,pe.current),dn=null,Cn=null),Ft=null,Xe&&Xe.remove(),Xe=null,!!xe.current&&(we.current===!1&&(xe.current.position=pe.current.position),k$(xe.current,pe.current,we.current?eN:tN))){U.current(he,Date.now()-Oe);for(const Zr of pe.current.children)Zr.data.removeListeners();if(document.body.style.cursor="default",!it.current){u.current.victory(),ae(!0);return}Ge.project.activeLayer.tween({opacity:0},{duration:xd,easing:"easeInCubic"});for(const Zr of Ve.current)Zr.data.animation.stop(),Zr.tween({"position.x":pe.current.position.x,"position.y":pe.current.position.y,opacity:BE},{duration:xd,easing:"easeInCubic"});setTimeout(()=>{u.current.victory(),Ge.project.activeLayer.tween({opacity:1},{duration:ni,easing:"easeOutCubic"});const Zr=Math.max(Ge.view.bounds.width,Ge.view.bounds.height)/2;for(const ei of Ve.current){ei.data.animation.stop();const Yo=Math.random()*Math.PI*2,Xo=Math.random()*Zr;ei.tween({"position.x":ei.position.x+Xo*Math.cos(Yo),"position.y":ei.position.y+Xo*Math.sin(Yo),opacity:0},{duration:xd,easing:"easeOutCubic"})}ae(!0)},xd)}};ot.on({mouseenter:us,mouseleave:kt,mousedown:Ht,mousedrag:Ot,mouseup:Qo}),ot.data.removeListeners=()=>ot.off({mouseenter:us,mouseleave:kt,mousedown:Ht,mousedrag:Ot,mouseup:Qo})};return(()=>{Ge.setup(ne.current),pe.current=b$(),he&&(xe.current=Ge.project.importSVG(`<path d="${he.path}" />`,{applyMatrix:!0}),xe.current.sendToBack(),xe.current.fillRule="evenodd",xe.current.closed=!0);const ot=Ge.project.view.bounds,Ft=xe.current?xe.current.bounds:pe.current.children[3].bounds.scale(2);ot.width>ot.height?me.current=Math.min(Math.min(ot.width*.7,700)/Ft.width,Math.min(ot.height*.8,600)/Ft.height):me.current=Math.min(Math.min(ot.width*.8,600)/Ft.width,Math.min(ot.height*.7,700)/Ft.height),xe.current&&(xe.current.scale(me.current),xe.current.position=Ge.view.center);for(const Xe of pe.current.children)Xe.scale(me.current),D$(Xe,ne.current),Je(Xe),of(Xe,ne.current),m_(Xe,pe.current)})(),()=>{Ge.project.remove(),Ve.current=null,pe.current=null,xe.current=null}},[he]),G.useLayoutEffect(()=>{we.current=T,xe.current&&(T?(xe.current.fillColor=m.colors.shape,xe.current.position=Ge.view.center):xe.current.fillColor="transparent")},[he,T,m]),G.useLayoutEffect(()=>{if(it.current=I,!I)return;const Oe=new Ge.Group;Oe.sendToBack();const Je=new Ge.Point(ne.current.width,ne.current.height).divide(window.devicePixelRatio),Tt=()=>Math.random()*(rN-VE)+VE,ot=()=>Math.random()*(BE-FE)+FE;Ve.current=new Array(LE);for(let Ft=0;Ft<LE;Ft++){const Xe=new Ge.Path.Circle({center:Ge.Point.random().multiply(Je),radius:Tt(),opacity:ot(),parent:Oe,data:{index:Ft}}),dn=()=>{const Cn={radius:Tt(),opacity:ot(),"position.x":Math.min(ne.current.width/window.devicePixelRatio,Math.max(0,Xe.position.x+Math.random()*200-100)),"position.y":Math.min(ne.current.height/window.devicePixelRatio,Math.max(0,Xe.position.y+Math.random()*200-100))};Xe.data.animation=Xe.tween(Cn,{duration:Math.random()*1e4+5e3,easing:"easeInOutQuad"}).then(dn)};dn(),Ve.current[Ft]=Xe}},[he,I]),G.useLayoutEffect(()=>{!I&&rt.current&&(rt.current.remove(),rt.current=null,Ve.current=null)},[I]),G.useLayoutEffect(()=>{for(const Je of pe.current.children)Je.children.display.fillColor=m.colors.pieces[Je.data.id],Je.children.insetBorder.strokeColor=m.colors.pieces[Je.data.id];const Oe=Object.values(m.colors.pieces);if(I)for(const Je of Ve.current)Je.fillColor=Oe[Math.floor(Math.random()*Oe.length)]},[m.colors,he,I]),G.useEffect(()=>{n()},[]),R.jsxs(fe,{css:{flex:"1",position:"relative",color:"dialogText",animation:`${ni}ms fadeIn ease`},children:[he&&T===!1&&R.jsx(fe,{css:{zIndex:-1,position:"absolute",top:3,right:3,cursor:"pointer"},children:R.jsx(yd,{tangram:he,selected:!0,hideBadge:!0})}),R.jsx(fe,{as:"canvas",ref:ne,css:{minHeight:"auto",flex:1}}),he&&te&&R.jsx(O$,{tangram:he,onStop:Ce,onNext:J<z.length-1?lt:void 0,onApprove:h&&h.isAdmin&&!he.approved?Te:void 0,onStarToggle:h&&he.approved?()=>B(he):void 0})]})},L$=()=>{const t=nn(),e=G.useContext(gi),[n,r]=G.useState(!1),[i,s]=G.useState(!1),[a,u]=G.useState(!1),[h,g]=G.useState(!1),{initialized:m}=G.useContext(Ko),{playlist:w,initialized:T}=G.useContext(Fr),{currentUser:I,initialized:j}=G.useContext(Qn),z=j&&m&&T&&w;if(G.useEffect(()=>{setTimeout(()=>r(!0),ni*2),u(setTimeout(()=>s(!0),ni*2))},[]),G.useEffect(()=>{z&&(clearTimeout(a),s(!1))},[z]),h)return R.jsxs(R.Fragment,{children:[R.jsx(M$,{}),R.jsx(S$,{})]});const X=()=>{g(!0),I&&e(t.formatMessage({id:"Logged in as {username}"},{username:I.username}))};return R.jsxs(fe,{css:{flex:"1",alignItems:"center",justifyContent:"center",gap:3,animation:z&&n?`${ni}ms fadeIn ease ${__}ms forwards reverse`:void 0},deps:[z,n],onAnimationEnd:V=>{V.currentTarget===V.target&&X()},children:[R.jsx(fe,{css:{animation:`${ni}ms fadeIn ease ${__}ms both`},children:R.jsx(UA,{css:{size:"logo",overflow:"visible","& > g":{transition:`all ${ni}ms ease`,transform:z&&n?"translate(30px, -30px)":"translate(0, 0)"}},deps:[z,n]})}),R.jsx(Gr,{css:{transition:`opacity ${ni}ms ease`,opacity:i?1:0},deps:[i],children:t.formatMessage({id:"Loading..."})})]})};window.isSecureContext&&navigator.serviceWorker.getRegistrations().then(function(t){for(let e of t)e.unregister()});const V$=()=>(G.useEffect(()=>{matchMedia("hover: none").matches&&(window.oncontextmenu=function(){return!1})},[]),HN({body:{m:0,bg:"background",fontFamily:"'Comic Neue', cursive",fontWeight:"bolder","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",transition:`background-color ${Of}ms`},"body, html, #root":{height:"100%"},"#root":{display:"flex",flexDirection:"column",padding:`
        env(safe-area-inset-top, 0)
        env(safe-area-inset-right, 0)
        env(safe-area-inset-bottom, 0)
        env(safe-area-inset-left, 0)
      `},"*":{boxSizing:"border-box",userSelect:"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"},"input, textarea":{"-webkit-user-select":"initial","-moz-user-select":"initial","-ms-user-select":"initial",userSelect:"initial"}}),R.jsx(v8,{children:R.jsx(r$,{children:R.jsx(Lz,{children:R.jsx(Vz,{children:R.jsx(Zz,{children:R.jsx(p$,{children:R.jsx(E$,{children:R.jsx(e8,{children:R.jsx(w$,{children:R.jsx(T$,{children:R.jsx(fe,{css:{flex:"1",color:"dialogText",fontSize:3},children:R.jsx(L$,{})})})})})})})})})})})}));x_.createRoot(document.getElementById("root")).render(R.jsx(_$,{children:R.jsx(V$,{})}));export{sN as c,US as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}