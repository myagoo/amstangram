(function(){"use strict";const Z={current:!0},g=50*Math.SQRT2/6/Math.SQRT2,tt=function(t){return t*Math.PI/180},yt=function(t){return t*180/Math.PI},z=function(t){if(t<0)for(;t<0;)t+=360;else if(t>=360)for(;t>=360;)t-=360;return t},E=function(t,e){return Math.abs(t-e)<1e-12},qt=function(t,e,r){return Math.abs(t-e)<r},U=function(t,e){return!E(t,e)},et=function(t){for(var e=t.length,r,s;e;)s=Math.floor(Math.random()*e),e--,r=t[e],t[e]=t[s],t[s]=r;return t},H=function(t,e,r){t=t.sort(e);for(var s=[t[0]],n=1;n<t.length;n++)s.push(t[n]),e(t[n],t[n-1])===0&&(s.pop(),r||s.pop());return s};class o{constructor(e,r){this.coeffInt=e,this.coeffSqrt=r}dup(){return new o(this.coeffInt,this.coeffSqrt)}toFloat(){return this.coeffInt+this.coeffSqrt*Math.SQRT2}eq(e){return Z.current?this.coeffInt===e.coeffInt&&this.coeffSqrt===e.coeffSqrt:E(this.coeffInt,e.coeffInt)&&E(this.coeffSqrt,e.coeffSqrt)}sameSign(e){var r=new o(0,0);return r.compare(this)===r.compare(e)}compare(e){if(this.eq(e))return 0;var r=this.toFloat(),s=e.toFloat();return r<s?-1:1}distance(e){var r=this.dup();return r.subtract(e),r.abs()}closeNumbers(e,r){return qt(this.toFloat(),e.toFloat(),r)}isZero(){return Z.current?this.coeffInt===0&&this.coeffSqrt===0:E(this.coeffInt,0)&&E(this.coeffSqrt,0)}add(e){return this.coeffInt+=e.coeffInt,this.coeffSqrt+=e.coeffSqrt,this}subtract(e){return this.coeffInt-=e.coeffInt,this.coeffSqrt-=e.coeffSqrt,this}multiply(e){var r=this.coeffInt;return this.coeffInt=r*e.coeffInt+2*this.coeffSqrt*e.coeffSqrt,this.coeffSqrt=r*e.coeffSqrt+this.coeffSqrt*e.coeffInt,this}div(e){var r=e.coeffInt*e.coeffInt-2*e.coeffSqrt*e.coeffSqrt;if(!E(r,0)){var s=this.coeffInt;return this.coeffInt=s*e.coeffInt-2*this.coeffSqrt*e.coeffSqrt,this.coeffSqrt=this.coeffSqrt*e.coeffInt-s*e.coeffSqrt,this}}neg(){return this.coeffInt=-this.coeffInt,this.coeffSqrt=-this.coeffSqrt,this}abs(){return this.toFloat()<0&&(this.coeffInt=-this.coeffInt,this.coeffSqrt=-this.coeffSqrt),this}scale(e){if(E(e,0)){console.log("Scaling by 0 is not possible!"),console.log(JSON.stringify(this));return}return this.coeffInt*=e,this.coeffSqrt*=e,this}}function u(t,e){typeof t>"u"?this.x=new o(0,0):this.x=t,typeof e>"u"?this.y=new o(0,0):this.y=e}u.prototype.dup=function(){return new u(this.x.dup(),this.y.dup())},u.prototype.toFloatX=function(){return this.x.toFloat()},u.prototype.toFloatY=function(){return this.y.toFloat()},u.prototype.compare=function(t){var e=this.x.compare(t.x),r=this.y.compare(t.y);return e!=0?e:r},u.prototype.compareYX=function(t){var e=this.x.compare(t.x),r=this.y.compare(t.y);return r!=0?r:e},u.prototype.multipleOf=function(t){var e=this.x.sameSign(t.x),r=this.y.sameSign(t.y);if(!(e&&r))return!1;if(this.x.isZero()&&t.x.isZero())return this.y.isZero()&&t.y.isZero()?!0:r;if(this.y.isZero()&&t.y.isZero())return e;var s=this.x.dup().div(t.x),n=this.y.dup().div(t.y);return typeof s>"u"||typeof n>"u"?(console.log("Undefined"),console.log(this.x.coeffInt+","+this.x.coeffSqrt+" - "+this.y.coeffInt+","+this.y.coeffSqrt),console.log(t.x.coeffInt+","+t.x.coeffSqrt+" - "+t.y.coeffInt+","+t.y.coeffSqrt),!1):s.eq(n)};const D=function(t,e){return t.compare(e)},St=function(t,e){return t.compareYX(e)};u.prototype.eq=function(t){return this.x.eq(t.x)&&this.y.eq(t.y)},u.prototype.isZero=function(){return this.x.isZero()&&this.y.isZero()},u.prototype.length=function(){return Math.sqrt(this.dotProduct(this).toFloat())},u.prototype.neg=function(){return this.x.neg(),this.y.neg(),this},u.prototype.angle=function(){if(this.isZero())return 0;var t=Math.atan2(this.toFloatY(),this.toFloatX());return t=z(yt(t)),Math.round(t)},u.prototype.distance=function(t){var e=t.dup().subtract(this);return e.length()},u.prototype.angleTo=function(t){if(this.isZero())return t.angle();if(t.isZero())return this.angle();var e=360-(t.angle()-this.angle());return e=z(e),e},u.prototype.add=function(t){return this.x.add(t.x),this.y.add(t.y),this},u.prototype.middle=function(t){var e=new u;return e.add(this),e.add(t),e.scale(.5),e},u.prototype.subtract=function(t){return this.x.subtract(t.x),this.y.subtract(t.y),this},u.prototype.normalize=function(){var t=this.length();return U(t,0)&&(this.x.scale(1/t),this.y.scale(1/t)),this},u.prototype.dotProduct=function(t){return this.x.dup().multiply(t.x).add(this.y.dup().multiply(t.y))},u.prototype.determinant=function(t){return this.x.dup().multiply(t.y).subtract(this.y.dup().multiply(t.x))},u.prototype.transform=function(t){if(t.length!=3){console.log("Matrix seems to have the wrong dimension!");return}var e=new o(1,0),r=this.dup();this.x=r.x.dup().multiply(t[0][0]),this.x.add(r.y.dup().multiply(t[0][1])),this.x.add(e.dup().multiply(t[0][2])),this.y=r.x.dup().multiply(t[1][0]),this.y.add(r.y.dup().multiply(t[1][1])),this.y.add(e.dup().multiply(t[1][2]));var s=e.dup();return e=r.x.dup().multiply(t[2][0]),e.add(r.y.dup().multiply(t[2][1])),e.add(s.dup().multiply(t[2][2])),U(e,1)&&U(e,0)&&(this.x.div(e),this.y.div(e)),this},u.prototype.translate=function(t,e){var r=[[new o(1,0),new o(0,0),t],[new o(0,0),new o(1,0),e],[new o(0,0),new o(0,0),new o(1,0)]];return this.transform(r)},u.prototype.rotate=function(t){t=z(t);var e,r;t%45!=0?(e=new o(Math.cos(tt(t)),0),r=new o(Math.sin(tt(t)),0)):(t%90!=0?(e=new o(0,.5),r=new o(0,.5)):t%180!=0?(e=new o(0,0),r=new o(1,0)):(e=new o(1,0),r=new o(0,0)),t>180&&t<360&&r.neg(),t>90&&t<270&&e.neg());var s=[[e,r.dup().neg(),new o(0,0)],[r,e,new o(0,0)],[new o(0,0),new o(0,0),new o(1,0)]];return this.transform(s),this},u.prototype.scale=function(t){if(E(0,t)){console.log("Attempt to scale by 0!"),console.log(JSON.stringify(this));return}return this.x.scale(t),this.y.scale(t),this};const V=function(t,e,r){var s=t.dup().subtract(r).determinant(e.dup().subtract(r));return s.isZero()?0:s.toFloat()>0?1:-1},xt=function(t,e,r){for(var s=[],n=[],i=0;i<t.length;i++)t[i].eq(e)&&s.push(i),t[i].eq(r)&&n.push(i);return s.length>=2&&n.length>=2},c=[],F=[],C=[],G=8;for(var J=0;J<=5;J++)F[J]=[],c[J]=[],C[J]=[];c[0][0]=[new u(new o(0,12*g),new o(0,0)),new u(new o(0,0),new o(0,12*g))],c[1][0]=[new u(new o(12*g,0),new o(0,0)),new u(new o(0,0),new o(12*g,0))],c[2][0]=[new u(new o(0,6*g),new o(0,0)),new u(new o(0,0),new o(0,6*g))],c[3][0]=[new u(new o(0,6*g),new o(0,0)),new u(new o(0,6*g),new o(0,6*g)),new u(new o(0,0),new o(0,6*g))],c[4][0]=[new u(new o(12*g,0),new o(0,0)),new u(new o(18*g,0),new o(6*g,0)),new u(new o(6*g,0),new o(6*g,0))],c[5][0]=[new u(new o(12*g,0),new o(0,0)),new u(new o(18*g,0),new o(-6*g,0)),new u(new o(6*g,0),new o(-6*g,0))];for(var a=0;a<=5;a++){for(var W=new u,M=0;M<c[a][0].length;M++)W.add(c[a][0][M]);W.scale(1/(c[a][0].length+1)),F[a][0]=[],F[a][0][0]=W}for(a=0;a<=1;a++){var rt=c[a][0][0].dup().add(c[a][0][1]).scale(.5),Y=c[a][0][0].dup().add(rt),A=c[a][0][1].dup().add(rt);if(Y.scale(1/c[a][0].length),F[a][0][1]=Y,A.scale(1/c[a][0].length),F[a][0][2]=A,a===0){var bt=c[a][0][0].dup().scale(.5),Ft=c[a][0][1].dup().scale(.5),st=bt.add(Ft);st.scale(1/c[a][0].length),st.scale(1/c[a][0].length)}}for(a=3;a<=5;a++){for(Y=new u,A=new u,M=0;M<c[a][0].length;M++)M!=c[a][0].length-1&&Y.add(c[a][0][M]),A.add(c[a][0][M]);Y.scale(1/c[a][0].length),F[a][0][1]=Y,A.scale(1/c[a][0].length),F[a][0][2]=A}var nt=[[new o(0,.5),new o(0,-.5),new o(0,0)],[new o(0,.5),new o(0,.5),new o(0,0)],[new o(0,0),new o(0,0),new o(1,0)]];for(a=0;a<=5;a++)for(var v=0;v<7;v++){c[a][v+1]=[],F[a][v+1]=[];for(var M=0;M<F[a][v].length;M++)F[a][v+1][M]=F[a][v][M].dup().transform(nt);for(var Q=0;Q<c[a][0].length;Q++)c[a][v+1][Q]=c[a][v][Q].dup().transform(nt)}for(a=0;a<=5;a++)for(v=0;v<=7;v++)if(C[a][v]=[],C[a][v][0]=[c[a][v][0].dup(),c[a][v][a<3?1:2].dup()],C[a][v][1]=[c[a][v][0].dup().neg(),c[a][v][0].dup().neg().add(c[a][v][1].dup())],a<3)C[a][v][2]=[c[a][v][1].dup().neg(),c[a][v][1].dup().neg().add(c[a][v][0].dup())];else{var it=c[a][v][1].dup().neg();C[a][v][2]=[c[a][v][0].dup().add(it),c[a][v][2].dup().add(it)],C[a][v][3]=[c[a][v][2].dup().neg(),c[a][v][2].dup().neg().add(c[a][v][1].dup())]}function q(t,e){if(t==="undefined"?this.point1=new u:this.point1=t,e==="undefined"?this.point2=new u:this.point2=e,!this.point1.isZero()&&!this.point2.isZero()||this.point2.isZero()&&!this.point1.isZero()){var r=this.point1.compare(this.point2);if(r===1){var s=this.point1;this.point1=this.point2,this.point2=s}}}q.prototype.dup=function(){return new q(this.point1.dup(),this.point2.dup())},q.prototype.length=function(){return this.point1.distance(this.point2)},q.prototype.direction=function(){return this.point2.dup().subtract(this.point1)},q.prototype.lineParameters=function(){var t=[];if(this.point1.x.eq(this.point2.x))t[0]=1,t[1]=0,t[2]=this.point1.x.dup().neg().toFloat();else if(this.point1.y.eq(this.point2.y))t[0]=0,t[1]=1,t[2]=this.point1.y.dup().neg().toFloat();else{var e=this.direction();t[0]=e.toFloatX()/e.toFloatY(),t[1]=-1,t[2]=this.point2.determinant(this.point1).toFloat()/e.toFloatX()}return t},q.prototype.eq=function(t){return this.point1.eq(t.point1)&&this.point2.eq(t.point2)||this.point2.eq(t.point1)&&this.point1.eq(t.point2)},q.prototype.compare=function(t){var e=this.point1.compare(t.point1),r=this.point2.compare(t.point2);if(e==="undefined"||r==="undefined"){console.log("Comparison between the segments is not possible!");return}return e!=0?e:r},q.prototype.split=function(t){if(t.length===0)return[this];t=t.sort(D);var e=[];e[0]=new q(this.point1,t[0]);var r;for(r=1;r<t.length;r++)e[r]=new q(t[r-1],t[r]);return e[r]=new q(t[r-1],this.point2),e},q.prototype.projectedParameter=function(t){if(this.point1.eq(this.point2))return 1;var e=t.dup().subtract(this.point1),r=this.direction(),s=e.dotProduct(r).toFloat()/r.dotProduct(r).toFloat();return s},q.prototype.onSegment=function(t){if(t.eq(this.point1)||t.eq(this.point2)||this.point1.eq(this.point2))return!1;if(V(this.point1,this.point2,t)===0){var e=this.projectedParameter(t);return e>=0&&e<=1}return!1},q.prototype.onSegmentIncludingEndpoints=function(t){if(t.eq(this.point1)||t.eq(this.point2)||this.point1.eq(this.point2))return!0;if(V(this.point1,this.point2,t)===0){var e=this.projectedParameter(t);return e>=0&&e<=1}return!1},q.prototype.intersectsOrientations=function(t){var e=V(this.point1,this.point2,t.point1),r=V(this.point1,this.point2,t.point2),s=V(t.point1,t.point2,this.point1),n=V(t.point1,t.point2,this.point2);return e!=r&&s!=n},q.prototype.intersectsIncludingSegment=function(t){return this.point1.eq(t.point1)||this.point2.eq(t.point1)||this.point1.eq(t.point2)||this.point2.eq(t.point2)?!1:this.intersectsOrientations(t)},q.prototype.intersects=function(t){return this.onSegmentIncludingEndpoints(t.point1)||this.onSegmentIncludingEndpoints(t.point2)||t.onSegmentIncludingEndpoints(this.point1)||t.onSegmentIncludingEndpoints(this.point2)?!1:this.intersectsOrientations(t)},q.prototype.angleTo=function(t){var e,r;if(this.point1.eq(t.point1))e=this.direction(),r=t.direction();else if(this.point1.eq(t.point2))e=this.direction(),r=t.direction().scale(-1);else if(this.point2.eq(t.point1))e=this.direction().scale(-1),r=t.direction();else if(this.point2.eq(t.point2))e=this.direction().scale(-1),r=t.direction().scale(-1);else return;return e.angleTo(r)};const K=function(t,e){return t.compare(e)},Mt=new o(576*g,0);function O(t,e,r){this.tanType=t,this.anchor=e,this.orientation=r,!(typeof Z>"u")&&Z.current&&(this.points=this.getPoints(),this.segments=this.getSegments(),this.insidePoints=this.getInsidePoints())}O.prototype.dup=function(){return new O(this.tanType,this.anchor.dup(),this.orientation)};var Et=[96,48,24,48,48,48].map(t=>t*g);O.prototype.area=function(){return Et[this.tanType]},O.prototype.getPoints=function(){if(Z.current&&typeof this.points<"u")return this.points;var t=[];t[0]=this.anchor.dup();for(var e=c[this.tanType][this.orientation],r=0;r<e.length;r++){var s=this.anchor.dup();s.add(e[r]),t[r+1]=s}return t},O.prototype.getSegments=function(){if(Z.current&&typeof this.segments<"u")return this.segments;for(var t=[],e=this.getPoints(),r=0;r<e.length-1;r++)t[r]=new q(e[r],e[r+1]);return t[r]=new q(e[r],e[0]),t},O.prototype.center=function(){return this.anchor.dup().add(F[this.tanType][this.orientation][0])},O.prototype.getInsidePoints=function(){if(Z.current&&typeof this.insidePoints<"u")return this.insidePoints;for(var t=[],e=F[this.tanType][this.orientation].length,r=0;r<e;r++)t.push(this.anchor.dup().add(F[this.tanType][this.orientation][r]));return t},O.prototype.toSVG=function(){for(var t=this.getPoints(),e="",r=0;r<t.length;r++)e+=t[r].toFloatX()+", "+t[r].toFloatY()+" ";return e};const $=function(t){for(var e=[],r=0;r<t.length;r++){var s=t[r].getPoints();e=e.concat(s)}return e=H(e,D,!0),e},P=function(t){for(var e=new o(0,0),r=0;r<t.length-1;r++)e.add(t[r].determinant(t[r+1]));return e.add(t[r].determinant(t[0])),e.abs(),e.scale(.5)},ot=function(t,e){for(var r=0;r<e.length;r++){var s=T(t,e[r]);if(s===-1)return!1}return!0},Ot=function(t,e){for(var r=[],s,n=0;n<e.length;n++){s=e[n].getSegments();for(var i=0;i<s.length;i++){for(var h=[],f=0;f<t.length;f++)s[i].onSegment(t[f])&&h.push(t[f]);r=r.concat(s[i].split(h))}}return r=H(r,K,!1),r},at=function(t,e){for(var r=360,s=-1,n=0;n<e.length;n++){var i=e[n].angleTo(t);i<r&&(s=n,r=i)}return[s,r]},ft=function(t,e){for(var r=0,s=-1,n=0;n<e.length;n++){var i=e[n].angleTo(t);i>r&&(s=n,r=i)}return[s,r]},ht=function(t,e,r,s,n){if(!(t.length===0||e.length===0)){t.sort(D);var i=t[0],h=i.dup();h.subtract(new u(new o(0,0),new o(1,0)));var f=[];f.push(i);var l=new q(h,i),m=!0;do{var w=e.filter(function(b){return!l.eq(b)&&(b.point1.eq(i)||b.point2.eq(i))}),S;m?S=ft(l,w):S=r(l,w);var y=S[0],x=S[1];if(y===-1)break;x===180&&!m&&n&&f.pop(),w[y].point1.eq(i)?(f.push(w[y].point2),i=w[y].point2):(f.push(w[y].point1),i=w[y].point1),l=w[y],e=e.filter(function(b){return!l.eq(b)}),m&&(m=!1)}while(!i.eq(t[0])||!ot(f,t)&&!s);return f.pop(),[f,e]}},Zt=function(t,e,r){if(!(t.length===0||e.length===0)){for(var s=e.length*2,n=0;s!=n;){s=e.length*2;for(var i=[],h=0;h<e.length;h++)i.push(e[h].point1),i.push(e[h].point2);e=e.filter(function(f){return xt(i,f.point1,f.point2)}),n=e.length*2}return t=H(i,D,!0),ht(t,e,at,!0,r)}},_=function(t,e){var r=[],s=0,n=$(t),i=Ot(n,t),h=ht(n,i,ft,!1,e);r[s]=h[0],i=h[1];var f=P(r[0]);for(console.log("console "+JSON.stringify(f));!f.eq(Mt)&&f.toFloat()>40001||!ot(r[0],n);){if(s++,h=Zt(n,i,at),typeof h>"u")return;r[s]=h[0],i=h[1],f.subtract(P(r[s]))}return r},d=function(t,e){typeof e>"u"?e=$(t):e=e[0];for(var r=new o(100*g,0),s=new o(100*g,0),n=new o(-100*g,0),i=new o(-100*g,0),h=0;h<e.length;h++){var f=e[h].x,l=e[h].y;f.compare(r)<0&&(r=f),l.compare(s)<0&&(s=l),f.compare(n)>0&&(n=f),l.compare(i)>0&&(i=l)}return[r,s,n,i]},T=function(t,e){for(var r=0,s=0;s<t.length;s++){var n=t[s],i=s===t.length-1?t[0]:t[s+1];if(e.eq(n)||e.eq(i)||new q(n,i).onSegment(e))return 0;t[s].y.compare(e.y)<=0?i.y.compare(e.y)===1&&V(i,e,n)>0&&r++:i.y.compare(e.y)<=0&&V(i,e,n)<0&&r--}return r===0?-1:1};var Vt=0,Ct=[1,1,2,6,24,120,720,5040,40320];function L(t,e){this.outlineVertices=0,this.outerOutlineVertices=0,this.numHoles=0,this.holeArea=0,this.holeVertices=0,this.holeType=0,this.perimeter=0,this.longestEdge=0,this.shortestEdge=0,this.rangeX=0,this.rangeY=0,this.convexPercentage=0,this.convexHullArea=0,this.symmetry=0,this.hangingPieces=0,this.matchedEdges=0,this.matchedVertices=0,this.computeEvaluation(t,e)}L.prototype.getValue=function(t){var e;switch(Vt){case 0:e=1-this.convexPercentage;break;case 1:e=this.outlineVertices;break;case 2:e=this.outerOutlineVertices;break;case 3:e=this.perimeter;break;case 4:e=-this.matchedVertices;break;case 5:e=(this.outerOutlineVertices-3)/26+1-this.convexPercentage;default:e=0}return e},L.prototype.computeConvexHullLess3Points=function(t){return t.length<=1||t[0].eq(t[1])&&t.pop(),t},L.prototype.computeConvexHull=function(t,e){if(t.length<=2)return this.computeConvexHullLess3Points(t);t=t.sort(function(i,h){var f=z(i.dup().subtract(e).angle()),l=z(h.dup().subtract(e).angle()),m=E(f,l),w=i.distance(e),S=h.distance(e);return m&&E(w,S)?0:!m&&f<l||m&&w<S?-1:1});for(var r=[t[0]],s=1;s<t.length-1;s++)r.push(t[s]),E(t[s].dup().subtract(e).angle(),t[s+1].dup().subtract(e).angle())&&r.pop();if(r.push(t[s]),r.length<=2)return this.computeConvexHullLess3Points(r);var n=[];for(n.push(r[0]),n.push(r[1]),s=2;s<r.length;s++){for(;n.length>1&&V(n[n.length-1],r[s],n[n.length-2])<=0;)n.pop();n.push(r[s])}return n};var ut=function(t){return function(e,r){var s=e.y.distance(t.y),n=r.y.distance(t.y),i=s.compare(n);return i===0?e.x.compare(r.x):i}},ct=function(t){return function(e,r){var s=e.x.distance(t.x),n=r.x.distance(t.x),i=s.compare(n);return i===0?e.y.compare(r.y):i}};L.prototype.computeEvaluation=function(t,e){this.outerOutlineVertices=e[0].length,this.numHoles=e.length-1;for(var r=0;r<e.length;r++)r!=0&&(this.holeArea+=P(e[r]).toFloat(),this.holeVertices+=e[r].length),this.outlineVertices+=e[r].length;this.longestEdge=-1,this.shortestEdge=60*g;for(var s,n=0;n<e[0].length;n++)n!=e[0].length-1?s=e[0][n].distance(e[0][n+1]):s=e[0][n].distance(e[0][0]),s>this.longestEdge&&(this.longestEdge=s),s<this.shortestEdge&&(this.shortestEdge=s),this.perimeter+=s;for(var i=_(t,!1)[0],n=0;n<i[0].length;n++)i[n].eq(i[n+1])&&this.hangingPieces++;for(var r=1;r<i.length;r++){for(var h=!1,f=0;f<i[r].length;f++){for(var n=0;n<i[0].length;n++)h=h||i[0][n].eq(i[r][f]);if(h)break}switch(this.holeType){case 0:h?this.holeType=2:this.holeType=1;break;case 1:h&&(this.holeType=3);break;case 2:h||(this.holeType=3);break}}var l=d(t,e);this.rangeX=l[2].dup().subtract(l[0]).toFloat(),this.rangeY=l[3].dup().subtract(l[1]).toFloat();var m=new u;m.x=l[0].dup().add(l[2]).scale(.5),m.y=l[1].dup().add(l[3]).scale(.5);var w=[],S=[],y=[],x=[];for(n=0;n<e[0].length;n++){var b=e[0][n].x.compare(m.x),wt=e[0][n].y.compare(m.y);b<0?y.push(e[0][n]):b>0&&x.push(e[0][n]),wt<0?w.push(e[0][n]):wt>0&&S.push(e[0][n])}w.sort(ut(m)),S.sort(ut(m)),y.sort(ct(m)),x.sort(ct(m));var X=!1;if(w.length==S.length){for(p=0;p<w.length;p++)if(!w[p].x.eq(S[p].x)||!w[p].y.distance(m.y).eq(S[p].y.distance(m.y))){X=!0;break}}else X=!0;if(X||this.symmetry++,X=!1,y.length==x.length){for(p=0;p<y.length;p++)if(!y[p].y.eq(x[p].y)||!y[p].x.distance(m.x).eq(x[p].x.distance(m.x))){X=!0;break}}else X=!0;X||this.symmetry++;var k=$(t),j=[];for(p=0;p<k.length;p++)j.push(0);for(var B=[],R,I=0;I<t.length;I++){R=t[I].getSegments();for(var N=0;N<R.length;N++){for(var mt=[],p=0;p<k.length;p++)R[N].onSegment(k[p])&&mt.push(k[p]),(R[N].point1.eq(k[p])||R[N].point2.eq(k[p]))&&j[p]++;B=B.concat(R[N].split(mt))}}for(var p=0;p<k.length;p++)j[p]/=2,j[p]>1&&(this.matchedVertices+=Ct[j[p]-1]);var zt=B.length;B=H(B,K,!1),this.matchedEdges=(zt-B.length)/2;var Dt=this.computeConvexHull(e[0],k.sort(St)[0]);this.convexHullArea=P(Dt).toFloat(),this.convexPercentage=576*g/this.convexHullArea};class kt{constructor(e){this.tans=e.sort(function(r,s){return r.tanType-s.tanType}),this.outline=_(this.tans,!0),typeof this.outline<"u"&&(this.evaluation=new L(this.tans,this.outline))}center(){var e=new u,r=d(this.tans,this.outline);return e.x=r[0].dup().add(r[2]).scale(.5),e.y=r[1].dup().add(r[3]).scale(.5),e}positionCentered(){var e=new u(new o(this.evaluation.rangeX/2,0),new o(this.evaluation.rangeY/2,0));e.subtract(this.center());for(var r=0;r<this.tans.length;r++)this.tans[r].anchor.translate(e.x,e.y);this.outline=_(this.tans,!0)}toSVGOutline(){for(var e="M "+this.outline[0][0].toFloatX()+", "+this.outline[0][0].toFloatY()+" ",r=1;r<this.outline[0].length;r++)e+="L "+this.outline[0][r].toFloatX()+", "+this.outline[0][r].toFloatY()+" ";e+="Z ";for(var s=1;s<this.outline.length;s++){e+="M "+this.outline[s][0].toFloatX()+", "+this.outline[s][0].toFloatY()+" ";for(var r=1;r<this.outline[s].length;r++)e+="L "+this.outline[s][r].toFloatX()+", "+this.outline[s][r].toFloatY()+" ";e+="Z"}return e}}const Xt=(t,e)=>t.evaluation.getValue()-e.evaluation.getValue();var lt=new o(50*g,0),vt=50,Ht=function(t,e){for(var r=e.getPoints(),s=r.concat(e.getInsidePoints()),n=0;n<t.length;n++){for(var i=t[n].getPoints(),h=0,f=0;f<s.length;f++){var l=T(i,s[f]);if(l===1)return!1;l===0&&h++}if(h>=3)return!1;for(h=0,i=i.concat(t[n].getInsidePoints()),f=0;f<i.length;f++){if(l=T(r,i[f]),l===1)return!1;l===0&&h++}if(h>=3)return!1}for(var m=e.getSegments(),w=0;w<m.length;w++)for(n=0;n<t.length;n++)for(var S=t[n].getSegments(),y=0;y<S.length;y++)if(m[w].intersects(S[y]))return!1;var x=t.slice(0);x[t.length]=e;var b=d(x);return!(b[2].dup().subtract(b[0]).compare(lt)>0||b[3].dup().subtract(b[1]).compare(lt)>0)},pt=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];if(!E(e,0)){for(r=0;r<t.length;r++)t[r]/=e;return t}},Yt=function(t,e,r,s,n){for(var i=[],h=[],f=0;f<n.length;f++)n[f].point1.eq(e)?h.push(n[f].direction()):n[f].point2.eq(e)&&h.push(n[f].direction().neg());for(var l=0;l<G;l++)for(i.push(1),f=0;f<h.length;f++)h[f].multipleOf(C[r][l][s][0])&&(i[l]+=vt),h[f].multipleOf(C[r][l][s][1])&&(i[l]+=vt);return pt(i)},At=function(t){var e=Math.random();if(t=t.slice(0),e<t[0])return 0;for(var r=1;r<G;r++)if(t[r]+=t[r-1],e<=t[r])return r;return G-1},Bt=function(t,e){var r=e.getPoints();return t=t.concat(r),H(t,D,!0)},Rt=function(t,e){for(var r=e.getPoints(),s=[],n=0;n<t.length;n++){for(var i=[],h=0;h<r.length;h++)t[n].onSegment(r[h])&&i.push(r[h]);s=s.concat(t[n].split(i))}return s=s.concat(e.getSegments()),s=H(s,K,!0),s},gt=function(){var t=Math.floor(Math.random()*2),e=[0,0,1,2,2,3,4+t];e=et(e);var r=Math.floor(Math.random()*G),s=[],n=new u(new o(30,0),new o(30,0));s[0]=new O(e[0],n,r);for(var i=s[0].getPoints(),h=s[0].getSegments(),f=1;f<7;f++)for(var l=!1,m=0;!l;){n=i[Math.floor(Math.random()*i.length)].dup();var w=0,S=e[f]<3?[0,1,2]:[0,1,2,3];S=et(S);do{for(var y,x=Yt(s,n,e[f],S[w],h);typeof x<"u"&&!l;){if(r=At(x),S[w]===0)y=new O(e[f],n,r);else{var b=n.dup().subtract(c[e[f]][r][S[w]-1]);y=new O(e[f],b,r)}Ht(s,y)&&(s[f]=y,l=!0,i=Bt(i,y),h=Rt(h,y)),x[r]=0,x=pt(x)}w++}while(!l&&w<(e[f]<3?3:4));if(m++,m>100)return console.log("Infinity loop!"),gt()}return new kt(s)},Nt=function(t){Z.current=!0;for(var e=[],r=0;r<t;r++){e[r]=gt(),self.postMessage(r);for(var s=0;s<7;s++)delete e[r].tans[s].points,delete e[r].tans[s].segments,delete e[r].tans[s].insidePoints}e=e.sort(Xt),Z.current=!1;for(var r=0;r<t;r++)self.postMessage(JSON.stringify(e[r].tans));self.postMessage("Generating done!")};self.addEventListener("message",function(t){var e=t.data;self.postMessage("Worker started!"),Nt(e)},!1)})();
