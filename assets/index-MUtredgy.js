(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const v2=50,y2=.25,Jo=1,os=4,w2=2,I2=5,uI=10,E2=300,od=1500,cI=100,mf=250,Wr=1e3,Kp=500,an="DIALOG_CLOSED_REASON",hI=60,T2=5,dI=2,fI=.25,gI=.75,S2=["animals","letters","digits","people","geometric","stuff"],rc=["0ï¸âƒ£","1ï¸âƒ£","2ï¸âƒ£","3ï¸âƒ£","4ï¸âƒ£","5ï¸âƒ£","6ï¸âƒ£","7ï¸âƒ£","8ï¸âƒ£","9ï¸âƒ£"],ic=["ðŸ„°","ðŸ„±","ðŸ„²","ðŸ„³","ðŸ„´","ðŸ„µ","ðŸ„¶","ðŸ„·","ðŸ„¸","ðŸ„¹","ðŸ„º","ðŸ„»","ðŸ„¼","ðŸ„½","ðŸ„¾","ðŸ„¿","ðŸ…€","ðŸ…","ðŸ…‚","ðŸ…ƒ","ðŸ…„","ðŸ……","ðŸ…†","ðŸ…‡","ðŸ…ˆ","ðŸ…‰"];window.sentryOnLoad=function(){Sentry.init({enabled:!0,release:`a966b11
`,environment:"production",beforeSend:(t,e)=>e.originalException===an?null:t})};{let t=function(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","G-F7R3KZMTTS",{anonymize_ip:!0,cookie_expires:0})}var x2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function C2(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var uS={exports:{}},wg={},cS={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wh=Symbol.for("react.element"),A2=Symbol.for("react.portal"),P2=Symbol.for("react.fragment"),b2=Symbol.for("react.strict_mode"),R2=Symbol.for("react.profiler"),k2=Symbol.for("react.provider"),N2=Symbol.for("react.context"),D2=Symbol.for("react.forward_ref"),M2=Symbol.for("react.suspense"),O2=Symbol.for("react.memo"),L2=Symbol.for("react.lazy"),mI=Symbol.iterator;function V2(t){return t===null||typeof t!="object"?null:(t=mI&&t[mI]||t["@@iterator"],typeof t=="function"?t:null)}var hS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dS=Object.assign,fS={};function su(t,e,n){this.props=t,this.context=e,this.refs=fS,this.updater=n||hS}su.prototype.isReactComponent={};su.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};su.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gS(){}gS.prototype=su.prototype;function ey(t,e,n){this.props=t,this.context=e,this.refs=fS,this.updater=n||hS}var ty=ey.prototype=new gS;ty.constructor=ey;dS(ty,su.prototype);ty.isPureReactComponent=!0;var pI=Array.isArray,mS=Object.prototype.hasOwnProperty,ny={current:null},pS={key:!0,ref:!0,__self:!0,__source:!0};function _S(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)mS.call(e,r)&&!pS.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var h=Array(u),g=0;g<u;g++)h[g]=arguments[g+2];i.children=h}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:wh,type:t,key:s,ref:a,props:i,_owner:ny.current}}function F2(t,e){return{$$typeof:wh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ry(t){return typeof t=="object"&&t!==null&&t.$$typeof===wh}function B2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var _I=/\/+/g;function $m(t,e){return typeof t=="object"&&t!==null&&t.key!=null?B2(""+t.key):e.toString(36)}function jd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case wh:case A2:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+$m(a,0):r,pI(i)?(n="",t!=null&&(n=t.replace(_I,"$&/")+"/"),jd(i,e,n,"",function(g){return g})):i!=null&&(ry(i)&&(i=F2(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(_I,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",pI(t))for(var u=0;u<t.length;u++){s=t[u];var h=r+$m(s,u);a+=jd(s,e,n,h,i)}else if(h=V2(t),typeof h=="function")for(t=h.call(t),u=0;!(s=t.next()).done;)s=s.value,h=r+$m(s,u++),a+=jd(s,e,n,h,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ad(t,e,n){if(t==null)return t;var r=[],i=0;return jd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function U2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var fr={current:null},zd={transition:null},j2={ReactCurrentDispatcher:fr,ReactCurrentBatchConfig:zd,ReactCurrentOwner:ny};ut.Children={map:ad,forEach:function(t,e,n){ad(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ad(t,function(){e++}),e},toArray:function(t){return ad(t,function(e){return e})||[]},only:function(t){if(!ry(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ut.Component=su;ut.Fragment=P2;ut.Profiler=R2;ut.PureComponent=ey;ut.StrictMode=b2;ut.Suspense=M2;ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j2;ut.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dS({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=ny.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(h in e)mS.call(e,h)&&!pS.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&u!==void 0?u[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=n;else if(1<h){u=Array(h);for(var g=0;g<h;g++)u[g]=arguments[g+2];r.children=u}return{$$typeof:wh,type:t.type,key:i,ref:s,props:r,_owner:a}};ut.createContext=function(t){return t={$$typeof:N2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:k2,_context:t},t.Consumer=t};ut.createElement=_S;ut.createFactory=function(t){var e=_S.bind(null,t);return e.type=t,e};ut.createRef=function(){return{current:null}};ut.forwardRef=function(t){return{$$typeof:D2,render:t}};ut.isValidElement=ry;ut.lazy=function(t){return{$$typeof:L2,_payload:{_status:-1,_result:t},_init:U2}};ut.memo=function(t,e){return{$$typeof:O2,type:t,compare:e===void 0?null:e}};ut.startTransition=function(t){var e=zd.transition;zd.transition={};try{t()}finally{zd.transition=e}};ut.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ut.useCallback=function(t,e){return fr.current.useCallback(t,e)};ut.useContext=function(t){return fr.current.useContext(t)};ut.useDebugValue=function(){};ut.useDeferredValue=function(t){return fr.current.useDeferredValue(t)};ut.useEffect=function(t,e){return fr.current.useEffect(t,e)};ut.useId=function(){return fr.current.useId()};ut.useImperativeHandle=function(t,e,n){return fr.current.useImperativeHandle(t,e,n)};ut.useInsertionEffect=function(t,e){return fr.current.useInsertionEffect(t,e)};ut.useLayoutEffect=function(t,e){return fr.current.useLayoutEffect(t,e)};ut.useMemo=function(t,e){return fr.current.useMemo(t,e)};ut.useReducer=function(t,e,n){return fr.current.useReducer(t,e,n)};ut.useRef=function(t){return fr.current.useRef(t)};ut.useState=function(t){return fr.current.useState(t)};ut.useSyncExternalStore=function(t,e,n){return fr.current.useSyncExternalStore(t,e,n)};ut.useTransition=function(){return fr.current.useTransition()};ut.version="18.2.0";cS.exports=ut;var G=cS.exports;const It=lS(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z2=G,$2=Symbol.for("react.element"),H2=Symbol.for("react.fragment"),q2=Object.prototype.hasOwnProperty,G2=z2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,W2={key:!0,ref:!0,__self:!0,__source:!0};function vS(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)q2.call(e,r)&&!W2.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:$2,type:t,key:s,ref:a,props:i,_owner:G2.current}}wg.Fragment=H2;wg.jsx=vS;wg.jsxs=vS;uS.exports=wg;var R=uS.exports,K2={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Qp=function(t,e){return Qp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Qp(t,e)};function yS(t,e){Qp(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Nr=function(){return Nr=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Nr.apply(this,arguments)};function Sc(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Ol(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,i++)r[i]=s[a];return r}function Q2(t,e){for(;t.length<e;)t="0"+t;return t}function es(t,e){var n,r,i;if(e.length===0)return t;for(n=0,i=e.length;n<i;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t<0?t*-2:t}function Y2(t,e,n){return Object.keys(e).sort().reduce(r,t);function r(i,s){return wS(i,e[s],s,n)}}function wS(t,e,n,r){var i=es(es(es(t,n),X2(e)),typeof e);if(e===null)return es(i,"null");if(e===void 0)return es(i,"undefined");if(typeof e=="object"||typeof e=="function"){if(r.indexOf(e)!==-1)return es(i,"[Circular]"+n);r.push(e);var s=Y2(i,e,r);if(!("valueOf"in e)||typeof e.valueOf!="function")return s;try{return es(s,String(e.valueOf()))}catch(a){return es(s,"[valueOf exception]"+(a.stack||a.message))}}return es(i,e.toString())}function X2(t){return Object.prototype.toString.call(t)}function J2(t){return Q2(wS(0,t,"",[]).toString(16),8)}var iy=J2,Z2={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},eN={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},tN={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],size:["width","height"]},nN={color:"colors",backgroundColor:"colors",borderColor:"colors",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",outlineColor:"colors",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",fill:"colors",stroke:"colors"},rN={margin:1,marginTop:1,marginRight:1,marginBottom:1,marginLeft:1,marginX:1,marginY:1,top:1,bottom:1,left:1,right:1},fi={unitlessProperties:Z2,propertyAliases:eN,multiplePropertyAliases:tN,propertyScales:nN,negativeProperties:rN},Dr=function(t,e,n){for(var r=t,i=typeof e=="string"?e.split("."):[e],s=0,a=i;s<a.length;s++){var u=a[s];r=r?r[u]:void 0}return r===void 0?n:r},IS=function(t,e){if(typeof e!="number"||e>=0)return Dr(t,e,e);var n=Math.abs(e),r=Dr(t,n,n);return typeof r=="string"?"-"+r:r*-1},Yp=function(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!(t in fi.unitlessProperties)?e+"px":String(e).trim()},Xp=function(t){return t.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})},iN=function(t,e){var n={},r=Dr(e,"breakpoints"),i=Object.entries(r).reduce(function(E,z,j){var J,V=z[0],B=z[1];return Nr(Nr({},E),(J={},J[V]="@media screen and (min-width: #"+j+"#"+B+")",J))},{_:null});for(var s in t){var a=t[s],u=typeof a;if(a!=null){if(s.includes("&")||s.startsWith("@")||u==="string"||u==="number"){n[s]=a;continue}for(var h=Object.keys(a),g=0,_=h;g<_.length;g++){var w=_[g],T=i[w];if(!T){n[s]=a[w];continue}n[T]=n[T]||{},a[w]!=null&&(n[T][s]=a[w])}}}return n},sy=function(t,e){var n={},r=iN(t,e);for(var i in r){var s=r[i];if(s&&typeof s=="object"){n[i]=sy(s,e);continue}var a=Dr(fi.propertyAliases,i,i),u=Dr(fi.propertyScales,a),h=Dr(e,u,Dr(e,a,{})),g=a in fi.negativeProperties?IS(h,s):Dr(h,s,s);if(fi.multiplePropertyAliases[a])for(var _=fi.multiplePropertyAliases[a],w=0;w<_.length;w++)n[_[w]]=g;else n[a]=g}return n},Jp=function(t,e,n){Object.keys(e).forEach(function(r){var i=e[r];typeof i=="string"||typeof i=="number"?(n[t]||(n[t]=""),n[t]+=Xp(r)+":"+Yp(r,i)+";"):typeof i=="object"&&(r.startsWith("@media")||r.startsWith("@supports")?(n[r]||(n[r]={}),Jp(t,i,n[r])):Jp(r.replace(/&/g,t),i,n))})},ES=function(t){var e={};return Jp("&",t,e),e},oy=[],Qs="global",pf="data-css-system-id",Zp="data-css-system-ids",e_=" ",sN=typeof process=="object"&&K2&&!1,t_=function(){function t(e){var n=this;this.createdIds={};var r=document.querySelector("style["+pf+'="'+e+'"]');if(r===null)r=document.createElement("style"),r.setAttribute(pf,e),document.head.appendChild(r);else{var i=r.getAttribute(Zp);i!==null&&i.split(e_).forEach(function(s){return n.createdIds[s]=!0})}this.element=r}return t.prototype.insertRule=function(e){var n=this.element.sheet;n.insertRule(e,n.cssRules.length)},t.prototype.remove=function(){this.element.remove()},t}(),vI=function(t){yS(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.insertRule=function(n){this.element.textContent+=n+`
`},e}(t_),TS=function(){function t(){var e;this.styleSheets=(e={},e[Qs]=new t_(Qs),e)}return t.prototype.getGlobalStyleSheet=function(){return this.styleSheets[Qs]},t.prototype.createStyleSheet=function(e){return this.styleSheets[e]=new t_(e),this.styleSheets[e]},t.prototype.removeStyleSheet=function(e){this.styleSheets[e]&&(this.styleSheets[e].remove(),delete this.styleSheets[e])},t}(),oN=function(t){yS(e,t);function e(){var n,r=t!==null&&t.apply(this,arguments)||this;return r.styleSheets=(n={},n[Qs]=new vI(Qs),n),r}return e.prototype.createStyleSheet=function(n){return this.styleSheets[n]=new vI(n),this.styleSheets[n]},e}(TS),yI=function(){function t(e){this.rules=[],this.createdIds={},this.id=e}return t.prototype.insertRule=function(e){this.rules.push(e)},t.prototype.getStyleTag=function(){return"<style "+pf+'="'+this.id+'" '+Zp+'="'+Object.keys(this.createdIds).join(e_)+'">'+this.rules.join(`
`)+"</style>"},t.prototype.getStyleComponent=function(){var e;return G.createElement("style",(e={},e[pf]=this.id,e[Zp]=Object.keys(this.createdIds).join(e_),e.dangerouslySetInnerHTML={__html:this.rules.join(`
`)},e))},t}(),aN=function(){function t(){var e;this.styleSheets=(e={},e[Qs]=new yI(Qs),e)}return t.prototype.getGlobalStyleSheet=function(){return this.styleSheets[Qs]},t.prototype.createStyleSheet=function(e){return this.styleSheets[e]=new yI(e),this.styleSheets[e]},t.prototype.removeStyleSheet=function(e){delete this.styleSheets[e]},t.prototype.getStyleTags=function(){return Object.values(this.styleSheets).map(function(e){return e.getStyleTag()}).join(`
`)},t.prototype.getStyleComponents=function(){return Object.values(this.styleSheets).map(function(e){return e.getStyleComponent()})},t}(),lN=typeof document<"u",ay=G.createContext(lN?sN?new oN:new TS:new aN),uN={breakpoints:{s:"40em",m:"52em",l:"64em"},space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},Ti=G.createContext(uN),cN=function(t,e){e===void 0&&(e=oy);var n=G.useContext(ay),r=G.useContext(Ti),i=G.useMemo(function(){var s=sy(t,r),a=iy(s),u="style-"+a,h=n.getGlobalStyleSheet();if(!h.createdIds[u]){for(var g=ES(s),_=Object.keys(g).sort(function(Z,ne){return Z<ne?-1:Z>ne?1:0}),w=0,T=_;w<T.length;w++){var E=T[w];if(typeof g[E]=="string"){var z=E.replace(/&/g,"."+u),j=g[E];h.insertRule(z+"{"+j+"}")}else{var J=E,V=g[J],B="";for(var U in V){var z=U.replace(/&/g,"."+u),j=V[U];B+=z+"{"+j+"}"}h.insertRule(J.replace(/#\d#/,"")+"{"+B+"}")}}h.createdIds[u]=!0}return u},Ol([r],e));return i},hN=function(t,e){e===void 0&&(e=oy);var n=G.useContext(ay),r=G.useContext(Ti),i=G.useMemo(function(){var s=iy({systemObject:t,theme:r}),a=n.createStyleSheet(s);for(var u in t)for(var h=sy(t[u],r),g=ES(h),_=Object.keys(g).sort(function(Z,ne){return Z<ne?-1:Z>ne?1:0}),w=0,T=_;w<T.length;w++){var E=T[w];if(typeof g[E]=="string"){var z=E.replace(/&/g,u).replace(/#\d#/,""),j=g[E];a.insertRule(z+"{"+j+"}")}else{var J=E,V=g[J],B="";for(var U in V){var z=U.replace(/&/g,u),j=V[U];B+=z+"{"+j+"}"}a.insertRule(J.replace(/#\d#/,"")+"{"+B+"}")}}return s},Ol([r],e));G.useEffect(function(){return function(){return n.removeStyleSheet(i)}},Ol([i,r],e))},dN=function(t,e){var n="";for(var r in t){var i=t[r],s=Dr(fi.propertyAliases,r,r),a=Dr(fi.propertyScales,s),u=Dr(e,a,Dr(e,s,{})),h=s in fi.negativeProperties?IS(u,i):Dr(u,i,i);if(fi.multiplePropertyAliases[s])for(var g=fi.multiplePropertyAliases[s],_=0;_<g.length;_++)n+=Xp(g[_])+":"+Yp(s,h)+";";else n+=Xp(s)+":"+Yp(s,h)+";"}return n},_f=function(t,e){e===void 0&&(e=oy);var n=G.useContext(ay),r=G.useContext(Ti),i=G.useMemo(function(){var s="keyframes-"+iy({keyframesObject:t,theme:r}),a=n.getGlobalStyleSheet();if(!a.createdIds[s]){var u="";for(var h in t){var g=t[h],_=isNaN(h)?h:h+"%",w=dN(g,r);u+=_+"{"+w+"}"}a.insertRule("@keyframes "+s+"{"+u+"}"),a.createdIds[s]=!0}return s},Ol([r],e));return i},SS=function(t){var e=t.css,n=Sc(t,["css"]);return function(r){var i=r.css,s=Sc(r,["css"]);return Nr(Nr(Nr({},n),{css:Nr(Nr({},e),i)}),s)}},Ih=function(t,e){var n=typeof e=="function"?e:SS(e);return It.forwardRef(function(r,i){var s=n(r),a=s.as,u=a===void 0?t:a,h=s.css,g=s.deps,_=s.className,w=Sc(s,["as","css","deps","className"]),T=cN(h,g),E=_?_+" "+T:T;return It.createElement(u,Nr({ref:i},w,{className:E}))})},Xi=function(t,e){var n=typeof e=="function"?e:SS(e);return It.forwardRef(function(r,i){var s=n(r),a=s.css,u=Sc(s,["css"]);return It.createElement(t,Nr({ref:i,css:a},u))})},fN=function(t){var e=t.gap,n=Sc(t,["gap"]),r=n.flexDirection,i=G.useContext(Ti),s=G.useMemo(function(){var a;if(e&&r){if(typeof r=="string"){var u=r==="column"||r==="column-reverse";return{"& > * + *":(a={},a[u?"mt":"ml"]=e,a)}}for(var h=void 0,g=void 0,_=typeof e=="object"?e:{_:e},w=r,T=new Set(Ol(Object.keys(w),Object.keys(_))),E={},z={},j=Ol(["_"],Object.keys(i.breakpoints)),J=0,V=j;J<V.length;J++){var B=V[J];if(T.has(B)!==!1){var U=B,Z=w[U]!=null?w[U]:h;h=Z;var ne=_[U]!=null?_[U]:g;g=ne;var u=Z==="column"||Z==="column-reverse";u?(E[U]=ne,z[U]=0):(z[U]=ne,E[U]=0)}}return{"& > * + *":{mt:E,ml:z}}}},[e,r,i]);return e?Nr(Nr({},n),s):n},n_={},xS={exports:{}},jr={},CS={exports:{}},AS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ce,Te){var De=Ce.length;Ce.push(Te);e:for(;0<De;){var Qe=De-1>>>1,vt=Ce[Qe];if(0<i(vt,Te))Ce[Qe]=Te,Ce[De]=vt,De=Qe;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function r(Ce){if(Ce.length===0)return null;var Te=Ce[0],De=Ce.pop();if(De!==Te){Ce[0]=De;e:for(var Qe=0,vt=Ce.length,nt=vt>>>1;Qe<nt;){var Dt=2*(Qe+1)-1,Ke=Ce[Dt],sn=Dt+1,yn=Ce[sn];if(0>i(Ke,De))sn<vt&&0>i(yn,Ke)?(Ce[Qe]=yn,Ce[sn]=De,Qe=sn):(Ce[Qe]=Ke,Ce[Dt]=De,Qe=Dt);else if(sn<vt&&0>i(yn,De))Ce[Qe]=yn,Ce[sn]=De,Qe=sn;else break e}}return Te}function i(Ce,Te){var De=Ce.sortIndex-Te.sortIndex;return De!==0?De:Ce.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var h=[],g=[],_=1,w=null,T=3,E=!1,z=!1,j=!1,J=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Ce){for(var Te=n(g);Te!==null;){if(Te.callback===null)r(g);else if(Te.startTime<=Ce)r(g),Te.sortIndex=Te.expirationTime,e(h,Te);else break;Te=n(g)}}function Z(Ce){if(j=!1,U(Ce),!z)if(n(h)!==null)z=!0,he(ne);else{var Te=n(g);Te!==null&&it(Z,Te.startTime-Ce)}}function ne(Ce,Te){z=!1,j&&(j=!1,V(ce),ce=-1),E=!0;var De=T;try{for(U(Te),w=n(h);w!==null&&(!(w.expirationTime>Te)||Ce&&!Ze());){var Qe=w.callback;if(typeof Qe=="function"){w.callback=null,T=w.priorityLevel;var vt=Qe(w.expirationTime<=Te);Te=t.unstable_now(),typeof vt=="function"?w.callback=vt:w===n(h)&&r(h),U(Te)}else r(h);w=n(h)}if(w!==null)var nt=!0;else{var Dt=n(g);Dt!==null&&it(Z,Dt.startTime-Te),nt=!1}return nt}finally{w=null,T=De,E=!1}}var te=!1,ae=null,ce=-1,_e=5,me=-1;function Ze(){return!(t.unstable_now()-me<_e)}function Oe(){if(ae!==null){var Ce=t.unstable_now();me=Ce;var Te=!0;try{Te=ae(!0,Ce)}finally{Te?xe():(te=!1,ae=null)}}else te=!1}var xe;if(typeof B=="function")xe=function(){B(Oe)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,et=we.port2;we.port1.onmessage=Oe,xe=function(){et.postMessage(null)}}else xe=function(){J(Oe,0)};function he(Ce){ae=Ce,te||(te=!0,xe())}function it(Ce,Te){ce=J(function(){Ce(t.unstable_now())},Te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){z||E||(z=!0,he(ne))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(Ce){switch(T){case 1:case 2:case 3:var Te=3;break;default:Te=T}var De=T;T=Te;try{return Ce()}finally{T=De}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,Te){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var De=T;T=Ce;try{return Te()}finally{T=De}},t.unstable_scheduleCallback=function(Ce,Te,De){var Qe=t.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?Qe+De:Qe):De=Qe,Ce){case 1:var vt=-1;break;case 2:vt=250;break;case 5:vt=1073741823;break;case 4:vt=1e4;break;default:vt=5e3}return vt=De+vt,Ce={id:_++,callback:Te,priorityLevel:Ce,startTime:De,expirationTime:vt,sortIndex:-1},De>Qe?(Ce.sortIndex=De,e(g,Ce),n(h)===null&&Ce===n(g)&&(j?(V(ce),ce=-1):j=!0,it(Z,De-Qe))):(Ce.sortIndex=vt,e(h,Ce),z||E||(z=!0,he(ne))),Ce},t.unstable_shouldYield=Ze,t.unstable_wrapCallback=function(Ce){var Te=T;return function(){var De=T;T=Te;try{return Ce.apply(this,arguments)}finally{T=De}}}})(AS);CS.exports=AS;var gN=CS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PS=G,Fr=gN;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bS=new Set,xc={};function Da(t,e){Ll(t,e),Ll(t+"Capture",e)}function Ll(t,e){for(xc[t]=e,t=0;t<e.length;t++)bS.add(e[t])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),r_=Object.prototype.hasOwnProperty,mN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wI={},II={};function pN(t){return r_.call(II,t)?!0:r_.call(wI,t)?!1:mN.test(t)?II[t]=!0:(wI[t]=!0,!1)}function _N(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vN(t,e,n,r){if(e===null||typeof e>"u"||_N(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gr(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Un[t]=new gr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Un[e]=new gr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Un[t]=new gr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Un[t]=new gr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Un[t]=new gr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Un[t]=new gr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Un[t]=new gr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Un[t]=new gr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Un[t]=new gr(t,5,!1,t.toLowerCase(),null,!1,!1)});var ly=/[\-:]([a-z])/g;function uy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ly,uy);Un[e]=new gr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ly,uy);Un[e]=new gr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ly,uy);Un[e]=new gr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Un[t]=new gr(t,1,!1,t.toLowerCase(),null,!1,!1)});Un.xlinkHref=new gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Un[t]=new gr(t,1,!1,t.toLowerCase(),null,!0,!0)});function cy(t,e,n,r){var i=Un.hasOwnProperty(e)?Un[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vN(e,n,i,r)&&(n=null),r||i===null?pN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ss=PS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ld=Symbol.for("react.element"),al=Symbol.for("react.portal"),ll=Symbol.for("react.fragment"),hy=Symbol.for("react.strict_mode"),i_=Symbol.for("react.profiler"),RS=Symbol.for("react.provider"),kS=Symbol.for("react.context"),dy=Symbol.for("react.forward_ref"),s_=Symbol.for("react.suspense"),o_=Symbol.for("react.suspense_list"),fy=Symbol.for("react.memo"),Vs=Symbol.for("react.lazy"),NS=Symbol.for("react.offscreen"),EI=Symbol.iterator;function Su(t){return t===null||typeof t!="object"?null:(t=EI&&t[EI]||t["@@iterator"],typeof t=="function"?t:null)}var Kt=Object.assign,Hm;function qu(t){if(Hm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Hm=e&&e[1]||""}return`
`+Hm+t}var qm=!1;function Gm(t,e){if(!t||qm)return"";qm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(g){var r=g}Reflect.construct(t,[],e)}else{try{e.call()}catch(g){r=g}t.call(e.prototype)}else{try{throw Error()}catch(g){r=g}t()}}catch(g){if(g&&r&&typeof g.stack=="string"){for(var i=g.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,u=s.length-1;1<=a&&0<=u&&i[a]!==s[u];)u--;for(;1<=a&&0<=u;a--,u--)if(i[a]!==s[u]){if(a!==1||u!==1)do if(a--,u--,0>u||i[a]!==s[u]){var h=`
`+i[a].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=a&&0<=u);break}}}finally{qm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qu(t):""}function yN(t){switch(t.tag){case 5:return qu(t.type);case 16:return qu("Lazy");case 13:return qu("Suspense");case 19:return qu("SuspenseList");case 0:case 2:case 15:return t=Gm(t.type,!1),t;case 11:return t=Gm(t.type.render,!1),t;case 1:return t=Gm(t.type,!0),t;default:return""}}function a_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ll:return"Fragment";case al:return"Portal";case i_:return"Profiler";case hy:return"StrictMode";case s_:return"Suspense";case o_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case kS:return(t.displayName||"Context")+".Consumer";case RS:return(t._context.displayName||"Context")+".Provider";case dy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fy:return e=t.displayName||null,e!==null?e:a_(t.type)||"Memo";case Vs:e=t._payload,t=t._init;try{return a_(t(e))}catch{}}return null}function wN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return a_(e);case 8:return e===hy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ao(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function DS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IN(t){var e=DS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ud(t){t._valueTracker||(t._valueTracker=IN(t))}function MS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=DS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function vf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function l_(t,e){var n=e.checked;return Kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function TI(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ao(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function OS(t,e){e=e.checked,e!=null&&cy(t,"checked",e,!1)}function u_(t,e){OS(t,e);var n=ao(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?c_(t,e.type,n):e.hasOwnProperty("defaultValue")&&c_(t,e.type,ao(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function SI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function c_(t,e,n){(e!=="number"||vf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Gu=Array.isArray;function El(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ao(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function h_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return Kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ye(92));if(Gu(n)){if(1<n.length)throw Error(ye(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ao(n)}}function LS(t,e){var n=ao(e.value),r=ao(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function CI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function VS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function d_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?VS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var cd,FS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(cd=cd||document.createElement("div"),cd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Cc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var sc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EN=["Webkit","ms","Moz","O"];Object.keys(sc).forEach(function(t){EN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sc[e]=sc[t]})});function BS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||sc.hasOwnProperty(t)&&sc[t]?(""+e).trim():e+"px"}function US(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=BS(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var TN=Kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function f_(t,e){if(e){if(TN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function g_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var m_=null;function gy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var p_=null,Tl=null,Sl=null;function AI(t){if(t=Sh(t)){if(typeof p_!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=xg(e),p_(t.stateNode,t.type,e))}}function jS(t){Tl?Sl?Sl.push(t):Sl=[t]:Tl=t}function zS(){if(Tl){var t=Tl,e=Sl;if(Sl=Tl=null,AI(t),e)for(t=0;t<e.length;t++)AI(e[t])}}function $S(t,e){return t(e)}function HS(){}var Wm=!1;function qS(t,e,n){if(Wm)return t(e,n);Wm=!0;try{return $S(t,e,n)}finally{Wm=!1,(Tl!==null||Sl!==null)&&(HS(),zS())}}function Ac(t,e){var n=t.stateNode;if(n===null)return null;var r=xg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ye(231,e,typeof n));return n}var __=!1;if(ps)try{var xu={};Object.defineProperty(xu,"passive",{get:function(){__=!0}}),window.addEventListener("test",xu,xu),window.removeEventListener("test",xu,xu)}catch{__=!1}function SN(t,e,n,r,i,s,a,u,h){var g=Array.prototype.slice.call(arguments,3);try{e.apply(n,g)}catch(_){this.onError(_)}}var oc=!1,yf=null,wf=!1,v_=null,xN={onError:function(t){oc=!0,yf=t}};function CN(t,e,n,r,i,s,a,u,h){oc=!1,yf=null,SN.apply(xN,arguments)}function AN(t,e,n,r,i,s,a,u,h){if(CN.apply(this,arguments),oc){if(oc){var g=yf;oc=!1,yf=null}else throw Error(ye(198));wf||(wf=!0,v_=g)}}function Ma(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function GS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function PI(t){if(Ma(t)!==t)throw Error(ye(188))}function PN(t){var e=t.alternate;if(!e){if(e=Ma(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return PI(i),t;if(s===r)return PI(i),e;s=s.sibling}throw Error(ye(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,u=i.child;u;){if(u===n){a=!0,n=i,r=s;break}if(u===r){a=!0,r=i,n=s;break}u=u.sibling}if(!a){for(u=s.child;u;){if(u===n){a=!0,n=s,r=i;break}if(u===r){a=!0,r=s,n=i;break}u=u.sibling}if(!a)throw Error(ye(189))}}if(n.alternate!==r)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?t:e}function WS(t){return t=PN(t),t!==null?KS(t):null}function KS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=KS(t);if(e!==null)return e;t=t.sibling}return null}var QS=Fr.unstable_scheduleCallback,bI=Fr.unstable_cancelCallback,bN=Fr.unstable_shouldYield,RN=Fr.unstable_requestPaint,ln=Fr.unstable_now,kN=Fr.unstable_getCurrentPriorityLevel,my=Fr.unstable_ImmediatePriority,YS=Fr.unstable_UserBlockingPriority,If=Fr.unstable_NormalPriority,NN=Fr.unstable_LowPriority,XS=Fr.unstable_IdlePriority,Ig=null,zi=null;function DN(t){if(zi&&typeof zi.onCommitFiberRoot=="function")try{zi.onCommitFiberRoot(Ig,t,void 0,(t.current.flags&128)===128)}catch{}}var pi=Math.clz32?Math.clz32:LN,MN=Math.log,ON=Math.LN2;function LN(t){return t>>>=0,t===0?32:31-(MN(t)/ON|0)|0}var hd=64,dd=4194304;function Wu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ef(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~i;u!==0?r=Wu(u):(s&=a,s!==0&&(r=Wu(s)))}else a=n&~i,a!==0?r=Wu(a):s!==0&&(r=Wu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-pi(e),i=1<<n,r|=t[n],e&=~i;return r}function VN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-pi(s),u=1<<a,h=i[a];h===-1?(!(u&n)||u&r)&&(i[a]=VN(u,e)):h<=e&&(t.expiredLanes|=u),s&=~u}}function y_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function JS(){var t=hd;return hd<<=1,!(hd&4194240)&&(hd=64),t}function Km(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Eh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pi(e),t[e]=n}function BN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-pi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function py(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-pi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Tt=0;function ZS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ex,_y,tx,nx,rx,w_=!1,fd=[],Ys=null,Xs=null,Js=null,Pc=new Map,bc=new Map,Bs=[],UN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function RI(t,e){switch(t){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":Pc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(e.pointerId)}}function Cu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Sh(e),e!==null&&_y(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function jN(t,e,n,r,i){switch(e){case"focusin":return Ys=Cu(Ys,t,e,n,r,i),!0;case"dragenter":return Xs=Cu(Xs,t,e,n,r,i),!0;case"mouseover":return Js=Cu(Js,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Pc.set(s,Cu(Pc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,bc.set(s,Cu(bc.get(s)||null,t,e,n,r,i)),!0}return!1}function ix(t){var e=Zo(t.target);if(e!==null){var n=Ma(e);if(n!==null){if(e=n.tag,e===13){if(e=GS(n),e!==null){t.blockedOn=e,rx(t.priority,function(){tx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $d(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=I_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);m_=r,n.target.dispatchEvent(r),m_=null}else return e=Sh(n),e!==null&&_y(e),t.blockedOn=n,!1;e.shift()}return!0}function kI(t,e,n){$d(t)&&n.delete(e)}function zN(){w_=!1,Ys!==null&&$d(Ys)&&(Ys=null),Xs!==null&&$d(Xs)&&(Xs=null),Js!==null&&$d(Js)&&(Js=null),Pc.forEach(kI),bc.forEach(kI)}function Au(t,e){t.blockedOn===e&&(t.blockedOn=null,w_||(w_=!0,Fr.unstable_scheduleCallback(Fr.unstable_NormalPriority,zN)))}function Rc(t){function e(i){return Au(i,t)}if(0<fd.length){Au(fd[0],t);for(var n=1;n<fd.length;n++){var r=fd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ys!==null&&Au(Ys,t),Xs!==null&&Au(Xs,t),Js!==null&&Au(Js,t),Pc.forEach(e),bc.forEach(e),n=0;n<Bs.length;n++)r=Bs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Bs.length&&(n=Bs[0],n.blockedOn===null);)ix(n),n.blockedOn===null&&Bs.shift()}var xl=Ss.ReactCurrentBatchConfig,Tf=!0;function $N(t,e,n,r){var i=Tt,s=xl.transition;xl.transition=null;try{Tt=1,vy(t,e,n,r)}finally{Tt=i,xl.transition=s}}function HN(t,e,n,r){var i=Tt,s=xl.transition;xl.transition=null;try{Tt=4,vy(t,e,n,r)}finally{Tt=i,xl.transition=s}}function vy(t,e,n,r){if(Tf){var i=I_(t,e,n,r);if(i===null)ip(t,e,r,Sf,n),RI(t,r);else if(jN(i,t,e,n,r))r.stopPropagation();else if(RI(t,r),e&4&&-1<UN.indexOf(t)){for(;i!==null;){var s=Sh(i);if(s!==null&&ex(s),s=I_(t,e,n,r),s===null&&ip(t,e,r,Sf,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ip(t,e,r,null,n)}}var Sf=null;function I_(t,e,n,r){if(Sf=null,t=gy(r),t=Zo(t),t!==null)if(e=Ma(t),e===null)t=null;else if(n=e.tag,n===13){if(t=GS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Sf=t,null}function sx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kN()){case my:return 1;case YS:return 4;case If:case NN:return 16;case XS:return 536870912;default:return 16}default:return 16}}var Hs=null,yy=null,Hd=null;function ox(){if(Hd)return Hd;var t,e=yy,n=e.length,r,i="value"in Hs?Hs.value:Hs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Hd=i.slice(t,1<r?1-r:void 0)}function qd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gd(){return!0}function NI(){return!1}function zr(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gd:NI,this.isPropagationStopped=NI,this}return Kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gd)},persist:function(){},isPersistent:gd}),e}var ou={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wy=zr(ou),Th=Kt({},ou,{view:0,detail:0}),qN=zr(Th),Qm,Ym,Pu,Eg=Kt({},Th,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Iy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pu&&(Pu&&t.type==="mousemove"?(Qm=t.screenX-Pu.screenX,Ym=t.screenY-Pu.screenY):Ym=Qm=0,Pu=t),Qm)},movementY:function(t){return"movementY"in t?t.movementY:Ym}}),DI=zr(Eg),GN=Kt({},Eg,{dataTransfer:0}),WN=zr(GN),KN=Kt({},Th,{relatedTarget:0}),Xm=zr(KN),QN=Kt({},ou,{animationName:0,elapsedTime:0,pseudoElement:0}),YN=zr(QN),XN=Kt({},ou,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),JN=zr(XN),ZN=Kt({},ou,{data:0}),MI=zr(ZN),eD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nD[t])?!!e[t]:!1}function Iy(){return rD}var iD=Kt({},Th,{key:function(t){if(t.key){var e=eD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Iy,charCode:function(t){return t.type==="keypress"?qd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sD=zr(iD),oD=Kt({},Eg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),OI=zr(oD),aD=Kt({},Th,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Iy}),lD=zr(aD),uD=Kt({},ou,{propertyName:0,elapsedTime:0,pseudoElement:0}),cD=zr(uD),hD=Kt({},Eg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dD=zr(hD),fD=[9,13,27,32],Ey=ps&&"CompositionEvent"in window,ac=null;ps&&"documentMode"in document&&(ac=document.documentMode);var gD=ps&&"TextEvent"in window&&!ac,ax=ps&&(!Ey||ac&&8<ac&&11>=ac),LI=" ",VI=!1;function lx(t,e){switch(t){case"keyup":return fD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ux(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ul=!1;function mD(t,e){switch(t){case"compositionend":return ux(e);case"keypress":return e.which!==32?null:(VI=!0,LI);case"textInput":return t=e.data,t===LI&&VI?null:t;default:return null}}function pD(t,e){if(ul)return t==="compositionend"||!Ey&&lx(t,e)?(t=ox(),Hd=yy=Hs=null,ul=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ax&&e.locale!=="ko"?null:e.data;default:return null}}var _D={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_D[t.type]:e==="textarea"}function cx(t,e,n,r){jS(r),e=xf(e,"onChange"),0<e.length&&(n=new wy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var lc=null,kc=null;function vD(t){Ix(t,0)}function Tg(t){var e=dl(t);if(MS(e))return t}function yD(t,e){if(t==="change")return e}var hx=!1;if(ps){var Jm;if(ps){var Zm="oninput"in document;if(!Zm){var BI=document.createElement("div");BI.setAttribute("oninput","return;"),Zm=typeof BI.oninput=="function"}Jm=Zm}else Jm=!1;hx=Jm&&(!document.documentMode||9<document.documentMode)}function UI(){lc&&(lc.detachEvent("onpropertychange",dx),kc=lc=null)}function dx(t){if(t.propertyName==="value"&&Tg(kc)){var e=[];cx(e,kc,t,gy(t)),qS(vD,e)}}function wD(t,e,n){t==="focusin"?(UI(),lc=e,kc=n,lc.attachEvent("onpropertychange",dx)):t==="focusout"&&UI()}function ID(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Tg(kc)}function ED(t,e){if(t==="click")return Tg(e)}function TD(t,e){if(t==="input"||t==="change")return Tg(e)}function SD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yi=typeof Object.is=="function"?Object.is:SD;function Nc(t,e){if(yi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!r_.call(e,i)||!yi(t[i],e[i]))return!1}return!0}function jI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zI(t,e){var n=jI(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jI(n)}}function fx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gx(){for(var t=window,e=vf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=vf(t.document)}return e}function Ty(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function xD(t){var e=gx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&fx(n.ownerDocument.documentElement,n)){if(r!==null&&Ty(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=zI(n,s);var a=zI(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var CD=ps&&"documentMode"in document&&11>=document.documentMode,cl=null,E_=null,uc=null,T_=!1;function $I(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;T_||cl==null||cl!==vf(r)||(r=cl,"selectionStart"in r&&Ty(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),uc&&Nc(uc,r)||(uc=r,r=xf(E_,"onSelect"),0<r.length&&(e=new wy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=cl)))}function md(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var hl={animationend:md("Animation","AnimationEnd"),animationiteration:md("Animation","AnimationIteration"),animationstart:md("Animation","AnimationStart"),transitionend:md("Transition","TransitionEnd")},ep={},mx={};ps&&(mx=document.createElement("div").style,"AnimationEvent"in window||(delete hl.animationend.animation,delete hl.animationiteration.animation,delete hl.animationstart.animation),"TransitionEvent"in window||delete hl.transitionend.transition);function Sg(t){if(ep[t])return ep[t];if(!hl[t])return t;var e=hl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in mx)return ep[t]=e[n];return t}var px=Sg("animationend"),_x=Sg("animationiteration"),vx=Sg("animationstart"),yx=Sg("transitionend"),wx=new Map,HI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function To(t,e){wx.set(t,e),Da(e,[t])}for(var tp=0;tp<HI.length;tp++){var np=HI[tp],AD=np.toLowerCase(),PD=np[0].toUpperCase()+np.slice(1);To(AD,"on"+PD)}To(px,"onAnimationEnd");To(_x,"onAnimationIteration");To(vx,"onAnimationStart");To("dblclick","onDoubleClick");To("focusin","onFocus");To("focusout","onBlur");To(yx,"onTransitionEnd");Ll("onMouseEnter",["mouseout","mouseover"]);Ll("onMouseLeave",["mouseout","mouseover"]);Ll("onPointerEnter",["pointerout","pointerover"]);Ll("onPointerLeave",["pointerout","pointerover"]);Da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Da("onBeforeInput",["compositionend","keypress","textInput","paste"]);Da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ku));function qI(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,AN(r,e,void 0,t),t.currentTarget=null}function Ix(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var u=r[a],h=u.instance,g=u.currentTarget;if(u=u.listener,h!==s&&i.isPropagationStopped())break e;qI(i,u,g),s=h}else for(a=0;a<r.length;a++){if(u=r[a],h=u.instance,g=u.currentTarget,u=u.listener,h!==s&&i.isPropagationStopped())break e;qI(i,u,g),s=h}}}if(wf)throw t=v_,wf=!1,v_=null,t}function Mt(t,e){var n=e[P_];n===void 0&&(n=e[P_]=new Set);var r=t+"__bubble";n.has(r)||(Ex(e,t,2,!1),n.add(r))}function rp(t,e,n){var r=0;e&&(r|=4),Ex(n,t,r,e)}var pd="_reactListening"+Math.random().toString(36).slice(2);function Dc(t){if(!t[pd]){t[pd]=!0,bS.forEach(function(n){n!=="selectionchange"&&(bD.has(n)||rp(n,!1,t),rp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[pd]||(e[pd]=!0,rp("selectionchange",!1,e))}}function Ex(t,e,n,r){switch(sx(e)){case 1:var i=$N;break;case 4:i=HN;break;default:i=vy}n=i.bind(null,e,n,t),i=void 0,!__||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ip(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;a=a.return}for(;u!==null;){if(a=Zo(u),a===null)return;if(h=a.tag,h===5||h===6){r=s=a;continue e}u=u.parentNode}}r=r.return}qS(function(){var g=s,_=gy(n),w=[];e:{var T=wx.get(t);if(T!==void 0){var E=wy,z=t;switch(t){case"keypress":if(qd(n)===0)break e;case"keydown":case"keyup":E=sD;break;case"focusin":z="focus",E=Xm;break;case"focusout":z="blur",E=Xm;break;case"beforeblur":case"afterblur":E=Xm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=DI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=WN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=lD;break;case px:case _x:case vx:E=YN;break;case yx:E=cD;break;case"scroll":E=qN;break;case"wheel":E=dD;break;case"copy":case"cut":case"paste":E=JN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=OI}var j=(e&4)!==0,J=!j&&t==="scroll",V=j?T!==null?T+"Capture":null:T;j=[];for(var B=g,U;B!==null;){U=B;var Z=U.stateNode;if(U.tag===5&&Z!==null&&(U=Z,V!==null&&(Z=Ac(B,V),Z!=null&&j.push(Mc(B,Z,U)))),J)break;B=B.return}0<j.length&&(T=new E(T,z,null,n,_),w.push({event:T,listeners:j}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",T&&n!==m_&&(z=n.relatedTarget||n.fromElement)&&(Zo(z)||z[_s]))break e;if((E||T)&&(T=_.window===_?_:(T=_.ownerDocument)?T.defaultView||T.parentWindow:window,E?(z=n.relatedTarget||n.toElement,E=g,z=z?Zo(z):null,z!==null&&(J=Ma(z),z!==J||z.tag!==5&&z.tag!==6)&&(z=null)):(E=null,z=g),E!==z)){if(j=DI,Z="onMouseLeave",V="onMouseEnter",B="mouse",(t==="pointerout"||t==="pointerover")&&(j=OI,Z="onPointerLeave",V="onPointerEnter",B="pointer"),J=E==null?T:dl(E),U=z==null?T:dl(z),T=new j(Z,B+"leave",E,n,_),T.target=J,T.relatedTarget=U,Z=null,Zo(_)===g&&(j=new j(V,B+"enter",z,n,_),j.target=U,j.relatedTarget=J,Z=j),J=Z,E&&z)t:{for(j=E,V=z,B=0,U=j;U;U=qa(U))B++;for(U=0,Z=V;Z;Z=qa(Z))U++;for(;0<B-U;)j=qa(j),B--;for(;0<U-B;)V=qa(V),U--;for(;B--;){if(j===V||V!==null&&j===V.alternate)break t;j=qa(j),V=qa(V)}j=null}else j=null;E!==null&&GI(w,T,E,j,!1),z!==null&&J!==null&&GI(w,J,z,j,!0)}}e:{if(T=g?dl(g):window,E=T.nodeName&&T.nodeName.toLowerCase(),E==="select"||E==="input"&&T.type==="file")var ne=yD;else if(FI(T))if(hx)ne=TD;else{ne=ID;var te=wD}else(E=T.nodeName)&&E.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(ne=ED);if(ne&&(ne=ne(t,g))){cx(w,ne,n,_);break e}te&&te(t,T,g),t==="focusout"&&(te=T._wrapperState)&&te.controlled&&T.type==="number"&&c_(T,"number",T.value)}switch(te=g?dl(g):window,t){case"focusin":(FI(te)||te.contentEditable==="true")&&(cl=te,E_=g,uc=null);break;case"focusout":uc=E_=cl=null;break;case"mousedown":T_=!0;break;case"contextmenu":case"mouseup":case"dragend":T_=!1,$I(w,n,_);break;case"selectionchange":if(CD)break;case"keydown":case"keyup":$I(w,n,_)}var ae;if(Ey)e:{switch(t){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else ul?lx(t,n)&&(ce="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ce="onCompositionStart");ce&&(ax&&n.locale!=="ko"&&(ul||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&ul&&(ae=ox()):(Hs=_,yy="value"in Hs?Hs.value:Hs.textContent,ul=!0)),te=xf(g,ce),0<te.length&&(ce=new MI(ce,t,null,n,_),w.push({event:ce,listeners:te}),ae?ce.data=ae:(ae=ux(n),ae!==null&&(ce.data=ae)))),(ae=gD?mD(t,n):pD(t,n))&&(g=xf(g,"onBeforeInput"),0<g.length&&(_=new MI("onBeforeInput","beforeinput",null,n,_),w.push({event:_,listeners:g}),_.data=ae))}Ix(w,e)})}function Mc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function xf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ac(t,n),s!=null&&r.unshift(Mc(t,s,i)),s=Ac(t,e),s!=null&&r.push(Mc(t,s,i))),t=t.return}return r}function qa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function GI(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var u=n,h=u.alternate,g=u.stateNode;if(h!==null&&h===r)break;u.tag===5&&g!==null&&(u=g,i?(h=Ac(n,s),h!=null&&a.unshift(Mc(n,h,u))):i||(h=Ac(n,s),h!=null&&a.push(Mc(n,h,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var RD=/\r\n?/g,kD=/\u0000|\uFFFD/g;function WI(t){return(typeof t=="string"?t:""+t).replace(RD,`
`).replace(kD,"")}function _d(t,e,n){if(e=WI(e),WI(t)!==e&&n)throw Error(ye(425))}function Cf(){}var S_=null,x_=null;function C_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var A_=typeof setTimeout=="function"?setTimeout:void 0,ND=typeof clearTimeout=="function"?clearTimeout:void 0,KI=typeof Promise=="function"?Promise:void 0,DD=typeof queueMicrotask=="function"?queueMicrotask:typeof KI<"u"?function(t){return KI.resolve(null).then(t).catch(MD)}:A_;function MD(t){setTimeout(function(){throw t})}function sp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Rc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Rc(e)}function Zs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function QI(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var au=Math.random().toString(36).slice(2),Ri="__reactFiber$"+au,Oc="__reactProps$"+au,_s="__reactContainer$"+au,P_="__reactEvents$"+au,OD="__reactListeners$"+au,LD="__reactHandles$"+au;function Zo(t){var e=t[Ri];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_s]||n[Ri]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=QI(t);t!==null;){if(n=t[Ri])return n;t=QI(t)}return e}t=n,n=t.parentNode}return null}function Sh(t){return t=t[Ri]||t[_s],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function dl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function xg(t){return t[Oc]||null}var b_=[],fl=-1;function So(t){return{current:t}}function Ft(t){0>fl||(t.current=b_[fl],b_[fl]=null,fl--)}function kt(t,e){fl++,b_[fl]=t.current,t.current=e}var lo={},Jn=So(lo),Cr=So(!1),ga=lo;function Vl(t,e){var n=t.type.contextTypes;if(!n)return lo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ar(t){return t=t.childContextTypes,t!=null}function Af(){Ft(Cr),Ft(Jn)}function YI(t,e,n){if(Jn.current!==lo)throw Error(ye(168));kt(Jn,e),kt(Cr,n)}function Tx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ye(108,wN(t)||"Unknown",i));return Kt({},n,r)}function Pf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||lo,ga=Jn.current,kt(Jn,t),kt(Cr,Cr.current),!0}function XI(t,e,n){var r=t.stateNode;if(!r)throw Error(ye(169));n?(t=Tx(t,e,ga),r.__reactInternalMemoizedMergedChildContext=t,Ft(Cr),Ft(Jn),kt(Jn,t)):Ft(Cr),kt(Cr,n)}var ss=null,Cg=!1,op=!1;function Sx(t){ss===null?ss=[t]:ss.push(t)}function VD(t){Cg=!0,Sx(t)}function xo(){if(!op&&ss!==null){op=!0;var t=0,e=Tt;try{var n=ss;for(Tt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ss=null,Cg=!1}catch(i){throw ss!==null&&(ss=ss.slice(t+1)),QS(my,xo),i}finally{Tt=e,op=!1}}return null}var gl=[],ml=0,bf=null,Rf=0,Kr=[],Qr=0,ma=null,ls=1,us="";function $o(t,e){gl[ml++]=Rf,gl[ml++]=bf,bf=t,Rf=e}function xx(t,e,n){Kr[Qr++]=ls,Kr[Qr++]=us,Kr[Qr++]=ma,ma=t;var r=ls;t=us;var i=32-pi(r)-1;r&=~(1<<i),n+=1;var s=32-pi(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,ls=1<<32-pi(e)+i|n<<i|r,us=s+t}else ls=1<<s|n<<i|r,us=t}function Sy(t){t.return!==null&&($o(t,1),xx(t,1,0))}function xy(t){for(;t===bf;)bf=gl[--ml],gl[ml]=null,Rf=gl[--ml],gl[ml]=null;for(;t===ma;)ma=Kr[--Qr],Kr[Qr]=null,us=Kr[--Qr],Kr[Qr]=null,ls=Kr[--Qr],Kr[Qr]=null}var Lr=null,Mr=null,jt=!1,di=null;function Cx(t,e){var n=Xr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function JI(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lr=t,Mr=Zs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lr=t,Mr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ma!==null?{id:ls,overflow:us}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Lr=t,Mr=null,!0):!1;default:return!1}}function R_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function k_(t){if(jt){var e=Mr;if(e){var n=e;if(!JI(t,e)){if(R_(t))throw Error(ye(418));e=Zs(n.nextSibling);var r=Lr;e&&JI(t,e)?Cx(r,n):(t.flags=t.flags&-4097|2,jt=!1,Lr=t)}}else{if(R_(t))throw Error(ye(418));t.flags=t.flags&-4097|2,jt=!1,Lr=t}}}function ZI(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lr=t}function vd(t){if(t!==Lr)return!1;if(!jt)return ZI(t),jt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!C_(t.type,t.memoizedProps)),e&&(e=Mr)){if(R_(t))throw Ax(),Error(ye(418));for(;e;)Cx(t,e),e=Zs(e.nextSibling)}if(ZI(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Mr=Zs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Mr=null}}else Mr=Lr?Zs(t.stateNode.nextSibling):null;return!0}function Ax(){for(var t=Mr;t;)t=Zs(t.nextSibling)}function Fl(){Mr=Lr=null,jt=!1}function Cy(t){di===null?di=[t]:di.push(t)}var FD=Ss.ReactCurrentBatchConfig;function ci(t,e){if(t&&t.defaultProps){e=Kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var kf=So(null),Nf=null,pl=null,Ay=null;function Py(){Ay=pl=Nf=null}function by(t){var e=kf.current;Ft(kf),t._currentValue=e}function N_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Cl(t,e){Nf=t,Ay=pl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ir=!0),t.firstContext=null)}function ei(t){var e=t._currentValue;if(Ay!==t)if(t={context:t,memoizedValue:e,next:null},pl===null){if(Nf===null)throw Error(ye(308));pl=t,Nf.dependencies={lanes:0,firstContext:t}}else pl=pl.next=t;return e}var ea=null;function Ry(t){ea===null?ea=[t]:ea.push(t)}function Px(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ry(e)):(n.next=i.next,i.next=n),e.interleaved=n,vs(t,r)}function vs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fs=!1;function ky(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function fs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function eo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,pt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,vs(t,n)}return i=r.interleaved,i===null?(e.next=e,Ry(r)):(e.next=i.next,i.next=e),r.interleaved=e,vs(t,n)}function Gd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,py(t,n)}}function eE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Df(t,e,n,r){var i=t.updateQueue;Fs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var h=u,g=h.next;h.next=null,a===null?s=g:a.next=g,a=h;var _=t.alternate;_!==null&&(_=_.updateQueue,u=_.lastBaseUpdate,u!==a&&(u===null?_.firstBaseUpdate=g:u.next=g,_.lastBaseUpdate=h))}if(s!==null){var w=i.baseState;a=0,_=g=h=null,u=s;do{var T=u.lane,E=u.eventTime;if((r&T)===T){_!==null&&(_=_.next={eventTime:E,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var z=t,j=u;switch(T=e,E=n,j.tag){case 1:if(z=j.payload,typeof z=="function"){w=z.call(E,w,T);break e}w=z;break e;case 3:z.flags=z.flags&-65537|128;case 0:if(z=j.payload,T=typeof z=="function"?z.call(E,w,T):z,T==null)break e;w=Kt({},w,T);break e;case 2:Fs=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,T=i.effects,T===null?i.effects=[u]:T.push(u))}else E={eventTime:E,lane:T,tag:u.tag,payload:u.payload,callback:u.callback,next:null},_===null?(g=_=E,h=w):_=_.next=E,a|=T;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;T=u,u=T.next,T.next=null,i.lastBaseUpdate=T,i.shared.pending=null}}while(!0);if(_===null&&(h=w),i.baseState=h,i.firstBaseUpdate=g,i.lastBaseUpdate=_,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);_a|=a,t.lanes=a,t.memoizedState=w}}function tE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ye(191,i));i.call(r)}}}var Rx=new PS.Component().refs;function D_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ag={isMounted:function(t){return(t=t._reactInternals)?Ma(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=lr(),i=no(t),s=fs(r,i);s.payload=e,n!=null&&(s.callback=n),e=eo(t,s,i),e!==null&&(_i(e,t,i,r),Gd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=lr(),i=no(t),s=fs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=eo(t,s,i),e!==null&&(_i(e,t,i,r),Gd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=lr(),r=no(t),i=fs(n,r);i.tag=2,e!=null&&(i.callback=e),e=eo(t,i,r),e!==null&&(_i(e,t,r,n),Gd(e,t,r))}};function nE(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Nc(n,r)||!Nc(i,s):!0}function kx(t,e,n){var r=!1,i=lo,s=e.contextType;return typeof s=="object"&&s!==null?s=ei(s):(i=Ar(e)?ga:Jn.current,r=e.contextTypes,s=(r=r!=null)?Vl(t,i):lo),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ag,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function rE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ag.enqueueReplaceState(e,e.state,null)}function M_(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=Rx,ky(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ei(s):(s=Ar(e)?ga:Jn.current,i.context=Vl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(D_(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ag.enqueueReplaceState(i,i.state,null),Df(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var r=n.stateNode}if(!r)throw Error(ye(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var u=i.refs;u===Rx&&(u=i.refs={}),a===null?delete u[s]:u[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,t))}return t}function yd(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function iE(t){var e=t._init;return e(t._payload)}function Nx(t){function e(V,B){if(t){var U=V.deletions;U===null?(V.deletions=[B],V.flags|=16):U.push(B)}}function n(V,B){if(!t)return null;for(;B!==null;)e(V,B),B=B.sibling;return null}function r(V,B){for(V=new Map;B!==null;)B.key!==null?V.set(B.key,B):V.set(B.index,B),B=B.sibling;return V}function i(V,B){return V=ro(V,B),V.index=0,V.sibling=null,V}function s(V,B,U){return V.index=U,t?(U=V.alternate,U!==null?(U=U.index,U<B?(V.flags|=2,B):U):(V.flags|=2,B)):(V.flags|=1048576,B)}function a(V){return t&&V.alternate===null&&(V.flags|=2),V}function u(V,B,U,Z){return B===null||B.tag!==6?(B=fp(U,V.mode,Z),B.return=V,B):(B=i(B,U),B.return=V,B)}function h(V,B,U,Z){var ne=U.type;return ne===ll?_(V,B,U.props.children,Z,U.key):B!==null&&(B.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===Vs&&iE(ne)===B.type)?(Z=i(B,U.props),Z.ref=bu(V,B,U),Z.return=V,Z):(Z=Jd(U.type,U.key,U.props,null,V.mode,Z),Z.ref=bu(V,B,U),Z.return=V,Z)}function g(V,B,U,Z){return B===null||B.tag!==4||B.stateNode.containerInfo!==U.containerInfo||B.stateNode.implementation!==U.implementation?(B=gp(U,V.mode,Z),B.return=V,B):(B=i(B,U.children||[]),B.return=V,B)}function _(V,B,U,Z,ne){return B===null||B.tag!==7?(B=ua(U,V.mode,Z,ne),B.return=V,B):(B=i(B,U),B.return=V,B)}function w(V,B,U){if(typeof B=="string"&&B!==""||typeof B=="number")return B=fp(""+B,V.mode,U),B.return=V,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case ld:return U=Jd(B.type,B.key,B.props,null,V.mode,U),U.ref=bu(V,null,B),U.return=V,U;case al:return B=gp(B,V.mode,U),B.return=V,B;case Vs:var Z=B._init;return w(V,Z(B._payload),U)}if(Gu(B)||Su(B))return B=ua(B,V.mode,U,null),B.return=V,B;yd(V,B)}return null}function T(V,B,U,Z){var ne=B!==null?B.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return ne!==null?null:u(V,B,""+U,Z);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case ld:return U.key===ne?h(V,B,U,Z):null;case al:return U.key===ne?g(V,B,U,Z):null;case Vs:return ne=U._init,T(V,B,ne(U._payload),Z)}if(Gu(U)||Su(U))return ne!==null?null:_(V,B,U,Z,null);yd(V,U)}return null}function E(V,B,U,Z,ne){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return V=V.get(U)||null,u(B,V,""+Z,ne);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case ld:return V=V.get(Z.key===null?U:Z.key)||null,h(B,V,Z,ne);case al:return V=V.get(Z.key===null?U:Z.key)||null,g(B,V,Z,ne);case Vs:var te=Z._init;return E(V,B,U,te(Z._payload),ne)}if(Gu(Z)||Su(Z))return V=V.get(U)||null,_(B,V,Z,ne,null);yd(B,Z)}return null}function z(V,B,U,Z){for(var ne=null,te=null,ae=B,ce=B=0,_e=null;ae!==null&&ce<U.length;ce++){ae.index>ce?(_e=ae,ae=null):_e=ae.sibling;var me=T(V,ae,U[ce],Z);if(me===null){ae===null&&(ae=_e);break}t&&ae&&me.alternate===null&&e(V,ae),B=s(me,B,ce),te===null?ne=me:te.sibling=me,te=me,ae=_e}if(ce===U.length)return n(V,ae),jt&&$o(V,ce),ne;if(ae===null){for(;ce<U.length;ce++)ae=w(V,U[ce],Z),ae!==null&&(B=s(ae,B,ce),te===null?ne=ae:te.sibling=ae,te=ae);return jt&&$o(V,ce),ne}for(ae=r(V,ae);ce<U.length;ce++)_e=E(ae,V,ce,U[ce],Z),_e!==null&&(t&&_e.alternate!==null&&ae.delete(_e.key===null?ce:_e.key),B=s(_e,B,ce),te===null?ne=_e:te.sibling=_e,te=_e);return t&&ae.forEach(function(Ze){return e(V,Ze)}),jt&&$o(V,ce),ne}function j(V,B,U,Z){var ne=Su(U);if(typeof ne!="function")throw Error(ye(150));if(U=ne.call(U),U==null)throw Error(ye(151));for(var te=ne=null,ae=B,ce=B=0,_e=null,me=U.next();ae!==null&&!me.done;ce++,me=U.next()){ae.index>ce?(_e=ae,ae=null):_e=ae.sibling;var Ze=T(V,ae,me.value,Z);if(Ze===null){ae===null&&(ae=_e);break}t&&ae&&Ze.alternate===null&&e(V,ae),B=s(Ze,B,ce),te===null?ne=Ze:te.sibling=Ze,te=Ze,ae=_e}if(me.done)return n(V,ae),jt&&$o(V,ce),ne;if(ae===null){for(;!me.done;ce++,me=U.next())me=w(V,me.value,Z),me!==null&&(B=s(me,B,ce),te===null?ne=me:te.sibling=me,te=me);return jt&&$o(V,ce),ne}for(ae=r(V,ae);!me.done;ce++,me=U.next())me=E(ae,V,ce,me.value,Z),me!==null&&(t&&me.alternate!==null&&ae.delete(me.key===null?ce:me.key),B=s(me,B,ce),te===null?ne=me:te.sibling=me,te=me);return t&&ae.forEach(function(Oe){return e(V,Oe)}),jt&&$o(V,ce),ne}function J(V,B,U,Z){if(typeof U=="object"&&U!==null&&U.type===ll&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case ld:e:{for(var ne=U.key,te=B;te!==null;){if(te.key===ne){if(ne=U.type,ne===ll){if(te.tag===7){n(V,te.sibling),B=i(te,U.props.children),B.return=V,V=B;break e}}else if(te.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===Vs&&iE(ne)===te.type){n(V,te.sibling),B=i(te,U.props),B.ref=bu(V,te,U),B.return=V,V=B;break e}n(V,te);break}else e(V,te);te=te.sibling}U.type===ll?(B=ua(U.props.children,V.mode,Z,U.key),B.return=V,V=B):(Z=Jd(U.type,U.key,U.props,null,V.mode,Z),Z.ref=bu(V,B,U),Z.return=V,V=Z)}return a(V);case al:e:{for(te=U.key;B!==null;){if(B.key===te)if(B.tag===4&&B.stateNode.containerInfo===U.containerInfo&&B.stateNode.implementation===U.implementation){n(V,B.sibling),B=i(B,U.children||[]),B.return=V,V=B;break e}else{n(V,B);break}else e(V,B);B=B.sibling}B=gp(U,V.mode,Z),B.return=V,V=B}return a(V);case Vs:return te=U._init,J(V,B,te(U._payload),Z)}if(Gu(U))return z(V,B,U,Z);if(Su(U))return j(V,B,U,Z);yd(V,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,B!==null&&B.tag===6?(n(V,B.sibling),B=i(B,U),B.return=V,V=B):(n(V,B),B=fp(U,V.mode,Z),B.return=V,V=B),a(V)):n(V,B)}return J}var Bl=Nx(!0),Dx=Nx(!1),xh={},$i=So(xh),Lc=So(xh),Vc=So(xh);function ta(t){if(t===xh)throw Error(ye(174));return t}function Ny(t,e){switch(kt(Vc,e),kt(Lc,t),kt($i,xh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:d_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=d_(e,t)}Ft($i),kt($i,e)}function Ul(){Ft($i),Ft(Lc),Ft(Vc)}function Mx(t){ta(Vc.current);var e=ta($i.current),n=d_(e,t.type);e!==n&&(kt(Lc,t),kt($i,n))}function Dy(t){Lc.current===t&&(Ft($i),Ft(Lc))}var qt=So(0);function Mf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ap=[];function My(){for(var t=0;t<ap.length;t++)ap[t]._workInProgressVersionPrimary=null;ap.length=0}var Wd=Ss.ReactCurrentDispatcher,lp=Ss.ReactCurrentBatchConfig,pa=0,Gt=null,mn=null,Tn=null,Of=!1,cc=!1,Fc=0,BD=0;function Gn(){throw Error(ye(321))}function Oy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!yi(t[n],e[n]))return!1;return!0}function Ly(t,e,n,r,i,s){if(pa=s,Gt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wd.current=t===null||t.memoizedState===null?$D:HD,t=n(r,i),cc){s=0;do{if(cc=!1,Fc=0,25<=s)throw Error(ye(301));s+=1,Tn=mn=null,e.updateQueue=null,Wd.current=qD,t=n(r,i)}while(cc)}if(Wd.current=Lf,e=mn!==null&&mn.next!==null,pa=0,Tn=mn=Gt=null,Of=!1,e)throw Error(ye(300));return t}function Vy(){var t=Fc!==0;return Fc=0,t}function Ci(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Gt.memoizedState=Tn=t:Tn=Tn.next=t,Tn}function ti(){if(mn===null){var t=Gt.alternate;t=t!==null?t.memoizedState:null}else t=mn.next;var e=Tn===null?Gt.memoizedState:Tn.next;if(e!==null)Tn=e,mn=t;else{if(t===null)throw Error(ye(310));mn=t,t={memoizedState:mn.memoizedState,baseState:mn.baseState,baseQueue:mn.baseQueue,queue:mn.queue,next:null},Tn===null?Gt.memoizedState=Tn=t:Tn=Tn.next=t}return Tn}function Bc(t,e){return typeof e=="function"?e(t):e}function up(t){var e=ti(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=mn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=a=null,h=null,g=s;do{var _=g.lane;if((pa&_)===_)h!==null&&(h=h.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),r=g.hasEagerState?g.eagerState:t(r,g.action);else{var w={lane:_,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};h===null?(u=h=w,a=r):h=h.next=w,Gt.lanes|=_,_a|=_}g=g.next}while(g!==null&&g!==s);h===null?a=r:h.next=u,yi(r,e.memoizedState)||(Ir=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=h,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Gt.lanes|=s,_a|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cp(t){var e=ti(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);yi(s,e.memoizedState)||(Ir=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Ox(){}function Lx(t,e){var n=Gt,r=ti(),i=e(),s=!yi(r.memoizedState,i);if(s&&(r.memoizedState=i,Ir=!0),r=r.queue,Fy(Bx.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Tn!==null&&Tn.memoizedState.tag&1){if(n.flags|=2048,Uc(9,Fx.bind(null,n,r,i,e),void 0,null),xn===null)throw Error(ye(349));pa&30||Vx(n,e,i)}return i}function Vx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Gt.updateQueue,e===null?(e={lastEffect:null,stores:null},Gt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Fx(t,e,n,r){e.value=n,e.getSnapshot=r,Ux(e)&&jx(t)}function Bx(t,e,n){return n(function(){Ux(e)&&jx(t)})}function Ux(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!yi(t,n)}catch{return!0}}function jx(t){var e=vs(t,1);e!==null&&_i(e,t,1,-1)}function sE(t){var e=Ci();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:t},e.queue=t,t=t.dispatch=zD.bind(null,Gt,t),[e.memoizedState,t]}function Uc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Gt.updateQueue,e===null?(e={lastEffect:null,stores:null},Gt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zx(){return ti().memoizedState}function Kd(t,e,n,r){var i=Ci();Gt.flags|=t,i.memoizedState=Uc(1|e,n,void 0,r===void 0?null:r)}function Pg(t,e,n,r){var i=ti();r=r===void 0?null:r;var s=void 0;if(mn!==null){var a=mn.memoizedState;if(s=a.destroy,r!==null&&Oy(r,a.deps)){i.memoizedState=Uc(e,n,s,r);return}}Gt.flags|=t,i.memoizedState=Uc(1|e,n,s,r)}function oE(t,e){return Kd(8390656,8,t,e)}function Fy(t,e){return Pg(2048,8,t,e)}function $x(t,e){return Pg(4,2,t,e)}function Hx(t,e){return Pg(4,4,t,e)}function qx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Gx(t,e,n){return n=n!=null?n.concat([t]):null,Pg(4,4,qx.bind(null,e,t),n)}function By(){}function Wx(t,e){var n=ti();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Oy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Kx(t,e){var n=ti();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Oy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Qx(t,e,n){return pa&21?(yi(n,e)||(n=JS(),Gt.lanes|=n,_a|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ir=!0),t.memoizedState=n)}function UD(t,e){var n=Tt;Tt=n!==0&&4>n?n:4,t(!0);var r=lp.transition;lp.transition={};try{t(!1),e()}finally{Tt=n,lp.transition=r}}function Yx(){return ti().memoizedState}function jD(t,e,n){var r=no(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xx(t))Jx(e,n);else if(n=Px(t,e,n,r),n!==null){var i=lr();_i(n,t,r,i),Zx(n,e,r)}}function zD(t,e,n){var r=no(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xx(t))Jx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,u=s(a,n);if(i.hasEagerState=!0,i.eagerState=u,yi(u,a)){var h=e.interleaved;h===null?(i.next=i,Ry(e)):(i.next=h.next,h.next=i),e.interleaved=i;return}}catch{}finally{}n=Px(t,e,i,r),n!==null&&(i=lr(),_i(n,t,r,i),Zx(n,e,r))}}function Xx(t){var e=t.alternate;return t===Gt||e!==null&&e===Gt}function Jx(t,e){cc=Of=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Zx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,py(t,n)}}var Lf={readContext:ei,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},$D={readContext:ei,useCallback:function(t,e){return Ci().memoizedState=[t,e===void 0?null:e],t},useContext:ei,useEffect:oE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Kd(4194308,4,qx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Kd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Kd(4,2,t,e)},useMemo:function(t,e){var n=Ci();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ci();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=jD.bind(null,Gt,t),[r.memoizedState,t]},useRef:function(t){var e=Ci();return t={current:t},e.memoizedState=t},useState:sE,useDebugValue:By,useDeferredValue:function(t){return Ci().memoizedState=t},useTransition:function(){var t=sE(!1),e=t[0];return t=UD.bind(null,t[1]),Ci().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Gt,i=Ci();if(jt){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=e(),xn===null)throw Error(ye(349));pa&30||Vx(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,oE(Bx.bind(null,r,s,t),[t]),r.flags|=2048,Uc(9,Fx.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ci(),e=xn.identifierPrefix;if(jt){var n=us,r=ls;n=(r&~(1<<32-pi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=BD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HD={readContext:ei,useCallback:Wx,useContext:ei,useEffect:Fy,useImperativeHandle:Gx,useInsertionEffect:$x,useLayoutEffect:Hx,useMemo:Kx,useReducer:up,useRef:zx,useState:function(){return up(Bc)},useDebugValue:By,useDeferredValue:function(t){var e=ti();return Qx(e,mn.memoizedState,t)},useTransition:function(){var t=up(Bc)[0],e=ti().memoizedState;return[t,e]},useMutableSource:Ox,useSyncExternalStore:Lx,useId:Yx,unstable_isNewReconciler:!1},qD={readContext:ei,useCallback:Wx,useContext:ei,useEffect:Fy,useImperativeHandle:Gx,useInsertionEffect:$x,useLayoutEffect:Hx,useMemo:Kx,useReducer:cp,useRef:zx,useState:function(){return cp(Bc)},useDebugValue:By,useDeferredValue:function(t){var e=ti();return mn===null?e.memoizedState=t:Qx(e,mn.memoizedState,t)},useTransition:function(){var t=cp(Bc)[0],e=ti().memoizedState;return[t,e]},useMutableSource:Ox,useSyncExternalStore:Lx,useId:Yx,unstable_isNewReconciler:!1};function jl(t,e){try{var n="",r=e;do n+=yN(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function hp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function O_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var GD=typeof WeakMap=="function"?WeakMap:Map;function eC(t,e,n){n=fs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ff||(Ff=!0,q_=r),O_(t,e)},n}function tC(t,e,n){n=fs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){O_(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){O_(t,e),typeof r!="function"&&(to===null?to=new Set([this]):to.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function aE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new GD;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=oM.bind(null,t,e,n),e.then(t,t))}function lE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function uE(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=fs(-1,1),e.tag=2,eo(n,e,1))),n.lanes|=1),t)}var WD=Ss.ReactCurrentOwner,Ir=!1;function nr(t,e,n,r){e.child=t===null?Dx(e,null,n,r):Bl(e,t.child,n,r)}function cE(t,e,n,r,i){n=n.render;var s=e.ref;return Cl(e,i),r=Ly(t,e,n,r,s,i),n=Vy(),t!==null&&!Ir?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ys(t,e,i)):(jt&&n&&Sy(e),e.flags|=1,nr(t,e,r,i),e.child)}function hE(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Wy(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,nC(t,e,s,r,i)):(t=Jd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Nc,n(a,r)&&t.ref===e.ref)return ys(t,e,i)}return e.flags|=1,t=ro(s,r),t.ref=e.ref,t.return=e,e.child=t}function nC(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Nc(s,r)&&t.ref===e.ref)if(Ir=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ir=!0);else return e.lanes=t.lanes,ys(t,e,i)}return L_(t,e,n,r,i)}function rC(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},kt(vl,Rr),Rr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,kt(vl,Rr),Rr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,kt(vl,Rr),Rr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,kt(vl,Rr),Rr|=r;return nr(t,e,i,n),e.child}function iC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function L_(t,e,n,r,i){var s=Ar(n)?ga:Jn.current;return s=Vl(e,s),Cl(e,i),n=Ly(t,e,n,r,s,i),r=Vy(),t!==null&&!Ir?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ys(t,e,i)):(jt&&r&&Sy(e),e.flags|=1,nr(t,e,n,i),e.child)}function dE(t,e,n,r,i){if(Ar(n)){var s=!0;Pf(e)}else s=!1;if(Cl(e,i),e.stateNode===null)Qd(t,e),kx(e,n,r),M_(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var h=a.context,g=n.contextType;typeof g=="object"&&g!==null?g=ei(g):(g=Ar(n)?ga:Jn.current,g=Vl(e,g));var _=n.getDerivedStateFromProps,w=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||h!==g)&&rE(e,a,r,g),Fs=!1;var T=e.memoizedState;a.state=T,Df(e,r,a,i),h=e.memoizedState,u!==r||T!==h||Cr.current||Fs?(typeof _=="function"&&(D_(e,n,_,r),h=e.memoizedState),(u=Fs||nE(e,n,u,r,T,h,g))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=g,r=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,bx(t,e),u=e.memoizedProps,g=e.type===e.elementType?u:ci(e.type,u),a.props=g,w=e.pendingProps,T=a.context,h=n.contextType,typeof h=="object"&&h!==null?h=ei(h):(h=Ar(n)?ga:Jn.current,h=Vl(e,h));var E=n.getDerivedStateFromProps;(_=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==w||T!==h)&&rE(e,a,r,h),Fs=!1,T=e.memoizedState,a.state=T,Df(e,r,a,i);var z=e.memoizedState;u!==w||T!==z||Cr.current||Fs?(typeof E=="function"&&(D_(e,n,E,r),z=e.memoizedState),(g=Fs||nE(e,n,g,r,T,z,h)||!1)?(_||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,z,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,z,h)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=z),a.props=r,a.state=z,a.context=h,r=g):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),r=!1)}return V_(t,e,n,r,s,i)}function V_(t,e,n,r,i,s){iC(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&XI(e,n,!1),ys(t,e,s);r=e.stateNode,WD.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Bl(e,t.child,null,s),e.child=Bl(e,null,u,s)):nr(t,e,u,s),e.memoizedState=r.state,i&&XI(e,n,!0),e.child}function sC(t){var e=t.stateNode;e.pendingContext?YI(t,e.pendingContext,e.pendingContext!==e.context):e.context&&YI(t,e.context,!1),Ny(t,e.containerInfo)}function fE(t,e,n,r,i){return Fl(),Cy(i),e.flags|=256,nr(t,e,n,r),e.child}var F_={dehydrated:null,treeContext:null,retryLane:0};function B_(t){return{baseLanes:t,cachePool:null,transitions:null}}function oC(t,e,n){var r=e.pendingProps,i=qt.current,s=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),kt(qt,i&1),t===null)return k_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=kg(a,r,0,null),t=ua(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=B_(n),e.memoizedState=F_,t):Uy(e,a));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return KD(t,e,a,r,u,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,u=i.sibling;var h={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=ro(i,h),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=ro(u,s):(s=ua(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?B_(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=F_,r}return s=t.child,t=s.sibling,r=ro(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Uy(t,e){return e=kg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wd(t,e,n,r){return r!==null&&Cy(r),Bl(e,t.child,null,n),t=Uy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KD(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=hp(Error(ye(422))),wd(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=kg({mode:"visible",children:r.children},i,0,null),s=ua(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Bl(e,t.child,null,a),e.child.memoizedState=B_(a),e.memoizedState=F_,s);if(!(e.mode&1))return wd(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(ye(419)),r=hp(s,r,void 0),wd(t,e,a,r)}if(u=(a&t.childLanes)!==0,Ir||u){if(r=xn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,vs(t,i),_i(r,t,i,-1))}return Gy(),r=hp(Error(ye(421))),wd(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=aM.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Mr=Zs(i.nextSibling),Lr=e,jt=!0,di=null,t!==null&&(Kr[Qr++]=ls,Kr[Qr++]=us,Kr[Qr++]=ma,ls=t.id,us=t.overflow,ma=e),e=Uy(e,r.children),e.flags|=4096,e)}function gE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),N_(t.return,e,n)}function dp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function aC(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(nr(t,e,r.children,n),r=qt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gE(t,n,e);else if(t.tag===19)gE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(kt(qt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Mf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),dp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Mf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}dp(e,!0,n,null,s);break;case"together":dp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ys(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),_a|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,n=ro(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ro(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function QD(t,e,n){switch(e.tag){case 3:sC(e),Fl();break;case 5:Mx(e);break;case 1:Ar(e.type)&&Pf(e);break;case 4:Ny(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;kt(kf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(kt(qt,qt.current&1),e.flags|=128,null):n&e.child.childLanes?oC(t,e,n):(kt(qt,qt.current&1),t=ys(t,e,n),t!==null?t.sibling:null);kt(qt,qt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return aC(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),kt(qt,qt.current),r)break;return null;case 22:case 23:return e.lanes=0,rC(t,e,n)}return ys(t,e,n)}var lC,U_,uC,cC;lC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};U_=function(){};uC=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ta($i.current);var s=null;switch(n){case"input":i=l_(t,i),r=l_(t,r),s=[];break;case"select":i=Kt({},i,{value:void 0}),r=Kt({},r,{value:void 0}),s=[];break;case"textarea":i=h_(t,i),r=h_(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Cf)}f_(n,r);var a;n=null;for(g in i)if(!r.hasOwnProperty(g)&&i.hasOwnProperty(g)&&i[g]!=null)if(g==="style"){var u=i[g];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(xc.hasOwnProperty(g)?s||(s=[]):(s=s||[]).push(g,null));for(g in r){var h=r[g];if(u=i!=null?i[g]:void 0,r.hasOwnProperty(g)&&h!==u&&(h!=null||u!=null))if(g==="style")if(u){for(a in u)!u.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in h)h.hasOwnProperty(a)&&u[a]!==h[a]&&(n||(n={}),n[a]=h[a])}else n||(s||(s=[]),s.push(g,n)),n=h;else g==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,u=u?u.__html:void 0,h!=null&&u!==h&&(s=s||[]).push(g,h)):g==="children"?typeof h!="string"&&typeof h!="number"||(s=s||[]).push(g,""+h):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(xc.hasOwnProperty(g)?(h!=null&&g==="onScroll"&&Mt("scroll",t),s||u===h||(s=[])):(s=s||[]).push(g,h))}n&&(s=s||[]).push("style",n);var g=s;(e.updateQueue=g)&&(e.flags|=4)}};cC=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ru(t,e){if(!jt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Wn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YD(t,e,n){var r=e.pendingProps;switch(xy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(e),null;case 1:return Ar(e.type)&&Af(),Wn(e),null;case 3:return r=e.stateNode,Ul(),Ft(Cr),Ft(Jn),My(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,di!==null&&(K_(di),di=null))),U_(t,e),Wn(e),null;case 5:Dy(e);var i=ta(Vc.current);if(n=e.type,t!==null&&e.stateNode!=null)uC(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ye(166));return Wn(e),null}if(t=ta($i.current),vd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ri]=e,r[Oc]=s,t=(e.mode&1)!==0,n){case"dialog":Mt("cancel",r),Mt("close",r);break;case"iframe":case"object":case"embed":Mt("load",r);break;case"video":case"audio":for(i=0;i<Ku.length;i++)Mt(Ku[i],r);break;case"source":Mt("error",r);break;case"img":case"image":case"link":Mt("error",r),Mt("load",r);break;case"details":Mt("toggle",r);break;case"input":TI(r,s),Mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Mt("invalid",r);break;case"textarea":xI(r,s),Mt("invalid",r)}f_(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var u=s[a];a==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&_d(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&_d(r.textContent,u,t),i=["children",""+u]):xc.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&Mt("scroll",r)}switch(n){case"input":ud(r),SI(r,s,!0);break;case"textarea":ud(r),CI(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Cf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=VS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Ri]=e,t[Oc]=r,lC(t,e,!1,!1),e.stateNode=t;e:{switch(a=g_(n,r),n){case"dialog":Mt("cancel",t),Mt("close",t),i=r;break;case"iframe":case"object":case"embed":Mt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ku.length;i++)Mt(Ku[i],t);i=r;break;case"source":Mt("error",t),i=r;break;case"img":case"image":case"link":Mt("error",t),Mt("load",t),i=r;break;case"details":Mt("toggle",t),i=r;break;case"input":TI(t,r),i=l_(t,r),Mt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Kt({},r,{value:void 0}),Mt("invalid",t);break;case"textarea":xI(t,r),i=h_(t,r),Mt("invalid",t);break;default:i=r}f_(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var h=u[s];s==="style"?US(t,h):s==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&FS(t,h)):s==="children"?typeof h=="string"?(n!=="textarea"||h!=="")&&Cc(t,h):typeof h=="number"&&Cc(t,""+h):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xc.hasOwnProperty(s)?h!=null&&s==="onScroll"&&Mt("scroll",t):h!=null&&cy(t,s,h,a))}switch(n){case"input":ud(t),SI(t,r,!1);break;case"textarea":ud(t),CI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ao(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?El(t,!!r.multiple,s,!1):r.defaultValue!=null&&El(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Cf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wn(e),null;case 6:if(t&&e.stateNode!=null)cC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ye(166));if(n=ta(Vc.current),ta($i.current),vd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ri]=e,(s=r.nodeValue!==n)&&(t=Lr,t!==null))switch(t.tag){case 3:_d(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_d(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ri]=e,e.stateNode=r}return Wn(e),null;case 13:if(Ft(qt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(jt&&Mr!==null&&e.mode&1&&!(e.flags&128))Ax(),Fl(),e.flags|=98560,s=!1;else if(s=vd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ye(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ye(317));s[Ri]=e}else Fl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wn(e),s=!1}else di!==null&&(K_(di),di=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||qt.current&1?pn===0&&(pn=3):Gy())),e.updateQueue!==null&&(e.flags|=4),Wn(e),null);case 4:return Ul(),U_(t,e),t===null&&Dc(e.stateNode.containerInfo),Wn(e),null;case 10:return by(e.type._context),Wn(e),null;case 17:return Ar(e.type)&&Af(),Wn(e),null;case 19:if(Ft(qt),s=e.memoizedState,s===null)return Wn(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Ru(s,!1);else{if(pn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Mf(t),a!==null){for(e.flags|=128,Ru(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return kt(qt,qt.current&1|2),e.child}t=t.sibling}s.tail!==null&&ln()>zl&&(e.flags|=128,r=!0,Ru(s,!1),e.lanes=4194304)}else{if(!r)if(t=Mf(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ru(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!jt)return Wn(e),null}else 2*ln()-s.renderingStartTime>zl&&n!==1073741824&&(e.flags|=128,r=!0,Ru(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ln(),e.sibling=null,n=qt.current,kt(qt,r?n&1|2:n&1),e):(Wn(e),null);case 22:case 23:return qy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rr&1073741824&&(Wn(e),e.subtreeFlags&6&&(e.flags|=8192)):Wn(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function XD(t,e){switch(xy(e),e.tag){case 1:return Ar(e.type)&&Af(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ul(),Ft(Cr),Ft(Jn),My(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dy(e),null;case 13:if(Ft(qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));Fl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ft(qt),null;case 4:return Ul(),null;case 10:return by(e.type._context),null;case 22:case 23:return qy(),null;case 24:return null;default:return null}}var Id=!1,Qn=!1,JD=typeof WeakSet=="function"?WeakSet:Set,Le=null;function _l(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xt(t,e,r)}else n.current=null}function j_(t,e,n){try{n()}catch(r){Xt(t,e,r)}}var mE=!1;function ZD(t,e){if(S_=Tf,t=gx(),Ty(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,u=-1,h=-1,g=0,_=0,w=t,T=null;t:for(;;){for(var E;w!==n||i!==0&&w.nodeType!==3||(u=a+i),w!==s||r!==0&&w.nodeType!==3||(h=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(E=w.firstChild)!==null;)T=w,w=E;for(;;){if(w===t)break t;if(T===n&&++g===i&&(u=a),T===s&&++_===r&&(h=a),(E=w.nextSibling)!==null)break;w=T,T=w.parentNode}w=E}n=u===-1||h===-1?null:{start:u,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(x_={focusedElem:t,selectionRange:n},Tf=!1,Le=e;Le!==null;)if(e=Le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Le=t;else for(;Le!==null;){e=Le;try{var z=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(z!==null){var j=z.memoizedProps,J=z.memoizedState,V=e.stateNode,B=V.getSnapshotBeforeUpdate(e.elementType===e.type?j:ci(e.type,j),J);V.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var U=e.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(Z){Xt(e,e.return,Z)}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}return z=mE,mE=!1,z}function hc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&j_(e,n,s)}i=i.next}while(i!==r)}}function bg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function z_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hC(t){var e=t.alternate;e!==null&&(t.alternate=null,hC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ri],delete e[Oc],delete e[P_],delete e[OD],delete e[LD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dC(t){return t.tag===5||t.tag===3||t.tag===4}function pE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Cf));else if(r!==4&&(t=t.child,t!==null))for($_(t,e,n),t=t.sibling;t!==null;)$_(t,e,n),t=t.sibling}function H_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(H_(t,e,n),t=t.sibling;t!==null;)H_(t,e,n),t=t.sibling}var Dn=null,hi=!1;function Ns(t,e,n){for(n=n.child;n!==null;)fC(t,e,n),n=n.sibling}function fC(t,e,n){if(zi&&typeof zi.onCommitFiberUnmount=="function")try{zi.onCommitFiberUnmount(Ig,n)}catch{}switch(n.tag){case 5:Qn||_l(n,e);case 6:var r=Dn,i=hi;Dn=null,Ns(t,e,n),Dn=r,hi=i,Dn!==null&&(hi?(t=Dn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dn.removeChild(n.stateNode));break;case 18:Dn!==null&&(hi?(t=Dn,n=n.stateNode,t.nodeType===8?sp(t.parentNode,n):t.nodeType===1&&sp(t,n),Rc(t)):sp(Dn,n.stateNode));break;case 4:r=Dn,i=hi,Dn=n.stateNode.containerInfo,hi=!0,Ns(t,e,n),Dn=r,hi=i;break;case 0:case 11:case 14:case 15:if(!Qn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&j_(n,e,a),i=i.next}while(i!==r)}Ns(t,e,n);break;case 1:if(!Qn&&(_l(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Xt(n,e,u)}Ns(t,e,n);break;case 21:Ns(t,e,n);break;case 22:n.mode&1?(Qn=(r=Qn)||n.memoizedState!==null,Ns(t,e,n),Qn=r):Ns(t,e,n);break;default:Ns(t,e,n)}}function _E(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new JD),e.forEach(function(r){var i=lM.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ui(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:Dn=u.stateNode,hi=!1;break e;case 3:Dn=u.stateNode.containerInfo,hi=!0;break e;case 4:Dn=u.stateNode.containerInfo,hi=!0;break e}u=u.return}if(Dn===null)throw Error(ye(160));fC(s,a,i),Dn=null,hi=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(g){Xt(i,e,g)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gC(e,t),e=e.sibling}function gC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ui(e,t),xi(t),r&4){try{hc(3,t,t.return),bg(3,t)}catch(j){Xt(t,t.return,j)}try{hc(5,t,t.return)}catch(j){Xt(t,t.return,j)}}break;case 1:ui(e,t),xi(t),r&512&&n!==null&&_l(n,n.return);break;case 5:if(ui(e,t),xi(t),r&512&&n!==null&&_l(n,n.return),t.flags&32){var i=t.stateNode;try{Cc(i,"")}catch(j){Xt(t,t.return,j)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,u=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&OS(i,s),g_(u,a);var g=g_(u,s);for(a=0;a<h.length;a+=2){var _=h[a],w=h[a+1];_==="style"?US(i,w):_==="dangerouslySetInnerHTML"?FS(i,w):_==="children"?Cc(i,w):cy(i,_,w,g)}switch(u){case"input":u_(i,s);break;case"textarea":LS(i,s);break;case"select":var T=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?El(i,!!s.multiple,E,!1):T!==!!s.multiple&&(s.defaultValue!=null?El(i,!!s.multiple,s.defaultValue,!0):El(i,!!s.multiple,s.multiple?[]:"",!1))}i[Oc]=s}catch(j){Xt(t,t.return,j)}}break;case 6:if(ui(e,t),xi(t),r&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(j){Xt(t,t.return,j)}}break;case 3:if(ui(e,t),xi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rc(e.containerInfo)}catch(j){Xt(t,t.return,j)}break;case 4:ui(e,t),xi(t);break;case 13:ui(e,t),xi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||($y=ln())),r&4&&_E(t);break;case 22:if(_=n!==null&&n.memoizedState!==null,t.mode&1?(Qn=(g=Qn)||_,ui(e,t),Qn=g):ui(e,t),xi(t),r&8192){if(g=t.memoizedState!==null,(t.stateNode.isHidden=g)&&!_&&t.mode&1)for(Le=t,_=t.child;_!==null;){for(w=Le=_;Le!==null;){switch(T=Le,E=T.child,T.tag){case 0:case 11:case 14:case 15:hc(4,T,T.return);break;case 1:_l(T,T.return);var z=T.stateNode;if(typeof z.componentWillUnmount=="function"){r=T,n=T.return;try{e=r,z.props=e.memoizedProps,z.state=e.memoizedState,z.componentWillUnmount()}catch(j){Xt(r,n,j)}}break;case 5:_l(T,T.return);break;case 22:if(T.memoizedState!==null){yE(w);continue}}E!==null?(E.return=T,Le=E):yE(w)}_=_.sibling}e:for(_=null,w=t;;){if(w.tag===5){if(_===null){_=w;try{i=w.stateNode,g?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=w.stateNode,h=w.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,u.style.display=BS("display",a))}catch(j){Xt(t,t.return,j)}}}else if(w.tag===6){if(_===null)try{w.stateNode.nodeValue=g?"":w.memoizedProps}catch(j){Xt(t,t.return,j)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;_===w&&(_=null),w=w.return}_===w&&(_=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:ui(e,t),xi(t),r&4&&_E(t);break;case 21:break;default:ui(e,t),xi(t)}}function xi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(dC(n)){var r=n;break e}n=n.return}throw Error(ye(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Cc(i,""),r.flags&=-33);var s=pE(t);H_(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,u=pE(t);$_(t,u,a);break;default:throw Error(ye(161))}}catch(h){Xt(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eM(t,e,n){Le=t,mC(t)}function mC(t,e,n){for(var r=(t.mode&1)!==0;Le!==null;){var i=Le,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Id;if(!a){var u=i.alternate,h=u!==null&&u.memoizedState!==null||Qn;u=Id;var g=Qn;if(Id=a,(Qn=h)&&!g)for(Le=i;Le!==null;)a=Le,h=a.child,a.tag===22&&a.memoizedState!==null?wE(i):h!==null?(h.return=a,Le=h):wE(i);for(;s!==null;)Le=s,mC(s),s=s.sibling;Le=i,Id=u,Qn=g}vE(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Le=s):vE(t)}}function vE(t){for(;Le!==null;){var e=Le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qn||bg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ci(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&tE(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}tE(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var g=e.alternate;if(g!==null){var _=g.memoizedState;if(_!==null){var w=_.dehydrated;w!==null&&Rc(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Qn||e.flags&512&&z_(e)}catch(T){Xt(e,e.return,T)}}if(e===t){Le=null;break}if(n=e.sibling,n!==null){n.return=e.return,Le=n;break}Le=e.return}}function yE(t){for(;Le!==null;){var e=Le;if(e===t){Le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Le=n;break}Le=e.return}}function wE(t){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bg(4,e)}catch(h){Xt(e,n,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(h){Xt(e,i,h)}}var s=e.return;try{z_(e)}catch(h){Xt(e,s,h)}break;case 5:var a=e.return;try{z_(e)}catch(h){Xt(e,a,h)}}}catch(h){Xt(e,e.return,h)}if(e===t){Le=null;break}var u=e.sibling;if(u!==null){u.return=e.return,Le=u;break}Le=e.return}}var tM=Math.ceil,Vf=Ss.ReactCurrentDispatcher,jy=Ss.ReactCurrentOwner,Zr=Ss.ReactCurrentBatchConfig,pt=0,xn=null,gn=null,Vn=0,Rr=0,vl=So(0),pn=0,jc=null,_a=0,Rg=0,zy=0,dc=null,wr=null,$y=0,zl=1/0,rs=null,Ff=!1,q_=null,to=null,Ed=!1,qs=null,Bf=0,fc=0,G_=null,Yd=-1,Xd=0;function lr(){return pt&6?ln():Yd!==-1?Yd:Yd=ln()}function no(t){return t.mode&1?pt&2&&Vn!==0?Vn&-Vn:FD.transition!==null?(Xd===0&&(Xd=JS()),Xd):(t=Tt,t!==0||(t=window.event,t=t===void 0?16:sx(t.type)),t):1}function _i(t,e,n,r){if(50<fc)throw fc=0,G_=null,Error(ye(185));Eh(t,n,r),(!(pt&2)||t!==xn)&&(t===xn&&(!(pt&2)&&(Rg|=n),pn===4&&Us(t,Vn)),Pr(t,r),n===1&&pt===0&&!(e.mode&1)&&(zl=ln()+500,Cg&&xo()))}function Pr(t,e){var n=t.callbackNode;FN(t,e);var r=Ef(t,t===xn?Vn:0);if(r===0)n!==null&&bI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&bI(n),e===1)t.tag===0?VD(IE.bind(null,t)):Sx(IE.bind(null,t)),DD(function(){!(pt&6)&&xo()}),n=null;else{switch(ZS(r)){case 1:n=my;break;case 4:n=YS;break;case 16:n=If;break;case 536870912:n=XS;break;default:n=If}n=TC(n,pC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function pC(t,e){if(Yd=-1,Xd=0,pt&6)throw Error(ye(327));var n=t.callbackNode;if(Al()&&t.callbackNode!==n)return null;var r=Ef(t,t===xn?Vn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Uf(t,r);else{e=r;var i=pt;pt|=2;var s=vC();(xn!==t||Vn!==e)&&(rs=null,zl=ln()+500,la(t,e));do try{iM();break}catch(u){_C(t,u)}while(!0);Py(),Vf.current=s,pt=i,gn!==null?e=0:(xn=null,Vn=0,e=pn)}if(e!==0){if(e===2&&(i=y_(t),i!==0&&(r=i,e=W_(t,i))),e===1)throw n=jc,la(t,0),Us(t,r),Pr(t,ln()),n;if(e===6)Us(t,r);else{if(i=t.current.alternate,!(r&30)&&!nM(i)&&(e=Uf(t,r),e===2&&(s=y_(t),s!==0&&(r=s,e=W_(t,s))),e===1))throw n=jc,la(t,0),Us(t,r),Pr(t,ln()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ye(345));case 2:Ho(t,wr,rs);break;case 3:if(Us(t,r),(r&130023424)===r&&(e=$y+500-ln(),10<e)){if(Ef(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){lr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=A_(Ho.bind(null,t,wr,rs),e);break}Ho(t,wr,rs);break;case 4:if(Us(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-pi(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=ln()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*tM(r/1960))-r,10<r){t.timeoutHandle=A_(Ho.bind(null,t,wr,rs),r);break}Ho(t,wr,rs);break;case 5:Ho(t,wr,rs);break;default:throw Error(ye(329))}}}return Pr(t,ln()),t.callbackNode===n?pC.bind(null,t):null}function W_(t,e){var n=dc;return t.current.memoizedState.isDehydrated&&(la(t,e).flags|=256),t=Uf(t,e),t!==2&&(e=wr,wr=n,e!==null&&K_(e)),t}function K_(t){wr===null?wr=t:wr.push.apply(wr,t)}function nM(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!yi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Us(t,e){for(e&=~zy,e&=~Rg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pi(e),r=1<<n;t[n]=-1,e&=~r}}function IE(t){if(pt&6)throw Error(ye(327));Al();var e=Ef(t,0);if(!(e&1))return Pr(t,ln()),null;var n=Uf(t,e);if(t.tag!==0&&n===2){var r=y_(t);r!==0&&(e=r,n=W_(t,r))}if(n===1)throw n=jc,la(t,0),Us(t,e),Pr(t,ln()),n;if(n===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ho(t,wr,rs),Pr(t,ln()),null}function Hy(t,e){var n=pt;pt|=1;try{return t(e)}finally{pt=n,pt===0&&(zl=ln()+500,Cg&&xo())}}function va(t){qs!==null&&qs.tag===0&&!(pt&6)&&Al();var e=pt;pt|=1;var n=Zr.transition,r=Tt;try{if(Zr.transition=null,Tt=1,t)return t()}finally{Tt=r,Zr.transition=n,pt=e,!(pt&6)&&xo()}}function qy(){Rr=vl.current,Ft(vl)}function la(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ND(n)),gn!==null)for(n=gn.return;n!==null;){var r=n;switch(xy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Af();break;case 3:Ul(),Ft(Cr),Ft(Jn),My();break;case 5:Dy(r);break;case 4:Ul();break;case 13:Ft(qt);break;case 19:Ft(qt);break;case 10:by(r.type._context);break;case 22:case 23:qy()}n=n.return}if(xn=t,gn=t=ro(t.current,null),Vn=Rr=e,pn=0,jc=null,zy=Rg=_a=0,wr=dc=null,ea!==null){for(e=0;e<ea.length;e++)if(n=ea[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ea=null}return t}function _C(t,e){do{var n=gn;try{if(Py(),Wd.current=Lf,Of){for(var r=Gt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Of=!1}if(pa=0,Tn=mn=Gt=null,cc=!1,Fc=0,jy.current=null,n===null||n.return===null){pn=1,jc=e,gn=null;break}e:{var s=t,a=n.return,u=n,h=e;if(e=Vn,u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var g=h,_=u,w=_.tag;if(!(_.mode&1)&&(w===0||w===11||w===15)){var T=_.alternate;T?(_.updateQueue=T.updateQueue,_.memoizedState=T.memoizedState,_.lanes=T.lanes):(_.updateQueue=null,_.memoizedState=null)}var E=lE(a);if(E!==null){E.flags&=-257,uE(E,a,u,s,e),E.mode&1&&aE(s,g,e),e=E,h=g;var z=e.updateQueue;if(z===null){var j=new Set;j.add(h),e.updateQueue=j}else z.add(h);break e}else{if(!(e&1)){aE(s,g,e),Gy();break e}h=Error(ye(426))}}else if(jt&&u.mode&1){var J=lE(a);if(J!==null){!(J.flags&65536)&&(J.flags|=256),uE(J,a,u,s,e),Cy(jl(h,u));break e}}s=h=jl(h,u),pn!==4&&(pn=2),dc===null?dc=[s]:dc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var V=eC(s,h,e);eE(s,V);break e;case 1:u=h;var B=s.type,U=s.stateNode;if(!(s.flags&128)&&(typeof B.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(to===null||!to.has(U)))){s.flags|=65536,e&=-e,s.lanes|=e;var Z=tC(s,u,e);eE(s,Z);break e}}s=s.return}while(s!==null)}wC(n)}catch(ne){e=ne,gn===n&&n!==null&&(gn=n=n.return);continue}break}while(!0)}function vC(){var t=Vf.current;return Vf.current=Lf,t===null?Lf:t}function Gy(){(pn===0||pn===3||pn===2)&&(pn=4),xn===null||!(_a&268435455)&&!(Rg&268435455)||Us(xn,Vn)}function Uf(t,e){var n=pt;pt|=2;var r=vC();(xn!==t||Vn!==e)&&(rs=null,la(t,e));do try{rM();break}catch(i){_C(t,i)}while(!0);if(Py(),pt=n,Vf.current=r,gn!==null)throw Error(ye(261));return xn=null,Vn=0,pn}function rM(){for(;gn!==null;)yC(gn)}function iM(){for(;gn!==null&&!bN();)yC(gn)}function yC(t){var e=EC(t.alternate,t,Rr);t.memoizedProps=t.pendingProps,e===null?wC(t):gn=e,jy.current=null}function wC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=XD(n,e),n!==null){n.flags&=32767,gn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{pn=6,gn=null;return}}else if(n=YD(n,e,Rr),n!==null){gn=n;return}if(e=e.sibling,e!==null){gn=e;return}gn=e=t}while(e!==null);pn===0&&(pn=5)}function Ho(t,e,n){var r=Tt,i=Zr.transition;try{Zr.transition=null,Tt=1,sM(t,e,n,r)}finally{Zr.transition=i,Tt=r}return null}function sM(t,e,n,r){do Al();while(qs!==null);if(pt&6)throw Error(ye(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(BN(t,s),t===xn&&(gn=xn=null,Vn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ed||(Ed=!0,TC(If,function(){return Al(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Zr.transition,Zr.transition=null;var a=Tt;Tt=1;var u=pt;pt|=4,jy.current=null,ZD(t,n),gC(n,t),xD(x_),Tf=!!S_,x_=S_=null,t.current=n,eM(n),RN(),pt=u,Tt=a,Zr.transition=s}else t.current=n;if(Ed&&(Ed=!1,qs=t,Bf=i),s=t.pendingLanes,s===0&&(to=null),DN(n.stateNode),Pr(t,ln()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ff)throw Ff=!1,t=q_,q_=null,t;return Bf&1&&t.tag!==0&&Al(),s=t.pendingLanes,s&1?t===G_?fc++:(fc=0,G_=t):fc=0,xo(),null}function Al(){if(qs!==null){var t=ZS(Bf),e=Zr.transition,n=Tt;try{if(Zr.transition=null,Tt=16>t?16:t,qs===null)var r=!1;else{if(t=qs,qs=null,Bf=0,pt&6)throw Error(ye(331));var i=pt;for(pt|=4,Le=t.current;Le!==null;){var s=Le,a=s.child;if(Le.flags&16){var u=s.deletions;if(u!==null){for(var h=0;h<u.length;h++){var g=u[h];for(Le=g;Le!==null;){var _=Le;switch(_.tag){case 0:case 11:case 15:hc(8,_,s)}var w=_.child;if(w!==null)w.return=_,Le=w;else for(;Le!==null;){_=Le;var T=_.sibling,E=_.return;if(hC(_),_===g){Le=null;break}if(T!==null){T.return=E,Le=T;break}Le=E}}}var z=s.alternate;if(z!==null){var j=z.child;if(j!==null){z.child=null;do{var J=j.sibling;j.sibling=null,j=J}while(j!==null)}}Le=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Le=a;else e:for(;Le!==null;){if(s=Le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hc(9,s,s.return)}var V=s.sibling;if(V!==null){V.return=s.return,Le=V;break e}Le=s.return}}var B=t.current;for(Le=B;Le!==null;){a=Le;var U=a.child;if(a.subtreeFlags&2064&&U!==null)U.return=a,Le=U;else e:for(a=B;Le!==null;){if(u=Le,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:bg(9,u)}}catch(ne){Xt(u,u.return,ne)}if(u===a){Le=null;break e}var Z=u.sibling;if(Z!==null){Z.return=u.return,Le=Z;break e}Le=u.return}}if(pt=i,xo(),zi&&typeof zi.onPostCommitFiberRoot=="function")try{zi.onPostCommitFiberRoot(Ig,t)}catch{}r=!0}return r}finally{Tt=n,Zr.transition=e}}return!1}function EE(t,e,n){e=jl(n,e),e=eC(t,e,1),t=eo(t,e,1),e=lr(),t!==null&&(Eh(t,1,e),Pr(t,e))}function Xt(t,e,n){if(t.tag===3)EE(t,t,n);else for(;e!==null;){if(e.tag===3){EE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(to===null||!to.has(r))){t=jl(n,t),t=tC(e,t,1),e=eo(e,t,1),t=lr(),e!==null&&(Eh(e,1,t),Pr(e,t));break}}e=e.return}}function oM(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=lr(),t.pingedLanes|=t.suspendedLanes&n,xn===t&&(Vn&n)===n&&(pn===4||pn===3&&(Vn&130023424)===Vn&&500>ln()-$y?la(t,0):zy|=n),Pr(t,e)}function IC(t,e){e===0&&(t.mode&1?(e=dd,dd<<=1,!(dd&130023424)&&(dd=4194304)):e=1);var n=lr();t=vs(t,e),t!==null&&(Eh(t,e,n),Pr(t,n))}function aM(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),IC(t,n)}function lM(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ye(314))}r!==null&&r.delete(e),IC(t,n)}var EC;EC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Cr.current)Ir=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ir=!1,QD(t,e,n);Ir=!!(t.flags&131072)}else Ir=!1,jt&&e.flags&1048576&&xx(e,Rf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Qd(t,e),t=e.pendingProps;var i=Vl(e,Jn.current);Cl(e,n),i=Ly(null,e,r,t,i,n);var s=Vy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ar(r)?(s=!0,Pf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ky(e),i.updater=Ag,e.stateNode=i,i._reactInternals=e,M_(e,r,t,n),e=V_(null,e,r,!0,s,n)):(e.tag=0,jt&&s&&Sy(e),nr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Qd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=cM(r),t=ci(r,t),i){case 0:e=L_(null,e,r,t,n);break e;case 1:e=dE(null,e,r,t,n);break e;case 11:e=cE(null,e,r,t,n);break e;case 14:e=hE(null,e,r,ci(r.type,t),n);break e}throw Error(ye(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ci(r,i),L_(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ci(r,i),dE(t,e,r,i,n);case 3:e:{if(sC(e),t===null)throw Error(ye(387));r=e.pendingProps,s=e.memoizedState,i=s.element,bx(t,e),Df(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=jl(Error(ye(423)),e),e=fE(t,e,r,n,i);break e}else if(r!==i){i=jl(Error(ye(424)),e),e=fE(t,e,r,n,i);break e}else for(Mr=Zs(e.stateNode.containerInfo.firstChild),Lr=e,jt=!0,di=null,n=Dx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fl(),r===i){e=ys(t,e,n);break e}nr(t,e,r,n)}e=e.child}return e;case 5:return Mx(e),t===null&&k_(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,C_(r,i)?a=null:s!==null&&C_(r,s)&&(e.flags|=32),iC(t,e),nr(t,e,a,n),e.child;case 6:return t===null&&k_(e),null;case 13:return oC(t,e,n);case 4:return Ny(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Bl(e,null,r,n):nr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ci(r,i),cE(t,e,r,i,n);case 7:return nr(t,e,e.pendingProps,n),e.child;case 8:return nr(t,e,e.pendingProps.children,n),e.child;case 12:return nr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,kt(kf,r._currentValue),r._currentValue=a,s!==null)if(yi(s.value,a)){if(s.children===i.children&&!Cr.current){e=ys(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){a=s.child;for(var h=u.firstContext;h!==null;){if(h.context===r){if(s.tag===1){h=fs(-1,n&-n),h.tag=2;var g=s.updateQueue;if(g!==null){g=g.shared;var _=g.pending;_===null?h.next=h:(h.next=_.next,_.next=h),g.pending=h}}s.lanes|=n,h=s.alternate,h!==null&&(h.lanes|=n),N_(s.return,n,e),u.lanes|=n;break}h=h.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ye(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),N_(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}nr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Cl(e,n),i=ei(i),r=r(i),e.flags|=1,nr(t,e,r,n),e.child;case 14:return r=e.type,i=ci(r,e.pendingProps),i=ci(r.type,i),hE(t,e,r,i,n);case 15:return nC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ci(r,i),Qd(t,e),e.tag=1,Ar(r)?(t=!0,Pf(e)):t=!1,Cl(e,n),kx(e,r,i),M_(e,r,i,n),V_(null,e,r,!0,t,n);case 19:return aC(t,e,n);case 22:return rC(t,e,n)}throw Error(ye(156,e.tag))};function TC(t,e){return QS(t,e)}function uM(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xr(t,e,n,r){return new uM(t,e,n,r)}function Wy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cM(t){if(typeof t=="function")return Wy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dy)return 11;if(t===fy)return 14}return 2}function ro(t,e){var n=t.alternate;return n===null?(n=Xr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Jd(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")Wy(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ll:return ua(n.children,i,s,e);case hy:a=8,i|=8;break;case i_:return t=Xr(12,n,e,i|2),t.elementType=i_,t.lanes=s,t;case s_:return t=Xr(13,n,e,i),t.elementType=s_,t.lanes=s,t;case o_:return t=Xr(19,n,e,i),t.elementType=o_,t.lanes=s,t;case NS:return kg(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case RS:a=10;break e;case kS:a=9;break e;case dy:a=11;break e;case fy:a=14;break e;case Vs:a=16,r=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=Xr(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ua(t,e,n,r){return t=Xr(7,t,r,e),t.lanes=n,t}function kg(t,e,n,r){return t=Xr(22,t,r,e),t.elementType=NS,t.lanes=n,t.stateNode={isHidden:!1},t}function fp(t,e,n){return t=Xr(6,t,null,e),t.lanes=n,t}function gp(t,e,n){return e=Xr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hM(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Km(0),this.expirationTimes=Km(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Km(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ky(t,e,n,r,i,s,a,u,h){return t=new hM(t,e,n,u,h),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Xr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ky(s),t}function dM(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:al,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function SC(t){if(!t)return lo;t=t._reactInternals;e:{if(Ma(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ar(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var n=t.type;if(Ar(n))return Tx(t,n,e)}return e}function xC(t,e,n,r,i,s,a,u,h){return t=Ky(n,r,!0,t,i,s,a,u,h),t.context=SC(null),n=t.current,r=lr(),i=no(n),s=fs(r,i),s.callback=e??null,eo(n,s,i),t.current.lanes=i,Eh(t,i,r),Pr(t,r),t}function Ng(t,e,n,r){var i=e.current,s=lr(),a=no(i);return n=SC(n),e.context===null?e.context=n:e.pendingContext=n,e=fs(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=eo(i,e,a),t!==null&&(_i(t,i,a,s),Gd(t,i,a)),a}function jf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function TE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qy(t,e){TE(t,e),(t=t.alternate)&&TE(t,e)}function fM(){return null}var CC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yy(t){this._internalRoot=t}Dg.prototype.render=Yy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));Ng(t,e,null,null)};Dg.prototype.unmount=Yy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;va(function(){Ng(null,t,null,null)}),e[_s]=null}};function Dg(t){this._internalRoot=t}Dg.prototype.unstable_scheduleHydration=function(t){if(t){var e=nx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Bs.length&&e!==0&&e<Bs[n].priority;n++);Bs.splice(n,0,t),n===0&&ix(t)}};function Xy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Mg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function SE(){}function gM(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var g=jf(a);s.call(g)}}var a=xC(e,r,t,0,null,!1,!1,"",SE);return t._reactRootContainer=a,t[_s]=a.current,Dc(t.nodeType===8?t.parentNode:t),va(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var g=jf(h);u.call(g)}}var h=Ky(t,0,!1,null,null,!1,!1,"",SE);return t._reactRootContainer=h,t[_s]=h.current,Dc(t.nodeType===8?t.parentNode:t),va(function(){Ng(e,h,n,r)}),h}function Og(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var u=i;i=function(){var h=jf(a);u.call(h)}}Ng(e,a,t,i)}else a=gM(n,e,t,i,r);return jf(a)}ex=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Wu(e.pendingLanes);n!==0&&(py(e,n|1),Pr(e,ln()),!(pt&6)&&(zl=ln()+500,xo()))}break;case 13:va(function(){var r=vs(t,1);if(r!==null){var i=lr();_i(r,t,1,i)}}),Qy(t,1)}};_y=function(t){if(t.tag===13){var e=vs(t,134217728);if(e!==null){var n=lr();_i(e,t,134217728,n)}Qy(t,134217728)}};tx=function(t){if(t.tag===13){var e=no(t),n=vs(t,e);if(n!==null){var r=lr();_i(n,t,e,r)}Qy(t,e)}};nx=function(){return Tt};rx=function(t,e){var n=Tt;try{return Tt=t,e()}finally{Tt=n}};p_=function(t,e,n){switch(e){case"input":if(u_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=xg(r);if(!i)throw Error(ye(90));MS(r),u_(r,i)}}}break;case"textarea":LS(t,n);break;case"select":e=n.value,e!=null&&El(t,!!n.multiple,e,!1)}};$S=Hy;HS=va;var mM={usingClientEntryPoint:!1,Events:[Sh,dl,xg,jS,zS,Hy]},ku={findFiberByHostInstance:Zo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},pM={bundleType:ku.bundleType,version:ku.version,rendererPackageName:ku.rendererPackageName,rendererConfig:ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=WS(t),t===null?null:t.stateNode},findFiberByHostInstance:ku.findFiberByHostInstance||fM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Td.isDisabled&&Td.supportsFiber)try{Ig=Td.inject(pM),zi=Td}catch{}}jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mM;jr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xy(e))throw Error(ye(200));return dM(t,e,null,n)};jr.createRoot=function(t,e){if(!Xy(t))throw Error(ye(299));var n=!1,r="",i=CC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Ky(t,1,!1,null,null,n,!1,r,i),t[_s]=e.current,Dc(t.nodeType===8?t.parentNode:t),new Yy(e)};jr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=WS(e),t=t===null?null:t.stateNode,t};jr.flushSync=function(t){return va(t)};jr.hydrate=function(t,e,n){if(!Mg(e))throw Error(ye(200));return Og(null,t,e,!0,n)};jr.hydrateRoot=function(t,e,n){if(!Xy(t))throw Error(ye(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=CC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=xC(e,null,t,1,n??null,i,!1,s,a),t[_s]=e.current,Dc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Dg(e)};jr.render=function(t,e,n){if(!Mg(e))throw Error(ye(200));return Og(null,t,e,!1,n)};jr.unmountComponentAtNode=function(t){if(!Mg(t))throw Error(ye(40));return t._reactRootContainer?(va(function(){Og(null,null,t,!1,function(){t._reactRootContainer=null,t[_s]=null})}),!0):!1};jr.unstable_batchedUpdates=Hy;jr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Mg(n))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return Og(t,e,n,!1,r)};jr.version="18.2.0-next-9e3b772b8-20220608";function AC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(AC)}catch(t){console.error(t)}}AC(),xS.exports=jr;var Jy=xS.exports,xE=Jy;n_.createRoot=xE.createRoot,n_.hydrateRoot=xE.hydrateRoot;var Q_=function(t,e){return Q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Q_(t,e)};function ri(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Q_(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ve=function(){return Ve=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ve.apply(this,arguments)};function ws(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function bi(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var PC={exports:{}},xt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pn=typeof Symbol=="function"&&Symbol.for,Zy=Pn?Symbol.for("react.element"):60103,e0=Pn?Symbol.for("react.portal"):60106,Lg=Pn?Symbol.for("react.fragment"):60107,Vg=Pn?Symbol.for("react.strict_mode"):60108,Fg=Pn?Symbol.for("react.profiler"):60114,Bg=Pn?Symbol.for("react.provider"):60109,Ug=Pn?Symbol.for("react.context"):60110,t0=Pn?Symbol.for("react.async_mode"):60111,jg=Pn?Symbol.for("react.concurrent_mode"):60111,zg=Pn?Symbol.for("react.forward_ref"):60112,$g=Pn?Symbol.for("react.suspense"):60113,_M=Pn?Symbol.for("react.suspense_list"):60120,Hg=Pn?Symbol.for("react.memo"):60115,qg=Pn?Symbol.for("react.lazy"):60116,vM=Pn?Symbol.for("react.block"):60121,yM=Pn?Symbol.for("react.fundamental"):60117,wM=Pn?Symbol.for("react.responder"):60118,IM=Pn?Symbol.for("react.scope"):60119;function $r(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Zy:switch(t=t.type,t){case t0:case jg:case Lg:case Fg:case Vg:case $g:return t;default:switch(t=t&&t.$$typeof,t){case Ug:case zg:case qg:case Hg:case Bg:return t;default:return e}}case e0:return e}}}function bC(t){return $r(t)===jg}xt.AsyncMode=t0;xt.ConcurrentMode=jg;xt.ContextConsumer=Ug;xt.ContextProvider=Bg;xt.Element=Zy;xt.ForwardRef=zg;xt.Fragment=Lg;xt.Lazy=qg;xt.Memo=Hg;xt.Portal=e0;xt.Profiler=Fg;xt.StrictMode=Vg;xt.Suspense=$g;xt.isAsyncMode=function(t){return bC(t)||$r(t)===t0};xt.isConcurrentMode=bC;xt.isContextConsumer=function(t){return $r(t)===Ug};xt.isContextProvider=function(t){return $r(t)===Bg};xt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zy};xt.isForwardRef=function(t){return $r(t)===zg};xt.isFragment=function(t){return $r(t)===Lg};xt.isLazy=function(t){return $r(t)===qg};xt.isMemo=function(t){return $r(t)===Hg};xt.isPortal=function(t){return $r(t)===e0};xt.isProfiler=function(t){return $r(t)===Fg};xt.isStrictMode=function(t){return $r(t)===Vg};xt.isSuspense=function(t){return $r(t)===$g};xt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Lg||t===jg||t===Fg||t===Vg||t===$g||t===_M||typeof t=="object"&&t!==null&&(t.$$typeof===qg||t.$$typeof===Hg||t.$$typeof===Bg||t.$$typeof===Ug||t.$$typeof===zg||t.$$typeof===yM||t.$$typeof===wM||t.$$typeof===IM||t.$$typeof===vM)};xt.typeOf=$r;PC.exports=xt;var EM=PC.exports,RC=EM,TM={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},SM={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},kC={};kC[RC.ForwardRef]=TM;kC[RC.Memo]=SM;function NC(t,e,n){if(n===void 0&&(n=Error),!t)throw new n(e)}var ct;(function(t){t[t.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",t[t.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",t[t.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",t[t.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",t[t.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",t[t.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",t[t.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",t[t.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",t[t.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",t[t.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",t[t.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",t[t.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",t[t.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",t[t.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",t[t.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",t[t.INVALID_TAG=23]="INVALID_TAG",t[t.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",t[t.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",t[t.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(ct||(ct={}));var Ot;(function(t){t[t.literal=0]="literal",t[t.argument=1]="argument",t[t.number=2]="number",t[t.date=3]="date",t[t.time=4]="time",t[t.select=5]="select",t[t.plural=6]="plural",t[t.pound=7]="pound",t[t.tag=8]="tag"})(Ot||(Ot={}));var $l;(function(t){t[t.number=0]="number",t[t.dateTime=1]="dateTime"})($l||($l={}));function CE(t){return t.type===Ot.literal}function xM(t){return t.type===Ot.argument}function DC(t){return t.type===Ot.number}function MC(t){return t.type===Ot.date}function OC(t){return t.type===Ot.time}function LC(t){return t.type===Ot.select}function VC(t){return t.type===Ot.plural}function CM(t){return t.type===Ot.pound}function FC(t){return t.type===Ot.tag}function BC(t){return!!(t&&typeof t=="object"&&t.type===$l.number)}function Y_(t){return!!(t&&typeof t=="object"&&t.type===$l.dateTime)}var UC=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,AM=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function PM(t){var e={};return t.replace(AM,function(n){var r=n.length;switch(n[0]){case"G":e.era=r===4?"long":r===5?"narrow":"short";break;case"y":e.year=r===2?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":e.month=["numeric","2-digit","short","long","narrow"][r-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":e.day=["numeric","2-digit"][r-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":e.weekday=r===4?"long":r===5?"narrow":"short";break;case"e":if(r<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][r-4];break;case"c":if(r<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][r-4];break;case"a":e.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":e.hourCycle="h12",e.hour=["numeric","2-digit"][r-1];break;case"H":e.hourCycle="h23",e.hour=["numeric","2-digit"][r-1];break;case"K":e.hourCycle="h11",e.hour=["numeric","2-digit"][r-1];break;case"k":e.hourCycle="h24",e.hour=["numeric","2-digit"][r-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":e.minute=["numeric","2-digit"][r-1];break;case"s":e.second=["numeric","2-digit"][r-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":e.timeZoneName=r<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),e}var bM=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function RM(t){if(t.length===0)throw new Error("Number skeleton cannot be empty");for(var e=t.split(bM).filter(function(T){return T.length>0}),n=[],r=0,i=e;r<i.length;r++){var s=i[r],a=s.split("/");if(a.length===0)throw new Error("Invalid number skeleton");for(var u=a[0],h=a.slice(1),g=0,_=h;g<_.length;g++){var w=_[g];if(w.length===0)throw new Error("Invalid number skeleton")}n.push({stem:u,options:h})}return n}function kM(t){return t.replace(/^(.*?)-/,"")}var AE=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,jC=/^(@+)?(\+|#+)?[rs]?$/g,NM=/(\*)(0+)|(#+)(0+)|(0+)/g,zC=/^(0+)$/;function PE(t){var e={};return t[t.length-1]==="r"?e.roundingPriority="morePrecision":t[t.length-1]==="s"&&(e.roundingPriority="lessPrecision"),t.replace(jC,function(n,r,i){return typeof i!="string"?(e.minimumSignificantDigits=r.length,e.maximumSignificantDigits=r.length):i==="+"?e.minimumSignificantDigits=r.length:r[0]==="#"?e.maximumSignificantDigits=r.length:(e.minimumSignificantDigits=r.length,e.maximumSignificantDigits=r.length+(typeof i=="string"?i.length:0)),""}),e}function $C(t){switch(t){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function DM(t){var e;if(t[0]==="E"&&t[1]==="E"?(e={notation:"engineering"},t=t.slice(2)):t[0]==="E"&&(e={notation:"scientific"},t=t.slice(1)),e){var n=t.slice(0,2);if(n==="+!"?(e.signDisplay="always",t=t.slice(2)):n==="+?"&&(e.signDisplay="exceptZero",t=t.slice(2)),!zC.test(t))throw new Error("Malformed concise eng/scientific notation");e.minimumIntegerDigits=t.length}return e}function bE(t){var e={},n=$C(t);return n||e}function MM(t){for(var e={},n=0,r=t;n<r.length;n++){var i=r[n];switch(i.stem){case"percent":case"%":e.style="percent";continue;case"%x100":e.style="percent",e.scale=100;continue;case"currency":e.style="currency",e.currency=i.options[0];continue;case"group-off":case",_":e.useGrouping=!1;continue;case"precision-integer":case".":e.maximumFractionDigits=0;continue;case"measure-unit":case"unit":e.style="unit",e.unit=kM(i.options[0]);continue;case"compact-short":case"K":e.notation="compact",e.compactDisplay="short";continue;case"compact-long":case"KK":e.notation="compact",e.compactDisplay="long";continue;case"scientific":e=Ve(Ve(Ve({},e),{notation:"scientific"}),i.options.reduce(function(h,g){return Ve(Ve({},h),bE(g))},{}));continue;case"engineering":e=Ve(Ve(Ve({},e),{notation:"engineering"}),i.options.reduce(function(h,g){return Ve(Ve({},h),bE(g))},{}));continue;case"notation-simple":e.notation="standard";continue;case"unit-width-narrow":e.currencyDisplay="narrowSymbol",e.unitDisplay="narrow";continue;case"unit-width-short":e.currencyDisplay="code",e.unitDisplay="short";continue;case"unit-width-full-name":e.currencyDisplay="name",e.unitDisplay="long";continue;case"unit-width-iso-code":e.currencyDisplay="symbol";continue;case"scale":e.scale=parseFloat(i.options[0]);continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(NM,function(h,g,_,w,T,E){if(g)e.minimumIntegerDigits=_.length;else{if(w&&T)throw new Error("We currently do not support maximum integer digits");if(E)throw new Error("We currently do not support exact integer digits")}return""});continue}if(zC.test(i.stem)){e.minimumIntegerDigits=i.stem.length;continue}if(AE.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(AE,function(h,g,_,w,T,E){return _==="*"?e.minimumFractionDigits=g.length:w&&w[0]==="#"?e.maximumFractionDigits=w.length:T&&E?(e.minimumFractionDigits=T.length,e.maximumFractionDigits=T.length+E.length):(e.minimumFractionDigits=g.length,e.maximumFractionDigits=g.length),""});var s=i.options[0];s==="w"?e=Ve(Ve({},e),{trailingZeroDisplay:"stripIfInteger"}):s&&(e=Ve(Ve({},e),PE(s)));continue}if(jC.test(i.stem)){e=Ve(Ve({},e),PE(i.stem));continue}var a=$C(i.stem);a&&(e=Ve(Ve({},e),a));var u=DM(i.stem);u&&(e=Ve(Ve({},e),u))}return e}var Sd={"001":["H","h"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["H","h","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["H","hB","h","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["H","h","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["H","hB","h","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["H","h","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["H","h","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["H","h","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["H","h","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["H","hB","h","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["H","h","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["H","h","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["H","h","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function OM(t,e){for(var n="",r=0;r<t.length;r++){var i=t.charAt(r);if(i==="j"){for(var s=0;r+1<t.length&&t.charAt(r+1)===i;)s++,r++;var a=1+(s&1),u=s<2?1:3+(s>>1),h="a",g=LM(e);for((g=="H"||g=="k")&&(u=0);u-- >0;)n+=h;for(;a-- >0;)n=g+n}else i==="J"?n+="H":n+=i}return n}function LM(t){var e=t.hourCycle;if(e===void 0&&t.hourCycles&&t.hourCycles.length&&(e=t.hourCycles[0]),e)switch(e){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n=t.language,r;n!=="root"&&(r=t.maximize().region);var i=Sd[r||""]||Sd[n||""]||Sd["".concat(n,"-001")]||Sd["001"];return i[0]}var mp,VM=new RegExp("^".concat(UC.source,"*")),FM=new RegExp("".concat(UC.source,"*$"));function dt(t,e){return{start:t,end:e}}var BM=!!String.prototype.startsWith&&"_a".startsWith("a",1),UM=!!String.fromCodePoint,jM=!!Object.fromEntries,zM=!!String.prototype.codePointAt,$M=!!String.prototype.trimStart,HM=!!String.prototype.trimEnd,qM=!!Number.isSafeInteger,GM=qM?Number.isSafeInteger:function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<=9007199254740991},X_=!0;try{var WM=qC("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");X_=((mp=WM.exec("a"))===null||mp===void 0?void 0:mp[0])==="a"}catch{X_=!1}var RE=BM?function(e,n,r){return e.startsWith(n,r)}:function(e,n,r){return e.slice(r,r+n.length)===n},J_=UM?String.fromCodePoint:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r="",i=e.length,s=0,a;i>s;){if(a=e[s++],a>1114111)throw RangeError(a+" is not a valid code point");r+=a<65536?String.fromCharCode(a):String.fromCharCode(((a-=65536)>>10)+55296,a%1024+56320)}return r},kE=jM?Object.fromEntries:function(e){for(var n={},r=0,i=e;r<i.length;r++){var s=i[r],a=s[0],u=s[1];n[a]=u}return n},HC=zM?function(e,n){return e.codePointAt(n)}:function(e,n){var r=e.length;if(!(n<0||n>=r)){var i=e.charCodeAt(n),s;return i<55296||i>56319||n+1===r||(s=e.charCodeAt(n+1))<56320||s>57343?i:(i-55296<<10)+(s-56320)+65536}},KM=$M?function(e){return e.trimStart()}:function(e){return e.replace(VM,"")},QM=HM?function(e){return e.trimEnd()}:function(e){return e.replace(FM,"")};function qC(t,e){return new RegExp(t,e)}var Z_;if(X_){var NE=qC("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");Z_=function(e,n){var r;NE.lastIndex=n;var i=NE.exec(e);return(r=i[1])!==null&&r!==void 0?r:""}}else Z_=function(e,n){for(var r=[];;){var i=HC(e,n);if(i===void 0||GC(i)||ZM(i))break;r.push(i),n+=i>=65536?2:1}return J_.apply(void 0,r)};var YM=function(){function t(e,n){n===void 0&&(n={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!n.ignoreTag,this.locale=n.locale,this.requiresOtherClause=!!n.requiresOtherClause,this.shouldParseSkeletons=!!n.shouldParseSkeletons}return t.prototype.parse=function(){if(this.offset()!==0)throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},t.prototype.parseMessage=function(e,n,r){for(var i=[];!this.isEOF();){var s=this.char();if(s===123){var a=this.parseArgument(e,r);if(a.err)return a;i.push(a.val)}else{if(s===125&&e>0)break;if(s===35&&(n==="plural"||n==="selectordinal")){var u=this.clonePosition();this.bump(),i.push({type:Ot.pound,location:dt(u,this.clonePosition())})}else if(s===60&&!this.ignoreTag&&this.peek()===47){if(r)break;return this.error(ct.UNMATCHED_CLOSING_TAG,dt(this.clonePosition(),this.clonePosition()))}else if(s===60&&!this.ignoreTag&&ev(this.peek()||0)){var a=this.parseTag(e,n);if(a.err)return a;i.push(a.val)}else{var a=this.parseLiteral(e,n);if(a.err)return a;i.push(a.val)}}}return{val:i,err:null}},t.prototype.parseTag=function(e,n){var r=this.clonePosition();this.bump();var i=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Ot.literal,value:"<".concat(i,"/>"),location:dt(r,this.clonePosition())},err:null};if(this.bumpIf(">")){var s=this.parseMessage(e+1,n,!0);if(s.err)return s;var a=s.val,u=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!ev(this.char()))return this.error(ct.INVALID_TAG,dt(u,this.clonePosition()));var h=this.clonePosition(),g=this.parseTagName();return i!==g?this.error(ct.UNMATCHED_CLOSING_TAG,dt(h,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Ot.tag,value:i,children:a,location:dt(r,this.clonePosition())},err:null}:this.error(ct.INVALID_TAG,dt(u,this.clonePosition())))}else return this.error(ct.UNCLOSED_TAG,dt(r,this.clonePosition()))}else return this.error(ct.INVALID_TAG,dt(r,this.clonePosition()))},t.prototype.parseTagName=function(){var e=this.offset();for(this.bump();!this.isEOF()&&JM(this.char());)this.bump();return this.message.slice(e,this.offset())},t.prototype.parseLiteral=function(e,n){for(var r=this.clonePosition(),i="";;){var s=this.tryParseQuote(n);if(s){i+=s;continue}var a=this.tryParseUnquoted(e,n);if(a){i+=a;continue}var u=this.tryParseLeftAngleBracket();if(u){i+=u;continue}break}var h=dt(r,this.clonePosition());return{val:{type:Ot.literal,value:i,location:h},err:null}},t.prototype.tryParseLeftAngleBracket=function(){return!this.isEOF()&&this.char()===60&&(this.ignoreTag||!XM(this.peek()||0))?(this.bump(),"<"):null},t.prototype.tryParseQuote=function(e){if(this.isEOF()||this.char()!==39)return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if(e==="plural"||e==="selectordinal")break;return null;default:return null}this.bump();var n=[this.char()];for(this.bump();!this.isEOF();){var r=this.char();if(r===39)if(this.peek()===39)n.push(39),this.bump();else{this.bump();break}else n.push(r);this.bump()}return J_.apply(void 0,n)},t.prototype.tryParseUnquoted=function(e,n){if(this.isEOF())return null;var r=this.char();return r===60||r===123||r===35&&(n==="plural"||n==="selectordinal")||r===125&&e>0?null:(this.bump(),J_(r))},t.prototype.parseArgument=function(e,n){var r=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,dt(r,this.clonePosition()));if(this.char()===125)return this.bump(),this.error(ct.EMPTY_ARGUMENT,dt(r,this.clonePosition()));var i=this.parseIdentifierIfPossible().value;if(!i)return this.error(ct.MALFORMED_ARGUMENT,dt(r,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,dt(r,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Ot.argument,value:i,location:dt(r,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,dt(r,this.clonePosition())):this.parseArgumentOptions(e,n,i,r);default:return this.error(ct.MALFORMED_ARGUMENT,dt(r,this.clonePosition()))}},t.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),n=this.offset(),r=Z_(this.message,n),i=n+r.length;this.bumpTo(i);var s=this.clonePosition(),a=dt(e,s);return{value:r,location:a}},t.prototype.parseArgumentOptions=function(e,n,r,i){var s,a=this.clonePosition(),u=this.parseIdentifierIfPossible().value,h=this.clonePosition();switch(u){case"":return this.error(ct.EXPECT_ARGUMENT_TYPE,dt(a,h));case"number":case"date":case"time":{this.bumpSpace();var g=null;if(this.bumpIf(",")){this.bumpSpace();var _=this.clonePosition(),w=this.parseSimpleArgStyleIfPossible();if(w.err)return w;var T=QM(w.val);if(T.length===0)return this.error(ct.EXPECT_ARGUMENT_STYLE,dt(this.clonePosition(),this.clonePosition()));var E=dt(_,this.clonePosition());g={style:T,styleLocation:E}}var z=this.tryParseArgumentClose(i);if(z.err)return z;var j=dt(i,this.clonePosition());if(g&&RE(g==null?void 0:g.style,"::",0)){var J=KM(g.style.slice(2));if(u==="number"){var w=this.parseNumberSkeletonFromString(J,g.styleLocation);return w.err?w:{val:{type:Ot.number,value:r,location:j,style:w.val},err:null}}else{if(J.length===0)return this.error(ct.EXPECT_DATE_TIME_SKELETON,j);var V=J;this.locale&&(V=OM(J,this.locale));var T={type:$l.dateTime,pattern:V,location:g.styleLocation,parsedOptions:this.shouldParseSkeletons?PM(V):{}},B=u==="date"?Ot.date:Ot.time;return{val:{type:B,value:r,location:j,style:T},err:null}}}return{val:{type:u==="number"?Ot.number:u==="date"?Ot.date:Ot.time,value:r,location:j,style:(s=g==null?void 0:g.style)!==null&&s!==void 0?s:null},err:null}}case"plural":case"selectordinal":case"select":{var U=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(ct.EXPECT_SELECT_ARGUMENT_OPTIONS,dt(U,Ve({},U)));this.bumpSpace();var Z=this.parseIdentifierIfPossible(),ne=0;if(u!=="select"&&Z.value==="offset"){if(!this.bumpIf(":"))return this.error(ct.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,dt(this.clonePosition(),this.clonePosition()));this.bumpSpace();var w=this.tryParseDecimalInteger(ct.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,ct.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(w.err)return w;this.bumpSpace(),Z=this.parseIdentifierIfPossible(),ne=w.val}var te=this.tryParsePluralOrSelectOptions(e,u,n,Z);if(te.err)return te;var z=this.tryParseArgumentClose(i);if(z.err)return z;var ae=dt(i,this.clonePosition());return u==="select"?{val:{type:Ot.select,value:r,options:kE(te.val),location:ae},err:null}:{val:{type:Ot.plural,value:r,options:kE(te.val),offset:ne,pluralType:u==="plural"?"cardinal":"ordinal",location:ae},err:null}}default:return this.error(ct.INVALID_ARGUMENT_TYPE,dt(a,h))}},t.prototype.tryParseArgumentClose=function(e){return this.isEOF()||this.char()!==125?this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,dt(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},t.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,n=this.clonePosition();!this.isEOF();){var r=this.char();switch(r){case 39:{this.bump();var i=this.clonePosition();if(!this.bumpUntil("'"))return this.error(ct.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,dt(i,this.clonePosition()));this.bump();break}case 123:{e+=1,this.bump();break}case 125:{if(e>0)e-=1;else return{val:this.message.slice(n.offset,this.offset()),err:null};break}default:this.bump();break}}return{val:this.message.slice(n.offset,this.offset()),err:null}},t.prototype.parseNumberSkeletonFromString=function(e,n){var r=[];try{r=RM(e)}catch{return this.error(ct.INVALID_NUMBER_SKELETON,n)}return{val:{type:$l.number,tokens:r,location:n,parsedOptions:this.shouldParseSkeletons?MM(r):{}},err:null}},t.prototype.tryParsePluralOrSelectOptions=function(e,n,r,i){for(var s,a=!1,u=[],h=new Set,g=i.value,_=i.location;;){if(g.length===0){var w=this.clonePosition();if(n!=="select"&&this.bumpIf("=")){var T=this.tryParseDecimalInteger(ct.EXPECT_PLURAL_ARGUMENT_SELECTOR,ct.INVALID_PLURAL_ARGUMENT_SELECTOR);if(T.err)return T;_=dt(w,this.clonePosition()),g=this.message.slice(w.offset,this.offset())}else break}if(h.has(g))return this.error(n==="select"?ct.DUPLICATE_SELECT_ARGUMENT_SELECTOR:ct.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,_);g==="other"&&(a=!0),this.bumpSpace();var E=this.clonePosition();if(!this.bumpIf("{"))return this.error(n==="select"?ct.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:ct.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,dt(this.clonePosition(),this.clonePosition()));var z=this.parseMessage(e+1,n,r);if(z.err)return z;var j=this.tryParseArgumentClose(E);if(j.err)return j;u.push([g,{value:z.val,location:dt(E,this.clonePosition())}]),h.add(g),this.bumpSpace(),s=this.parseIdentifierIfPossible(),g=s.value,_=s.location}return u.length===0?this.error(n==="select"?ct.EXPECT_SELECT_ARGUMENT_SELECTOR:ct.EXPECT_PLURAL_ARGUMENT_SELECTOR,dt(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!a?this.error(ct.MISSING_OTHER_CLAUSE,dt(this.clonePosition(),this.clonePosition())):{val:u,err:null}},t.prototype.tryParseDecimalInteger=function(e,n){var r=1,i=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(r=-1);for(var s=!1,a=0;!this.isEOF();){var u=this.char();if(u>=48&&u<=57)s=!0,a=a*10+(u-48),this.bump();else break}var h=dt(i,this.clonePosition());return s?(a*=r,GM(a)?{val:a,err:null}:this.error(n,h)):this.error(e,h)},t.prototype.offset=function(){return this.position.offset},t.prototype.isEOF=function(){return this.offset()===this.message.length},t.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},t.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var n=HC(this.message,e);if(n===void 0)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return n},t.prototype.error=function(e,n){return{val:null,err:{kind:e,message:this.message,location:n}}},t.prototype.bump=function(){if(!this.isEOF()){var e=this.char();e===10?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},t.prototype.bumpIf=function(e){if(RE(this.message,e,this.offset())){for(var n=0;n<e.length;n++)this.bump();return!0}return!1},t.prototype.bumpUntil=function(e){var n=this.offset(),r=this.message.indexOf(e,n);return r>=0?(this.bumpTo(r),!0):(this.bumpTo(this.message.length),!1)},t.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var n=this.offset();if(n===e)break;if(n>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},t.prototype.bumpSpace=function(){for(;!this.isEOF()&&GC(this.char());)this.bump()},t.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),n=this.offset(),r=this.message.charCodeAt(n+(e>=65536?2:1));return r??null},t}();function ev(t){return t>=97&&t<=122||t>=65&&t<=90}function XM(t){return ev(t)||t===47}function JM(t){return t===45||t===46||t>=48&&t<=57||t===95||t>=97&&t<=122||t>=65&&t<=90||t==183||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function GC(t){return t>=9&&t<=13||t===32||t===133||t>=8206&&t<=8207||t===8232||t===8233}function ZM(t){return t>=33&&t<=35||t===36||t>=37&&t<=39||t===40||t===41||t===42||t===43||t===44||t===45||t>=46&&t<=47||t>=58&&t<=59||t>=60&&t<=62||t>=63&&t<=64||t===91||t===92||t===93||t===94||t===96||t===123||t===124||t===125||t===126||t===161||t>=162&&t<=165||t===166||t===167||t===169||t===171||t===172||t===174||t===176||t===177||t===182||t===187||t===191||t===215||t===247||t>=8208&&t<=8213||t>=8214&&t<=8215||t===8216||t===8217||t===8218||t>=8219&&t<=8220||t===8221||t===8222||t===8223||t>=8224&&t<=8231||t>=8240&&t<=8248||t===8249||t===8250||t>=8251&&t<=8254||t>=8257&&t<=8259||t===8260||t===8261||t===8262||t>=8263&&t<=8273||t===8274||t===8275||t>=8277&&t<=8286||t>=8592&&t<=8596||t>=8597&&t<=8601||t>=8602&&t<=8603||t>=8604&&t<=8607||t===8608||t>=8609&&t<=8610||t===8611||t>=8612&&t<=8613||t===8614||t>=8615&&t<=8621||t===8622||t>=8623&&t<=8653||t>=8654&&t<=8655||t>=8656&&t<=8657||t===8658||t===8659||t===8660||t>=8661&&t<=8691||t>=8692&&t<=8959||t>=8960&&t<=8967||t===8968||t===8969||t===8970||t===8971||t>=8972&&t<=8991||t>=8992&&t<=8993||t>=8994&&t<=9e3||t===9001||t===9002||t>=9003&&t<=9083||t===9084||t>=9085&&t<=9114||t>=9115&&t<=9139||t>=9140&&t<=9179||t>=9180&&t<=9185||t>=9186&&t<=9254||t>=9255&&t<=9279||t>=9280&&t<=9290||t>=9291&&t<=9311||t>=9472&&t<=9654||t===9655||t>=9656&&t<=9664||t===9665||t>=9666&&t<=9719||t>=9720&&t<=9727||t>=9728&&t<=9838||t===9839||t>=9840&&t<=10087||t===10088||t===10089||t===10090||t===10091||t===10092||t===10093||t===10094||t===10095||t===10096||t===10097||t===10098||t===10099||t===10100||t===10101||t>=10132&&t<=10175||t>=10176&&t<=10180||t===10181||t===10182||t>=10183&&t<=10213||t===10214||t===10215||t===10216||t===10217||t===10218||t===10219||t===10220||t===10221||t===10222||t===10223||t>=10224&&t<=10239||t>=10240&&t<=10495||t>=10496&&t<=10626||t===10627||t===10628||t===10629||t===10630||t===10631||t===10632||t===10633||t===10634||t===10635||t===10636||t===10637||t===10638||t===10639||t===10640||t===10641||t===10642||t===10643||t===10644||t===10645||t===10646||t===10647||t===10648||t>=10649&&t<=10711||t===10712||t===10713||t===10714||t===10715||t>=10716&&t<=10747||t===10748||t===10749||t>=10750&&t<=11007||t>=11008&&t<=11055||t>=11056&&t<=11076||t>=11077&&t<=11078||t>=11079&&t<=11084||t>=11085&&t<=11123||t>=11124&&t<=11125||t>=11126&&t<=11157||t===11158||t>=11159&&t<=11263||t>=11776&&t<=11777||t===11778||t===11779||t===11780||t===11781||t>=11782&&t<=11784||t===11785||t===11786||t===11787||t===11788||t===11789||t>=11790&&t<=11798||t===11799||t>=11800&&t<=11801||t===11802||t===11803||t===11804||t===11805||t>=11806&&t<=11807||t===11808||t===11809||t===11810||t===11811||t===11812||t===11813||t===11814||t===11815||t===11816||t===11817||t>=11818&&t<=11822||t===11823||t>=11824&&t<=11833||t>=11834&&t<=11835||t>=11836&&t<=11839||t===11840||t===11841||t===11842||t>=11843&&t<=11855||t>=11856&&t<=11857||t===11858||t>=11859&&t<=11903||t>=12289&&t<=12291||t===12296||t===12297||t===12298||t===12299||t===12300||t===12301||t===12302||t===12303||t===12304||t===12305||t>=12306&&t<=12307||t===12308||t===12309||t===12310||t===12311||t===12312||t===12313||t===12314||t===12315||t===12316||t===12317||t>=12318&&t<=12319||t===12320||t===12336||t===64830||t===64831||t>=65093&&t<=65094}function tv(t){t.forEach(function(e){if(delete e.location,LC(e)||VC(e))for(var n in e.options)delete e.options[n].location,tv(e.options[n].value);else DC(e)&&BC(e.style)||(MC(e)||OC(e))&&Y_(e.style)?delete e.style.location:FC(e)&&tv(e.children)})}function eO(t,e){e===void 0&&(e={}),e=Ve({shouldParseSkeletons:!0,requiresOtherClause:!0},e);var n=new YM(t,e).parse();if(n.err){var r=SyntaxError(ct[n.err.kind]);throw r.location=n.err.location,r.originalMessage=n.err.message,r}return e!=null&&e.captureLocation||tv(n.val),n.val}function Ai(t,e){var n=e&&e.cache?e.cache:oO,r=e&&e.serializer?e.serializer:sO,i=e&&e.strategy?e.strategy:nO;return i(t,{cache:n,serializer:r})}function tO(t){return t==null||typeof t=="number"||typeof t=="boolean"}function WC(t,e,n,r){var i=tO(r)?r:n(r),s=e.get(i);return typeof s>"u"&&(s=t.call(this,r),e.set(i,s)),s}function KC(t,e,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),s=e.get(i);return typeof s>"u"&&(s=t.apply(this,r),e.set(i,s)),s}function n0(t,e,n,r,i){return n.bind(e,t,r,i)}function nO(t,e){var n=t.length===1?WC:KC;return n0(t,this,n,e.cache.create(),e.serializer)}function rO(t,e){return n0(t,this,KC,e.cache.create(),e.serializer)}function iO(t,e){return n0(t,this,WC,e.cache.create(),e.serializer)}var sO=function(){return JSON.stringify(arguments)};function r0(){this.cache=Object.create(null)}r0.prototype.get=function(t){return this.cache[t]};r0.prototype.set=function(t,e){this.cache[t]=e};var oO={create:function(){return new r0}},Pi={variadic:rO,monadic:iO},Gi;(function(t){t.MISSING_VALUE="MISSING_VALUE",t.INVALID_VALUE="INVALID_VALUE",t.MISSING_INTL_API="MISSING_INTL_API"})(Gi||(Gi={}));var Co=function(t){ri(e,t);function e(n,r,i){var s=t.call(this,n)||this;return s.code=r,s.originalMessage=i,s}return e.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},e}(Error),DE=function(t){ri(e,t);function e(n,r,i,s){return t.call(this,'Invalid values for "'.concat(n,'": "').concat(r,'". Options are "').concat(Object.keys(i).join('", "'),'"'),Gi.INVALID_VALUE,s)||this}return e}(Co),aO=function(t){ri(e,t);function e(n,r,i){return t.call(this,'Value for "'.concat(n,'" must be of type ').concat(r),Gi.INVALID_VALUE,i)||this}return e}(Co),lO=function(t){ri(e,t);function e(n,r){return t.call(this,'The intl string context variable "'.concat(n,'" was not provided to the string "').concat(r,'"'),Gi.MISSING_VALUE,r)||this}return e}(Co),tr;(function(t){t[t.literal=0]="literal",t[t.object=1]="object"})(tr||(tr={}));function uO(t){return t.length<2?t:t.reduce(function(e,n){var r=e[e.length-1];return!r||r.type!==tr.literal||n.type!==tr.literal?e.push(n):r.value+=n.value,e},[])}function QC(t){return typeof t=="function"}function Zd(t,e,n,r,i,s,a){if(t.length===1&&CE(t[0]))return[{type:tr.literal,value:t[0].value}];for(var u=[],h=0,g=t;h<g.length;h++){var _=g[h];if(CE(_)){u.push({type:tr.literal,value:_.value});continue}if(CM(_)){typeof s=="number"&&u.push({type:tr.literal,value:n.getNumberFormat(e).format(s)});continue}var w=_.value;if(!(i&&w in i))throw new lO(w,a);var T=i[w];if(xM(_)){(!T||typeof T=="string"||typeof T=="number")&&(T=typeof T=="string"||typeof T=="number"?String(T):""),u.push({type:typeof T=="string"?tr.literal:tr.object,value:T});continue}if(MC(_)){var E=typeof _.style=="string"?r.date[_.style]:Y_(_.style)?_.style.parsedOptions:void 0;u.push({type:tr.literal,value:n.getDateTimeFormat(e,E).format(T)});continue}if(OC(_)){var E=typeof _.style=="string"?r.time[_.style]:Y_(_.style)?_.style.parsedOptions:r.time.medium;u.push({type:tr.literal,value:n.getDateTimeFormat(e,E).format(T)});continue}if(DC(_)){var E=typeof _.style=="string"?r.number[_.style]:BC(_.style)?_.style.parsedOptions:void 0;E&&E.scale&&(T=T*(E.scale||1)),u.push({type:tr.literal,value:n.getNumberFormat(e,E).format(T)});continue}if(FC(_)){var z=_.children,j=_.value,J=i[j];if(!QC(J))throw new aO(j,"function",a);var V=Zd(z,e,n,r,i,s),B=J(V.map(function(ne){return ne.value}));Array.isArray(B)||(B=[B]),u.push.apply(u,B.map(function(ne){return{type:typeof ne=="string"?tr.literal:tr.object,value:ne}}))}if(LC(_)){var U=_.options[T]||_.options.other;if(!U)throw new DE(_.value,T,Object.keys(_.options),a);u.push.apply(u,Zd(U.value,e,n,r,i));continue}if(VC(_)){var U=_.options["=".concat(T)];if(!U){if(!Intl.PluralRules)throw new Co(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,Gi.MISSING_INTL_API,a);var Z=n.getPluralRules(e,{type:_.pluralType}).select(T-(_.offset||0));U=_.options[Z]||_.options.other}if(!U)throw new DE(_.value,T,Object.keys(_.options),a);u.push.apply(u,Zd(U.value,e,n,r,i,T-(_.offset||0)));continue}}return uO(u)}function cO(t,e){return e?Ve(Ve(Ve({},t||{}),e||{}),Object.keys(t).reduce(function(n,r){return n[r]=Ve(Ve({},t[r]),e[r]||{}),n},{})):t}function hO(t,e){return e?Object.keys(t).reduce(function(n,r){return n[r]=cO(t[r],e[r]),n},Ve({},t)):t}function pp(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}function dO(t){return t===void 0&&(t={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Ai(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.NumberFormat).bind.apply(e,bi([void 0],n,!1)))},{cache:pp(t.number),strategy:Pi.variadic}),getDateTimeFormat:Ai(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.DateTimeFormat).bind.apply(e,bi([void 0],n,!1)))},{cache:pp(t.dateTime),strategy:Pi.variadic}),getPluralRules:Ai(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.PluralRules).bind.apply(e,bi([void 0],n,!1)))},{cache:pp(t.pluralRules),strategy:Pi.variadic})}}var YC=function(){function t(e,n,r,i){var s=this;if(n===void 0&&(n=t.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(h){var g=s.formatToParts(h);if(g.length===1)return g[0].value;var _=g.reduce(function(w,T){return!w.length||T.type!==tr.literal||typeof w[w.length-1]!="string"?w.push(T.value):w[w.length-1]+=T.value,w},[]);return _.length<=1?_[0]||"":_},this.formatToParts=function(h){return Zd(s.ast,s.locales,s.formatters,s.formats,h,void 0,s.message)},this.resolvedOptions=function(){var h;return{locale:((h=s.resolvedLocale)===null||h===void 0?void 0:h.toString())||Intl.NumberFormat.supportedLocalesOf(s.locales)[0]}},this.getAst=function(){return s.ast},this.locales=n,this.resolvedLocale=t.resolveLocale(n),typeof e=="string"){if(this.message=e,!t.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var a=i||{};a.formatters;var u=ws(a,["formatters"]);this.ast=t.__parse(e,Ve(Ve({},u),{locale:this.resolvedLocale}))}else this.ast=e;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=hO(t.formats,r),this.formatters=i&&i.formatters||dO(this.formatterCache)}return Object.defineProperty(t,"defaultLocale",{get:function(){return t.memoizedDefaultLocale||(t.memoizedDefaultLocale=new Intl.NumberFormat().resolvedOptions().locale),t.memoizedDefaultLocale},enumerable:!1,configurable:!0}),t.memoizedDefaultLocale=null,t.resolveLocale=function(e){if(!(typeof Intl.Locale>"u")){var n=Intl.NumberFormat.supportedLocalesOf(e);return n.length>0?new Intl.Locale(n[0]):new Intl.Locale(typeof e=="string"?e:e[0])}},t.__parse=eO,t.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},t}(),ya;(function(t){t.FORMAT_ERROR="FORMAT_ERROR",t.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",t.INVALID_CONFIG="INVALID_CONFIG",t.MISSING_DATA="MISSING_DATA",t.MISSING_TRANSLATION="MISSING_TRANSLATION"})(ya||(ya={}));var Ch=function(t){ri(e,t);function e(n,r,i){var s=this,a=i?i instanceof Error?i:new Error(String(i)):void 0;return s=t.call(this,"[@formatjs/intl Error ".concat(n,"] ").concat(r,`
`).concat(a?`
`.concat(a.message,`
`).concat(a.stack):""))||this,s.code=n,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(s,e),s}return e}(Error),fO=function(t){ri(e,t);function e(n,r){return t.call(this,ya.UNSUPPORTED_FORMATTER,n,r)||this}return e}(Ch),gO=function(t){ri(e,t);function e(n,r){return t.call(this,ya.INVALID_CONFIG,n,r)||this}return e}(Ch),ME=function(t){ri(e,t);function e(n,r){return t.call(this,ya.MISSING_DATA,n,r)||this}return e}(Ch),ii=function(t){ri(e,t);function e(n,r,i){var s=t.call(this,ya.FORMAT_ERROR,"".concat(n,`
Locale: `).concat(r,`
`),i)||this;return s.locale=r,s}return e}(Ch),_p=function(t){ri(e,t);function e(n,r,i,s){var a=t.call(this,"".concat(n,`
MessageID: `).concat(i==null?void 0:i.id,`
Default Message: `).concat(i==null?void 0:i.defaultMessage,`
Description: `).concat(i==null?void 0:i.description,`
`),r,s)||this;return a.descriptor=i,a.locale=r,a}return e}(ii),mO=function(t){ri(e,t);function e(n,r){var i=t.call(this,ya.MISSING_TRANSLATION,'Missing message: "'.concat(n.id,'" for locale "').concat(r,'", using ').concat(n.defaultMessage?"default message (".concat(typeof n.defaultMessage=="string"?n.defaultMessage:n.defaultMessage.map(function(s){var a;return(a=s.value)!==null&&a!==void 0?a:JSON.stringify(s)}).join(),")"):"id"," as fallback."))||this;return i.descriptor=n,i}return e}(Ch);function Oa(t,e,n){return n===void 0&&(n={}),e.reduce(function(r,i){return i in t?r[i]=t[i]:i in n&&(r[i]=n[i]),r},{})}var pO=function(t){},_O=function(t){},XC={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:pO,onWarn:_O};function JC(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function jo(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}function vO(t){t===void 0&&(t=JC());var e=Intl.RelativeTimeFormat,n=Intl.ListFormat,r=Intl.DisplayNames,i=Ai(function(){for(var u,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((u=Intl.DateTimeFormat).bind.apply(u,bi([void 0],h,!1)))},{cache:jo(t.dateTime),strategy:Pi.variadic}),s=Ai(function(){for(var u,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((u=Intl.NumberFormat).bind.apply(u,bi([void 0],h,!1)))},{cache:jo(t.number),strategy:Pi.variadic}),a=Ai(function(){for(var u,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((u=Intl.PluralRules).bind.apply(u,bi([void 0],h,!1)))},{cache:jo(t.pluralRules),strategy:Pi.variadic});return{getDateTimeFormat:i,getNumberFormat:s,getMessageFormat:Ai(function(u,h,g,_){return new YC(u,h,g,Ve({formatters:{getNumberFormat:s,getDateTimeFormat:i,getPluralRules:a}},_||{}))},{cache:jo(t.message),strategy:Pi.variadic}),getRelativeTimeFormat:Ai(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return new(e.bind.apply(e,bi([void 0],u,!1)))},{cache:jo(t.relativeTime),strategy:Pi.variadic}),getPluralRules:a,getListFormat:Ai(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return new(n.bind.apply(n,bi([void 0],u,!1)))},{cache:jo(t.list),strategy:Pi.variadic}),getDisplayNames:Ai(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return new(r.bind.apply(r,bi([void 0],u,!1)))},{cache:jo(t.displayNames),strategy:Pi.variadic})}}function i0(t,e,n,r){var i=t&&t[e],s;if(i&&(s=i[n]),s)return s;r(new fO("No ".concat(e," format named: ").concat(n)))}function xd(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=Ve({timeZone:e},t[r]),n},{})}function OE(t,e){var n=Object.keys(Ve(Ve({},t),e));return n.reduce(function(r,i){return r[i]=Ve(Ve({},t[i]||{}),e[i]||{}),r},{})}function LE(t,e){if(!e)return t;var n=YC.formats;return Ve(Ve(Ve({},n),t),{date:OE(xd(n.date,e),xd(t.date||{},e)),time:OE(xd(n.time,e),xd(t.time||{},e))})}var nv=function(t,e,n,r,i){var s=t.locale,a=t.formats,u=t.messages,h=t.defaultLocale,g=t.defaultFormats,_=t.fallbackOnEmptyString,w=t.onError,T=t.timeZone,E=t.defaultRichTextElements;n===void 0&&(n={id:""});var z=n.id,j=n.defaultMessage;NC(!!z,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var J=String(z),V=u&&Object.prototype.hasOwnProperty.call(u,J)&&u[J];if(Array.isArray(V)&&V.length===1&&V[0].type===Ot.literal)return V[0].value;if(!r&&V&&typeof V=="string"&&!E)return V.replace(/'\{(.*?)\}'/gi,"{$1}");if(r=Ve(Ve({},E),r||{}),a=LE(a,T),g=LE(g,T),!V){if(_===!1&&V==="")return V;if((!j||s&&s.toLowerCase()!==h.toLowerCase())&&w(new mO(n,s)),j)try{var B=e.getMessageFormat(j,h,g,i);return B.format(r)}catch(U){return w(new _p('Error formatting default message for: "'.concat(J,'", rendering default message verbatim'),s,n,U)),typeof j=="string"?j:J}return J}try{var B=e.getMessageFormat(V,s,a,Ve({formatters:e},i||{}));return B.format(r)}catch(U){w(new _p('Error formatting message: "'.concat(J,'", using ').concat(j?"default message":"id"," as fallback."),s,n,U))}if(j)try{var B=e.getMessageFormat(j,h,g,i);return B.format(r)}catch(U){w(new _p('Error formatting the default message for: "'.concat(J,'", rendering message verbatim'),s,n,U))}return typeof V=="string"?V:typeof j=="string"?j:J},ZC=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function Gg(t,e,n,r){var i=t.locale,s=t.formats,a=t.onError,u=t.timeZone;r===void 0&&(r={});var h=r.format,g=Ve(Ve({},u&&{timeZone:u}),h&&i0(s,e,h,a)),_=Oa(r,ZC,g);return e==="time"&&!_.hour&&!_.minute&&!_.second&&!_.timeStyle&&!_.dateStyle&&(_=Ve(Ve({},_),{hour:"numeric",minute:"numeric"})),n(i,_)}function yO(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return Gg(t,"date",e,a).format(u)}catch(h){t.onError(new ii("Error formatting date.",t.locale,h))}return String(u)}function wO(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return Gg(t,"time",e,a).format(u)}catch(h){t.onError(new ii("Error formatting time.",t.locale,h))}return String(u)}function IO(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=n[2],u=a===void 0?{}:a,h=t.timeZone,g=t.locale,_=t.onError,w=Oa(u,ZC,h?{timeZone:h}:{});try{return e(g,w).formatRange(i,s)}catch(T){_(new ii("Error formatting date time range.",t.locale,T))}return String(i)}function EO(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return Gg(t,"date",e,a).formatToParts(u)}catch(h){t.onError(new ii("Error formatting date.",t.locale,h))}return[]}function TO(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,u=typeof i=="string"?new Date(i||0):i;try{return Gg(t,"time",e,a).formatToParts(u)}catch(h){t.onError(new ii("Error formatting time.",t.locale,h))}return[]}var SO=["style","type","fallback","languageDisplay"];function xO(t,e,n,r){var i=t.locale,s=t.onError,a=Intl.DisplayNames;a||s(new Co(`Intl.DisplayNames is not available in this environment.
Try polyfilling it using "@formatjs/intl-displaynames"
`,Gi.MISSING_INTL_API));var u=Oa(r,SO);try{return e(i,u).of(n)}catch(h){s(new ii("Error formatting display name.",i,h))}}var CO=["type","style"],VE=Date.now();function AO(t){return"".concat(VE,"_").concat(t,"_").concat(VE)}function PO(t,e,n,r){r===void 0&&(r={});var i=eA(t,e,n,r).reduce(function(s,a){var u=a.value;return typeof u!="string"?s.push(u):typeof s[s.length-1]=="string"?s[s.length-1]+=u:s.push(u),s},[]);return i.length===1?i[0]:i.length===0?"":i}function eA(t,e,n,r){var i=t.locale,s=t.onError;r===void 0&&(r={});var a=Intl.ListFormat;a||s(new Co(`Intl.ListFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-listformat"
`,Gi.MISSING_INTL_API));var u=Oa(r,CO);try{var h={},g=n.map(function(_,w){if(typeof _=="object"){var T=AO(w);return h[T]=_,T}return String(_)});return e(i,u).formatToParts(g).map(function(_){return _.type==="literal"?_:Ve(Ve({},_),{value:h[_.value]||_.value})})}catch(_){s(new ii("Error formatting list.",i,_))}return n}var bO=["type"];function RO(t,e,n,r){var i=t.locale,s=t.onError;r===void 0&&(r={}),Intl.PluralRules||s(new Co(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,Gi.MISSING_INTL_API));var a=Oa(r,bO);try{return e(i,a).select(n)}catch(u){s(new ii("Error formatting plural.",i,u))}return"other"}var kO=["numeric","style"];function NO(t,e,n){var r=t.locale,i=t.formats,s=t.onError;n===void 0&&(n={});var a=n.format,u=!!a&&i0(i,"relative",a,s)||{},h=Oa(n,kO,u);return e(r,h)}function DO(t,e,n,r,i){i===void 0&&(i={}),r||(r="second");var s=Intl.RelativeTimeFormat;s||t.onError(new Co(`Intl.RelativeTimeFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-relativetimeformat"
`,Gi.MISSING_INTL_API));try{return NO(t,e,i).format(n,r)}catch(a){t.onError(new ii("Error formatting relative time.",t.locale,a))}return String(n)}var MO=["style","currency","currencyDisplay","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem"];function tA(t,e,n){var r=t.locale,i=t.formats,s=t.onError;n===void 0&&(n={});var a=n.format,u=a&&i0(i,"number",a,s)||{},h=Oa(n,MO,u);return e(r,h)}function OO(t,e,n,r){r===void 0&&(r={});try{return tA(t,e,r).format(n)}catch(i){t.onError(new ii("Error formatting number.",t.locale,i))}return String(n)}function LO(t,e,n,r){r===void 0&&(r={});try{return tA(t,e,r).formatToParts(n)}catch(i){t.onError(new ii("Error formatting number.",t.locale,i))}return[]}function VO(t){var e=t?t[Object.keys(t)[0]]:void 0;return typeof e=="string"}function FO(t){t.onWarn&&t.defaultRichTextElements&&VO(t.messages||{})&&t.onWarn(`[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. 
Please consider using "@formatjs/cli" to pre-compile your messages for performance.
For more details see https://formatjs.io/docs/getting-started/message-distribution`)}function BO(t,e){var n=vO(e),r=Ve(Ve({},XC),t),i=r.locale,s=r.defaultLocale,a=r.onError;return i?!Intl.NumberFormat.supportedLocalesOf(i).length&&a?a(new ME('Missing locale data for locale: "'.concat(i,'" in Intl.NumberFormat. Using default locale: "').concat(s,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(i).length&&a&&a(new ME('Missing locale data for locale: "'.concat(i,'" in Intl.DateTimeFormat. Using default locale: "').concat(s,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(a&&a(new gO('"locale" was not configured, using "'.concat(s,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),r.locale=r.defaultLocale||"en"),FO(r),Ve(Ve({},r),{formatters:n,formatNumber:OO.bind(null,r,n.getNumberFormat),formatNumberToParts:LO.bind(null,r,n.getNumberFormat),formatRelativeTime:DO.bind(null,r,n.getRelativeTimeFormat),formatDate:yO.bind(null,r,n.getDateTimeFormat),formatDateToParts:EO.bind(null,r,n.getDateTimeFormat),formatTime:wO.bind(null,r,n.getDateTimeFormat),formatDateTimeRange:IO.bind(null,r,n.getDateTimeFormat),formatTimeToParts:TO.bind(null,r,n.getDateTimeFormat),formatPlural:RO.bind(null,r,n.getPluralRules),formatMessage:nv.bind(null,r,n),$t:nv.bind(null,r,n),formatList:PO.bind(null,r,n.getListFormat),formatListToParts:eA.bind(null,r,n.getListFormat),formatDisplayName:xO.bind(null,r,n.getDisplayNames)})}function nA(t){NC(t,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var rA=Ve(Ve({},XC),{textComponent:G.Fragment});function UO(t){return function(e){return t(G.Children.toArray(e))}}function rv(t,e){if(t===e)return!0;if(!t||!e)return!1;var n=Object.keys(t),r=Object.keys(e),i=n.length;if(r.length!==i)return!1;for(var s=0;s<i;s++){var a=n[s];if(t[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}var s0=typeof window<"u"&&!window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=G.createContext(null)):G.createContext(null);s0.Consumer;var jO=s0.Provider,zO=jO,$O=s0;function Yt(){var t=G.useContext($O);return nA(t),t}var iv;(function(t){t.formatDate="FormattedDate",t.formatTime="FormattedTime",t.formatNumber="FormattedNumber",t.formatList="FormattedList",t.formatDisplayName="FormattedDisplayName"})(iv||(iv={}));var sv;(function(t){t.formatDate="FormattedDateParts",t.formatTime="FormattedTimeParts",t.formatNumber="FormattedNumberParts",t.formatList="FormattedListParts"})(sv||(sv={}));function iA(t){var e=function(n){var r=Yt(),i=n.value,s=n.children,a=ws(n,["value","children"]),u=typeof i=="string"?new Date(i||0):i,h=t==="formatDate"?r.formatDateToParts(u,a):r.formatTimeToParts(u,a);return s(h)};return e.displayName=sv[t],e}function Ah(t){var e=function(n){var r=Yt(),i=n.value,s=n.children,a=ws(n,["value","children"]),u=r[t](i,a);if(typeof s=="function")return s(u);var h=r.textComponent||G.Fragment;return G.createElement(h,null,u)};return e.displayName=iv[t],e}function vp(t){return{locale:t.locale,timeZone:t.timeZone,fallbackOnEmptyString:t.fallbackOnEmptyString,formats:t.formats,textComponent:t.textComponent,messages:t.messages,defaultLocale:t.defaultLocale,defaultFormats:t.defaultFormats,onError:t.onError,onWarn:t.onWarn,wrapRichTextChunksInFragment:t.wrapRichTextChunksInFragment,defaultRichTextElements:t.defaultRichTextElements}}function sA(t){return t&&Object.keys(t).reduce(function(e,n){var r=t[n];return e[n]=QC(r)?UO(r):r,e},{})}var FE=function(t,e,n,r){for(var i=[],s=4;s<arguments.length;s++)i[s-4]=arguments[s];var a=sA(r),u=nv.apply(void 0,bi([t,e,n,a],i,!1));return Array.isArray(u)?G.Children.toArray(u):u},BE=function(t,e){var n=t.defaultRichTextElements,r=ws(t,["defaultRichTextElements"]),i=sA(n),s=BO(Ve(Ve(Ve({},rA),r),{defaultRichTextElements:i}),e),a={locale:s.locale,timeZone:s.timeZone,fallbackOnEmptyString:s.fallbackOnEmptyString,formats:s.formats,defaultLocale:s.defaultLocale,defaultFormats:s.defaultFormats,messages:s.messages,onError:s.onError,defaultRichTextElements:i};return Ve(Ve({},s),{formatMessage:FE.bind(null,a,s.formatters),$t:FE.bind(null,a,s.formatters)})},HO=function(t){ri(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.cache=JC(),n.state={cache:n.cache,intl:BE(vp(n.props),n.cache),prevConfig:vp(n.props)},n}return e.getDerivedStateFromProps=function(n,r){var i=r.prevConfig,s=r.cache,a=vp(n);return rv(i,a)?null:{intl:BE(a,s),prevConfig:a}},e.prototype.render=function(){return nA(this.state.intl),G.createElement(zO,{value:this.state.intl},this.props.children)},e.displayName="IntlProvider",e.defaultProps=rA,e}(G.PureComponent);const qO=HO;function GO(t,e){var n=t.values,r=ws(t,["values"]),i=e.values,s=ws(e,["values"]);return rv(i,n)&&rv(r,s)}function oA(t){var e=Yt(),n=e.formatMessage,r=e.textComponent,i=r===void 0?G.Fragment:r,s=t.id,a=t.description,u=t.defaultMessage,h=t.values,g=t.children,_=t.tagName,w=_===void 0?i:_,T=t.ignoreTag,E={id:s,description:a,defaultMessage:u},z=n(E,h,{ignoreTag:T});return typeof g=="function"?g(Array.isArray(z)?z:[z]):w?G.createElement(w,null,G.Children.toArray(z)):G.createElement(G.Fragment,null,z)}oA.displayName="FormattedMessage";var aA=G.memo(oA,GO);aA.displayName="MemoizedFormattedMessage";const wt=aA;Ah("formatDate");Ah("formatTime");Ah("formatNumber");Ah("formatList");Ah("formatDisplayName");iA("formatDate");iA("formatTime");const fe=Ih("div",({css:t,...e})=>({css:fN({display:"flex",minWidth:0,minHeight:0,flex:"none",alignSelf:"auto",alignItems:"stretch",flexDirection:"column",justifyContent:"flex-start",...t}),...e})),lA=t=>{const e=G.useContext(Ti);return R.jsxs(fe,{as:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 467.27 512",...t,children:[R.jsx("polygon",{fill:e.colors.shape,points:"352.33 159.67 432.16 239.45 432.16 399.13 319.29 512 93.55 512 159.67 445.87 0 286.25 319.29 286.25 272.55 239.45 272.55 79.84 352.33 0 465.26 112.87 352.33 112.87 352.33 159.67"}),R.jsxs("g",{children:[R.jsx("polygon",{fill:e.colors.pieces.mt1,points:"272.57 79.84 272.57 239.45 352.36 319.29 432.19 399.13 432.19 239.45 352.36 159.67 352.36 112.87 465.29 112.87 352.36 0 272.57 79.84"}),R.jsx("polygon",{fill:e.colors.pieces.st1,points:"93.58 512 319.32 512 432.19 399.13 319.32 286.25 93.58 512"}),R.jsx("polygon",{fill:e.colors.pieces.lt2,points:"159.67 445.87 239.48 366.05 319.31 286.24 0.03 286.24 159.67 445.87"})]})]})};var UE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},WO=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],u=t[n++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},cA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,u=a?t[i+1]:0,h=i+2<t.length,g=h?t[i+2]:0,_=s>>2,w=(s&3)<<4|u>>4;let T=(u&15)<<2|g>>6,E=g&63;h||(E=64,a||(T=64)),r.push(n[_],n[w],n[T],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(uA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):WO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const g=i<t.length?n[t.charAt(i)]:64;++i;const w=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||u==null||g==null||w==null)throw new KO;const T=s<<2|u>>4;if(r.push(T),g!==64){const E=u<<4&240|g>>2;if(r.push(E),w!==64){const z=g<<6&192|w;r.push(z)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class KO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QO=function(t){const e=uA(t);return cA.encodeByteArray(e,!0)},zf=function(t){return QO(t).replace(/\./g,"")},hA=function(t){try{return cA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!YO(n)||(t[n]=$f(t[n],e[n]));return t}function YO(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=()=>XO().__FIREBASE_DEFAULTS__,ZO=()=>{if(typeof process>"u"||typeof UE>"u")return;const t=UE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},eL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&hA(t[1]);return e&&JSON.parse(e)},o0=()=>{try{return JO()||ZO()||eL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dA=()=>{var t;return(t=o0())===null||t===void 0?void 0:t.config},tL=t=>{var e;return(e=o0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nL=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),u="";return[zf(JSON.stringify(n)),zf(JSON.stringify(a)),u].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qt())}function a0(){var t;const e=(t=o0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sL(){return typeof self=="object"&&self.self===self}function fA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function l0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gA(){const t=Qt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function oL(){return!a0()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zc(){try{return typeof indexedDB=="object"}catch{return!1}}function aL(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="FirebaseError";class ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lL,Object.setPrototypeOf(this,ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,La.prototype.create)}}class La{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?uL(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new ur(i,u,r)}}function uL(t,e){return t.replace(cL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const cL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ov(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(zE(s)&&zE(a)){if(!ov(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function zE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Qu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function mA(t,e){const n=new dL(t,e);return n.subscribe.bind(n)}class dL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");fL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=yp),i.error===void 0&&(i.error=yp),i.complete===void 0&&(i.complete=yp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(t){return t&&t._delegate?t._delegate:t}class Wi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new nL;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pL(e))try{this.getOrInitializeService({instanceIdentifier:qo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=qo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qo){return this.instances.has(e)}getOptions(e=qo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:mL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=qo){return this.component?this.component.multipleInstances?e:qo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mL(t){return t===qo?void 0:t}function pL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=[];var ot;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ot||(ot={}));const pA={debug:ot.DEBUG,verbose:ot.VERBOSE,info:ot.INFO,warn:ot.WARN,error:ot.ERROR,silent:ot.SILENT},vL=ot.INFO,yL={[ot.DEBUG]:"log",[ot.VERBOSE]:"log",[ot.INFO]:"info",[ot.WARN]:"warn",[ot.ERROR]:"error"},wL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=yL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wg{constructor(e){this.name=e,this._logLevel=vL,this._logHandler=wL,this._userLogHandler=null,u0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ot))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ot.DEBUG,...e),this._logHandler(this,ot.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ot.VERBOSE,...e),this._logHandler(this,ot.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ot.INFO,...e),this._logHandler(this,ot.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ot.WARN,...e),this._logHandler(this,ot.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ot.ERROR,...e),this._logHandler(this,ot.ERROR,...e)}}function IL(t){u0.forEach(e=>{e.setLogLevel(t)})}function EL(t,e){for(const n of u0){let r=null;e&&e.level&&(r=pA[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...a)=>{const u=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&t({level:ot[s].toLowerCase(),message:u,args:a,type:i.name})}}}const TL=(t,e)=>e.some(n=>t instanceof n);let $E,HE;function SL(){return $E||($E=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xL(){return HE||(HE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _A=new WeakMap,av=new WeakMap,vA=new WeakMap,wp=new WeakMap,c0=new WeakMap;function CL(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(io(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&_A.set(n,t)}).catch(()=>{}),c0.set(e,t),e}function AL(t){if(av.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});av.set(t,e)}let lv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return av.get(t);if(e==="objectStoreNames")return t.objectStoreNames||vA.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return io(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function PL(t){lv=t(lv)}function bL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ip(this),e,...n);return vA.set(r,e.sort?e.sort():[e]),io(r)}:xL().includes(t)?function(...e){return t.apply(Ip(this),e),io(_A.get(this))}:function(...e){return io(t.apply(Ip(this),e))}}function RL(t){return typeof t=="function"?bL(t):(t instanceof IDBTransaction&&AL(t),TL(t,SL())?new Proxy(t,lv):t)}function io(t){if(t instanceof IDBRequest)return CL(t);if(wp.has(t))return wp.get(t);const e=RL(t);return e!==t&&(wp.set(t,e),c0.set(e,t)),e}const Ip=t=>c0.get(t);function kL(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),u=io(a);return r&&a.addEventListener("upgradeneeded",h=>{r(io(a.result),h.oldVersion,h.newVersion,io(a.transaction),h)}),n&&a.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),u.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),u}const NL=["get","getKey","getAll","getAllKeys","count"],DL=["put","add","delete","clear"],Ep=new Map;function qE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ep.get(e))return Ep.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=DL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||NL.includes(n)))return;const s=async function(a,...u){const h=this.transaction(a,i?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(await Promise.all([g[n](...u),i&&h.done]))[0]};return Ep.set(e,s),s}PL(t=>({...t,get:(e,n,r)=>qE(e,n)||t.get(e,n,r),has:(e,n)=>!!qE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(OL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function OL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const uv="@firebase/app",GE="0.9.24";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new Wg("@firebase/app"),LL="@firebase/app-compat",VL="@firebase/analytics-compat",FL="@firebase/analytics",BL="@firebase/app-check-compat",UL="@firebase/app-check",jL="@firebase/auth",zL="@firebase/auth-compat",$L="@firebase/database",HL="@firebase/database-compat",qL="@firebase/functions",GL="@firebase/functions-compat",WL="@firebase/installations",KL="@firebase/installations-compat",QL="@firebase/messaging",YL="@firebase/messaging-compat",XL="@firebase/performance",JL="@firebase/performance-compat",ZL="@firebase/remote-config",eV="@firebase/remote-config-compat",tV="@firebase/storage",nV="@firebase/storage-compat",rV="@firebase/firestore",iV="@firebase/firestore-compat",sV="firebase",oV="10.7.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo="[DEFAULT]",aV={[uv]:"fire-core",[LL]:"fire-core-compat",[FL]:"fire-analytics",[VL]:"fire-analytics-compat",[UL]:"fire-app-check",[BL]:"fire-app-check-compat",[jL]:"fire-auth",[zL]:"fire-auth-compat",[$L]:"fire-rtdb",[HL]:"fire-rtdb-compat",[qL]:"fire-fn",[GL]:"fire-fn-compat",[WL]:"fire-iid",[KL]:"fire-iid-compat",[QL]:"fire-fcm",[YL]:"fire-fcm-compat",[XL]:"fire-perf",[JL]:"fire-perf-compat",[ZL]:"fire-rc",[eV]:"fire-rc-compat",[tV]:"fire-gcs",[nV]:"fire-gcs-compat",[rV]:"fire-fst",[iV]:"fire-fst-compat","fire-js":"fire-js",[sV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co=new Map,$c=new Map;function Hf(t,e){try{t.container.addComponent(e)}catch(n){wa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function yA(t,e){t.container.addOrOverwriteComponent(e)}function ho(t){const e=t.name;if($c.has(e))return wa.debug(`There were multiple attempts to register component ${e}.`),!1;$c.set(e,t);for(const n of co.values())Hf(n,t);return!0}function wA(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function lV(t,e,n=uo){wA(t,e).clearInstance(n)}function uV(){$c.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},gs=new La("app","Firebase",cV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hV=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gs.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=oV;function h0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:uo,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw gs.create("bad-app-name",{appName:String(i)});if(n||(n=dA()),!n)throw gs.create("no-options");const s=co.get(i);if(s){if(ov(n,s.options)&&ov(r,s.config))return s;throw gs.create("duplicate-app",{appName:i})}const a=new _L(i);for(const h of $c.values())a.addComponent(h);const u=new hV(n,r,a);return co.set(i,u),u}function dV(t=uo){const e=co.get(t);if(!e&&t===uo&&dA())return h0();if(!e)throw gs.create("no-app",{appName:t});return e}function fV(){return Array.from(co.values())}async function IA(t){const e=t.name;co.has(e)&&(co.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Hi(t,e,n){var r;let i=(r=aV[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wa.warn(u.join(" "));return}ho(new Wi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function EA(t,e){if(t!==null&&typeof t!="function")throw gs.create("invalid-log-argument");EL(t,e)}function TA(t){IL(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV="firebase-heartbeat-database",mV=1,Hc="firebase-heartbeat-store";let Tp=null;function SA(){return Tp||(Tp=kL(gV,mV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Hc)}}}).catch(t=>{throw gs.create("idb-open",{originalErrorMessage:t.message})})),Tp}async function pV(t){try{return await(await SA()).transaction(Hc).objectStore(Hc).get(xA(t))}catch(e){if(e instanceof ur)wa.warn(e.message);else{const n=gs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wa.warn(n.message)}}}async function WE(t,e){try{const r=(await SA()).transaction(Hc,"readwrite");await r.objectStore(Hc).put(e,xA(t)),await r.done}catch(n){if(n instanceof ur)wa.warn(n.message);else{const r=gs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});wa.warn(r.message)}}}function xA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=1024,vV=30*24*60*60*1e3;class yV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new IV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=KE();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const u=new Date(a.date).valueOf();return Date.now()-u<=vV}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=KE(),{heartbeatsToSend:r,unsentEntries:i}=wV(this._heartbeatsCache.heartbeats),s=zf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function KE(){return new Date().toISOString().substring(0,10)}function wV(t,e=_V){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),QE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),QE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class IV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zc()?aL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await pV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return WE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return WE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function QE(t){return zf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(t){ho(new Wi("platform-logger",e=>new ML(e),"PRIVATE")),ho(new Wi("heartbeat",e=>new yV(e),"PRIVATE")),Hi(uv,GE,t),Hi(uv,GE,"esm2017"),Hi("fire-js","")}EV("");const TV=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:ur,SDK_VERSION:Ao,_DEFAULT_ENTRY_NAME:uo,_addComponent:Hf,_addOrOverwriteComponent:yA,_apps:co,_clearComponents:uV,_components:$c,_getProvider:wA,_registerComponent:ho,_removeServiceInstance:lV,deleteApp:IA,getApp:dV,getApps:fV,initializeApp:h0,onLog:EA,registerVersion:Hi,setLogLevel:TA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e,n){this._delegate=e,this.firebase=n,Hf(e,new Wi("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),IA(this._delegate)))}_getService(e,n=uo){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=uo){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Hf(this._delegate,e)}_addOrOverwriteComponent(e){yA(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},YE=new La("app-compat","Firebase",xV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CV(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:Hi,setLogLevel:TA,onLog:EA,apps:null,SDK_VERSION:Ao,INTERNAL:{registerComponent:u,removeApp:r,useAsService:h,modularAPIs:TV}};n.default=n,Object.defineProperty(n,"apps",{get:a});function r(g){delete e[g]}function i(g){if(g=g||uo,!jE(e,g))throw YE.create("no-app",{appName:g});return e[g]}i.App=t;function s(g,_={}){const w=h0(g,_);if(jE(e,w.name))return e[w.name];const T=new t(w,n);return e[w.name]=T,T}function a(){return Object.keys(e).map(g=>e[g])}function u(g){const _=g.name,w=_.replace("-compat","");if(ho(g)&&g.type==="PUBLIC"){const T=(E=i())=>{if(typeof E[w]!="function")throw YE.create("invalid-app-argument",{appName:_});return E[w]()};g.serviceProps!==void 0&&$f(T,g.serviceProps),n[w]=T,t.prototype[w]=function(...E){return this._getService.bind(this,_).apply(this,g.multipleInstances?E:[])}}return g.type==="PUBLIC"?n[w]:null}function h(g,_){return _==="serverAuth"?null:_}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(){const t=CV(SV);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:CA,extendNamespace:e,createSubscribe:mA,ErrorFactory:La,deepExtend:$f});function e(n){$f(t,n)}return t}const AV=CA();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Wg("@firebase/app-compat"),PV="@firebase/app-compat",bV="0.2.24";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RV(t){Hi(PV,bV,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(sL()&&self.firebase!==void 0){XE.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&XE.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Rt=AV;RV();var kV="firebase",NV="10.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rt.registerVersion(kV,NV,"app-compat");const Nu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Ga={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function AA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MV=DV,OV=AA,PA=new La("auth","Firebase",AA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf=new Wg("@firebase/auth");function LV(t,...e){qf.logLevel<=ot.WARN&&qf.warn(`Auth (${Ao}): ${t}`,...e)}function ef(t,...e){qf.logLevel<=ot.ERROR&&qf.error(`Auth (${Ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(t,...e){throw d0(t,...e)}function Fn(t,...e){return d0(t,...e)}function bA(t,e,n){const r=Object.assign(Object.assign({},OV()),{[e]:n});return new La("auth","Firebase",r).create(e,{appName:t.name})}function uu(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&jn(t,"argument-error"),bA(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function d0(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return PA.create(t,...e)}function Ee(t,e,...n){if(!t)throw d0(e,...n)}function Li(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ef(e),new Error(e)}function wi(t,e){t||Li(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function f0(){return JE()==="http:"||JE()==="https:"}function JE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(f0()||fA()||"connection"in navigator)?navigator.onLine:!0}function FV(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,n){this.shortDelay=e,this.longDelay=n,wi(n>e,"Short delay should be less than long delay!"),this.isMobile=iL()||l0()}get(){return VV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e){wi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV=new Ph(3e4,6e4);function nn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function rn(t,e,n,r,i={}){return kA(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const u=lu(Object.assign({key:t.config.apiKey},a)).slice(1),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode),RA.fetch()(NA(t,t.config.apiHost,n,u),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function kA(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},BV),e);try{const i=new zV(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Yu(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const u=s.ok?a.errorMessage:a.error.message,[h,g]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yu(t,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Yu(t,"email-already-in-use",a);if(h==="USER_DISABLED")throw Yu(t,"user-disabled",a);const _=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw bA(t,_,g);jn(t,_)}}catch(i){if(i instanceof ur)throw i;jn(t,"network-request-failed",{message:String(i)})}}async function xs(t,e,n,r,i={}){const s=await rn(t,e,n,r,i);return"mfaPendingCredential"in s&&jn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function NA(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?g0(t.config,i):`${t.config.apiScheme}://${i}`}function jV(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Fn(this.auth,"network-request-failed")),UV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Fn(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(t){return t!==void 0&&t.getResponse!==void 0}function eT(t){return t!==void 0&&t.enterprise!==void 0}class $V{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return jV(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HV(t){return(await rn(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function qV(t,e){return rn(t,"GET","/v2/recaptchaConfig",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GV(t,e){return rn(t,"POST","/v1/accounts:delete",e)}async function WV(t,e){return rn(t,"POST","/v1/accounts:update",e)}async function KV(t,e){return rn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QV(t,e=!1){const n=qe(t),r=await n.getIdToken(e),i=Kg(r);Ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:gc(Sp(i.auth_time)),issuedAtTime:gc(Sp(i.iat)),expirationTime:gc(Sp(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Sp(t){return Number(t)*1e3}function Kg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ef("JWT malformed, contained fewer than 3 sections"),null;try{const i=hA(n);return i?JSON.parse(i):(ef("Failed to decode base64 JWT payload"),null)}catch(i){return ef("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function YV(t){const e=Kg(t);return Ee(e,"internal-error"),Ee(typeof e.exp<"u","internal-error"),Ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Is(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ur&&XV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function XV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=gc(this.lastLoginAt),this.creationTime=gc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gc(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Is(t,KV(n,{idToken:r}));Ee(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?tF(s.providerUserInfo):[],u=eF(t.providerData,a),h=t.isAnonymous,g=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),_=h?g:!1,w={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new DA(s.createdAt,s.lastLoginAt),isAnonymous:_};Object.assign(t,w)}async function ZV(t){const e=qe(t);await Gc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eF(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function tF(t){return t.map(e=>{var{providerId:n}=e,r=ws(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nF(t,e){const n=await kA(t,{},async()=>{const r=lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=NA(t,i,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",RA.fetch()(a,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function rF(t,e){return rn(t,"POST","/v2/accounts:revokeToken",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ee(e.idToken,"internal-error"),Ee(typeof e.idToken<"u","internal-error"),Ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return Ee(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await nF(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new Wc;return r&&(Ee(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ee(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ee(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wc,this.toJSON())}_performRefresh(){return Li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(t,e){Ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ca{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=ws(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new DA(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Is(this,this.stsTokenManager.getToken(this.auth,e));return Ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return QV(this,e)}reload(){return ZV(this)}_assign(e){this!==e&&(Ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ca(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Gc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Is(this,GV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,a,u,h,g,_;const w=(r=n.displayName)!==null&&r!==void 0?r:void 0,T=(i=n.email)!==null&&i!==void 0?i:void 0,E=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,z=(a=n.photoURL)!==null&&a!==void 0?a:void 0,j=(u=n.tenantId)!==null&&u!==void 0?u:void 0,J=(h=n._redirectEventId)!==null&&h!==void 0?h:void 0,V=(g=n.createdAt)!==null&&g!==void 0?g:void 0,B=(_=n.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:U,emailVerified:Z,isAnonymous:ne,providerData:te,stsTokenManager:ae}=n;Ee(U&&ae,e,"internal-error");const ce=Wc.fromJSON(this.name,ae);Ee(typeof U=="string",e,"internal-error"),Ds(w,e.name),Ds(T,e.name),Ee(typeof Z=="boolean",e,"internal-error"),Ee(typeof ne=="boolean",e,"internal-error"),Ds(E,e.name),Ds(z,e.name),Ds(j,e.name),Ds(J,e.name),Ds(V,e.name),Ds(B,e.name);const _e=new ca({uid:U,auth:e,email:T,emailVerified:Z,displayName:w,isAnonymous:ne,photoURL:z,phoneNumber:E,tenantId:j,stsTokenManager:ce,createdAt:V,lastLoginAt:B});return te&&Array.isArray(te)&&(_e.providerData=te.map(me=>Object.assign({},me))),J&&(_e._redirectEventId=J),_e}static async _fromIdTokenResponse(e,n,r=!1){const i=new Wc;i.updateFromServerResponse(n);const s=new ca({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Gc(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT=new Map;function Or(t){wi(t instanceof Function,"Expected a class definition");let e=tT.get(t);return e?(wi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,tT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}MA.type="NONE";const Hl=MA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(t,e,n){return`firebase:${t}:${e}:${n}`}class Pl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=ha(this.userKey,i.apiKey,s),this.fullPersistenceKey=ha("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ca._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Pl(Or(Hl),e,r);const i=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let s=i[0]||Or(Hl);const a=ha(r,e.config.apiKey,e.name);let u=null;for(const g of n)try{const _=await g._get(a);if(_){const w=ca._fromJSON(e,_);g!==s&&(u=w),s=g;break}}catch{}const h=i.filter(g=>g._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Pl(s,e,r):(s=h[0],u&&await s._set(a,u.toJSON()),await Promise.all(n.map(async g=>{if(g!==s)try{await g._remove(a)}catch{}})),new Pl(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(FA(e))return"Blackberry";if(BA(e))return"Webos";if(m0(e))return"Safari";if((e.includes("chrome/")||LA(e))&&!e.includes("edge/"))return"Chrome";if(bh(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function OA(t=Qt()){return/firefox\//i.test(t)}function m0(t=Qt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function LA(t=Qt()){return/crios\//i.test(t)}function VA(t=Qt()){return/iemobile/i.test(t)}function bh(t=Qt()){return/android/i.test(t)}function FA(t=Qt()){return/blackberry/i.test(t)}function BA(t=Qt()){return/webos/i.test(t)}function cu(t=Qt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function iF(t=Qt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function sF(t=Qt()){var e;return cu(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function oF(){return gA()&&document.documentMode===10}function UA(t=Qt()){return cu(t)||bh(t)||BA(t)||FA(t)||/windows phone/i.test(t)||VA(t)}function aF(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(t,e=[]){let n;switch(t){case"Browser":n=nT(Qt());break;case"Worker":n=`${nT(Qt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,u)=>{try{const h=e(s);a(h)}catch(h){u(h)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uF(t,e={}){return rn(t,"GET","/v2/passwordPolicy",nn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=6;class hF{constructor(e){var n,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:cF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,a,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(n=h.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rT(this),this.idTokenSubscription=new rT(this),this.beforeStateQueue=new lF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Or(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Pl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===u)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Gc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?qe(e):null;return n&&Ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uF(this),n=new hF(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new La("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await rF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Or(e)||this._popupRedirectResolver;Ee(n,this,"argument-error"),this.redirectPersistenceManager=await Pl.create(this,[Or(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ee(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const h=e.addObserver(n,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(n);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&LV(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Zt(t){return qe(t)}class rT{constructor(e){this.auth=e,this.observer=null,this.addObserver=mA(n=>this.observer=n)}get next(){return Ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function p0(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Fn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",fF().appendChild(r)})}function zA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const gF="https://www.google.com/recaptcha/enterprise.js?render=",mF="recaptcha-enterprise",pF="NO_RECAPTCHA";class _F{constructor(e){this.type=mF,this.auth=Zt(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,u)=>{qV(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const g=new $V(h);return s.tenantId==null?s._agentRecaptchaConfig=g:s._tenantRecaptchaConfigs[s.tenantId]=g,a(g.siteKey)}}).catch(h=>{u(h)})})}function i(s,a,u){const h=window.grecaptcha;eT(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(g=>{a(g)}).catch(()=>{a(pF)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(u=>{if(!n&&eT(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}p0(gF+u).then(()=>{i(u,s,a)}).catch(h=>{a(h)})}}).catch(u=>{a(u)})})}}async function iT(t,e,n,r=!1){const i=new _F(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Kc(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await iT(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await iT(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(s)})}function vF(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Or);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function yF(t,e,n){const r=Zt(t);Ee(r._canInitEmulator,r,"emulator-config-failed"),Ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=$A(e),{host:a,port:u}=wF(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||IF()}function $A(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wF(t){const e=$A(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:sT(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:sT(a)}}}function sT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function IF(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Li("not implemented")}_getIdTokenResponse(e){return Li("not implemented")}_linkToIdToken(e,n){return Li("not implemented")}_getReauthenticationResolver(e){return Li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HA(t,e){return rn(t,"POST","/v1/accounts:resetPassword",nn(t,e))}async function EF(t,e){return rn(t,"POST","/v1/accounts:update",e)}async function TF(t,e){return rn(t,"POST","/v1/accounts:signUp",e)}async function SF(t,e){return rn(t,"POST","/v1/accounts:update",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xF(t,e){return xs(t,"POST","/v1/accounts:signInWithPassword",nn(t,e))}async function Qg(t,e){return rn(t,"POST","/v1/accounts:sendOobCode",nn(t,e))}async function CF(t,e){return Qg(t,e)}async function AF(t,e){return Qg(t,e)}async function PF(t,e){return Qg(t,e)}async function bF(t,e){return Qg(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RF(t,e){return xs(t,"POST","/v1/accounts:signInWithEmailLink",nn(t,e))}async function kF(t,e){return xs(t,"POST","/v1/accounts:signInWithEmailLink",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends hu{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Qc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Qc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kc(e,n,"signInWithPassword",xF);case"emailLink":return RF(e,{email:this._email,oobCode:this._password});default:jn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kc(e,r,"signUpPassword",TF);case"emailLink":return kF(e,{idToken:n,email:this._email,oobCode:this._password});default:jn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ms(t,e){return xs(t,"POST","/v1/accounts:signInWithIdp",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF="http://localhost";class Ki extends hu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ki(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):jn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=ws(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Ki(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ms(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ms(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ms(e,n)}buildRequest(){const e={requestUri:NF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=lu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DF(t,e){return rn(t,"POST","/v1/accounts:sendVerificationCode",nn(t,e))}async function MF(t,e){return xs(t,"POST","/v1/accounts:signInWithPhoneNumber",nn(t,e))}async function OF(t,e){const n=await xs(t,"POST","/v1/accounts:signInWithPhoneNumber",nn(t,e));if(n.temporaryProof)throw Yu(t,"account-exists-with-different-credential",n);return n}const LF={USER_NOT_FOUND:"user-not-found"};async function VF(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return xs(t,"POST","/v1/accounts:signInWithPhoneNumber",nn(t,n),LF)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends hu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new da({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new da({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return MF(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return OF(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return VF(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new da({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function BF(t){const e=yl(Qu(t)).link,n=e?yl(Qu(e)).deep_link_id:null,r=yl(Qu(t)).deep_link_id;return(r?yl(Qu(r)).link:null)||r||n||e||t}class Yg{constructor(e){var n,r,i,s,a,u;const h=yl(Qu(e)),g=(n=h.apiKey)!==null&&n!==void 0?n:null,_=(r=h.oobCode)!==null&&r!==void 0?r:null,w=FF((i=h.mode)!==null&&i!==void 0?i:null);Ee(g&&_&&w,"argument-error"),this.apiKey=g,this.operation=w,this.code=_,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const n=BF(e);try{return new Yg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){this.providerId=Po.PROVIDER_ID}static credential(e,n){return Qc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Yg.parseLink(n);return Ee(r,"argument-error"),Qc._fromEmailAndCode(e,r.code,r.tenantId)}}Po.PROVIDER_ID="password";Po.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Po.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends Cs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class bl extends du{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return Ee("providerId"in n&&"signInMethod"in n,"argument-error"),Ki._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Ee(e.idToken||e.accessToken,"argument-error"),Ki._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return bl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return bl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:u}=e;if(!r&&!i&&!n&&!s||!u)return null;try{return new bl(u)._credential({idToken:n,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki extends du{constructor(){super("facebook.com")}static credential(e){return Ki._fromParams({providerId:ki.PROVIDER_ID,signInMethod:ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ki.credentialFromTaggedObject(e)}static credentialFromError(e){return ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ki.credential(e.oauthAccessToken)}catch{return null}}}ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";ki.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ki._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ni.credential(n,r)}catch{return null}}}Ni.GOOGLE_SIGN_IN_METHOD="google.com";Ni.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends du{constructor(){super("github.com")}static credential(e){return Ki._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Di.credential(e.oauthAccessToken)}catch{return null}}}Di.GITHUB_SIGN_IN_METHOD="github.com";Di.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF="http://localhost";class ql extends hu{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return ms(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ms(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ms(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new ql(r,s)}static _create(e,n){return new ql(e,n)}buildRequest(){return{requestUri:UF,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF="saml.";class Gf extends Cs{constructor(e){Ee(e.startsWith(jF),"argument-error"),super(e)}static credentialFromResult(e){return Gf.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Gf.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=ql.fromJSON(e);return Ee(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return ql._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends du{constructor(){super("twitter.com")}static credential(e,n){return Ki._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Mi.credential(n,r)}catch{return null}}}Mi.TWITTER_SIGN_IN_METHOD="twitter.com";Mi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qA(t,e){return xs(t,"POST","/v1/accounts:signUp",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ca._fromIdTokenResponse(e,r,i),a=oT(r);return new ni({user:s,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=oT(r);return new ni({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function oT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zF(t){var e;const n=Zt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new ni({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await qA(n,{returnSecureToken:!0}),i=await ni._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf extends ur{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Wf.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Wf(e,n,r,i)}}function GA(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Wf._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $F(t,e){const n=qe(t);await Xg(!0,n,e);const{providerUserInfo:r}=await WV(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=WA(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function _0(t,e,n=!1){const r=await Is(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ni._forOperation(t,"link",r)}async function Xg(t,e,n){await Gc(e);const r=WA(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";Ee(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KA(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Is(t,GA(r,i,e,t),n);Ee(s.idToken,r,"internal-error");const a=Kg(s.idToken);Ee(a,r,"internal-error");const{sub:u}=a;return Ee(t.uid===u,r,"user-mismatch"),ni._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&jn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QA(t,e,n=!1){const r="signIn",i=await GA(t,r,e),s=await ni._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Jg(t,e){return QA(Zt(t),e)}async function YA(t,e){const n=qe(t);return await Xg(!1,n,e.providerId),_0(n,e)}async function XA(t,e){return KA(qe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HF(t,e){return xs(t,"POST","/v1/accounts:signInWithCustomToken",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(t,e){const n=Zt(t),r=await HF(n,{token:e,returnSecureToken:!0}),i=await ni._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?v0._fromServerResponse(e,n):"totpInfo"in n?y0._fromServerResponse(e,n):jn(e,"internal-error")}}class v0 extends Rh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new v0(n)}}class y0 extends Rh{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new y0(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t,e,n){var r;Ee(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),Ee(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Ee(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Ee(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(t){const e=Zt(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function GF(t,e,n){const r=Zt(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&Zg(r,i,n),await Kc(r,i,"getOobCode",AF)}async function WF(t,e,n){await HA(qe(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&w0(t),r})}async function KF(t,e){await SF(qe(t),{oobCode:e})}async function JA(t,e){const n=qe(t),r=await HA(n,{oobCode:e}),i=r.requestType;switch(Ee(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ee(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ee(r.mfaInfo,n,"internal-error");default:Ee(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Rh._fromServerResponse(Zt(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function QF(t,e){const{data:n}=await JA(qe(t),e);return n.email}async function YF(t,e,n){const r=Zt(t),a=await Kc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qA).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&w0(t),h}),u=await ni._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function XF(t,e,n){return Jg(qe(t),Po.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&w0(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JF(t,e,n){const r=Zt(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,u){Ee(u.handleCodeInApp,r,"argument-error"),u&&Zg(r,a,u)}s(i,n),await Kc(r,i,"getOobCode",PF)}function ZF(t,e){const n=Yg.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function e5(t,e,n){const r=qe(t),i=Po.credentialWithLink(e,n||qc());return Ee(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Jg(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(t,e){return rn(t,"POST","/v1/accounts:createAuthUri",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n5(t,e){const n=f0()?qc():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await t5(qe(t),r);return i||[]}async function r5(t,e){const n=qe(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&Zg(n.auth,i,e);const{email:s}=await CF(n.auth,i);s!==t.email&&await t.reload()}async function i5(t,e,n){const r=qe(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&Zg(r.auth,s,n);const{email:a}=await bF(r.auth,s);a!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s5(t,e){return rn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o5(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=qe(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await Is(r,s5(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const u=r.providerData.find(({providerId:h})=>h==="password");u&&(u.displayName=r.displayName,u.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function a5(t,e){return ZA(qe(t),e,null)}function l5(t,e){return ZA(qe(t),null,e)}async function ZA(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const a=await Is(t,EF(r,s));await t._updateTokensIfNecessary(a,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u5(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const a=(n=(e=Kg(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(a){const u=a!=="anonymous"&&a!=="custom"?a:null;return new Rl(s,u)}}if(!r)return null;switch(r){case"facebook.com":return new c5(s,i);case"github.com":return new h5(s,i);case"google.com":return new d5(s,i);case"twitter.com":return new f5(s,i,t.screenName||null);case"custom":case"anonymous":return new Rl(s,null);default:return new Rl(s,r,i)}}class Rl{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class eP extends Rl{constructor(e,n,r,i){super(e,n,r),this.username=i}}class c5 extends Rl{constructor(e,n){super(e,"facebook.com",n)}}class h5 extends eP{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class d5 extends Rl{constructor(e,n){super(e,"google.com",n)}}class f5 extends eP{constructor(e,n,r){super(e,"twitter.com",n,r)}}function g5(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:u5(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new na("enroll",e,n)}static _fromMfaPendingCredential(e){return new na("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return na._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return na._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Zt(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(u=>Rh._fromServerResponse(r,u));Ee(i.mfaPendingCredential,r,"internal-error");const a=na._fromMfaPendingCredential(i.mfaPendingCredential);return new I0(a,s,async u=>{const h=await u._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const g=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(n.operationType){case"signIn":const _=await ni._fromIdTokenResponse(r,n.operationType,g);return await r._updateCurrentUser(_.user),_;case"reauthenticate":return Ee(n.user,r,"internal-error"),ni._forOperation(n.user,n.operationType,g);default:jn(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function m5(t,e){var n;const r=qe(t),i=e;return Ee(e.customData.operationType,r,"argument-error"),Ee((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),I0._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t,e){return rn(t,"POST","/v2/accounts/mfaEnrollment:start",nn(t,e))}function _5(t,e){return rn(t,"POST","/v2/accounts/mfaEnrollment:finalize",nn(t,e))}function v5(t,e){return rn(t,"POST","/v2/accounts/mfaEnrollment:withdraw",nn(t,e))}class E0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Rh._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new E0(e)}async getSession(){return na._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await Is(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Is(this.user,v5(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const xp=new WeakMap;function y5(t){const e=qe(t);return xp.has(e)||xp.set(e,E0._fromUser(e)),xp.get(e)}const Kf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Kf,"1"),this.storage.removeItem(Kf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(){const t=Qt();return m0(t)||cu(t)}const I5=1e3,E5=10;class nP extends tP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=w5()&&aF(),this.fallbackToPolling=UA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,u,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);oF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,E5):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},I5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}nP.type="LOCAL";const T0=nP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP extends tP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}rP.type="SESSION";const Ia=rP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T5(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new em(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(a).map(async g=>g(n.origin,s)),h=await T5(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}em.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,h)=>{const g=kh("",20);i.port1.start();const _=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(w){const T=w;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(_),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(T.data.response);break;default:clearTimeout(_),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return window}function x5(t){fn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(){return typeof fn().WorkerGlobalScope<"u"&&typeof fn().importScripts=="function"}async function C5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function A5(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function P5(){return S0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP="firebaseLocalStorageDb",b5=1,Qf="firebaseLocalStorage",sP="fbase_key";class Nh{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function tm(t,e){return t.transaction([Qf],e?"readwrite":"readonly").objectStore(Qf)}function R5(){const t=indexedDB.deleteDatabase(iP);return new Nh(t).toPromise()}function cv(){const t=indexedDB.open(iP,b5);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Qf,{keyPath:sP})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Qf)?e(r):(r.close(),await R5(),e(await cv()))})})}async function aT(t,e,n){const r=tm(t,!0).put({[sP]:e,value:n});return new Nh(r).toPromise()}async function k5(t,e){const n=tm(t,!1).get(e),r=await new Nh(n).toPromise();return r===void 0?null:r.value}function lT(t,e){const n=tm(t,!0).delete(e);return new Nh(n).toPromise()}const N5=800,D5=3;class oP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>D5)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return S0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=em._getInstance(P5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await C5(),!this.activeServiceWorker)return;this.sender=new S5(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||A5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cv();return await aT(e,Kf,"1"),await lT(e,Kf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>aT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>k5(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>lT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=tm(i,!1).getAll();return new Nh(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),N5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}oP.type="LOCAL";const Yc=oP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(t,e){return rn(t,"POST","/v2/accounts/mfaSignIn:start",nn(t,e))}function O5(t,e){return rn(t,"POST","/v2/accounts/mfaSignIn:finalize",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=500,V5=6e4,Cd=1e12;class F5{constructor(e){this.auth=e,this.counter=Cd,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new B5(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||Cd;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||Cd;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||Cd;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class B5{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Ee(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=U5(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},V5)},L5))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function U5(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp=zA("rcb"),j5=new Ph(3e4,6e4),z5="https://www.google.com/recaptcha/api.js?";class $5{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=fn().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return Ee(H5(n),e,"argument-error"),this.shouldResolveImmediately(n)&&ZE(fn().grecaptcha)?Promise.resolve(fn().grecaptcha):new Promise((r,i)=>{const s=fn().setTimeout(()=>{i(Fn(e,"network-request-failed"))},j5.get());fn()[Cp]=()=>{fn().clearTimeout(s),delete fn()[Cp];const u=fn().grecaptcha;if(!u||!ZE(u)){i(Fn(e,"internal-error"));return}const h=u.render;u.render=(g,_)=>{const w=h(g,_);return this.counter++,w},this.hostLanguage=n,r(u)};const a=`${z5}?${lu({onload:Cp,render:"explicit",hl:n})}`;p0(a).catch(()=>{clearTimeout(s),i(Fn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=fn().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function H5(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class q5{async load(e){return new F5(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP="recaptcha",G5={theme:"light",type:"image"};let W5=class{constructor(e,n,r=Object.assign({},G5)){this.parameters=r,this.type=aP,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Zt(e),this.isInvisible=this.parameters.size==="invisible",Ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;Ee(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new q5:new $5,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Ee(!this.parameters.sitekey,this.auth,"argument-error"),Ee(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=fn()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){Ee(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ee(f0()&&!S0(),this.auth,"internal-error"),await K5(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await HV(this.auth);Ee(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ee(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function K5(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=da._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Q5(t,e,n){const r=Zt(t),i=await nm(r,e,qe(n));return new x0(i,s=>Jg(r,s))}async function Y5(t,e,n){const r=qe(t);await Xg(!1,r,"phone");const i=await nm(r.auth,e,qe(n));return new x0(i,s=>YA(r,s))}async function X5(t,e,n){const r=qe(t),i=await nm(r.auth,e,qe(n));return new x0(i,s=>XA(r,s))}async function nm(t,e,n){var r;const i=await n.verify();try{Ee(typeof i=="string",t,"argument-error"),Ee(n.type===aP,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return Ee(a.type==="enroll",t,"internal-error"),(await p5(t,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{Ee(a.type==="signin",t,"internal-error");const u=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return Ee(u,t,"missing-multi-factor-info"),(await M5(t,{mfaPendingCredential:a.credential,mfaEnrollmentId:u,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await DF(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{n._reset()}}async function J5(t,e){await _0(qe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ea=class tf{constructor(e){this.providerId=tf.PROVIDER_ID,this.auth=Zt(e)}verifyPhoneNumber(e,n){return nm(this.auth,e,qe(n))}static credential(e,n){return da._fromVerification(e,n)}static credentialFromResult(e){const n=e;return tf.credentialFromTaggedObject(n)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?da._fromTokenResponse(n,r):null}};Ea.PROVIDER_ID="phone";Ea.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t,e){return e?Or(e):(Ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends hu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ms(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ms(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ms(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Z5(t){return QA(t.auth,new C0(t),t.bypassAuthState)}function e4(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),KA(n,new C0(t),t.bypassAuthState)}async function t4(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),_0(n,new C0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Z5;case"linkViaPopup":case"linkViaRedirect":return t4;case"reauthViaPopup":case"reauthViaRedirect":return e4;default:jn(this.auth,"internal-error")}}resolve(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new Ph(2e3,1e4);async function r4(t,e,n){const r=Zt(t);uu(t,e,Cs);const i=Va(r,n);return new cs(r,"signInViaPopup",e,i).executeNotNull()}async function i4(t,e,n){const r=qe(t);uu(r.auth,e,Cs);const i=Va(r.auth,n);return new cs(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function s4(t,e,n){const r=qe(t);uu(r.auth,e,Cs);const i=Va(r.auth,n);return new cs(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class cs extends lP{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,cs.currentPopupAction&&cs.currentPopupAction.cancel(),cs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ee(e,this.auth,"internal-error"),e}async onExecution(){wi(this.filter.length===1,"Popup operations only handle one event");const e=kh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,cs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,n4.get())};e()}}cs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4="pendingRedirect",mc=new Map;class a4 extends lP{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=mc.get(this.auth._key());if(!e){try{const r=await l4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}mc.set(this.auth._key(),e)}return this.bypassAuthState||mc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l4(t,e){const n=cP(e),r=uP(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function A0(t,e){return uP(t)._set(cP(e),"true")}function u4(){mc.clear()}function P0(t,e){mc.set(t._key(),e)}function uP(t){return Or(t._redirectPersistence)}function cP(t){return ha(o4,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(t,e,n){return h4(t,e,n)}async function h4(t,e,n){const r=Zt(t);uu(t,e,Cs),await r._initializationPromise;const i=Va(r,n);return await A0(i,r),i._openRedirect(r,e,"signInViaRedirect")}function d4(t,e,n){return f4(t,e,n)}async function f4(t,e,n){const r=qe(t);uu(r.auth,e,Cs),await r.auth._initializationPromise;const i=Va(r.auth,n);await A0(i,r.auth);const s=await hP(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function g4(t,e,n){return m4(t,e,n)}async function m4(t,e,n){const r=qe(t);uu(r.auth,e,Cs),await r.auth._initializationPromise;const i=Va(r.auth,n);await Xg(!1,r,e.providerId),await A0(i,r.auth);const s=await hP(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function p4(t,e){return await Zt(t)._initializationPromise,rm(t,e,!1)}async function rm(t,e,n=!1){const r=Zt(t),i=Va(r,e),a=await new a4(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function hP(t){const e=kh(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=10*60*1e3;class dP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!v4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!fP(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Fn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_4&&this.cachedEventUids.clear(),this.cachedEventUids.has(uT(e))}saveEventToCache(e){this.cachedEventUids.add(uT(e)),this.lastProcessedEventTime=Date.now()}}function uT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fP({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function v4(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fP(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gP(t,e={}){return rn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,w4=/^https?/;async function I4(t){if(t.config.emulator)return;const{authorizedDomains:e}=await gP(t);for(const n of e)try{if(E4(n))return}catch{}jn(t,"unauthorized-domain")}function E4(t){const e=qc(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!w4.test(n))return!1;if(y4.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=new Ph(3e4,6e4);function cT(){const t=fn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function S4(t){return new Promise((e,n)=>{var r,i,s;function a(){cT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cT(),n(Fn(t,"network-request-failed"))},timeout:T4.get()})}if(!((i=(r=fn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=fn().gapi)===null||s===void 0)&&s.load)a();else{const u=zA("iframefcb");return fn()[u]=()=>{gapi.load?a():n(Fn(t,"network-request-failed"))},p0(`https://apis.google.com/js/api.js?onload=${u}`).catch(h=>n(h))}}).catch(e=>{throw nf=null,e})}let nf=null;function x4(t){return nf=nf||S4(t),nf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4=new Ph(5e3,15e3),A4="__/auth/iframe",P4="emulator/auth/iframe",b4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},R4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function k4(t){const e=t.config;Ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?g0(e,P4):`https://${t.config.authDomain}/${A4}`,r={apiKey:e.apiKey,appName:t.name,v:Ao},i=R4.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${lu(r).slice(1)}`}async function N4(t){const e=await x4(t),n=fn().gapi;return Ee(n,t,"internal-error"),e.open({where:document.body,url:k4(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:b4,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=Fn(t,"network-request-failed"),u=fn().setTimeout(()=>{s(a)},C4.get());function h(){fn().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},M4=500,O4=600,L4="_blank",V4="http://localhost";class hT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function F4(t,e,n,r=M4,i=O4){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const h=Object.assign(Object.assign({},D4),{width:r.toString(),height:i.toString(),top:s,left:a}),g=Qt().toLowerCase();n&&(u=LA(g)?L4:n),OA(g)&&(e=e||V4,h.scrollbars="yes");const _=Object.entries(h).reduce((T,[E,z])=>`${T}${E}=${z},`,"");if(sF(g)&&u!=="_self")return B4(e||"",u),new hT(null);const w=window.open(e||"",u,_);Ee(w,t,"popup-blocked");try{w.focus()}catch{}return new hT(w)}function B4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U4="__/auth/handler",j4="emulator/auth/handler",z4=encodeURIComponent("fac");async function hv(t,e,n,r,i,s){Ee(t.config.authDomain,t,"auth-domain-config-required"),Ee(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ao,eventId:i};if(e instanceof Cs){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",hL(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,w]of Object.entries(s||{}))a[_]=w}if(e instanceof du){const _=e.getScopes().filter(w=>w!=="");_.length>0&&(a.scopes=_.join(","))}t.tenantId&&(a.tid=t.tenantId);const u=a;for(const _ of Object.keys(u))u[_]===void 0&&delete u[_];const h=await t._getAppCheckToken(),g=h?`#${z4}=${encodeURIComponent(h)}`:"";return`${$4(t)}?${lu(u).slice(1)}${g}`}function $4({config:t}){return t.emulator?g0(t,j4):`https://${t.authDomain}/${U4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="webStorageSupport";class H4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ia,this._completeRedirectFn=rm,this._overrideRedirectResult=P0}async _openPopup(e,n,r,i){var s;wi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await hv(e,n,r,qc(),i);return F4(e,a,kh())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await hv(e,n,r,qc(),i);return x5(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(wi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await N4(e),r=new dP(e);return n.register("authEvent",i=>(Ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ap,{type:Ap},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Ap];a!==void 0&&n(!!a),jn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=I4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return UA()||m0()||cu()}}const q4=H4;class G4{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Li("unexpected MultiFactorSessionType")}}}class b0 extends G4{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new b0(e)}_finalizeEnroll(e,n,r){return _5(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return O5(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class mP{constructor(){}static assertion(e){return b0._fromCredential(e)}}mP.FACTOR_ID="phone";var dT="@firebase/auth",fT="1.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Q4(t){ho(new Wi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Ee(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jA(t)},g=new dF(r,i,s,h);return vF(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ho(new Wi("auth-internal",e=>{const n=Zt(e.getProvider("auth").getImmediate());return(r=>new W4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Hi(dT,fT,K4(t)),Hi(dT,fT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=5*60;tL("authIdTokenMaxAge");Q4("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=2e3;async function J4(t,e,n){var r;const{BuildInfo:i}=Ta();wi(e.sessionId,"AuthEvent did not contain a session ID");const s=await r3(e.sessionId),a={};return cu()?a.ibi=i.packageName:bh()?a.apn=i.packageName:jn(t,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,hv(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function Z4(t){const{BuildInfo:e}=Ta(),n={};cu()?n.iosBundleId=e.packageName:bh()?n.androidPackageName=e.packageName:jn(t,"operation-not-supported-in-this-environment"),await gP(t,n)}function e3(t){const{cordova:e}=Ta();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,iF()?"_blank":"_system","location=yes"),n(i)})})}async function t3(t,e,n){const{cordova:r}=Ta();let i=()=>{};try{await new Promise((s,a)=>{let u=null;function h(){var w;s();const T=(w=r.plugins.browsertab)===null||w===void 0?void 0:w.close;typeof T=="function"&&T(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function g(){u||(u=window.setTimeout(()=>{a(Fn(t,"redirect-cancelled-by-user"))},X4))}function _(){(document==null?void 0:document.visibilityState)==="visible"&&g()}e.addPassiveListener(h),document.addEventListener("resume",g,!1),bh()&&document.addEventListener("visibilitychange",_,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",g,!1),document.removeEventListener("visibilitychange",_,!1),u&&window.clearTimeout(u)}})}finally{i()}}function n3(t){var e,n,r,i,s,a,u,h,g,_;const w=Ta();Ee(typeof((e=w==null?void 0:w.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ee(typeof((n=w==null?void 0:w.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ee(typeof((s=(i=(r=w==null?void 0:w.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ee(typeof((h=(u=(a=w==null?void 0:w.cordova)===null||a===void 0?void 0:a.plugins)===null||u===void 0?void 0:u.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ee(typeof((_=(g=w==null?void 0:w.cordova)===null||g===void 0?void 0:g.InAppBrowser)===null||_===void 0?void 0:_.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function r3(t){const e=i3(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function i3(t){if(wi(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3=20;class o3 extends dP{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function a3(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:c3(),postBody:null,tenantId:t.tenantId,error:Fn(t,"no-auth-event")}}function l3(t,e){return dv()._set(fv(t),e)}async function gT(t){const e=await dv()._get(fv(t));return e&&await dv()._remove(fv(t)),e}function u3(t,e){var n,r;const i=d3(e);if(i.includes("/__/auth/callback")){const s=rf(i),a=s.firebaseError?h3(decodeURIComponent(s.firebaseError)):null,u=(r=(n=a==null?void 0:a.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],h=u?Fn(u):null;return h?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function c3(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<s3;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function dv(){return Or(T0)}function fv(t){return ha("authEvent",t.config.apiKey,t.name)}function h3(t){try{return JSON.parse(t)}catch{return null}}function d3(t){const e=rf(t),n=e.link?decodeURIComponent(e.link):void 0,r=rf(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return rf(i).link||i||r||n||t}function rf(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return yl(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=500;class g3{constructor(){this._redirectPersistence=Ia,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=rm,this._overrideRedirectResult=P0}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new o3(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){jn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){n3(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),u4(),await this._originValidation(e);const a=a3(e,r,i);await l3(e,a);const u=await J4(e,a,n),h=await e3(u);return t3(e,s,h)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Z4(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Ta(),a=setTimeout(async()=>{await gT(e),n.onEvent(mT())},f3),u=async _=>{clearTimeout(a);const w=await gT(e);let T=null;w&&(_!=null&&_.url)&&(T=u3(w,_.url)),n.onEvent(T||mT())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,u);const h=i,g=`${s.packageName.toLowerCase()}://`;Ta().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(g)&&u({url:_}),typeof h=="function")try{h(_)}catch(w){console.error(w)}}}}const m3=g3;function mT(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Fn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(t,e){Zt(t)._logFramework(e)}var _3="@firebase/auth-compat",v3="0.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3=1e3;function pc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function w3(){return pc()==="http:"||pc()==="https:"}function pP(t=Qt()){return!!((pc()==="file:"||pc()==="ionic:"||pc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function I3(){return l0()||a0()}function E3(){return gA()&&(document==null?void 0:document.documentMode)===11}function T3(t=Qt()){return/Edge\/\d+/.test(t)}function S3(t=Qt()){return E3()||T3(t)}function _P(){try{const t=self.localStorage,e=kh();if(t)return t.setItem(e,"1"),t.removeItem(e),S3()?zc():!0}catch{return R0()&&zc()}return!1}function R0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Pp(){return(w3()||fA()||pP())&&!I3()&&_P()&&!R0()}function vP(){return pP()&&typeof document<"u"}async function x3(){return vP()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},y3);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function C3(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr={LOCAL:"local",NONE:"none",SESSION:"session"},Du=Ee,yP="persistence";function A3(t,e){if(Du(Object.values(kr).includes(e),t,"invalid-persistence-type"),l0()){Du(e!==kr.SESSION,t,"unsupported-persistence-type");return}if(a0()){Du(e===kr.NONE,t,"unsupported-persistence-type");return}if(R0()){Du(e===kr.NONE||e===kr.LOCAL&&zc(),t,"unsupported-persistence-type");return}Du(e===kr.NONE||_P(),t,"unsupported-persistence-type")}async function gv(t){await t._initializationPromise;const e=wP(),n=ha(yP,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function P3(t,e){const n=wP();if(!n)return[];const r=ha(yP,t,e);switch(n.getItem(r)){case kr.NONE:return[Hl];case kr.LOCAL:return[Yc,Ia];case kr.SESSION:return[Ia];default:return[]}}function wP(){var t;try{return((t=C3())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3=Ee;class Gs{constructor(){this.browserResolver=Or(q4),this.cordovaResolver=Or(m3),this.underlyingResolver=null,this._redirectPersistence=Ia,this._completeRedirectFn=rm,this._overrideRedirectResult=P0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return vP()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return b3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await x3();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IP(t){return t.unwrap()}function R3(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k3(t){return EP(t)}function N3(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new D3(t,m5(t,e))}else if(r){const i=EP(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function EP(t){const{_tokenResponse:e}=t instanceof ur?t.customData:t;if(!e)return null;if(!(t instanceof ur)&&"temporaryProof"in e&&"phoneNumber"in e)return Ea.credentialFromResult(t);const n=e.providerId;if(!n||n===Nu.PASSWORD)return null;let r;switch(n){case Nu.GOOGLE:r=Ni;break;case Nu.FACEBOOK:r=ki;break;case Nu.GITHUB:r=Di;break;case Nu.TWITTER:r=Mi;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:u,nonce:h}=e;return!s&&!a&&!i&&!u?null:u?n.startsWith("saml.")?ql._create(n,u):Ki._fromParams({providerId:n,signInMethod:n,pendingToken:u,idToken:i,accessToken:s}):new bl(n).credential({idToken:i,accessToken:s,rawNonce:h})}return t instanceof ur?r.credentialFromError(t):r.credentialFromResult(t)}function _r(t,e){return e.catch(n=>{throw n instanceof ur&&N3(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:k3(n),additionalUserInfo:g5(n),user:im.getOrCreate(i)}})}async function mv(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>_r(t,n.confirm(r))}}class D3{constructor(e,n){this.resolver=n,this.auth=R3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return _r(IP(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let im=class Xu{constructor(e){this._delegate=e,this.multiFactor=y5(e)}static getOrCreate(e){return Xu.USER_MAP.has(e)||Xu.USER_MAP.set(e,new Xu(e)),Xu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return _r(this.auth,YA(this._delegate,e))}async linkWithPhoneNumber(e,n){return mv(this.auth,Y5(this._delegate,e,n))}async linkWithPopup(e){return _r(this.auth,s4(this._delegate,e,Gs))}async linkWithRedirect(e){return await gv(Zt(this.auth)),g4(this._delegate,e,Gs)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return _r(this.auth,XA(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return mv(this.auth,X5(this._delegate,e,n))}reauthenticateWithPopup(e){return _r(this.auth,i4(this._delegate,e,Gs))}async reauthenticateWithRedirect(e){return await gv(Zt(this.auth)),d4(this._delegate,e,Gs)}sendEmailVerification(e){return r5(this._delegate,e)}async unlink(e){return await $F(this._delegate,e),this}updateEmail(e){return a5(this._delegate,e)}updatePassword(e){return l5(this._delegate,e)}updatePhoneNumber(e){return J5(this._delegate,e)}updateProfile(e){return o5(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return i5(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};im.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=Ee;class pv{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Mu(r,"invalid-api-key",{appName:e.name}),Mu(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Gs:void 0;this._delegate=n.initialize({options:{persistence:M3(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(MV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?im.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){yF(this._delegate,e,n)}applyActionCode(e){return KF(this._delegate,e)}checkActionCode(e){return JA(this._delegate,e)}confirmPasswordReset(e,n){return WF(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return _r(this._delegate,YF(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return n5(this._delegate,e)}isSignInWithEmailLink(e){return ZF(this._delegate,e)}async getRedirectResult(){Mu(Pp(),this._delegate,"operation-not-supported-in-this-environment");const e=await p4(this._delegate,Gs);return e?_r(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){p3(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:a}=pT(e,n,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:a}=pT(e,n,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,n){return JF(this._delegate,e,n)}sendPasswordResetEmail(e,n){return GF(this._delegate,e,n||void 0)}async setPersistence(e){A3(this._delegate,e);let n;switch(e){case kr.SESSION:n=Ia;break;case kr.LOCAL:n=await Or(Yc)._isAvailable()?Yc:T0;break;case kr.NONE:n=Hl;break;default:return jn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return _r(this._delegate,zF(this._delegate))}signInWithCredential(e){return _r(this._delegate,Jg(this._delegate,e))}signInWithCustomToken(e){return _r(this._delegate,qF(this._delegate,e))}signInWithEmailAndPassword(e,n){return _r(this._delegate,XF(this._delegate,e,n))}signInWithEmailLink(e,n){return _r(this._delegate,e5(this._delegate,e,n))}signInWithPhoneNumber(e,n){return mv(this._delegate,Q5(this._delegate,e,n))}async signInWithPopup(e){return Mu(Pp(),this._delegate,"operation-not-supported-in-this-environment"),_r(this._delegate,r4(this._delegate,e,Gs))}async signInWithRedirect(e){return Mu(Pp(),this._delegate,"operation-not-supported-in-this-environment"),await gv(this._delegate),c4(this._delegate,e,Gs)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return QF(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}pv.Persistence=kr;function pT(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:a=>i(a&&im.getOrCreate(a)),error:e,complete:n}}function M3(t,e){const n=P3(t,e);if(typeof self<"u"&&!n.includes(Yc)&&n.push(Yc),typeof window<"u")for(const r of[T0,Ia])n.includes(r)||n.push(r);return n.includes(Hl)||n.push(Hl),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(){this.providerId="phone",this._delegate=new Ea(IP(Rt.auth()))}static credential(e,n){return Ea.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}k0.PHONE_SIGN_IN_METHOD=Ea.PHONE_SIGN_IN_METHOD;k0.PROVIDER_ID=Ea.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3=Ee;class L3{constructor(e,n,r=Rt.app()){var i;O3((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new W5(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3="auth-compat";function F3(t){t.INTERNAL.registerComponent(new Wi(V3,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new pv(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ga.EMAIL_SIGNIN,PASSWORD_RESET:Ga.PASSWORD_RESET,RECOVER_EMAIL:Ga.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ga.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ga.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ga.VERIFY_EMAIL}},EmailAuthProvider:Po,FacebookAuthProvider:ki,GithubAuthProvider:Di,GoogleAuthProvider:Ni,OAuthProvider:bl,SAMLAuthProvider:Gf,PhoneAuthProvider:k0,PhoneMultiFactorGenerator:mP,RecaptchaVerifier:L3,TwitterAuthProvider:Mi,Auth:pv,AuthCredential:hu,Error:ur}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(_3,v3)}F3(Rt);var B3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ne,N0=N0||{},Xe=B3||self;function sm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Dh(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function U3(t){return Object.prototype.hasOwnProperty.call(t,bp)&&t[bp]||(t[bp]=++j3)}var bp="closure_uid_"+(1e9*Math.random()>>>0),j3=0;function z3(t,e,n){return t.call.apply(t.bind,arguments)}function $3(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Yn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Yn=z3:Yn=$3,Yn.apply(null,arguments)}function Ad(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function bn(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var a=Array(arguments.length-2),u=2;u<arguments.length;u++)a[u-2]=arguments[u];return e.prototype[i].apply(r,a)}}function bo(){this.s=this.s,this.o=this.o}var H3=0;bo.prototype.s=!1;bo.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),H3!=0)&&U3(this)};bo.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const TP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function D0(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function _T(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(sm(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let a=0;a<s;a++)t[i+a]=r[a]}else t.push(r)}}function Xn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Xn.prototype.h=function(){this.defaultPrevented=!0};var q3=function(){if(!Xe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};Xe.addEventListener("test",n,e),Xe.removeEventListener("test",n,e)}catch{}return t}();function Xc(t){return/^[\s\xa0]*$/.test(t)}function om(){var t=Xe.navigator;return t&&(t=t.userAgent)?t:""}function Oi(t){return om().indexOf(t)!=-1}function M0(t){return M0[" "](t),t}M0[" "]=function(){};function G3(t,e){var n=FB;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var W3=Oi("Opera"),Gl=Oi("Trident")||Oi("MSIE"),SP=Oi("Edge"),_v=SP||Gl,xP=Oi("Gecko")&&!(om().toLowerCase().indexOf("webkit")!=-1&&!Oi("Edge"))&&!(Oi("Trident")||Oi("MSIE"))&&!Oi("Edge"),K3=om().toLowerCase().indexOf("webkit")!=-1&&!Oi("Edge");function CP(){var t=Xe.document;return t?t.documentMode:void 0}var vv;e:{var Rp="",kp=function(){var t=om();if(xP)return/rv:([^\);]+)(\)|;)/.exec(t);if(SP)return/Edge\/([\d\.]+)/.exec(t);if(Gl)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(K3)return/WebKit\/(\S+)/.exec(t);if(W3)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(kp&&(Rp=kp?kp[1]:""),Gl){var Np=CP();if(Np!=null&&Np>parseFloat(Rp)){vv=String(Np);break e}}vv=Rp}var yv;if(Xe.document&&Gl){var vT=CP();yv=vT||parseInt(vv,10)||void 0}else yv=void 0;var Q3=yv;function Jc(t,e){if(Xn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(xP){e:{try{M0(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Y3[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Jc.$.h.call(this)}}bn(Jc,Xn);var Y3={2:"touch",3:"pen",4:"mouse"};Jc.prototype.h=function(){Jc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Mh="closure_listenable_"+(1e6*Math.random()|0),X3=0;function J3(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++X3,this.fa=this.ia=!1}function am(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function O0(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Z3(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function AP(t){const e={};for(const n in t)e[n]=t[n];return e}const yT="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function PP(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<yT.length;s++)n=yT[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lm(t){this.src=t,this.g={},this.h=0}lm.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var a=Iv(t,e,r,i);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new J3(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function wv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=TP(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(am(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Iv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var L0="closure_lm_"+(1e6*Math.random()|0),Dp={};function bP(t,e,n,r,i){if(r&&r.once)return kP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)bP(t,e[s],n,r,i);return null}return n=B0(n),t&&t[Mh]?t.O(e,n,Dh(r)?!!r.capture:!!r,i):RP(t,e,n,!1,r,i)}function RP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var a=Dh(i)?!!i.capture:!!i,u=F0(t);if(u||(t[L0]=u=new lm(t)),n=u.add(e,n,r,a,s),n.proxy)return n;if(r=eB(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)q3||(i=a),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(DP(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function eB(){function t(n){return e.call(t.src,t.listener,n)}const e=tB;return t}function kP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)kP(t,e[s],n,r,i);return null}return n=B0(n),t&&t[Mh]?t.P(e,n,Dh(r)?!!r.capture:!!r,i):RP(t,e,n,!0,r,i)}function NP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)NP(t,e[s],n,r,i);else r=Dh(r)?!!r.capture:!!r,n=B0(n),t&&t[Mh]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Iv(s,n,r,i),-1<n&&(am(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=F0(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Iv(e,n,r,i)),(n=-1<t?e[t]:null)&&V0(n))}function V0(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Mh])wv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(DP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=F0(e))?(wv(n,t),n.h==0&&(n.src=null,e[L0]=null)):am(t)}}}function DP(t){return t in Dp?Dp[t]:Dp[t]="on"+t}function tB(t,e){if(t.fa)t=!0;else{e=new Jc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&V0(t),t=n.call(r,e)}return t}function F0(t){return t=t[L0],t instanceof lm?t:null}var Mp="__closure_events_fn_"+(1e9*Math.random()>>>0);function B0(t){return typeof t=="function"?t:(t[Mp]||(t[Mp]=function(e){return t.handleEvent(e)}),t[Mp])}function An(){bo.call(this),this.i=new lm(this),this.S=this,this.J=null}bn(An,bo);An.prototype[Mh]=!0;An.prototype.removeEventListener=function(t,e,n,r){NP(this,t,e,n,r)};function Bn(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Xn(e,t);else if(e instanceof Xn)e.target=e.target||t;else{var i=e;e=new Xn(r,t),PP(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=e.g=n[s];i=Pd(a,r,!0,e)&&i}if(a=e.g=t,i=Pd(a,r,!0,e)&&i,i=Pd(a,r,!1,e)&&i,n)for(s=0;s<n.length;s++)a=e.g=n[s],i=Pd(a,r,!1,e)&&i}An.prototype.N=function(){if(An.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)am(n[r]);delete t.g[e],t.h--}}this.J=null};An.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};An.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Pd(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==n){var u=a.listener,h=a.la||a.src;a.ia&&wv(t.i,a),i=u.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var U0=Xe.JSON.stringify;class nB{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function rB(){var t=j0;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class iB{constructor(){this.h=this.g=null}add(e,n){const r=MP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var MP=new nB(()=>new sB,t=>t.reset());class sB{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function oB(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function aB(t){Xe.setTimeout(()=>{throw t},0)}let Zc,eh=!1,j0=new iB,OP=()=>{const t=Xe.Promise.resolve(void 0);Zc=()=>{t.then(lB)}};var lB=()=>{for(var t;t=rB();){try{t.h.call(t.g)}catch(n){aB(n)}var e=MP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}eh=!1};function um(t,e){An.call(this),this.h=t||1,this.g=e||Xe,this.j=Yn(this.qb,this),this.l=Date.now()}bn(um,An);Ne=um.prototype;Ne.ga=!1;Ne.T=null;Ne.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Bn(this,"tick"),this.ga&&(z0(this),this.start()))}};Ne.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function z0(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}Ne.N=function(){um.$.N.call(this),z0(this),delete this.g};function $0(t,e,n){if(typeof t=="function")n&&(t=Yn(t,n));else if(t&&typeof t.handleEvent=="function")t=Yn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Xe.setTimeout(t,e||0)}function LP(t){t.g=$0(()=>{t.g=null,t.i&&(t.i=!1,LP(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class uB extends bo{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:LP(this)}N(){super.N(),this.g&&(Xe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function th(t){bo.call(this),this.h=t,this.g={}}bn(th,bo);var wT=[];function VP(t,e,n,r){Array.isArray(n)||(n&&(wT[0]=n.toString()),n=wT);for(var i=0;i<n.length;i++){var s=bP(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function FP(t){O0(t.g,function(e,n){this.g.hasOwnProperty(n)&&V0(e)},t),t.g={}}th.prototype.N=function(){th.$.N.call(this),FP(this)};th.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function cm(){this.g=!0}cm.prototype.Ea=function(){this.g=!1};function cB(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var a="",u=s.split("&"),h=0;h<u.length;h++){var g=u[h].split("=");if(1<g.length){var _=g[0];g=g[1];var w=_.split("_");a=2<=w.length&&w[1]=="type"?a+(_+"="+g+"&"):a+(_+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+a})}function hB(t,e,n,r,i,s,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+a})}function wl(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+fB(t,n)+(r?" "+r:"")})}function dB(t,e){t.info(function(){return"TIMEOUT: "+e})}cm.prototype.info=function(){};function fB(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return U0(n)}catch{return e}}var Fa={},IT=null;function hm(){return IT=IT||new An}Fa.Ta="serverreachability";function BP(t){Xn.call(this,Fa.Ta,t)}bn(BP,Xn);function nh(t){const e=hm();Bn(e,new BP(e))}Fa.STAT_EVENT="statevent";function UP(t,e){Xn.call(this,Fa.STAT_EVENT,t),this.stat=e}bn(UP,Xn);function or(t){const e=hm();Bn(e,new UP(e,t))}Fa.Ua="timingevent";function jP(t,e){Xn.call(this,Fa.Ua,t),this.size=e}bn(jP,Xn);function Oh(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Xe.setTimeout(function(){t()},e)}var dm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},zP={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function H0(){}H0.prototype.h=null;function ET(t){return t.h||(t.h=t.i())}function $P(){}var Lh={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function q0(){Xn.call(this,"d")}bn(q0,Xn);function G0(){Xn.call(this,"c")}bn(G0,Xn);var Ev;function fm(){}bn(fm,H0);fm.prototype.g=function(){return new XMLHttpRequest};fm.prototype.i=function(){return{}};Ev=new fm;function Vh(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new th(this),this.P=gB,t=_v?125:void 0,this.V=new um(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new HP}function HP(){this.i=null,this.g="",this.h=!1}var gB=45e3,qP={},Tv={};Ne=Vh.prototype;Ne.setTimeout=function(t){this.P=t};function Sv(t,e,n){t.L=1,t.A=mm(Es(e)),t.u=n,t.S=!0,GP(t,null)}function GP(t,e){t.G=Date.now(),Fh(t),t.B=Es(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),eb(n.i,"t",r),t.o=0,n=t.l.J,t.h=new HP,t.g=Ib(t.l,n?e:null,!t.u),0<t.O&&(t.M=new uB(Yn(t.Pa,t,t.g),t.O)),VP(t.U,t.g,"readystatechange",t.nb),e=t.I?AP(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),nh(),cB(t.j,t.v,t.B,t.m,t.W,t.u)}Ne.nb=function(t){t=t.target;const e=this.M;e&&Vi(t)==3?e.l():this.Pa(t)};Ne.Pa=function(t){try{if(t==this.g)e:{const _=Vi(this.g);var e=this.g.Ia();const w=this.g.da();if(!(3>_)&&(_!=3||_v||this.g&&(this.h.h||this.g.ja()||CT(this.g)))){this.J||_!=4||e==7||(e==8||0>=w?nh(3):nh(2)),gm(this);var n=this.g.da();this.ca=n;t:if(WP(this)){var r=CT(this.g);t="";var i=r.length,s=Vi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ra(this),_c(this);var a="";break t}this.h.i=new Xe.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,hB(this.j,this.v,this.B,this.m,this.W,_,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var u,h=this.g;if((u=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Xc(u)){var g=u;break t}}g=null}if(n=g)wl(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xv(this,n);else{this.i=!1,this.s=3,or(12),ra(this),_c(this);break e}}this.S?(KP(this,_,a),_v&&this.i&&_==3&&(VP(this.U,this.V,"tick",this.mb),this.V.start())):(wl(this.j,this.m,a,null),xv(this,a)),_==4&&ra(this),this.i&&!this.J&&(_==4?_b(this.l,this):(this.i=!1,Fh(this)))}else OB(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.s=3,or(12)):(this.s=0,or(13)),ra(this),_c(this)}}}catch{}finally{}};function WP(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function KP(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=mB(t,n),i==Tv){e==4&&(t.s=4,or(14),r=!1),wl(t.j,t.m,null,"[Incomplete Response]");break}else if(i==qP){t.s=4,or(15),wl(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else wl(t.j,t.m,i,null),xv(t,i);WP(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,or(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),J0(e),e.M=!0,or(11))):(wl(t.j,t.m,n,"[Invalid Chunked Response]"),ra(t),_c(t))}Ne.mb=function(){if(this.g){var t=Vi(this.g),e=this.g.ja();this.o<e.length&&(gm(this),KP(this,t,e),this.i&&t!=4&&Fh(this))}};function mB(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Tv:(n=Number(e.substring(n,r)),isNaN(n)?qP:(r+=1,r+n>e.length?Tv:(e=e.slice(r,r+n),t.o=r+n,e)))}Ne.cancel=function(){this.J=!0,ra(this)};function Fh(t){t.Y=Date.now()+t.P,QP(t,t.P)}function QP(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Oh(Yn(t.lb,t),e)}function gm(t){t.C&&(Xe.clearTimeout(t.C),t.C=null)}Ne.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(dB(this.j,this.B),this.L!=2&&(nh(),or(17)),ra(this),this.s=2,_c(this)):QP(this,this.Y-t)};function _c(t){t.l.H==0||t.J||_b(t.l,t)}function ra(t){gm(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,z0(t.V),FP(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function xv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Cv(n.i,t))){if(!t.K&&Cv(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Jf(n),ym(n);else break e;X0(n),or(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Oh(Yn(n.ib,n),6e3));if(1>=rb(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else ia(n,11)}else if((t.K||n.g==t)&&Jf(n),!Xc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let g=i[e];if(n.V=g[0],g=g[1],n.H==2)if(g[0]=="c"){n.K=g[1],n.pa=g[2];const _=g[3];_!=null&&(n.ra=_,n.l.info("VER="+n.ra));const w=g[4];w!=null&&(n.Ga=w,n.l.info("SVER="+n.Ga));const T=g[5];T!=null&&typeof T=="number"&&0<T&&(r=1.5*T,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const E=t.g;if(E){const z=E.g?E.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(z){var s=r.i;s.g||z.indexOf("spdy")==-1&&z.indexOf("quic")==-1&&z.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(W0(s,s.h),s.h=null))}if(r.F){const j=E.g?E.g.getResponseHeader("X-HTTP-Session-Id"):null;j&&(r.Da=j,Lt(r.I,r.F,j))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=wb(r,r.J?r.pa:null,r.Y),a.K){ib(r.i,a);var u=a,h=r.L;h&&u.setTimeout(h),u.C&&(gm(u),Fh(u)),r.g=a}else mb(r);0<n.j.length&&wm(n)}else g[0]!="stop"&&g[0]!="close"||ia(n,7);else n.H==3&&(g[0]=="stop"||g[0]=="close"?g[0]=="stop"?ia(n,7):Y0(n):g[0]!="noop"&&n.h&&n.h.Aa(g),n.A=0)}}nh(4)}catch{}}function pB(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(sm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function _B(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(sm(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function YP(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(sm(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=_B(t),r=pB(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var XP=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vB(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function fa(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof fa){this.h=t.h,Yf(this,t.j),this.s=t.s,this.g=t.g,Xf(this,t.m),this.l=t.l;var e=t.i,n=new rh;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),TT(this,n),this.o=t.o}else t&&(e=String(t).match(XP))?(this.h=!1,Yf(this,e[1]||"",!0),this.s=Ju(e[2]||""),this.g=Ju(e[3]||"",!0),Xf(this,e[4]),this.l=Ju(e[5]||"",!0),TT(this,e[6]||"",!0),this.o=Ju(e[7]||"")):(this.h=!1,this.i=new rh(null,this.h))}fa.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Zu(e,ST,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Zu(e,ST,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Zu(n,n.charAt(0)=="/"?IB:wB,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Zu(n,TB)),t.join("")};function Es(t){return new fa(t)}function Yf(t,e,n){t.j=n?Ju(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Xf(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function TT(t,e,n){e instanceof rh?(t.i=e,SB(t.i,t.h)):(n||(e=Zu(e,EB)),t.i=new rh(e,t.h))}function Lt(t,e,n){t.i.set(e,n)}function mm(t){return Lt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ju(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Zu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,yB),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function yB(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var ST=/[#\/\?@]/g,wB=/[#\?:]/g,IB=/[#\?]/g,EB=/[#\?@]/g,TB=/#/g;function rh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ro(t){t.g||(t.g=new Map,t.h=0,t.i&&vB(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}Ne=rh.prototype;Ne.add=function(t,e){Ro(this),this.i=null,t=fu(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function JP(t,e){Ro(t),e=fu(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ZP(t,e){return Ro(t),e=fu(t,e),t.g.has(e)}Ne.forEach=function(t,e){Ro(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};Ne.ta=function(){Ro(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};Ne.Z=function(t){Ro(this);let e=[];if(typeof t=="string")ZP(this,t)&&(e=e.concat(this.g.get(fu(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};Ne.set=function(t,e){return Ro(this),this.i=null,t=fu(this,t),ZP(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};Ne.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function eb(t,e,n){JP(t,e),0<n.length&&(t.i=null,t.g.set(fu(t,e),D0(n)),t.h+=n.length)}Ne.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),t.push(i)}}return this.i=t.join("&")};function fu(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function SB(t,e){e&&!t.j&&(Ro(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(JP(this,r),eb(this,i,n))},t)),t.j=e}var xB=class{constructor(t,e){this.g=t,this.map=e}};function tb(t){this.l=t||CB,Xe.PerformanceNavigationTiming?(t=Xe.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Xe.g&&Xe.g.Ka&&Xe.g.Ka()&&Xe.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var CB=10;function nb(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function rb(t){return t.h?1:t.g?t.g.size:0}function Cv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function W0(t,e){t.g?t.g.add(e):t.h=e}function ib(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}tb.prototype.cancel=function(){if(this.i=sb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function sb(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return D0(t.i)}var AB=class{stringify(t){return Xe.JSON.stringify(t,void 0)}parse(t){return Xe.JSON.parse(t,void 0)}};function PB(){this.g=new AB}function bB(t,e,n){const r=n||"";try{YP(t,function(i,s){let a=i;Dh(i)&&(a=U0(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function RB(t,e){const n=new cm;if(Xe.Image){const r=new Image;r.onload=Ad(bd,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ad(bd,n,r,"TestLoadImage: error",!1,e),r.onabort=Ad(bd,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ad(bd,n,r,"TestLoadImage: timeout",!1,e),Xe.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function bd(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function pm(t){this.l=t.ec||null,this.j=t.ob||!1}bn(pm,H0);pm.prototype.g=function(){return new _m(this.l,this.j)};pm.prototype.i=function(t){return function(){return t}}({});function _m(t,e){An.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=K0,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}bn(_m,An);var K0=0;Ne=_m.prototype;Ne.open=function(t,e){if(this.readyState!=K0)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ih(this)};Ne.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Xe).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};Ne.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Bh(this)),this.readyState=K0};Ne.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ih(this)),this.g&&(this.readyState=3,ih(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Xe.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ob(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function ob(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}Ne.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Bh(this):ih(this),this.readyState==3&&ob(this)}};Ne.Za=function(t){this.g&&(this.response=this.responseText=t,Bh(this))};Ne.Ya=function(t){this.g&&(this.response=t,Bh(this))};Ne.ka=function(){this.g&&Bh(this)};function Bh(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ih(t)}Ne.setRequestHeader=function(t,e){this.v.append(t,e)};Ne.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};Ne.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function ih(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(_m.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var kB=Xe.JSON.parse;function en(t){An.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ab,this.L=this.M=!1}bn(en,An);var ab="",NB=/^https?$/i,DB=["POST","PUT"];Ne=en.prototype;Ne.Oa=function(t){this.M=t};Ne.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ev.g(),this.C=this.u?ET(this.u):ET(Ev),this.g.onreadystatechange=Yn(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){xT(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Xe.FormData&&t instanceof Xe.FormData,!(0<=TP(DB,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{cb(this),0<this.B&&((this.L=MB(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Yn(this.ua,this)):this.A=$0(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){xT(this,s)}};function MB(t){return Gl&&typeof t.timeout=="number"&&t.ontimeout!==void 0}Ne.ua=function(){typeof N0<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Bn(this,"timeout"),this.abort(8))};function xT(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,lb(t),vm(t)}function lb(t){t.F||(t.F=!0,Bn(t,"complete"),Bn(t,"error"))}Ne.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Bn(this,"complete"),Bn(this,"abort"),vm(this))};Ne.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vm(this,!0)),en.$.N.call(this)};Ne.La=function(){this.s||(this.G||this.v||this.l?ub(this):this.kb())};Ne.kb=function(){ub(this)};function ub(t){if(t.h&&typeof N0<"u"&&(!t.C[1]||Vi(t)!=4||t.da()!=2)){if(t.v&&Vi(t)==4)$0(t.La,0,t);else if(Bn(t,"readystatechange"),Vi(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var i=String(t.I).match(XP)[1]||null;!i&&Xe.self&&Xe.self.location&&(i=Xe.self.location.protocol.slice(0,-1)),r=!NB.test(i?i.toLowerCase():"")}n=r}if(n)Bn(t,"complete"),Bn(t,"success");else{t.m=6;try{var s=2<Vi(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",lb(t)}}finally{vm(t)}}}}function vm(t,e){if(t.g){cb(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Bn(t,"ready");try{n.onreadystatechange=r}catch{}}}function cb(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Xe.clearTimeout(t.A),t.A=null)}Ne.isActive=function(){return!!this.g};function Vi(t){return t.g?t.g.readyState:0}Ne.da=function(){try{return 2<Vi(this)?this.g.status:-1}catch{return-1}};Ne.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};Ne.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),kB(e)}};function CT(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case ab:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function OB(t){const e={};t=(t.g&&2<=Vi(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Xc(t[r]))continue;var n=oB(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}Z3(e,function(r){return r.join(", ")})}Ne.Ia=function(){return this.m};Ne.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function hb(t){let e="";return O0(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Q0(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=hb(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Lt(t,e,n))}function Ou(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function db(t){this.Ga=0,this.j=[],this.l=new cm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ou("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ou("baseRetryDelayMs",5e3,t),this.hb=Ou("retryDelaySeedMs",1e4,t),this.eb=Ou("forwardChannelMaxRetries",2,t),this.xa=Ou("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new tb(t&&t.concurrentRequestLimit),this.Ja=new PB,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}Ne=db.prototype;Ne.ra=8;Ne.H=1;function Y0(t){if(fb(t),t.H==3){var e=t.W++,n=Es(t.I);if(Lt(n,"SID",t.K),Lt(n,"RID",e),Lt(n,"TYPE","terminate"),Uh(t,n),e=new Vh(t,t.l,e),e.L=2,e.A=mm(Es(n)),n=!1,Xe.navigator&&Xe.navigator.sendBeacon)try{n=Xe.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Xe.Image&&(new Image().src=e.A,n=!0),n||(e.g=Ib(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Fh(e)}yb(t)}function ym(t){t.g&&(J0(t),t.g.cancel(),t.g=null)}function fb(t){ym(t),t.u&&(Xe.clearTimeout(t.u),t.u=null),Jf(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Xe.clearTimeout(t.m),t.m=null)}function wm(t){if(!nb(t.i)&&!t.m){t.m=!0;var e=t.Na;Zc||OP(),eh||(Zc(),eh=!0),j0.add(e,t),t.C=0}}function LB(t,e){return rb(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Oh(Yn(t.Na,t,e),vb(t,t.C)),t.C++,!0)}Ne.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Vh(this,this.l,t);let s=this.s;if(this.U&&(s?(s=AP(s),PP(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=gb(this,i,e),n=Es(this.I),Lt(n,"RID",t),Lt(n,"CVER",22),this.F&&Lt(n,"X-HTTP-Session-Id",this.F),Uh(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(hb(s)))+"&"+e:this.o&&Q0(n,this.o,s)),W0(this.i,i),this.bb&&Lt(n,"TYPE","init"),this.P?(Lt(n,"$req",e),Lt(n,"SID","null"),i.aa=!0,Sv(i,n,null)):Sv(i,n,e),this.H=2}}else this.H==3&&(t?AT(this,t):this.j.length==0||nb(this.i)||AT(this))};function AT(t,e){var n;e?n=e.m:n=t.W++;const r=Es(t.I);Lt(r,"SID",t.K),Lt(r,"RID",n),Lt(r,"AID",t.V),Uh(t,r),t.o&&t.s&&Q0(r,t.o,t.s),n=new Vh(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=gb(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),W0(t.i,n),Sv(n,r,e)}function Uh(t,e){t.na&&O0(t.na,function(n,r){Lt(e,r,n)}),t.h&&YP({},function(n,r){Lt(e,r,n)})}function gb(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Yn(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const a=["count="+n];s==-1?0<n?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let u=!0;for(let h=0;h<n;h++){let g=i[h].g;const _=i[h].map;if(g-=s,0>g)s=Math.max(0,i[h].g-100),u=!1;else try{bB(_,a,"req"+g+"_")}catch{r&&r(_)}}if(u){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function mb(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Zc||OP(),eh||(Zc(),eh=!0),j0.add(e,t),t.A=0}}function X0(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Oh(Yn(t.Ma,t),vb(t,t.A)),t.A++,!0)}Ne.Ma=function(){if(this.u=null,pb(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Oh(Yn(this.jb,this),t)}};Ne.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,or(10),ym(this),pb(this))};function J0(t){t.B!=null&&(Xe.clearTimeout(t.B),t.B=null)}function pb(t){t.g=new Vh(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Es(t.wa);Lt(e,"RID","rpc"),Lt(e,"SID",t.K),Lt(e,"AID",t.V),Lt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Lt(e,"TO",t.qa),Lt(e,"TYPE","xmlhttp"),Uh(t,e),t.o&&t.s&&Q0(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=mm(Es(e)),n.u=null,n.S=!0,GP(n,t)}Ne.ib=function(){this.v!=null&&(this.v=null,ym(this),X0(this),or(19))};function Jf(t){t.v!=null&&(Xe.clearTimeout(t.v),t.v=null)}function _b(t,e){var n=null;if(t.g==e){Jf(t),J0(t),t.g=null;var r=2}else if(Cv(t.i,e))n=e.F,ib(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=hm(),Bn(r,new jP(r,n)),wm(t)}else mb(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&LB(t,e)||r==2&&X0(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:ia(t,5);break;case 4:ia(t,10);break;case 3:ia(t,6);break;default:ia(t,2)}}}function vb(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ia(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Yn(t.pb,t);n||(n=new fa("//www.google.com/images/cleardot.gif"),Xe.location&&Xe.location.protocol=="http"||Yf(n,"https"),mm(n)),RB(n.toString(),r)}else or(2);t.H=0,t.h&&t.h.za(e),yb(t),fb(t)}Ne.pb=function(t){t?(this.l.info("Successfully pinged google.com"),or(2)):(this.l.info("Failed to ping google.com"),or(1))};function yb(t){if(t.H=0,t.ma=[],t.h){const e=sb(t.i);(e.length!=0||t.j.length!=0)&&(_T(t.ma,e),_T(t.ma,t.j),t.i.i.length=0,D0(t.j),t.j.length=0),t.h.ya()}}function wb(t,e,n){var r=n instanceof fa?Es(n):new fa(n);if(r.g!="")e&&(r.g=e+"."+r.g),Xf(r,r.m);else{var i=Xe.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new fa(null);r&&Yf(s,r),e&&(s.g=e),i&&Xf(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Lt(r,n,e),Lt(r,"VER",t.ra),Uh(t,r),r}function Ib(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new en(new pm({ob:n})):new en(t.va),e.Oa(t.J),e}Ne.isActive=function(){return!!this.h&&this.h.isActive(this)};function Eb(){}Ne=Eb.prototype;Ne.Ba=function(){};Ne.Aa=function(){};Ne.za=function(){};Ne.ya=function(){};Ne.isActive=function(){return!0};Ne.Va=function(){};function Zf(){if(Gl&&!(10<=Number(Q3)))throw Error("Environmental error: no available transport.")}Zf.prototype.g=function(t,e){return new Br(t,e)};function Br(t,e){An.call(this),this.g=new db(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Xc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Xc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new gu(this)}bn(Br,An);Br.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;or(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=wb(t,null,t.Y),wm(t)};Br.prototype.close=function(){Y0(this.g)};Br.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=U0(t),t=n);e.j.push(new xB(e.fb++,t)),e.H==3&&wm(e)};Br.prototype.N=function(){this.g.h=null,delete this.j,Y0(this.g),delete this.g,Br.$.N.call(this)};function Tb(t){q0.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}bn(Tb,q0);function Sb(){G0.call(this),this.status=1}bn(Sb,G0);function gu(t){this.g=t}bn(gu,Eb);gu.prototype.Ba=function(){Bn(this.g,"a")};gu.prototype.Aa=function(t){Bn(this.g,new Tb(t))};gu.prototype.za=function(t){Bn(this.g,new Sb)};gu.prototype.ya=function(){Bn(this.g,"b")};function VB(){this.blockSize=-1}function Ii(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}bn(Ii,VB);Ii.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Op(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],a=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Ii.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Op(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Op(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Op(this,r),i=0;break}}this.h=i,this.i+=e};Ii.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function St(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var FB={};function Z0(t){return-128<=t&&128>t?G3(t,function(e){return new St([e|0],0>e?-1:0)}):new St([t|0],0>t?-1:0)}function Fi(t){if(isNaN(t)||!isFinite(t))return kl;if(0>t)return On(Fi(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Av;return new St(e,0)}function xb(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return On(xb(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Fi(Math.pow(e,8)),r=kl,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),a=parseInt(t.substring(i,i+s),e);8>s?(s=Fi(Math.pow(e,s)),r=r.R(s).add(Fi(a))):(r=r.R(n),r=r.add(Fi(a)))}return r}var Av=4294967296,kl=Z0(0),Pv=Z0(1),PT=Z0(16777216);Ne=St.prototype;Ne.ea=function(){if(Yr(this))return-On(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Av+r)*e,e*=Av}return t};Ne.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(hs(this))return"0";if(Yr(this))return"-"+On(this).toString(t);for(var e=Fi(Math.pow(t,6)),n=this,r="";;){var i=tg(n,e).g;n=eg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,hs(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};Ne.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function hs(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Yr(t){return t.h==-1}Ne.X=function(t){return t=eg(this,t),Yr(t)?-1:hs(t)?0:1};function On(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new St(n,~t.h).add(Pv)}Ne.abs=function(){return Yr(this)?On(this):this};Ne.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new St(n,n[n.length-1]&-2147483648?-1:0)};function eg(t,e){return t.add(On(e))}Ne.R=function(t){if(hs(this)||hs(t))return kl;if(Yr(this))return Yr(t)?On(this).R(On(t)):On(On(this).R(t));if(Yr(t))return On(this.R(On(t)));if(0>this.X(PT)&&0>t.X(PT))return Fi(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,u=t.D(i)>>>16,h=t.D(i)&65535;n[2*r+2*i]+=a*h,Rd(n,2*r+2*i),n[2*r+2*i+1]+=s*h,Rd(n,2*r+2*i+1),n[2*r+2*i+1]+=a*u,Rd(n,2*r+2*i+1),n[2*r+2*i+2]+=s*u,Rd(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new St(n,0)};function Rd(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Lu(t,e){this.g=t,this.h=e}function tg(t,e){if(hs(e))throw Error("division by zero");if(hs(t))return new Lu(kl,kl);if(Yr(t))return e=tg(On(t),e),new Lu(On(e.g),On(e.h));if(Yr(e))return e=tg(t,On(e)),new Lu(On(e.g),e.h);if(30<t.g.length){if(Yr(t)||Yr(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Pv,r=e;0>=r.X(t);)n=bT(n),r=bT(r);var i=Wa(n,1),s=Wa(r,1);for(r=Wa(r,2),n=Wa(n,2);!hs(r);){var a=s.add(r);0>=a.X(t)&&(i=i.add(n),s=a),r=Wa(r,1),n=Wa(n,1)}return e=eg(t,i.R(e)),new Lu(i,e)}for(i=kl;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Fi(n),a=s.R(e);Yr(a)||0<a.X(t);)n-=r,s=Fi(n),a=s.R(e);hs(s)&&(s=Pv),i=i.add(s),t=eg(t,a)}return new Lu(i,t)}Ne.gb=function(t){return tg(this,t).h};Ne.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new St(n,this.h&t.h)};Ne.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new St(n,this.h|t.h)};Ne.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new St(n,this.h^t.h)};function bT(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new St(n,t.h)}function Wa(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new St(i,t.h)}Zf.prototype.createWebChannel=Zf.prototype.g;Br.prototype.send=Br.prototype.u;Br.prototype.open=Br.prototype.m;Br.prototype.close=Br.prototype.close;dm.NO_ERROR=0;dm.TIMEOUT=8;dm.HTTP_ERROR=6;zP.COMPLETE="complete";$P.EventType=Lh;Lh.OPEN="a";Lh.CLOSE="b";Lh.ERROR="c";Lh.MESSAGE="d";An.prototype.listen=An.prototype.O;en.prototype.listenOnce=en.prototype.P;en.prototype.getLastError=en.prototype.Sa;en.prototype.getLastErrorCode=en.prototype.Ia;en.prototype.getStatus=en.prototype.da;en.prototype.getResponseJson=en.prototype.Wa;en.prototype.getResponseText=en.prototype.ja;en.prototype.send=en.prototype.ha;en.prototype.setWithCredentials=en.prototype.Oa;Ii.prototype.digest=Ii.prototype.l;Ii.prototype.reset=Ii.prototype.reset;Ii.prototype.update=Ii.prototype.j;St.prototype.add=St.prototype.add;St.prototype.multiply=St.prototype.R;St.prototype.modulo=St.prototype.gb;St.prototype.compare=St.prototype.X;St.prototype.toNumber=St.prototype.ea;St.prototype.toString=St.prototype.toString;St.prototype.getBits=St.prototype.D;St.fromNumber=Fi;St.fromString=xb;var BB=function(){return new Zf},UB=function(){return hm()},Lp=dm,jB=zP,zB=Fa,RT={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},kd=$P,$B=en,HB=Ii,Nl=St,qB={};const kT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mu="10.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo=new Wg("@firebase/firestore");function nl(){return fo.logLevel}function GB(t){fo.setLogLevel(t)}function ve(t,...e){if(fo.logLevel<=ot.DEBUG){const n=e.map(ew);fo.debug(`Firestore (${mu}): ${t}`,...n)}}function un(t,...e){if(fo.logLevel<=ot.ERROR){const n=e.map(ew);fo.error(`Firestore (${mu}): ${t}`,...n)}}function Ei(t,...e){if(fo.logLevel<=ot.WARN){const n=e.map(ew);fo.warn(`Firestore (${mu}): ${t}`,...n)}}function ew(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t="Unexpected state"){const e=`FIRESTORE (${mu}) INTERNAL ASSERTION FAILED: `+t;throw un(e),new Error(e)}function Fe(t,e){t||Me()}function WB(t,e){t||Me()}function ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class KB{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Sn.UNAUTHENTICATED))}shutdown(){}}class QB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class YB{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve();let s=new Cn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Cn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Cn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string"),new Cb(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string"),new Sn(e)}}class XB{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class JB{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new XB(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Sn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ZB{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class e6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,ve("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Fe(typeof n.token=="string"),this.R=n.token,new ZB(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=t6(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function tt(t,e){return t<e?-1:t>e?1:0}function Wl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function Pb(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new pe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pe(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new pe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ht.fromMillis(Date.now())}static fromDate(e){return Ht.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ht(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tt(this.nanoseconds,e.nanoseconds):tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new Ht(0,0))}static max(){return new Ue(new Ht(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,n,r){n===void 0?n=0:n>e.length&&Me(),r===void 0?r=e.length-n:r>e.length-n&&Me(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class gt extends sh{construct(e,n,r){return new gt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new pe(ue.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new gt(n)}static emptyPath(){return new gt([])}}const n6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends sh{construct(e,n,r){return new zt(e,n,r)}static isValidIdentifier(e){return n6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new pe(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new pe(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new pe(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new pe(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(n)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(gt.fromString(e))}static fromName(e){return new Pe(gt.fromString(e).popFirst(5))}static empty(){return new Pe(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new gt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function bv(t){return t.fields.find(e=>e.kind===2)}function Go(t){return t.fields.filter(e=>e.kind!==2)}ng.UNKNOWN_ID=-1;class sf{constructor(e,n){this.fieldPath=e,this.kind=n}}class oh{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new oh(0,Ur.min())}}function bb(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(r===1e9?new Ht(n+1,0):new Ht(n,r));return new Ur(i,Pe.empty(),e)}function Rb(t){return new Ur(t.readTime,t.key,-1)}class Ur{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ur(Ue.min(),Pe.empty(),-1)}static max(){return new Ur(Ue.max(),Pe.empty(),-1)}}function tw(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Pe.comparator(t.documentKey,e.documentKey),n!==0?n:tt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Nb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(t){if(t.code!==ue.FAILED_PRECONDITION||t.message!==kb)throw t;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new se((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof se?n:se.resolve(n)}catch(n){return se.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):se.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):se.reject(n)}static resolve(e){return new se((n,r)=>{n(e)})}static reject(e){return new se((n,r)=>{r(e)})}static waitFor(e){return new se((n,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&n()},h=>r(h))}),a=!0,s===i&&n()})}static or(e){let n=se.resolve(!1);for(const r of e)n=n.next(i=>i?se.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new se((r,i)=>{const s=e.length,a=new Array(s);let u=0;for(let h=0;h<s;h++){const g=h;n(e[g]).next(_=>{a[g]=_,++u,u===s&&r(a)},_=>i(_))}})}static doWhile(e,n){return new se((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Cn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new vc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=nw(r.target.error);this.V.reject(new vc(e,i))}}static open(e,n,r,i){try{return new Im(n,e.transaction(i,r))}catch(s){throw new vc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ve("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new i6(n)}}class mi{constructor(e,n,r){this.name=e,this.version=n,this.p=r,mi.S(Qt())===12.2&&un("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ve("SimpleDb","Removing database:",e),Wo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!zc())return!1;if(mi.C())return!0;const e=Qt(),n=mi.S(e),r=0<n&&n<10,i=mi.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=qB)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(ve("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;n(a)},i.onblocked=()=>{r(new vc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new pe(ue.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new pe(ue.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new vc(e,a))},i.onupgradeneeded=s=>{ve("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{ve("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const u=Im.open(this.db,e,s?"readonly":"readwrite",r),h=i(u).next(g=>(u.g(),g)).catch(g=>(u.abort(g),se.reject(g))).toPromise();return h.catch(()=>{}),await u.m,h}catch(u){const h=u,g=h.name!=="FirebaseError"&&a<3;if(ve("SimpleDb","Transaction failed with error:",h.message,"Retrying:",g),this.close(),!g)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class r6{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Wo(this.k.delete())}}class vc extends pe{constructor(e,n){super(ue.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function No(t){return t.name==="IndexedDbTransactionError"}class i6{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ve("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(ve("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Wo(r)}add(e){return ve("SimpleDb","ADD",this.store.name,e,e),Wo(this.store.add(e))}get(e){return Wo(this.store.get(e)).next(n=>(n===void 0&&(n=null),ve("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return ve("SimpleDb","DELETE",this.store.name,e),Wo(this.store.delete(e))}count(){return ve("SimpleDb","COUNT",this.store.name),Wo(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,u)=>{s.push(u)}).next(()=>s)}{const i=this.store.getAll(r.range);return new se((s,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{s(u.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new se((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,n){ve("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,u)=>u.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new se((r,i)=>{n.onerror=s=>{const a=nw(s.target.error);i(a)},n.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(u=>{u?a.continue():r()}):r()}})}G(e,n){const r=[];return new se((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const u=a.target.result;if(!u)return void i();const h=new r6(u),g=n(u.primaryKey,u.value,h);if(g instanceof se){const _=g.catch(w=>(h.done(),se.reject(w)));r.push(_)}h.isDone?i():h.$===null?u.continue():u.continue(h.$)}}).next(()=>se.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Wo(t){return new se((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=nw(r.target.error);n(i)}})}let NT=!1;function nw(t){const e=mi.S(Qt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new pe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return NT||(NT=!0,setTimeout(()=>{throw r},0)),r}}return t}class s6{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){ve("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{ve("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(n){No(n)?ve("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await ko(n)}await this.ee(6e4)})}}class o6{constructor(e,n){this.localStore=e,this.persistence=n}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))}ne(e,n){const r=new Set;let i=n,s=!0;return se.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return ve("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(u=>{i-=u,r.add(a)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(u=>(ve("IndexBackiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>a.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const a=Rb(s);tw(a,r)>0&&(r=a)}),new Ur(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}Er._e=-1;function jh(t){return t==null}function ah(t){return t===0&&1/t==-1/0}function Db(t){return typeof t=="number"&&Number.isInteger(t)&&!ah(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=DT(e)),e=a6(t.get(n),e);return DT(e)}function a6(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function DT(t){return t+""}function Bi(t){const e=t.length;if(Fe(e>=2),e===2)return Fe(t.charAt(0)===""&&t.charAt(1)===""),gt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const a=t.indexOf("",s);switch((a<0||a>n)&&Me(),t.charAt(a+1)){case"":const u=t.substring(s,a);let h;i.length===0?h=u:(i+=u,h=i,i=""),r.push(h);break;case"":i+=t.substring(s,a),i+="\0";break;case"":i+=t.substring(s,a+1);break;default:Me()}s=a+2}return new gt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(t,e){return[t,cr(e)]}function Mb(t,e,n){return[t,cr(e),n]}const l6={},u6=["prefixPath","collectionGroup","readTime","documentId"],c6=["prefixPath","collectionGroup","documentId"],h6=["collectionGroup","readTime","prefixPath","documentId"],d6=["canonicalId","targetId"],f6=["targetId","path"],g6=["path","targetId"],m6=["collectionId","parent"],p6=["indexId","uid"],_6=["uid","sequenceNumber"],v6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],y6=["indexId","uid","orderedDocumentKey"],w6=["userId","collectionPath","documentId"],I6=["userId","collectionPath","largestBatchId"],E6=["userId","collectionGroup","largestBatchId"],Ob=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],T6=[...Ob,"documentOverlays"],Lb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Vb=Lb,S6=[...Vb,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv extends Nb{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function Rn(t,e){const n=ke(t);return mi.M(n.ae,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ba(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Fb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,n){this.comparator=e,this.root=n||Mn.EMPTY}insert(e,n){return new Nt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Mn.BLACK,null,null))}remove(e){return new Nt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nd(this.root,e,this.comparator,!0)}}class Nd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Mn.RED,this.left=i??Mn.EMPTY,this.right=s??Mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Mn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Mn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Me();const e=this.left.check();if(e!==this.right.check())throw Me();return e+(this.isRed()?0:1)}}Mn.EMPTY=null,Mn.RED=!0,Mn.BLACK=!1;Mn.EMPTY=new class{constructor(){this.size=0}get key(){throw Me()}get value(){throw Me()}get color(){throw Me()}get left(){throw Me()}get right(){throw Me()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Mn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.comparator=e,this.data=new Nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new LT(this.data.getIterator())}getIteratorFrom(e){return new LT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof At)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new At(this.comparator);return n.data=e,n}}class LT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ka(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Tr([])}unionWith(e){let n=new At(zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Tr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Wl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Bb("Invalid base64 string: "+s):s}}(e);return new _n(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new _n(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const C6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(Fe(!!t),typeof t=="string"){let e=0;const n=C6.exec(t);if(Fe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Jt(t.seconds),nanos:Jt(t.nanos)}}function Jt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mo(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Em(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function rw(t){const e=t.mapValue.fields.__previous_value__;return Em(e)?rw(e):e}function lh(t){const e=go(t.mapValue.fields.__local_write_time__.timestampValue);return new Ht(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,n,r,i,s,a,u,h,g){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=g}}class po{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new po("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof po&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},af={nullValue:"NULL_VALUE"};function Sa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Em(t)?4:Ub(t)?9007199254740991:10:Me()}function Qi(t,e){if(t===e)return!0;const n=Sa(t);if(n!==Sa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return lh(t).isEqual(lh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=go(i.timestampValue),u=go(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return mo(i.bytesValue).isEqual(mo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Jt(i.geoPointValue.latitude)===Jt(s.geoPointValue.latitude)&&Jt(i.geoPointValue.longitude)===Jt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Jt(i.integerValue)===Jt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Jt(i.doubleValue),u=Jt(s.doubleValue);return a===u?ah(a)===ah(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return Wl(t.arrayValue.values||[],e.arrayValue.values||[],Qi);case 10:return function(i,s){const a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(OT(a)!==OT(u))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!Qi(a[h],u[h])))return!1;return!0}(t,e);default:return Me()}}function uh(t,e){return(t.values||[]).find(n=>Qi(n,e))!==void 0}function _o(t,e){if(t===e)return 0;const n=Sa(t),r=Sa(e);if(n!==r)return tt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return tt(t.booleanValue,e.booleanValue);case 2:return function(s,a){const u=Jt(s.integerValue||s.doubleValue),h=Jt(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return VT(t.timestampValue,e.timestampValue);case 4:return VT(lh(t),lh(e));case 5:return tt(t.stringValue,e.stringValue);case 6:return function(s,a){const u=mo(s),h=mo(a);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const u=s.split("/"),h=a.split("/");for(let g=0;g<u.length&&g<h.length;g++){const _=tt(u[g],h[g]);if(_!==0)return _}return tt(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const u=tt(Jt(s.latitude),Jt(a.latitude));return u!==0?u:tt(Jt(s.longitude),Jt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){const u=s.values||[],h=a.values||[];for(let g=0;g<u.length&&g<h.length;++g){const _=_o(u[g],h[g]);if(_)return _}return tt(u.length,h.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Ws.mapValue&&a===Ws.mapValue)return 0;if(s===Ws.mapValue)return 1;if(a===Ws.mapValue)return-1;const u=s.fields||{},h=Object.keys(u),g=a.fields||{},_=Object.keys(g);h.sort(),_.sort();for(let w=0;w<h.length&&w<_.length;++w){const T=tt(h[w],_[w]);if(T!==0)return T;const E=_o(u[h[w]],g[_[w]]);if(E!==0)return E}return tt(h.length,_.length)}(t.mapValue,e.mapValue);default:throw Me()}}function VT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return tt(t,e);const n=go(t),r=go(e),i=tt(n.seconds,r.seconds);return i!==0?i:tt(n.nanos,r.nanos)}function Kl(t){return kv(t)}function kv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=go(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return mo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Pe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=kv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${kv(n.fields[a])}`;return i+"}"}(t.mapValue):Me()}function xa(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Nv(t){return!!t&&"integerValue"in t}function ch(t){return!!t&&"arrayValue"in t}function FT(t){return!!t&&"nullValue"in t}function BT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lf(t){return!!t&&"mapValue"in t}function yc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ba(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=yc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=yc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ub(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function P6(t){return"nullValue"in t?af:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?xa(po.empty(),Pe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Me()}function b6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?xa(po.empty(),Pe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ws:Me()}function UT(t,e){const n=_o(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function jT(t,e){const n=_o(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.value=e}static empty(){return new Ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!lf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=yc(n)}setAll(e){let n=zt.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const h=this.getFieldsMap(n);this.applyChanges(h,r,i),r={},i=[],n=u.popLast()}a?r[u.lastSegment()]=yc(a):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());lf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Qi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];lf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ba(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ln(yc(this.value))}}function jb(t){const e=[];return Ba(t.fields,(n,r)=>{const i=new zt([n]);if(lf(r)){const s=jb(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Tr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n,r,i,s,a,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new Vt(e,0,Ue.min(),Ue.min(),Ue.min(),Ln.empty(),0)}static newFoundDocument(e,n,r,i){return new Vt(e,1,n,Ue.min(),r,i,0)}static newNoDocument(e,n){return new Vt(e,2,n,Ue.min(),Ue.min(),Ln.empty(),0)}static newUnknownDocument(e,n){return new Vt(e,3,n,Ue.min(),Ue.min(),Ln.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,n){this.position=e,this.inclusive=n}}function zT(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=Pe.comparator(Pe.fromName(a.referenceValue),n.key):r=_o(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function $T(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Qi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,n="asc"){this.field=e,this.dir=n}}function R6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{}class lt extends zb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new k6(e,n,r):n==="array-contains"?new M6(e,r):n==="in"?new Kb(e,r):n==="not-in"?new O6(e,r):n==="array-contains-any"?new L6(e,r):new lt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new N6(e,r):new D6(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(_o(n,this.value)):n!==null&&Sa(this.value)===Sa(n)&&this.matchesComparison(_o(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Et extends zb{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new Et(e,n)}matches(e){return Ql(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Ql(t){return t.op==="and"}function Dv(t){return t.op==="or"}function iw(t){return $b(t)&&Ql(t)}function $b(t){for(const e of t.filters)if(e instanceof Et)return!1;return!0}function Mv(t){if(t instanceof lt)return t.field.canonicalString()+t.op.toString()+Kl(t.value);if(iw(t))return t.filters.map(e=>Mv(e)).join(",");{const e=t.filters.map(n=>Mv(n)).join(",");return`${t.op}(${e})`}}function Hb(t,e){return t instanceof lt?function(r,i){return i instanceof lt&&r.op===i.op&&r.field.isEqual(i.field)&&Qi(r.value,i.value)}(t,e):t instanceof Et?function(r,i){return i instanceof Et&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&Hb(a,i.filters[u]),!0):!1}(t,e):void Me()}function qb(t,e){const n=t.filters.concat(e);return Et.create(n,t.op)}function Gb(t){return t instanceof lt?function(n){return`${n.field.canonicalString()} ${n.op} ${Kl(n.value)}`}(t):t instanceof Et?function(n){return n.op.toString()+" {"+n.getFilters().map(Gb).join(" ,")+"}"}(t):"Filter"}class k6 extends lt{constructor(e,n,r){super(e,n,r),this.key=Pe.fromName(r.referenceValue)}matches(e){const n=Pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class N6 extends lt{constructor(e,n){super(e,"in",n),this.keys=Wb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class D6 extends lt{constructor(e,n){super(e,"not-in",n),this.keys=Wb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Wb(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Pe.fromName(r.referenceValue))}class M6 extends lt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ch(n)&&uh(n.arrayValue,this.value)}}class Kb extends lt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&uh(this.value.arrayValue,n)}}class O6 extends lt{constructor(e,n){super(e,"not-in",n)}matches(e){if(uh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!uh(this.value.arrayValue,n)}}class L6 extends lt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ch(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>uh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e,n=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ce=null}}function Ov(t,e=null,n=[],r=[],i=null,s=null,a=null){return new V6(t,e,n,r,i,s,a)}function Ca(t){const e=ke(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Mv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),jh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Kl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Kl(r)).join(",")),e.ce=n}return e.ce}function zh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!R6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Hb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$T(t.startAt,e.startAt)&&$T(t.endAt,e.endAt)}function rg(t){return Pe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function ig(t,e){return t.filters.filter(n=>n instanceof lt&&n.field.isEqual(e))}function HT(t,e,n){let r=af,i=!0;for(const s of ig(t,e)){let a=af,u=!0;switch(s.op){case"<":case"<=":a=P6(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,u=!1;break;case"!=":case"not-in":a=af}UT({value:r,inclusive:i},{value:a,inclusive:u})<0&&(r=a,i=u)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const a=n.position[s];UT({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function qT(t,e,n){let r=Ws,i=!0;for(const s of ig(t,e)){let a=Ws,u=!0;switch(s.op){case">=":case">":a=b6(s.value),u=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,u=!1;break;case"!=":case"not-in":a=Ws}jT({value:r,inclusive:i},{value:a,inclusive:u})>0&&(r=a,i=u)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const a=n.position[s];jT({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n=null,r=[],i=[],s=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Qb(t,e,n,r,i,s,a,u){return new As(t,e,n,r,i,s,a,u)}function pu(t){return new As(t)}function GT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function sw(t){return t.collectionGroup!==null}function Dl(t){const e=ke(t);if(e.le===null){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new At(zt.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(g=>{g.isInequality()&&(u=u.add(g.field))})}),u})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new hh(s,r))}),n.has(zt.keyField().canonicalString())||e.le.push(new hh(zt.keyField(),r))}return e.le}function hr(t){const e=ke(t);return e.he||(e.he=F6(e,Dl(t))),e.he}function F6(t,e){if(t.limitType==="F")return Ov(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new hh(i.field,s)});const n=t.endAt?new vo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new vo(t.startAt.position,t.startAt.inclusive):null;return Ov(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Lv(t,e){const n=t.filters.concat([e]);return new As(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function sg(t,e,n){return new As(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $h(t,e){return zh(hr(t),hr(e))&&t.limitType===e.limitType}function Yb(t){return`${Ca(hr(t))}|lt:${t.limitType}`}function rl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Gb(i)).join(", ")}]`),jh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Kl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Kl(i)).join(",")),`Target(${r})`}(hr(t))}; limitType=${t.limitType})`}function Hh(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Pe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Dl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){const g=zT(a,u,h);return a.inclusive?g<=0:g<0}(r.startAt,Dl(r),i)||r.endAt&&!function(a,u,h){const g=zT(a,u,h);return a.inclusive?g>=0:g>0}(r.endAt,Dl(r),i))}(t,e)}function Xb(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Jb(t){return(e,n)=>{let r=!1;for(const i of Dl(t)){const s=B6(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function B6(t,e,n){const r=t.field.isKeyField()?Pe.comparator(e.key,n.key):function(s,a,u){const h=a.data.field(s),g=u.data.field(s);return h!==null&&g!==null?_o(h,g):Me()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ba(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Fb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=new Nt(Pe.comparator);function Sr(){return U6}const Zb=new Nt(Pe.comparator);function ec(...t){let e=Zb;for(const n of t)e=e.insert(n.key,n);return e}function eR(t){let e=Zb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ui(){return wc()}function tR(){return wc()}function wc(){return new Do(t=>t.toString(),(t,e)=>t.isEqual(e))}const j6=new Nt(Pe.comparator),z6=new At(Pe.comparator);function rt(...t){let e=z6;for(const n of t)e=e.add(n);return e}const $6=new At(tt);function ow(){return $6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ah(e)?"-0":e}}function rR(t){return{integerValue:""+t}}function iR(t,e){return Db(e)?rR(e):nR(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(){this._=void 0}}function H6(t,e,n){return t instanceof Yl?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Em(s)&&(s=rw(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof Aa?oR(t,e):t instanceof Pa?aR(t,e):function(i,s){const a=sR(i,s),u=WT(a)+WT(i.Ie);return Nv(a)&&Nv(i.Ie)?rR(u):nR(i.serializer,u)}(t,e)}function q6(t,e,n){return t instanceof Aa?oR(t,e):t instanceof Pa?aR(t,e):n}function sR(t,e){return t instanceof Xl?function(r){return Nv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Yl extends Tm{}class Aa extends Tm{constructor(e){super(),this.elements=e}}function oR(t,e){const n=lR(e);for(const r of t.elements)n.some(i=>Qi(i,r))||n.push(r);return{arrayValue:{values:n}}}class Pa extends Tm{constructor(e){super(),this.elements=e}}function aR(t,e){let n=lR(e);for(const r of t.elements)n=n.filter(i=>!Qi(i,r));return{arrayValue:{values:n}}}class Xl extends Tm{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function WT(t){return Jt(t.integerValue||t.doubleValue)}function lR(t){return ch(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,n){this.field=e,this.transform=n}}function G6(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Aa&&i instanceof Aa||r instanceof Pa&&i instanceof Pa?Wl(r.elements,i.elements,Qi):r instanceof Xl&&i instanceof Xl?Qi(r.Ie,i.Ie):r instanceof Yl&&i instanceof Yl}(t.transform,e.transform)}class W6{constructor(e,n){this.version=e,this.transformResults=n}}class $t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new $t}static exists(e){return new $t(void 0,e)}static updateTime(e){return new $t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Sm{}function uR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vu(t.key,$t.none()):new _u(t.key,t.data,$t.none());{const n=t.data,r=Ln.empty();let i=new At(zt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Ps(t.key,r,new Tr(i.toArray()),$t.none())}}function K6(t,e,n){t instanceof _u?function(i,s,a){const u=i.value.clone(),h=QT(i.fieldTransforms,s,a.transformResults);u.setAll(h),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof Ps?function(i,s,a){if(!uf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const u=QT(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(cR(i)),h.setAll(u),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Ic(t,e,n,r){return t instanceof _u?function(s,a,u,h){if(!uf(s.precondition,a))return u;const g=s.value.clone(),_=YT(s.fieldTransforms,h,a);return g.setAll(_),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ps?function(s,a,u,h){if(!uf(s.precondition,a))return u;const g=YT(s.fieldTransforms,h,a),_=a.data;return _.setAll(cR(s)),_.setAll(g),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(w=>w.field))}(t,e,n,r):function(s,a,u){return uf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function Q6(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=sR(r.transform,i||null);s!=null&&(n===null&&(n=Ln.empty()),n.set(r.field,s))}return n||null}function KT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Wl(r,i,(s,a)=>G6(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _u extends Sm{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ps extends Sm{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function cR(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function QT(t,e,n){const r=new Map;Fe(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,q6(a,u,n[i]))}return r}function YT(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,H6(s,a,e))}return r}class vu extends Sm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aw extends Sm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&K6(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ic(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ic(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=tR();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let u=this.applyToLocalView(a,s.mutatedFields);u=n.has(i.key)?null:u;const h=uR(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),rt())}isEqual(e){return this.batchId===e.batchId&&Wl(this.mutations,e.mutations,(n,r)=>KT(n,r))&&Wl(this.baseMutations,e.baseMutations,(n,r)=>KT(n,r))}}class uw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Fe(e.mutations.length===r.length);let i=function(){return j6}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new uw(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn,ft;function hR(t){switch(t){default:return Me();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function dR(t){if(t===void 0)return un("GRPC error has no .code"),ue.UNKNOWN;switch(t){case dn.OK:return ue.OK;case dn.CANCELLED:return ue.CANCELLED;case dn.UNKNOWN:return ue.UNKNOWN;case dn.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case dn.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case dn.INTERNAL:return ue.INTERNAL;case dn.UNAVAILABLE:return ue.UNAVAILABLE;case dn.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case dn.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case dn.NOT_FOUND:return ue.NOT_FOUND;case dn.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case dn.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case dn.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case dn.ABORTED:return ue.ABORTED;case dn.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case dn.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case dn.DATA_LOSS:return ue.DATA_LOSS;default:return Me()}}(ft=dn||(dn={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X6=new Nl([4294967295,4294967295],0);function XT(t){const e=fR().encode(t),n=new HB;return n.update(e),new Uint8Array(n.digest())}function JT(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Nl([n,r],0),new Nl([i,s],0)]}class hw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new tc(`Invalid padding: ${n}`);if(r<0)throw new tc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new tc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new tc(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Nl.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Nl.fromNumber(r)));return i.compare(X6)===1&&(i=new Nl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=XT(e),[r,i]=JT(n);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new hw(s,i,n);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Te===0)return;const n=XT(e),[r,i]=JT(n);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class tc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Wh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Gh(Ue.min(),i,new Nt(tt),Sr(),rt())}}class Wh{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Wh(r,n,rt(),rt(),rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class gR{constructor(e,n){this.targetId=e,this.fe=n}}class mR{constructor(e,n,r=_n.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ZT{constructor(){this.ge=0,this.pe=t1(),this.ye=_n.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=rt(),n=rt(),r=rt();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Me()}}),new Wh(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=t1()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Fe(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class J6{constructor(e){this.Le=e,this.ke=new Map,this.qe=Sr(),this.Qe=e1(),this.Ke=new Nt(tt)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:Me()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(rg(s))if(r===0){const a=new Pe(s.path);this.We(n,a,Vt.newNoDocument(a,Ue.min()))}else Fe(r===1);else{const a=this.Ze(n);if(a!==r){const u=this.Xe(e),h=u?this.et(u,e,a):1;if(h!==0){this.He(n);const g=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,g)}}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,u;try{a=mo(r).toUint8Array()}catch(h){if(h instanceof Bb)return Ei("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new hw(a,i,s)}catch(h){return Ei(h instanceof tc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Te===0?null:u}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Le.nt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,a)=>{const u=this.Ye(a);if(u){if(s.current&&rg(u.target)){const h=new Pe(u.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,Vt.newNoDocument(h,e))}s.De&&(n.set(a,s.ve()),s.Fe())}});let r=rt();this.Qe.forEach((s,a)=>{let u=!0;a.forEachWhile(h=>{const g=this.Ye(h);return!g||g.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new Gh(e,n,this.Ke,this.qe,r);return this.qe=Sr(),this.Qe=e1(),this.Ke=new Nt(tt),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new ZT,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new At(tt),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||ve("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new ZT),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function e1(){return new Nt(Pe.comparator)}function t1(){return new Nt(Pe.comparator)}const Z6={asc:"ASCENDING",desc:"DESCENDING"},e9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},t9={and:"AND",or:"OR"};class n9{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Vv(t,e){return t.useProto3Json||jh(e)?e:{value:e}}function Jl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pR(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function r9(t,e){return Jl(t,e.toTimestamp())}function hn(t){return Fe(!!t),Ue.fromTimestamp(function(n){const r=go(n);return new Ht(r.seconds,r.nanos)}(t))}function dw(t,e){return function(r){return new gt(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function _R(t){const e=gt.fromString(t);return Fe(CR(e)),e}function dh(t,e){return dw(t.databaseId,e.path)}function qi(t,e){const n=_R(e);if(n.get(1)!==t.databaseId.projectId)throw new pe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new pe(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Pe(yR(n))}function Fv(t,e){return dw(t.databaseId,e)}function vR(t){const e=_R(t);return e.length===4?gt.emptyPath():yR(e)}function fh(t){return new gt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yR(t){return Fe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function n1(t,e,n){return{name:dh(t,e),fields:n.value.mapValue.fields}}function wR(t,e,n){const r=qi(t,e.name),i=hn(e.updateTime),s=e.createTime?hn(e.createTime):Ue.min(),a=new Ln({mapValue:{fields:e.fields}}),u=Vt.newFoundDocument(r,i,s,a);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function i9(t,e){return"found"in e?function(r,i){Fe(!!i.found),i.found.name,i.found.updateTime;const s=qi(r,i.found.name),a=hn(i.found.updateTime),u=i.found.createTime?hn(i.found.createTime):Ue.min(),h=new Ln({mapValue:{fields:i.found.fields}});return Vt.newFoundDocument(s,a,u,h)}(t,e):"missing"in e?function(r,i){Fe(!!i.missing),Fe(!!i.readTime);const s=qi(r,i.missing),a=hn(i.readTime);return Vt.newNoDocument(s,a)}(t,e):Me()}function s9(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Me()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(g,_){return g.useProto3Json?(Fe(_===void 0||typeof _=="string"),_n.fromBase64String(_||"")):(Fe(_===void 0||_ instanceof Uint8Array),_n.fromUint8Array(_||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(g){const _=g.code===void 0?ue.UNKNOWN:dR(g.code);return new pe(_,g.message||"")}(a);n=new mR(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=qi(t,r.document.name),s=hn(r.document.updateTime),a=r.document.createTime?hn(r.document.createTime):Ue.min(),u=new Ln({mapValue:{fields:r.document.fields}}),h=Vt.newFoundDocument(i,s,a,u),g=r.targetIds||[],_=r.removedTargetIds||[];n=new cf(g,_,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=qi(t,r.document),s=r.readTime?hn(r.readTime):Ue.min(),a=Vt.newNoDocument(i,s),u=r.removedTargetIds||[];n=new cf([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=qi(t,r.document),s=r.removedTargetIds||[];n=new cf([],s,i,null)}else{if(!("filter"in e))return Me();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Y6(i,s),u=r.targetId;n=new gR(u,a)}}return n}function gh(t,e){let n;if(e instanceof _u)n={update:n1(t,e.key,e.value)};else if(e instanceof vu)n={delete:dh(t,e.key)};else if(e instanceof Ps)n={update:n1(t,e.key,e.data),updateMask:h9(e.fieldMask)};else{if(!(e instanceof aw))return Me();n={verify:dh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const u=a.transform;if(u instanceof Yl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Aa)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Pa)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Xl)return{fieldPath:a.field.canonicalString(),increment:u.Ie};throw Me()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:r9(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Me()}(t,e.precondition)),n}function Bv(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?$t.updateTime(hn(s.updateTime)):s.exists!==void 0?$t.exists(s.exists):$t.none()}(e.currentDocument):$t.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,u){let h=null;if("setToServerValue"in u)Fe(u.setToServerValue==="REQUEST_TIME"),h=new Yl;else if("appendMissingElements"in u){const _=u.appendMissingElements.values||[];h=new Aa(_)}else if("removeAllFromArray"in u){const _=u.removeAllFromArray.values||[];h=new Pa(_)}else"increment"in u?h=new Xl(a,u.increment):Me();const g=zt.fromServerFormat(u.fieldPath);return new qh(g,h)}(t,i)):[];if(e.update){e.update.name;const i=qi(t,e.update.name),s=new Ln({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const g=h.fieldPaths||[];return new Tr(g.map(_=>zt.fromServerFormat(_)))}(e.updateMask);return new Ps(i,s,a,n,r)}return new _u(i,s,n,r)}if(e.delete){const i=qi(t,e.delete);return new vu(i,n)}if(e.verify){const i=qi(t,e.verify);return new aw(i,n)}return Me()}function o9(t,e){return t&&t.length>0?(Fe(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?hn(i.updateTime):hn(s);return a.isEqual(Ue.min())&&(a=hn(s)),new W6(a,i.transformResults||[])}(n,e))):[]}function IR(t,e){return{documents:[Fv(t,e.path)]}}function ER(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Fv(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fv(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return xR(Et.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(g=>function(w){return{field:il(w.field),direction:l9(w.dir)}}(g))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const a=Vv(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),n}function TR(t){let e=vR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Fe(r===1);const _=n.from[0];_.allDescendants?i=_.collectionId:e=e.child(_.collectionId)}let s=[];n.where&&(s=function(w){const T=SR(w);return T instanceof Et&&iw(T)?T.getFilters():[T]}(n.where));let a=[];n.orderBy&&(a=function(w){return w.map(T=>function(z){return new hh(sl(z.field),function(J){switch(J){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(z.direction))}(T))}(n.orderBy));let u=null;n.limit&&(u=function(w){let T;return T=typeof w=="object"?w.value:w,jh(T)?null:T}(n.limit));let h=null;n.startAt&&(h=function(w){const T=!!w.before,E=w.values||[];return new vo(E,T)}(n.startAt));let g=null;return n.endAt&&(g=function(w){const T=!w.before,E=w.values||[];return new vo(E,T)}(n.endAt)),Qb(e,i,a,s,u,"F",h,g)}function a9(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function SR(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=sl(n.unaryFilter.field);return lt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=sl(n.unaryFilter.field);return lt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=sl(n.unaryFilter.field);return lt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=sl(n.unaryFilter.field);return lt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Me()}}(t):t.fieldFilter!==void 0?function(n){return lt.create(sl(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Me()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Et.create(n.compositeFilter.filters.map(r=>SR(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Me()}}(n.compositeFilter.op))}(t):Me()}function l9(t){return Z6[t]}function u9(t){return e9[t]}function c9(t){return t9[t]}function il(t){return{fieldPath:t.canonicalString()}}function sl(t){return zt.fromServerFormat(t.fieldPath)}function xR(t){return t instanceof lt?function(n){if(n.op==="=="){if(BT(n.value))return{unaryFilter:{field:il(n.field),op:"IS_NAN"}};if(FT(n.value))return{unaryFilter:{field:il(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(BT(n.value))return{unaryFilter:{field:il(n.field),op:"IS_NOT_NAN"}};if(FT(n.value))return{unaryFilter:{field:il(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:il(n.field),op:u9(n.op),value:n.value}}}(t):t instanceof Et?function(n){const r=n.getFilters().map(i=>xR(i));return r.length===1?r[0]:{compositeFilter:{op:c9(n.op),filters:r}}}(t):Me()}function h9(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function CR(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,n,r,i,s=Ue.min(),a=Ue.min(),u=_n.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.ut=e}}function d9(t,e){let n;if(e.document)n=wR(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Pe.fromSegments(e.noDocument.path),i=Ra(e.noDocument.readTime);n=Vt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Me();{const r=Pe.fromSegments(e.unknownDocument.path),i=Ra(e.unknownDocument.version);n=Vt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Ht(i[0],i[1]);return Ue.fromTimestamp(s)}(e.readTime)),n}function r1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:og(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:dh(s,a.key),fields:a.data.value.mapValue.fields,updateTime:Jl(s,a.version.toTimestamp()),createTime:Jl(s,a.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ba(e.version)};else{if(!e.isUnknownDocument())return Me();r.unknownDocument={path:n.path.toArray(),version:ba(e.version)}}return r}function og(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ba(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ra(t){const e=new Ht(t.seconds,t.nanoseconds);return Ue.fromTimestamp(e)}function Ko(t,e){const n=(e.baseMutations||[]).map(s=>Bv(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const u=e.mutations[s+1];a.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Bv(t.ut,s)),i=Ht.fromMillis(e.localWriteTimeMs);return new lw(e.batchId,i,n,r)}function nc(t){const e=Ra(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ra(t.lastLimboFreeSnapshotVersion):Ue.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return Fe(s.documents.length===1),hr(pu(vR(s.documents[0])))}(t.query):function(s){return hr(TR(s))}(t.query),new ds(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,_n.fromBase64String(t.resumeToken))}function PR(t,e){const n=ba(e.snapshotVersion),r=ba(e.lastLimboFreeSnapshotVersion);let i;i=rg(e.target)?IR(t.ut,e.target):ER(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ca(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fw(t){const e=TR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?sg(e,e.limit,"L"):e}function Vp(t,e){return new cw(e.largestBatchId,Bv(t.ut,e.overlayMutation))}function i1(t,e){const n=e.path.lastSegment();return[t,cr(e.path.popLast()),n]}function s1(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:ba(r.readTime),documentKey:cr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{getBundleMetadata(e,n){return o1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ra(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return o1(e).put(function(i){return{bundleId:i.id,createTime:ba(hn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return a1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:fw(s.bundledQuery),readTime:Ra(s.readTime)}}(r)})}saveNamedQuery(e,n){return a1(e).put(function(i){return{name:i.name,readTime:ba(hn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function o1(t){return Rn(t,"bundles")}function a1(t){return Rn(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){const r=n.uid||"";return new xm(e,r)}getOverlay(e,n){return Vu(e).get(i1(this.userId,n)).next(r=>r?Vp(this.serializer,r):null)}getOverlays(e,n){const r=Ui();return se.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,a)=>{const u=new cw(n,a);i.push(this.lt(e,u))}),se.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(cr(a.getCollectionPath())));const s=[];return i.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Vu(e).H("collectionPathOverlayIndex",u))}),se.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Ui(),s=cr(n),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Vu(e).W("collectionPathOverlayIndex",a).next(u=>{for(const h of u){const g=Vp(this.serializer,h);i.set(g.getKey(),g)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Ui();let a;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Vu(e).Y({index:"collectionGroupOverlayIndex",range:u},(h,g,_)=>{const w=Vp(this.serializer,g);s.size()<i||w.largestBatchId===a?(s.set(w.getKey(),w),a=w.largestBatchId):_.done()}).next(()=>s)}lt(e,n){return Vu(e).put(function(i,s,a){const[u,h,g]=i1(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:g,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:gh(i.ut,a.mutation)}}(this.serializer,this.userId,n))}}function Vu(t){return Rn(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(Jt(e.integerValue));else if("doubleValue"in e){const r=Jt(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),ah(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(mo(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?Ub(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):Me()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),Pe.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}Qo.St=new Qo;function g9(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function l1(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=g9(255&r[s]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class m9{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=l1(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=l1(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class p9{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class _9{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Fu{constructor(){this.Wt=new m9,this.Gt=new p9(this.Wt),this.zt=new _9(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Yo(this.indexId,this.documentKey,this.arrayValue,r)}}function Ms(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=u1(t.arrayValue,e.arrayValue),n!==0?n:(n=u1(t.directionalValue,e.directionalValue),n!==0?n:Pe.comparator(t.documentKey,e.documentKey)))}function u1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this.Jt=new At((n,r)=>zt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Fe(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=bv(e);if(n!==void 0&&!this.tn(n))return!1;const r=Go(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const u=this.Jt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const h=r[s];if(!this.nn(u,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const u=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],u))return!1}return!0}sn(){if(this.Xt)return null;let e=new At(zt.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new sf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new sf(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new sf(r.field,r.dir==="asc"?0:1)));return new ng(ng.UNKNOWN_ID,this.collectionId,n,oh.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(t){var e,n;if(Fe(t instanceof lt||t instanceof Et),t instanceof lt){if(t instanceof Kb){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>lt.create(t.field,"==",s)))||[];return Et.create(i,"or")}return t}const r=t.filters.map(i=>bR(i));return Et.create(r,t.op)}function v9(t){if(t.getFilters().length===0)return[];const e=zv(bR(t));return Fe(RR(e)),Uv(e)||jv(e)?[e]:e.getFilters()}function Uv(t){return t instanceof lt}function jv(t){return t instanceof Et&&iw(t)}function RR(t){return Uv(t)||jv(t)||function(n){if(n instanceof Et&&Dv(n)){for(const r of n.getFilters())if(!Uv(r)&&!jv(r))return!1;return!0}return!1}(t)}function zv(t){if(Fe(t instanceof lt||t instanceof Et),t instanceof lt)return t;if(t.filters.length===1)return zv(t.filters[0]);const e=t.filters.map(r=>zv(r));let n=Et.create(e,t.op);return n=ag(n),RR(n)?n:(Fe(n instanceof Et),Fe(Ql(n)),Fe(n.filters.length>1),n.filters.reduce((r,i)=>gw(r,i)))}function gw(t,e){let n;return Fe(t instanceof lt||t instanceof Et),Fe(e instanceof lt||e instanceof Et),n=t instanceof lt?e instanceof lt?function(i,s){return Et.create([i,s],"and")}(t,e):h1(t,e):e instanceof lt?h1(e,t):function(i,s){if(Fe(i.filters.length>0&&s.filters.length>0),Ql(i)&&Ql(s))return qb(i,s.getFilters());const a=Dv(i)?i:s,u=Dv(i)?s:i,h=a.filters.map(g=>gw(g,u));return Et.create(h,"or")}(t,e),ag(n)}function h1(t,e){if(Ql(e))return qb(e,t.getFilters());{const n=e.filters.map(r=>gw(t,r));return Et.create(n,"or")}}function ag(t){if(Fe(t instanceof lt||t instanceof Et),t instanceof lt)return t;const e=t.getFilters();if(e.length===1)return ag(e[0]);if($b(t))return t;const n=e.map(i=>ag(i)),r=[];return n.forEach(i=>{i instanceof lt?r.push(i):i instanceof Et&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Et.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(){this.on=new mw}addToCollectionParentIndex(e,n){return this.on.add(n),se.resolve()}getCollectionParents(e,n){return se.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return se.resolve()}deleteFieldIndex(e,n){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,n){return se.resolve()}getDocumentsMatchingTarget(e,n){return se.resolve(null)}getIndexType(e,n){return se.resolve(0)}getFieldIndexes(e,n){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,n){return se.resolve(Ur.min())}getMinOffsetFromCollectionGroup(e,n){return se.resolve(Ur.min())}updateCollectionGroup(e,n,r){return se.resolve()}updateIndexEntries(e,n){return se.resolve()}}class mw{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new At(gt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new At(gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd=new Uint8Array(0);class w9{constructor(e,n){this.user=e,this.databaseId=n,this._n=new mw,this.an=new Do(r=>Ca(r),(r,i)=>zh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:cr(i)};return d1(e).put(s)}return se.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[Pb(n),""],!1,!0);return d1(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==n)break;r.push(Bi(a.parent))}return r})}addFieldIndex(e,n){const r=Bu(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const a=Ya(e);return s.next(u=>{a.put(s1(u,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Bu(e),i=Ya(e),s=Qa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Bu(e),r=Qa(e),i=Ya(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return se.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new c1(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Qa(e);let i=!0;const s=new Map;return se.forEach(this.un(n),a=>this.cn(e,a).next(u=>{i&&(i=!!u),s.set(a,u)})).next(()=>{if(i){let a=rt();const u=[];return se.forEach(s,(h,g)=>{ve("IndexedDbIndexManager",`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(Z=>`${Z.fieldPath}:${Z.kind}`).join(",")}`}(h)} to execute ${Ca(n)}`);const _=function(U,Z){const ne=bv(Z);if(ne===void 0)return null;for(const te of ig(U,ne.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null}(g,h),w=function(U,Z){const ne=new Map;for(const te of Go(Z))for(const ae of ig(U,te.fieldPath))switch(ae.op){case"==":case"in":ne.set(te.fieldPath.canonicalString(),ae.value);break;case"not-in":case"!=":return ne.set(te.fieldPath.canonicalString(),ae.value),Array.from(ne.values())}return null}(g,h),T=function(U,Z){const ne=[];let te=!0;for(const ae of Go(Z)){const ce=ae.kind===0?HT(U,ae.fieldPath,U.startAt):qT(U,ae.fieldPath,U.startAt);ne.push(ce.value),te&&(te=ce.inclusive)}return new vo(ne,te)}(g,h),E=function(U,Z){const ne=[];let te=!0;for(const ae of Go(Z)){const ce=ae.kind===0?qT(U,ae.fieldPath,U.endAt):HT(U,ae.fieldPath,U.endAt);ne.push(ce.value),te&&(te=ce.inclusive)}return new vo(ne,te)}(g,h),z=this.ln(h,g,T),j=this.ln(h,g,E),J=this.hn(h,g,w),V=this.Pn(h.indexId,_,z,T.inclusive,j,E.inclusive,J);return se.forEach(V,B=>r.j(B,n.limit).next(U=>{U.forEach(Z=>{const ne=Pe.fromSegments(Z.documentKey);a.has(ne)||(a=a.add(ne),u.push(ne))})}))}).next(()=>u)}return se.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=v9(Et.create(e.filters,"and")).map(r=>Ov(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,a,u){const h=(n!=null?n.length:1)*Math.max(r.length,s.length),g=h/(n!=null?n.length:1),_=[];for(let w=0;w<h;++w){const T=n?this.In(n[w/g]):Dd,E=this.Tn(e,T,r[w%g],i),z=this.En(e,T,s[w%g],a),j=u.map(J=>this.Tn(e,T,J,!0));_.push(...this.createRange(E,z,j))}return _}Tn(e,n,r,i){const s=new Yo(e,Pe.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new Yo(e,Pe.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new c1(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const u of s)r.en(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(e,n){let r=2;const i=this.un(n);return se.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let g=new At(zt.comparator),_=!1;for(const w of h.filters)for(const T of w.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:g=g.add(T.field));for(const w of h.orderBy)w.field.isKeyField()||(g=g.add(w.field));return g.size+(_?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){const r=new Fu;for(const i of Go(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);Qo.St.ht(s,a)}return r.Ut()}In(e){const n=new Fu;return Qo.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new Fu;return Qo.St.ht(xa(this.databaseId,n),r.jt(function(s){const a=Go(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new Fu);let s=0;for(const a of Go(e)){const u=r[s++];for(const h of i)if(this.Rn(n,a.fieldPath)&&ch(u))i=this.Vn(i,a,u);else{const g=h.jt(a.kind);Qo.St.ht(u,g)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const u of i){const h=new Fu;h.seed(u.Ut()),Qo.St.ht(a,h.jt(n.kind)),s.push(h)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof lt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Bu(e),i=Ya(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const a=[];return se.forEach(s,u=>i.get([u.indexId,this.uid]).next(h=>{a.push(function(_,w){const T=w?new oh(w.sequenceNumber,new Ur(Ra(w.readTime),new Pe(Bi(w.documentKey)),w.largestBatchId)):oh.empty(),E=_.fields.map(([z,j])=>new sf(zt.fromServerFormat(z),j));return new ng(_.indexId,_.collectionGroup,E,T)}(u,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:tt(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Bu(e),s=Ya(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>se.forEach(u,h=>s.put(s1(h.indexId,this.user,a,r)))))}updateIndexEntries(e,n){const r=new Map;return se.forEach(n,(i,s)=>{const a=r.get(i.collectionGroup);return(a?se.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),se.forEach(u,h=>this.gn(e,i,h).next(g=>{const _=this.pn(s,h);return g.isEqual(_)?se.resolve():this.yn(e,s,h,g,_)}))))})}wn(e,n,r,i){return Qa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return Qa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=Qa(e);let s=new At(Ms);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(a,u)=>{s=s.add(new Yo(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>s)}pn(e,n){let r=new At(Ms);const i=this.dn(n,e);if(i==null)return r;const s=bv(n);if(s!=null){const a=e.data.field(s.fieldPath);if(ch(a))for(const u of a.arrayValue.values||[])r=r.add(new Yo(n.indexId,e.key,this.In(u),i))}else r=r.add(new Yo(n.indexId,e.key,Dd,i));return r}yn(e,n,r,i,s){ve("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(h,g,_,w,T){const E=h.getIterator(),z=g.getIterator();let j=Ka(E),J=Ka(z);for(;j||J;){let V=!1,B=!1;if(j&&J){const U=_(j,J);U<0?B=!0:U>0&&(V=!0)}else j!=null?B=!0:V=!0;V?(w(J),J=Ka(z)):B?(T(j),j=Ka(E)):(j=Ka(E),J=Ka(z))}}(i,s,Ms,u=>{a.push(this.wn(e,n,r,u))},u=>{a.push(this.Sn(e,n,r,u))}),se.waitFor(a)}fn(e){let n=1;return Ya(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,u)=>Ms(a,u)).filter((a,u,h)=>!u||Ms(a,h[u-1])!==0);const i=[];i.push(e);for(const a of r){const u=Ms(a,e),h=Ms(a,n);if(u===0)i[0]=e.Ht();else if(u>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(n);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const u=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Dd,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Dd,[]];s.push(IDBKeyRange.bound(u,h))}return s}bn(e,n){return Ms(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(f1)}getMinOffset(e,n){return se.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||Me())).next(f1)}}function d1(t){return Rn(t,"collectionParents")}function Qa(t){return Rn(t,"indexEntries")}function Bu(t){return Rn(t,"indexConfiguration")}function Ya(t){return Rn(t,"indexState")}function f1(t){Fe(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;tw(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Ur(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class vr{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],a=IDBKeyRange.only(n.batchId);let u=0;const h=r.Y({range:a},(_,w,T)=>(u++,T.delete()));s.push(h.next(()=>{Fe(u===1)}));const g=[];for(const _ of n.mutations){const w=Mb(e,_.key.path,n.batchId);s.push(i.delete(w)),g.push(_.key)}return se.waitFor(s).next(()=>g)}function lg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Me();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(41943040,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class Cm{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){Fe(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Cm(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Os(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=ol(e),a=Os(e);return a.add({}).next(u=>{Fe(typeof u=="number");const h=new lw(u,n,r,i),g=function(E,z,j){const J=j.baseMutations.map(B=>gh(E.ut,B)),V=j.mutations.map(B=>gh(E.ut,B));return{userId:z,batchId:j.batchId,localWriteTimeMs:j.localWriteTime.toMillis(),baseMutations:J,mutations:V}}(this.serializer,this.userId,h),_=[];let w=new At((T,E)=>tt(T.canonicalString(),E.canonicalString()));for(const T of i){const E=Mb(this.userId,T.key.path,u);w=w.add(T.key.path.popLast()),_.push(a.put(g)),_.push(s.put(E,l6))}return w.forEach(T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))}),e.addOnCommittedListener(()=>{this.Dn[u]=h.keys()}),se.waitFor(_).next(()=>h)})}lookupMutationBatch(e,n){return Os(e).get(n).next(r=>r?(Fe(r.userId===this.userId),Ko(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?se.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Os(e).Y({index:"userMutationsIndex",range:i},(a,u,h)=>{u.userId===this.userId&&(Fe(u.batchId>=r),s=Ko(this.serializer,u)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Os(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Os(e).W("userMutationsIndex",n).next(r=>r.map(i=>Ko(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=of(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ol(e).Y({range:i},(a,u,h)=>{const[g,_,w]=a,T=Bi(_);if(g===this.userId&&n.path.isEqual(T))return Os(e).get(w).next(E=>{if(!E)throw Me();Fe(E.userId===this.userId),s.push(Ko(this.serializer,E))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new At(tt);const i=[];return n.forEach(s=>{const a=of(this.userId,s.path),u=IDBKeyRange.lowerBound(a),h=ol(e).Y({range:u},(g,_,w)=>{const[T,E,z]=g,j=Bi(E);T===this.userId&&s.path.isEqual(j)?r=r.add(z):w.done()});i.push(h)}),se.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=of(this.userId,r),a=IDBKeyRange.lowerBound(s);let u=new At(tt);return ol(e).Y({range:a},(h,g,_)=>{const[w,T,E]=h,z=Bi(T);w===this.userId&&r.isPrefixOf(z)?z.length===i&&(u=u.add(E)):_.done()}).next(()=>this.vn(e,u))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Os(e).get(s).next(a=>{if(a===null)throw Me();Fe(a.userId===this.userId),r.push(Ko(this.serializer,a))}))}),se.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return kR(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),se.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return se.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return ol(e).Y({range:r},(s,a,u)=>{if(s[0]===this.userId){const h=Bi(s[1]);i.push(h)}else u.done()}).next(()=>{Fe(i.length===0)})})}containsKey(e,n){return NR(e,this.userId,n)}Mn(e){return DR(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function NR(t,e,n){const r=of(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return ol(t).Y({range:s,J:!0},(u,h,g)=>{const[_,w,T]=u;_===e&&w===i&&(a=!0),g.done()}).next(()=>a)}function Os(t){return Rn(t,"mutations")}function ol(t){return Rn(t,"documentMutations")}function DR(t){return Rn(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new ka(0)}static Nn(){return new ka(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new ka(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>Ue.fromTimestamp(new Ht(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Xa(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(Fe(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Xa(e).Y((a,u)=>{const h=nc(u);h.sequenceNumber<=n&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>se.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Xa(e).Y((r,i)=>{const s=nc(i);n(s)})}Bn(e){return m1(e).get("targetGlobalKey").next(n=>(Fe(n!==null),n))}Ln(e,n){return m1(e).put("targetGlobalKey",n)}kn(e,n){return Xa(e).put(PR(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ca(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Xa(e).Y({range:i,index:"queryTargetsIndex"},(a,u,h)=>{const g=nc(u);zh(n,g.target)&&(s=g,h.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=js(e);return n.forEach(a=>{const u=cr(a.path);i.push(s.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,a))}),se.waitFor(i)}removeMatchingKeys(e,n,r){const i=js(e);return se.forEach(n,s=>{const a=cr(s.path);return se.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=js(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=js(e);let s=rt();return i.Y({range:r,J:!0},(a,u,h)=>{const g=Bi(a[1]),_=new Pe(g);s=s.add(_)}).next(()=>s)}containsKey(e,n){const r=cr(n.path),i=IDBKeyRange.bound([r],[Pb(r)],!1,!0);let s=0;return js(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,u],h,g)=>{a!==0&&(s++,g.done())}).next(()=>s>0)}_t(e,n){return Xa(e).get(n).next(r=>r?nc(r):null)}}function Xa(t){return Rn(t,"targets")}function m1(t){return Rn(t,"targetGlobal")}function js(t){return Rn(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1([t,e],[n,r]){const i=tt(t,n);return i===0?tt(e,r):i}class E9{constructor(e){this.Qn=e,this.buffer=new At(p1),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();p1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class T9{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){ve("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){No(n)?ve("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ko(n)}await this.Gn(3e5)})}}class S9{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return se.resolve(Er._e);const r=new E9(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(g1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),g1):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,a,u,h,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,a=Date.now(),this.nthSequenceNumber(e,i))).next(w=>(r=w,u=Date.now(),this.removeTargets(e,r,n))).next(w=>(s=w,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(w=>(g=Date.now(),nl()<=ot.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(h-u)+`ms
	Removed ${w} documents in `+(g-h)+`ms
Total Duration: ${g-_}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:w})))}}function x9(t,e){return new S9(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,n){this.db=e,this.garbageCollector=x9(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return Md(e,r)}removeReference(e,n,r){return Md(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Md(e,n)}Xn(e,n){return function(i,s){let a=!1;return DR(i).Z(u=>NR(i,u,s).next(h=>(h&&(a=!0),se.resolve(!h)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,u)=>{if(u<=n){const h=this.Xn(e,a).next(g=>{if(!g)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Ue.min()),js(e).delete(function(w){return[0,cr(w.path)]}(a))))});i.push(h)}}).next(()=>se.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Md(e,n)}Zn(e,n){const r=js(e);let i,s=Er._e;return r.Y({index:"documentTargetsIndex"},([a,u],{path:h,sequenceNumber:g})=>{a===0?(s!==Er._e&&n(new Pe(Bi(i)),s),s=g,i=h):s=Er._e}).next(()=>{s!==Er._e&&n(new Pe(Bi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Md(t,e){return js(t).put(function(r,i){return{targetId:0,path:cr(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(){this.changes=new Do(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?se.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return zo(e).put(r)}removeEntry(e,n,r){return zo(e).delete(function(s,a){const u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],og(a),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=Vt.newInvalidDocument(n);return zo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Uu(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:Vt.newInvalidDocument(n)};return zo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Uu(n))},(i,s)=>{r={document:this.tr(n,s),size:lg(s)}}).next(()=>r)}getEntries(e,n){let r=Sr();return this.rr(e,n,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,n){let r=Sr(),i=new Nt(Pe.comparator);return this.rr(e,n,(s,a)=>{const u=this.tr(s,a);r=r.insert(s,u),i=i.insert(s,lg(a))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return se.resolve();let i=new At(y1);n.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(Uu(i.first()),Uu(i.last())),a=i.getIterator();let u=a.getNext();return zo(e).Y({index:"documentKeyIndex",range:s},(h,g,_)=>{const w=Pe.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;u&&y1(u,w)<0;)r(u,null),u=a.getNext();u&&u.isEqual(w)&&(r(u,g),u=a.hasNext()?a.getNext():null),u?_.U(Uu(u)):_.done()}).next(()=>{for(;u;)r(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const a=n.path,u=[a.popLast().toArray(),a.lastSegment(),og(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zo(e).W(IDBKeyRange.bound(u,h,!0)).next(g=>{s==null||s.incrementDocumentReadCount(g.length);let _=Sr();for(const w of g){const T=this.tr(Pe.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);T.isFoundDocument()&&(Hh(n,T)||i.has(T.key))&&(_=_.insert(T.key,T))}return _})}getAllFromCollectionGroup(e,n,r,i){let s=Sr();const a=v1(n,r),u=v1(n,Ur.max());return zo(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,u,!0)},(h,g,_)=>{const w=this.tr(Pe.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);s=s.insert(w.key,w),s.size===i&&_.done()}).next(()=>s)}newChangeBuffer(e){return new P9(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return _1(e).get("remoteDocumentGlobalKey").next(n=>(Fe(!!n),n))}er(e,n){return _1(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=d9(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Ue.min())))return r}return Vt.newInvalidDocument(e)}}function OR(t){return new A9(t)}class P9 extends MR{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Do(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new At((s,a)=>tt(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const u=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,u.readTime)),a.isValidDocument()){const h=r1(this._r.serializer,a);i=i.add(s.path.popLast());const g=lg(h);r+=g-u.size,n.push(this._r.addEntry(e,s,h))}else if(r-=u.size,this.trackRemovals){const h=r1(this._r.serializer,a.convertToNoDocument(Ue.min()));n.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),se.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function _1(t){return Rn(t,"remoteDocumentGlobal")}function zo(t){return Rn(t,"remoteDocumentsV14")}function Uu(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function v1(t,e){const n=e.documentKey.path.toArray();return[t,og(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function y1(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=tt(n[s],r[s]),i)return i;return i=tt(n.length,r.length),i||(i=tt(n[n.length-2],r[r.length-2]),i||tt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ic(r.mutation,i,Tr.empty(),Ht.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,rt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=rt()){const i=Ui();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=ec();return s.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Ui();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,rt()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,r,i){let s=Sr();const a=wc(),u=function(){return wc()}();return n.forEach((h,g)=>{const _=r.get(g.key);i.has(g.key)&&(_===void 0||_.mutation instanceof Ps)?s=s.insert(g.key,g):_!==void 0?(a.set(g.key,_.mutation.getFieldMask()),Ic(_.mutation,g,_.mutation.getFieldMask(),Ht.now())):a.set(g.key,Tr.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((g,_)=>a.set(g,_)),n.forEach((g,_)=>{var w;return u.set(g,new b9(_,(w=a.get(g))!==null&&w!==void 0?w:null))}),u))}recalculateAndSaveOverlays(e,n){const r=wc();let i=new Nt((a,u)=>a-u),s=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(h=>{const g=n.get(h);if(g===null)return;let _=r.get(h)||Tr.empty();_=u.applyToLocalView(g,_),r.set(h,_);const w=(i.get(u.batchId)||rt()).add(h);i=i.insert(u.batchId,w)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),g=h.key,_=h.value,w=tR();_.forEach(T=>{if(!s.has(T)){const E=uR(n.get(T),r.get(T));E!==null&&w.set(T,E),s=s.add(T)}}),a.push(this.documentOverlayCache.saveOverlays(e,g,w))}return se.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return Pe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):sw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):se.resolve(Ui());let u=-1,h=s;return a.next(g=>se.forEach(g,(_,w)=>(u<w.largestBatchId&&(u=w.largestBatchId),s.get(_)?se.resolve():this.remoteDocumentCache.getEntry(e,_).next(T=>{h=h.insert(_,T)}))).next(()=>this.populateOverlays(e,g,s)).next(()=>this.computeViews(e,h,g,rt())).next(_=>({batchId:u,changes:eR(_)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Pe(n)).next(r=>{let i=ec();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=ec();return this.indexManager.getCollectionParents(e,s).next(u=>se.forEach(u,h=>{const g=function(w,T){return new As(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(n,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,g,r,i).next(_=>{_.forEach((w,T)=>{a=a.insert(w,T)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((h,g)=>{const _=g.getKey();a.get(_)===null&&(a=a.insert(_,Vt.newInvalidDocument(_)))});let u=ec();return a.forEach((h,g)=>{const _=s.get(h);_!==void 0&&Ic(_.mutation,g,Tr.empty(),Ht.now()),Hh(n,g)&&(u=u.insert(h,g))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return se.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:hn(i.createTime)}}(n)),se.resolve()}getNamedQuery(e,n){return se.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:fw(i.bundledQuery),readTime:hn(i.readTime)}}(n)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k9{constructor(){this.overlays=new Nt(Pe.comparator),this.lr=new Map}getOverlay(e,n){return se.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ui();return se.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),se.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),se.resolve()}getOverlaysForCollection(e,n,r){const i=Ui(),s=n.length+1,a=new Pe(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const h=u.getNext().value,g=h.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return se.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Nt((g,_)=>g-_);const a=this.overlays.getIterator();for(;a.hasNext();){const g=a.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>r){let _=s.get(g.largestBatchId);_===null&&(_=Ui(),s=s.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const u=Ui(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((g,_)=>u.set(g,_)),!(u.size()>=i)););return se.resolve(u)}lt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new cw(n,r));let s=this.lr.get(n);s===void 0&&(s=rt(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(){this.hr=new At(En.Pr),this.Ir=new At(En.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new En(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new En(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new Pe(new gt([])),r=new En(n,e),i=new En(n,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new Pe(new gt([])),r=new En(n,e),i=new En(n,e+1);let s=rt();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new En(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class En{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return Pe.comparator(e.key,n.key)||tt(e.gr,n.gr)}static Tr(e,n){return tt(e.gr,n.gr)||Pe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N9{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new At(En.Pr)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new lw(s,n,r,i);this.mutationQueue.push(a);for(const u of i)this.yr=this.yr.add(new En(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return se.resolve(a)}lookupMutationBatch(e,n){return se.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Sr(r),s=i<0?0:i;return se.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new En(n,0),i=new En(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const u=this.wr(a.gr);s.push(u)}),se.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new At(tt);return n.forEach(i=>{const s=new En(i,0),a=new En(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],u=>{r=r.add(u.gr)})}),se.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Pe.isDocumentKey(s)||(s=s.child(""));const a=new En(new Pe(s),0);let u=new At(tt);return this.yr.forEachWhile(h=>{const g=h.key.path;return!!r.isPrefixOf(g)&&(g.length===i&&(u=u.add(h.gr)),!0)},a),se.resolve(this.br(u))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Fe(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return se.forEach(n.mutations,i=>{const s=new En(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new En(n,0),i=this.yr.firstAfterOrEqual(r);return se.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(e){this.Cr=e,this.docs=function(){return new Nt(Pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return se.resolve(r?r.document.mutableCopy():Vt.newInvalidDocument(n))}getEntries(e,n){let r=Sr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Vt.newInvalidDocument(i))}),se.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Sr();const a=n.path,u=new Pe(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:g,value:{document:_}}=h.getNext();if(!a.isPrefixOf(g.path))break;g.path.length>a.length+1||tw(Rb(_),r)<=0||(i.has(_.key)||Hh(n,_))&&(s=s.insert(_.key,_.mutableCopy()))}return se.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Me()}vr(e,n){return se.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new M9(this)}getSize(e){return se.resolve(this.size)}}class M9 extends MR{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),se.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O9{constructor(e){this.persistence=e,this.Fr=new Do(n=>Ca(n),zh),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.Mr=0,this.Or=new pw,this.targetCount=0,this.Nr=ka.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),se.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new ka(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,se.resolve()}updateTargetData(e,n){return this.kn(n),se.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((a,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),se.waitFor(s).next(()=>i)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return se.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),se.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),se.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),se.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return se.resolve(r)}containsKey(e,n){return se.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,n){this.Br={},this.overlays={},this.Lr=new Er(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new O9(this),this.indexManager=new y9,this.remoteDocumentCache=function(i){return new D9(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new AR(n),this.Kr=new R9(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new k9,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new N9(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){ve("MemoryPersistence","Starting transaction:",e);const i=new L9(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return se.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class L9 extends Nb{constructor(e){super(),this.currentSequenceNumber=e}}class Am{constructor(e){this.persistence=e,this.Gr=new pw,this.zr=null}static jr(e){return new Am(e)}get Hr(){if(this.zr)return this.zr;throw Me()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),se.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),se.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),se.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.Hr,r=>{const i=Pe.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,Ue.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return se.or([()=>se.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V9{constructor(e){this.serializer=e}N(e,n,r,i){const s=new Im("createOrUpgrade",n);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",MT,{unique:!0}),h.createObjectStore("documentMutations")}(e),w1(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=se.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),w1(e)),a=a.next(()=>function(h){const g=h.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ue.min().toTimestamp(),targetCount:0};return g.put("targetGlobalKey",_)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,g){return g.store("mutations").W().next(_=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",MT,{unique:!0});const w=g.store("mutations"),T=_.map(E=>w.put(E));return se.waitFor(T)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const g=h.createObjectStore("documentOverlays",{keyPath:w6});g.createIndex("collectionPathOverlayIndex",I6,{unique:!1}),g.createIndex("collectionGroupOverlayIndex",E6,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const g=h.createObjectStore("remoteDocumentsV14",{keyPath:u6});g.createIndex("documentKeyIndex",c6),g.createIndex("collectionGroupIndex",h6)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:p6}).createIndex("sequenceNumberIndex",_6,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:v6}).createIndex("documentKeyIndex",y6,{unique:!1})}(e))),a}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=lg(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>se.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(u=>se.forEach(u,h=>{Fe(h.userId===s.userId);const g=Ko(this.serializer,h);return kR(e,s.userId,g).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,u)=>{const h=new gt(a),g=function(w){return[0,cr(w)]}(h);s.push(n.get(g).next(_=>_?se.resolve():(w=>n.put({targetId:0,path:cr(w),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>se.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:m6});const r=n.store("collectionParents"),i=new mw,s=a=>{if(i.add(a)){const u=a.lastSegment(),h=a.popLast();return r.put({collectionId:u,parent:cr(h)})}};return n.store("remoteDocuments").Y({J:!0},(a,u)=>{const h=new gt(a);return s(h.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([a,u,h],g)=>{const _=Bi(u);return s(_.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=nc(i),a=PR(this.serializer,s);return n.put(a)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const u=n.store("remoteDocumentsV14"),h=function(w){return w.document?new Pe(gt.fromString(w.document.name).popFirst(5)):w.noDocument?Pe.fromSegments(w.noDocument.path):w.unknownDocument?Pe.fromSegments(w.unknownDocument.path):Me()}(a).path.toArray(),g={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(u.put(g))}).next(()=>se.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=OR(this.serializer),s=new VR(Am.jr,this.serializer.ut);return r.W().next(a=>{const u=new Map;return a.forEach(h=>{var g;let _=(g=u.get(h.userId))!==null&&g!==void 0?g:rt();Ko(this.serializer,h).keys().forEach(w=>_=_.add(w)),u.set(h.userId,_)}),se.forEach(u,(h,g)=>{const _=new Sn(g),w=xm.ct(this.serializer,_),T=s.getIndexManager(_),E=Cm.ct(_,this.serializer,T,s.referenceDelegate);return new LR(i,E,w,T).recalculateAndSaveOverlaysForDocumentKeys(new Rv(n,Er._e),h).next()})})}}function w1(t){t.createObjectStore("targetDocuments",{keyPath:f6}).createIndex("documentTargetsIndex",g6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",d6,{unique:!0}),t.createObjectStore("targetGlobal")}const Fp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class _w{constructor(e,n,r,i,s,a,u,h,g,_,w=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=a,this.document=u,this.oi=g,this._i=_,this.ai=w,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=T=>Promise.resolve(),!_w.D())throw new pe(ue.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new C9(this,i),this.Ii=n+"main",this.serializer=new AR(h),this.Ti=new mi(this.Ii,this.ai,new V9(this.serializer)),this.qr=new I9(this.referenceDelegate,this.serializer),this.remoteDocumentCache=OR(this.serializer),this.Kr=new f9,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,_===!1&&un("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new pe(ue.FAILED_PRECONDITION,Fp);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Er(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Od(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(No(e))return ve("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ve("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return ju(e).get("owner").next(n=>se.resolve(this.wi(n)))}Si(e){return Od(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Rn(n,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(u=>s.indexOf(u)===-1);return se.forEach(a,u=>r.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const n of e)this.Ei.removeItem(this.vi(n.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?se.resolve(!0):ju(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new pe(ue.FAILED_PRECONDITION,Fp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Od(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||a&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ve("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Rv(e,Er._e);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Od(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Cm.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new w9(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return xm.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){ve("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(h){return h===15?S6:h===14?Vb:h===13?Lb:h===12?T6:h===11?Ob:void Me()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,u=>(a=new Rv(u,this.Lr?this.Lr.next():Er._e),n==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw un(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new pe(ue.FAILED_PRECONDITION,kb);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Li(e){return ju(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new pe(ue.FAILED_PRECONDITION,Fp)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ju(e).put("owner",n)}static D(){return mi.D()}pi(e){const n=ju(e);return n.get("owner").next(r=>this.wi(r)?(ve("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):se.resolve())}Di(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(un(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;oL()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return ve("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return un("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){un("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ju(t){return Rn(t,"owner")}function Od(t){return Rn(t,"clientMetadata")}function vw(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=rt(),i=rt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new yw(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F9{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new F9;return this.Hi(e,n,a).next(u=>{if(s.result=u,this.$i)return this.Ji(e,n,a,u.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(nl()<=ot.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",rl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),se.resolve()):(nl()<=ot.DEBUG&&ve("QueryEngine","Query:",rl(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(nl()<=ot.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",rl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hr(n))):se.resolve())}zi(e,n){if(GT(n))return se.resolve(null);let r=hr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=sg(n,null,"F"),r=hr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=rt(...s);return this.Gi.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{const g=this.Yi(n,u);return this.Zi(n,g,a,h.readTime)?this.zi(e,sg(n,null,"F")):this.Xi(e,g,n,h)}))})))}ji(e,n,r,i){return GT(n)||i.isEqual(Ue.min())?se.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(n,s);return this.Zi(n,a,r,i)?se.resolve(null):(nl()<=ot.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),rl(n)),this.Xi(e,a,n,bb(i,-1)).next(u=>u))})}Yi(e,n){let r=new At(Jb(e));return n.forEach((i,s)=>{Hh(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return nl()<=ot.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",rl(n)),this.Gi.getDocumentsMatchingQuery(e,n,Ur.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Nt(tt),this.ns=new Do(s=>Ca(s),zh),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LR(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function BR(t,e,n,r){return new B9(t,e,n,r)}async function UR(t,e){const n=ke(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],u=[];let h=rt();for(const g of i){a.push(g.batchId);for(const _ of g.mutations)h=h.add(_.key)}for(const g of s){u.push(g.batchId);for(const _ of g.mutations)h=h.add(_.key)}return n.localDocuments.getDocuments(r,h).next(g=>({_s:g,removedBatchIds:a,addedBatchIds:u}))})})}function U9(t,e){const n=ke(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(u,h,g,_){const w=g.batch,T=w.keys();let E=se.resolve();return T.forEach(z=>{E=E.next(()=>_.getEntry(h,z)).next(j=>{const J=g.docVersions.get(z);Fe(J!==null),j.version.compareTo(J)<0&&(w.applyToRemoteDocument(j,g),j.isValidDocument()&&(j.setReadTime(g.commitVersion),_.addEntry(j)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(h,w))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=rt();for(let g=0;g<u.mutationResults.length;++g)u.mutationResults[g].transformResults.length>0&&(h=h.add(u.batch.mutations[g].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function jR(t){const e=ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function j9(t,e){const n=ke(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const u=[];e.targetChanges.forEach((_,w)=>{const T=i.get(w);if(!T)return;u.push(n.qr.removeMatchingKeys(s,_.removedDocuments,w).next(()=>n.qr.addMatchingKeys(s,_.addedDocuments,w)));let E=T.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(w)!==null?E=E.withResumeToken(_n.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):_.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(_.resumeToken,r)),i=i.insert(w,E),function(j,J,V){return j.resumeToken.approximateByteSize()===0||J.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(T,E,_)&&u.push(n.qr.updateTargetData(s,E))});let h=Sr(),g=rt();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,_))}),u.push(zR(s,a,e.documentUpdates).next(_=>{h=_.us,g=_.cs})),!r.isEqual(Ue.min())){const _=n.qr.getLastRemoteSnapshotVersion(s).next(w=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(_)}return se.waitFor(u).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,h,g)).next(()=>h)}).then(s=>(n.ts=i,s))}function zR(t,e,n){let r=rt(),i=rt();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=Sr();return n.forEach((u,h)=>{const g=s.get(u);h.isFoundDocument()!==g.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(Ue.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!g.isValidDocument()||h.version.compareTo(g.version)>0||h.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):ve("LocalStore","Ignoring outdated watch update for ",u,". Current version:",g.version," Watch version:",h.version)}),{us:a,cs:i}})}function z9(t,e){const n=ke(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Zl(t,e){const n=ke(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,se.resolve(i)):n.qr.allocateTargetId(r).next(a=>(i=new ds(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function eu(t,e,n){const r=ke(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!No(a))throw a;ve("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function ug(t,e,n){const r=ke(t);let i=Ue.min(),s=rt();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,g,_){const w=ke(h),T=w.ns.get(_);return T!==void 0?se.resolve(w.ts.get(T)):w.qr.getTargetData(g,_)}(r,a,hr(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,u.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,n?i:Ue.min(),n?s:rt())).next(u=>(qR(r,Xb(e),u),{documents:u,ls:s})))}function $R(t,e){const n=ke(t),r=ke(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function HR(t,e){const n=ke(t),r=n.rs.get(e)||Ue.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,bb(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(qR(n,e,i),i))}function qR(t,e,n){let r=t.rs.get(e)||Ue.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}async function $9(t,e,n,r){const i=ke(t);let s=rt(),a=Sr();for(const g of n){const _=e.hs(g.metadata.name);g.document&&(s=s.add(_));const w=e.Ps(g);w.setReadTime(e.Is(g.metadata.readTime)),a=a.insert(_,w)}const u=i.ss.newChangeBuffer({trackRemovals:!0}),h=await Zl(i,function(_){return hr(pu(gt.fromString(`__bundle__/docs/${_}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",g=>zR(g,u,a).next(_=>(u.apply(g),_)).next(_=>i.qr.removeMatchingKeysForTargetId(g,h.targetId).next(()=>i.qr.addMatchingKeys(g,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(g,_.us,_.cs)).next(()=>_.us)))}async function H9(t,e,n=rt()){const r=await Zl(t,hr(fw(e.bundledQuery))),i=ke(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=hn(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const u=r.withResumeToken(_n.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(u.targetId,u),i.qr.updateTargetData(s,u).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function I1(t,e){return`firestore_clients_${t}_${e}`}function E1(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Bp(t,e){return`firestore_targets_${t}_${e}`}class cg{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new pe(i.error.code,i.error.message))),a?new cg(e,n,i.state,s):(un("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ec{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new pe(r.error.code,r.error.message))),s?new Ec(e,r.state,i):(un("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class hg{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=ow();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=Db(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new hg(e,s):(un("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class ww{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new ww(n.clientId,n.onlineState):(un("SharedClientState",`Failed to parse online state: ${e}`),null)}}class $v{constructor(){this.activeTargetIds=ow()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Up{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Nt(tt),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=I1(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new $v),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(I1(this.persistenceKey,r));if(i){const s=hg.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const n=this.storage.getItem(this.Cs);if(n){const r=this.Ms(n);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Bp(this.persistenceKey,e));if(r){const i=Ec.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bp(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ve("SharedClientState","READ",e,n),n}setItem(e,n){ve("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){ve("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const n=e;if(n.storageArea===this.storage){if(ve("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void un("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){const r=this.Ks(n.key);return this.$s(r,null)}{const r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){const r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){const r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){const r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){const r=function(s){let a=Er._e;if(s!=null)try{const u=JSON.parse(s);Fe(typeof u=="number"),a=u}catch(u){un("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(n.newValue);r!==Er._e&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){const r=this.Hs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new cg(this.currentUser,e,n,r),s=E1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=E1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){const n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){const i=Bp(this.persistenceKey,e),s=new Ec(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return hg.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return cg.Ts(new Sn(s),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return Ec.Ts(i,n)}Ms(e){return ww.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);ve("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],u=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||u.push(h)}),this.syncEngine.Xs(a,u).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=ow();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class GR{constructor(){this.eo=new $v,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new $v,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){ve("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){ve("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ld=null;function jp(){return Ld===null?Ld=function(){return 268435456+Math.round(2147483648*Math.random())}():Ld++,"0x"+Ld.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W9{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="WebChannelConnection";class K9 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,a){const u=jp(),h=this.So(n,r);ve("RestConnection",`Sending RPC '${n}' ${u}:`,h,i);const g={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(g,s,a),this.Do(n,h,g,i).then(_=>(ve("RestConnection",`Received RPC '${n}' ${u}: `,_),_),_=>{throw Ei("RestConnection",`RPC '${n}' ${u} failed with error: `,_,"url: ",h,"request:",i),_})}Co(n,r,i,s,a,u){return this.wo(n,r,i,s,a)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}So(n,r){const i=G9[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=jp();return new Promise((a,u)=>{const h=new $B;h.setWithCredentials(!0),h.listenOnce(jB.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Lp.NO_ERROR:const _=h.getResponseJson();ve(Kn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(_)),a(_);break;case Lp.TIMEOUT:ve(Kn,`RPC '${e}' ${s} timed out`),u(new pe(ue.DEADLINE_EXCEEDED,"Request time out"));break;case Lp.HTTP_ERROR:const w=h.getStatus();if(ve(Kn,`RPC '${e}' ${s} failed with status:`,w,"response text:",h.getResponseText()),w>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const E=T==null?void 0:T.error;if(E&&E.status&&E.message){const z=function(J){const V=J.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(V)>=0?V:ue.UNKNOWN}(E.status);u(new pe(z,E.message))}else u(new pe(ue.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new pe(ue.UNAVAILABLE,"Connection failed."));break;default:Me()}}finally{ve(Kn,`RPC '${e}' ${s} completed.`)}});const g=JSON.stringify(i);ve(Kn,`RPC '${e}' ${s} sending request:`,i),h.send(n,"POST",g,r,15)})}vo(e,n,r){const i=jp(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=BB(),u=UB(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(h.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;const _=s.join("");ve(Kn,`Creating RPC '${e}' stream ${i}: ${_}`,h);const w=a.createWebChannel(_,h);let T=!1,E=!1;const z=new W9({co:J=>{E?ve(Kn,`Not sending because RPC '${e}' stream ${i} is closed:`,J):(T||(ve(Kn,`Opening RPC '${e}' stream ${i} transport.`),w.open(),T=!0),ve(Kn,`RPC '${e}' stream ${i} sending:`,J),w.send(J))},lo:()=>w.close()}),j=(J,V,B)=>{J.listen(V,U=>{try{B(U)}catch(Z){setTimeout(()=>{throw Z},0)}})};return j(w,kd.EventType.OPEN,()=>{E||ve(Kn,`RPC '${e}' stream ${i} transport opened.`)}),j(w,kd.EventType.CLOSE,()=>{E||(E=!0,ve(Kn,`RPC '${e}' stream ${i} transport closed`),z.Ro())}),j(w,kd.EventType.ERROR,J=>{E||(E=!0,Ei(Kn,`RPC '${e}' stream ${i} transport errored:`,J),z.Ro(new pe(ue.UNAVAILABLE,"The operation could not be completed")))}),j(w,kd.EventType.MESSAGE,J=>{var V;if(!E){const B=J.data[0];Fe(!!B);const U=B,Z=U.error||((V=U[0])===null||V===void 0?void 0:V.error);if(Z){ve(Kn,`RPC '${e}' stream ${i} received error:`,Z);const ne=Z.status;let te=function(_e){const me=dn[_e];if(me!==void 0)return dR(me)}(ne),ae=Z.message;te===void 0&&(te=ue.INTERNAL,ae="Unknown error status: "+ne+" with message "+Z.message),E=!0,z.Ro(new pe(te,ae)),w.close()}else ve(Kn,`RPC '${e}' stream ${i} received:`,B),z.Vo(B)}}),j(u,zB.STAT_EVENT,J=>{J.stat===RT.PROXY?ve(Kn,`RPC '${e}' stream ${i} detected buffering proxy`):J.stat===RT.NOPROXY&&ve(Kn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{z.Ao()},0),z}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(){return typeof window<"u"?window:null}function hf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(t){return new n9(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e,n,r,i,s,a,u,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Iw(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,n){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===ue.RESOURCE_EXHAUSTED?(un(n.toString()),un("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(n)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new pe(ue.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return ve("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(ve("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Q9 extends KR{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=s9(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?hn(a.readTime):Ue.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=fh(this.serializer),n.addTarget=function(s,a){let u;const h=a.target;if(u=rg(h)?{documents:IR(s,h)}:{query:ER(s,h)},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=pR(s,a.resumeToken);const g=Vv(s,a.expectedCount);g!==null&&(u.expectedCount=g)}else if(a.snapshotVersion.compareTo(Ue.min())>0){u.readTime=Jl(s,a.snapshotVersion.toTimestamp());const g=Vv(s,a.expectedCount);g!==null&&(u.expectedCount=g)}return u}(this.serializer,e);const r=a9(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=fh(this.serializer),n.removeTarget=e,this.e_(n)}}class Y9 extends KR{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=o9(e.writeResults,e.commitTime),r=hn(e.commitTime);return this.listener.I_(r,n)}return Fe(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=fh(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gh(this.serializer,r))};this.e_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X9 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new pe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new pe(ue.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,n,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new pe(ue.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class J9{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(un(n),this.f_=!1):ve("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z9{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{Mo(this)&&(ve("RemoteStore","Restarting streams for network reachability change."),await async function(h){const g=ke(h);g.C_.add(4),await yu(g),g.M_.set("Unknown"),g.C_.delete(4),await Qh(g)}(this))})}),this.M_=new J9(r,i)}}async function Qh(t){if(Mo(t))for(const e of t.v_)await e(!0)}async function yu(t){for(const e of t.v_)await e(!1)}function Pm(t,e){const n=ke(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),Sw(n)?Tw(n):Iu(n).Ho()&&Ew(n,e))}function mh(t,e){const n=ke(t),r=Iu(n);n.D_.delete(e),r.Ho()&&QR(n,e),n.D_.size===0&&(r.Ho()?r.Zo():Mo(n)&&n.M_.set("Unknown"))}function Ew(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Iu(t).u_(e)}function QR(t,e){t.x_.Oe(e),Iu(t).c_(e)}function Tw(t){t.x_=new J6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Iu(t).start(),t.M_.g_()}function Sw(t){return Mo(t)&&!Iu(t).jo()&&t.D_.size>0}function Mo(t){return ke(t).C_.size===0}function YR(t){t.x_=void 0}async function eU(t){t.D_.forEach((e,n)=>{Ew(t,e)})}async function tU(t,e){YR(t),Sw(t)?(t.M_.w_(e),Tw(t)):t.M_.set("Unknown")}async function nU(t,e,n){if(t.M_.set("Online"),e instanceof mR&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const u of s.targetIds)i.D_.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.D_.delete(u),i.x_.removeTarget(u))}(t,e)}catch(r){ve("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dg(t,r)}else if(e instanceof cf?t.x_.$e(e):e instanceof gR?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(Ue.min()))try{const r=await jR(t.localStore);n.compareTo(r)>=0&&await function(s,a){const u=s.x_.it(a);return u.targetChanges.forEach((h,g)=>{if(h.resumeToken.approximateByteSize()>0){const _=s.D_.get(g);_&&s.D_.set(g,_.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,g)=>{const _=s.D_.get(h);if(!_)return;s.D_.set(h,_.withResumeToken(_n.EMPTY_BYTE_STRING,_.snapshotVersion)),QR(s,h);const w=new ds(_.target,h,g,_.sequenceNumber);Ew(s,w)}),s.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){ve("RemoteStore","Failed to raise snapshot:",r),await dg(t,r)}}async function dg(t,e,n){if(!No(e))throw e;t.C_.add(1),await yu(t),t.M_.set("Offline"),n||(n=()=>jR(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ve("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await Qh(t)})}function XR(t,e){return e().catch(n=>dg(t,n,e))}async function wu(t){const e=ke(t),n=yo(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;rU(e);)try{const i=await z9(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,iU(e,i)}catch(i){await dg(e,i)}JR(e)&&ZR(e)}function rU(t){return Mo(t)&&t.b_.length<10}function iU(t,e){t.b_.push(e);const n=yo(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function JR(t){return Mo(t)&&!yo(t).jo()&&t.b_.length>0}function ZR(t){yo(t).start()}async function sU(t){yo(t).E_()}async function oU(t){const e=yo(t);for(const n of t.b_)e.P_(n.mutations)}async function aU(t,e,n){const r=t.b_.shift(),i=uw.from(r,e,n);await XR(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await wu(t)}async function lU(t,e){e&&yo(t).h_&&await async function(r,i){if(function(a){return hR(a)&&a!==ue.ABORTED}(i.code)){const s=r.b_.shift();yo(r).Yo(),await XR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await wu(r)}}(t,e),JR(t)&&ZR(t)}async function S1(t,e){const n=ke(t);n.asyncQueue.verifyOperationInProgress(),ve("RemoteStore","RemoteStore received new credentials");const r=Mo(n);n.C_.add(3),await yu(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await Qh(n)}async function Hv(t,e){const n=ke(t);e?(n.C_.delete(2),await Qh(n)):e||(n.C_.add(2),await yu(n),n.M_.set("Unknown"))}function Iu(t){return t.O_||(t.O_=function(n,r,i){const s=ke(n);return s.A_(),new Q9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:eU.bind(null,t),Io:tU.bind(null,t),a_:nU.bind(null,t)}),t.v_.push(async e=>{e?(t.O_.Yo(),Sw(t)?Tw(t):t.M_.set("Unknown")):(await t.O_.stop(),YR(t))})),t.O_}function yo(t){return t.N_||(t.N_=function(n,r,i){const s=ke(n);return s.A_(),new Y9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:sU.bind(null,t),Io:lU.bind(null,t),T_:oU.bind(null,t),I_:aU.bind(null,t)}),t.v_.push(async e=>{e?(t.N_.Yo(),await wu(t)):(await t.N_.stop(),t.b_.length>0&&(ve("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))})),t.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Cn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,u=new xw(e,n,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pe(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Eu(t,e){if(un("AsyncQueue",`${e}: ${t}`),No(t))return new pe(ue.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Pe.comparator(n.key,r.key):(n,r)=>Pe.comparator(n.key,r.key),this.keyedMap=ec(),this.sortedSet=new Nt(this.comparator)}static emptySet(e){return new Ml(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ml)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ml;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(){this.B_=new Nt(Pe.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):Me():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class tu{constructor(e,n,r,i,s,a,u,h,g){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=g}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new tu(e,n,Ml.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(){this.k_=void 0,this.listeners=[]}}class cU{constructor(){this.queries=new Do(e=>Yb(e),$h),this.onlineState="Unknown",this.q_=new Set}}async function Cw(t,e){const n=ke(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new uU),i)try{s.k_=await n.onListen(r)}catch(a){const u=Eu(a,`Initialization of query '${rl(e.query)}' failed`);return void e.onError(u)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&Pw(n)}async function Aw(t,e){const n=ke(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function hU(t,e){const n=ke(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const u of a.listeners)u.K_(i)&&(r=!0);a.k_=i}}r&&Pw(n)}function dU(t,e,n){const r=ke(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function Pw(t){t.q_.forEach(e=>{e.next()})}class bw{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new tu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e){this.serializer=e}hs(e){return qi(this.serializer,e)}Ps(e){return e.metadata.exists?wR(this.serializer,e.document,!1):Vt.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return hn(e)}}class gU{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ek(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=gt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new C1(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const u=(n.get(a)||rt()).add(s);n.set(a,u)}}return n}async complete(){const e=await $9(this.localStore,new C1(this.serializer),this.documents,this.X_.id),n=this.ta(this.documents);for(const r of this.queries)await H9(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function ek(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.key=e}}class nk{constructor(e){this.key=e}}class rk{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=rt(),this.mutatedKeys=rt(),this._a=Jb(e),this.aa=new Ml(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new x1,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,g=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((_,w)=>{const T=i.get(_),E=Hh(this.query,w)?w:null,z=!!T&&this.mutatedKeys.has(T.key),j=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let J=!1;T&&E?T.data.isEqual(E.data)?z!==j&&(r.track({type:3,doc:E}),J=!0):this.ha(T,E)||(r.track({type:2,doc:E}),J=!0,(h&&this._a(E,h)>0||g&&this._a(E,g)<0)&&(u=!0)):!T&&E?(r.track({type:0,doc:E}),J=!0):T&&!E&&(r.track({type:1,doc:T}),J=!0,(h||g)&&(u=!0)),J&&(E?(a=a.add(E),s=j?s.add(_):s.delete(_)):(a=a.delete(_),s=s.delete(_)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const _=this.query.limitType==="F"?a.last():a.first();a=a.delete(_.key),s=s.delete(_.key),r.track({type:1,doc:_})}return{aa:a,la:r,Zi:u,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((_,w)=>function(E,z){const j=J=>{switch(J){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me()}};return j(E)-j(z)}(_.type,w.type)||this._a(_.doc,w.doc)),this.Pa(r),i=i!=null&&i;const u=n&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,g=h!==this.sa;return this.sa=h,a.length!==0||g?{snapshot:new tu(this.query,e.aa,s,a,e.mutatedKeys,h===0,g,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:u}:{Ta:u}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new x1,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=rt(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new nk(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new tk(r))}),n}da(e){this.ia=e.ls,this.oa=rt();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return tu.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class mU{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class pU{constructor(e){this.key=e,this.Ra=!1}}class _U{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new Do(u=>Yb(u),$h),this.fa=new Map,this.ga=new Set,this.pa=new Nt(Pe.comparator),this.ya=new Map,this.wa=new pw,this.Sa={},this.ba=new Map,this.Da=ka.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function vU(t,e){const n=Mw(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await Zl(n.localStore,hr(e)),u=n.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await Rw(n,e,r,u==="current",a.resumeToken),n.isPrimaryClient&&Pm(n.remoteStore,a)}return i}async function Rw(t,e,n,r,i){t.va=(w,T,E)=>async function(j,J,V,B){let U=J.view.ca(V);U.Zi&&(U=await ug(j.localStore,J.query,!1).then(({documents:ae})=>J.view.ca(ae,U)));const Z=B&&B.targetChanges.get(J.targetId),ne=B&&B.targetMismatches.get(J.targetId)!=null,te=J.view.applyChanges(U,j.isPrimaryClient,Z,ne);return qv(j,J.targetId,te.Ta),te.snapshot}(t,w,T,E);const s=await ug(t.localStore,e,!0),a=new rk(e,s.ls),u=a.ca(s.documents),h=Wh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),g=a.applyChanges(u,t.isPrimaryClient,h);qv(t,n,g.Ta);const _=new mU(e,n,a);return t.ma.set(e,_),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),g.snapshot}async function yU(t,e){const n=ke(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!$h(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await eu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),mh(n.remoteStore,r.targetId),nu(n,r.targetId)}).catch(ko)):(nu(n,r.targetId),await eu(n.localStore,r.targetId,!0))}async function wU(t,e,n){const r=Ow(t);try{const i=await function(a,u){const h=ke(a),g=Ht.now(),_=u.reduce((E,z)=>E.add(z.key),rt());let w,T;return h.persistence.runTransaction("Locally write mutations","readwrite",E=>{let z=Sr(),j=rt();return h.ss.getEntries(E,_).next(J=>{z=J,z.forEach((V,B)=>{B.isValidDocument()||(j=j.add(V))})}).next(()=>h.localDocuments.getOverlayedDocuments(E,z)).next(J=>{w=J;const V=[];for(const B of u){const U=Q6(B,w.get(B.key).overlayedDocument);U!=null&&V.push(new Ps(B.key,U,jb(U.value.mapValue),$t.exists(!0)))}return h.mutationQueue.addMutationBatch(E,g,V,u)}).next(J=>{T=J;const V=J.applyToLocalDocumentSet(w,j);return h.documentOverlayCache.saveOverlays(E,J.batchId,V)})}).then(()=>({batchId:T.batchId,changes:eR(w)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let g=a.Sa[a.currentUser.toKey()];g||(g=new Nt(tt)),g=g.insert(u,h),a.Sa[a.currentUser.toKey()]=g}(r,i.batchId,n),await bs(r,i.changes),await wu(r.remoteStore)}catch(i){const s=Eu(i,"Failed to persist write");n.reject(s)}}async function ik(t,e){const n=ke(t);try{const r=await j9(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.ya.get(s);a&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?Fe(a.Ra):i.removedDocuments.size>0&&(Fe(a.Ra),a.Ra=!1))}),await bs(n,r,e)}catch(r){await ko(r)}}function A1(t,e,n){const r=ke(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.ma.forEach((s,a)=>{const u=a.view.Q_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){const h=ke(a);h.onlineState=u;let g=!1;h.queries.forEach((_,w)=>{for(const T of w.listeners)T.Q_(u)&&(g=!0)}),g&&Pw(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function IU(t,e,n){const r=ke(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Nt(Pe.comparator);a=a.insert(s,Vt.newNoDocument(s,Ue.min()));const u=rt().add(s),h=new Gh(Ue.min(),new Map,new Nt(tt),a,u);await ik(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),Dw(r)}else await eu(r.localStore,e,!1).then(()=>nu(r,e,n)).catch(ko)}async function EU(t,e){const n=ke(t),r=e.batch.batchId;try{const i=await U9(n.localStore,e);Nw(n,r,null),kw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bs(n,i)}catch(i){await ko(i)}}async function TU(t,e,n){const r=ke(t);try{const i=await function(a,u){const h=ke(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let _;return h.mutationQueue.lookupMutationBatch(g,u).next(w=>(Fe(w!==null),_=w.keys(),h.mutationQueue.removeMutationBatch(g,w))).next(()=>h.mutationQueue.performConsistencyCheck(g)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(g,_,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_)).next(()=>h.localDocuments.getDocuments(g,_))})}(r.localStore,e);Nw(r,e,n),kw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await bs(r,i)}catch(i){await ko(i)}}async function SU(t,e){const n=ke(t);Mo(n.remoteStore)||ve("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const u=ke(a);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=Eu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function kw(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function Nw(t,e,n){const r=ke(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function nu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||sk(t,r)})}function sk(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);n!==null&&(mh(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),Dw(t))}function qv(t,e,n){for(const r of n)r instanceof tk?(t.wa.addReference(r.key,e),xU(t,r)):r instanceof nk?(ve("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||sk(t,r.key)):Me()}function xU(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(ve("SyncEngine","New document in limbo: "+n),t.ga.add(r),Dw(t))}function Dw(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new Pe(gt.fromString(e)),r=t.Da.next();t.ya.set(r,new pU(n)),t.pa=t.pa.insert(n,r),Pm(t.remoteStore,new ds(hr(pu(n.path)),r,"TargetPurposeLimboResolution",Er._e))}}async function bs(t,e,n){const r=ke(t),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((u,h)=>{a.push(r.va(h,e,n).then(g=>{if((g||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,g!=null&&g.fromCache?"not-current":"current"),g){i.push(g);const _=yw.Qi(h.targetId,g);s.push(_)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,g){const _=ke(h);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>se.forEach(g,T=>se.forEach(T.ki,E=>_.persistence.referenceDelegate.addReference(w,T.targetId,E)).next(()=>se.forEach(T.qi,E=>_.persistence.referenceDelegate.removeReference(w,T.targetId,E)))))}catch(w){if(!No(w))throw w;ve("LocalStore","Failed to update sequence numbers: "+w)}for(const w of g){const T=w.targetId;if(!w.fromCache){const E=_.ts.get(T),z=E.snapshotVersion,j=E.withLastLimboFreeSnapshotVersion(z);_.ts=_.ts.insert(T,j)}}}(r.localStore,s))}async function CU(t,e){const n=ke(t);if(!n.currentUser.isEqual(e)){ve("SyncEngine","User change. New user:",e.toKey());const r=await UR(n.localStore,e);n.currentUser=e,function(s,a){s.ba.forEach(u=>{u.forEach(h=>{h.reject(new pe(ue.CANCELLED,a))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bs(n,r._s)}}function AU(t,e){const n=ke(t),r=n.ya.get(e);if(r&&r.Ra)return rt().add(r.key);{let i=rt();const s=n.fa.get(e);if(!s)return i;for(const a of s){const u=n.ma.get(a);i=i.unionWith(u.view.ua)}return i}}async function PU(t,e){const n=ke(t),r=await ug(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&qv(n,e.targetId,i.Ta),i}async function bU(t,e){const n=ke(t);return HR(n.localStore,e).then(r=>bs(n,r))}async function RU(t,e,n,r){const i=ke(t),s=await function(u,h){const g=ke(u),_=ke(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",w=>_.Cn(w,h).next(T=>T?g.localDocuments.getDocuments(w,T):se.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await wu(i.remoteStore):n==="acknowledged"||n==="rejected"?(Nw(i,e,r||null),kw(i,e),function(u,h){ke(ke(u).mutationQueue).Fn(h)}(i.localStore,e)):Me(),await bs(i,s)):ve("SyncEngine","Cannot apply mutation batch with id: "+e)}async function kU(t,e){const n=ke(t);if(Mw(n),Ow(n),e===!0&&n.Ca!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await P1(n,r.toArray());n.Ca=!0,await Hv(n.remoteStore,!0);for(const s of i)Pm(n.remoteStore,s)}else if(e===!1&&n.Ca!==!1){const r=[];let i=Promise.resolve();n.fa.forEach((s,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(nu(n,a),eu(n.localStore,a,!0))),mh(n.remoteStore,a)}),await i,await P1(n,r),function(a){const u=ke(a);u.ya.forEach((h,g)=>{mh(u.remoteStore,g)}),u.wa.Vr(),u.ya=new Map,u.pa=new Nt(Pe.comparator)}(n),n.Ca=!1,await Hv(n.remoteStore,!1)}}async function P1(t,e,n){const r=ke(t),i=[],s=[];for(const a of e){let u;const h=r.fa.get(a);if(h&&h.length!==0){u=await Zl(r.localStore,hr(h[0]));for(const g of h){const _=r.ma.get(g),w=await PU(r,_);w.snapshot&&s.push(w.snapshot)}}else{const g=await $R(r.localStore,a);u=await Zl(r.localStore,g),await Rw(r,ok(g),a,!1,u.resumeToken)}i.push(u)}return r.Va.a_(s),i}function ok(t){return Qb(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function NU(t){return function(n){return ke(ke(n).persistence).Bi()}(ke(t).localStore)}async function DU(t,e,n,r){const i=ke(t);if(i.Ca)return void ve("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const a=await HR(i.localStore,Xb(s[0])),u=Gh.createSynthesizedRemoteEventForCurrentChange(e,n==="current",_n.EMPTY_BYTE_STRING);await bs(i,a,u);break}case"rejected":await eu(i.localStore,e,!0),nu(i,e,r);break;default:Me()}}async function MU(t,e,n){const r=Mw(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){ve("SyncEngine","Adding an already active target "+i);continue}const s=await $R(r.localStore,i),a=await Zl(r.localStore,s);await Rw(r,ok(s),a.targetId,!1,a.resumeToken),Pm(r.remoteStore,a)}for(const i of n)r.fa.has(i)&&await eu(r.localStore,i,!1).then(()=>{mh(r.remoteStore,i),nu(r,i)}).catch(ko)}}function Mw(t){const e=ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ik.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IU.bind(null,e),e.Va.a_=hU.bind(null,e.eventManager),e.Va.Fa=dU.bind(null,e.eventManager),e}function Ow(t){const e=ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=TU.bind(null,e),e}function OU(t,e,n){const r=ke(t);(async function(s,a,u){try{const h=await a.getMetadata();if(await function(E,z){const j=ke(E),J=hn(z.createTime);return j.persistence.runTransaction("hasNewerBundle","readonly",V=>j.Kr.getBundleMetadata(V,z.id)).then(V=>!!V&&V.createTime.compareTo(J)>=0)}(s.localStore,h))return await a.close(),u._completeWith(function(E){return{taskState:"Success",documentsLoaded:E.totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}}(h)),Promise.resolve(new Set);u._updateProgress(ek(h));const g=new gU(h,s.localStore,a.serializer);let _=await a.Ma();for(;_;){const T=await g.ea(_);T&&u._updateProgress(T),_=await a.Ma()}const w=await g.complete();return await bs(s,w.ra,void 0),await function(E,z){const j=ke(E);return j.persistence.runTransaction("Save bundle","readwrite",J=>j.Kr.saveBundleMetadata(J,z))}(s.localStore,h),u._completeWith(w.progress),Promise.resolve(w.na)}catch(h){return Ei("SyncEngine",`Loading bundle failed with ${h}`),u._failWith(h),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Gv{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Kh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return BR(this.persistence,new FR,e.initialUser,this.serializer)}createPersistence(e){return new VR(Am.jr,this.serializer)}createSharedClientState(e){return new GR}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ak extends Gv{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Ow(this.xa.syncEngine),await wu(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return BR(this.persistence,new FR,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new T9(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new o6(n,this.persistence);return new s6(e.asyncQueue,r)}createPersistence(e){const n=vw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new _w(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,WR(),hf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new GR}}class LU extends ak{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xa.syncEngine;this.sharedClientState instanceof Up&&(this.sharedClientState.syncEngine={Ys:RU.bind(null,n),Zs:DU.bind(null,n),Xs:MU.bind(null,n),Bi:NU.bind(null,n),Js:bU.bind(null,n)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await kU(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=WR();if(!Up.D(n))throw new pe(ue.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=vw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Up(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Lw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>A1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=CU.bind(null,this.syncEngine),await Hv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new cU}()}createDatastore(e){const n=Kh(e.databaseInfo.databaseId),r=function(s){return new K9(s)}(e.databaseInfo);return function(s,a,u,h){return new X9(s,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,u){return new Z9(r,i,s,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>A1(this.syncEngine,n,0),function(){return T1.D()?new T1:new q9}())}createSyncEngine(e,n){return function(i,s,a,u,h,g,_){const w=new _U(i,s,a,u,h,g);return _&&(w.Ca=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=ke(n);ve("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await yu(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):un("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Cn,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const n=this.La.decode(e),r=Number(n);isNaN(r)&&this.Qa(`length string (${n}) is not valid number`);const i=await this.Ka(r);return new fU(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e===123)}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const n=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new pe(ue.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,s){const a=ke(i),u=fh(a.serializer)+"/documents",h={documents:s.map(T=>dh(a.serializer,T))},g=await a.Co("BatchGetDocuments",u,h,s.length),_=new Map;g.forEach(T=>{const E=i9(a.serializer,T);_.set(E.key.toString(),E)});const w=[];return s.forEach(T=>{const E=_.get(T.toString());Fe(!!E),w.push(E)}),w}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=Pe.fromPath(r);this.mutations.push(new aw(i,this.precondition(i)))}),await async function(r,i){const s=ke(r),a=fh(s.serializer)+"/documents",u={writes:i.map(h=>gh(s.serializer,h))};await s.wo("Commit",a,u)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Me();n=Ue.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new pe(ue.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ue.min())?$t.exists(!1):$t.updateTime(n):$t.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ue.min()))throw new pe(ue.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $t.updateTime(n)}return $t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new Iw(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new FU(this.datastore),n=this.za(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const n=this.updateFunction(e);return!jh(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!hR(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Sn.UNAUTHENTICATED,this.clientId=Ab.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{ve("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(ve("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new pe(ue.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Eu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function df(t,e){t.asyncQueue.verifyOperationInProgress(),ve("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await UR(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Wv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Vw(t);ve("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>S1(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>S1(e.remoteStore,s)),t._onlineComponents=e}function lk(t){return t.name==="FirebaseError"?t.code===ue.FAILED_PRECONDITION||t.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function Vw(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ve("FirestoreClient","Using user provided OfflineComponentProvider");try{await df(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!lk(n))throw n;Ei("Error using user provided cache. Falling back to memory cache: "+n),await df(t,new Gv)}}else ve("FirestoreClient","Using default OfflineComponentProvider"),await df(t,new Gv);return t._offlineComponents}async function Rm(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ve("FirestoreClient","Using user provided OnlineComponentProvider"),await Wv(t,t._uninitializedComponentsProvider._online)):(ve("FirestoreClient","Using default OnlineComponentProvider"),await Wv(t,new Lw))),t._onlineComponents}function uk(t){return Vw(t).then(e=>e.persistence)}function Fw(t){return Vw(t).then(e=>e.localStore)}function ck(t){return Rm(t).then(e=>e.remoteStore)}function Bw(t){return Rm(t).then(e=>e.syncEngine)}function jU(t){return Rm(t).then(e=>e.datastore)}async function ru(t){const e=await Rm(t),n=e.eventManager;return n.onListen=vU.bind(null,e.syncEngine),n.onUnlisten=yU.bind(null,e.syncEngine),n}function zU(t){return t.asyncQueue.enqueue(async()=>{const e=await uk(t),n=await ck(t);return e.setNetworkEnabled(!0),function(i){const s=ke(i);return s.C_.delete(0),Qh(s)}(n)})}function $U(t){return t.asyncQueue.enqueue(async()=>{const e=await uk(t),n=await ck(t);return e.setNetworkEnabled(!1),async function(i){const s=ke(i);s.C_.add(0),await yu(s),s.M_.set("Offline")}(n)})}function HU(t,e){const n=new Cn;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const u=await function(g,_){const w=ke(g);return w.persistence.runTransaction("read document","readonly",T=>w.localDocuments.getDocument(T,_))}(i,s);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new pe(ue.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const h=Eu(u,`Failed to get document '${s} from cache`);a.reject(h)}}(await Fw(t),e,n)),n.promise}function hk(t,e,n={}){const r=new Cn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,u,h,g){const _=new bm({next:T=>{a.enqueueAndForget(()=>Aw(s,w));const E=T.docs.has(u);!E&&T.fromCache?g.reject(new pe(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&T.fromCache&&h&&h.source==="server"?g.reject(new pe(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),w=new bw(pu(u.path),_,{includeMetadataChanges:!0,J_:!0});return Cw(s,w)}(await ru(t),t.asyncQueue,e,n,r)),r.promise}function qU(t,e){const n=new Cn;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const u=await ug(i,s,!0),h=new rk(s,u.ls),g=h.ca(u.documents),_=h.applyChanges(g,!1);a.resolve(_.snapshot)}catch(u){const h=Eu(u,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Fw(t),e,n)),n.promise}function dk(t,e,n={}){const r=new Cn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,u,h,g){const _=new bm({next:T=>{a.enqueueAndForget(()=>Aw(s,w)),T.fromCache&&h.source==="server"?g.reject(new pe(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),w=new bw(u,_,{includeMetadataChanges:!0,J_:!0});return Cw(s,w)}(await ru(t),t.asyncQueue,e,n,r)),r.promise}function GU(t,e){const n=new bm(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){ke(i).q_.add(s),s.next()}(await ru(t),n)),()=>{n.Na(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){ke(i).q_.delete(s)}(await ru(t),n))}}function WU(t,e,n,r){const i=function(a,u){let h;return h=typeof a=="string"?fR().encode(a):a,function(_,w){return new VU(_,w)}(function(_,w){if(_ instanceof Uint8Array)return b1(_,w);if(_ instanceof ArrayBuffer)return b1(new Uint8Array(_),w);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),u)}(n,Kh(e));t.asyncQueue.enqueueAndForget(async()=>{OU(await Bw(t),i,r)})}function KU(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=ke(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await Fw(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(t,e,n){if(!n)throw new pe(ue.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function gk(t,e,n,r){if(e===!0&&r===!0)throw new pe(ue.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function k1(t){if(!Pe.isDocumentKey(t))throw new pe(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function N1(t){if(Pe.isDocumentKey(t))throw new pe(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function km(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Me()}function _t(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new pe(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=km(t);throw new pe(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function mk(t,e){if(e<=0)throw new pe(ue.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new pe(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new pe(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new pe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new pe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new pe(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D1({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new pe(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new pe(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new KB;switch(r.type){case"firstParty":return new JB(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new pe(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=R1.get(n);r&&(ve("ComponentProvider","Removing Datastore"),R1.delete(n),r.terminate())}(this),Promise.resolve()}}function QU(t,e,n,r={}){var i;const s=(t=_t(t,Yh))._getSettings(),a=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Ei("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=Sn.MOCK_USER;else{u=rL(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new pe(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Sn(g)}t._authCredentials=new QB(new Cb(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dr=class pk{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pk(this.firestore,e,this._query)}},Wt=class _k{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new so(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _k(this.firestore,e,this._key)}},so=class vk extends dr{constructor(e,n,r){super(e,n,pu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wt(this.firestore,null,new Pe(e))}withConverter(e){return new vk(this.firestore,e,this._path)}};function yk(t,e,...n){if(t=qe(t),Uw("collection","path",e),t instanceof Yh){const r=gt.fromString(e,...n);return N1(r),new so(t,null,r)}{if(!(t instanceof Wt||t instanceof so))throw new pe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(gt.fromString(e,...n));return N1(r),new so(t.firestore,null,r)}}function YU(t,e){if(t=_t(t,Yh),Uw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new pe(ue.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dr(t,null,function(r){return new As(gt.emptyPath(),r)}(e))}function fg(t,e,...n){if(t=qe(t),arguments.length===1&&(e=Ab.newId()),Uw("doc","path",e),t instanceof Yh){const r=gt.fromString(e,...n);return k1(r),new Wt(t,null,new Pe(r))}{if(!(t instanceof Wt||t instanceof so))throw new pe(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(gt.fromString(e,...n));return k1(r),new Wt(t.firestore,t instanceof so?t.converter:null,new Pe(r))}}function wk(t,e){return t=qe(t),e=qe(e),(t instanceof Wt||t instanceof so)&&(e instanceof Wt||e instanceof so)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Ik(t,e){return t=qe(t),e=qe(e),t instanceof dr&&e instanceof dr&&t.firestore===e.firestore&&$h(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Iw(this,"async_queue_retry"),this.iu=()=>{const n=hf();n&&ve("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=hf();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=hf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new Cn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!No(e))throw e;ve("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw un("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=xw.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Me()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function Kv(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class JU{constructor(){this._progressObserver={},this._taskCompletionResolver=new Cn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZU=-1;let tn=class extends Yh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new XU}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Ek(this),this._firestoreClient.terminate()}};function kn(t){return t._firestoreClient||Ek(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ek(t){var e,n,r;const i=t._freezeSettings(),s=function(u,h,g,_){return new A6(u,h,g,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,fk(_.experimentalLongPollingOptions),_.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new UU(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function ej(t,e){Sk(t=_t(t,tn));const n=kn(t);if(n._uninitializedComponentsProvider)throw new pe(ue.FAILED_PRECONDITION,"SDK cache is already specified.");Ei("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new Lw;return Tk(n,i,new ak(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function tj(t){Sk(t=_t(t,tn));const e=kn(t);if(e._uninitializedComponentsProvider)throw new pe(ue.FAILED_PRECONDITION,"SDK cache is already specified.");Ei("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new Lw;return Tk(e,r,new LU(r,n.cacheSizeBytes))}function Tk(t,e,n){const r=new Cn;return t.asyncQueue.enqueue(async()=>{try{await df(t,n),await Wv(t,e),r.resolve()}catch(i){const s=i;if(!lk(s))throw s;Ei("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function nj(t){if(t._initialized&&!t._terminated)throw new pe(ue.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Cn;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!mi.D())return Promise.resolve();const i=r+"main";await mi.delete(i)}(vw(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function rj(t){return function(n){const r=new Cn;return n.asyncQueue.enqueueAndForget(async()=>SU(await Bw(n),r)),r.promise}(kn(t=_t(t,tn)))}function ij(t){return zU(kn(t=_t(t,tn)))}function sj(t){return $U(kn(t=_t(t,tn)))}function oj(t,e){const n=kn(t=_t(t,tn)),r=new JU;return WU(n,t._databaseId,e,r),r}function aj(t,e){return KU(kn(t=_t(t,tn)),e).then(n=>n?new dr(t,null,n.query):null)}function Sk(t){if(t._initialized||t._terminated)throw new pe(ue.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yi(_n.fromBase64String(e))}catch(n){throw new pe(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Yi(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wo=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new pe(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ua=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new pe(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new pe(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return tt(this._lat,e._lat)||tt(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=/^__.*__$/;class uj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ps(e,this.data,this.fieldMask,n,this.fieldTransforms):new _u(e,this.data,n,this.fieldTransforms)}}class xk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ps(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Ck(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me()}}class Dm{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Dm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return gg(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(Ck(this.Iu)&&lj.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class cj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Kh(e)}pu(e,n,r,i=!1){return new Dm({Iu:e,methodName:n,gu:r,path:zt.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ja(t){const e=t._freezeSettings(),n=Kh(t._databaseId);return new cj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Mm(t,e,n,r,i,s={}){const a=t.pu(s.merge||s.mergeFields?2:0,e,n,i);Hw("Data must be an object, but it was:",a,r);const u=bk(r,a);let h,g;if(s.merge)h=new Tr(a.fieldMask),g=a.fieldTransforms;else if(s.mergeFields){const _=[];for(const w of s.mergeFields){const T=Qv(e,w,n);if(!a.contains(T))throw new pe(ue.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);kk(_,T)||_.push(T)}h=new Tr(_),g=a.fieldTransforms.filter(w=>h.covers(w.field))}else h=null,g=a.fieldTransforms;return new uj(new Ln(u),h,g)}class Xh extends Ua{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xh}}function Ak(t,e,n){return new Dm({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class jw extends Ua{_toFieldTransform(e){return new qh(e.path,new Yl)}isEqual(e){return e instanceof jw}}class hj extends Ua{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=Ak(this,e,!0),r=this.yu.map(s=>za(s,n)),i=new Aa(r);return new qh(e.path,i)}isEqual(e){return this===e}}class dj extends Ua{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=Ak(this,e,!0),r=this.yu.map(s=>za(s,n)),i=new Pa(r);return new qh(e.path,i)}isEqual(e){return this===e}}class fj extends Ua{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new Xl(e.serializer,iR(e.serializer,this.wu));return new qh(e.path,n)}isEqual(e){return this===e}}function zw(t,e,n,r){const i=t.pu(1,e,n);Hw("Data must be an object, but it was:",i,r);const s=[],a=Ln.empty();Ba(r,(h,g)=>{const _=qw(e,h,n);g=qe(g);const w=i.Ru(_);if(g instanceof Xh)s.push(_);else{const T=za(g,w);T!=null&&(s.push(_),a.set(_,T))}});const u=new Tr(s);return new xk(a,u,i.fieldTransforms)}function $w(t,e,n,r,i,s){const a=t.pu(1,e,n),u=[Qv(e,r,n)],h=[i];if(s.length%2!=0)throw new pe(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<s.length;T+=2)u.push(Qv(e,s[T])),h.push(s[T+1]);const g=[],_=Ln.empty();for(let T=u.length-1;T>=0;--T)if(!kk(g,u[T])){const E=u[T];let z=h[T];z=qe(z);const j=a.Ru(E);if(z instanceof Xh)g.push(E);else{const J=za(z,j);J!=null&&(g.push(E),_.set(E,J))}}const w=new Tr(g);return new xk(_,w,a.fieldTransforms)}function Pk(t,e,n,r=!1){return za(n,t.pu(r?4:3,e))}function za(t,e){if(Rk(t=qe(t)))return Hw("Unsupported field value:",e,t),bk(t,e);if(t instanceof Ua)return function(r,i){if(!Ck(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const u of r){let h=za(u,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return iR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ht.fromDate(r);return{timestampValue:Jl(i.serializer,s)}}if(r instanceof Ht){const s=new Ht(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jl(i.serializer,s)}}if(r instanceof Nm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yi)return{bytesValue:pR(i.serializer,r._byteString)};if(r instanceof Wt){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:dw(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${km(r)}`)}(t,e)}function bk(t,e){const n={};return Fb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ba(t,(r,i)=>{const s=za(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Rk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ht||t instanceof Nm||t instanceof Yi||t instanceof Wt||t instanceof Ua)}function Hw(t,e,n){if(!Rk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=km(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function Qv(t,e,n){if((e=qe(e))instanceof wo)return e._internalPath;if(typeof e=="string")return qw(t,e);throw gg("Field path arguments must be of type string or ",t,!1,void 0,n)}const gj=new RegExp("[~\\*/\\[\\]]");function qw(t,e,n){if(e.search(gj)>=0)throw gg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wo(...e.split("."))._internalPath}catch{throw gg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function gg(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new pe(ue.INVALID_ARGUMENT,u+t+h)}function kk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Om("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class mj extends ph{data(){return super.data()}}function Om(t,e){return typeof e=="string"?qw(t,e):e instanceof wo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new pe(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gw{}class Jh extends Gw{}function Ls(t,e,...n){let r=[];e instanceof Gw&&r.push(e),r=r.concat(n),function(s){const a=s.filter(h=>h instanceof Ww).length,u=s.filter(h=>h instanceof Lm).length;if(a>1||a>0&&u>0)throw new pe(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Lm extends Jh{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Lm(e,n,r)}_apply(e){const n=this._parse(e);return Mk(e._query,n),new dr(e.firestore,e.converter,Lv(e._query,n))}_parse(e){const n=ja(e.firestore);return function(s,a,u,h,g,_,w){let T;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new pe(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){O1(w,_);const E=[];for(const z of w)E.push(M1(h,s,z));T={arrayValue:{values:E}}}else T=M1(h,s,w)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||O1(w,_),T=Pk(u,a,w,_==="in"||_==="not-in");return lt.create(g,_,T)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function pj(t,e,n){const r=e,i=Om("where",t);return Lm._create(i,r,n)}class Ww extends Gw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ww(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Et.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const u=s.getFlattenedFilters();for(const h of u)Mk(a,h),a=Lv(a,h)}(e._query,n),new dr(e.firestore,e.converter,Lv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Kw extends Jh{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Kw(e,n)}_apply(e){const n=function(i,s,a){if(i.startAt!==null)throw new pe(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new pe(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hh(s,a)}(e._query,this._field,this._direction);return new dr(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new As(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function _j(t,e="asc"){const n=e,r=Om("orderBy",t);return Kw._create(r,n)}class Vm extends Jh{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Vm(e,n,r)}_apply(e){return new dr(e.firestore,e.converter,sg(e._query,this._limit,this._limitType))}}function vj(t){return mk("limit",t),Vm._create("limit",t,"F")}function yj(t){return mk("limitToLast",t),Vm._create("limitToLast",t,"L")}class Fm extends Jh{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Fm(e,n,r)}_apply(e){const n=Dk(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,function(i,s){return new As(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function wj(...t){return Fm._create("startAt",t,!0)}function Ij(...t){return Fm._create("startAfter",t,!1)}class Bm extends Jh{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Bm(e,n,r)}_apply(e){const n=Dk(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,function(i,s){return new As(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function Ej(...t){return Bm._create("endBefore",t,!1)}function Tj(...t){return Bm._create("endAt",t,!0)}function Dk(t,e,n,r){if(n[0]=qe(n[0]),n[0]instanceof ph)return function(s,a,u,h,g){if(!h)throw new pe(ue.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const _=[];for(const w of Dl(s))if(w.field.isKeyField())_.push(xa(a,h.key));else{const T=h.data.field(w.field);if(Em(T))throw new pe(ue.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const E=w.field.canonicalString();throw new pe(ue.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}_.push(T)}return new vo(_,g)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=ja(t.firestore);return function(a,u,h,g,_,w){const T=a.explicitOrderBy;if(_.length>T.length)throw new pe(ue.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let z=0;z<_.length;z++){const j=_[z];if(T[z].field.isKeyField()){if(typeof j!="string")throw new pe(ue.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof j}`);if(!sw(a)&&j.indexOf("/")!==-1)throw new pe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${j}' contains a slash.`);const J=a.path.child(gt.fromString(j));if(!Pe.isDocumentKey(J))throw new pe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${J}' is not because it contains an odd number of segments.`);const V=new Pe(J);E.push(xa(u,V))}else{const J=Pk(h,g,j);E.push(J)}}return new vo(E,w)}(t._query,t.firestore._databaseId,i,e,n,r)}}function M1(t,e,n){if(typeof(n=qe(n))=="string"){if(n==="")throw new pe(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sw(e)&&n.indexOf("/")!==-1)throw new pe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(gt.fromString(n));if(!Pe.isDocumentKey(r))throw new pe(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xa(t,new Pe(r))}if(n instanceof Wt)return xa(t,n._key);throw new pe(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${km(n)}.`)}function O1(t,e){if(!Array.isArray(t)||t.length===0)throw new pe(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mk(t,e){const n=function(i,s){for(const a of i)for(const u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new pe(ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pe(ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Qw{convertValue(e,n="none"){switch(Sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Me()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ba(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Nm(Jt(e.latitude),Jt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=rw(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(lh(e));default:return null}}convertTimestamp(e){const n=go(e);return new Ht(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=gt.fromString(e);Fe(CR(r));const i=new po(r.get(1),r.get(3)),s=new Pe(r.popFirst(5));return i.isEqual(n)||un(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Sj extends Qw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Wt(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Ts=class extends ph{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Tc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Om("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Tc=class extends Ts{data(e={}){return super.data(e)}},Io=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new sa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Tc(this._firestore,this._userDataWriter,r.key,r,new sa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pe(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{const h=new Tc(i._firestore,i._userDataWriter,u.doc.key,u.doc,new sa(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const h=new Tc(i._firestore,i._userDataWriter,u.doc.key,u.doc,new sa(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let g=-1,_=-1;return u.type!==0&&(g=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),_=a.indexOf(u.doc.key)),{type:xj(u.type),doc:h,oldIndex:g,newIndex:_}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function xj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me()}}function Ok(t,e){return t instanceof Ts&&e instanceof Ts?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Io&&e instanceof Io&&t._firestore===e._firestore&&Ik(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cj(t){t=_t(t,Wt);const e=_t(t.firestore,tn);return hk(kn(e),t._key).then(n=>Yw(e,t,n))}class $a extends Qw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Wt(this.firestore,null,n)}}function Aj(t){t=_t(t,Wt);const e=_t(t.firestore,tn),n=kn(e),r=new $a(e);return HU(n,t._key).then(i=>new Ts(e,r,t._key,i,new sa(i!==null&&i.hasLocalMutations,!0),t.converter))}function Pj(t){t=_t(t,Wt);const e=_t(t.firestore,tn);return hk(kn(e),t._key,{source:"server"}).then(n=>Yw(e,t,n))}function bj(t){t=_t(t,dr);const e=_t(t.firestore,tn),n=kn(e),r=new $a(e);return Nk(t._query),dk(n,t._query).then(i=>new Io(e,r,t,i))}function Rj(t){t=_t(t,dr);const e=_t(t.firestore,tn),n=kn(e),r=new $a(e);return qU(n,t._query).then(i=>new Io(e,r,t,i))}function kj(t){t=_t(t,dr);const e=_t(t.firestore,tn),n=kn(e),r=new $a(e);return dk(n,t._query,{source:"server"}).then(i=>new Io(e,r,t,i))}function L1(t,e,n){t=_t(t,Wt);const r=_t(t.firestore,tn),i=Um(t.converter,e,n);return Zh(r,[Mm(ja(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,$t.none())])}function V1(t,e,n,...r){t=_t(t,Wt);const i=_t(t.firestore,tn),s=ja(i);let a;return a=typeof(e=qe(e))=="string"||e instanceof wo?$w(s,"updateDoc",t._key,e,n,r):zw(s,"updateDoc",t._key,e),Zh(i,[a.toMutation(t._key,$t.exists(!0))])}function Nj(t){return Zh(_t(t.firestore,tn),[new vu(t._key,$t.none())])}function Dj(t,e){const n=_t(t.firestore,tn),r=fg(t),i=Um(t.converter,e);return Zh(n,[Mm(ja(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,$t.exists(!1))]).then(()=>r)}function Lk(t,...e){var n,r,i;t=qe(t);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||Kv(e[a])||(s=e[a],a++);const u={includeMetadataChanges:s.includeMetadataChanges};if(Kv(e[a])){const w=e[a];e[a]=(n=w.next)===null||n===void 0?void 0:n.bind(w),e[a+1]=(r=w.error)===null||r===void 0?void 0:r.bind(w),e[a+2]=(i=w.complete)===null||i===void 0?void 0:i.bind(w)}let h,g,_;if(t instanceof Wt)g=_t(t.firestore,tn),_=pu(t._key.path),h={next:w=>{e[a]&&e[a](Yw(g,t,w))},error:e[a+1],complete:e[a+2]};else{const w=_t(t,dr);g=_t(w.firestore,tn),_=w._query;const T=new $a(g);h={next:E=>{e[a]&&e[a](new Io(g,T,w,E))},error:e[a+1],complete:e[a+2]},Nk(t._query)}return function(T,E,z,j){const J=new bm(j),V=new bw(E,J,z);return T.asyncQueue.enqueueAndForget(async()=>Cw(await ru(T),V)),()=>{J.Na(),T.asyncQueue.enqueueAndForget(async()=>Aw(await ru(T),V))}}(kn(g),_,u,h)}function Mj(t,e){return GU(kn(t=_t(t,tn)),Kv(e)?e:{next:e})}function Zh(t,e){return function(r,i){const s=new Cn;return r.asyncQueue.enqueueAndForget(async()=>wU(await Bw(r),i,s)),s.promise}(kn(t),e)}function Yw(t,e,n){const r=n.docs.get(e._key),i=new $a(t);return new Ts(t,i,e._key,r,new sa(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lj=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ja(e)}set(e,n,r){this._verifyNotCommitted();const i=zs(e,this._firestore),s=Um(i.converter,n,r),a=Mm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,$t.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=zs(e,this._firestore);let a;return a=typeof(n=qe(n))=="string"||n instanceof wo?$w(this._dataReader,"WriteBatch.update",s._key,n,r,i):zw(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(a.toMutation(s._key,$t.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=zs(e,this._firestore);return this._mutations=this._mutations.concat(new vu(n._key,$t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pe(ue.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function zs(t,e){if((t=qe(t)).firestore!==e)throw new pe(ue.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vj=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ja(n)}get(n){const r=zs(n,this._firestore),i=new Sj(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Me();const a=s[0];if(a.isFoundDocument())return new ph(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new ph(this._firestore,i,r._key,null,r.converter);throw Me()})}set(n,r,i){const s=zs(n,this._firestore),a=Um(s.converter,r,i),u=Mm(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,u),this}update(n,r,i,...s){const a=zs(n,this._firestore);let u;return u=typeof(r=qe(r))=="string"||r instanceof wo?$w(this._dataReader,"Transaction.update",a._key,r,i,s):zw(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,u),this}delete(n){const r=zs(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=zs(e,this._firestore),r=new $a(this._firestore);return super.get(e).then(i=>new Ts(this._firestore,r,n._key,i._document,new sa(!1,!1),n.converter))}};function Fj(t,e,n){t=_t(t,tn);const r=Object.assign(Object.assign({},Oj),n);return function(s){if(s.maxAttempts<1)throw new pe(ue.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,u){const h=new Cn;return s.asyncQueue.enqueueAndForget(async()=>{const g=await jU(s);new BU(s.asyncQueue,g,u,a,h).run()}),h.promise}(kn(t),i=>e(new Vj(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(){return new Xh("deleteField")}function Uj(){return new jw("serverTimestamp")}function jj(...t){return new hj("arrayUnion",t)}function zj(...t){return new dj("arrayRemove",t)}function $j(t){return new fj("increment",t)}(function(e,n=!0){(function(i){mu=i})(Ao),ho(new Wi("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),u=new tn(new YB(r.getProvider("auth-internal")),new e6(r.getProvider("app-check-internal")),function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new pe(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new po(g.options.projectId,_)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Hi(kT,"4.4.0",e),Hi(kT,"4.4.0","esm2017")})();const Hj="@firebase/firestore-compat",qj="0.3.23";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new pe("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){if(typeof Uint8Array>"u")throw new pe("unimplemented","Uint8Arrays are not available in this environment.")}function B1(){if(!x6())throw new pe("unimplemented","Blobs are unavailable in Firestore in this environment.")}let Vk=class Yv{constructor(e){this._delegate=e}static fromBase64String(e){return B1(),new Yv(Yi.fromBase64String(e))}static fromUint8Array(e){return F1(),new Yv(Yi.fromUint8Array(e))}toBase64(){return B1(),this._delegate.toBase64()}toUint8Array(){return F1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t){return Gj(t,["next","error","complete"])}function Gj(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{enableIndexedDbPersistence(e,n){return ej(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return tj(e._delegate)}clearIndexedDbPersistence(e){return nj(e._delegate)}}class Fk{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof po||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ei("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){QU(this._delegate,e,n,r)}enableNetwork(){return ij(this._delegate)}disableNetwork(){return sj(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,gk("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return rj(this._delegate)}onSnapshotsInSync(e){return Mj(this._delegate,e)}get app(){if(!this._appCompat)throw new pe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new iu(this,yk(this._delegate,e))}catch(n){throw ir(n,"collection()","Firestore.collection()")}}doc(e){try{return new Jr(this,fg(this._delegate,e))}catch(n){throw ir(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new rr(this,YU(this._delegate,e))}catch(n){throw ir(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Fj(this._delegate,n=>e(new Bk(this,n)))}batch(){return kn(this._delegate),new Uk(new Lj(this._delegate,e=>Zh(this._delegate,e)))}loadBundle(e){return oj(this._delegate,e)}namedQuery(e){return aj(this._delegate,e).then(n=>n?new rr(this,n):null)}}class jm extends Qw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vk(new Yi(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Jr.forKey(n,this.firestore,null)}}function Kj(t){GB(t)}class Bk{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new jm(e)}get(e){const n=oa(e);return this._delegate.get(n).then(r=>new _h(this._firestore,new Ts(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=oa(e);return r?(Xw("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=oa(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=oa(e);return this._delegate.delete(n),this}}class Uk{constructor(e){this._delegate=e}set(e,n,r){const i=oa(e);return r?(Xw("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=oa(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=oa(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Na{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new Tc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vh(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Na.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Na(e,new jm(e),n),i.set(n,s)),s}}Na.INSTANCES=new WeakMap;class Jr{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new jm(e)}static forPath(e,n,r){if(e.length%2!==0)throw new pe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Jr(n,new Wt(n._delegate,r,new Pe(e)))}static forKey(e,n,r){return new Jr(n,new Wt(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new iu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new iu(this.firestore,yk(this._delegate,e))}catch(n){throw ir(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=qe(e),e instanceof Wt?wk(this._delegate,e):!1}set(e,n){n=Xw("DocumentReference.set",n);try{return n?L1(this._delegate,e,n):L1(this._delegate,e)}catch(r){throw ir(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?V1(this._delegate,e):V1(this._delegate,e,n,...r)}catch(i){throw ir(i,"updateDoc()","DocumentReference.update()")}}delete(){return Nj(this._delegate)}onSnapshot(...e){const n=jk(e),r=zk(e,i=>new _h(this.firestore,new Ts(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Lk(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=Aj(this._delegate):(e==null?void 0:e.source)==="server"?n=Pj(this._delegate):n=Cj(this._delegate),n.then(r=>new _h(this.firestore,new Ts(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Jr(this.firestore,e?this._delegate.withConverter(Na.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ir(t,e,n){return t.message=t.message.replace(e,n),t}function jk(t){for(const e of t)if(typeof e=="object"&&!Xv(e))return e;return{}}function zk(t,e){var n,r;let i;return Xv(t[0])?i=t[0]:Xv(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class _h{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Jr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Ok(this._delegate,e._delegate)}}class vh extends _h{data(e){const n=this._delegate.data(e);return this._delegate._converter||WB(n!==void 0),n}}class rr{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new jm(e)}where(e,n,r){try{return new rr(this.firestore,Ls(this._delegate,pj(e,n,r)))}catch(i){throw ir(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new rr(this.firestore,Ls(this._delegate,_j(e,n)))}catch(r){throw ir(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new rr(this.firestore,Ls(this._delegate,vj(e)))}catch(n){throw ir(n,"limit()","Query.limit()")}}limitToLast(e){try{return new rr(this.firestore,Ls(this._delegate,yj(e)))}catch(n){throw ir(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new rr(this.firestore,Ls(this._delegate,wj(...e)))}catch(n){throw ir(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new rr(this.firestore,Ls(this._delegate,Ij(...e)))}catch(n){throw ir(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new rr(this.firestore,Ls(this._delegate,Ej(...e)))}catch(n){throw ir(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new rr(this.firestore,Ls(this._delegate,Tj(...e)))}catch(n){throw ir(n,"endAt()","Query.endAt()")}}isEqual(e){return Ik(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=Rj(this._delegate):(e==null?void 0:e.source)==="server"?n=kj(this._delegate):n=bj(this._delegate),n.then(r=>new Jv(this.firestore,new Io(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=jk(e),r=zk(e,i=>new Jv(this.firestore,new Io(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Lk(this._delegate,n,r)}withConverter(e){return new rr(this.firestore,e?this._delegate.withConverter(Na.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Qj{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new vh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Jv{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new rr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new vh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Qj(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new vh(this._firestore,r))})}isEqual(e){return Ok(this._delegate,e._delegate)}}class iu extends rr{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Jr(this.firestore,e):null}doc(e){try{return e===void 0?new Jr(this.firestore,fg(this._delegate)):new Jr(this.firestore,fg(this._delegate,e))}catch(n){throw ir(n,"doc()","CollectionReference.doc()")}}add(e){return Dj(this._delegate,e).then(n=>new Jr(this.firestore,n))}isEqual(e){return wk(this._delegate,e._delegate)}withConverter(e){return new iu(this.firestore,e?this._delegate.withConverter(Na.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function oa(t){return _t(t,Wt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(...e){this._delegate=new wo(...e)}static documentId(){return new Jw(zt.keyField().canonicalString())}isEqual(e){return e=qe(e),e instanceof wo?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e){this._delegate=e}static serverTimestamp(){const e=Uj();return e._methodName="FieldValue.serverTimestamp",new Xo(e)}static delete(){const e=Bj();return e._methodName="FieldValue.delete",new Xo(e)}static arrayUnion(...e){const n=jj(...e);return n._methodName="FieldValue.arrayUnion",new Xo(n)}static arrayRemove(...e){const n=zj(...e);return n._methodName="FieldValue.arrayRemove",new Xo(n)}static increment(e){const n=$j(e);return n._methodName="FieldValue.increment",new Xo(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj={Firestore:Fk,GeoPoint:Nm,Timestamp:Ht,Blob:Vk,Transaction:Bk,WriteBatch:Uk,DocumentReference:Jr,DocumentSnapshot:_h,Query:rr,QueryDocumentSnapshot:vh,QuerySnapshot:Jv,CollectionReference:iu,FieldPath:Jw,FieldValue:Xo,setLogLevel:Kj,CACHE_SIZE_UNLIMITED:ZU};function Xj(t,e){t.INTERNAL.registerComponent(new Wi("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Yj)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jj(t){Xj(t,(e,n)=>new Fk(e,n,new Wj)),t.registerVersion(Hj,qj)}Jj(Rt);Rt.initializeApp({apiKey:"AIzaSyAHOemftrTSOUjtoA6K3VR2hkOU5H-ScSI",authDomain:"amstangram.firebaseapp.com",databaseURL:"https://amstangram.firebaseio.com",projectId:"amstangram",storageBucket:"amstangram.appspot.com",messagingSenderId:"1075176148116",appId:"1:1075176148116:web:e61e6512cd983a75533881",measurementId:"G-PLH3BSWLM2"});const Zj=t=>{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},ez=t=>{let e=t.length,n,r;for(;e!==0;)r=Math.floor(Math.random()*e),e-=1,n=t[e],t[e]=t[r],t[r]=n;return t},tz=Xi(fe,{css:{fontSize:3,p:2,borderRadius:1,bg:"notificationBackground",color:"dialogText",animation:`${Wr/2}ms fadeIn both`,boxShadow:"0px 0px 10px #00000080"}}),si=G.createContext(null),nz=({children:t})=>{const e=G.useRef(),[n,r]=G.useState(null),i=G.useCallback(s=>{r(a=>(a&&clearTimeout(a.timeoutId),{content:s,timeoutId:setTimeout(()=>{r(null)},2e3)}))},[]);return R.jsxs(si.Provider,{value:i,children:[t,n&&Jy.createPortal(R.jsx(fe,{css:{position:"fixed",top:0,left:0,bottom:0,right:0,pointerEvents:"none",alignItems:"center",justifyContent:"center"},children:R.jsx(tz,{ref:e,children:n.content})}),document.getElementById("notificationContainer"))]})},zn=G.createContext(null),rz=({children:t})=>{const[e,n]=G.useState(void 0),[r,i]=G.useState(null),[s,a]=G.useState(!1);G.useEffect(()=>{e!==void 0&&r!==null&&a(!0)},[e,r]),G.useEffect(()=>Rt.auth().onAuthStateChanged(async T=>{if(!T)n(null);else{const z=(await Rt.firestore().collection("users").doc(T.uid).get()).data();n({uid:T.uid,...z,firebaseUser:T})}}),[]),G.useEffect(()=>Rt.firestore().collection("users").onSnapshot(T=>{const E={};for(const z of T.docs){const j=z.data();E[z.id]=j}i(E)}),[]);const u=G.useCallback(async(w,T)=>{await w.firebaseUser.updateProfile({displayName:T}),await Rt.firestore().collection("users").doc(w.uid).update({username:T}),n({...w,username:T})},[]),h=G.useCallback(async(w,T,E)=>{const z=Rt.auth.EmailAuthProvider.credential(w.firebaseUser.email,T);await w.firebaseUser.reauthenticateWithCredential(z),await w.firebaseUser.updatePassword(E)},[]),g=G.useCallback(async(w,T,E)=>{const z=Rt.auth.EmailAuthProvider.credential(w.firebaseUser.email,E);await w.firebaseUser.reauthenticateWithCredential(z),await w.firebaseUser.updateEmail(T)},[]),_=G.useMemo(()=>({initialized:s,currentUser:e,usersMetadata:r,updateUsername:u,updatePassword:h,updateEmail:g}),[s,e,r,u,h,g]);return R.jsx(zn.Provider,{value:_,children:t})},Oo=G.createContext([]),iz=({children:t})=>{const{currentUser:e}=G.useContext(zn),[n,r]=G.useState(null);G.useEffect(()=>Rt.firestore().collection("tangrams").onSnapshot(a=>{const u=[];for(const h of a.docs){const g=h.id,{..._}=h.data();u.push({id:g,..._})}r(u)}),[]);const i=G.useMemo(()=>{if(!n)return{initialized:!1,approvedTangrams:null,pendingTangrams:null,approvedTangramsByCategory:null};const s=[],a=[];for(const u of n)u.approved?s.push(u):e&&(e.isAdmin||u.uid===e.uid)&&a.push(u);return{initialized:!0,approvedTangrams:s,pendingTangrams:a}},[e,n]);return R.jsx(Oo.Provider,{value:i,children:t})},br=G.createContext(null),sz=({children:t})=>{const e=Yt(),n=G.useContext(si),{currentUser:r}=G.useContext(zn),{approvedTangrams:i}=G.useContext(Oo),[s,a]=G.useState(null),[u,h]=G.useState(null),[g,_]=G.useState(null),[w,T]=G.useState(0),[E,z]=G.useState(!1);G.useEffect(()=>{s&&u&&z(!0)},[s,u]),G.useEffect(()=>Rt.firestore().collection("stats").onSnapshot(ce=>{const _e={},me={};for(const Ze of ce.docs){const Oe=Ze.id,xe=Ze.data();_e[Oe]||(_e[Oe]={},me[Oe]={});for(const we in xe)_e[Oe][we]=xe[we].completed,me[Oe][we]=xe[we].starred}a(_e),h(me)}),[]);const j=G.useCallback(ae=>!r||!u[ae]?!1:u[ae][r.uid]===!0,[r,u]),J=G.useCallback(ae=>!r||!s[ae]?!1:s[ae][r.uid]!==void 0,[r,s]),V=G.useCallback(ae=>{let ce=`${window.location.origin}/?tangrams=${ae.map(({id:_e})=>_e).join(",")}`;r&&(ce+=`&uid=${r.uid}`),Zj(ce),n(e.formatMessage({id:"Challenge link copied to clipboard"}))},[n,r,e]),B=G.useCallback(()=>{T(ae=>ae+1)},[]),U=G.useCallback(ae=>{const ce=ae?({id:me,edges:Ze},{id:Oe,edges:xe})=>{const we=J(me),et=J(Oe);return!we&&!et?xe-Ze:we-et}:({id:me},{id:Ze})=>{const Oe=J(me),xe=J(Ze);return Oe-xe},_e=ez([...i]).sort(ce);_(_e)},[i,J]),Z=G.useCallback(async(ae,ce)=>{r&&i.some(_e=>_e.id===ae.id)&&!J(ae.id)&&await Rt.firestore().collection("stats").doc(ae.id).set({[r.uid]:{completed:ce}},{merge:!0})},[i,r,J]),ne=G.useCallback(async ae=>{if(r&&i.some(ce=>ce.id===ae.id)){const ce=j(ae.id);await Rt.firestore().collection("stats").doc(ae.id).set({[r.uid]:{starred:!ce}},{merge:!0})}},[i,r,j]),te=G.useMemo(()=>({initialized:E,requestSave:B,saveRequestId:w,playlist:g,setPlaylist:_,shareTangrams:V,startRandomPlaylist:U,tangramsCompletedBy:s,tangramsStarredBy:u,toggleTangramStar:ne,markTangramAsComplete:Z,isTangramCompleted:J,isTangramStarred:j}),[E,B,w,g,V,U,s,u,ne,Z,J,j]);return R.jsx(br.Provider,{value:te,children:t})};var $k={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},U1=It.createContext&&It.createContext($k),oo=function(){return oo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},oo.apply(this,arguments)},oz=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Hk(t){return t&&t.map(function(e,n){return It.createElement(e.tag,oo({key:n},e.attr),Hk(e.child))})}function mr(t){return function(e){return It.createElement(az,oo({attr:oo({},t.attr)},e),Hk(t.child))}}function az(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,a=oz(t,["attr","size","title"]),u=i||n.size||"1em",h;return n.className&&(h=n.className),t.className&&(h=(h?h+" ":"")+t.className),It.createElement("svg",oo({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:h,style:oo(oo({color:t.color||n.color},n.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),s&&It.createElement("title",null,s),t.children)};return U1!==void 0?It.createElement(U1.Consumer,null,function(n){return e(n)}):e($k)}function qk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"}},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"}}]})(t)}function lz(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(t)}function Gk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"}},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"}}]})(t)}function Wk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(t)}function uz(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}}]})(t)}function cz(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"}}]})(t)}function Kk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(t)}function Qk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(t)}function Yk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"}},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"}},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"}}]})(t)}function Eo(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(t)}function hz(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"}},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"}},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"}},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}}]})(t)}function Xk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(t)}function dz(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"path",attr:{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"}}]})(t)}function fz(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"line",attr:{x1:"23",y1:"9",x2:"17",y2:"15"}},{tag:"line",attr:{x1:"17",y1:"9",x2:"23",y2:"15"}}]})(t)}function Jk(t){return mr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(t)}const gz="modulepreload",mz=function(t){return"/"+t},j1={},pz=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=mz(s),s in j1)return;j1[s]=!0;const a=s.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(!!r)for(let _=i.length-1;_>=0;_--){const w=i[_];if(w.href===s&&(!a||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${u}`))return;const g=document.createElement("link");if(g.rel=a?"stylesheet":gz,a||(g.as="script",g.crossOrigin=""),g.href=s,document.head.appendChild(g),a)return new Promise((_,w)=>{g.addEventListener("load",_),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};function mg(){return mg=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mg.apply(this,arguments)}function _z(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function vz(t){G.useEffect(t,[])}function Ja(t,e){e===void 0&&(e={});var n=e,r=n.volume,i=r===void 0?1:r,s=n.playbackRate,a=s===void 0?1:s,u=n.soundEnabled,h=u===void 0?!0:u,g=n.interrupt,_=g===void 0?!1:g,w=n.onload,T=_z(n,["id","volume","playbackRate","soundEnabled","interrupt","onload"]),E=It.useRef(null),z=It.useRef(!1),j=It.useState(null),J=j[0],V=j[1],B=It.useState(null),U=B[0],Z=B[1],ne=function(){typeof w=="function"&&w.call(this),z.current&&V(this.duration()*1e3),Z(this)};vz(function(){return pz(()=>import("./howler-f5E0YXTk.js").then(me=>me.h),__vite__mapDeps([])).then(function(me){if(!z.current){var Ze;E.current=(Ze=me.Howl)!==null&&Ze!==void 0?Ze:me.default.Howl,z.current=!0,new E.current(mg({src:Array.isArray(t)?t:[t],volume:i,rate:a,onload:ne},T))}}),function(){z.current=!1}}),It.useEffect(function(){E.current&&U&&Z(new E.current(mg({src:Array.isArray(t)?t:[t],volume:i,onload:ne},T)))},[JSON.stringify(t)]),It.useEffect(function(){U&&(U.volume(i),U.rate(a))},[i,a]);var te=It.useCallback(function(me){typeof me>"u"&&(me={}),!(!U||!h&&!me.forceSoundEnabled)&&(_&&U.stop(),me.playbackRate&&U.rate(me.playbackRate),U.play(me.id))},[U,h,_]),ae=It.useCallback(function(me){U&&U.stop(me)},[U]),ce=It.useCallback(function(me){U&&U.pause(me)},[U]),_e=[te,{sound:U,stop:ae,pause:ce,duration:J}];return _e}const yz="/assets/star-wql4oqhK.wav",z1="/assets/button-J_WJeIQM.wav",wz="/assets/card-xj0x2Eh2.wav",Iz="/assets/pop-DwoHE_6m.wav",Ez="/assets/victory-gnOqf9qL.wav",oi=G.createContext([!0,()=>{}]),Tz=({children:t})=>{const[e,n]=G.useState(!0),[r]=Ja(yz,{soundEnabled:e}),[i]=Ja(z1,{soundEnabled:e}),[s]=Ja(z1,{soundEnabled:e}),[a]=Ja(wz,{soundEnabled:e}),[u]=Ja(Iz,{soundEnabled:e}),[h]=Ja(Ez,{soundEnabled:e});G.useEffect(()=>{n(window.localStorage.getItem("sound")!=="off")},[]);const g=G.useCallback(()=>{const w=!e;n(w),window.localStorage.setItem("sound",w?"on":"off")},[e]),_=G.useMemo(()=>({soundEnabled:e,toggleSound:g,playButton:i,playToggle:s,playCard:a,playStar:r,playTangram:u,playVictory:h}),[e,g,i,s,a,r,u,h]);return R.jsx(oi.Provider,{value:_,children:t})},Zw=Ih("button",({css:t,onClick:e,mute:n,...r})=>{const{playButton:i}=G.useContext(oi);return{css:{borderRadius:2,minWidth:0,minHeight:0,flex:"none",fontFamily:"inherit",fontWeight:"bolder",border:"none",fontSize:"inherit",color:"inherit",background:"none",cursor:"pointer",p:3,"&:disabled":{opacity:.3,cursor:"not-allowed"},"&:focus":{outline:"none"},...t},onClick:s=>{n||i(),e&&e(s)},...r}}),Sz=Xi(Zw,{css:{border:"2px solid",borderRadius:2}}),xz=Xi(Zw,{css:{border:"2px solid",color:"errorText"}}),ar=Xi(Zw,({css:t,...e})=>({css:{animation:`${_f({0:{bg:"pieces.lt2"},14:{bg:"pieces.rh"},28:{bg:"pieces.st2"},42:{bg:"pieces.mt1"},57:{bg:"pieces.st1"},71:{bg:"pieces.lt1"},85:{bg:"pieces.sq"},100:{bg:"pieces.lt2"}})} 20s linear infinite both`,color:"#FFFFFFDD",...t},...e})),zm=({uid:t,size:e="badge",css:n,onClick:r,...i})=>{const{playButton:s}=G.useContext(oi),a=G.useContext(Ti),u=G.useMemo(()=>{const h=Object.values(a.colors.pieces);return h[t.charCodeAt(0)%h.length].slice(1)},[a,t]);return R.jsx(fe,{as:"img",src:`https://api.dicebear.com/7.x/croodles-neutral/svg?seed=${t}&backgroundColor=${encodeURIComponent(u)}`,css:{m:"2px",boxShadow:`0 0 0 2px ${a.colors.dialogText}`,borderRadius:"50%",backgroundColor:u,size:e,...n},onClick:r?h=>{s(),r(h)}:void 0,...i})},Cz=(t,e)=>{const[n,r]=G.useState(null),i=u=>{if(n&&u.touches&&u.touches.length!==1)clearTimeout(n.timeoutId);else{const h=u.touches?u.touches.item(0):u;r({timeoutId:setTimeout(t,e),startEvent:{clientX:h.clientX,clientY:h.clientY}})}},s=u=>{if(!n)return;let h=u.touches?u.touches.item(0):u;Math.sqrt(Math.pow(h.clientX-n.startEvent.clientX,2)+Math.pow(h.clientY-n.startEvent.clientY,2))>10&&clearTimeout(n.timeoutId)},a=()=>{n&&clearTimeout(n.timeoutId)};return{onMouseDown:i,onMouseUp:a,onMouseMove:s,onMouseLeave:a,onTouchStart:i,onTouchEnd:a,onTouchMove:s}},Az=t=>t.edges>16?0:t.edges>8?1:2,ed=({showStroke:t,tangram:e,completed:n,selected:r,css:i,onBadgeClick:s,onClick:a,onLongPress:u,hideBadge:h,...g})=>{const{path:_,width:w,height:T,uid:E,approved:z,emoji:j}=e,J=G.useMemo(()=>Az(e),[e]),{playCard:V}=G.useContext(oi),U=G.useContext(Ti).colors.difficulties[J],Z=G.useCallback(()=>{u&&u(e)},[u,e]),ne=Cz(Z,1e3);return R.jsx(fe,{css:i,onClick:a?()=>{V(),a(e)}:void 0,...ne,...g,children:R.jsxs(fe,{css:{opacity:E&&z===!1?.5:1,borderRadius:5,boxShadow:r?`0px 0px 0px 4px ${U}`:"0px 0px 0px 1px rgba(0, 0, 0, 0.1)",m:1,bg:"background",transition:`background-color ${mf}ms`,p:3,textAlign:"center",position:"relative",cursor:a||u?"pointer":void 0,width:128,height:178},deps:[U,r,E,z],children:[R.jsx(fe,{as:"svg",css:{flex:"1",justifyContent:"center",fill:U,stroke:t?"lime":void 0,strokeWidth:t?8:void 0},deps:[t,U],viewBox:`0 0 ${w} ${T}`,dangerouslySetInnerHTML:{__html:`<path d="${_}" />`}}),n&&R.jsx(fe,{css:{position:"absolute",top:1,left:1,fontSize:"30px"},children:j}),E&&!h&&R.jsx(zm,{uid:E,css:{position:"absolute",bottom:1,right:1,cursor:s?"pointer":void 0},onClick:s?te=>{te.stopPropagation(),s(E)}:void 0})]})})},Ji=({children:t,title:e,onClose:n,big:r,css:i,...s})=>{const{playButton:a}=G.useContext(oi);return Jy.createPortal(R.jsx(fe,{onClick:n,css:{position:"fixed",top:0,left:0,right:0,bottom:0,bg:"#00000080",alignItems:"center",justifyContent:"center",animation:`${Wr/2}ms fadeIn ease both`,p:3},children:R.jsxs(fe,{css:{flex:"0 1 auto",bg:"dialogBackground",color:"dialogText",borderRadius:3,transition:`background-color ${mf}ms, color ${mf}ms`,fontSize:3,p:3,gap:3,maxWidth:"95vw",width:r?"568px":"400px"},onClick:u=>u.stopPropagation(),children:[R.jsxs(fe,{css:{flexDirection:"row",gap:3,alignItems:"center",justifyContent:"space-between",zIndex:1},children:[e,R.jsx(fe,{as:Jk,css:{cursor:"pointer",size:"badge",ml:e?void 0:"auto"},onClick:()=>{a(),n()}})]}),R.jsx(fe,{css:{overflow:"auto",flex:"1",maxWidth:"100%",...i},...s,children:t})]})}),document.getElementById("dialogContainer"))},Ye=Ih("div",{css:{display:"inline",minWidth:0,minHeight:0,flex:"none"}}),xr=Xi(Ye,{css:{fontSize:2,color:"errorText"}}),as=Xi(Ye,{css:{fontSize:2,opacity:.75}}),Vr=Xi(Ye,{css:{fontSize:4,fontWeight:"bolder"}}),Za=Xi(Ye,{css:{fontSize:3,fontWeight:"bold"}}),$1=Ih("a",{css:{cursor:"pointer",textDecoration:"underline",color:"inherit","&:visited":{color:"inherit"}}}),vi=Xi(Ye,{css:{cursor:"pointer",textDecoration:"underline"}}),yr=({icon:t,css:e})=>R.jsx(Ye,{as:t,css:{position:"relative",top:"0.1em",size:"0.9em",...e}}),Pz=({uid:t,tangrams:e,deferred:n})=>{const r=Yt(),{usersMetadata:i}=G.useContext(zn);G.useContext(br);const s=i[t]?i[t].username:null;return R.jsxs(Ji,{big:!0,title:R.jsx(Vr,{children:s?r.formatMessage({id:"{username} challenged you"},{username:s}):r.formatMessage({id:"Rise to the challenge"},{username:s})}),onClose:()=>n.reject(an),css:{gap:3,overflow:"initial",maxWidth:"568px"},children:[R.jsx(fe,{css:{flex:"1",overflow:"auto",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",m:-1},children:e.map(a=>R.jsx(ed,{selected:!0,tangram:a,css:{m:1}},a.id))}),R.jsx(ar,{onClick:()=>{n.resolve()},children:r.formatMessage({id:"Let's go!"})})]})},bz=(t,e)=>e.edges===t.edges?e.length-t.length:e.edges-t.edges,Rz=(t,e)=>rc.indexOf(t.emoji)-rc.indexOf(e.emoji),kz=(t,e)=>ic.indexOf(t.emoji)-ic.indexOf(e.emoji),cn=Ih("input",{type:"text",css:{color:"inherit",fontFamily:"inherit",fontWeight:"bolder",fontSize:"inherit",bg:"inputBackground",border:"none",borderRadius:2,borderColor:"currentColor",p:2,"&:disabled":{opacity:.5,cursor:"not-allowed"},"&:focus":{outline:"none"}}}),Nz=Xi(fe,({css:t,...e})=>({css:{p:3,alignItems:"center",position:"sticky",top:0,zIndex:1,background:`linear-gradient(0deg, rgba(0,0,0,0) 0%, ${G.useContext(Ti).colors.dialogBackground} 50%)`,...t},...e})),Dz=({deferred:t})=>{const e=Yt(),{currentUser:n}=G.useContext(zn),{pendingTangrams:r,approvedTangrams:i}=G.useContext(Oo),{showProfile:s,showTangram:a}=G.useContext(rd),{setPlaylist:u,shareTangrams:h,startRandomPlaylist:g,isTangramCompleted:_,isTangramStarred:w}=G.useContext(br),[T,E]=G.useState([]),[z,j]=G.useState(()=>{const te=window.localStorage.getItem("selectedGalleryFilter");return["all","uncompleted","starred","pending"].includes(te)?te:"all"}),J=te=>{j(te.target.value),window.localStorage.setItem("selectedGalleryFilter",te.target.value)},V=G.useCallback(te=>{E(ae=>ae.some(ce=>ce.id===te.id)?ae.filter(ce=>ce.id!==te.id):[...ae,te])},[]),B=()=>{T.length?u(T):g(),t.resolve()},U=()=>t.reject(an),Z=G.useMemo(()=>{const te=z==="pending"?r:i,ae={};for(const _e of te)z==="uncompleted"&&_(_e.id)||z==="starred"&&!w(_e.id)||(ae[_e.category]||(ae[_e.category]=[]),ae[_e.category].push(_e));const ce={};for(const _e of Object.keys(ae).sort())ce[_e]=ae[_e].sort(_e==="letters"?kz:_e==="digits"?Rz:bz);return ce},[r,i,z,_,w]),ne=Object.keys(Z);return R.jsx(R.Fragment,{children:R.jsx(Ji,{big:!0,title:R.jsx(Vr,{children:e.formatMessage({id:"Tangram gallery"})}),css:{gap:3,width:"568px"},onClose:U,children:R.jsxs(R.Fragment,{children:[R.jsxs(cn,{as:"select",value:z,onChange:J,children:[R.jsx("option",{value:"all",children:e.formatMessage({id:"All tangrams"})}),R.jsx("option",{value:"uncompleted",children:e.formatMessage({id:"Uncompleted tangrams"})}),R.jsx("option",{value:"starred",children:e.formatMessage({id:"â˜… Starred tangrams"})}),R.jsx("option",{value:"pending",children:e.formatMessage({id:"Pending approbation tangrams"})})]}),R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:3},children:ne.length===0?R.jsx(fe,{css:{gap:3,alignItems:"center"},children:z==="uncompleted"?R.jsxs(R.Fragment,{children:[R.jsx(Ye,{css:{fontSize:"8em"},children:"ðŸ¾"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(Za,{css:{textAlign:"center"},children:R.jsx(wt,{id:"You've completed all tangrams"})}),R.jsx(as,{children:R.jsx(wt,{id:"Come back later for more or create your own tangrams"})})]})]}):z==="pending"?n&&n.isAdmin?R.jsxs(R.Fragment,{children:[R.jsx(Ye,{css:{fontSize:"8em"},children:"ðŸ‘®"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(Za,{css:{textAlign:"center"},children:R.jsx(wt,{id:"No tangram left to approve"})}),R.jsx(as,{children:R.jsx(wt,{id:"Good job moderator {username}!",values:{username:n.username}})})]})]}):R.jsxs(R.Fragment,{children:[R.jsx(Ye,{css:{fontSize:"8em"},children:"ðŸ‘"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(Za,{css:{textAlign:"center"},children:R.jsx(wt,{id:"All your tangrams have been approved"})}),R.jsx(as,{children:R.jsx(wt,{id:"Create more tangrams and earn <starIcon></starIcon>",values:{starIcon:()=>R.jsx(yr,{icon:Eo,css:{fill:"currentColor"}})}})})]})]}):z==="starred"?R.jsxs(R.Fragment,{children:[R.jsx(Ye,{css:{fontSize:"8em"},children:"ðŸŒƒ"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(Za,{css:{textAlign:"center"},children:R.jsx(wt,{id:"No starred tangrams yet"})}),R.jsx(as,{children:R.jsx(wt,{id:"Press <starIcon></starIcon> to star a tangram and show your love",values:{starIcon:()=>R.jsx(yr,{icon:Eo,css:{fill:"currentColor"}})}})})]})]}):R.jsxs(R.Fragment,{children:[R.jsx(Ye,{css:{fontSize:"8em"},children:"ðŸ¤·"}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(Za,{css:{textAlign:"center"},children:R.jsx(wt,{id:"Nothing to see here"})}),R.jsx(as,{children:R.jsx(wt,{id:"Something might have gone wrong"})})]})]})},"noresult"):R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:3},children:ne.map(te=>R.jsxs(fe,{children:[R.jsx(Nz,{children:R.jsx(Za,{children:e.formatMessage({id:te})})}),R.jsx(fe,{css:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 136px)",gridColumnGap:2,gridRowGap:2,justifyContent:"center",justifyItems:"center",alignItems:"center"},children:Z[te].map(ae=>R.jsx(ed,{showStroke:z==="pending"&&n&&n.isAdmin,tangram:ae,completed:_(ae.id),selected:T.some(ce=>ce.id===ae.id),onClick:V,onBadgeClick:s,onLongPress:a},ae.id))})]},te))},"results")}),R.jsxs(fe,{css:{flexDirection:"row",gap:2},children:[R.jsx(ar,{onClick:B,css:{flex:"1"},children:T.length===0?e.formatMessage({id:"Play now!"}):T.length===1?e.formatMessage({id:"Start 1 tangram!"}):e.formatMessage({id:"Start {count} tangrams!"},{count:T.length})}),R.jsx(ar,{disabled:T.length===0,onClick:()=>h(T),children:R.jsx(fe,{as:Yk,css:{size:"icon",m:"-2px"}})})]})]})})})},Mz=({deferred:t})=>{const e=Yt(),{showProfile:n}=G.useContext(rd),{currentUser:r,usersMetadata:i}=G.useContext(zn),{approvedTangrams:s}=G.useContext(Oo),{tangramsStarredBy:a,tangramsCompletedBy:u}=G.useContext(br),[h,g]=G.useState(()=>{const z=window.localStorage.getItem("selectedLeaderboard");return["stars","completed","created"].includes(z)?z:"stars"}),_=z=>{g(z.target.value),window.localStorage.setItem("selectedLeaderboard",z.target.value)},w=z=>{n(z)},T=G.useMemo(()=>{const z={},j={},J={};for(const{id:V,uid:B}of s){j[B]||(j[B]=0,z[B]=0);for(const U in a[V])U!==B&&a[V][U]&&(z[B]+=1);j[B]+=1;for(const U in u[V])J[U]||(J[U]=0),J[U]+=1}return Object.keys(i).map(V=>{const B=i[V];return{uid:V,...B,stars:z[V]||0,completed:J[V]||0,created:j[V]||0}})},[s,a,u,i]),E=G.useMemo(()=>{if(T)return T.sort((z,j)=>j[h]-z[h])},[T,h]);return R.jsx(Ji,{title:R.jsx(Vr,{children:e.formatMessage({id:"Leaderboard"})}),onClose:()=>t.reject(an),css:{gap:3},children:R.jsxs(R.Fragment,{children:[R.jsxs(cn,{as:"select",value:h,onChange:_,children:[R.jsx("option",{value:"stars",children:e.formatMessage({id:"Stars earned"})}),R.jsx("option",{value:"completed",children:e.formatMessage({id:"Completed tangrams"})}),R.jsx("option",{value:"created",children:e.formatMessage({id:"Created tangrams"})})]}),R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:2},children:E.map(({uid:z,username:j,...J},V)=>R.jsxs(fe,{css:{flexDirection:"row",gap:2,alignItems:"center",fontSize:V===0?"1.6em":V===1?"1.4em":V===2?"1.2em":void 0},deps:[V],children:[R.jsx(zm,{uid:z,size:"badge",onClick:()=>w(z)}),R.jsx(Ye,{css:{flex:"1",fontWeight:r&&r.uid===z?"bold":void 0},deps:[r,z],children:j}),R.jsxs(Ye,{children:[J[h],h==="stars"&&R.jsxs(R.Fragment,{children:[" ",R.jsx(yr,{icon:Eo,css:{fill:"currentColor"}})]})]})]},z))})]})})};var td=t=>t.type==="checkbox",Il=t=>t instanceof Date,sr=t=>t==null;const Zk=t=>typeof t=="object";var vn=t=>!sr(t)&&!Array.isArray(t)&&Zk(t)&&!Il(t),Oz=t=>vn(t)&&t.target?td(t.target)?t.target.checked:t.target.value:t,Lz=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Vz=(t,e)=>t.has(Lz(e)),Fz=t=>{const e=t.constructor&&t.constructor.prototype;return vn(e)&&e.hasOwnProperty("isPrototypeOf")},eI=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ns(t){let e;const n=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(eI&&(t instanceof Blob||t instanceof FileList))&&(n||vn(t)))if(e=n?[]:{},!n&&!Fz(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=ns(t[r]));else return t;return e}var nd=t=>Array.isArray(t)?t.filter(Boolean):[],on=t=>t===void 0,Be=(t,e,n)=>{if(!e||!vn(t))return n;const r=nd(e.split(/[,[\].]+?/)).reduce((i,s)=>sr(i)?i:i[s],t);return on(r)||r===t?on(t[e])?n:t[e]:r},$s=t=>typeof t=="boolean";const H1={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},gi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ts={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};It.createContext(null);var Bz=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const a=s;return e._proxyFormState[a]!==gi.all&&(e._proxyFormState[a]=!r||gi.all),n&&(n[a]=!0),t[a]}});return i},Gr=t=>vn(t)&&!Object.keys(t).length,Uz=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return Gr(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(a=>e[a]===(!r||gi.all))},zp=t=>Array.isArray(t)?t:[t];function jz(t){const e=It.useRef(t);e.current=t,It.useEffect(()=>{const n=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{n&&n.unsubscribe()}},[t.disabled])}var ji=t=>typeof t=="string",zz=(t,e,n,r,i)=>ji(t)?(r&&e.watch.add(t),Be(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),Be(n,s))):(r&&(e.watchAll=!0),n),tI=t=>/^\w*$/.test(t),e2=t=>nd(t.replace(/["|']|\]/g,"").split(/\.|\[/));function Ut(t,e,n){let r=-1;const i=tI(e)?[e]:e2(e),s=i.length,a=s-1;for(;++r<s;){const u=i[r];let h=n;if(r!==a){const g=t[u];h=vn(g)||Array.isArray(g)?g:isNaN(+i[r+1])?{}:[]}t[u]=h,t=t[u]}return t}var $z=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},q1=t=>({isOnSubmit:!t||t===gi.onSubmit,isOnBlur:t===gi.onBlur,isOnChange:t===gi.onChange,isOnAll:t===gi.all,isOnTouch:t===gi.onTouched}),G1=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const ff=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=Be(t,i);if(s){const{_f:a,...u}=s;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],i)&&!r)break;if(a.ref&&e(a.ref,a.name)&&!r)break}else vn(u)&&ff(u,e)}}};var Hz=(t,e,n)=>{const r=nd(Be(t,n));return Ut(r,"root",e[n]),Ut(t,n,r),t},nI=t=>t.type==="file",Ks=t=>typeof t=="function",pg=t=>{if(!eI)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},gf=t=>ji(t),rI=t=>t.type==="radio",_g=t=>t instanceof RegExp;const W1={value:!1,isValid:!1},K1={value:!0,isValid:!0};var t2=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!on(t[0].attributes.value)?on(t[0].value)||t[0].value===""?K1:{value:t[0].value,isValid:!0}:K1:W1}return W1};const Q1={isValid:!1,value:null};var n2=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,Q1):Q1;function Y1(t,e,n="validate"){if(gf(t)||Array.isArray(t)&&t.every(gf)||$s(t)&&!t)return{type:n,message:gf(t)?t:"",ref:e}}var el=t=>vn(t)&&!_g(t)?t:{value:t,message:""},X1=async(t,e,n,r,i)=>{const{ref:s,refs:a,required:u,maxLength:h,minLength:g,min:_,max:w,pattern:T,validate:E,name:z,valueAsNumber:j,mount:J,disabled:V}=t._f,B=Be(e,z);if(!J||V)return{};const U=a?a[0]:s,Z=Oe=>{r&&U.reportValidity&&(U.setCustomValidity($s(Oe)?"":Oe||""),U.reportValidity())},ne={},te=rI(s),ae=td(s),ce=te||ae,_e=(j||nI(s))&&on(s.value)&&on(B)||pg(s)&&s.value===""||B===""||Array.isArray(B)&&!B.length,me=$z.bind(null,z,n,ne),Ze=(Oe,xe,we,et=ts.maxLength,he=ts.minLength)=>{const it=Oe?xe:we;ne[z]={type:Oe?et:he,message:it,ref:s,...me(Oe?et:he,it)}};if(i?!Array.isArray(B)||!B.length:u&&(!ce&&(_e||sr(B))||$s(B)&&!B||ae&&!t2(a).isValid||te&&!n2(a).isValid)){const{value:Oe,message:xe}=gf(u)?{value:!!u,message:u}:el(u);if(Oe&&(ne[z]={type:ts.required,message:xe,ref:U,...me(ts.required,xe)},!n))return Z(xe),ne}if(!_e&&(!sr(_)||!sr(w))){let Oe,xe;const we=el(w),et=el(_);if(!sr(B)&&!isNaN(B)){const he=s.valueAsNumber||B&&+B;sr(we.value)||(Oe=he>we.value),sr(et.value)||(xe=he<et.value)}else{const he=s.valueAsDate||new Date(B),it=De=>new Date(new Date().toDateString()+" "+De),Ce=s.type=="time",Te=s.type=="week";ji(we.value)&&B&&(Oe=Ce?it(B)>it(we.value):Te?B>we.value:he>new Date(we.value)),ji(et.value)&&B&&(xe=Ce?it(B)<it(et.value):Te?B<et.value:he<new Date(et.value))}if((Oe||xe)&&(Ze(!!Oe,we.message,et.message,ts.max,ts.min),!n))return Z(ne[z].message),ne}if((h||g)&&!_e&&(ji(B)||i&&Array.isArray(B))){const Oe=el(h),xe=el(g),we=!sr(Oe.value)&&B.length>+Oe.value,et=!sr(xe.value)&&B.length<+xe.value;if((we||et)&&(Ze(we,Oe.message,xe.message),!n))return Z(ne[z].message),ne}if(T&&!_e&&ji(B)){const{value:Oe,message:xe}=el(T);if(_g(Oe)&&!B.match(Oe)&&(ne[z]={type:ts.pattern,message:xe,ref:s,...me(ts.pattern,xe)},!n))return Z(xe),ne}if(E){if(Ks(E)){const Oe=await E(B,e),xe=Y1(Oe,U);if(xe&&(ne[z]={...xe,...me(ts.validate,xe.message)},!n))return Z(xe.message),ne}else if(vn(E)){let Oe={};for(const xe in E){if(!Gr(Oe)&&!n)break;const we=Y1(await E[xe](B,e),U,xe);we&&(Oe={...we,...me(xe,we.message)},Z(we.message),n&&(ne[z]=Oe))}if(!Gr(Oe)&&(ne[z]={ref:U,...Oe},!n))return ne}}return Z(!0),ne};function qz(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=on(t)?r++:t[e[r++]];return t}function Gz(t){for(const e in t)if(t.hasOwnProperty(e)&&!on(t[e]))return!1;return!0}function Nn(t,e){const n=Array.isArray(e)?e:tI(e)?[e]:e2(e),r=n.length===1?t:qz(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(vn(r)&&Gr(r)||Array.isArray(r)&&Gz(r))&&Nn(t,n.slice(0,-1)),t}function $p(){let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}}var vg=t=>sr(t)||!Zk(t);function aa(t,e){if(vg(t)||vg(e))return t===e;if(Il(t)&&Il(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n){const s=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const a=e[i];if(Il(s)&&Il(a)||vn(s)&&vn(a)||Array.isArray(s)&&Array.isArray(a)?!aa(s,a):s!==a)return!1}}return!0}var r2=t=>t.type==="select-multiple",Wz=t=>rI(t)||td(t),Hp=t=>pg(t)&&t.isConnected,i2=t=>{for(const e in t)if(Ks(t[e]))return!0;return!1};function yg(t,e={}){const n=Array.isArray(t);if(vn(t)||n)for(const r in t)Array.isArray(t[r])||vn(t[r])&&!i2(t[r])?(e[r]=Array.isArray(t[r])?[]:{},yg(t[r],e[r])):sr(t[r])||(e[r]=!0);return e}function s2(t,e,n){const r=Array.isArray(t);if(vn(t)||r)for(const i in t)Array.isArray(t[i])||vn(t[i])&&!i2(t[i])?on(e)||vg(n[i])?n[i]=Array.isArray(t[i])?yg(t[i],[]):{...yg(t[i])}:s2(t[i],sr(e)?{}:e[i],n[i]):n[i]=!aa(t[i],e[i]);return n}var qp=(t,e)=>s2(t,e,yg(e)),o2=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>on(t)?t:e?t===""?NaN:t&&+t:n&&ji(t)?new Date(t):r?r(t):t;function Gp(t){const e=t.ref;if(!(t.refs?t.refs.every(n=>n.disabled):e.disabled))return nI(e)?e.files:rI(e)?n2(t.refs).value:r2(e)?[...e.selectedOptions].map(({value:n})=>n):td(e)?t2(t.refs).value:o2(on(e.value)?t.ref.value:e.value,t)}var Kz=(t,e,n,r)=>{const i={};for(const s of t){const a=Be(e,s);a&&Ut(i,s,a._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},zu=t=>on(t)?t:_g(t)?t.source:vn(t)?_g(t.value)?t.value.source:t.value:t,Qz=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function J1(t,e,n){const r=Be(t,n);if(r||tI(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),a=Be(e,s),u=Be(t,s);if(a&&!Array.isArray(a)&&n!==s)return{name:n};if(u&&u.type)return{name:s,error:u};i.pop()}return{name:n}}var Yz=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,Xz=(t,e)=>!nd(Be(t,e)).length&&Nn(t,e);const Jz={mode:gi.onSubmit,reValidateMode:gi.onChange,shouldFocusError:!0};function Zz(t={},e){let n={...Jz,...t},r={submitCount:0,isDirty:!1,isLoading:Ks(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{},disabled:!1},i={},s=vn(n.defaultValues)||vn(n.values)?ns(n.defaultValues||n.values)||{}:{},a=n.shouldUnregister?{}:ns(s),u={action:!1,mount:!1,watch:!1},h={mount:new Set,unMount:new Set,array:new Set,watch:new Set},g,_=0;const w={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},T={values:$p(),array:$p(),state:$p()},E=t.resetOptions&&t.resetOptions.keepDirtyValues,z=q1(n.mode),j=q1(n.reValidateMode),J=n.criteriaMode===gi.all,V=X=>ie=>{clearTimeout(_),_=setTimeout(X,ie)},B=async X=>{if(w.isValid||X){const ie=n.resolver?Gr((await _e()).errors):await Ze(i,!0);ie!==r.isValid&&T.state.next({isValid:ie})}},U=X=>w.isValidating&&T.state.next({isValidating:X}),Z=(X,ie=[],ge,Ae,Re=!0,de=!0)=>{if(Ae&&ge){if(u.action=!0,de&&Array.isArray(Be(i,X))){const o=ge(Be(i,X),Ae.argA,Ae.argB);Re&&Ut(i,X,o)}if(de&&Array.isArray(Be(r.errors,X))){const o=ge(Be(r.errors,X),Ae.argA,Ae.argB);Re&&Ut(r.errors,X,o),Xz(r.errors,X)}if(w.touchedFields&&de&&Array.isArray(Be(r.touchedFields,X))){const o=ge(Be(r.touchedFields,X),Ae.argA,Ae.argB);Re&&Ut(r.touchedFields,X,o)}w.dirtyFields&&(r.dirtyFields=qp(s,a)),T.state.next({name:X,isDirty:xe(X,ie),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Ut(a,X,ie)},ne=(X,ie)=>{Ut(r.errors,X,ie),T.state.next({errors:r.errors})},te=(X,ie,ge,Ae)=>{const Re=Be(i,X);if(Re){const de=Be(a,X,on(ge)?Be(s,X):ge);on(de)||Ae&&Ae.defaultChecked||ie?Ut(a,X,ie?de:Gp(Re._f)):he(X,de),u.mount&&B()}},ae=(X,ie,ge,Ae,Re)=>{let de=!1,o=!1;const l={name:X};if(!ge||Ae){w.isDirty&&(o=r.isDirty,r.isDirty=l.isDirty=xe(),de=o!==l.isDirty);const c=aa(Be(s,X),ie);o=Be(r.dirtyFields,X),c?Nn(r.dirtyFields,X):Ut(r.dirtyFields,X,!0),l.dirtyFields=r.dirtyFields,de=de||w.dirtyFields&&o!==!c}if(ge){const c=Be(r.touchedFields,X);c||(Ut(r.touchedFields,X,ge),l.touchedFields=r.touchedFields,de=de||w.touchedFields&&c!==ge)}return de&&Re&&T.state.next(l),de?l:{}},ce=(X,ie,ge,Ae)=>{const Re=Be(r.errors,X),de=w.isValid&&$s(ie)&&r.isValid!==ie;if(t.delayError&&ge?(g=V(()=>ne(X,ge)),g(t.delayError)):(clearTimeout(_),g=null,ge?Ut(r.errors,X,ge):Nn(r.errors,X)),(ge?!aa(Re,ge):Re)||!Gr(Ae)||de){const o={...Ae,...de&&$s(ie)?{isValid:ie}:{},errors:r.errors,name:X};r={...r,...o},T.state.next(o)}U(!1)},_e=async X=>n.resolver(a,n.context,Kz(X||h.mount,i,n.criteriaMode,n.shouldUseNativeValidation)),me=async X=>{const{errors:ie}=await _e(X);if(X)for(const ge of X){const Ae=Be(ie,ge);Ae?Ut(r.errors,ge,Ae):Nn(r.errors,ge)}else r.errors=ie;return ie},Ze=async(X,ie,ge={valid:!0})=>{for(const Ae in X){const Re=X[Ae];if(Re){const{_f:de,...o}=Re;if(de){const l=h.array.has(de.name),c=await X1(Re,a,J,n.shouldUseNativeValidation&&!ie,l);if(c[de.name]&&(ge.valid=!1,ie))break;!ie&&(Be(c,de.name)?l?Hz(r.errors,c,de.name):Ut(r.errors,de.name,c[de.name]):Nn(r.errors,de.name))}o&&await Ze(o,ie,ge)}}return ge.valid},Oe=()=>{for(const X of h.unMount){const ie=Be(i,X);ie&&(ie._f.refs?ie._f.refs.every(ge=>!Hp(ge)):!Hp(ie._f.ref))&&yn(X)}h.unMount=new Set},xe=(X,ie)=>(X&&ie&&Ut(a,X,ie),!aa(vt(),s)),we=(X,ie,ge)=>zz(X,h,{...u.mount?a:on(ie)?s:ji(X)?{[X]:ie}:ie},ge,ie),et=X=>nd(Be(u.mount?a:s,X,t.shouldUnregister?Be(s,X,[]):[])),he=(X,ie,ge={})=>{const Ae=Be(i,X);let Re=ie;if(Ae){const de=Ae._f;de&&(!de.disabled&&Ut(a,X,o2(ie,de)),Re=pg(de.ref)&&sr(ie)?"":ie,r2(de.ref)?[...de.ref.options].forEach(o=>o.selected=Re.includes(o.value)):de.refs?td(de.ref)?de.refs.length>1?de.refs.forEach(o=>(!o.defaultChecked||!o.disabled)&&(o.checked=Array.isArray(Re)?!!Re.find(l=>l===o.value):Re===o.value)):de.refs[0]&&(de.refs[0].checked=!!Re):de.refs.forEach(o=>o.checked=o.value===Re):nI(de.ref)?de.ref.value="":(de.ref.value=Re,de.ref.type||T.values.next({name:X,values:{...a}})))}(ge.shouldDirty||ge.shouldTouch)&&ae(X,Re,ge.shouldTouch,ge.shouldDirty,!0),ge.shouldValidate&&Qe(X)},it=(X,ie,ge)=>{for(const Ae in ie){const Re=ie[Ae],de=`${X}.${Ae}`,o=Be(i,de);(h.array.has(X)||!vg(Re)||o&&!o._f)&&!Il(Re)?it(de,Re,ge):he(de,Re,ge)}},Ce=(X,ie,ge={})=>{const Ae=Be(i,X),Re=h.array.has(X),de=ns(ie);Ut(a,X,de),Re?(T.array.next({name:X,values:{...a}}),(w.isDirty||w.dirtyFields)&&ge.shouldDirty&&T.state.next({name:X,dirtyFields:qp(s,a),isDirty:xe(X,de)})):Ae&&!Ae._f&&!sr(de)?it(X,de,ge):he(X,de,ge),G1(X,h)&&T.state.next({...r}),T.values.next({name:X,values:{...a}}),!u.mount&&e()},Te=async X=>{const ie=X.target;let ge=ie.name,Ae=!0;const Re=Be(i,ge),de=()=>ie.type?Gp(Re._f):Oz(X),o=l=>{Ae=Number.isNaN(l)||l===Be(a,ge,l)};if(Re){let l,c;const d=de(),f=X.type===H1.BLUR||X.type===H1.FOCUS_OUT,m=!Qz(Re._f)&&!n.resolver&&!Be(r.errors,ge)&&!Re._f.deps||Yz(f,Be(r.touchedFields,ge),r.isSubmitted,j,z),v=G1(ge,h,f);Ut(a,ge,d),f?(Re._f.onBlur&&Re._f.onBlur(X),g&&g(0)):Re._f.onChange&&Re._f.onChange(X);const p=ae(ge,d,f,!1),y=!Gr(p)||v;if(!f&&T.values.next({name:ge,type:X.type,values:{...a}}),m)return w.isValid&&B(),y&&T.state.next({name:ge,...v?{}:p});if(!f&&v&&T.state.next({...r}),U(!0),n.resolver){const{errors:I}=await _e([ge]);if(o(d),Ae){const A=J1(r.errors,i,ge),P=J1(I,i,A.name||ge);l=P.error,ge=P.name,c=Gr(I)}}else l=(await X1(Re,a,J,n.shouldUseNativeValidation))[ge],o(d),Ae&&(l?c=!1:w.isValid&&(c=await Ze(i,!0)));Ae&&(Re._f.deps&&Qe(Re._f.deps),ce(ge,c,l,p))}},De=(X,ie)=>{if(Be(r.errors,ie)&&X.focus)return X.focus(),1},Qe=async(X,ie={})=>{let ge,Ae;const Re=zp(X);if(U(!0),n.resolver){const de=await me(on(X)?X:Re);ge=Gr(de),Ae=X?!Re.some(o=>Be(de,o)):ge}else X?(Ae=(await Promise.all(Re.map(async de=>{const o=Be(i,de);return await Ze(o&&o._f?{[de]:o}:o)}))).every(Boolean),!(!Ae&&!r.isValid)&&B()):Ae=ge=await Ze(i);return T.state.next({...!ji(X)||w.isValid&&ge!==r.isValid?{}:{name:X},...n.resolver||!X?{isValid:ge}:{},errors:r.errors,isValidating:!1}),ie.shouldFocus&&!Ae&&ff(i,De,X?Re:h.mount),Ae},vt=X=>{const ie={...s,...u.mount?a:{}};return on(X)?ie:ji(X)?Be(ie,X):X.map(ge=>Be(ie,ge))},nt=(X,ie)=>({invalid:!!Be((ie||r).errors,X),isDirty:!!Be((ie||r).dirtyFields,X),isTouched:!!Be((ie||r).touchedFields,X),error:Be((ie||r).errors,X)}),Dt=X=>{X&&zp(X).forEach(ie=>Nn(r.errors,ie)),T.state.next({errors:X?r.errors:{}})},Ke=(X,ie,ge)=>{const Ae=(Be(i,X,{_f:{}})._f||{}).ref;Ut(r.errors,X,{...ie,ref:Ae}),T.state.next({name:X,errors:r.errors,isValid:!1}),ge&&ge.shouldFocus&&Ae&&Ae.focus&&Ae.focus()},sn=(X,ie)=>Ks(X)?T.values.subscribe({next:ge=>X(we(void 0,ie),ge)}):we(X,ie,!0),yn=(X,ie={})=>{for(const ge of X?zp(X):h.mount)h.mount.delete(ge),h.array.delete(ge),ie.keepValue||(Nn(i,ge),Nn(a,ge)),!ie.keepError&&Nn(r.errors,ge),!ie.keepDirty&&Nn(r.dirtyFields,ge),!ie.keepTouched&&Nn(r.touchedFields,ge),!n.shouldUnregister&&!ie.keepDefaultValue&&Nn(s,ge);T.values.next({values:{...a}}),T.state.next({...r,...ie.keepDirty?{isDirty:xe()}:{}}),!ie.keepIsValid&&B()},Zi=({disabled:X,name:ie,field:ge,fields:Ae,value:Re})=>{if($s(X)){const de=X?void 0:on(Re)?Gp(ge?ge._f:Be(Ae,ie)._f):Re;Ut(a,ie,de),ae(ie,de,!1,!1,!0)}},Ct=(X,ie={})=>{let ge=Be(i,X);const Ae=$s(ie.disabled);return Ut(i,X,{...ge||{},_f:{...ge&&ge._f?ge._f:{ref:{name:X}},name:X,mount:!0,...ie}}),h.mount.add(X),ge?Zi({field:ge,disabled:ie.disabled,name:X}):te(X,!0,ie.value),{...Ae?{disabled:ie.disabled}:{},...n.progressive?{required:!!ie.required,min:zu(ie.min),max:zu(ie.max),minLength:zu(ie.minLength),maxLength:zu(ie.maxLength),pattern:zu(ie.pattern)}:{},name:X,onChange:Te,onBlur:Te,ref:Re=>{if(Re){Ct(X,ie),ge=Be(i,X);const de=on(Re.value)&&Re.querySelectorAll&&Re.querySelectorAll("input,select,textarea")[0]||Re,o=Wz(de),l=ge._f.refs||[];if(o?l.find(c=>c===de):de===ge._f.ref)return;Ut(i,X,{_f:{...ge._f,...o?{refs:[...l.filter(Hp),de,...Array.isArray(Be(s,X))?[{}]:[]],ref:{type:de.type,name:X}}:{ref:de}}}),te(X,!1,void 0,de)}else ge=Be(i,X,{}),ge._f&&(ge._f.mount=!1),(n.shouldUnregister||ie.shouldUnregister)&&!(Vz(h.array,X)&&u.action)&&h.unMount.add(X)}}},Bt=()=>n.shouldFocusError&&ff(i,De,h.mount),Pt=X=>{$s(X)&&(T.state.next({disabled:X}),ff(i,ie=>{ie.disabled=X},0,!1))},Lo=(X,ie)=>async ge=>{ge&&(ge.preventDefault&&ge.preventDefault(),ge.persist&&ge.persist());let Ae=ns(a);if(T.state.next({isSubmitting:!0}),n.resolver){const{errors:Re,values:de}=await _e();r.errors=Re,Ae=de}else await Ze(i);Nn(r.errors,"root"),Gr(r.errors)?(T.state.next({errors:{}}),await X(Ae,ge)):(ie&&await ie({...r.errors},ge),Bt(),setTimeout(Bt)),T.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Gr(r.errors),submitCount:r.submitCount+1,errors:r.errors})},Zn=(X,ie={})=>{Be(i,X)&&(on(ie.defaultValue)?Ce(X,Be(s,X)):(Ce(X,ie.defaultValue),Ut(s,X,ie.defaultValue)),ie.keepTouched||Nn(r.touchedFields,X),ie.keepDirty||(Nn(r.dirtyFields,X),r.isDirty=ie.defaultValue?xe(X,Be(s,X)):xe()),ie.keepError||(Nn(r.errors,X),w.isValid&&B()),T.state.next({...r}))},Hr=(X,ie={})=>{const ge=X?ns(X):s,Ae=ns(ge),Re=X&&!Gr(X)?Ae:s;if(ie.keepDefaultValues||(s=ge),!ie.keepValues){if(ie.keepDirtyValues||E)for(const de of h.mount)Be(r.dirtyFields,de)?Ut(Re,de,Be(a,de)):Ce(de,Be(Re,de));else{if(eI&&on(X))for(const de of h.mount){const o=Be(i,de);if(o&&o._f){const l=Array.isArray(o._f.refs)?o._f.refs[0]:o._f.ref;if(pg(l)){const c=l.closest("form");if(c){c.reset();break}}}}i={}}a=t.shouldUnregister?ie.keepDefaultValues?ns(s):{}:ns(Re),T.array.next({values:{...Re}}),T.values.next({values:{...Re}})}h={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!u.mount&&e(),u.mount=!w.isValid||!!ie.keepIsValid,u.watch=!!t.shouldUnregister,T.state.next({submitCount:ie.keepSubmitCount?r.submitCount:0,isDirty:ie.keepDirty?r.isDirty:!!(ie.keepDefaultValues&&!aa(X,s)),isSubmitted:ie.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:ie.keepDirtyValues?r.dirtyFields:ie.keepDefaultValues&&X?qp(s,X):{},touchedFields:ie.keepTouched?r.touchedFields:{},errors:ie.keepErrors?r.errors:{},isSubmitSuccessful:ie.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},qr=(X,ie)=>Hr(Ks(X)?X(a):X,ie);return{control:{register:Ct,unregister:yn,getFieldState:nt,handleSubmit:Lo,setError:Ke,_executeSchema:_e,_getWatch:we,_getDirty:xe,_updateValid:B,_removeUnmounted:Oe,_updateFieldArray:Z,_updateDisabledField:Zi,_getFieldArray:et,_reset:Hr,_resetDefaultValues:()=>Ks(n.defaultValues)&&n.defaultValues().then(X=>{qr(X,n.resetOptions),T.state.next({isLoading:!1})}),_updateFormState:X=>{r={...r,...X}},_disableForm:Pt,_subjects:T,_proxyFormState:w,get _fields(){return i},get _formValues(){return a},get _state(){return u},set _state(X){u=X},get _defaultValues(){return s},get _names(){return h},set _names(X){h=X},get _formState(){return r},set _formState(X){r=X},get _options(){return n},set _options(X){n={...n,...X}}},trigger:Qe,register:Ct,handleSubmit:Lo,watch:sn,setValue:Ce,getValues:vt,reset:qr,resetField:Zn,clearErrors:Dt,unregister:yn,setError:Ke,setFocus:(X,ie={})=>{const ge=Be(i,X),Ae=ge&&ge._f;if(Ae){const Re=Ae.refs?Ae.refs[0]:Ae.ref;Re.focus&&(Re.focus(),ie.shouldSelect&&Re.select())}},getFieldState:nt}}function Ha(t={}){const e=It.useRef(),n=It.useRef(),[r,i]=It.useState({isDirty:!1,isValidating:!1,isLoading:Ks(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},disabled:!1,defaultValues:Ks(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...Zz(t,()=>i(a=>({...a}))),formState:r});const s=e.current.control;return s._options=t,jz({subject:s._subjects.state,next:a=>{Uz(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),It.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),It.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==r.isDirty&&s._subjects.state.next({isDirty:a})}},[s,r.isDirty]),It.useEffect(()=>{t.values&&!aa(t.values,n.current)?(s._reset(t.values,s._options.resetOptions),n.current=t.values):s._resetDefaultValues()},[t.values,s]),It.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=Bz(r,s),e.current}const e8=({setTab:t})=>{const e=Yt(),n=G.useContext(si),{handleSubmit:r,register:i,setError:s,formState:a}=Ha(),u=G.useCallback(async({email:h})=>{try{await Rt.auth().sendPasswordResetEmail(h),t("signin"),n(e.formatMessage({id:"Reset password email sent"}))}catch(g){switch(g.code){case"auth/invalid-email":case"auth/user-not-found":case"auth/user-disabled":s("email",{type:"invalid",message:e.formatMessage({id:"Unknown email address"})});break;default:n(e.formatMessage({id:"An error occured, please retry later"},{email:h}))}}},[s,e,n,t]);return R.jsxs(fe,{as:"form",name:"reset",onSubmit:r(u),css:{gap:4},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:e.formatMessage({id:"Email address"})}),R.jsx(cn,{type:"email",...i("email",{required:e.formatMessage({id:"Email address is required"})})}),a.errors.email&&R.jsx(xr,{children:a.errors.email.message})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(ar,{type:"submit",disabled:a.isSubmitting,children:e.formatMessage({id:"Send the reset mail!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:()=>t("signin"),children:e.formatMessage({id:"Back"})})})]})]})},t8=({onSignUp:t,setTab:e})=>{const n=Yt(),{handleSubmit:r,register:i,watch:s,setError:a,formState:u}=Ha(),h=s("password"),g=G.useCallback(async({email:_,username:w,password:T})=>{try{const{user:E}=await Rt.auth().createUserWithEmailAndPassword(_,T),z={username:w,signupDate:Date.now()};await Rt.firestore().collection("users").doc(E.uid).set(z),t({uid:E.uid,...z,firebaseUser:E})}catch(E){switch(E.code){case"auth/weak-password":a("password",{type:"weakPassword",message:n.formatMessage({id:"Password is too weak"})});break;case"auth/email-already-in-use":a("email",{type:"alreadyExists",message:n.formatMessage({id:"Email address already in use"})});break;case"auth/invalid-email":a("email",{type:"invalid",message:n.formatMessage({id:"Invalid email address"})});break;default:return}}},[t,a,n]);return R.jsxs(fe,{as:"form",name:"signup",autoComplete:"off",onSubmit:r(g),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Username"})}),R.jsx(cn,{...i("username",{required:n.formatMessage({id:"Username is required"})})}),u.errors.username&&R.jsx(xr,{children:u.errors.username.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Email address"})}),R.jsx(cn,{type:"email",...i("email",{required:n.formatMessage({id:"Email address is required"})})}),u.errors.email&&R.jsx(xr,{children:u.errors.email.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(cn,{autoComplete:"new-password",type:"password",...i("password",{required:n.formatMessage({id:"Password is required"})})}),u.errors.password&&R.jsx(xr,{children:u.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Confirm password"})}),R.jsx(cn,{autoComplete:"new-password",type:"password",...i("passwordConfirm",{required:"Password is required",validate:_=>_===h||n.formatMessage({id:"Passwords must match"})})}),u.errors.passwordConfirm&&R.jsx(xr,{children:u.errors.passwordConfirm.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(ar,{disabled:u.isSubmitting,type:"submit",children:n.formatMessage({id:"Sign me up!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:()=>e("signin"),children:n.formatMessage({id:"I already have an account"})})})]})]})},n8=({onSignIn:t,setTab:e})=>{const n=Yt(),{handleSubmit:r,register:i,setError:s,formState:a}=Ha(),u=G.useCallback(async({email:h,password:g})=>{try{const{user:_}=await Rt.auth().signInWithEmailAndPassword(h,g),T=(await Rt.firestore().collection("users").doc(_.uid).get()).data();t({uid:_.uid,...T,firebaseUser:_})}catch(_){switch(_.code){case"auth/invalid-email":case"auth/user-not-found":case"auth/user-disabled":s("email",{type:"invalid",message:n.formatMessage({id:"Unknown email address"})});break;case"auth/wrong-password":s("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:return}}},[t,s,n]);return R.jsxs(fe,{as:"form",name:"signin",onSubmit:r(u),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Email address"})}),R.jsx(cn,{type:"email",...i("email",{required:n.formatMessage({id:"Email address is required"})})}),a.errors.email&&R.jsx(xr,{children:a.errors.email.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(cn,{type:"password",...i("password",{required:n.formatMessage({id:"Password is required"})})}),a.errors.password&&R.jsx(xr,{children:a.errors.password.message}),R.jsx(vi,{css:{alignSelf:"flex-end",fontSize:2},onClick:()=>e("reset"),children:n.formatMessage({id:"Forgot password?"})})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(ar,{type:"submit",disabled:a.isSubmitting,children:n.formatMessage({id:"Sign me in!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:()=>e("signup"),children:n.formatMessage({id:"I don't have an account"})})})]})]})},r8=({deferred:t})=>{const e=Yt(),n=G.useContext(si),[r,i]=G.useState("signup"),s=a=>{t.resolve(a),n(e.formatMessage({id:"Logged in as {username}"},{username:a.username}))};return R.jsx(Ji,{title:r==="signup"?R.jsx(Vr,{children:e.formatMessage({id:"Create your account"})}):r==="signin"?R.jsx(Vr,{children:e.formatMessage({id:"Connect to your account"})}):R.jsx(Vr,{children:e.formatMessage({id:"Reset your password"})}),onClose:()=>t.reject(an),children:r==="signup"?R.jsx(t8,{onSignUp:s,setTab:i}):r==="signin"?R.jsx(n8,{onSignIn:s,setTab:i}):R.jsx(e8,{setTab:i})})},i8={Amstangram:"Amstangram",Language:"Language",en:"English",fr:"French",Theme:"Theme","Logged in as {username}":"Logged in as {username}",Settings:"Settings",Difficulty:"Difficulty",Easy:"Easy",Hard:"Hard","Tangram approved":"Tangram approved","You can't save an invalid tangram":"You can't save an invalid tangram","You can't save such an easy tangram":"You can't save such an easy tangram","Tangram submitted for review":"Tangram submitted for review","Logged out":"Logged out","Tangram gallery":"Tangram gallery","All tangrams":"All tangrams","Uncompleted tangrams":"Uncompleted tangrams","â˜… Starred tangrams":"â˜… Starred tangrams","Pending approbation tangrams":"Pending approbation tangrams","You've completed all tangrams":"You've completed all tangrams","Come back later for more or create your own tangrams":"Come back later for more or create your own tangrams","No tangram left to approve":"No tangram left to approve","Good job moderator {username}!":"Good job moderator {username}!","All your tangrams have been approved":"All your tangrams have been approved","Create more tangrams and earn <starIcon></starIcon>":"Create more tangrams and earn <starIcon></starIcon>","No starred tangrams yet":"No starred tangrams yet","Press <starIcon></starIcon> to star a tangram and show your love":"Press <starIcon></starIcon> to star a tangram and show your love","Nothing to see here":"Nothing to see here","Something might have gone wrong":"Something might have gone wrong","Play now!":"Play now !","Start 1 tangram!":"Start 1 tangram !","Start {count} tangrams!":"Start {count} tangrams !","Password is too weak":"Password is too weak","Email address already in use":"Email address already in use","Invalid email address":"Invalid email address","Email address":"Email address","Email address is required":"Email address is required",Username:"Username","Username is required":"Username is required",Password:"Password","Password is required":"Password is required","Confirm password":"Confirm password","Passwords must match":"Passwords must match","Sign me up!":"Sign me up!","I already have an account":"I already have an account","Unknown email address":"Unknown email address","Incorrect password":"Incorrect password","Sign me in!":"Sign me in!","I don't have an account":"I don't have an account","Create your account":"Create your account","Connect to your account":"Connect to your account","A moderator will have to approve your tangram. It can be deleted or edited at any time.":"A moderator will have to approve your tangram.<br></br>It can be deleted or edited at any time.","Submit your tangram":"Submit your tangram","Edit your tangram":"Edit your tangram",Path:"Path","Invalid path":"Invalid path",Category:"Category","Victory emoji":"Victory emoji","Leave empty for random emoji":"Leave empty for random emoji",Order:"Order","Submit!":"Submit!","Edit!":"Edit!","Or delete tangram":"Or delete tangram",animals:"Animals",geometric:"Geometric",digits:"Digits",letters:"Alphabet",people:"People",stuff:"Stuff","Joined {signupDate}":"Joined {signupDate}","Log out":"Log out","Are you sure you want to log out?":"Are you sure you want to log out?","Change email address":"Change email address","Change username":"Change username","Change password":"Change password",Back:"Back","Confirm new password":"Confirm new password","New password":"New password","Current password":"Current password","Password changed successfuly":"Password changed successfuly","New username":"New username","Username updated successfuly":"Username updated successfuly","Email address updated successfuly":"Email address updated successfuly","New email address":"New email address","An error occured, please retry later":"An error occured, please retry later",Sounds:"Sounds","Are you sure you want to delete this tangram?":"Are you sure you want to delete this tangram?","Tangram deleted successfuly":"Tangram deleted successfuly","Tangram modified successfuly":"Tangram modified successfuly","Challenge link copied to clipboard":"Challenge link copied to clipboard","{username} challenged you":"{username} challenged you","Rise to the challenge":"Rise to the challenge","Let's go!":"Let's go!",Leaderboard:"Leaderboard","Completed {completed}/{total} tangrams":"Completed {completed}/{total} tangrams","Created {created} tangrams":"Created {created} tangrams","Earned {stars}":"Earned {stars} <starIcon></starIcon>","Stars earned":"Stars earned","Completed tangrams":"Completed tangrams","Created tangrams":"Created tangrams","Random tip":"Random tip","Got it!":"Got it!","Welcome to Amstangram":"Welcome to Amstangram","tips.welcome":"Reproduce the black shape by moving the pieces, you can rotate a piece by pressing it.<br></br><br></br>Have fun !","tips.menu":"You can access the tangram gallery {galleryIcon}, settings {settingsIcon} and more by pressing {menuIcon}","tips.account1":"You can create an account by pressing {accountIcon} in the menu {menuIcon}","tips.account2":"Signup in order to save your progression and create your very own tangrams","tips.gallery":"You can create your own tangram playlist by selecting tangrams in the gallery {galleryIcon}","tips.share":"You can share playlist with your friends by pressing {shareIcon} in the gallery {galleryIcon}","tips.create":"You can create your own tangrams by pressing {createIcon} in the menu {menuIcon}","tips.stars":"Did you liked this tangram?<br></br>Give a star to its creator by pressing {starIcon}","tips.difficulty":"Having it too easy?<br></br>You can change difficulty by pressing {settingsIcon} in the menu {menuIcon}","tips.theme":"Too bright for your eyes?<br></br>You can toggle dark mode by pressing {settingsIcon} in the menu {menuIcon}","tips.sound":"Too much noise?<br></br>You can disable sounds by pressing {settingsIcon} in the menu {menuIcon}","tips.card":"You can acces tangram details or edit your own tangrams by long pressing a card in the gallery {galleryIcon}","tips.leaderboard":"Check the leaderboard to see who's the best by pressing {leaderboardIcon} in the menu {menuIcon}","tips.particles":"Disable particle effects by pressing {settingsIcon} in the menu {menuIcon}. It can improve performances.","I don't want to see tips anymore":"I don't want to see tips anymore","Show tips":"Show tips","Show particles":"Show particles",Yes:"Yes",No:"No","Reset tips":"Reset tips","Tips reseted successfuly":"Tips reseted successfuly","Loading...":"Loading...",Approve:"Approve",Next:"Next",Quit:"Quit","See my profile":"See my profile","Log in":"Log in","Save tangram":"Save tangram","Contact ðŸ’Œ":"Contact ðŸ’Œ","A word about Amstangram":"A word about Amstangram","Version {code}":"Version {code}","Forgot password?":"Forgot password?","Reset your password":"Reset your password","Send the reset mail!":"Send the reset mail!","Reset password email sent":"Reset password email sent"},s8={Amstangram:"Amstangram",Language:"Langage",en:"Anglais",fr:"Francais",Theme:"ThÃ¨me","Logged in as {username}":"ConnectÃ© en tant que {username}",Settings:"RÃ©glages",Difficulty:"DifficultÃ©",Easy:"Facile",Hard:"Difficile","Tangram approved":"Tangram approuvÃ©","You can't save an invalid tangram":"Tangram invalide","You can't save such an easy tangram":"Tangram trop facile","Tangram submitted for review":"Tangram soumis pour vÃ©rification","Logged out":"DÃ©connectÃ©.e","Tangram gallery":"Galerie des tangrams","All tangrams":"Tous les tangrams","Uncompleted tangrams":"Tangrams non complÃ©tÃ©s","â˜… Starred tangrams":"Tangrams Ã©toilÃ©s â˜…","Pending approbation tangrams":"Tangrams en attente d'approbation","You've completed all tangrams":"Tu as complÃ©tÃ© tous les tangrams","Come back later for more or create your own tangrams":"Reviens plus tard ou crÃ©Ã©s tes propres tangrams","No tangram left to approve":"Il ne reste plus de tangram Ã  approuver","Good job moderator {username}!":"Bon boulot modÃ©rateur {username} !","All your tangrams have been approved":"Tous tes tangrams ont Ã©tÃ© approuvÃ©s","Create more tangrams and earn <starIcon></starIcon>":"CrÃ©Ã©s d'autres tangrams et gagne des <starIcon></starIcon>","No starred tangrams yet":"Tu n'as pas encore donnÃ© d'Ã©toile","Press <starIcon></starIcon> to star a tangram and show your love":"Appuie sur <starIcon></starIcon> pour donner une Ã©toile et montrer que tu aimes un tangram","Nothing to see here":"Rien Ã  voir","Something might have gone wrong":"Il semble y avoir un problÃ¨me","Play now!":"Commencer Ã  jouer !","Start 1 tangram!":"Lancer 1 tangram","Start {count} tangrams!":"Lancer {count} tangrams","Password is too weak":"Mot de passe trop faible","Email address already in use":"Adresse email dÃ©jÃ  prise","Invalid email address":"Adresse email invalide","Email address":"Adresse Email","Email address is required":"Adresse email requise",Username:"Nom d'utilisateur","Username is required":"Nom d'utilisateur requis",Password:"Mot de passe","Password is required":"Mot de passe requis","Confirm password":"Confirmer le mot de passe","Passwords must match":"Les mots de passe doivent correspondre","Sign me up!":"Je crÃ©Ã© mon compte !","I already have an account":"J'ai dÃ©jÃ  un compte","Unknown email address":"Adresse email inconnu","Incorrect password":"Mot de passe incorrect","Sign me in!":"Je me connecte !","I don't have an account":"Je n'ai pas de compte","Create your account":"CrÃ©er un compte","Connect to your account":"Se connecter","Submit your tangram":"Envoyer votre tangram","Edit your tangram":"Ã‰diter votre tangram",Category:"CatÃ©gorie",Path:"Chemin","Invalid path":"Chemin invalide","Victory emoji":"Emoji de succÃ¨s","Leave empty for random emoji":"Laisser vide pour un emoji au hasard",Order:"Ordre","A moderator will have to approve your tangram. It can be deleted or edited at any time.":"Un modÃ©rateur doit approuver votre tangram.<br></br>Il peut Ãªtre supprimÃ© ou modifiÃ© n'importe quand.","Submit!":"Envoyer !","Edit!":"Ã‰diter !","Or delete tangram":"Ou supprimer le tangram",animals:"Animaux",geometric:"GÃ©omÃ©trique",digits:"Chiffres",letters:"Alphabet",people:"Personnes",stuff:"Trucs","Joined {signupDate}":"Inscrit le {signupDate}","Log out":"Se dÃ©connecter","Are you sure you want to log out?":"Es-tu sÃ»r.e de vouloir te dÃ©connecter ?","Change email address":"Modifier l'adresse email","Change username":"Modifier le nom d'utilisateur","Change password":"Modifier le mot de passe",Back:"Retour","Confirm new password":"Confirmer le nouveau mot de passe","New password":"Nouveau mot de passe","Current password":"Mot de passe actuel","Password changed successfuly":"Mot de passe changÃ© avec succÃ©s","New username":"Nouveau nom d'utilisateur","Username updated successfuly":"Nom d'utilisateur changÃ© avec succÃ©s","Email address updated successfuly":"Adresse email changÃ© avec succÃ©s","New email address":"Nouvelle adresse email","An error occured, please retry later":"Une erreur est survenue, veuillez rÃ©essayer plus tard",Sounds:"Sons","Are you sure you want to delete this tangram?":"Es-tu sÃ»r.e de vouloir supprimer ce tangram ?","Tangram deleted successfuly":"Tangram supprimÃ© avec succÃ©s","Tangram modified successfuly":"Tangram modifiÃ© avec succÃ©s","Challenge link copied to clipboard":"Lien de dÃ©fi copiÃ© dans le presse papier","{username} challenged you":"{username} te met au dÃ©fi","Rise to the challenge":"Relevez le dÃ©fi","Let's go!":"C'est parti !",Leaderboard:"Classement","Completed {completed}/{total} tangrams":"{completed}/{total} tangrams complÃ©tÃ©s","Created {created} tangrams":"{created} tangrams crÃ©Ã©s","Earned {stars}":"{stars} <starIcon></starIcon> gagnÃ©es","Stars earned":"Ã‰toiles gagnÃ©es","Completed tangrams":"Tangrams complÃ©tÃ©s","Created tangrams":"Tangrams crÃ©Ã©s","Random tip":"Astuce","Got it!":"J'ai compris !","Welcome to Amstangram":"Bienvenue sur Amstangram","tips.welcome":"Reproduis la forme noire en dÃ©plaÃ§ant les piÃ¨ces, tu peux faire tourner une piÃ¨ce en appuyant dessus.<br></br><br></br>Amuse-toi bien !","tips.menu":"Tu peux accÃ©der Ã  la galerie des tangrams {galleryIcon}, aux rÃ©glages {settingsIcon} et plus encore en appuyant sur {menuIcon}","tips.account1":"CrÃ©er ton compte utilisateur en appuyant sur {accountIcon} dans le menu {menuIcon}","tips.account2":"CrÃ©er ton compte utilisateur pour sauvegarder ta progression crÃ©er tes propres tangrams","tips.gallery":"Tu peux crÃ©er ta propre playlist en sÃ©lectionnant les tangrams dans la galerie {galleryIcon}","tips.share":"Tu peux partager ta playlist avec tes amis en appuyant sur {shareIcon} dans la galerie {galleryIcon}","tips.create":"Tu peux crÃ©er tes propres tangrams en appuyant sur {createIcon} dans le menu {menuIcon}","tips.stars":"T'as aimÃ© ce tangram ?<br></br>Envoie une Ã©toile Ã  son crÃ©ateur en appuyant sur {starIcon}","tips.difficulty":"Trop facile pour toi ?<br></br>Essayes le mode difficile en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.theme":"Envie de passer du cÃ´tÃ© obscur ?<br></br>Tu peux activer le mode sombre en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.sound":"Trop de bruits ?<br></br>Tu peux dÃ©sactiver les sons en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.card":"Tu peux accÃ©der aux dÃ©tails d'un tangram ou mÃªme Ã©diter les tiens en faisant un appui long sur une carte dans la galerie {galleryIcon}","tips.leaderboard":"Jette un oeil au classement pour savoir qui est le meilleur en appuyant sur {leaderboardIcon} dans le menu {menuIcon}","tips.particles":"DÃ©sactive les effets de particule en appuyant sur {settingsIcon} dans le menu {menuIcon}. Cela peut amÃ©liorer les performances.","I don't want to see tips anymore":"Je ne veux plus voir les astuces","Show tips":"Afficher les astuces","Show particles":"Afficher les particles",Yes:"Oui",No:"Non","Reset tips":"RÃ©initialiser les astuces","Tips reseted successfuly":"Astuces rÃ©initilisÃ©es avec succÃ©s","Loading...":"Chargement...",Approve:"Approuver",Next:"Suivant",Quit:"Quitter","See my profile":"Voir mon profil","Log in":"Se connecter","Save tangram":"Sauvegarder le tangram","Contact ðŸ’Œ":"Contact ðŸ’Œ","A word about Amstangram":"Quelques mots Ã  propos d'Amstangram","Version {code}":"Version {code}","Forgot password?":"Mot de passe oubliÃ© ?","Reset your password":"RÃ©initialiser le mot de passe","Send the reset mail!":"Envoyer le mail de rÃ©initialisation","Reset password email sent":"Email de rÃ©initialisation envoyÃ©"},o8={en:i8,fr:s8},iI="fr",Zv=["en","fr"],sI=G.createContext({language:iI,setLanguage:()=>{}}),a8=()=>{const t=localStorage.getItem("language");if(Zv.includes(t))return t;const e=navigator.languages;for(const n of e){const r=Zv.find(i=>n.includes(i));if(r)return r}return iI},l8=({children:t})=>{const[e,n]=G.useState(iI);G.useEffect(()=>{const i=a8();n(i)},[]);const r=G.useMemo(()=>({language:e,setLanguage:i=>{n(i),localStorage.setItem("language",i)}}),[e]);return R.jsx(qO,{locale:e,messages:o8[e],onError:console.warn,children:R.jsx(sI.Provider,{value:r,children:t})})},u8=({currentUser:t,onClose:e})=>{const n=Yt(),{updateEmail:r}=G.useContext(zn),i=G.useContext(si),{handleSubmit:s,register:a,setError:u,formState:h}=Ha(),g=G.useCallback(async({password:_,newEmail:w})=>{try{await r(t,_,w),i(n.formatMessage({id:"Email address updated successfuly"})),e()}catch(T){switch(T.code){case"auth/email-already-in-use":u("newEmail",{type:"alreadyExists",message:n.formatMessage({id:"Email address already in use"})});break;case"auth/invalid-email":u("newEmail",{type:"invalid",message:n.formatMessage({id:"Invalid email address"})});break;case"auth/wrong-password":u("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:throw i(n.formatMessage({id:"An error occured, please retry later"})),T}}},[t,r,u,e,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(g),css:{flex:"1",gap:4},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(cn,{type:"password",...a("password",{required:n.formatMessage({id:"Password is required"})})}),h.errors.password&&R.jsx(xr,{children:h.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New email address"})}),R.jsx(cn,{type:"email",...a("newEmail",{required:n.formatMessage({id:"Email address is required"})})}),h.errors.newEmail&&R.jsx(xr,{children:h.errors.newEmail.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(ar,{disabled:h.isSubmitting,type:"submit",children:n.formatMessage({id:"Change email address"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},c8=({currentUser:t,onClose:e})=>{const n=Yt(),{updateUsername:r}=G.useContext(zn),i=G.useContext(si),{handleSubmit:s,register:a,formState:u}=Ha(),h=G.useCallback(async({newUsername:g})=>{try{await r(t,g),i(n.formatMessage({id:"Username updated successfuly"})),e()}catch(_){throw i(n.formatMessage({id:"An error occured, please retry later"})),_}},[t,r,e,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(h),css:{flex:"1",gap:4},children:[R.jsx(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New username"})}),R.jsx(cn,{type:"text",...a("newUsername",{required:n.formatMessage({id:"Username is required"})})}),u.errors.newUsername&&R.jsx(xr,{children:u.errors.newUsername.message})]})}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(ar,{disabled:u.isSubmitting,type:"submit",children:n.formatMessage({id:"Change username"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},h8=({currentUser:t,onClose:e})=>{const n=Yt(),{updateUsername:r}=G.useContext(zn),i=G.useContext(si),{handleSubmit:s,register:a,watch:u,setError:h,formState:g}=Ha(),_=u("newPassword"),w=G.useCallback(async({password:T,newPassword:E})=>{try{await r(t,T,E),i(n.formatMessage({id:"Password changed successfuly"})),e()}catch(z){switch(z.code){case"auth/weak-password":h("newPassword",{type:"weakPassword",message:n.formatMessage({id:"Password is too weak"})});break;case"auth/wrong-password":h("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:i(n.formatMessage({id:"An error occured, please retry later"}));return}}},[t,r,e,h,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(w),css:{flex:"1",gap:4},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Current password"})}),R.jsx(cn,{type:"password",...a("password",{required:n.formatMessage({id:"Password is required"})})}),g.errors.password&&R.jsx(xr,{children:g.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New password"})}),R.jsx(cn,{type:"password",autoComplete:"new-password",...a("newPassword",{required:n.formatMessage({id:"Password is required"})})}),g.errors.newPassword&&R.jsx(xr,{children:g.errors.newPassword.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Confirm new password"})}),R.jsx(cn,{type:"password",...a("newPasswordConfirm",{required:"Password is required",validate:T=>T===_||n.formatMessage({id:"Passwords must match"})})}),g.errors.newPasswordConfirm&&R.jsx(xr,{children:g.errors.newPasswordConfirm.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(ar,{disabled:g.isSubmitting,type:"submit",children:n.formatMessage({id:"Change password"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},d8=({uid:t,deferred:e})=>{const n=Yt(),r=G.useContext(si),{language:i}=G.useContext(sI),{currentUser:s,usersMetadata:a}=G.useContext(zn),{username:u,signupDate:h}=a[t],[g,_]=G.useState(!1),[w,T]=G.useState(!1),[E,z]=G.useState(!1),{approvedTangrams:j}=G.useContext(Oo),{tangramsStarredBy:J,tangramsCompletedBy:V}=G.useContext(br),{stars:B,completed:U,created:Z}=G.useMemo(()=>{let te=0,ae=0,ce=0;for(const _e of j){if(_e.uid===t){ae++;for(const me in J[_e.id])me!==t&&J[_e.id][me]&&(te+=1)}for(const me in V[_e.id])me===t&&(ce+=1)}return{stars:te,completed:ce,created:ae}},[j,V,J,t]),ne=async()=>{window.confirm(n.formatMessage({id:"Are you sure you want to log out?"}))&&(await Rt.auth().signOut(),e.reject(an),r(n.formatMessage({id:"Logged out"})))};return R.jsx(Ji,{onClose:()=>e.reject(an),css:{overflow:"auto",pt:4,mt:-4,gap:3},children:g?R.jsx(u8,{currentUser:s,onClose:()=>_(!1)}):w?R.jsx(c8,{currentUser:s,onClose:()=>T(!1)}):E?R.jsx(h8,{currentUser:s,onClose:()=>z(!1)}):R.jsxs(fe,{css:{gap:4,mt:-4},children:[R.jsxs(fe,{css:{gap:3,alignItems:"center"},children:[R.jsx(zm,{uid:t,size:"badgeBig"}),R.jsx(Vr,{children:u}),R.jsxs(fe,{css:{gap:2,fontSize:2,alignItems:"center"},children:[s&&t===s.uid&&R.jsx(Ye,{children:s.firebaseUser.email}),R.jsx(Ye,{children:n.formatMessage({id:"Joined {signupDate}"},{signupDate:new Intl.DateTimeFormat(i).format(h)})}),R.jsx(Ye,{children:n.formatMessage({id:"Completed {completed}/{total} tangrams"},{completed:U,total:j.length})}),R.jsx(Ye,{children:n.formatMessage({id:"Created {created} tangrams"},{created:Z})}),R.jsx(Ye,{children:R.jsx(wt,{id:"Earned {stars}",values:{stars:B,starIcon:()=>R.jsx(yr,{icon:Eo,css:{fill:"currentColor"}})}})})]})]}),s&&s.uid===t&&R.jsxs(R.Fragment,{children:[R.jsxs(fe,{css:{gap:3,alignItems:"center"},children:[R.jsx(vi,{onClick:()=>_(!0),children:n.formatMessage({id:"Change email address"})}),R.jsx(vi,{onClick:()=>T(!0),children:n.formatMessage({id:"Change username"})}),R.jsx(vi,{onClick:()=>z(!0),children:n.formatMessage({id:"Change password"})})]}),R.jsx(xz,{onClick:ne,children:n.formatMessage({id:"Log out"})})]})]})})},Z1=["ðŸ’ª","ðŸ”¥","ðŸ˜±","ðŸ˜Ž","ðŸŽ‰","ðŸ¥‡","ðŸš€","ðŸ‘Œ","ðŸ‘","ðŸ˜µ"],eS=()=>Z1[Math.floor(Math.random()*Z1.length)];var a2={exports:{}};const f8={},g8=Object.freeze(Object.defineProperty({__proto__:null,default:f8},Symbol.toStringTag,{value:"Module"})),tS=C2(g8);/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, JÃ¼rg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 JÃ¼rg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(t){(function(e,n){e=e||tS;var r=e.window,i=e.document,s=new function(){var o=/^(statics|enumerable|beans|preserve)$/,l=[],c=l.slice,d=Object.create,f=Object.getOwnPropertyDescriptor,m=Object.defineProperty,v=l.forEach||function(C,S){for(var k=0,O=this.length;k<O;k++)C.call(S,this[k],k,this)},p=function(C,S){for(var k in this)this.hasOwnProperty(k)&&C.call(S,this[k],k,this)},y=Object.assign||function(C){for(var S=1,k=arguments.length;S<k;S++){var O=arguments[S];for(var F in O)O.hasOwnProperty(F)&&(C[F]=O[F])}return C},I=function(C,S,k){if(C){var O=f(C,"length");(O&&typeof O.value=="number"?v:p).call(C,S,k=k||C)}return k};function A(C,S,k,O,F){var N={};function D($,H){H=H||(H=f(S,$))&&(H.get?H:H.value),typeof H=="string"&&H[0]==="#"&&(H=C[H.substring(1)]||H);var q=typeof H=="function",W=H,Q=F||q&&!H.base?H&&H.get?$ in C:C[$]:null,K;(!F||!Q)&&(q&&Q&&(H.base=Q),q&&O!==!1&&(K=$.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(N[K[3].toLowerCase()+K[4]]=K[2]),(!W||q||!W.get||typeof W.get!="function"||!P.isPlainObject(W))&&(W={value:W,writable:!0}),(f(C,$)||{configurable:!0}).configurable&&(W.configurable=!0,W.enumerable=k??!K),m(C,$,W))}if(S){for(var x in S)S.hasOwnProperty(x)&&!o.test(x)&&D(x);for(var x in N){var b=N[x],M=C["set"+b],L=C["get"+b]||M&&C["is"+b];L&&(O===!0||L.length===0)&&D(x,{get:L,set:M})}}return C}function P(){for(var C=0,S=arguments.length;C<S;C++){var k=arguments[C];k&&y(this,k)}return this}return A(P,{inject:function(C){if(C){var S=C.statics===!0?C:C.statics,k=C.beans,O=C.preserve;S!==C&&A(this.prototype,C,C.enumerable,k,O),A(this,S,null,k,O)}for(var F=1,N=arguments.length;F<N;F++)this.inject(arguments[F]);return this},extend:function(){for(var C=this,S,k,O=0,F,N=arguments.length;O<N&&!(S&&k);O++)F=arguments[O],S=S||F.initialize,k=k||F.prototype;return S=S||function(){C.apply(this,arguments)},k=S.prototype=k||d(this.prototype),m(k,"constructor",{value:S,writable:!0,configurable:!0}),A(S,this),arguments.length&&this.inject.apply(S,arguments),S.base=C,S}}).inject({enumerable:!1,initialize:P,set:P,inject:function(){for(var C=0,S=arguments.length;C<S;C++){var k=arguments[C];k&&A(this,k,k.enumerable,k.beans,k.preserve)}return this},extend:function(){var C=d(this);return C.inject.apply(C,arguments)},each:function(C,S){return I(this,C,S)},clone:function(){return new this.constructor(this)},statics:{set:y,each:I,create:d,define:m,describe:f,clone:function(C){return y(new C.constructor,C)},isPlainObject:function(C){var S=C!=null&&C.constructor;return S&&(S===Object||S===P||S.name==="Object")},pick:function(C,S){return C!==n?C:S},slice:function(C,S,k){return c.call(C,S,k)}}})};t.exports=s,s.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+s.each(this,function(o,l){if(!/^_/.test(l)){var c=typeof o;this.push(l+": "+(c==="number"?_.instance.number(o):c==="string"?"'"+o+"'":o))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(o){return s.importJSON(o,this)},exportJSON:function(o){return s.exportJSON(this,o)},toJSON:function(){return s.serialize(this)},set:function(o,l){return o&&s.filter(this,o,l,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function o(){var l=o.base.apply(this,arguments),c=l.prototype._class;return c&&!s.exports[c]&&(s.exports[c]=l),l},equals:function(o,l){if(o===l)return!0;if(o&&o.equals)return o.equals(l);if(l&&l.equals)return l.equals(o);if(o&&l&&typeof o=="object"&&typeof l=="object"){if(Array.isArray(o)&&Array.isArray(l)){var c=o.length;if(c!==l.length)return!1;for(;c--;)if(!s.equals(o[c],l[c]))return!1}else{var d=Object.keys(o),c=d.length;if(c!==Object.keys(l).length)return!1;for(;c--;){var f=d[c];if(!(l.hasOwnProperty(f)&&s.equals(o[f],l[f])))return!1}}return!0}return!1},read:function(o,l,c,d){if(this===s){var f=this.peek(o,l);return o.__index++,f}var m=this.prototype,v=m._readIndex,p=l||v&&o.__index||0,y=o.length,I=o[p];if(d=d||y-p,I instanceof this||c&&c.readNull&&I==null&&d<=1)return v&&(o.__index=p+1),I&&c&&c.clone?I.clone():I;if(I=s.create(m),v&&(I.__read=!0),I=I.initialize.apply(I,p>0||p+d<y?s.slice(o,p,p+d):o)||I,v){o.__index=p+I.__read;var A=I.__filtered;A&&(o.__filtered=A,I.__filtered=n),I.__read=n}return I},peek:function(o,l){return o[o.__index=l||o.__index||0]},remain:function(o){return o.length-(o.__index||0)},readList:function(o,l,c,d){for(var f=[],m,v=l||0,p=d?v+d:o.length,y=v;y<p;y++)f.push(Array.isArray(m=o[y])?this.read(m,0,c):this.read(o,y,c,1));return f},readNamed:function(o,l,c,d,f){var m=this.getNamed(o,l),v=m!==n;if(v){var p=o.__filtered;if(!p){var y=this.getSource(o);p=o.__filtered=s.create(y),p.__unfiltered=y}p[l]=n}return this.read(v?[m]:o,c,d,f)},readSupported:function(o,l){var c=this.getSource(o),d=this,f=!1;return c&&Object.keys(c).forEach(function(m){if(m in l){var v=d.readNamed(o,m);v!==n&&(l[m]=v),f=!0}}),f},getSource:function(o){var l=o.__source;if(l===n){var c=o.length===1&&o[0];l=o.__source=c&&s.isPlainObject(c)?c:null}return l},getNamed:function(o,l){var c=this.getSource(o);if(c)return l?c[l]:o.__filtered||c},hasNamed:function(o,l){return!!this.getNamed(o,l)},filter:function(o,l,c,d){var f;function m(A){if(!(c&&A in c)&&!(f&&A in f)){var P=l[A];P!==n&&(o[A]=P)}}if(d){for(var v={},p=0,y,I=d.length;p<I;p++)(y=d[p])in l&&(m(y),v[y]=!0);f=v}return Object.keys(l.__unfiltered||l).forEach(m),o},isPlainValue:function(o,l){return s.isPlainObject(o)||Array.isArray(o)||l&&typeof o=="string"},serialize:function(o,l,c,d){l=l||{};var f=!d,m;if(f&&(l.formatter=new _(l.precision),d={length:0,definitions:{},references:{},add:function(P,C){var S="#"+P._id,k=this.references[S];if(!k){this.length++;var O=C.call(P),F=P._class;F&&O[0]!==F&&O.unshift(F),this.definitions[S]=O,k=this.references[S]=[S]}return k}}),o&&o._serialize){m=o._serialize(l,d);var v=o._class;v&&!o._compactSerialize&&(f||!c)&&m[0]!==v&&m.unshift(v)}else if(Array.isArray(o)){m=[];for(var p=0,y=o.length;p<y;p++)m[p]=s.serialize(o[p],l,c,d)}else if(s.isPlainObject(o)){m={};for(var I=Object.keys(o),p=0,y=I.length;p<y;p++){var A=I[p];m[A]=s.serialize(o[A],l,c,d)}}else typeof o=="number"?m=l.formatter.number(o,l.precision):m=o;return f&&d.length>0?[["dictionary",d.definitions],m]:m},deserialize:function(o,l,c,d,f){var m=o,v=!c,p=v&&o&&o.length&&o[0][0]==="dictionary";if(c=c||{},Array.isArray(o)){var y=o[0],I=y==="dictionary";if(o.length==1&&/^#/.test(y))return c.dictionary[y];y=s.exports[y],m=[];for(var A=y?1:0,P=o.length;A<P;A++)m.push(s.deserialize(o[A],l,c,I,p));if(y){var C=m;l?m=l(y,C,v||f):m=new y(C)}}else if(s.isPlainObject(o)){m={},d&&(c.dictionary=m);for(var S in o)m[S]=s.deserialize(o[S],l,c)}return p?m[1]:m},exportJSON:function(o,l){var c=s.serialize(o,l);return l&&l.asString==!1?c:JSON.stringify(c)},importJSON:function(o,l){return s.deserialize(typeof o=="string"?JSON.parse(o):o,function(c,d,f){var m=f&&l&&l.constructor===c,v=m?l:s.create(c.prototype);if(d.length===1&&v instanceof te&&(m||!(v instanceof ce))){var p=d[0];s.isPlainObject(p)&&(p.insert=!1,m&&(d=d.concat([te.INSERT])))}return(m?v.set:c).apply(v,d),m&&(l=null),v})},push:function(o,l){var c=l.length;if(c<4096)o.push.apply(o,l);else{var d=o.length;o.length+=c;for(var f=0;f<c;f++)o[d+f]=l[f]}return o},splice:function(o,l,c,d){var f=l&&l.length,m=c===n;c=m?o.length:c,c>o.length&&(c=o.length);for(var v=0;v<f;v++)l[v]._index=c+v;if(m)return s.push(o,l),[];var p=[c,d];l&&s.push(p,l);for(var y=o.splice.apply(o,p),v=0,I=y.length;v<I;v++)y[v]._index=n;for(var v=c+f,I=o.length;v<I;v++)o[v]._index=v;return y},capitalize:function(o){return o.replace(/\b[a-z]/g,function(l){return l.toUpperCase()})},camelize:function(o){return o.replace(/-(.)/g,function(l,c){return c.toUpperCase()})},hyphenate:function(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function(o,l){if(typeof o!="string")s.each(o,function(m,v){this.on(v,m)},this);else{var c=this._eventTypes,d=c&&c[o],f=this._callbacks=this._callbacks||{};f=f[o]=f[o]||[],f.indexOf(l)===-1&&(f.push(l),d&&d.install&&f.length===1&&d.install.call(this,o))}return this},off:function(o,l){if(typeof o!="string"){s.each(o,function(v,p){this.off(p,v)},this);return}var c=this._eventTypes,d=c&&c[o],f=this._callbacks&&this._callbacks[o],m;return f&&(!l||(m=f.indexOf(l))!==-1&&f.length===1?(d&&d.uninstall&&d.uninstall.call(this,o),delete this._callbacks[o]):m!==-1&&f.splice(m,1)),this},once:function(o,l){return this.on(o,function c(){l.apply(this,arguments),this.off(o,c)})},emit:function(o,l){var c=this._callbacks&&this._callbacks[o];if(!c)return!1;var d=s.slice(arguments,1),f=l&&l.target&&!l.currentTarget;c=c.slice(),f&&(l.currentTarget=this);for(var m=0,v=c.length;m<v;m++)if(c[m].apply(this,d)==!1){l&&l.stop&&l.stop();break}return f&&delete l.currentTarget,!0},responds:function(o){return!!(this._callbacks&&this._callbacks[o])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(o){var l=this._eventTypes,c=this._callbacks,d=o?"install":"uninstall";if(l){for(var f in c)if(c[f].length>0){var m=l[f],v=m&&m[d];v&&v.call(this,f)}}},statics:{inject:function o(l){var c=l._events;if(c){var d={};s.each(c,function(f,m){var v=typeof f=="string",p=v?f:m,y=s.capitalize(p),I=p.substring(2).toLowerCase();d[I]=v?{}:f,p="_"+p,l["get"+y]=function(){return this[p]},l["set"+y]=function(A){var P=this[p];P&&this.off(I,P),A&&this.on(I,A),this[p]=A}}),l._eventTypes=d}return o.base.apply(this,arguments)}}},u=s.extend({_class:"PaperScope",initialize:function o(){de=this,this.settings=new s({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=o._id++,o._scopes[this._id]=this;var l=o.prototype;if(!this.support){var c=ie.getContext(1,1)||{};l.support={nativeDash:"setLineDash"in c||"mozDash"in c,nativeBlendModes:ge.nativeModes},ie.release(c)}if(!this.agent){var d=e.navigator.userAgent.toLowerCase(),f=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(d)||[])[0],m=f==="darwin"?"mac":f,v=l.agent=l.browser={platform:m};m&&(v[m]=!0),d.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(p,y,I,A,P){if(!v.chrome){var C=y==="opera"?A:/^(node|trident)$/.test(y)?P:I;v.version=C,v.versionNumber=parseFloat(C),y={trident:"msie",jsdom:"node"}[y]||y,v.name=y,v[y]=!0}}),v.chrome&&delete v.webkit,v.atom&&delete v.chrome}},version:"0.12.17",getView:function(){var o=this.project;return o&&o._view},getPaper:function(){return this},execute:function(o,l){},install:function(o){var l=this;s.each(["project","view","tool"],function(d){s.define(o,d,{configurable:!0,get:function(){return l[d]}})});for(var c in this)!/^_/.test(c)&&this[c]&&(o[c]=this[c])},setup:function(o){return de=this,this.project=new ne(o),this},createCanvas:function(o,l){return ie.getCanvas(o,l)},activate:function(){de=this},clear:function(){for(var o=this.projects,l=this.tools,c=o.length-1;c>=0;c--)o[c].remove();for(var c=l.length-1;c>=0;c--)l[c].remove()},remove:function(){this.clear(),delete u._scopes[this._id]},statics:new function(){function o(l){return l+="Attribute",function(c,d){return c[l](d)||c[l]("data-paper-"+d)}}return{_scopes:{},_id:0,get:function(l){return this._scopes[l]||null},getAttribute:o("get"),hasAttribute:o("has")}}}),h=s.extend(a,{initialize:function(o){this._scope=de,this._index=this._scope[this._list].push(this)-1,(o||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var o=this._scope[this._reference];return o&&o!==this&&o.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",o),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(s.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),g={findItemBoundsCollisions:function(o,l,c){function d(v){for(var p=new Array(v.length),y=0;y<v.length;y++){var I=v[y].getBounds();p[y]=[I.left,I.top,I.right,I.bottom]}return p}var f=d(o),m=!l||l===o?f:d(l);return this.findBoundsCollisions(f,m,c||0)},findCurveBoundsCollisions:function(o,l,c,d){function f(C){for(var S=Math.min,k=Math.max,O=new Array(C.length),F=0;F<C.length;F++){var N=C[F];O[F]=[S(N[0],N[2],N[4],N[6]),S(N[1],N[3],N[5],N[7]),k(N[0],N[2],N[4],N[6]),k(N[1],N[3],N[5],N[7])]}return O}var m=f(o),v=!l||l===o?m:f(l);if(d){for(var p=this.findBoundsCollisions(m,v,c||0,!1,!0),y=this.findBoundsCollisions(m,v,c||0,!0,!0),I=[],A=0,P=p.length;A<P;A++)I[A]={hor:p[A],ver:y[A]};return I}return this.findBoundsCollisions(m,v,c||0)},findBoundsCollisions:function(o,l,c,d,f){var m=!l||o===l,v=m?o:o.concat(l),p=o.length,y=v.length;function I(Se,be,We){for(var $e=0,ze=Se.length;$e<ze;){var je=ze+$e>>>1;v[Se[je]][be]<We?$e=je+1:ze=je}return $e-1}for(var A=d?1:0,P=A+2,C=d?0:1,S=C+2,k=new Array(y),O=0;O<y;O++)k[O]=O;k.sort(function(Se,be){return v[Se][A]-v[be][A]});for(var F=[],N=new Array(p),O=0;O<y;O++){var D=k[O],x=v[D],b=m?D:D-p,M=D<p,L=m||!M,$=M?[]:null;if(F.length){var H=I(F,P,x[A]-c)+1;if(F.splice(0,H),m&&f){$=$.concat(F);for(var q=0;q<F.length;q++){var W=F[q];N[W].push(b)}}else for(var Q=x[S],K=x[C],q=0;q<F.length;q++){var W=F[q],Y=v[W],ee=W<p,re=m||W>=p;(f||(M&&re||L&&ee)&&Q>=Y[C]-c&&K<=Y[S]+c)&&(M&&re&&$.push(m?W:W-p),L&&ee&&N[W].push(b))}}if(M&&(o===l&&$.push(D),N[D]=$),F.length){var oe=x[P],le=I(F,P,oe);F.splice(le+1,0,D)}else F.push(D)}for(var O=0;O<N.length;O++){var Ie=N[O];Ie&&Ie.sort(function(be,We){return be-We})}return N}},_=s.extend({initialize:function(o){this.precision=s.pick(o,5),this.multiplier=Math.pow(10,this.precision)},number:function(o){return this.precision<16?Math.round(o*this.multiplier)/this.multiplier:o},pair:function(o,l,c){return this.number(o)+(c||",")+this.number(l)},point:function(o,l){return this.number(o.x)+(l||",")+this.number(o.y)},size:function(o,l){return this.number(o.width)+(l||",")+this.number(o.height)},rectangle:function(o,l){return this.point(o,l)+(l||",")+this.size(o,l)}});_.instance=new _;var w=new function(){var o=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],l=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],c=Math.abs,d=Math.sqrt,f=Math.pow,m=Math.log2||function(P){return Math.log(P)*Math.LOG2E},v=1e-12,p=112e-18;function y(P,C,S){return P<C?C:P>S?S:P}function I(P,C,S){function k(H){var q=H*134217729,W=H-q,Q=W+q,K=H-Q;return[Q,K]}var O=C*C-P*S,F=C*C+P*S;if(c(O)*3<F){var N=k(P),D=k(C),x=k(S),b=C*C,M=D[0]*D[0]-b+2*D[0]*D[1]+D[1]*D[1],L=P*S,$=N[0]*x[0]-L+N[0]*x[1]+N[1]*x[0]+N[1]*x[1];O=b-L+(M-$)}return O}function A(){var P=Math.max.apply(Math,arguments);return P&&(P<1e-8||P>1e8)?f(2,-Math.round(m(P))):0}return{EPSILON:v,MACHINE_EPSILON:p,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(d(2)-1)/3,isZero:function(P){return P>=-v&&P<=v},isMachineZero:function(P){return P>=-p&&P<=p},clamp:y,integrate:function(P,C,S,k){for(var O=o[k-2],F=l[k-2],N=(S-C)*.5,D=N+C,x=0,b=k+1>>1,M=k&1?F[x++]*P(D):0;x<b;){var L=N*O[x];M+=F[x++]*(P(D+L)+P(D-L))}return N*M},findRoot:function(P,C,S,k,O,F,N){for(var D=0;D<F;D++){var x=P(S),b=x/C(S),M=S-b;if(c(b)<N){S=M;break}x>0?(O=S,S=M<=k?(k+O)*.5:M):(k=S,S=M>=O?(k+O)*.5:M)}return y(S,k,O)},solveQuadratic:function(P,C,S,k,O,F){var N,D=1/0;if(c(P)<v){if(c(C)<v)return c(S)<v?-1:0;N=-S/C}else{C*=-.5;var x=I(P,C,S);if(x&&c(x)<p){var b=A(c(P),c(C),c(S));b&&(P*=b,C*=b,S*=b,x=I(P,C,S))}if(x>=-p){var M=x<0?0:d(x),L=C+(C<0?-M:M);L===0?(N=S/P,D=-N):(N=L/P,D=S/L)}}var $=0,H=O==null,q=O-v,W=F+v;return isFinite(N)&&(H||N>q&&N<W)&&(k[$++]=H?N:y(N,O,F)),D!==N&&isFinite(D)&&(H||D>q&&D<W)&&(k[$++]=H?D:y(D,O,F)),$},solveCubic:function(P,C,S,k,O,F,N){var D=A(c(P),c(C),c(S),c(k)),x,b,M,L,$;D&&(P*=D,C*=D,S*=D,k*=D);function H(le){x=le;var Ie=P*x;b=Ie+C,M=b*x+S,L=(Ie+b)*x+M,$=M*x+k}if(c(P)<v)P=C,b=S,M=k,x=1/0;else if(c(k)<v)b=C,M=S,x=0;else{H(-(C/P)/3);var q=$/P,W=f(c(q),1/3),Q=q<0?-1:1,K=-L/P,Y=K>0?1.324717957244746*Math.max(W,d(K)):W,ee=x-Q*Y;if(ee!==x){do H(ee),ee=L===0?x:x-$/L/(1+p);while(Q*ee>Q*x);c(P)*x*x>c(k/x)&&(M=-k/x,b=(M-S)/x)}}var re=w.solveQuadratic(P,b,M,O,F,N),oe=F==null;return isFinite(x)&&(re===0||re>0&&x!==O[0]&&x!==O[1])&&(oe||x>F-v&&x<N+v)&&(O[re++]=oe?x:y(x,F,N)),re}}},T={_id:1,_pools:{},get:function(o){if(o){var l=this._pools[o];return l||(l=this._pools[o]={_id:1}),l._id++}else return this._id++}},E=s.extend({_class:"Point",_readIndex:!0,initialize:function(l,c){var d=typeof l,f=this.__read,m=0;if(d==="number"){var v=typeof c=="number";this._set(l,v?c:l),f&&(m=v?2:1)}else if(d==="undefined"||l===null)this._set(0,0),f&&(m=l===null?1:0);else{var p=d==="string"?l.split(/[\s,]+/)||[]:l;m=1,Array.isArray(p)?this._set(+p[0],+(p.length>1?p[1]:p[0])):"x"in p?this._set(p.x||0,p.y||0):"width"in p?this._set(p.width||0,p.height||0):"angle"in p?(this._set(p.length||0,0),this.setAngle(p.angle||0)):(this._set(0,0),m=0)}return f&&(this.__read=m),this},set:"#initialize",_set:function(o,l){return this.x=o,this.y=l,this},equals:function(o){return this===o||o&&(this.x===o.x&&this.y===o.y||Array.isArray(o)&&this.x===o[0]&&this.y===o[1])||!1},clone:function(){return new E(this.x,this.y)},toString:function(){var o=_.instance;return"{ x: "+o.number(this.x)+", y: "+o.number(this.y)+" }"},_serialize:function(o){var l=o.formatter;return[l.number(this.x),l.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(o){if(this.isZero()){var l=this._angle||0;this._set(Math.cos(l)*o,Math.sin(l)*o)}else{var c=o/this.getLength();w.isZero(c)&&this.getAngle(),this._set(this.x*c,this.y*c)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(o){this.setAngleInRadians.call(this,o*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var o=E.read(arguments),l=this.getLength()*o.getLength();if(w.isZero(l))return NaN;var c=this.dot(o)/l;return Math.acos(c<-1?-1:c>1?1:c)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(o){if(this._angle=o,!this.isZero()){var l=this.getLength();this._set(Math.cos(o)*l,Math.sin(o)*l)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var o=E.read(arguments);return Math.atan2(this.cross(o),this.dot(o))*180/Math.PI},getDistance:function(){var o=arguments,l=E.read(o),c=l.x-this.x,d=l.y-this.y,f=c*c+d*d,m=s.read(o);return m?f:Math.sqrt(f)},normalize:function(o){o===n&&(o=1);var l=this.getLength(),c=l!==0?o/l:0,d=new E(this.x*c,this.y*c);return c>=0&&(d._angle=this._angle),d},rotate:function(o,l){if(o===0)return this.clone();o=o*Math.PI/180;var c=l?this.subtract(l):this,d=Math.sin(o),f=Math.cos(o);return c=new E(c.x*f-c.y*d,c.x*d+c.y*f),l?c.add(l):c},transform:function(o){return o?o._transformPoint(this):this},add:function(){var o=E.read(arguments);return new E(this.x+o.x,this.y+o.y)},subtract:function(){var o=E.read(arguments);return new E(this.x-o.x,this.y-o.y)},multiply:function(){var o=E.read(arguments);return new E(this.x*o.x,this.y*o.y)},divide:function(){var o=E.read(arguments);return new E(this.x/o.x,this.y/o.y)},modulo:function(){var o=E.read(arguments);return new E(this.x%o.x,this.y%o.y)},negate:function(){return new E(-this.x,-this.y)},isInside:function(){return V.read(arguments).contains(this)},isClose:function(){var o=arguments,l=E.read(o),c=s.read(o);return this.getDistance(l)<=c},isCollinear:function(){var o=E.read(arguments);return E.isCollinear(this.x,this.y,o.x,o.y)},isColinear:"#isCollinear",isOrthogonal:function(){var o=E.read(arguments);return E.isOrthogonal(this.x,this.y,o.x,o.y)},isZero:function(){var o=w.isZero;return o(this.x)&&o(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(o){return this.x*(o>1&&o<4?-1:1)>=0&&this.y*(o>2?-1:1)>=0},dot:function(){var o=E.read(arguments);return this.x*o.x+this.y*o.y},cross:function(){var o=E.read(arguments);return this.x*o.y-this.y*o.x},project:function(){var o=E.read(arguments),l=o.isZero()?0:this.dot(o)/o.dot(o);return new E(o.x*l,o.y*l)},statics:{min:function(){var o=arguments,l=E.read(o),c=E.read(o);return new E(Math.min(l.x,c.x),Math.min(l.y,c.y))},max:function(){var o=arguments,l=E.read(o),c=E.read(o);return new E(Math.max(l.x,c.x),Math.max(l.y,c.y))},random:function(){return new E(Math.random(),Math.random())},isCollinear:function(o,l,c,d){return Math.abs(o*d-l*c)<=Math.sqrt((o*o+l*l)*(c*c+d*d))*1e-8},isOrthogonal:function(o,l,c,d){return Math.abs(o*c+l*d)<=Math.sqrt((o*o+l*l)*(c*c+d*d))*1e-8}}},s.each(["round","ceil","floor","abs"],function(o){var l=Math[o];this[o]=function(){return new E(l(this.x),l(this.y))}},{})),z=E.extend({initialize:function(l,c,d,f){this._x=l,this._y=c,this._owner=d,this._setter=f},_set:function(o,l,c){return this._x=o,this._y=l,c||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(o){this._x=o,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(o){this._y=o,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(o){this._owner._changeSelection(this._getSelection(),o)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),j=s.extend({_class:"Size",_readIndex:!0,initialize:function(l,c){var d=typeof l,f=this.__read,m=0;if(d==="number"){var v=typeof c=="number";this._set(l,v?c:l),f&&(m=v?2:1)}else if(d==="undefined"||l===null)this._set(0,0),f&&(m=l===null?1:0);else{var p=d==="string"?l.split(/[\s,]+/)||[]:l;m=1,Array.isArray(p)?this._set(+p[0],+(p.length>1?p[1]:p[0])):"width"in p?this._set(p.width||0,p.height||0):"x"in p?this._set(p.x||0,p.y||0):(this._set(0,0),m=0)}return f&&(this.__read=m),this},set:"#initialize",_set:function(o,l){return this.width=o,this.height=l,this},equals:function(o){return o===this||o&&(this.width===o.width&&this.height===o.height||Array.isArray(o)&&this.width===o[0]&&this.height===o[1])||!1},clone:function(){return new j(this.width,this.height)},toString:function(){var o=_.instance;return"{ width: "+o.number(this.width)+", height: "+o.number(this.height)+" }"},_serialize:function(o){var l=o.formatter;return[l.number(this.width),l.number(this.height)]},add:function(){var o=j.read(arguments);return new j(this.width+o.width,this.height+o.height)},subtract:function(){var o=j.read(arguments);return new j(this.width-o.width,this.height-o.height)},multiply:function(){var o=j.read(arguments);return new j(this.width*o.width,this.height*o.height)},divide:function(){var o=j.read(arguments);return new j(this.width/o.width,this.height/o.height)},modulo:function(){var o=j.read(arguments);return new j(this.width%o.width,this.height%o.height)},negate:function(){return new j(-this.width,-this.height)},isZero:function(){var o=w.isZero;return o(this.width)&&o(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(o,l){return new j(Math.min(o.width,l.width),Math.min(o.height,l.height))},max:function(o,l){return new j(Math.max(o.width,l.width),Math.max(o.height,l.height))},random:function(){return new j(Math.random(),Math.random())}}},s.each(["round","ceil","floor","abs"],function(o){var l=Math[o];this[o]=function(){return new j(l(this.width),l(this.height))}},{})),J=j.extend({initialize:function(l,c,d,f){this._width=l,this._height=c,this._owner=d,this._setter=f},_set:function(o,l,c){return this._width=o,this._height=l,c||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(o){this._width=o,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(o){this._height=o,this._owner[this._setter](this)}}),V=s.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(l,c,d,f){var m=arguments,v=typeof l,p;if(v==="number"?(this._set(l,c,d,f),p=4):v==="undefined"||l===null?(this._set(0,0,0,0),p=l===null?1:0):m.length===1&&(Array.isArray(l)?(this._set.apply(this,l),p=1):l.x!==n||l.width!==n?(this._set(l.x||0,l.y||0,l.width||0,l.height||0),p=1):l.from===n&&l.to===n&&(this._set(0,0,0,0),s.readSupported(m,this)&&(p=1))),p===n){var y=E.readNamed(m,"from"),I=s.peek(m),A=y.x,P=y.y,C,S;if(I&&I.x!==n||s.hasNamed(m,"to")){var k=E.readNamed(m,"to");C=k.x-A,S=k.y-P,C<0&&(A=k.x,C=-C),S<0&&(P=k.y,S=-S)}else{var O=j.read(m);C=O.width,S=O.height}this._set(A,P,C,S),p=m.__index}var F=m.__filtered;return F&&(this.__filtered=F),this.__read&&(this.__read=p),this},set:"#initialize",_set:function(o,l,c,d){return this.x=o,this.y=l,this.width=c,this.height=d,this},clone:function(){return new V(this.x,this.y,this.width,this.height)},equals:function(o){var l=s.isPlainValue(o)?V.read(arguments):o;return l===this||l&&this.x===l.x&&this.y===l.y&&this.width===l.width&&this.height===l.height||!1},toString:function(){var o=_.instance;return"{ x: "+o.number(this.x)+", y: "+o.number(this.y)+", width: "+o.number(this.width)+", height: "+o.number(this.height)+" }"},_serialize:function(o){var l=o.formatter;return[l.number(this.x),l.number(this.y),l.number(this.width),l.number(this.height)]},getPoint:function(o){var l=o?E:z;return new l(this.x,this.y,this,"setPoint")},setPoint:function(){var o=E.read(arguments);this.x=o.x,this.y=o.y},getSize:function(o){var l=o?j:J;return new l(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var o=j.read(arguments),l=this._sx,c=this._sy,d=o.width,f=o.height;l&&(this.x+=(this.width-d)*l),c&&(this.y+=(this.height-f)*c),this.width=d,this.height=f,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(o){if(!this._fw){var l=o-this.x;this.width-=this._sx===.5?l*2:l}this.x=o,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(o){if(!this._fh){var l=o-this.y;this.height-=this._sy===.5?l*2:l}this.y=o,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(o){if(!this._fw){var l=o-this.x;this.width=this._sx===.5?l*2:l}this.x=o-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(o){if(!this._fh){var l=o-this.y;this.height=this._sy===.5?l*2:l}this.y=o-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(o){this._fw||this._sx===.5?this.x=o-this.width/2:(this._sx&&(this.x+=(o-this.x)*2*this._sx),this.width=(o-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(o){this._fh||this._sy===.5?this.y=o-this.height/2:(this._sy&&(this.y+=(o-this.y)*2*this._sy),this.height=(o-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(o){var l=o?E:z;return new l(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var o=E.read(arguments);return this.setCenterX(o.x),this.setCenterY(o.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(o){return o&&o.width!==n||(Array.isArray(o)?o:arguments).length===4?this._containsRectangle(V.read(arguments)):this._containsPoint(E.read(arguments))},_containsPoint:function(o){var l=o.x,c=o.y;return l>=this.x&&c>=this.y&&l<=this.x+this.width&&c<=this.y+this.height},_containsRectangle:function(o){var l=o.x,c=o.y;return l>=this.x&&c>=this.y&&l+o.width<=this.x+this.width&&c+o.height<=this.y+this.height},intersects:function(){var o=V.read(arguments),l=s.read(arguments)||0;return o.x+o.width>this.x-l&&o.y+o.height>this.y-l&&o.x<this.x+this.width+l&&o.y<this.y+this.height+l},intersect:function(){var o=V.read(arguments),l=Math.max(this.x,o.x),c=Math.max(this.y,o.y),d=Math.min(this.x+this.width,o.x+o.width),f=Math.min(this.y+this.height,o.y+o.height);return new V(l,c,d-l,f-c)},unite:function(){var o=V.read(arguments),l=Math.min(this.x,o.x),c=Math.min(this.y,o.y),d=Math.max(this.x+this.width,o.x+o.width),f=Math.max(this.y+this.height,o.y+o.height);return new V(l,c,d-l,f-c)},include:function(){var o=E.read(arguments),l=Math.min(this.x,o.x),c=Math.min(this.y,o.y),d=Math.max(this.x+this.width,o.x),f=Math.max(this.y+this.height,o.y);return new V(l,c,d-l,f-c)},expand:function(){var o=j.read(arguments),l=o.width,c=o.height;return new V(this.x-l/2,this.y-c/2,this.width+l,this.height+c)},scale:function(o,l){return this.expand(this.width*o-this.width,this.height*(l===n?o:l)-this.height)}},s.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(o,l){var c=o.join(""),d=/^[RL]/.test(c);l>=4&&(o[1]+=d?"Y":"X");var f=o[d?0:1],m=o[d?1:0],v="get"+f,p="get"+m,y="set"+f,I="set"+m,A="get"+c,P="set"+c;this[A]=function(C){var S=C?E:z;return new S(this[v](),this[p](),this,P)},this[P]=function(){var C=E.read(arguments);this[y](C.x),this[I](C.y)}},{beans:!0})),B=V.extend({initialize:function(l,c,d,f,m,v){this._set(l,c,d,f,!0),this._owner=m,this._setter=v},_set:function(o,l,c,d,f){return this._x=o,this._y=l,this._width=c,this._height=d,f||this._owner[this._setter](this),this}},new function(){var o=V.prototype;return s.each(["x","y","width","height"],function(l){var c=s.capitalize(l),d="_"+l;this["get"+c]=function(){return this[d]},this["set"+c]=function(f){this[d]=f,this._dontNotify||this._owner[this._setter](this)}},s.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(l){var c="set"+l;this[c]=function(){this._dontNotify=!0,o[c].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(l){var c=this._owner;c._changeSelection&&c._changeSelection(2,l)}}))}),U=s.extend({_class:"Matrix",initialize:function o(l,c){var d=arguments,f=d.length,m=!0;if(f>=6?this._set.apply(this,d):f===1||f===2?l instanceof o?this._set(l._a,l._b,l._c,l._d,l._tx,l._ty,c):Array.isArray(l)?this._set.apply(this,c?l.concat([c]):l):m=!1:f?m=!1:this.reset(),!m)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(o,l,c,d,f,m,v){return this._a=o,this._b=l,this._c=c,this._d=d,this._tx=f,this._ty=m,v||this._changed(),this},_serialize:function(o,l){return s.serialize(this.getValues(),o,!0,l)},_changed:function(){var o=this._owner;o&&(o._applyMatrix?o.transform(null,!0):o._changed(25))},clone:function(){return new U(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(o){return o===this||o&&this._a===o._a&&this._b===o._b&&this._c===o._c&&this._d===o._d&&this._tx===o._tx&&this._ty===o._ty},toString:function(){var o=_.instance;return"[["+[o.number(this._a),o.number(this._c),o.number(this._tx)].join(", ")+"], ["+[o.number(this._b),o.number(this._d),o.number(this._ty)].join(", ")+"]]"},reset:function(o){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,o||this._changed(),this},apply:function(o,l){var c=this._owner;return c?(c.transform(null,s.pick(o,!0),l),this.isIdentity()):!1},translate:function(){var o=E.read(arguments),l=o.x,c=o.y;return this._tx+=l*this._a+c*this._c,this._ty+=l*this._b+c*this._d,this._changed(),this},scale:function(){var o=arguments,l=E.read(o),c=E.read(o,0,{readNull:!0});return c&&this.translate(c),this._a*=l.x,this._b*=l.x,this._c*=l.y,this._d*=l.y,c&&this.translate(c.negate()),this._changed(),this},rotate:function(o){o*=Math.PI/180;var l=E.read(arguments,1),c=l.x,d=l.y,f=Math.cos(o),m=Math.sin(o),v=c-c*f+d*m,p=d-c*m-d*f,y=this._a,I=this._b,A=this._c,P=this._d;return this._a=f*y+m*A,this._b=f*I+m*P,this._c=-m*y+f*A,this._d=-m*I+f*P,this._tx+=v*y+p*A,this._ty+=v*I+p*P,this._changed(),this},shear:function(){var o=arguments,l=E.read(o),c=E.read(o,0,{readNull:!0});c&&this.translate(c);var d=this._a,f=this._b;return this._a+=l.y*this._c,this._b+=l.y*this._d,this._c+=l.x*d,this._d+=l.x*f,c&&this.translate(c.negate()),this._changed(),this},skew:function(){var o=arguments,l=E.read(o),c=E.read(o,0,{readNull:!0}),d=Math.PI/180,f=new E(Math.tan(l.x*d),Math.tan(l.y*d));return this.shear(f,c)},append:function(o,l){if(o){var c=this._a,d=this._b,f=this._c,m=this._d,v=o._a,p=o._c,y=o._b,I=o._d,A=o._tx,P=o._ty;this._a=v*c+y*f,this._c=p*c+I*f,this._b=v*d+y*m,this._d=p*d+I*m,this._tx+=A*c+P*f,this._ty+=A*d+P*m,l||this._changed()}return this},prepend:function(o,l){if(o){var c=this._a,d=this._b,f=this._c,m=this._d,v=this._tx,p=this._ty,y=o._a,I=o._c,A=o._b,P=o._d,C=o._tx,S=o._ty;this._a=y*c+I*d,this._c=y*f+I*m,this._b=A*c+P*d,this._d=A*f+P*m,this._tx=y*v+I*p+C,this._ty=A*v+P*p+S,l||this._changed()}return this},appended:function(o){return this.clone().append(o)},prepended:function(o){return this.clone().prepend(o)},invert:function(){var o=this._a,l=this._b,c=this._c,d=this._d,f=this._tx,m=this._ty,v=o*d-l*c,p=null;return v&&!isNaN(v)&&isFinite(f)&&isFinite(m)&&(this._a=d/v,this._b=-l/v,this._c=-c/v,this._d=o/v,this._tx=(c*m-d*f)/v,this._ty=(l*f-o*m)/v,p=this),p},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new U(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var o=this._a*this._d-this._c*this._b;return o&&!isNaN(o)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(o,l,c){return arguments.length<3?this._transformPoint(E.read(arguments)):this._transformCoordinates(o,l,c)},_transformPoint:function(o,l,c){var d=o.x,f=o.y;return l||(l=new E),l._set(d*this._a+f*this._c+this._tx,d*this._b+f*this._d+this._ty,c)},_transformCoordinates:function(o,l,c){for(var d=0,f=2*c;d<f;d+=2){var m=o[d],v=o[d+1];l[d]=m*this._a+v*this._c+this._tx,l[d+1]=m*this._b+v*this._d+this._ty}return l},_transformCorners:function(o){var l=o.x,c=o.y,d=l+o.width,f=c+o.height,m=[l,c,d,c,d,f,l,f];return this._transformCoordinates(m,m,4)},_transformBounds:function(o,l,c){for(var d=this._transformCorners(o),f=d.slice(0,2),m=f.slice(),v=2;v<8;v++){var p=d[v],y=v&1;p<f[y]?f[y]=p:p>m[y]&&(m[y]=p)}return l||(l=new V),l._set(f[0],f[1],m[0]-f[0],m[1]-f[1],c)},inverseTransform:function(){return this._inverseTransform(E.read(arguments))},_inverseTransform:function(o,l,c){var d=this._a,f=this._b,m=this._c,v=this._d,p=this._tx,y=this._ty,I=d*v-f*m,A=null;if(I&&!isNaN(I)&&isFinite(p)&&isFinite(y)){var P=o.x-this._tx,C=o.y-this._ty;l||(l=new E),A=l._set((P*v-C*m)/I,(C*d-P*f)/I,c)}return A},decompose:function(){var o=this._a,l=this._b,c=this._c,d=this._d,f=o*d-l*c,m=Math.sqrt,v=Math.atan2,p=180/Math.PI,y,I,A;if(o!==0||l!==0){var P=m(o*o+l*l);y=Math.acos(o/P)*(l>0?1:-1),I=[P,f/P],A=[v(o*c+l*d,P*P),0]}else if(c!==0||d!==0){var C=m(c*c+d*d);y=Math.asin(c/C)*(d>0?1:-1),I=[f/C,C],A=[0,v(o*c+l*d,C*C)]}else y=0,A=I=[0,0];return{translation:this.getTranslation(),rotation:y*p,scaling:new E(I),skewing:new E(A[0]*p,A[1]*p)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new E(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(o){this.isIdentity()||o.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},s.each(["a","b","c","d","tx","ty"],function(o){var l=s.capitalize(o),c="_"+o;this["get"+l]=function(){return this[c]},this["set"+l]=function(d){this[c]=d,this._changed()}},{})),Z=s.extend({_class:"Line",initialize:function(l,c,d,f,m){var v=!1;arguments.length>=4?(this._px=l,this._py=c,this._vx=d,this._vy=f,v=m):(this._px=l.x,this._py=l.y,this._vx=c.x,this._vy=c.y,v=d),v||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new E(this._px,this._py)},getVector:function(){return new E(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(o,l){return Z.intersect(this._px,this._py,this._vx,this._vy,o._px,o._py,o._vx,o._vy,!0,l)},getSide:function(o,l){return Z.getSide(this._px,this._py,this._vx,this._vy,o.x,o.y,!0,l)},getDistance:function(o){return Math.abs(this.getSignedDistance(o))},getSignedDistance:function(o){return Z.getSignedDistance(this._px,this._py,this._vx,this._vy,o.x,o.y,!0)},isCollinear:function(o){return E.isCollinear(this._vx,this._vy,o._vx,o._vy)},isOrthogonal:function(o){return E.isOrthogonal(this._vx,this._vy,o._vx,o._vy)},statics:{intersect:function(o,l,c,d,f,m,v,p,y,I){y||(c-=o,d-=l,v-=f,p-=m);var A=c*p-d*v;if(!w.isMachineZero(A)){var P=o-f,C=l-m,S=(v*C-p*P)/A,k=(c*C-d*P)/A,O=1e-12,F=-O,N=1+O;if(I||F<S&&S<N&&F<k&&k<N)return I||(S=S<=0?0:S>=1?1:S),new E(o+S*c,l+S*d)}},getSide:function(o,l,c,d,f,m,v,p){v||(c-=o,d-=l);var y=f-o,I=m-l,A=y*d-I*c;return!p&&w.isMachineZero(A)&&(A=(y*c+y*c)/(c*c+d*d),A>=0&&A<=1&&(A=0)),A<0?-1:A>0?1:0},getSignedDistance:function(o,l,c,d,f,m,v){return v||(c-=o,d-=l),c===0?d>0?f-o:o-f:d===0?c<0?m-l:l-m:((f-o)*d-(m-l)*c)/(d>c?d*Math.sqrt(1+c*c/(d*d)):c*Math.sqrt(1+d*d/(c*c)))},getDistance:function(o,l,c,d,f,m,v){return Math.abs(Z.getSignedDistance(o,l,c,d,f,m,v))}}}),ne=h.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(l){h.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Zi(null,null,this),this._view=Pt.create(this,l||ie.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(o,l){return s.serialize(this._children,o,!0,l)},_changed:function(o,l){if(o&1){var c=this._view;c&&(c._needsUpdate=!0,!c._requested&&c._autoUpdate&&c.requestUpdate())}var d=this._changes;if(d&&l){var f=this._changesById,m=l._id,v=f[m];v?v.flags|=o:d.push(f[m]={item:l,flags:o})}},clear:function(){for(var o=this._children,l=o.length-1;l>=0;l--)o[l].remove()},isEmpty:function(){return!this._children.length},remove:function o(){return o.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(o){this._currentStyle.set(o)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new ce({project:this,insert:!0})},getSymbolDefinitions:function(){var o=[],l={};return this.getItems({class:Ze,match:function(c){var d=c._definition,f=d._id;return l[f]||(l[f]=!0,o.push(d)),!1}}),o},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var o=this._selectionItems,l=[];for(var c in o){var d=o[c],f=d._selection;f&1&&d.isInserted()?l.push(d):f||this._updateSelection(d)}return l},_updateSelection:function(o){var l=o._id,c=this._selectionItems;o._selection?c[l]!==o&&(this._selectionCount++,c[l]=o):c[l]===o&&(this._selectionCount--,delete c[l])},selectAll:function(){for(var o=this._children,l=0,c=o.length;l<c;l++)o[l].setFullySelected(!0)},deselectAll:function(){var o=this._selectionItems;for(var l in o)o[l].setFullySelected(!1)},addLayer:function(o){return this.insertLayer(n,o)},insertLayer:function(o,l){if(l instanceof ce){l._remove(!1,!0),s.splice(this._children,[l],o,0),l._setProject(this,!0);var c=l._name;c&&l.setName(c),this._changes&&l._changed(5),this._activeLayer||(this._activeLayer=l)}else l=null;return l},_insertItem:function(o,l,c){return l=this.insertLayer(o,l)||(this._activeLayer||this._insertItem(n,new ce(te.NO_INSERT),!0)).insertChild(o,l),c&&l.activate&&l.activate(),l},getItems:function(o){return te._getItems(this,o)},getItem:function(o){return te._getItems(this,o,null,null,!0)[0]||null},importJSON:function(o){this.activate();var l=this._activeLayer;return s.importJSON(o,l&&l.isEmpty()&&l)},removeOn:function(o){var l=this._removeSets;if(l){o==="mouseup"&&(l.mousedrag=null);var c=l[o];if(c){for(var d in c){var f=c[d];for(var m in l){var v=l[m];v&&v!=c&&delete v[f._id]}f.remove()}l[o]=null}}},draw:function(o,l,c){this._updateVersion++,o.save(),l.applyToContext(o);for(var d=this._children,f=new s({offset:new E(0,0),pixelRatio:c,viewMatrix:l.isIdentity()?null:l,matrices:[new U],updateMatrix:!0}),m=0,v=d.length;m<v;m++)d[m].draw(o,f);if(o.restore(),this._selectionCount>0){o.save(),o.strokeWidth=1;var p=this._selectionItems,y=this._scope.settings.handleSize,I=this._updateVersion;for(var A in p)p[A]._drawSelection(o,l,y,p,I);o.restore()}}}),te=s.extend(a,{statics:{extend:function o(l){return l._serializeFields&&(l._serializeFields=s.set({},this.prototype._serializeFields,l._serializeFields)),o.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new U,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var o=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return s.each(o,function(l){this._events[l]={install:function(c){this.getView()._countItemEvent(c,1)},uninstall:function(c){this.getView()._countItemEvent(c,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:o}})},{initialize:function(){},_initialize:function(o,l){var c=o&&s.isPlainObject(o),d=c&&o.internal===!0,f=this._matrix=new U,m=c&&o.project||de.project,v=de.settings;return this._id=d?null:T.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&v.applyMatrix,l&&f.translate(l),f._owner=this,this._style=new Zi(m._currentStyle,this,m),d||c&&o.insert==!1||!v.insertItems&&!(c&&o.insert==!0)?this._setProject(m):(c&&o.parent||m)._insertItem(n,this,!0),c&&o!==te.NO_INSERT&&o!==te.INSERT&&this.set(o,{internal:!0,insert:!0,project:!0,parent:!0}),c},_serialize:function(o,l){var c={},d=this;function f(m){for(var v in m){var p=d[v];s.equals(p,v==="leading"?m.fontSize*1.2:m[v])||(c[v]=s.serialize(p,o,v!=="data",l))}}return f(this._serializeFields),this instanceof ae||f(this._style._defaults),[this._class,c]},_changed:function(o){var l=this._symbol,c=this._parent||l,d=this._project;o&8&&(this._bounds=this._position=this._decomposed=n),o&16&&(this._globalMatrix=n),c&&o&72&&te._clearBoundsCache(c),o&2&&te._clearBoundsCache(this),d&&d._changed(o,this),l&&l._changed(o)},getId:function(){return this._id},getName:function(){return this._name},setName:function(o){if(this._name&&this._removeNamed(),o===+o+"")throw new Error("Names consisting only of numbers are not supported.");var l=this._getOwner();if(o&&l){var c=l._children,d=l._namedChildren;(d[o]=d[o]||[]).push(this),o in c||(c[o]=this)}this._name=o||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(o){this.getStyle().set(o)}},s.each(["locked","visible","blendMode","opacity","guide"],function(o){var l=s.capitalize(o),c="_"+o,d={locked:256,visible:265};this["get"+l]=function(){return this[c]},this["set"+l]=function(f){f!=this[c]&&(this[c]=f,this._changed(d[o]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(o){if(o!==this._selection){this._selection=o;var l=this._project;l&&(l._updateSelection(this),this._changed(257))}},_changeSelection:function(o,l){var c=this._selection;this.setSelection(l?c|o:c&~o)},isSelected:function(){if(this._selectChildren){for(var o=this._children,l=0,c=o.length;l<c;l++)if(o[l].isSelected())return!0}return!!(this._selection&1)},setSelected:function(o){if(this._selectChildren)for(var l=this._children,c=0,d=l.length;c<d;c++)l[c].setSelected(o);this._changeSelection(1,o)},isFullySelected:function(){var o=this._children,l=!!(this._selection&1);if(o&&l){for(var c=0,d=o.length;c<d;c++)if(!o[c].isFullySelected())return!1;return!0}return l},setFullySelected:function(o){var l=this._children;if(l)for(var c=0,d=l.length;c<d;c++)l[c].setFullySelected(o);this._changeSelection(1,o)},isClipMask:function(){return this._clipMask},setClipMask:function(o){this._clipMask!=(o=!!o)&&(this._clipMask=o,o&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(o){this._data=o},getPosition:function(o){var l=o?E:z,c=this._position||(this._position=this._getPositionFromBounds());return new l(c.x,c.y,this,"setPosition")},setPosition:function(){this.translate(E.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(o){return this._pivot?this._matrix._transformPoint(this._pivot):(o||this.getBounds()).getCenter(!0)},getPivot:function(){var o=this._pivot;return o?new z(o.x,o.y,this,"setPivot"):null},setPivot:function(){this._pivot=E.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},s.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(o,l){this[l]=function(c){return this.getBounds(c,o)}},{beans:!0,getBounds:function(o,l){var c=l||o instanceof U,d=s.set({},c?l:o,this._boundsOptions);(!d.stroke||this.getStrokeScaling())&&(d.cacheItem=this);var f=this._getCachedBounds(c&&o,d).rect;return arguments.length?f:new B(f.x,f.y,f.width,f.height,this,"setBounds")},setBounds:function(){var o=V.read(arguments),l=this.getBounds(),c=this._matrix,d=new U,f=o.getCenter();d.translate(f),(o.width!=l.width||o.height!=l.height)&&(c.isInvertible()||(c.set(c._backup||new U().translate(c.getTranslation())),l=this.getBounds()),d.scale(l.width!==0?o.width/l.width:0,l.height!==0?o.height/l.height:0)),f=l.getCenter(),d.translate(-f.x,-f.y),this.transform(d)},_getBounds:function(o,l){var c=this._children;return!c||!c.length?new V:(te._updateBoundsCache(this,l.cacheItem),te._getBounds(c,o,l))},_getBoundsCacheKey:function(o,l){return[o.stroke?1:0,o.handle?1:0,l?1:0].join("")},_getCachedBounds:function(o,l,c){o=o&&o._orNullIfIdentity();var d=l.internal&&!c,f=l.cacheItem,m=d?null:this._matrix._orNullIfIdentity(),v=f&&(!o||o.equals(m))&&this._getBoundsCacheKey(l,d),p=this._bounds;if(te._updateBoundsCache(this._parent||this._symbol,f),v&&p&&v in p){var y=p[v];return{rect:y.rect.clone(),nonscaling:y.nonscaling}}var I=this._getBounds(o||m,l),A=I.rect||I,P=this._style,C=I.nonscaling||P.hasStroke()&&!P.getStrokeScaling();if(v){p||(this._bounds=p={});var y=p[v]={rect:A.clone(),nonscaling:C,internal:d}}return{rect:A,nonscaling:C}},_getStrokeMatrix:function(o,l){var c=this.getStrokeScaling()?null:l&&l.internal?this:this._parent||this._symbol&&this._symbol._item,d=c?c.getViewMatrix().invert():o;return d&&d._shiftless()},statics:{_updateBoundsCache:function(o,l){if(o&&l){var c=l._id,d=o._boundsCache=o._boundsCache||{ids:{},list:[]};d.ids[c]||(d.list.push(l),d.ids[c]=l)}},_clearBoundsCache:function(o){var l=o._boundsCache;if(l){o._bounds=o._position=o._boundsCache=n;for(var c=0,d=l.list,f=d.length;c<f;c++){var m=d[c];m!==o&&(m._bounds=m._position=n,m._boundsCache&&te._clearBoundsCache(m))}}},_getBounds:function(o,l,c){var d=1/0,f=-d,m=d,v=f,p=!1;c=c||{};for(var y=0,I=o.length;y<I;y++){var A=o[y];if(A._visible&&!A.isEmpty(!0)){var P=A._getCachedBounds(l&&l.appended(A._matrix),c,!0),C=P.rect;d=Math.min(C.x,d),m=Math.min(C.y,m),f=Math.max(C.x+C.width,f),v=Math.max(C.y+C.height,v),P.nonscaling&&(p=!0)}}return{rect:isFinite(d)?new V(d,m,f-d,v-m):new V,nonscaling:p}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var o=this._decompose();return o?o.rotation:0},setRotation:function(o){var l=this.getRotation();if(l!=null&&o!=null){var c=this._decomposed;this.rotate(o-l),c&&(c.rotation=o,this._decomposed=c)}},getScaling:function(){var o=this._decompose(),l=o&&o.scaling;return new z(l?l.x:1,l?l.y:1,this,"setScaling")},setScaling:function(){var o=this.getScaling(),l=E.read(arguments,0,{clone:!0,readNull:!0});if(o&&l&&!o.equals(l)){var c=this.getRotation(),d=this._decomposed,f=new U,m=w.isZero;if(m(o.x)||m(o.y))f.translate(d.translation),c&&f.rotate(c),f.scale(l.x,l.y),this._matrix.set(f);else{var v=this.getPosition(!0);f.translate(v),c&&f.rotate(c),f.scale(l.x/o.x,l.y/o.y),c&&f.rotate(-c),f.translate(v.negate()),this.transform(f)}d&&(d.scaling=l,this._decomposed=d)}},getMatrix:function(){return this._matrix},setMatrix:function(){var o=this._matrix;o.set.apply(o,arguments)},getGlobalMatrix:function(o){var l=this._globalMatrix;if(l)for(var c=this._parent,d=[];c;){if(!c._globalMatrix){l=null;for(var f=0,m=d.length;f<m;f++)d[f]._globalMatrix=null;break}d.push(c),c=c._parent}if(!l){l=this._globalMatrix=this._matrix.clone();var c=this._parent;c&&l.prepend(c.getGlobalMatrix(!0))}return o?l:l.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(o){(this._applyMatrix=this._canApplyMatrix&&!!o)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(o,l){if(this._project!==o){this._project&&this._installEvents(!1),this._project=o;for(var c=this._children,d=0,f=c&&c.length;d<f;d++)c[d]._setProject(o);l=!0}l&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function o(l){o.base.call(this,l);for(var c=this._children,d=0,f=c&&c.length;d<f;d++)c[d]._installEvents(l)},getLayer:function(){for(var o=this;o=o._parent;)if(o instanceof ce)return o;return null},getParent:function(){return this._parent},setParent:function(o){return o.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(o){this.removeChildren(),this.addChildren(o)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var o=this._getOwner();return o&&o._children[this._index+1]||null},getPreviousSibling:function(){var o=this._getOwner();return o&&o._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(o){return o===this||o&&this._class===o._class&&this._style.equals(o._style)&&this._matrix.equals(o._matrix)&&this._locked===o._locked&&this._visible===o._visible&&this._blendMode===o._blendMode&&this._opacity===o._opacity&&this._clipMask===o._clipMask&&this._guide===o._guide&&this._equals(o)||!1},_equals:function(o){return s.equals(this._children,o._children)},clone:function(o){var l=new this.constructor(te.NO_INSERT),c=this._children,d=s.pick(o?o.insert:n,o===n||o===!0),f=s.pick(o?o.deep:n,!0);c&&l.copyAttributes(this),(!c||f)&&l.copyContent(this),c||l.copyAttributes(this),d&&l.insertAbove(this);var m=this._name,v=this._parent;if(m&&v){for(var c=v._children,p=m,y=1;c[m];)m=p+" "+y++;m!==p&&l.setName(m)}return l},copyContent:function(o){for(var l=o._children,c=0,d=l&&l.length;c<d;c++)this.addChild(l[c].clone(!1),!0)},copyAttributes:function(o,l){this.setStyle(o._style);for(var c=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],d=0,f=c.length;d<f;d++){var m=c[d];o.hasOwnProperty(m)&&(this[m]=o[m])}l||this._matrix.set(o._matrix,!0),this.setApplyMatrix(o._applyMatrix),this.setPivot(o._pivot),this.setSelection(o._selection);var v=o._data,p=o._name;this._data=v?s.clone(v):null,p&&this.setName(p)},rasterize:function(o,l){var c,d,f;s.isPlainObject(o)?(c=o.resolution,d=o.insert,f=o.raster):(c=o,d=l),f||(f=new me(te.NO_INSERT));var m=this.getStrokeBounds(),v=(c||this.getView().getResolution())/72,p=m.getTopLeft().floor(),y=m.getBottomRight().ceil(),I=new j(y.subtract(p)),A=I.multiply(v);if(f.setSize(A,!0),!A.isZero()){var P=f.getContext(!0),C=new U().scale(v).translate(p.negate());P.save(),C.applyToContext(P),this.draw(P,new s({matrices:[C]})),P.restore()}return f._matrix.set(new U().translate(p.add(I.divide(2))).scale(1/v)),(d===n||d)&&f.insertAbove(this),f},contains:function(){var o=this._matrix;return o.isInvertible()&&!!this._contains(o._inverseTransform(E.read(arguments)))},_contains:function(o){var l=this._children;if(l){for(var c=l.length-1;c>=0;c--)if(l[c].contains(o))return!0;return!1}return o.isInside(this.getInternalBounds())},isInside:function(){return V.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Te.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(o,l){return o instanceof te?this._asPathItem().getIntersections(o._asPathItem(),null,l,!0).length>0:!1}},new function(){function o(){var d=arguments;return this._hitTest(E.read(d),xe.getOptions(d))}function l(){var d=arguments,f=E.read(d),m=xe.getOptions(d),v=[];return this._hitTest(f,new s({all:v},m)),v}function c(d,f,m,v){var p=this._children;if(p)for(var y=p.length-1;y>=0;y--){var I=p[y],A=I!==v&&I._hitTest(d,f,m);if(A&&!f.all)return A}return null}return ne.inject({hitTest:o,hitTestAll:l,_hitTest:c}),{hitTest:o,hitTestAll:l,_hitTestChildren:c}},{_hitTest:function(o,l,c){if(this._locked||!this._visible||this._guide&&!l.guides||this.isEmpty())return null;var d=this._matrix,f=c?c.appended(d):this.getGlobalMatrix().prepend(this.getView()._matrix),m=Math.max(l.tolerance,1e-12),v=l._tolerancePadding=new j(Te._getStrokePadding(m,d._shiftless().invert()));if(o=d._inverseTransform(o),!o||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(v.multiply(2))._containsPoint(o))return null;var p=!(l.guides&&!this._guide||l.selected&&!this.isSelected()||l.type&&l.type!==s.hyphenate(this._class)||l.class&&!(this instanceof l.class)),y=l.match,I=this,A,P;function C(x){return x&&y&&!y(x)&&(x=null),x&&l.all&&l.all.push(x),x}function S(x,b){var M=b?A["get"+b]():I.getPosition();if(o.subtract(M).divide(v).length<=1)return new xe(x,I,{name:b?s.hyphenate(b):x,point:M})}var k=l.position,O=l.center,F=l.bounds;if(p&&this._parent&&(k||O||F)){if((O||F)&&(A=this.getInternalBounds()),P=k&&S("position")||O&&S("center","Center"),!P&&F)for(var N=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],D=0;D<8&&!P;D++)P=S("bounds",N[D]);P=C(P)}return P||(P=this._hitTestChildren(o,l,f)||p&&C(this._hitTestSelf(o,l,f,this.getStrokeScaling()?null:f._shiftless().invert()))||null),P&&P.point&&(P.point=d.transform(P.point)),P},_hitTestSelf:function(o,l){if(l.fill&&this.hasFill()&&this._contains(o))return new xe("fill",this)},matches:function(o,l){function c(v,p){for(var y in v)if(v.hasOwnProperty(y)){var I=v[y],A=p[y];if(s.isPlainObject(I)&&s.isPlainObject(A)){if(!c(I,A))return!1}else if(!s.equals(I,A))return!1}return!0}var d=typeof o;if(d==="object"){for(var f in o)if(o.hasOwnProperty(f)&&!this.matches(f,o[f]))return!1;return!0}else{if(d==="function")return o(this);if(o==="match")return l(this);var m=/^(empty|editable)$/.test(o)?this["is"+s.capitalize(o)]():o==="type"?s.hyphenate(this._class):this[o];if(o==="class"){if(typeof l=="function")return this instanceof l;m=this._class}if(typeof l=="function")return!!l(m);if(l){if(l.test)return l.test(m);if(s.isPlainObject(l))return c(l,m)}return s.equals(m,l)}},getItems:function(o){return te._getItems(this,o,this._matrix)},getItem:function(o){return te._getItems(this,o,this._matrix,null,!0)[0]||null},statics:{_getItems:function o(l,c,d,f,m){if(!f){var v=typeof c=="object"&&c,p=v&&v.overlapping,y=v&&v.inside,I=p||y,C=I&&V.read([I]);f={items:[],recursive:v&&v.recursive!==!1,inside:!!y,overlapping:!!p,rect:C,path:p&&new Te.Rectangle({rectangle:C,insert:!1})},v&&(c=s.filter({},c,{recursive:!0,inside:!0,overlapping:!0}))}var A=l._children,P=f.items,C=f.rect;d=C&&(d||new U);for(var S=0,k=A&&A.length;S<k;S++){var O=A[S],F=d&&d.appended(O._matrix),N=!0;if(C){var I=O.getBounds(F);if(!C.intersects(I))continue;C.contains(I)||f.overlapping&&(I.contains(C)||f.path.intersects(O,F))||(N=!1)}if(N&&O.matches(c)&&(P.push(O),m)||(f.recursive!==!1&&o(O,c,F,f,m),m&&P.length>0))break}return P}}},{importJSON:function(o){var l=s.importJSON(o,this);return l!==this?this.addChild(l):l},addChild:function(o){return this.insertChild(n,o)},insertChild:function(o,l){var c=l?this.insertChildren(o,[l]):null;return c&&c[0]},addChildren:function(o){return this.insertChildren(this._children.length,o)},insertChildren:function(o,l){var c=this._children;if(c&&l&&l.length>0){l=s.slice(l);for(var d={},f=l.length-1;f>=0;f--){var m=l[f],v=m&&m._id;!m||d[v]?l.splice(f,1):(m._remove(!1,!0),d[v]=!0)}s.splice(c,l,o,0);for(var p=this._project,y=p._changes,f=0,I=l.length;f<I;f++){var m=l[f],A=m._name;m._parent=this,m._setProject(p,!0),A&&m.setName(A),y&&m._changed(5)}this._changed(11)}else l=null;return l},_insertItem:"#insertChild",_insertAt:function(o,l){var c=o&&o._getOwner(),d=o!==this&&c?this:null;return d&&(d._remove(!1,!0),c._insertItem(o._index+l,d)),d},insertAbove:function(o){return this._insertAt(o,1)},insertBelow:function(o){return this._insertAt(o,0)},sendToBack:function(){var o=this._getOwner();return o?o._insertItem(0,this):null},bringToFront:function(){var o=this._getOwner();return o?o._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(o){return this.insertChild(0,o)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(o){return o._insertItem(n,this)},copyTo:function(o){return this.clone(!1).addTo(o)},reduce:function(o){var l=this._children;if(l&&l.length===1){var c=l[0].reduce(o);return this._parent?(c.insertAbove(this),this.remove()):c.remove(),c}return this},_removeNamed:function(){var o=this._getOwner();if(o){var l=o._children,c=o._namedChildren,d=this._name,f=c[d],m=f?f.indexOf(this):-1;m!==-1&&(l[d]==this&&delete l[d],f.splice(m,1),f.length?l[d]=f[0]:delete c[d])}},_remove:function(o,l){var c=this._getOwner(),d=this._project,f=this._index;return this._style&&this._style._dispose(),c?(this._name&&this._removeNamed(),f!=null&&(d._activeLayer===this&&(d._activeLayer=this.getNextSibling()||this.getPreviousSibling()),s.splice(c._children,null,f,1)),this._installEvents(!1),o&&d._changes&&this._changed(5),l&&c._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(o){var l=o&&o.insertBelow(this);return l&&this.remove(),l},removeChildren:function(o,l){if(!this._children)return null;o=o||0,l=s.pick(l,this._children.length);for(var c=s.splice(this._children,null,o,l-o),d=c.length-1;d>=0;d--)c[d]._remove(!0,!1);return c.length>0&&this._changed(11),c},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var o=0,l=this._children.length;o<l;o++)this._children[o]._index=o;this._changed(11)}},isEmpty:function(o){var l=this._children,c=l?l.length:0;if(o){for(var d=0;d<c;d++)if(!l[d].isEmpty(o))return!1;return!0}return!c},isEditable:function(){for(var o=this;o;){if(!o._visible||o._locked)return!1;o=o._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(o){function l(v){var p=[];do p.unshift(v);while(v=v._parent);return p}for(var c=l(this),d=l(o),f=0,m=Math.min(c.length,d.length);f<m;f++)if(c[f]!=d[f])return c[f]._index<d[f]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(o){return this._getOrder(o)===-1},isBelow:function(o){return this._getOrder(o)===1},isParent:function(o){return this._parent===o},isChild:function(o){return o&&o._parent===this},isDescendant:function(o){for(var l=this;l=l._parent;)if(l===o)return!0;return!1},isAncestor:function(o){return o?o.isDescendant(this):!1},isSibling:function(o){return this._parent===o._parent},isGroupedWith:function(o){for(var l=this._parent;l;){if(l._parent&&/^(Group|Layer|CompoundPath)$/.test(l._class)&&o.isDescendant(l))return!0;l=l._parent}return!1}},s.each(["rotate","scale","shear","skew"],function(o){var l=o==="rotate";this[o]=function(){var c=arguments,d=(l?s:E).read(c),f=E.read(c,0,{readNull:!0});return this.transform(new U()[o](d,f||this.getPosition(!0)))}},{translate:function(){var o=new U;return this.transform(o.translate.apply(o,arguments))},transform:function(o,l,c){var d=this._matrix,f=o&&!o.isIdentity(),m=c&&this._canApplyMatrix||this._applyMatrix&&(f||!d.isIdentity()||l&&this._children);if(!f&&!m)return this;if(f){!o.isInvertible()&&d.isInvertible()&&(d._backup=d.getValues()),d.prepend(o,!0);var v=this._style,p=v.getFillColor(!0),y=v.getStrokeColor(!0);p&&p.transform(o),y&&y.transform(o)}if(m&&(m=this._transformContent(d,l,c))){var I=this._pivot;I&&d._transformPoint(I,I,!0),d.reset(!0),c&&this._canApplyMatrix&&(this._applyMatrix=!0)}var A=this._bounds,P=this._position;(f||m)&&this._changed(25);var C=f&&A&&o.decompose();if(C&&C.skewing.isZero()&&C.rotation%90===0){for(var S in A){var k=A[S];if(k.nonscaling)delete A[S];else if(m||!k.internal){var O=k.rect;o._transformBounds(O,O)}}this._bounds=A;var F=A[this._getBoundsCacheKey(this._boundsOptions||{})];F&&(this._position=this._getPositionFromBounds(F.rect))}else f&&P&&this._pivot&&(this._position=o._transformPoint(P,P));return this},_transformContent:function(o,l,c){var d=this._children;if(d){for(var f=0,m=d.length;f<m;f++)d[f].transform(o,l,c);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(E.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(E.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(E.read(arguments))},localToParent:function(){return this._matrix._transformPoint(E.read(arguments))},fitBounds:function(o,l){o=V.read(arguments);var c=this.getBounds(),d=c.height/c.width,f=o.height/o.width,m=(l?d>f:d<f)?o.width/c.width:o.height/c.height,v=new V(new E,new j(c.width*m,c.height*m));v.setCenter(o.getCenter()),this.setBounds(v)}}),{_setStyles:function(o,l,c){var d=this._style,f=this._matrix;if(d.hasFill()&&(o.fillStyle=d.getFillColor().toCanvasStyle(o,f)),d.hasStroke()){o.strokeStyle=d.getStrokeColor().toCanvasStyle(o,f),o.lineWidth=d.getStrokeWidth();var m=d.getStrokeJoin(),v=d.getStrokeCap(),p=d.getMiterLimit();if(m&&(o.lineJoin=m),v&&(o.lineCap=v),p&&(o.miterLimit=p),de.support.nativeDash){var y=d.getDashArray(),I=d.getDashOffset();y&&y.length&&("setLineDash"in o?(o.setLineDash(y),o.lineDashOffset=I):(o.mozDash=y,o.mozDashOffset=I))}}if(d.hasShadow()){var A=l.pixelRatio||1,P=c._shiftless().prepend(new U().scale(A,A)),C=P.transform(new E(d.getShadowBlur(),0)),S=P.transform(this.getShadowOffset());o.shadowColor=d.getShadowColor().toCanvasStyle(o),o.shadowBlur=C.getLength(),o.shadowOffsetX=S.x,o.shadowOffsetY=S.y}},draw:function(o,l,c){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var d=l.matrices,f=l.viewMatrix,m=this._matrix,v=d[d.length-1].appended(m);if(v.isInvertible()){f=f?f.appended(v):v,d.push(v),l.updateMatrix&&(this._globalMatrix=v);var p=this._blendMode,y=w.clamp(this._opacity,0,1),I=p==="normal",A=ge.nativeModes[p],P=I&&y===1||l.dontStart||l.clip||(A||I&&y<1)&&this._canComposite(),C=l.pixelRatio||1,S,k,O;if(!P){var F=this.getStrokeBounds(f);if(!F.width||!F.height){d.pop();return}O=l.offset,k=l.offset=F.getTopLeft().floor(),S=o,o=ie.getContext(F.getSize().ceil().add(1).multiply(C)),C!==1&&o.scale(C,C)}o.save();var N=c?c.appended(m):this._canScaleStroke&&!this.getStrokeScaling(!0)&&f,D=!P&&l.clipItem,x=!N||D;if(P?(o.globalAlpha=y,A&&(o.globalCompositeOperation=p)):x&&o.translate(-k.x,-k.y),x&&(P?m:f).applyToContext(o),D&&l.clipItem.draw(o,l.extend({clip:!0})),N){o.setTransform(C,0,0,C,0,0);var b=l.offset;b&&o.translate(-b.x,-b.y)}this._draw(o,l,f,N),o.restore(),d.pop(),l.clip&&!l.dontFinish&&o.clip(this.getFillRule()),P||(ge.process(p,o,S,y,k.subtract(O).multiply(C)),ie.release(o),l.offset=O)}}},_isUpdated:function(o){var l=this._parent;if(l instanceof De)return l._isUpdated(o);var c=this._updateVersion===o;return!c&&l&&l._visible&&l._isUpdated(o)&&(this._updateVersion=o,c=!0),c},_drawSelection:function(o,l,c,d,f){var m=this._selection,v=m&1,p=m&2||v&&this._selectBounds,y=m&4;if(this._drawSelected||(v=!1),(v||p||y)&&this._isUpdated(f)){var I,A=this.getSelectedColor(!0)||(I=this.getLayer())&&I.getSelectedColor(!0),P=l.appended(this.getGlobalMatrix(!0)),C=c/2;if(o.strokeStyle=o.fillStyle=A?A.toCanvasStyle(o):"#009dec",v&&this._drawSelected(o,P,d),y){var S=this.getPosition(!0),k=this._parent,O=k?k.localToGlobal(S):S,F=O.x,N=O.y;o.beginPath(),o.arc(F,N,C,0,Math.PI*2,!0),o.stroke();for(var D=[[0,-1],[1,0],[0,1],[-1,0]],x=C,b=c+1,M=0;M<4;M++){var L=D[M],$=L[0],H=L[1];o.moveTo(F+$*x,N+H*x),o.lineTo(F+$*b,N+H*b),o.stroke()}}if(p){var q=P._transformCorners(this.getInternalBounds());o.beginPath();for(var M=0;M<8;M++)o[M?"lineTo":"moveTo"](q[M],q[++M]);o.closePath(),o.stroke();for(var M=0;M<8;M++)o.fillRect(q[M]-C,q[++M]-C,c,c)}}},_canComposite:function(){return!1}},s.each(["down","drag","up","move"],function(o){this["removeOn"+s.capitalize(o)]=function(){var l={};return l[o]=!0,this.removeOn(l)}},{removeOn:function(o){for(var l in o)if(o[l]){var c="mouse"+l,d=this._project,f=d._removeSets=d._removeSets||{};f[c]=f[c]||{},f[c][this._id]=this}return this}}),{tween:function(o,l,c){c||(c=l,l=o,o=null,c||(c=l,l=null));var d=c&&c.easing,f=c&&c.start,m=c!=null&&(typeof c=="number"?c:c.duration),v=new id(this,o,l,m,d,f);function p(y){v._handleFrame(y.time*1e3),v.running||this.off("frame",p)}return m&&this.on("frame",p),v},tweenTo:function(o,l){return this.tween(null,o,l)},tweenFrom:function(o,l){return this.tween(o,null,l)}}),ae=te.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(l){this._children=[],this._namedChildren={},this._initialize(l)||this.addChildren(Array.isArray(l)?l:arguments)},_changed:function o(l){o.base.call(this,l),l&2050&&(this._clipItem=n)},_getClipItem:function(){var o=this._clipItem;if(o===n){o=null;for(var l=this._children,c=0,d=l.length;c<d;c++)if(l[c]._clipMask){o=l[c];break}this._clipItem=o}return o},isClipped:function(){return!!this._getClipItem()},setClipped:function(o){var l=this.getFirstChild();l&&l.setClipMask(o)},_getBounds:function o(l,c){var d=this._getClipItem();return d?d._getCachedBounds(d._matrix.prepended(l),s.set({},c,{stroke:!1})):o.base.call(this,l,c)},_hitTestChildren:function o(l,c,d){var f=this._getClipItem();return(!f||f.contains(l))&&o.base.call(this,l,c,d,f)},_draw:function(o,l){var c=l.clip,d=!c&&this._getClipItem();l=l.extend({clipItem:d,clip:!1}),c?(o.beginPath(),l.dontStart=l.dontFinish=!0):d&&d.draw(o,l.extend({clip:!0}));for(var f=this._children,m=0,v=f.length;m<v;m++){var p=f[m];p!==d&&p.draw(o,l)}}}),ce=ae.extend({_class:"Layer",initialize:function(){ae.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function o(){return this._parent?o.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),_e=te.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(l,c){this._initialize(l,c)},_equals:function(o){return this._type===o._type&&this._size.equals(o._size)&&s.equals(this._radius,o._radius)},copyContent:function(o){this.setType(o._type),this.setSize(o._size),this.setRadius(o._radius)},getType:function(){return this._type},setType:function(o){this._type=o},getShape:"#getType",setShape:"#setType",getSize:function(){var o=this._size;return new J(o.width,o.height,this,"setSize")},setSize:function(){var o=j.read(arguments);if(!this._size)this._size=o.clone();else if(!this._size.equals(o)){var l=this._type,c=o.width,d=o.height;l==="rectangle"?this._radius.set(j.min(this._radius,o.divide(2).abs())):l==="circle"?(c=d=(c+d)/2,this._radius=c/2):l==="ellipse"&&this._radius._set(c/2,d/2),this._size._set(c,d),this._changed(9)}},getRadius:function(){var o=this._radius;return this._type==="circle"?o:new J(o.width,o.height,this,"setRadius")},setRadius:function(o){var l=this._type;if(l==="circle"){if(o===this._radius)return;var c=o*2;this._radius=o,this._size._set(c,c)}else if(o=j.read(arguments),!this._radius)this._radius=o.clone();else{if(this._radius.equals(o))return;if(this._radius.set(o),l==="rectangle"){var c=j.max(this._size,o.multiply(2));this._size.set(c)}else l==="ellipse"&&this._size._set(o.width*2,o.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(o){var l=new Te[s.capitalize(this._type)]({center:new E,size:this._size,radius:this._radius,insert:!1});return l.copyAttributes(this),de.settings.applyMatrix&&l.setApplyMatrix(!0),(o===n||o)&&l.insertAbove(this),l},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(o,l,c,d){var f=this._style,m=f.hasFill(),v=f.hasStroke(),p=l.dontFinish||l.clip,y=!d;if(m||v||p){var I=this._type,A=this._radius,P=I==="circle";if(l.dontStart||o.beginPath(),y&&P)o.arc(0,0,A,0,Math.PI*2,!0);else{var C=P?A:A.width,S=P?A:A.height,k=this._size,O=k.width,F=k.height;if(y&&I==="rectangle"&&C===0&&S===0)o.rect(-O/2,-F/2,O,F);else{var N=O/2,D=F/2,x=1-.5522847498307936,b=C*x,M=S*x,L=[-N,-D+S,-N,-D+M,-N+b,-D,-N+C,-D,N-C,-D,N-b,-D,N,-D+M,N,-D+S,N,D-S,N,D-M,N-b,D,N-C,D,-N+C,D,-N+b,D,-N,D-M,-N,D-S];d&&d.transform(L,L,32),o.moveTo(L[0],L[1]),o.bezierCurveTo(L[2],L[3],L[4],L[5],L[6],L[7]),N!==C&&o.lineTo(L[8],L[9]),o.bezierCurveTo(L[10],L[11],L[12],L[13],L[14],L[15]),D!==S&&o.lineTo(L[16],L[17]),o.bezierCurveTo(L[18],L[19],L[20],L[21],L[22],L[23]),N!==C&&o.lineTo(L[24],L[25]),o.bezierCurveTo(L[26],L[27],L[28],L[29],L[30],L[31])}}o.closePath()}!p&&(m||v)&&(this._setStyles(o,l,c),m&&(o.fill(f.getFillRule()),o.shadowColor="rgba(0,0,0,0)"),v&&o.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(o,l){var c=new V(this._size).setCenter(0,0),d=this._style,f=l.stroke&&d.hasStroke()&&d.getStrokeWidth();return o&&(c=o._transformBounds(c)),f?c.expand(Te._getStrokePadding(f,this._getStrokeMatrix(o,l))):c}},new function(){function o(c,d,f){var m=c._radius;if(!m.isZero())for(var v=c._size.divide(2),p=1;p<=4;p++){var y=new E(p>1&&p<4?-1:1,p>2?-1:1),I=y.multiply(v),A=I.subtract(y.multiply(m)),P=new V(f?I.add(y.multiply(f)):I,A);if(P.contains(d))return{point:A,quadrant:p}}}function l(c,d,f,m){var v=c.divide(d);return(!m||v.isInQuadrant(m))&&v.subtract(v.normalize()).multiply(d).divide(f).length<=1}return{_contains:function c(d){if(this._type==="rectangle"){var f=o(this,d);return f?d.subtract(f.point).divide(this._radius).getLength()<=1:c.base.call(this,d)}else return d.divide(this.size).getLength()<=.5},_hitTestSelf:function c(d,f,m,v){var p=!1,y=this._style,I=f.stroke&&y.hasStroke(),A=f.fill&&y.hasFill();if(I||A){var P=this._type,C=this._radius,S=I?y.getStrokeWidth()/2:0,k=f._tolerancePadding.add(Te._getStrokePadding(S,!y.getStrokeScaling()&&v));if(P==="rectangle"){var O=k.multiply(2),F=o(this,d,O);if(F)p=l(d.subtract(F.point),C,k,F.quadrant);else{var N=new V(this._size).setCenter(0,0),D=N.expand(O),x=N.expand(O.negate());p=D._containsPoint(d)&&!x._containsPoint(d)}}else p=l(d,C,k)}return p?new xe(I?"stroke":"fill",this):c.base.apply(this,arguments)}}},{statics:new function(){function o(l,c,d,f,m){var v=s.create(_e.prototype);return v._type=l,v._size=d,v._radius=f,v._initialize(s.getNamed(m),c),v}return{Circle:function(){var l=arguments,c=E.readNamed(l,"center"),d=s.readNamed(l,"radius");return o("circle",c,new j(d*2),d,l)},Rectangle:function(){var l=arguments,c=V.readNamed(l,"rectangle"),d=j.min(j.readNamed(l,"radius"),c.getSize(!0).divide(2));return o("rectangle",c.getCenter(!0),c.getSize(!0),d,l)},Ellipse:function(){var l=arguments,c=_e._readEllipse(l),d=c.radius;return o("ellipse",c.center,d.multiply(2),d,l)},_readEllipse:function(l){var c,d;if(s.hasNamed(l,"radius"))c=E.readNamed(l,"center"),d=j.readNamed(l,"radius");else{var f=V.readNamed(l,"rectangle");c=f.getCenter(!0),d=f.getSize(!0).divide(2)}return{center:c,radius:d}}}}}),me=te.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(l,c){if(!this._initialize(l,c!==n&&E.read(arguments))){var d,f=typeof l,m=f==="string"?i.getElementById(l):f==="object"?l:null;if(m&&m!==te.NO_INSERT){if(m.getContext||m.naturalHeight!=null)d=m;else if(m){var v=j.read(arguments);v.isZero()||(d=ie.getCanvas(v))}}d?this.setImage(d):this.setSource(l)}this._size||(this._size=new j,this._loaded=!1)},_equals:function(o){return this.getSource()===o.getSource()},copyContent:function(o){var l=o._image,c=o._canvas;if(l)this._setImage(l);else if(c){var d=ie.getCanvas(o._size);d.getContext("2d").drawImage(c,0,0),this._setImage(d)}this._crossOrigin=o._crossOrigin},getSize:function(){var o=this._size;return new J(o?o.width:0,o?o.height:0,this,"setSize")},setSize:function(o,l){var c=j.read(arguments);if(c.equals(this._size))l&&this.clear();else if(c.width>0&&c.height>0){var d=!l&&this.getElement();this._setImage(ie.getCanvas(c)),d&&this.getContext(!0).drawImage(d,0,0,c.width,c.height)}else this._canvas&&ie.release(this._canvas),this._size=c.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(o){this.setSize(o,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(o){this.setSize(this.getWidth(),o)},getLoaded:function(){return this._loaded},isEmpty:function(){var o=this._size;return!o||o.width===0&&o.height===0},getResolution:function(){var o=this._matrix,l=new E(0,0).transform(o),c=new E(1,0).transform(o).subtract(l),d=new E(0,1).transform(o).subtract(l);return new j(72/c.getLength(),72/d.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(o){var l=this;function c(d){var f=l.getView(),m=d&&d.type||"load";f&&l.responds(m)&&(de=f._scope,l.emit(m,new Zn(d)))}this._setImage(o),this._loaded?setTimeout(c,0):o&&Bt.add(o,{load:function(d){l._setImage(o),c(d)},error:c})},_setImage:function(o){this._canvas&&ie.release(this._canvas),o&&o.getContext?(this._image=null,this._canvas=o,this._loaded=!0):(this._image=o,this._canvas=null,this._loaded=!!(o&&o.src&&o.complete)),this._size=new j(o?o.naturalWidth||o.width:0,o?o.naturalHeight||o.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var o=ie.getContext(this._size);try{this._image&&o.drawImage(this._image,0,0),this._canvas=o.canvas}catch{ie.release(o)}}return this._canvas},setCanvas:"#setImage",getContext:function(o){return this._context||(this._context=this.getCanvas().getContext("2d")),o&&(this._image=null,this._changed(1025)),this._context},setContext:function(o){this._context=o},getSource:function(){var o=this._image;return o&&o.src||this.toDataURL()},setSource:function(o){var l=new e.Image,c=this._crossOrigin;c&&(l.crossOrigin=c),o&&(l.src=o),this.setImage(l)},getCrossOrigin:function(){var o=this._image;return o&&o.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(o){this._crossOrigin=o;var l=this._image;l&&(l.crossOrigin=o)},getSmoothing:function(){return this._smoothing},setSmoothing:function(o){this._smoothing=typeof o=="string"?o:o?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var o=V.read(arguments),l=ie.getContext(o.getSize());return l.drawImage(this.getCanvas(),o.x,o.y,o.width,o.height,0,0,o.width,o.height),l.canvas},getSubRaster:function(){var o=V.read(arguments),l=new me(te.NO_INSERT);return l._setImage(this.getSubCanvas(o)),l.translate(o.getCenter().subtract(this.getSize().divide(2))),l._matrix.prepend(this._matrix),l.insertAbove(this),l},toDataURL:function(){var o=this._image,l=o&&o.src;if(/^data:/.test(l))return l;var c=this.getCanvas();return c?c.toDataURL.apply(c,arguments):null},drawImage:function(o){var l=E.read(arguments,1);this.getContext(!0).drawImage(o,l.x,l.y)},getAverageColor:function(o){var l,c;if(o?o instanceof Ce?(c=o,l=o.getBounds()):typeof o=="object"&&("width"in o?l=new V(o):"x"in o&&(l=new V(o.x-.5,o.y-.5,1,1))):l=this.getBounds(),!l)return null;var d=32,f=Math.min(l.width,d),m=Math.min(l.height,d),v=me._sampleContext;v?v.clearRect(0,0,d+1,d+1):v=me._sampleContext=ie.getContext(new j(d)),v.save();var p=new U().scale(f/l.width,m/l.height).translate(-l.x,-l.y);p.applyToContext(v),c&&c.draw(v,new s({clip:!0,matrices:[p]})),this._matrix.applyToContext(v);var y=this.getElement(),I=this._size;y&&v.drawImage(y,-I.width/2,-I.height/2),v.restore();for(var A=v.getImageData(.5,.5,Math.ceil(f),Math.ceil(m)).data,P=[0,0,0],C=0,S=0,k=A.length;S<k;S+=4){var O=A[S+3];C+=O,O/=255,P[0]+=A[S]*O,P[1]+=A[S+1]*O,P[2]+=A[S+2]*O}for(var S=0;S<3;S++)P[S]/=C;return C?Ke.read(P):null},getPixel:function(){var o=E.read(arguments),l=this.getContext().getImageData(o.x,o.y,1,1).data;return new Ke("rgb",[l[0]/255,l[1]/255,l[2]/255],l[3]/255)},setPixel:function(){var o=arguments,l=E.read(o),c=Ke.read(o),d=c._convert("rgb"),f=c._alpha,m=this.getContext(!0),v=m.createImageData(1,1),p=v.data;p[0]=d[0]*255,p[1]=d[1]*255,p[2]=d[2]*255,p[3]=f!=null?f*255:255,m.putImageData(v,l.x,l.y)},clear:function(){var o=this._size;this.getContext(!0).clearRect(0,0,o.width+1,o.height+1)},createImageData:function(){var o=j.read(arguments);return this.getContext().createImageData(o.width,o.height)},getImageData:function(){var o=V.read(arguments);return o.isEmpty()&&(o=new V(this._size)),this.getContext().getImageData(o.x,o.y,o.width,o.height)},putImageData:function(o){var l=E.read(arguments,1);this.getContext(!0).putImageData(o,l.x,l.y)},setImageData:function(o){this.setSize(o),this.getContext(!0).putImageData(o,0,0)},_getBounds:function(o,l){var c=new V(this._size).setCenter(0,0);return o?o._transformBounds(c):c},_hitTestSelf:function(o){if(this._contains(o)){var l=this;return new xe("pixel",l,{offset:o.add(l._size.divide(2)).round(),color:{get:function(){return l.getPixel(this.offset)}}})}},_draw:function(o,l,c){var d=this.getElement();if(d&&d.width>0&&d.height>0){o.globalAlpha=w.clamp(this._opacity,0,1),this._setStyles(o,l,c);var f=this._smoothing,m=f==="off";Ct.setPrefixed(o,m?"imageSmoothingEnabled":"imageSmoothingQuality",m?!1:f),o.drawImage(d,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Ze=te.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(l,c){this._initialize(l,c!==n&&E.read(arguments,1))||this.setDefinition(l instanceof Oe?l:new Oe(l))},_equals:function(o){return this._definition===o._definition},copyContent:function(o){this.setDefinition(o._definition)},getDefinition:function(){return this._definition},setDefinition:function(o){this._definition=o,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(o,l){var c=this._definition._item;return c._getCachedBounds(c._matrix.prepended(o),l)},_hitTestSelf:function(o,l,c){var d=l.extend({all:!1}),f=this._definition._item._hitTest(o,d,c);return f&&(f.item=this),f},_draw:function(o,l){this._definition._item.draw(o,l)}}),Oe=s.extend({_class:"SymbolDefinition",initialize:function(l,c){this._id=T.get(),this.project=de.project,l&&this.setItem(l,c)},_serialize:function(o,l){return l.add(this,function(){return s.serialize([this._class,this._item],o,!1,l)})},_changed:function(o){o&8&&te._clearBoundsCache(this),o&1&&this.project._changed(o)},getItem:function(){return this._item},setItem:function(o,l){o._symbol&&(o=o.clone()),this._item&&(this._item._symbol=null),this._item=o,o.remove(),o.setSelected(!1),l||o.setPosition(new E),o._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(o){return new Ze(this,o)},clone:function(){return new Oe(this._item.clone(!1))},equals:function(o){return o===this||o&&this._item.equals(o._item)||!1}}),xe=s.extend({_class:"HitResult",initialize:function(l,c,d){this.type=l,this.item=c,d&&this.inject(d)},statics:{getOptions:function(o){var l=o&&s.read(o);return new s({type:null,tolerance:de.settings.hitTolerance,fill:!l,stroke:!l,segments:!l,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},l)}}}),we=s.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(l,c,d,f,m,v){var p=arguments.length,y,I,A,P;p>0&&(l==null||typeof l=="object"?p===1&&l&&"point"in l?(y=l.point,I=l.handleIn,A=l.handleOut,P=l.selection):(y=l,I=c,A=d,P=f):(y=[l,c],I=d!==n?[d,f]:null,A=m!==n?[m,v]:null)),new et(y,this,"_point"),new et(I,this,"_handleIn"),new et(A,this,"_handleOut"),P&&this.setSelection(P)},_serialize:function(o,l){var c=this._point,d=this._selection,f=d||this.hasHandles()?[c,this._handleIn,this._handleOut]:c;return d&&f.push(d),s.serialize(f,o,!0,l)},_changed:function(o){var l=this._path;if(l){var c=l._curves,d=this._index,f;c&&((!o||o===this._point||o===this._handleIn)&&(f=d>0?c[d-1]:l._closed?c[c.length-1]:null)&&f._changed(),(!o||o===this._point||o===this._handleOut)&&(f=c[d])&&f._changed()),l._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(E.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(E.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(E.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var o=this._handleIn,l=this._handleOut;return!o.isZero()&&!l.isZero()&&o.isCollinear(l)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(o){var l=this._selection,c=this._path;this._selection=o=o||0,c&&o!==l&&(c._updateSelection(this,l,o),c._changed(257))},_changeSelection:function(o,l){var c=this._selection;this.setSelection(l?c|o:c&~o)},isSelected:function(){return!!(this._selection&7)},setSelected:function(o){this._changeSelection(7,o)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var o=this._path,l=this._index;return o?(l>0&&!o._closed&&l===o._segments.length-1&&l--,o.getCurves()[l]||null):null},getLocation:function(){var o=this.getCurve();return o?new it(o,this===o._segment1?0:1):null},getNext:function(){var o=this._path&&this._path._segments;return o&&(o[this._index+1]||this._path._closed&&o[0])||null},smooth:function(o,l,c){var d=o||{},f=d.type,m=d.factor,v=this.getPrevious(),p=this.getNext(),y=(v||this)._point,I=this._point,A=(p||this)._point,P=y.getDistance(I),C=I.getDistance(A);if(!f||f==="catmull-rom"){var S=m===n?.5:m,k=Math.pow(P,S),O=k*k,F=Math.pow(C,S),N=F*F;if(!l&&v){var D=2*N+3*F*k+O,x=3*F*(F+k);this.setHandleIn(x!==0?new E((N*y._x+D*I._x-O*A._x)/x-I._x,(N*y._y+D*I._y-O*A._y)/x-I._y):new E)}if(!c&&p){var D=2*O+3*k*F+N,x=3*k*(k+F);this.setHandleOut(x!==0?new E((O*A._x+D*I._x-N*y._x)/x-I._x,(O*A._y+D*I._y-N*y._y)/x-I._y):new E)}}else if(f==="geometric"){if(v&&p){var b=y.subtract(A),M=m===n?.4:m,L=M*P/(P+C);l||this.setHandleIn(b.multiply(L)),c||this.setHandleOut(b.multiply(L-M))}}else throw new Error("Smoothing method '"+f+"' not supported.")},getPrevious:function(){var o=this._path&&this._path._segments;return o&&(o[this._index-1]||this._path._closed&&o[o.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var o=this._path;return o&&this._index===o._segments.length-1||!1},reverse:function(){var o=this._handleIn,l=this._handleOut,c=o.clone();o.set(l),l.set(c)},reversed:function(){return new we(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new we(this._point,this._handleIn,this._handleOut)},equals:function(o){return o===this||o&&this._class===o._class&&this._point.equals(o._point)&&this._handleIn.equals(o._handleIn)&&this._handleOut.equals(o._handleOut)||!1},toString:function(){var o=["point: "+this._point];return this._handleIn.isZero()||o.push("handleIn: "+this._handleIn),this._handleOut.isZero()||o.push("handleOut: "+this._handleOut),"{ "+o.join(", ")+" }"},transform:function(o){this._transformCoordinates(o,new Array(6),!0),this._changed()},interpolate:function(o,l,c){var d=1-c,f=c,m=o._point,v=l._point,p=o._handleIn,y=l._handleIn,I=l._handleOut,A=o._handleOut;this._point._set(d*m._x+f*v._x,d*m._y+f*v._y,!0),this._handleIn._set(d*p._x+f*y._x,d*p._y+f*y._y,!0),this._handleOut._set(d*A._x+f*I._x,d*A._y+f*I._y,!0),this._changed()},_transformCoordinates:function(o,l,c){var d=this._point,f=!c||!this._handleIn.isZero()?this._handleIn:null,m=!c||!this._handleOut.isZero()?this._handleOut:null,v=d._x,p=d._y,y=2;return l[0]=v,l[1]=p,f&&(l[y++]=f._x+v,l[y++]=f._y+p),m&&(l[y++]=m._x+v,l[y++]=m._y+p),o&&(o._transformCoordinates(l,l,y/2),v=l[0],p=l[1],c?(d._x=v,d._y=p,y=2,f&&(f._x=l[y++]-v,f._y=l[y++]-p),m&&(m._x=l[y++]-v,m._y=l[y++]-p)):(f||(l[y++]=v,l[y++]=p),m||(l[y++]=v,l[y++]=p))),l}}),et=E.extend({initialize:function(l,c,d){var f,m,v;if(!l)f=m=0;else if((f=l[0])!==n)m=l[1];else{var p=l;(f=p.x)===n&&(p=E.read(arguments),f=p.x),m=p.y,v=p.selected}this._x=f,this._y=m,this._owner=c,c[d]=this,v&&this.setSelected(!0)},_set:function(o,l){return this._x=o,this._y=l,this._owner._changed(this),this},getX:function(){return this._x},setX:function(o){this._x=o,this._owner._changed(this)},getY:function(){return this._y},setY:function(o){this._y=o,this._owner._changed(this)},isZero:function(){var o=w.isZero;return o(this._x)&&o(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(o){this._owner._changeSelection(this._getSelection(),o)},_getSelection:function(){var o=this._owner;return this===o._point?1:this===o._handleIn?2:this===o._handleOut?4:0}}),he=s.extend({_class:"Curve",beans:!0,initialize:function(l,c,d,f,m,v,p,y){var I=arguments.length,A,P,C,S,k,O;I===3?(this._path=l,A=c,P=d):I?I===1?"segment1"in l?(A=new we(l.segment1),P=new we(l.segment2)):"point1"in l?(C=l.point1,k=l.handle1,O=l.handle2,S=l.point2):Array.isArray(l)&&(C=[l[0],l[1]],S=[l[6],l[7]],k=[l[2]-l[0],l[3]-l[1]],O=[l[4]-l[6],l[5]-l[7]]):I===2?(A=new we(l),P=new we(c)):I===4?(C=l,k=c,O=d,S=f):I===8&&(C=[l,c],S=[p,y],k=[d-l,f-c],O=[m-p,v-y]):(A=new we,P=new we),this._segment1=A||new we(C,null,k),this._segment2=P||new we(S,O,null)},_serialize:function(o,l){return s.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],o,!0,l)},_changed:function(){this._length=this._bounds=n},clone:function(){return new he(this._segment1,this._segment2)},toString:function(){var o=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||o.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||o.push("handle2: "+this._segment2._handleIn),o.push("point2: "+this._segment2._point),"{ "+o.join(", ")+" }"},classify:function(){return he.classify(this.getValues())},remove:function(){var o=!1;if(this._path){var l=this._segment2,c=l._handleOut;o=l.remove(),o&&this._segment1._handleOut.set(c)}return o},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(E.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(E.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(E.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(E.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var o=this._path&&this._path._curves;return o&&(o[this._segment1._index+1]||this._path._closed&&o[0])||null},getPrevious:function(){var o=this._path&&this._path._curves;return o&&(o[this._segment1._index-1]||this._path._closed&&o[o.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var o=this._path;return o&&this._segment1._index===o._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(o){this.getPoint1().setSelected(o),this.getHandle1().setSelected(o),this.getHandle2().setSelected(o),this.getPoint2().setSelected(o)},getValues:function(o){return he.getValues(this._segment1,this._segment2,o)},getPoints:function(){for(var o=this.getValues(),l=[],c=0;c<8;c+=2)l.push(new E(o[c],o[c+1]));return l}},{getLength:function(){return this._length==null&&(this._length=he.getLength(this.getValues(),0,1)),this._length},getArea:function(){return he.getArea(this.getValues())},getLine:function(){return new Z(this._segment1._point,this._segment2._point)},getPart:function(o,l){return new he(he.getPart(this.getValues(),o,l))},getPartLength:function(o,l){return he.getLength(this.getValues(),o,l)},divideAt:function(o){return this.divideAtTime(o&&o.curve===this?o.time:this.getTimeAt(o))},divideAtTime:function(o,l){var c=1e-8,d=1-c,f=null;if(o>=c&&o<=d){var m=he.subdivide(this.getValues(),o),v=m[0],p=m[1],y=l||this.hasHandles(),I=this._segment1,A=this._segment2,P=this._path;y&&(I._handleOut._set(v[2]-v[0],v[3]-v[1]),A._handleIn._set(p[4]-p[6],p[5]-p[7]));var C=v[6],S=v[7],k=new we(new E(C,S),y&&new E(v[4]-C,v[5]-S),y&&new E(p[2]-C,p[3]-S));P?(P.insert(I._index+1,k),f=this.getNext()):(this._segment2=k,this._changed(),f=new he(k,A))}return f},splitAt:function(o){var l=this._path;return l?l.splitAt(o):null},splitAtTime:function(o){return this.splitAt(this.getLocationAtTime(o))},divide:function(o,l){return this.divideAtTime(o===n?.5:l?o:this.getTimeAt(o))},split:function(o,l){return this.splitAtTime(o===n?.5:l?o:this.getTimeAt(o))},reversed:function(){return new he(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(o,l,c,d){var f=o._point,m=o._handleOut,v=l._handleIn,p=l._point,y=f.x,I=f.y,A=p.x,P=p.y,C=d?[y,I,y,I,A,P,A,P]:[y,I,y+m._x,I+m._y,A+v._x,P+v._y,A,P];return c&&c._transformCoordinates(C,C,4),C},subdivide:function(o,l){var c=o[0],d=o[1],f=o[2],m=o[3],v=o[4],p=o[5],y=o[6],I=o[7];l===n&&(l=.5);var A=1-l,P=A*c+l*f,C=A*d+l*m,S=A*f+l*v,k=A*m+l*p,O=A*v+l*y,F=A*p+l*I,N=A*P+l*S,D=A*C+l*k,x=A*S+l*O,b=A*k+l*F,M=A*N+l*x,L=A*D+l*b;return[[c,d,P,C,N,D,M,L],[M,L,x,b,O,F,y,I]]},getMonoCurves:function(o,l){var c=[],d=l?0:1,f=o[d+0],m=o[d+2],v=o[d+4],p=o[d+6];if(f>=m==m>=v&&m>=v==v>=p||he.isStraight(o))c.push(o);else{var y=3*(m-v)-f+p,I=2*(f+v)-4*m,A=m-f,P=1e-8,C=1-P,S=[],k=w.solveQuadratic(y,I,A,S,P,C);if(!k)c.push(o);else{S.sort();var O=S[0],F=he.subdivide(o,O);c.push(F[0]),k>1&&(O=(S[1]-O)/(1-O),F=he.subdivide(F[1],O),c.push(F[0])),c.push(F[1])}}return c},solveCubic:function(o,l,c,d,f,m){var v=o[l],p=o[l+2],y=o[l+4],I=o[l+6],A=0;if(!(v<c&&I<c&&p<c&&y<c||v>c&&I>c&&p>c&&y>c)){var P=3*(p-v),C=3*(y-p)-P,S=I-v-P-C;A=w.solveCubic(S,C,P,v-c,d,f,m)}return A},getTimeOf:function(o,l){var c=new E(o[0],o[1]),d=new E(o[6],o[7]),f=1e-12,m=1e-7,v=l.isClose(c,f)?0:l.isClose(d,f)?1:null;if(v===null)for(var p=[l.x,l.y],y=[],I=0;I<2;I++)for(var A=he.solveCubic(o,I,p[I],y,0,1),P=0;P<A;P++){var C=y[P];if(l.isClose(he.getPoint(o,C),m))return C}return l.isClose(c,m)?0:l.isClose(d,m)?1:null},getNearestTime:function(o,l){if(he.isStraight(o)){var c=o[0],d=o[1],f=o[6],m=o[7],v=f-c,p=m-d,y=v*v+p*p;if(y===0)return 0;var I=((l.x-c)*v+(l.y-d)*p)/y;return I<1e-12?0:I>.999999999999?1:he.getTimeOf(o,new E(c+I*v,d+I*p))}var A=100,P=1/0,C=0;function S(F){if(F>=0&&F<=1){var N=l.getDistance(he.getPoint(o,F),!0);if(N<P)return P=N,C=F,!0}}for(var k=0;k<=A;k++)S(k/A);for(var O=1/(A*2);O>1e-8;)!S(C-O)&&!S(C+O)&&(O/=2);return C},getPart:function(o,l,c){var d=l>c;if(d){var f=l;l=c,c=f}return l>0&&(o=he.subdivide(o,l)[1]),c<1&&(o=he.subdivide(o,(c-l)/(1-l))[0]),d?[o[6],o[7],o[4],o[5],o[2],o[3],o[0],o[1]]:o},isFlatEnough:function(o,l){var c=o[0],d=o[1],f=o[2],m=o[3],v=o[4],p=o[5],y=o[6],I=o[7],A=3*f-2*c-y,P=3*m-2*d-I,C=3*v-2*y-c,S=3*p-2*I-d;return Math.max(A*A,C*C)+Math.max(P*P,S*S)<=16*l*l},getArea:function(o){var l=o[0],c=o[1],d=o[2],f=o[3],m=o[4],v=o[5],p=o[6],y=o[7];return 3*((y-c)*(d+m)-(p-l)*(f+v)+f*(l-m)-d*(c-v)+y*(m+l/3)-p*(v+c/3))/20},getBounds:function(o){for(var l=o.slice(0,2),c=l.slice(),d=[0,0],f=0;f<2;f++)he._addBounds(o[f],o[f+2],o[f+4],o[f+6],f,0,l,c,d);return new V(l[0],l[1],c[0]-l[0],c[1]-l[1])},_addBounds:function(o,l,c,d,f,m,v,p,y){function I(M,L){var $=M-L,H=M+L;$<v[f]&&(v[f]=$),H>p[f]&&(p[f]=H)}m/=2;var A=v[f]+m,P=p[f]-m;if(o<A||l<A||c<A||d<A||o>P||l>P||c>P||d>P)if(l<o!=l<d&&c<o!=c<d)I(o,0),I(d,0);else{var C=3*(l-c)-o+d,S=2*(o+c)-4*l,k=l-o,O=w.solveQuadratic(C,S,k,y),F=1e-8,N=1-F;I(d,0);for(var D=0;D<O;D++){var x=y[D],b=1-x;F<=x&&x<=N&&I(b*b*b*o+3*b*b*x*l+3*b*x*x*c+x*x*x*d,m)}}}}},s.each(["getBounds","getStrokeBounds","getHandleBounds"],function(o){this[o]=function(){this._bounds||(this._bounds={});var l=this._bounds[o];return l||(l=this._bounds[o]=Te[o]([this._segment1,this._segment2],!1,this._path)),l.clone()}},{}),s.each({isStraight:function(o,l,c,d){if(l.isZero()&&c.isZero())return!0;var f=d.subtract(o);if(f.isZero())return!1;if(f.isCollinear(l)&&f.isCollinear(c)){var m=new Z(o,d),v=1e-7;if(m.getDistance(o.add(l))<v&&m.getDistance(d.add(c))<v){var p=f.dot(f),y=f.dot(l)/p,I=f.dot(c)/p;return y>=0&&y<=1&&I<=0&&I>=-1}}return!1},isLinear:function(o,l,c,d){var f=d.subtract(o).divide(3);return l.equals(f)&&c.negate().equals(f)}},function(o,l){this[l]=function(c){var d=this._segment1,f=this._segment2;return o(d._point,d._handleOut,f._handleIn,f._point,c)},this.statics[l]=function(c,d){var f=c[0],m=c[1],v=c[6],p=c[7];return o(new E(f,m),new E(c[2]-f,c[3]-m),new E(c[4]-v,c[5]-p),new E(v,p),d)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(o){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(o||0)},isCollinear:function(o){return o&&this.isStraight()&&o.isStraight()&&this.getLine().isCollinear(o.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(o,l){return this.getLocationAtTime(l?o:this.getTimeAt(o))},getLocationAtTime:function(o){return o!=null&&o>=0&&o<=1?new it(this,o):null},getTimeAt:function(o,l){return he.getTimeAt(this.getValues(),o,l)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var o=E.read(arguments);return o.isZero()?[]:he.getTimesWithTangent(this.getValues(),o)},getOffsetAtTime:function(o){return this.getPartLength(0,o)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(E.read(arguments)))},getOffsetOf:function(){var o=this.getLocationOf.apply(this,arguments);return o?o.getOffset():null},getTimeOf:function(){return he.getTimeOf(this.getValues(),E.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var o=E.read(arguments),l=this.getValues(),c=he.getNearestTime(l,o),d=he.getPoint(l,c);return new it(this,c,d,null,o.getDistance(d))},getNearestPoint:function(){var o=this.getNearestLocation.apply(this,arguments);return o&&o.getPoint()}},new function(){var o=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return s.each(o,function(l){this[l+"At"]=function(c,d){var f=this.getValues();return he[l](f,d?c:he.getTimeAt(f,c))},this[l+"AtTime"]=function(c){return he[l](this.getValues(),c)}},{statics:{_evaluateMethods:o}})},new function(){function o(d){var f=d[0],m=d[1],v=d[2],p=d[3],y=d[4],I=d[5],A=d[6],P=d[7],C=9*(v-y)+3*(A-f),S=6*(f+y)-12*v,k=3*(v-f),O=9*(p-I)+3*(P-m),F=6*(m+I)-12*p,N=3*(p-m);return function(D){var x=(C*D+S)*D+k,b=(O*D+F)*D+N;return Math.sqrt(x*x+b*b)}}function l(d,f){return Math.max(2,Math.min(16,Math.ceil(Math.abs(f-d)*32)))}function c(d,f,m,v){if(f==null||f<0||f>1)return null;var p=d[0],y=d[1],I=d[2],A=d[3],P=d[4],C=d[5],S=d[6],k=d[7],O=w.isZero;O(I-p)&&O(A-y)&&(I=p,A=y),O(P-S)&&O(C-k)&&(P=S,C=k);var F=3*(I-p),N=3*(P-I)-F,D=S-p-F-N,x=3*(A-y),b=3*(C-A)-x,M=k-y-x-b,L,$;if(m===0)L=f===0?p:f===1?S:((D*f+N)*f+F)*f+p,$=f===0?y:f===1?k:((M*f+b)*f+x)*f+y;else{var H=1e-8,q=1-H;if(f<H?(L=F,$=x):f>q?(L=3*(S-P),$=3*(k-C)):(L=(3*D*f+2*N)*f+F,$=(3*M*f+2*b)*f+x),v){L===0&&$===0&&(f<H||f>q)&&(L=P-I,$=C-A);var W=Math.sqrt(L*L+$*$);W&&(L/=W,$/=W)}if(m===3){var P=6*D*f+2*N,C=6*M*f+2*b,Q=Math.pow(L*L+$*$,3/2);L=Q!==0?(L*C-$*P)/Q:0,$=0}}return m===2?new E($,-L):new E(L,$)}return{statics:{classify:function(d){var f=d[0],m=d[1],v=d[2],p=d[3],y=d[4],I=d[5],A=d[6],P=d[7],C=f*(P-I)+m*(y-A)+A*I-P*y,S=v*(m-P)+p*(A-f)+f*P-m*A,k=y*(p-m)+I*(f-v)+v*m-p*f,O=3*k,F=O-S,N=F-S+C,D=Math.sqrt(N*N+F*F+O*O),x=D!==0?1/D:0,b=w.isZero,M="serpentine";N*=x,F*=x,O*=x;function L(W,Q,K){var Y=Q!==n,ee=Y&&Q>0&&Q<1,re=Y&&K>0&&K<1;return Y&&(!(ee||re)||W==="loop"&&!(ee&&re))&&(W="arch",ee=re=!1),{type:W,roots:ee||re?ee&&re?Q<K?[Q,K]:[K,Q]:[ee?Q:K]:null}}if(b(N))return b(F)?L(b(O)?"line":"quadratic"):L(M,O/(3*F));var $=3*F*F-4*N*O;if(b($))return L("cusp",F/(2*N));var H=$>0?Math.sqrt($/3):Math.sqrt(-$),q=2*N;return L($>0?M:"loop",(F+H)/q,(F-H)/q)},getLength:function(d,f,m,v){if(f===n&&(f=0),m===n&&(m=1),he.isStraight(d)){var p=d;m<1&&(p=he.subdivide(p,m)[0],f/=m),f>0&&(p=he.subdivide(p,f)[1]);var y=p[6]-p[0],I=p[7]-p[1];return Math.sqrt(y*y+I*I)}return w.integrate(v||o(d),f,m,l(f,m))},getTimeAt:function(d,f,m){if(m===n&&(m=f<0?1:0),f===0)return m;var v=Math.abs,p=1e-12,y=f>0,I=y?m:0,A=y?1:m,P=o(d),C=he.getLength(d,I,A,P),S=v(f)-C;if(v(S)<p)return y?A:I;if(S>p)return null;var k=f/C,O=0;function F(N){return O+=w.integrate(P,m,N,l(m,N)),m=N,O-f}return w.findRoot(F,P,m+k,I,A,32,1e-12)},getPoint:function(d,f){return c(d,f,0,!1)},getTangent:function(d,f){return c(d,f,1,!0)},getWeightedTangent:function(d,f){return c(d,f,1,!1)},getNormal:function(d,f){return c(d,f,2,!0)},getWeightedNormal:function(d,f){return c(d,f,2,!1)},getCurvature:function(d,f){return c(d,f,3,!1).x},getPeaks:function(d){var f=d[0],m=d[1],v=d[2],p=d[3],y=d[4],I=d[5],A=d[6],P=d[7],C=-f+3*v-3*y+A,S=3*f-6*v+3*y,k=-3*f+3*v,O=-m+3*p-3*I+P,F=3*m-6*p+3*I,N=-3*m+3*p,D=1e-8,x=1-D,b=[];return w.solveCubic(9*(C*C+O*O),9*(C*S+F*O),2*(S*S+F*F)+3*(k*C+N*O),k*S+F*N,b,D,x),b.sort()}}}},new function(){function o(S,k,O,F,N,D,x){var b=!x&&O.getPrevious()===N,M=!x&&O!==N&&O.getNext()===N,L=1e-8,$=1-L;if(F!==null&&F>=(b?L:0)&&F<=(M?$:1)&&D!==null&&D>=(M?L:0)&&D<=(b?$:1)){var H=new it(O,F,null,x),q=new it(N,D,null,x);H._intersection=q,q._intersection=H,(!k||k(H))&&it.insert(S,H,!0)}}function l(S,k,O,F,N,D,x,b,M,L,$,H,q){if(++M>=4096||++b>=40)return M;var W=1e-9,Q=k[0],K=k[1],Y=k[6],ee=k[7],re=Z.getSignedDistance,oe=re(Q,K,Y,ee,k[2],k[3]),le=re(Q,K,Y,ee,k[4],k[5]),Ie=oe*le>0?3/4:4/9,Se=Ie*Math.min(0,oe,le),be=Ie*Math.max(0,oe,le),We=re(Q,K,Y,ee,S[0],S[1]),$e=re(Q,K,Y,ee,S[2],S[3]),ze=re(Q,K,Y,ee,S[4],S[5]),je=re(Q,K,Y,ee,S[6],S[7]),Je=c(We,$e,ze,je),Ge=Je[0],yt=Je[1],st,ht;if(oe===0&&le===0&&We===0&&$e===0&&ze===0&&je===0||(st=d(Ge,yt,Se,be))==null||(ht=d(Ge.reverse(),yt.reverse(),Se,be))==null)return M;var mt=L+($-L)*st,at=L+($-L)*ht;if(Math.max(q-H,at-mt)<W){var $n=(mt+at)/2,Hn=(H+q)/2;o(N,D,x?F:O,x?Hn:$n,x?O:F,x?$n:Hn)}else{S=he.getPart(S,st,ht);var pr=q-H;if(ht-st>.8)if(at-mt>pr){var wn=he.subdivide(S,.5),$n=(mt+at)/2;M=l(k,wn[0],F,O,N,D,!x,b,M,H,q,mt,$n),M=l(k,wn[1],F,O,N,D,!x,b,M,H,q,$n,at)}else{var wn=he.subdivide(k,.5),Hn=(H+q)/2;M=l(wn[0],S,F,O,N,D,!x,b,M,H,Hn,mt,at),M=l(wn[1],S,F,O,N,D,!x,b,M,Hn,q,mt,at)}else pr===0||pr>=W?M=l(k,S,F,O,N,D,!x,b,M,H,q,mt,at):M=l(S,k,O,F,N,D,x,b,M,mt,at,H,q)}return M}function c(S,k,O,F){var N=[0,S],D=[1/3,k],x=[2/3,O],b=[1,F],M=k-(2*S+F)/3,L=O-(S+2*F)/3,$;if(M*L<0)$=[[N,D,b],[N,x,b]];else{var H=M/L;$=[H>=2?[N,D,b]:H<=.5?[N,x,b]:[N,D,x,b],[N,b]]}return(M||L)<0?$.reverse():$}function d(S,k,O,F){return S[0][1]<O?f(S,!0,O):k[0][1]>F?f(k,!1,F):S[0][0]}function f(S,k,O){for(var F=S[0][0],N=S[0][1],D=1,x=S.length;D<x;D++){var b=S[D][0],M=S[D][1];if(k?M>=O:M<=O)return M===O?b:F+(O-N)*(b-F)/(M-N);F=b,N=M}return null}function m(S,k,O,F,N){var D=w.isZero;if(D(F)&&D(N)){var x=he.getTimeOf(S,new E(k,O));return x===null?[]:[x]}for(var b=Math.atan2(-N,F),M=Math.sin(b),L=Math.cos(b),$=[],H=[],q=0;q<8;q+=2){var W=S[q]-k,Q=S[q+1]-O;$.push(W*L-Q*M,W*M+Q*L)}return he.solveCubic($,1,0,H,0,1),H}function v(S,k,O,F,N,D,x){for(var b=k[0],M=k[1],L=k[6],$=k[7],H=m(S,b,M,L-b,$-M),q=0,W=H.length;q<W;q++){var Q=H[q],K=he.getPoint(S,Q),Y=he.getTimeOf(k,K);Y!==null&&o(N,D,x?F:O,x?Y:Q,x?O:F,x?Q:Y)}}function p(S,k,O,F,N,D){var x=Z.intersect(S[0],S[1],S[6],S[7],k[0],k[1],k[6],k[7]);x&&o(N,D,O,he.getTimeOf(S,x),F,he.getTimeOf(k,x))}function y(S,k,O,F,N,D){var x=1e-12,b=Math.min,M=Math.max;if(M(S[0],S[2],S[4],S[6])+x>b(k[0],k[2],k[4],k[6])&&b(S[0],S[2],S[4],S[6])-x<M(k[0],k[2],k[4],k[6])&&M(S[1],S[3],S[5],S[7])+x>b(k[1],k[3],k[5],k[7])&&b(S[1],S[3],S[5],S[7])-x<M(k[1],k[3],k[5],k[7])){var L=P(S,k);if(L)for(var $=0;$<2;$++){var H=L[$];o(N,D,O,H[0],F,H[1],!0)}else{var q=he.isStraight(S),W=he.isStraight(k),Q=q&&W,K=q&&!W,Y=N.length;if((Q?p:q||W?v:l)(K?k:S,K?S:k,K?F:O,K?O:F,N,D,K,0,0,0,1,0,1),!Q||N.length===Y)for(var $=0;$<4;$++){var ee=$>>1,re=$&1,oe=ee*6,le=re*6,Ie=new E(S[oe],S[oe+1]),Se=new E(k[le],k[le+1]);Ie.isClose(Se,x)&&o(N,D,O,ee,F,re)}}}return N}function I(S,k,O,F){var N=he.classify(S);if(N.type==="loop"){var D=N.roots;o(O,F,k,D[0],k,D[1])}return O}function A(S,k,O,F,N,D){var x=1e-7,b=!k;b&&(k=S);for(var M=S.length,L=k.length,$=new Array(M),H=b?$:new Array(L),q=[],W=0;W<M;W++)$[W]=S[W].getValues(F);if(!b)for(var W=0;W<L;W++)H[W]=k[W].getValues(N);for(var Q=g.findCurveBoundsCollisions($,H,x),K=0;K<M;K++){var Y=S[K],ee=$[K];b&&I(ee,Y,q,O);var re=Q[K];if(re)for(var oe=0;oe<re.length;oe++){if(D&&q.length)return q;var le=re[oe];if(!b||le>K){var Ie=k[le],Se=H[le];y(ee,Se,Y,Ie,q,O)}}}return q}function P(S,k){function O(je){var Je=je[6]-je[0],Ge=je[7]-je[1];return Je*Je+Ge*Ge}var F=Math.abs,N=Z.getDistance,D=1e-8,x=1e-7,b=he.isStraight(S),M=he.isStraight(k),L=b&&M,$=O(S)<O(k),H=$?k:S,q=$?S:k,W=H[0],Q=H[1],K=H[6]-W,Y=H[7]-Q;if(N(W,Q,K,Y,q[0],q[1],!0)<x&&N(W,Q,K,Y,q[6],q[7],!0)<x)!L&&N(W,Q,K,Y,H[2],H[3],!0)<x&&N(W,Q,K,Y,H[4],H[5],!0)<x&&N(W,Q,K,Y,q[2],q[3],!0)<x&&N(W,Q,K,Y,q[4],q[5],!0)<x&&(b=M=L=!0);else if(L)return null;if(b^M)return null;for(var ee=[S,k],re=[],oe=0;oe<4&&re.length<2;oe++){var le=oe&1,Ie=le^1,Se=oe>>1,be=he.getTimeOf(ee[le],new E(ee[Ie][Se?6:0],ee[Ie][Se?7:1]));if(be!=null){var We=le?[Se,be]:[be,Se];(!re.length||F(We[0]-re[0][0])>D&&F(We[1]-re[0][1])>D)&&re.push(We)}if(oe>2&&!re.length)break}if(re.length!==2)re=null;else if(!L){var $e=he.getPart(S,re[0][0],re[1][0]),ze=he.getPart(k,re[0][1],re[1][1]);(F(ze[2]-$e[2])>x||F(ze[3]-$e[3])>x||F(ze[4]-$e[4])>x||F(ze[5]-$e[5])>x)&&(re=null)}return re}function C(S,k){var O=S[0],F=S[1],N=S[2],D=S[3],x=S[4],b=S[5],M=S[6],L=S[7],$=k.normalize(),H=$.x,q=$.y,W=3*M-9*x+9*N-3*O,Q=3*L-9*b+9*D-3*F,K=6*x-12*N+6*O,Y=6*b-12*D+6*F,ee=3*N-3*O,re=3*D-3*F,oe=2*W*q-2*Q*H,le=[];if(Math.abs(oe)<w.CURVETIME_EPSILON){var Ie=W*re-Q*ee,oe=W*Y-Q*K;if(oe!=0){var Se=-Ie/oe;Se>=0&&Se<=1&&le.push(Se)}}else{var be=(K*K-4*W*ee)*q*q+(-2*K*Y+4*Q*ee+4*W*re)*H*q+(Y*Y-4*Q*re)*H*H,We=K*q-Y*H;if(be>=0&&oe!=0){var $e=Math.sqrt(be),ze=-(We+$e)/oe,je=(-We+$e)/oe;ze>=0&&ze<=1&&le.push(ze),je>=0&&je<=1&&le.push(je)}}return le}return{getIntersections:function(S){var k=this.getValues(),O=S&&S!==this&&S.getValues();return O?y(k,O,this,S,[]):I(k,this,[])},statics:{getOverlaps:P,getIntersections:A,getCurveLineIntersections:m,getTimesWithTangent:C}}}),it=s.extend({_class:"CurveLocation",initialize:function(l,c,d,f,m){if(c>=.99999999){var v=l.getNext();v&&(c=0,l=v)}this._setCurve(l),this._time=c,this._point=d||l.getPointAtTime(c),this._overlap=f,this._distance=m,this._intersection=this._next=this._previous=null},_setPath:function(o){this._path=o,this._version=o?o._version:0},_setCurve:function(o){this._setPath(o._path),this._curve=o,this._segment=null,this._segment1=o._segment1,this._segment2=o._segment2},_setSegment:function(o){var l=o.getCurve();l?this._setCurve(l):(this._setPath(o._path),this._segment1=o,this._segment2=null),this._segment=o,this._time=o===this._segment1?0:1,this._point=o._point.clone()},getSegment:function(){var o=this._segment;if(!o){var l=this.getCurve(),c=this.getTime();c===0?o=l._segment1:c===1?o=l._segment2:c!=null&&(o=l.getPartLength(0,c)<l.getPartLength(c,1)?l._segment1:l._segment2),this._segment=o}return o},getCurve:function(){var o=this._path,l=this;o&&o._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function c(d){var f=d&&d.getCurve();if(f&&(l._time=f.getTimeOf(l._point))!=null)return l._setCurve(f),f}return this._curve||c(this._segment)||c(this._segment1)||c(this._segment2.getPrevious())},getPath:function(){var o=this.getCurve();return o&&o._path},getIndex:function(){var o=this.getCurve();return o&&o.getIndex()},getTime:function(){var o=this.getCurve(),l=this._time;return o&&l==null?this._time=o.getTimeOf(this._point):l},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var o=this._offset;if(o==null){o=0;var l=this.getPath(),c=this.getIndex();if(l&&c!=null)for(var d=l.getCurves(),f=0;f<c;f++)o+=d[f].getLength();this._offset=o+=this.getCurveOffset()}return o},getCurveOffset:function(){var o=this._curveOffset;if(o==null){var l=this.getCurve(),c=this.getTime();this._curveOffset=o=c!=null&&l&&l.getPartLength(0,c)}return o},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var o=this.getCurve(),l=o&&o.divideAtTime(this.getTime());return l&&this._setSegment(l._segment1),l},split:function(){var o=this.getCurve(),l=o._path,c=o&&o.splitAtTime(this.getTime());return c&&this._setSegment(l.getLastSegment()),c},equals:function(o,l){var c=this===o;if(!c&&o instanceof it){var d=this.getCurve(),f=o.getCurve(),m=d._path,v=f._path;if(m===v){var p=Math.abs,y=1e-7,I=p(this.getOffset()-o.getOffset()),A=!l&&this._intersection,P=!l&&o._intersection;c=(I<y||m&&p(m.getLength()-I)<y)&&(!A&&!P||A&&P&&A.equals(P,!0))}}return c},toString:function(){var o=[],l=this.getPoint(),c=_.instance;l&&o.push("point: "+l);var d=this.getIndex();d!=null&&o.push("index: "+d);var f=this.getTime();return f!=null&&o.push("time: "+c.number(f)),this._distance!=null&&o.push("distance: "+c.number(this._distance)),"{ "+o.join(", ")+" }"},isTouching:function(){var o=this._intersection;if(o&&this.getTangent().isCollinear(o.getTangent())){var l=this.getCurve(),c=o.getCurve();return!(l.isStraight()&&c.isStraight()&&l.getLine().intersect(c.getLine()))}return!1},isCrossing:function(){var o=this._intersection;if(!o)return!1;var l=this.getTime(),c=o.getTime(),d=1e-8,f=1-d,m=l>=d&&l<=f,v=c>=d&&c<=f;if(m&&v)return!this.isTouching();var p=this.getCurve(),y=p&&l<d?p.getPrevious():p,I=o.getCurve(),A=I&&c<d?I.getPrevious():I;if(l>f&&(p=p.getNext()),c>f&&(I=I.getNext()),!y||!p||!A||!I)return!1;var P=[];function C(H,q){var W=H.getValues(),Q=he.classify(W).roots||he.getPeaks(W),K=Q.length,Y=he.getLength(W,q&&K?Q[K-1]:0,!q&&K?Q[0]:1);P.push(K?Y:Y/32)}function S(H,q,W){return q<W?H>q&&H<W:H>q||H<W}m||(C(y,!0),C(p,!1)),v||(C(A,!0),C(I,!1));var k=this.getPoint(),O=Math.min.apply(Math,P),F=m?p.getTangentAtTime(l):p.getPointAt(O).subtract(k),N=m?F.negate():y.getPointAt(-O).subtract(k),D=v?I.getTangentAtTime(c):I.getPointAt(O).subtract(k),x=v?D.negate():A.getPointAt(-O).subtract(k),b=N.getAngle(),M=F.getAngle(),L=x.getAngle(),$=D.getAngle();return!!(m?S(b,L,$)^S(M,L,$)&&S(b,$,L)^S(M,$,L):S(L,b,M)^S($,b,M)&&S(L,M,b)^S($,M,b))},hasOverlap:function(){return!!this._overlap}},s.each(he._evaluateMethods,function(o){var l=o+"At";this[o]=function(){var c=this.getCurve(),d=this.getTime();return d!=null&&c&&c[l](d,!0)}},{preserve:!0}),new function(){function o(l,c,d){var f=l.length,m=0,v=f-1;function p(k,O){for(var F=k+O;F>=-1&&F<=f;F+=O){var N=l[(F%f+f)%f];if(!c.getPoint().isClose(N.getPoint(),1e-7))break;if(c.equals(N))return N}return null}for(;m<=v;){var y=m+v>>>1,I=l[y],A;if(d&&(A=c.equals(I)?I:p(y,-1)||p(y,1)))return c._overlap&&(A._overlap=A._intersection._overlap=!0),A;var P=c.getPath(),C=I.getPath(),S=P!==C?P._id-C._id:c.getIndex()+c.getTime()-(I.getIndex()+I.getTime());S<0?v=y-1:m=y+1}return l.splice(m,0,c),c}return{statics:{insert:o,expand:function(l){for(var c=l.slice(),d=l.length-1;d>=0;d--)o(c,l[d]._intersection,!1);return c}}}}),Ce=te.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(o){var l,c,d;if(s.isPlainObject(o)?(c=o.segments,l=o.pathData):Array.isArray(o)?c=o:typeof o=="string"&&(l=o),c){var f=c[0];d=f&&Array.isArray(f[0])}else l&&(d=(l.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(l));var m=d?De:Te;return new m(o)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(o){this.isClockwise()!=(o=!!o)&&this.reverse()},setPathData:function(o){var l=o&&o.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),c,d=!1,f,m,v=new E,p=new E;function y(x,b){var M=+c[x];return d&&(M+=v[b]),M}function I(x){return new E(y(x,"x"),y(x+1,"y"))}this.clear();for(var A=0,P=l&&l.length;A<P;A++){var C=l[A],S=C[0],k=S.toLowerCase();c=C.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var O=c&&c.length;switch(d=S===k,f==="z"&&!/[mz]/.test(k)&&this.moveTo(v),k){case"m":case"l":for(var F=k==="m",N=0;N<O;N+=2)this[F?"moveTo":"lineTo"](v=I(N)),F&&(p=v,F=!1);m=v;break;case"h":case"v":var D=k==="h"?"x":"y";v=v.clone();for(var N=0;N<O;N++)v[D]=y(N,D),this.lineTo(v);m=v;break;case"c":for(var N=0;N<O;N+=6)this.cubicCurveTo(I(N),m=I(N+2),v=I(N+4));break;case"s":for(var N=0;N<O;N+=4)this.cubicCurveTo(/[cs]/.test(f)?v.multiply(2).subtract(m):v,m=I(N),v=I(N+2)),f=k;break;case"q":for(var N=0;N<O;N+=4)this.quadraticCurveTo(m=I(N),v=I(N+2));break;case"t":for(var N=0;N<O;N+=2)this.quadraticCurveTo(m=/[qt]/.test(f)?v.multiply(2).subtract(m):v,v=I(N)),f=k;break;case"a":for(var N=0;N<O;N+=7)this.arcTo(v=I(N+5),new j(+c[N],+c[N+1]),+c[N+2],+c[N+4],+c[N+3]);break;case"z":this.closePath(1e-12),v=p;break}f=k}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(o){var l=o.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(o):{};return l.onPath||!!(this.getFillRule()==="evenodd"?l.windingL&1||l.windingR&1:l.winding)},getIntersections:function(o,l,c,d){var f=this===o||!o,m=this._matrix._orNullIfIdentity(),v=f?m:(c||o._matrix)._orNullIfIdentity();return f||this.getBounds(m).intersects(o.getBounds(v),1e-12)?he.getIntersections(this.getCurves(),!f&&o.getCurves(),l,m,v,d):[]},getCrossings:function(o){return this.getIntersections(o,function(l){return l.isCrossing()})},getNearestLocation:function(){for(var o=E.read(arguments),l=this.getCurves(),c=1/0,d=null,f=0,m=l.length;f<m;f++){var v=l[f].getNearestLocation(o);v._distance<c&&(c=v._distance,d=v)}return d},getNearestPoint:function(){var o=this.getNearestLocation.apply(this,arguments);return o&&o.getPoint()},interpolate:function(o,l,c){var d=!this._children,f=d?"_segments":"_children",m=o[f],v=l[f],p=this[f];if(!m||!v||m.length!==v.length)throw new Error("Invalid operands in interpolate() call: "+o+", "+l);var y=p.length,I=v.length;if(y<I)for(var A=d?we:Te,P=y;P<I;P++)this.add(new A);else y>I&&this[d?"removeSegments":"removeChildren"](I,y);for(var P=0;P<I;P++)p[P].interpolate(m[P],v[P],c);d&&(this.setClosed(o._closed),this._changed(9))},compare:function(o){var l=!1;if(o){var c=this._children||[this],d=o._children?o._children.slice():[o],f=c.length,m=d.length,v=[],p=0;l=!0;for(var y=g.findItemBoundsCollisions(c,d,w.GEOMETRIC_EPSILON),I=f-1;I>=0&&l;I--){var A=c[I];l=!1;var P=y[I];if(P)for(var C=P.length-1;C>=0&&!l;C--)A.compare(d[P[C]])&&(v[P[C]]||(v[P[C]]=!0,p++),l=!0)}l=l&&p===m}return l}}),Te=Ce.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(l){this._closed=!1,this._segments=[],this._version=0;var c=arguments,d=Array.isArray(l)?typeof l[0]=="object"?l:c:l&&l.size===n&&(l.x!==n||l.point!==n)?c:null;d&&d.length>0?this.setSegments(d):(this._curves=n,this._segmentSelection=0,!d&&typeof l=="string"&&(this.setPathData(l),l=null)),this._initialize(!d&&l)},_equals:function(o){return this._closed===o._closed&&s.equals(this._segments,o._segments)},copyContent:function(o){this.setSegments(o._segments),this._closed=o._closed},_changed:function o(l){if(o.base.call(this,l),l&8){if(this._length=this._area=n,l&32)this._version++;else if(this._curves)for(var c=0,d=this._curves.length;c<d;c++)this._curves[c]._changed()}else l&64&&(this._bounds=n)},getStyle:function(){var o=this._parent;return(o instanceof De?o:this)._style},getSegments:function(){return this._segments},setSegments:function(o){var l=this.isFullySelected(),c=o&&o.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,c){var d=o[c-1];typeof d=="boolean"&&(this.setClosed(d),c--),this._add(we.readList(o,0,{},c))}l&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var o=this._curves,l=this._segments;if(!o){var c=this._countCurves();o=this._curves=new Array(c);for(var d=0;d<c;d++)o[d]=new he(this,l[d],l[d+1]||l[0])}return o},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var o=this.getCurves();return o[o.length-1]},isClosed:function(){return this._closed},setClosed:function(o){if(this._closed!=(o=!!o)){if(this._closed=o,this._curves){var l=this._curves.length=this._countCurves();o&&(this._curves[l-1]=new he(this,this._segments[l-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(o,l){var c=this._segments,d=c.length,f=new _(l),m=new Array(6),v=!0,p,y,I,A,P,C,S,k,O=[];function F(D,x){if(D._transformCoordinates(o,m),p=m[0],y=m[1],v)O.push("M"+f.pair(p,y)),v=!1;else if(P=m[2],C=m[3],P===p&&C===y&&S===I&&k===A){if(!x){var b=p-I,M=y-A;O.push(b===0?"v"+f.number(M):M===0?"h"+f.number(b):"l"+f.pair(b,M))}}else O.push("c"+f.pair(S-I,k-A)+" "+f.pair(P-I,C-A)+" "+f.pair(p-I,y-A));I=p,A=y,S=m[4],k=m[5]}if(!d)return"";for(var N=0;N<d;N++)F(c[N]);return this._closed&&d>0&&(F(c[0],!0),O.push("z")),O.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(o){for(var l=this._segments,c=new Array(6),d=0,f=l.length;d<f;d++)l[d]._transformCoordinates(o,c,!0);return!0},_add:function(o,v){for(var c=this._segments,d=this._curves,f=o.length,m=v==null,v=m?c.length:v,p=0;p<f;p++){var y=o[p];y._path&&(y=o[p]=y.clone()),y._path=this,y._index=v+p,y._selection&&this._updateSelection(y,0,y._selection)}if(m)s.push(c,o);else{c.splice.apply(c,[v,0].concat(o));for(var p=v+f,I=c.length;p<I;p++)c[p]._index=p}if(d){var A=this._countCurves(),P=v>0&&v+f-1===A?v-1:v,C=P,S=Math.min(P+f,A);o._curves&&(d.splice.apply(d,[P,0].concat(o._curves)),C+=o._curves.length);for(var p=C;p<S;p++)d.splice(p,0,new he(this,null,null));this._adjustCurves(P,S)}return this._changed(41),o},_adjustCurves:function(o,l){for(var c=this._segments,d=this._curves,f,m=o;m<l;m++)f=d[m],f._path=this,f._segment1=c[m],f._segment2=c[m+1]||c[0],f._changed();(f=d[this._closed&&!o?c.length-1:o-1])&&(f._segment2=c[o]||c[0],f._changed()),(f=d[l])&&(f._segment1=c[l],f._changed())},_countCurves:function(){var o=this._segments.length;return!this._closed&&o>0?o-1:o},add:function(o){var l=arguments;return l.length>1&&typeof o!="number"?this._add(we.readList(l)):this._add([we.read(l)])[0]},insert:function(o,l){var c=arguments;return c.length>2&&typeof l!="number"?this._add(we.readList(c,1),o):this._add([we.read(c,1)],o)[0]},addSegment:function(){return this._add([we.read(arguments)])[0]},insertSegment:function(o){return this._add([we.read(arguments,1)],o)[0]},addSegments:function(o){return this._add(we.readList(o))},insertSegments:function(o,l){return this._add(we.readList(l),o)},removeSegment:function(o){return this.removeSegments(o,o+1)[0]||null},removeSegments:function(o,l,c){o=o||0,l=s.pick(l,this._segments.length);var d=this._segments,f=this._curves,m=d.length,v=d.splice(o,l-o),p=v.length;if(!p)return v;for(var y=0;y<p;y++){var I=v[y];I._selection&&this._updateSelection(I,I._selection,0),I._index=I._path=null}for(var y=o,A=d.length;y<A;y++)d[y]._index=y;if(f){for(var P=o>0&&l===m+(this._closed?1:0)?o-1:o,f=f.splice(P,p),y=f.length-1;y>=0;y--)f[y]._path=null;c&&(v._curves=f.slice(1)),this._adjustCurves(P,P)}return this._changed(41),v},clear:"#removeSegments",hasHandles:function(){for(var o=this._segments,l=0,c=o.length;l<c;l++)if(o[l].hasHandles())return!0;return!1},clearHandles:function(){for(var o=this._segments,l=0,c=o.length;l<c;l++)o[l].clearHandles()},getLength:function(){if(this._length==null){for(var o=this.getCurves(),l=0,c=0,d=o.length;c<d;c++)l+=o[c].getLength();this._length=l}return this._length},getArea:function(){var o=this._area;if(o==null){var l=this._segments,c=this._closed;o=0;for(var d=0,f=l.length;d<f;d++){var m=d+1===f;o+=he.getArea(he.getValues(l[d],l[m?0:d+1],null,m&&!c))}this._area=o}return o},isFullySelected:function(){var o=this._segments.length;return this.isSelected()&&o>0&&this._segmentSelection===o*7},setFullySelected:function(o){o&&this._selectSegments(!0),this.setSelected(o)},setSelection:function o(l){l&1||this._selectSegments(!1),o.base.call(this,l)},_selectSegments:function(o){var l=this._segments,c=l.length,d=o?7:0;this._segmentSelection=d*c;for(var f=0;f<c;f++)l[f]._selection=d},_updateSelection:function(o,l,c){o._selection=c;var d=this._segmentSelection+=c-l;d>0&&this.setSelected(!0)},divideAt:function(o){var l=this.getLocationAt(o),c;return l&&(c=l.getCurve().divideAt(l.getCurveOffset()))?c._segment1:null},splitAt:function(o){var l=this.getLocationAt(o),c=l&&l.index,d=l&&l.time,f=1e-8,m=1-f;d>m&&(c++,d=0);var v=this.getCurves();if(c>=0&&c<v.length){d>=f&&v[c++].divideAtTime(d);var p=this.removeSegments(c,this._segments.length,!0),y;return this._closed?(this.setClosed(!1),y=this):(y=new Te(te.NO_INSERT),y.insertAbove(this),y.copyAttributes(this)),y._add(p,0),this.addSegment(p[0]),y}return null},split:function(o,l){var c,d=l===n?o:(c=this.getCurves()[o])&&c.getLocationAtTime(l);return d!=null?this.splitAt(d):null},join:function(o,l){var c=l||0;if(o&&o!==this){var d=o._segments,f=this.getLastSegment(),m=o.getLastSegment();if(!m)return this;f&&f._point.isClose(m._point,c)&&o.reverse();var v=o.getFirstSegment();if(f&&f._point.isClose(v._point,c))f.setHandleOut(v._handleOut),this._add(d.slice(1));else{var p=this.getFirstSegment();p&&p._point.isClose(v._point,c)&&o.reverse(),m=o.getLastSegment(),p&&p._point.isClose(m._point,c)?(p.setHandleIn(m._handleIn),this._add(d.slice(0,d.length-1),0)):this._add(d.slice())}o._closed&&this._add([d[0]]),o.remove()}var y=this.getFirstSegment(),I=this.getLastSegment();return y!==I&&y._point.isClose(I._point,c)&&(y.setHandleIn(I._handleIn),I.remove(),this.setClosed(!0)),this},reduce:function(o){for(var l=this.getCurves(),c=o&&o.simplify,d=c?1e-7:0,f=l.length-1;f>=0;f--){var m=l[f];!m.hasHandles()&&(!m.hasLength(d)||c&&m.isCollinear(m.getNext()))&&m.remove()}return this},reverse:function(){this._segments.reverse();for(var o=0,l=this._segments.length;o<l;o++){var c=this._segments[o],d=c._handleIn;c._handleIn=c._handleOut,c._handleOut=d,c._index=o}this._curves=null,this._changed(9)},flatten:function(o){for(var l=new Qe(this,o||.25,256,!0),c=l.parts,d=c.length,f=[],m=0;m<d;m++)f.push(new we(c[m].curve.slice(0,2)));!this._closed&&d>0&&f.push(new we(c[d-1].curve.slice(6))),this.setSegments(f)},simplify:function(o){var l=new vt(this).fit(o||2.5);return l&&this.setSegments(l),!!l},smooth:function(o){var l=this,c=o||{},d=c.type||"asymmetric",f=this._segments,m=f.length,v=this._closed;function p(Ge,yt){var st=Ge&&Ge.index;if(st!=null){var ht=Ge.path;if(ht&&ht!==l)throw new Error(Ge._class+" "+st+" of "+ht+" is not part of "+l);yt&&Ge instanceof he&&st++}else st=typeof Ge=="number"?Ge:yt;return Math.min(st<0&&v?st%m:st<0?st+m:st,m-1)}var y=v&&c.from===n&&c.to===n,I=p(c.from,0),A=p(c.to,m-1);if(I>A)if(v)I-=m;else{var P=I;I=A,A=P}if(/^(?:asymmetric|continuous)$/.test(d)){var C=d==="asymmetric",S=Math.min,k=A-I+1,O=k-1,F=y?S(k,4):1,N=F,D=F,x=[];if(v||(N=S(1,I),D=S(1,m-A-1)),O+=N+D,O<=1)return;for(var b=0,M=I-N;b<=O;b++,M++)x[b]=f[(M<0?M+m:M)%m]._point;for(var L=x[0]._x+2*x[1]._x,$=x[0]._y+2*x[1]._y,H=2,q=O-1,W=[L],Q=[$],K=[H],Y=[],ee=[],b=1;b<O;b++){var re=b<q,oe=re||C?1:2,le=re?4:C?2:7,Ie=re?4:C?3:8,Se=re?2:C?0:1,be=oe/H;H=K[b]=le-be,L=W[b]=Ie*x[b]._x+Se*x[b+1]._x-be*L,$=Q[b]=Ie*x[b]._y+Se*x[b+1]._y-be*$}Y[q]=W[q]/K[q],ee[q]=Q[q]/K[q];for(var b=O-2;b>=0;b--)Y[b]=(W[b]-Y[b+1])/K[b],ee[b]=(Q[b]-ee[b+1])/K[b];Y[O]=(3*x[O]._x-Y[q])/2,ee[O]=(3*x[O]._y-ee[q])/2;for(var b=N,We=O-D,M=I;b<=We;b++,M++){var $e=f[M<0?M+m:M],ze=$e._point,je=Y[b]-ze._x,Je=ee[b]-ze._y;(y||b<We)&&$e.setHandleOut(je,Je),(y||b>N)&&$e.setHandleIn(-je,-Je)}}else for(var b=I;b<=A;b++)f[b<0?b+m:b].smooth(c,!y&&b===I,!y&&b===A)},toShape:function(o){if(!this._closed)return null;var l=this._segments,c,d,f,m;function v(C,S){var k=l[C],O=k.getNext(),F=l[S],N=F.getNext();return k._handleOut.isZero()&&O._handleIn.isZero()&&F._handleOut.isZero()&&N._handleIn.isZero()&&O._point.subtract(k._point).isCollinear(N._point.subtract(F._point))}function p(C){var S=l[C],k=S.getPrevious(),O=S.getNext();return k._handleOut.isZero()&&S._handleIn.isZero()&&S._handleOut.isZero()&&O._handleIn.isZero()&&S._point.subtract(k._point).isOrthogonal(O._point.subtract(S._point))}function y(C){var S=l[C],k=S.getNext(),O=S._handleOut,F=k._handleIn,N=.5522847498307936;if(O.isOrthogonal(F)){var D=S._point,x=k._point,b=new Z(D,O,!0).intersect(new Z(x,F,!0),!0);return b&&w.isZero(O.getLength()/b.subtract(D).getLength()-N)&&w.isZero(F.getLength()/b.subtract(x).getLength()-N)}return!1}function I(C,S){return l[C]._point.getDistance(l[S]._point)}if(!this.hasHandles()&&l.length===4&&v(0,2)&&v(1,3)&&p(1)?(c=_e.Rectangle,d=new j(I(0,3),I(0,1)),m=l[1]._point.add(l[2]._point).divide(2)):l.length===8&&y(0)&&y(2)&&y(4)&&y(6)&&v(1,5)&&v(3,7)?(c=_e.Rectangle,d=new j(I(1,6),I(0,3)),f=d.subtract(new j(I(0,7),I(1,2))).divide(2),m=l[3]._point.add(l[4]._point).divide(2)):l.length===4&&y(0)&&y(1)&&y(2)&&y(3)&&(w.isZero(I(0,2)-I(1,3))?(c=_e.Circle,f=I(0,2)/2):(c=_e.Ellipse,f=new j(I(2,0)/2,I(3,1)/2)),m=l[1]._point),c){var A=this.getPosition(!0),P=new c({center:A,size:d,radius:f,insert:!1});return P.copyAttributes(this,!0),P._matrix.prepend(this._matrix),P.rotate(m.subtract(A).getAngle()+90),(o===n||o)&&P.insertAbove(this),P}return null},toPath:"#clone",compare:function o(l){if(!l||l instanceof De)return o.base.call(this,l);var c=this.getCurves(),d=l.getCurves(),f=c.length,m=d.length;if(!f||!m)return f==m;for(var v=c[0].getValues(),p=[],y=0,I,A=0,P,C=0;C<m;C++){var F=d[C].getValues();p.push(F);var S=he.getOverlaps(v,F);if(S){I=!C&&S[0][0]>0?m-1:C,P=S[0][1];break}}for(var k=Math.abs,O=1e-8,F=p[I],N;v&&F;){var S=he.getOverlaps(v,F);if(S){var D=S[0][0];if(k(D-A)<O){A=S[1][0],A===1&&(v=++y<f?c[y].getValues():null,A=0);var x=S[0][1];if(k(x-P)<O){if(N||(N=[I,x]),P=S[1][1],P===1&&(++I>=m&&(I=0),F=p[I]||d[I].getValues(),P=0),!v)return N[0]===I&&N[1]===P;continue}}}break}return!1},_hitTestSelf:function(o,l,c,d){var f=this,m=this.getStyle(),v=this._segments,p=v.length,y=this._closed,I=l._tolerancePadding,A=I,P,C,S,k,O,F,N=l.stroke&&m.hasStroke(),D=l.fill&&m.hasFill(),x=l.curves,b=N?m.getStrokeWidth()/2:D&&l.tolerance>0||x?0:null;b!==null&&(b>0?(P=m.getStrokeJoin(),C=m.getStrokeCap(),S=m.getMiterLimit(),A=A.add(Te._getStrokePadding(b,d))):P=C="round");function M(Y,ee){return o.subtract(Y).divide(ee).length<=1}function L(Y,ee,re){if(!l.selected||ee.isSelected()){var oe=Y._point;if(ee!==oe&&(ee=ee.add(oe)),M(ee,A))return new xe(re,f,{segment:Y,point:ee})}}function $(Y,ee){return(ee||l.segments)&&L(Y,Y._point,"segment")||!ee&&l.handles&&(L(Y,Y._handleIn,"handle-in")||L(Y,Y._handleOut,"handle-out"))}function H(Y){k.add(Y)}function q(Y){var ee=y||Y._index>0&&Y._index<p-1;if((ee?P:C)==="round")return M(Y._point,A);if(k=new Te({internal:!0,closed:!0}),ee?Y.isSmooth()||Te._addBevelJoin(Y,P,b,S,null,d,H,!0):C==="square"&&Te._addSquareCap(Y,C,b,null,d,H,!0),!k.isEmpty()){var re;return k.contains(o)||(re=k.getNearestLocation(o))&&M(re.getPoint(),I)}}if(l.ends&&!l.segments&&!y){if(F=$(v[0],!0)||$(v[p-1],!0))return F}else if(l.segments||l.handles){for(var W=0;W<p;W++)if(F=$(v[W]))return F}if(b!==null){if(O=this.getNearestLocation(o),O){var Q=O.getTime();Q===0||Q===1&&p>1?q(O.getSegment())||(O=null):M(O.getPoint(),A)||(O=null)}if(!O&&P==="miter"&&p>1)for(var W=0;W<p;W++){var K=v[W];if(o.getDistance(K._point)<=S*b&&q(K)){O=K.getLocation();break}}}return!O&&D&&this._contains(o)||O&&!N&&!x?new xe("fill",this):O?new xe(N?"stroke":"curve",this,{location:O,point:O.getPoint()}):null}},s.each(he._evaluateMethods,function(o){this[o+"At"]=function(l){var c=this.getLocationAt(l);return c&&c[o]()}},{beans:!1,getLocationOf:function(){for(var o=E.read(arguments),l=this.getCurves(),c=0,d=l.length;c<d;c++){var f=l[c].getLocationOf(o);if(f)return f}return null},getOffsetOf:function(){var o=this.getLocationOf.apply(this,arguments);return o?o.getOffset():null},getLocationAt:function(o){if(typeof o=="number"){for(var l=this.getCurves(),c=0,d=0,f=l.length;d<f;d++){var m=c,v=l[d];if(c+=v.getLength(),c>o)return v.getLocationAt(o-m)}if(l.length>0&&o<=this.getLength())return new it(l[l.length-1],1)}else if(o&&o.getPath&&o.getPath()===this)return o;return null},getOffsetsWithTangent:function(){var o=E.read(arguments);if(o.isZero())return[];for(var l=[],c=0,d=this.getCurves(),f=0,m=d.length;f<m;f++){for(var v=d[f],p=v.getTimesWithTangent(o),y=0,I=p.length;y<I;y++){var A=c+v.getOffsetAtTime(p[y]);l.indexOf(A)<0&&l.push(A)}c+=v.length}return l}}),new function(){function o(c,d,f,m){if(m<=0)return;var v=m/2,p=m-2,y=v-1,I=new Array(6),A,P;function C(D){var x=I[D],b=I[D+1];(A!=x||P!=b)&&(c.beginPath(),c.moveTo(A,P),c.lineTo(x,b),c.stroke(),c.beginPath(),c.arc(x,b,v,0,Math.PI*2,!0),c.fill())}for(var S=0,k=d.length;S<k;S++){var O=d[S],F=O._selection;if(O._transformCoordinates(f,I),A=I[0],P=I[1],F&2&&C(2),F&4&&C(4),c.fillRect(A-v,P-v,m,m),p>0&&!(F&1)){var N=c.fillStyle;c.fillStyle="#ffffff",c.fillRect(A-y,P-y,p,p),c.fillStyle=N}}}function l(c,d,f){var m=d._segments,v=m.length,p=new Array(6),y=!0,I,A,P,C,S,k,O,F;function N(x){if(f)x._transformCoordinates(f,p),I=p[0],A=p[1];else{var b=x._point;I=b._x,A=b._y}if(y)c.moveTo(I,A),y=!1;else{if(f)S=p[2],k=p[3];else{var M=x._handleIn;S=I+M._x,k=A+M._y}S===I&&k===A&&O===P&&F===C?c.lineTo(I,A):c.bezierCurveTo(O,F,S,k,I,A)}if(P=I,C=A,f)O=p[4],F=p[5];else{var M=x._handleOut;O=P+M._x,F=C+M._y}}for(var D=0;D<v;D++)N(m[D]);d._closed&&v>0&&N(m[0])}return{_draw:function(c,d,f,m){var v=d.dontStart,p=d.dontFinish||d.clip,y=this.getStyle(),I=y.hasFill(),A=y.hasStroke(),P=y.getDashArray(),C=!de.support.nativeDash&&A&&P&&P.length;v||c.beginPath(),(I||A&&!C||p)&&(l(c,this,m),this._closed&&c.closePath());function S(x){return P[(x%C+C)%C]}if(!p&&(I||A)&&(this._setStyles(c,d,f),I&&(c.fill(y.getFillRule()),c.shadowColor="rgba(0,0,0,0)"),A)){if(C){v||c.beginPath();for(var k=new Qe(this,.25,32,!1,m),O=k.length,F=-y.getDashOffset(),N,D=0;F>0;)F-=S(D--)+S(D--);for(;F<O;)N=F+S(D++),(F>0||N>0)&&k.drawPart(c,Math.max(F,0),Math.max(N,0)),F=N+S(D++)}c.stroke()}},_drawSelected:function(c,d){c.beginPath(),l(c,this,d),c.stroke(),o(c,this._segments,d,de.settings.handleSize)}}},new function(){function o(l){var c=l._segments;if(!c.length)throw new Error("Use a moveTo() command first");return c[c.length-1]}return{moveTo:function(){var l=this._segments;l.length===1&&this.removeSegment(0),l.length||this._add([new we(E.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new we(E.read(arguments))])},cubicCurveTo:function(){var l=arguments,c=E.read(l),d=E.read(l),f=E.read(l),m=o(this);m.setHandleOut(c.subtract(m._point)),this._add([new we(f,d.subtract(f))])},quadraticCurveTo:function(){var l=arguments,c=E.read(l),d=E.read(l),f=o(this)._point;this.cubicCurveTo(c.add(f.subtract(c).multiply(1/3)),c.add(d.subtract(c).multiply(1/3)),d)},curveTo:function(){var l=arguments,c=E.read(l),d=E.read(l),f=s.pick(s.read(l),.5),m=1-f,v=o(this)._point,p=c.subtract(v.multiply(m*m)).subtract(d.multiply(f*f)).divide(2*f*m);if(p.isNaN())throw new Error("Cannot put a curve through points with parameter = "+f);this.quadraticCurveTo(p,d)},arcTo:function(){var l=arguments,c=Math.abs,d=Math.sqrt,f=o(this),m=f._point,v=E.read(l),p,y=s.peek(l),I=s.pick(y,!0),A,P,C,S;if(typeof I=="boolean")var k=m.add(v).divide(2),p=k.add(k.subtract(m).rotate(I?-90:90));else if(s.remain(l)<=2)p=v,v=E.read(l);else if(!m.equals(v)){var O=j.read(l),F=w.isZero;if(F(O.width)||F(O.height))return this.lineTo(v);var N=s.read(l),I=!!s.read(l),D=!!s.read(l),k=m.add(v).divide(2),x=m.subtract(k).rotate(-N),b=x.x,M=x.y,L=c(O.width),$=c(O.height),H=L*L,q=$*$,W=b*b,Q=M*M,K=d(W/H+Q/q);if(K>1&&(L*=K,$*=K,H=L*L,q=$*$),K=(H*q-H*Q-q*W)/(H*Q+q*W),c(K)<1e-12&&(K=0),K<0)throw new Error("Cannot create an arc with the given arguments");A=new E(L*M/$,-$*b/L).multiply((D===I?-1:1)*d(K)).rotate(N).add(k),S=new U().translate(A).rotate(N).scale(L,$),C=S._inverseTransform(m),P=C.getDirectedAngle(S._inverseTransform(v)),!I&&P>0?P-=360:I&&P<0&&(P+=360)}if(p){var Y=new Z(m.add(p).divide(2),p.subtract(m).rotate(90),!0),ee=new Z(p.add(v).divide(2),v.subtract(p).rotate(90),!0),re=new Z(m,v),oe=re.getSide(p);if(A=Y.intersect(ee,!0),!A){if(!oe)return this.lineTo(v);throw new Error("Cannot create an arc with the given arguments")}C=m.subtract(A),P=C.getDirectedAngle(v.subtract(A));var le=re.getSide(A,!0);le===0?P=oe*c(P):oe===le&&(P+=P<0?360:-360)}if(P){for(var Ie=1e-5,Se=c(P),be=Se>=360?4:Math.ceil((Se-Ie)/90),We=P/be,$e=We*Math.PI/360,ze=4/3*Math.sin($e)/(1+Math.cos($e)),je=[],Je=0;Je<=be;Je++){var x=v,Ge=null;if(Je<be&&(Ge=C.rotate(90).multiply(ze),S?(x=S._transformPoint(C),Ge=S._transformPoint(C.add(Ge)).subtract(x)):x=A.add(C)),!Je)f.setHandleOut(Ge);else{var yt=C.rotate(-90).multiply(ze);S&&(yt=S._transformPoint(C.add(yt)).subtract(x)),je.push(new we(x,yt,Ge))}C=C.rotate(We)}this._add(je)}},lineBy:function(){var l=E.read(arguments),c=o(this)._point;this.lineTo(c.add(l))},curveBy:function(){var l=arguments,c=E.read(l),d=E.read(l),f=s.read(l),m=o(this)._point;this.curveTo(m.add(c),m.add(d),f)},cubicCurveBy:function(){var l=arguments,c=E.read(l),d=E.read(l),f=E.read(l),m=o(this)._point;this.cubicCurveTo(m.add(c),m.add(d),m.add(f))},quadraticCurveBy:function(){var l=arguments,c=E.read(l),d=E.read(l),f=o(this)._point;this.quadraticCurveTo(f.add(c),f.add(d))},arcBy:function(){var l=arguments,c=o(this)._point,d=c.add(E.read(l)),f=s.pick(s.peek(l),!0);typeof f=="boolean"?this.arcTo(d,f):this.arcTo(d,c.add(E.read(l)))},closePath:function(l){this.setClosed(!0),this.join(this,l)}}},{_getBounds:function(o,l){var c=l.handle?"getHandleBounds":l.stroke?"getStrokeBounds":"getBounds";return Te[c](this._segments,this._closed,this,o,l)},statics:{getBounds:function(o,l,c,d,f,m){var v=o[0];if(!v)return new V;var p=new Array(6),y=v._transformCoordinates(d,new Array(6)),I=y.slice(0,2),A=I.slice(),P=new Array(2);function C(O){O._transformCoordinates(d,p);for(var F=0;F<2;F++)he._addBounds(y[F],y[F+4],p[F+2],p[F],F,m?m[F]:0,I,A,P);var N=y;y=p,p=N}for(var S=1,k=o.length;S<k;S++)C(o[S]);return l&&C(v),new V(I[0],I[1],A[0]-I[0],A[1]-I[1])},getStrokeBounds:function(o,l,c,d,f){var m=c.getStyle(),v=m.hasStroke(),p=m.getStrokeWidth(),y=v&&c._getStrokeMatrix(d,f),I=v&&Te._getStrokePadding(p,y),A=Te.getBounds(o,l,c,d,f,I);if(!v)return A;var P=p/2,C=m.getStrokeJoin(),S=m.getStrokeCap(),k=m.getMiterLimit(),O=new V(new j(I));function F(L){A=A.include(L)}function N(L){A=A.unite(O.setCenter(L._point.transform(d)))}function D(L,$){$==="round"||L.isSmooth()?N(L):Te._addBevelJoin(L,$,P,k,d,y,F)}function x(L,$){$==="round"?N(L):Te._addSquareCap(L,$,P,d,y,F)}var b=o.length-(l?0:1);if(b>0){for(var M=1;M<b;M++)D(o[M],C);l?D(o[0],C):(x(o[0],S),x(o[o.length-1],S))}return A},_getStrokePadding:function(o,l){if(!l)return[o,o];var c=new E(o,0).transform(l),d=new E(0,o).transform(l),f=c.getAngleInRadians(),m=c.getLength(),v=d.getLength(),p=Math.sin(f),y=Math.cos(f),I=Math.tan(f),A=Math.atan2(v*I,m),P=Math.atan2(v,I*m);return[Math.abs(m*Math.cos(A)*y+v*Math.sin(A)*p),Math.abs(v*Math.sin(P)*y+m*Math.cos(P)*p)]},_addBevelJoin:function(o,l,c,d,f,m,v,p){var y=o.getCurve(),I=y.getPrevious(),A=y.getPoint1().transform(f),P=I.getNormalAtTime(1).multiply(c).transform(m),C=y.getNormalAtTime(0).multiply(c).transform(m),S=P.getDirectedAngle(C);if((S<0||S>=180)&&(P=P.negate(),C=C.negate()),p&&v(A),v(A.add(P)),l==="miter"){var k=new Z(A.add(P),new E(-P.y,P.x),!0).intersect(new Z(A.add(C),new E(-C.y,C.x),!0),!0);k&&A.getDistance(k)<=d*c&&v(k)}v(A.add(C))},_addSquareCap:function(o,l,c,d,f,m,v){var p=o._point.transform(d),y=o.getLocation(),I=y.getNormal().multiply(y.getTime()===0?c:-c).transform(f);l==="square"&&(v&&(m(p.subtract(I)),m(p.add(I))),p=p.add(I.rotate(-90))),m(p.add(I)),m(p.subtract(I))},getHandleBounds:function(o,l,c,d,f){var m=c.getStyle(),v=f.stroke&&m.hasStroke(),p,y;if(v){var I=c._getStrokeMatrix(d,f),A=m.getStrokeWidth()/2,P=A;m.getStrokeJoin()==="miter"&&(P=A*m.getMiterLimit()),m.getStrokeCap()==="square"&&(P=Math.max(P,A*Math.SQRT2)),p=Te._getStrokePadding(A,I),y=Te._getStrokePadding(P,I)}for(var C=new Array(6),S=1/0,k=-S,O=S,F=k,N=0,D=o.length;N<D;N++){var x=o[N];x._transformCoordinates(d,C);for(var b=0;b<6;b+=2){var M=b?p:y,L=M?M[0]:0,$=M?M[1]:0,H=C[b],q=C[b+1],W=H-L,Q=H+L,K=q-$,Y=q+$;W<S&&(S=W),Q>k&&(k=Q),K<O&&(O=K),Y>F&&(F=Y)}}return new V(S,O,k-S,F-O)}}});Te.inject({statics:new function(){var o=.5522847498307936,l=[new we([-1,0],[0,o],[0,-o]),new we([0,-1],[-o,0],[o,0]),new we([1,0],[0,-o],[0,o]),new we([0,1],[o,0],[-o,0])];function c(f,m,v){var p=s.getNamed(v),y=new Te(p&&(p.insert==!0?te.INSERT:p.insert==!1?te.NO_INSERT:null));return y._add(f),y._closed=m,y.set(p,te.INSERT)}function d(f,m,v){for(var p=new Array(4),y=0;y<4;y++){var I=l[y];p[y]=new we(I._point.multiply(m).add(f),I._handleIn.multiply(m),I._handleOut.multiply(m))}return c(p,!0,v)}return{Line:function(){var f=arguments;return c([new we(E.readNamed(f,"from")),new we(E.readNamed(f,"to"))],!1,f)},Circle:function(){var f=arguments,m=E.readNamed(f,"center"),v=s.readNamed(f,"radius");return d(m,new j(v),f)},Rectangle:function(){var f=arguments,m=V.readNamed(f,"rectangle"),v=j.readNamed(f,"radius",0,{readNull:!0}),p=m.getBottomLeft(!0),y=m.getTopLeft(!0),I=m.getTopRight(!0),A=m.getBottomRight(!0),P;if(!v||v.isZero())P=[new we(p),new we(y),new we(I),new we(A)];else{v=j.min(v,m.getSize(!0).divide(2));var C=v.width,S=v.height,k=C*o,O=S*o;P=[new we(p.add(C,0),null,[-k,0]),new we(p.subtract(0,S),[0,O]),new we(y.add(0,S),null,[0,-O]),new we(y.add(C,0),[-k,0],null),new we(I.subtract(C,0),null,[k,0]),new we(I.add(0,S),[0,-O],null),new we(A.subtract(0,S),null,[0,O]),new we(A.subtract(C,0),[k,0])]}return c(P,!0,f)},RoundRectangle:"#Rectangle",Ellipse:function(){var f=arguments,m=_e._readEllipse(f);return d(m.center,m.radius,f)},Oval:"#Ellipse",Arc:function(){var f=arguments,m=E.readNamed(f,"from"),v=E.readNamed(f,"through"),p=E.readNamed(f,"to"),y=s.getNamed(f),I=new Te(y&&y.insert==!1&&te.NO_INSERT);return I.moveTo(m),I.arcTo(v,p),I.set(y)},RegularPolygon:function(){for(var f=arguments,m=E.readNamed(f,"center"),v=s.readNamed(f,"sides"),p=s.readNamed(f,"radius"),y=360/v,I=v%3===0,A=new E(0,I?-p:p),P=I?-1:.5,C=new Array(v),S=0;S<v;S++)C[S]=new we(m.add(A.rotate((S+P)*y)));return c(C,!0,f)},Star:function(){for(var f=arguments,m=E.readNamed(f,"center"),v=s.readNamed(f,"points")*2,p=s.readNamed(f,"radius1"),y=s.readNamed(f,"radius2"),I=360/v,A=new E(0,-1),P=new Array(v),C=0;C<v;C++)P[C]=new we(m.add(A.rotate(I*C).multiply(C%2?y:p)));return c(P,!0,f)}}}});var De=Ce.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(l){this._children=[],this._namedChildren={},this._initialize(l)||(typeof l=="string"?this.setPathData(l):this.addChildren(Array.isArray(l)?l:arguments))},insertChildren:function o(l,c){var d=c,f=d[0];f&&typeof f[0]=="number"&&(d=[d]);for(var m=c.length-1;m>=0;m--){var v=d[m];d===c&&!(v instanceof Te)&&(d=s.slice(d)),Array.isArray(v)?d[m]=new Te({segments:v,insert:!1}):v instanceof De&&(d.splice.apply(d,[m,1].concat(v.removeChildren())),v.remove())}return o.base.call(this,l,d)},reduce:function o(l){for(var c=this._children,d=c.length-1;d>=0;d--){var f=c[d].reduce(l);f.isEmpty()&&f.remove()}if(!c.length){var f=new Te(te.NO_INSERT);return f.copyAttributes(this),f.insertAbove(this),this.remove(),f}return o.base.call(this)},isClosed:function(){for(var o=this._children,l=0,c=o.length;l<c;l++)if(!o[l]._closed)return!1;return!0},setClosed:function(o){for(var l=this._children,c=0,d=l.length;c<d;c++)l[c].setClosed(o)},getFirstSegment:function(){var o=this.getFirstChild();return o&&o.getFirstSegment()},getLastSegment:function(){var o=this.getLastChild();return o&&o.getLastSegment()},getCurves:function(){for(var o=this._children,l=[],c=0,d=o.length;c<d;c++)s.push(l,o[c].getCurves());return l},getFirstCurve:function(){var o=this.getFirstChild();return o&&o.getFirstCurve()},getLastCurve:function(){var o=this.getLastChild();return o&&o.getLastCurve()},getArea:function(){for(var o=this._children,l=0,c=0,d=o.length;c<d;c++)l+=o[c].getArea();return l},getLength:function(){for(var o=this._children,l=0,c=0,d=o.length;c<d;c++)l+=o[c].getLength();return l},getPathData:function(o,l){for(var c=this._children,d=[],f=0,m=c.length;f<m;f++){var v=c[f],p=v._matrix;d.push(v.getPathData(o&&!p.isIdentity()?o.appended(p):o,l))}return d.join("")},_hitTestChildren:function o(l,c,d){return o.base.call(this,l,c.class===Te||c.type==="path"?c:s.set({},c,{fill:!1}),d)},_draw:function(o,l,c,d){var f=this._children;if(f.length){l=l.extend({dontStart:!0,dontFinish:!0}),o.beginPath();for(var m=0,v=f.length;m<v;m++)f[m].draw(o,l,d);if(!l.clip){this._setStyles(o,l,c);var p=this._style;p.hasFill()&&(o.fill(p.getFillRule()),o.shadowColor="rgba(0,0,0,0)"),p.hasStroke()&&o.stroke()}}},_drawSelected:function(o,l,c){for(var d=this._children,f=0,m=d.length;f<m;f++){var v=d[f],p=v._matrix;c[v._id]||v._drawSelected(o,p.isIdentity()?l:l.appended(p))}}},new function(){function o(l,c){var d=l._children;if(c&&!d.length)throw new Error("Use a moveTo() command first");return d[d.length-1]}return s.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(l){this[l]=function(){var c=o(this,!0);c[l].apply(c,arguments)}},{moveTo:function(){var l=o(this),c=l&&l.isEmpty()?l:new Te(te.NO_INSERT);c!==l&&this.addChild(c),c.moveTo.apply(c,arguments)},moveBy:function(){var l=o(this,!0),c=l&&l.getLastSegment(),d=E.read(arguments);this.moveTo(c?d.add(c._point):d)},closePath:function(l){o(this,!0).closePath(l)}})},s.each(["reverse","flatten","simplify","smooth"],function(o){this[o]=function(l){for(var c=this._children,d,f=0,m=c.length;f<m;f++)d=c[f][o](l)||d;return d}},{}));Ce.inject(new function(){var o=Math.min,l=Math.max,c=Math.abs,d={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function f(N){return N._children||[N]}function m(N,D){var x=N.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(D){for(var b=f(x),M=0,L=b.length;M<L;M++){var N=b[M];!N._closed&&!N.isEmpty()&&(N.closePath(1e-12),N.getFirstSegment().setHandleIn(0,0),N.getLastSegment().setHandleOut(0,0))}x=x.resolveCrossings().reorient(x.getFillRule()==="nonzero",!0)}return x}function v(N,D,x,b,M){var L=new De(te.NO_INSERT);return L.addChildren(N,!0),L=L.reduce({simplify:D}),M&&M.insert==!1||L.insertAbove(b&&x.isSibling(b)&&x.getIndex()<b.getIndex()?b:x),L.copyAttributes(x,!0),L}function p(N){return N.hasOverlap()||N.isCrossing()}function y(N,D,x,b){if(b&&(b.trace==!1||b.stroke)&&/^(subtract|intersect)$/.test(x))return I(N,D,x);var M=m(N,!0),L=D&&N!==D&&m(D,!0),$=d[x];$[x]=!0,L&&($.subtract||$.exclude)^(L.isClockwise()^M.isClockwise())&&L.reverse();var H=S(it.expand(M.getIntersections(L,p))),q=f(M),W=L&&f(L),Q=[],K=[],Y;function ee(Ge){for(var yt=0,st=Ge.length;yt<st;yt++){var ht=Ge[yt];s.push(Q,ht._segments),s.push(K,ht.getCurves()),ht._overlapsOnly=!0}}function re(Ge){for(var yt=[],st=0,ht=Ge&&Ge.length;st<ht;st++)yt.push(K[Ge[st]]);return yt}if(H.length){ee(q),W&&ee(W);for(var oe=new Array(K.length),le=0,Ie=K.length;le<Ie;le++)oe[le]=K[le].getValues();for(var Se=g.findCurveBoundsCollisions(oe,oe,0,!0),be={},le=0;le<K.length;le++){var We=K[le],$e=We._path._id,ze=be[$e]=be[$e]||{};ze[We.getIndex()]={hor:re(Se[le].hor),ver:re(Se[le].ver)}}for(var le=0,Ie=H.length;le<Ie;le++)O(H[le]._segment,M,L,be,$);for(var le=0,Ie=Q.length;le<Ie;le++){var je=Q[le],Je=je._intersection;je._winding||O(je,M,L,be,$),Je&&Je._overlap||(je._path._overlapsOnly=!1)}Y=F(Q,$)}else Y=C(W?q.concat(W):q.slice(),function(Ge){return!!$[Ge]});return v(Y,!0,N,D,b)}function I(N,D,x){var b=m(N),M=m(D),L=b.getIntersections(M,p),$=x==="subtract",H=x==="divide",q={},W=[];function Q(ee){if(!q[ee._id]&&(H||M.contains(ee.getPointAt(ee.getLength()/2))^$))return W.unshift(ee),q[ee._id]=!0}for(var K=L.length-1;K>=0;K--){var Y=L[K].split();Y&&(Q(Y)&&Y.getFirstSegment().setHandleIn(0,0),b.getLastSegment().setHandleOut(0,0))}return Q(b),v(W,!1,N,D)}function A(N,D){for(var x=N;x;){if(x===D)return;x=x._previous}for(;N._next&&N._next!==D;)N=N._next;if(!N._next){for(;D._previous;)D=D._previous;N._next=D,D._previous=N}}function P(N){for(var D=N.length-1;D>=0;D--)N[D].clearHandles()}function C(N,D,x){var b=N&&N.length;if(b){var M=s.each(N,function(Se,be){this[Se._id]={container:null,winding:Se.isClockwise()?1:-1,index:be}},{}),L=N.slice().sort(function(Se,be){return c(be.getArea())-c(Se.getArea())}),$=L[0],H=g.findItemBoundsCollisions(L,null,w.GEOMETRIC_EPSILON);x==null&&(x=$.isClockwise());for(var q=0;q<b;q++){var W=L[q],Q=M[W._id],K=0,Y=H[q];if(Y){for(var ee=null,re=Y.length-1;re>=0;re--)if(Y[re]<q){ee=ee||W.getInteriorPoint();var oe=L[Y[re]];if(oe.contains(ee)){var le=M[oe._id];K=le.winding,Q.winding+=K,Q.container=le.exclude?le.container:oe;break}}}if(D(Q.winding)===D(K))Q.exclude=!0,N[Q.index]=null;else{var Ie=Q.container;W.setClockwise(Ie?!Ie.isClockwise():x)}}}return N}function S(N,D,x){var b=D&&[],M=1e-8,L=1-M,$=!1,H=x||[],q=x&&{},W,Q,K;function Y(yt){return yt._path._id+"."+yt._segment1._index}for(var ee=(x&&x.length)-1;ee>=0;ee--){var re=x[ee];re._path&&(q[Y(re)]=!0)}for(var ee=N.length-1;ee>=0;ee--){var oe=N[ee],le=oe._time,Ie=le,Se=D&&!D(oe),re=oe._curve,be;if(re&&(re!==Q?($=!re.hasHandles()||q&&q[Y(re)],W=[],K=null,Q=re):K>=M&&(le/=K)),Se){W&&W.push(oe);continue}else D&&b.unshift(oe);if(K=Ie,le<M)be=re._segment1;else if(le>L)be=re._segment2;else{var We=re.divideAtTime(le,!0);$&&H.push(re,We),be=We._segment1;for(var $e=W.length-1;$e>=0;$e--){var ze=W[$e];ze._time=(ze._time-le)/(1-le)}}oe._setSegment(be);var je=be._intersection,Je=oe._intersection;if(je){A(je,Je);for(var Ge=je;Ge;)A(Ge._intersection,je),Ge=Ge._next}else be._intersection=Je}return x||P(H),b||N}function k(N,D,x,b,M){var L=Array.isArray(D)?D:D[x?"hor":"ver"],$=x?1:0,H=$^1,q=[N.x,N.y],W=q[$],Q=q[H],K=1e-9,Y=1e-6,ee=W-K,re=W+K,oe=0,le=0,Ie=0,Se=0,be=!1,We=!1,$e=1,ze=[],je,Je;function Ge(bt){var In=bt[H+0],ai=bt[H+6];if(!(Q<o(In,ai)||Q>l(In,ai))){var qn=bt[$+0],Rs=bt[$+2],Tu=bt[$+4],ks=bt[$+6];if(In===ai){(qn<re&&ks>ee||ks<re&&qn>ee)&&(be=!0);return}var Bo=Q===In?0:Q===ai||ee>l(qn,Rs,Tu,ks)||re<o(qn,Rs,Tu,ks)?1:he.solveCubic(bt,H,Q,ze,0,1)>0?ze[0]:1,li=Bo===0?qn:Bo===1?ks:he.getPoint(bt,Bo)[x?"y":"x"],Si=In>ai?1:-1,sd=je[H]>je[H+6]?1:-1,Uo=je[$+6];return Q!==In?(li<ee?Ie+=Si:li>re?Se+=Si:be=!0,li>W-Y&&li<W+Y&&($e/=2)):(Si!==sd?qn<ee?Ie+=Si:qn>re&&(Se+=Si):qn!=Uo&&(Uo<re&&li>re?(Se+=Si,be=!0):Uo>ee&&li<ee&&(Ie+=Si,be=!0)),$e/=4),je=bt,!M&&li>ee&&li<re&&he.getTangent(bt,Bo)[x?"x":"y"]===0&&k(N,D,!x,b,!0)}}function yt(bt){var In=bt[H+0],ai=bt[H+2],qn=bt[H+4],Rs=bt[H+6];if(Q<=l(In,ai,qn,Rs)&&Q>=o(In,ai,qn,Rs)){for(var Tu=bt[$+0],ks=bt[$+2],Bo=bt[$+4],li=bt[$+6],Si=ee>l(Tu,ks,Bo,li)||re<o(Tu,ks,Bo,li)?[bt]:he.getMonoCurves(bt,x),sd,Uo=0,_2=Si.length;Uo<_2;Uo++)if(sd=Ge(Si[Uo]))return sd}}for(var st=0,ht=L.length;st<ht;st++){var mt=L[st],at=mt._path,$n=mt.getValues(),Hn;if((!st||L[st-1]._path!==at)&&(je=null,at._closed||(Je=he.getValues(at.getLastCurve().getSegment2(),mt.getSegment1(),null,!b),Je[H]!==Je[H+6]&&(je=Je)),!je)){je=$n;for(var pr=at.getLastCurve();pr&&pr!==mt;){var wn=pr.getValues();if(wn[H]!==wn[H+6]){je=wn;break}pr=pr.getPrevious()}}if(Hn=yt($n))return Hn;if(st+1===ht||L[st+1]._path!==at){if(Je&&(Hn=yt(Je)))return Hn;be&&!Ie&&!Se&&(Ie=Se=at.isClockwise(b)^x?1:-1),oe+=Ie,le+=Se,Ie=Se=0,be&&(We=!0,be=!1),Je=null}}return oe=c(oe),le=c(le),{winding:l(oe,le),windingL:oe,windingR:le,quality:$e,onPath:We}}function O(N,D,x,b,M){var L=[],$=N,H=0,K;do{var q=N.getCurve();if(q){var W=q.getLength();L.push({segment:N,curve:q,length:W}),H+=W}N=N.getNext()}while(N&&!N._intersection&&N!==$);for(var Q=[.5,.25,.75],K={winding:0,quality:-1},Y=.001,ee=1-Y,re=0;re<Q.length&&K.quality<.5;re++)for(var W=H*Q[re],oe=0,le=L.length;oe<le;oe++){var Ie=L[oe],Se=Ie.length;if(W<=Se){var q=Ie.curve,be=q._path,We=be._parent,$e=We instanceof De?We:be,ze=w.clamp(q.getTimeAt(W),Y,ee),je=q.getPointAtTime(ze),Je=c(q.getTangentAtTime(ze).y)<Math.SQRT1_2,Ge=null;if(M.subtract&&x){var yt=$e===D?x:D,st=yt._getWinding(je,Je,!0);if($e===D&&st.winding||$e===x&&!st.winding){if(st.quality<1)continue;Ge={winding:0,quality:1}}}Ge=Ge||k(je,b[be._id][q.getIndex()],Je,!0),Ge.quality>K.quality&&(K=Ge);break}W-=Se}for(var oe=L.length-1;oe>=0;oe--)L[oe].segment._winding=K}function F(N,D){var x=[],b;function M(ht){var mt;return!!(ht&&!ht._visited&&(!D||D[(mt=ht._winding||{}).winding]&&!(D.unite&&mt.winding===2&&mt.windingL&&mt.windingR)))}function L(ht){if(ht){for(var mt=0,at=b.length;mt<at;mt++)if(ht===b[mt])return!0}return!1}function $(ht){for(var mt=ht._segments,at=0,$n=mt.length;at<$n;at++)mt[at]._visited=!0}function H(ht,mt){var at=ht._intersection,$n=at,Hn=[];mt&&(b=[ht]);function pr(wn,bt){for(;wn&&wn!==bt;){var In=wn._segment,ai=In&&In._path;if(ai){var qn=In.getNext()||ai.getFirstSegment(),Rs=qn._intersection;In!==ht&&(L(In)||L(qn)||qn&&M(In)&&(M(qn)||Rs&&M(Rs._segment)))&&Hn.push(In),mt&&b.push(In)}wn=wn._next}}if(at){for(pr(at);at&&at._previous;)at=at._previous;pr(at,$n)}return Hn}N.sort(function(ht,mt){var at=ht._intersection,$n=mt._intersection,Hn=!!(at&&at._overlap),pr=!!($n&&$n._overlap),wn=ht._path,bt=mt._path;return Hn^pr?Hn?1:-1:!at^!$n?at?1:-1:wn!==bt?wn._id-bt._id:ht._index-mt._index});for(var q=0,W=N.length;q<W;q++){var Q=N[q],K=M(Q),Y=null,ee=!1,re=!0,oe=[],le,Ie,Se;if(K&&Q._path._overlapsOnly){var be=Q._path,We=Q._intersection._segment._path;be.compare(We)&&(be.getArea()&&x.push(be.clone(!1)),$(be),$(We),K=!1)}for(;K;){var $e=!Y,ze=H(Q,$e),je=ze.shift(),ee=!$e&&(L(Q)||L(je)),Je=!ee&&je;if($e&&(Y=new Te(te.NO_INSERT),le=null),ee){(Q.isFirst()||Q.isLast())&&(re=Q._path._closed),Q._visited=!0;break}if(Je&&le&&(oe.push(le),le=null),le||(Je&&ze.push(Q),le={start:Y._segments.length,crossings:ze,visited:Ie=[],handleIn:Se}),Je&&(Q=je),!M(Q)){Y.removeSegments(le.start);for(var Ge=0,yt=Ie.length;Ge<yt;Ge++)Ie[Ge]._visited=!1;Ie.length=0;do Q=le&&le.crossings.shift(),(!Q||!Q._path)&&(Q=null,le=oe.pop(),le&&(Ie=le.visited,Se=le.handleIn));while(le&&!M(Q));if(!Q)break}var st=Q.getNext();Y.add(new we(Q._point,Se,st&&Q._handleOut)),Q._visited=!0,Ie.push(Q),Q=st||Q._path.getFirstSegment(),Se=st&&st._handleIn}ee&&(re&&(Y.getFirstSegment().setHandleIn(Se),Y.setClosed(re)),Y.getArea()!==0&&x.push(Y))}return x}return{_getWinding:function(N,D,x){return k(N,this.getCurves(),D,x)},unite:function(N,D){return y(this,N,"unite",D)},intersect:function(N,D){return y(this,N,"intersect",D)},subtract:function(N,D){return y(this,N,"subtract",D)},exclude:function(N,D){return y(this,N,"exclude",D)},divide:function(N,D){return D&&(D.trace==!1||D.stroke)?I(this,N,"divide"):v([this.subtract(N,D),this.intersect(N,D)],!0,this,N,D)},resolveCrossings:function(){var N=this._children,D=N||[this];function x(le,Ie){var Se=le&&le._intersection;return Se&&Se._overlap&&Se._path===Ie}var b=!1,M=!1,L=this.getIntersections(null,function(le){return le.hasOverlap()&&(b=!0)||le.isCrossing()&&(M=!0)}),$=b&&M&&[];if(L=it.expand(L),b)for(var H=S(L,function(le){return le.hasOverlap()},$),q=H.length-1;q>=0;q--){var W=H[q],Q=W._path,K=W._segment,Y=K.getPrevious(),ee=K.getNext();x(Y,Q)&&x(ee,Q)&&(K.remove(),Y._handleOut._set(0,0),ee._handleIn._set(0,0),Y!==K&&!Y.getCurve().hasLength()&&(ee._handleIn.set(Y._handleIn),Y.remove()))}M&&(S(L,b&&function(le){var Ie=le.getCurve(),Se=le.getSegment(),be=le._intersection,We=be._curve,$e=be._segment;if(Ie&&We&&Ie._path&&We._path)return!0;Se&&(Se._intersection=null),$e&&($e._intersection=null)},$),$&&P($),D=F(s.each(D,function(le){s.push(this,le._segments)},[])));var re=D.length,oe;return re>1&&N?(D!==N&&this.setChildren(D),oe=this):re===1&&!N&&(D[0]!==this&&this.setSegments(D[0].removeSegments()),oe=this),oe||(oe=new De(te.NO_INSERT),oe.addChildren(D),oe=oe.reduce(),oe.copyAttributes(this),this.replaceWith(oe)),oe},reorient:function(N,D){var x=this._children;return x&&x.length?this.setChildren(C(this.removeChildren(),function(b){return!!(N?b:b&1)},D)):D!==n&&this.setClockwise(D),this},getInteriorPoint:function(){var N=this.getBounds(),D=N.getCenter(!0);if(!this.contains(D)){for(var x=this.getCurves(),b=D.y,M=[],L=[],$=0,H=x.length;$<H;$++){var q=x[$].getValues(),W=q[1],Q=q[3],K=q[5],Y=q[7];if(b>=o(W,Q,K,Y)&&b<=l(W,Q,K,Y))for(var ee=he.getMonoCurves(q),re=0,oe=ee.length;re<oe;re++){var le=ee[re],Ie=le[1],Se=le[7];if(Ie!==Se&&(b>=Ie&&b<=Se||b>=Se&&b<=Ie)){var be=b===Ie?le[0]:b===Se?le[6]:he.solveCubic(le,1,b,L,0,1)===1?he.getPoint(le,L[0]).x:(le[0]+le[6])/2;M.push(be)}}}M.length>1&&(M.sort(function(We,$e){return We-$e}),D.x=(M[0]+M[1])/2)}return D}}});var Qe=s.extend({_class:"PathFlattener",initialize:function(o,l,c,d,f){var m=[],v=[],p=0,y=1/(c||32),I=o._segments,A=I[0],P;function C(F,N){var D=he.getValues(F,N,f);m.push(D),S(D,F._index,0,1)}function S(F,N,D,x){if(x-D>y&&!(d&&he.isStraight(F))&&!he.isFlatEnough(F,l||.25)){var b=he.subdivide(F,.5),M=(D+x)/2;S(b[0],N,D,M),S(b[1],N,M,x)}else{var L=F[6]-F[0],$=F[7]-F[1],H=Math.sqrt(L*L+$*$);H>0&&(p+=H,v.push({offset:p,curve:F,index:N,time:x}))}}for(var k=1,O=I.length;k<O;k++)P=I[k],C(A,P),A=P;o._closed&&C(P||A,I[0]),this.curves=m,this.parts=v,this.length=p,this.index=0},_get:function(o){for(var l=this.parts,c=l.length,d,f=this.index;d=f,!(!f||l[--f].offset<o););for(;d<c;d++){var m=l[d];if(m.offset>=o){this.index=d;var v=l[d-1],p=v&&v.index===m.index?v.time:0,y=v?v.offset:0;return{index:m.index,time:p+(m.time-p)*(o-y)/(m.offset-y)}}}return{index:l[c-1].index,time:1}},drawPart:function(o,l,c){for(var d=this._get(l),f=this._get(c),m=d.index,v=f.index;m<=v;m++){var p=he.getPart(this.curves[m],m===d.index?d.time:0,m===f.index?f.time:1);m===d.index&&o.moveTo(p[0],p[1]),o.bezierCurveTo.apply(o,p.slice(2))}}},s.each(he._evaluateMethods,function(o){this[o+"At"]=function(l){var c=this._get(l);return he[o](this.curves[c.index],c.time)}},{})),vt=s.extend({initialize:function(o){for(var l=this.points=[],c=o._segments,d=o._closed,f=0,m,v=c.length;f<v;f++){var p=c[f].point;(!m||!m.equals(p))&&l.push(m=p.clone())}d&&(l.unshift(l[l.length-1]),l.push(l[1])),this.closed=d},fit:function(o){var l=this.points,c=l.length,d=null;return c>0&&(d=[new we(l[0])],c>1&&(this.fitCubic(d,o,0,c-1,l[1].subtract(l[0]),l[c-2].subtract(l[c-1])),this.closed&&(d.shift(),d.pop()))),d},fitCubic:function(o,l,c,d,f,m){var v=this.points;if(d-c===1){var p=v[c],y=v[d],I=p.getDistance(y)/3;this.addCurve(o,[p,p.add(f.normalize(I)),y.add(m.normalize(I)),y]);return}for(var A=this.chordLengthParameterize(c,d),P=Math.max(l,l*l),C,S=!0,k=0;k<=4;k++){var O=this.generateBezier(c,d,A,f,m),F=this.findMaxError(c,d,O,A);if(F.error<l&&S){this.addCurve(o,O);return}if(C=F.index,F.error>=P)break;S=this.reparameterize(c,d,A,O),P=F.error}var N=v[C-1].subtract(v[C+1]);this.fitCubic(o,l,c,C,f,N),this.fitCubic(o,l,C,d,N.negate(),m)},addCurve:function(o,l){var c=o[o.length-1];c.setHandleOut(l[1].subtract(l[0])),o.push(new we(l[3],l[2].subtract(l[3])))},generateBezier:function(o,l,c,d,f){for(var m=1e-12,v=Math.abs,p=this.points,y=p[o],I=p[l],A=[[0,0],[0,0]],P=[0,0],C=0,S=l-o+1;C<S;C++){var k=c[C],O=1-k,F=3*k*O,N=O*O*O,D=F*O,x=F*k,b=k*k*k,M=d.normalize(D),L=f.normalize(x),$=p[o+C].subtract(y.multiply(N+D)).subtract(I.multiply(x+b));A[0][0]+=M.dot(M),A[0][1]+=M.dot(L),A[1][0]=A[0][1],A[1][1]+=L.dot(L),P[0]+=M.dot($),P[1]+=L.dot($)}var H=A[0][0]*A[1][1]-A[1][0]*A[0][1],q,W;if(v(H)>m){var Q=A[0][0]*P[1]-A[1][0]*P[0],K=P[0]*A[1][1]-P[1]*A[0][1];q=K/H,W=Q/H}else{var Y=A[0][0]+A[0][1],ee=A[1][0]+A[1][1];q=W=v(Y)>m?P[0]/Y:v(ee)>m?P[1]/ee:0}var re=I.getDistance(y),oe=m*re,le,Ie;if(q<oe||W<oe)q=W=re/3;else{var Se=I.subtract(y);le=d.normalize(q),Ie=f.normalize(W),le.dot(Se)-Ie.dot(Se)>re*re&&(q=W=re/3,le=Ie=null)}return[y,y.add(le||d.normalize(q)),I.add(Ie||f.normalize(W)),I]},reparameterize:function(o,l,c,d){for(var f=o;f<=l;f++)c[f-o]=this.findRoot(d,this.points[f],c[f-o]);for(var f=1,m=c.length;f<m;f++)if(c[f]<=c[f-1])return!1;return!0},findRoot:function(o,l,c){for(var d=[],f=[],m=0;m<=2;m++)d[m]=o[m+1].subtract(o[m]).multiply(3);for(var m=0;m<=1;m++)f[m]=d[m+1].subtract(d[m]).multiply(2);var v=this.evaluate(3,o,c),p=this.evaluate(2,d,c),y=this.evaluate(1,f,c),I=v.subtract(l),A=p.dot(p)+I.dot(y);return w.isMachineZero(A)?c:c-I.dot(p)/A},evaluate:function(o,l,c){for(var d=l.slice(),f=1;f<=o;f++)for(var m=0;m<=o-f;m++)d[m]=d[m].multiply(1-c).add(d[m+1].multiply(c));return d[0]},chordLengthParameterize:function(o,l){for(var c=[0],d=o+1;d<=l;d++)c[d-o]=c[d-o-1]+this.points[d].getDistance(this.points[d-1]);for(var d=1,f=l-o;d<=f;d++)c[d]/=c[f];return c},findMaxError:function(o,l,c,d){for(var f=Math.floor((l-o+1)/2),m=0,v=o+1;v<l;v++){var p=this.evaluate(3,c,d[v-o]),y=p.subtract(this.points[v]),I=y.x*y.x+y.y*y.y;I>=m&&(m=I,f=v)}return{error:m,index:f}}}),nt=te.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(l){this._content="",this._lines=[];var c=l&&s.isPlainObject(l)&&l.x===n&&l.y===n;this._initialize(c&&l,!c&&E.read(arguments))},_equals:function(o){return this._content===o._content},copyContent:function(o){this.setContent(o._content)},getContent:function(){return this._content},setContent:function(o){this._content=""+o,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Dt=nt.extend({_class:"PointText",initialize:function(){nt.apply(this,arguments)},getPoint:function(){var o=this._matrix.getTranslation();return new z(o.x,o.y,this,"setPoint")},setPoint:function(){var o=E.read(arguments);this.translate(o.subtract(this._matrix.getTranslation()))},_draw:function(o,l,c){if(this._content){this._setStyles(o,l,c);var d=this._lines,f=this._style,m=f.hasFill(),v=f.hasStroke(),p=f.getLeading(),y=o.shadowColor;o.font=f.getFontStyle(),o.textAlign=f.getJustification();for(var I=0,A=d.length;I<A;I++){o.shadowColor=y;var P=d[I];m&&(o.fillText(P,0,0),o.shadowColor="rgba(0,0,0,0)"),v&&o.strokeText(P,0,0),o.translate(0,p)}}},_getBounds:function(o,l){var c=this._style,d=this._lines,f=d.length,m=c.getJustification(),v=c.getLeading(),p=this.getView().getTextWidth(c.getFontStyle(),d),y=0;m!=="left"&&(y-=p/(m==="center"?2:1));var I=new V(y,f?-.75*v:0,p,f*v);return o?o._transformBounds(I,I):I}}),Ke=s.extend(new function(){var o={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},l={},c={transparent:[0,0,0,0]},d;function f(p){var y=p.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||p.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),I="rgb",A;if(y){var P=y[4]?4:3;A=new Array(P);for(var C=0;C<P;C++){var S=y[C+1];A[C]=parseInt(S.length==1?S+S:S,16)/255}}else if(y=p.match(/^(rgb|hsl)a?\((.*)\)$/)){I=y[1],A=y[2].trim().split(/[,\s]+/g);for(var k=I==="hsl",C=0,O=Math.min(A.length,4);C<O;C++){var F=A[C],S=parseFloat(F);if(k)if(C===0){var N=F.match(/([a-z]*)$/)[1];S*={turn:360,rad:180/Math.PI,grad:.9}[N]||1}else C<3&&(S/=100);else C<3&&(S/=/%$/.test(F)?100:255);A[C]=S}}else{var D=c[p];if(!D)if(r){d||(d=ie.getContext(1,1,{willReadFrequently:!0}),d.globalCompositeOperation="copy"),d.fillStyle="rgba(0,0,0,0)",d.fillStyle=p,d.fillRect(0,0,1,1);var x=d.getImageData(0,0,1,1).data;D=c[p]=[x[0]/255,x[1]/255,x[2]/255]}else D=[0,0,0];A=D.slice()}return[I,A]}var m=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],v={"rgb-hsb":function(p,y,I){var A=Math.max(p,y,I),P=Math.min(p,y,I),C=A-P,S=C===0?0:(A==p?(y-I)/C+(y<I?6:0):A==y?(I-p)/C+2:(p-y)/C+4)*60;return[S,A===0?0:C/A,A]},"hsb-rgb":function(p,y,I){p=(p/60%6+6)%6;var P=Math.floor(p),A=p-P,P=m[P],C=[I,I*(1-y),I*(1-y*A),I*(1-y*(1-A))];return[C[P[0]],C[P[1]],C[P[2]]]},"rgb-hsl":function(p,y,I){var A=Math.max(p,y,I),P=Math.min(p,y,I),C=A-P,S=C===0,k=S?0:(A==p?(y-I)/C+(y<I?6:0):A==y?(I-p)/C+2:(p-y)/C+4)*60,O=(A+P)/2,F=S?0:O<.5?C/(A+P):C/(2-A-P);return[k,F,O]},"hsl-rgb":function(p,y,I){if(p=(p/360%1+1)%1,y===0)return[I,I,I];for(var A=[p+1/3,p,p-1/3],P=I<.5?I*(1+y):I+y-I*y,C=2*I-P,S=[],k=0;k<3;k++){var O=A[k];O<0&&(O+=1),O>1&&(O-=1),S[k]=6*O<1?C+(P-C)*6*O:2*O<1?P:3*O<2?C+(P-C)*(2/3-O)*6:C}return S},"rgb-gray":function(p,y,I){return[p*.2989+y*.587+I*.114]},"gray-rgb":function(p){return[p,p,p]},"gray-hsb":function(p){return[0,0,p]},"gray-hsl":function(p){return[0,0,p]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return s.each(o,function(p,y){l[y]=[],s.each(p,function(I,A){var P=s.capitalize(I),C=/^(hue|saturation)$/.test(I),S=l[y][A]=y==="gradient"?I==="gradient"?function(k){var O=this._components[0];return k=sn.read(Array.isArray(k)?k:arguments,0,{readNull:!0}),O!==k&&(O&&O._removeOwner(this),k&&k._addOwner(this)),k}:function(){return E.read(arguments,0,{readNull:I==="highlight",clone:!0})}:function(k){return k==null||isNaN(k)?0:+k};this["get"+P]=function(){return this._type===y||C&&/^hs[bl]$/.test(this._type)?this._components[A]:this._convert(y)[A]},this["set"+P]=function(k){this._type!==y&&!(C&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(y),this._properties=o[y],this._type=y),this._components[A]=S.call(this,k),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function p(y){var I=arguments,A=this.__read,P=0,C,S,k,O;Array.isArray(y)&&(I=y,y=I[0]);var F=y!=null&&typeof y;if(F==="string"&&y in o&&(C=y,y=I[1],Array.isArray(y)?(S=y,k=I[2]):(A&&(P=1),I=s.slice(I,1),F=typeof y)),!S){if(O=F==="number"?I:F==="object"&&y.length!=null?y:null,O){C||(C=O.length>=3?"rgb":"gray");var N=o[C].length;k=O[N],A&&(P+=O===arguments?N+(k!=null?1:0):1),O.length>N&&(O=s.slice(O,0,N))}else if(F==="string"){var D=f(y);C=D[0],S=D[1],S.length===4&&(k=S[3],S.length--)}else if(F==="object")if(y.constructor===p){if(C=y._type,S=y._components.slice(),k=y._alpha,C==="gradient")for(var x=1,b=S.length;x<b;x++){var M=S[x];M&&(S[x]=M.clone())}}else if(y.constructor===sn)C="gradient",O=I;else{C="hue"in y?"lightness"in y?"hsl":"hsb":"gradient"in y||"stops"in y||"radial"in y?"gradient":"gray"in y?"gray":"rgb";var L=o[C],$=l[C];this._components=S=[];for(var x=0,b=L.length;x<b;x++){var H=y[L[x]];H==null&&!x&&C==="gradient"&&"stops"in y&&(H={stops:y.stops,radial:y.radial}),H=$[x].call(this,H),H!=null&&(S[x]=H)}k=y.alpha}A&&C&&(P=1)}if(this._type=C||"rgb",!S){this._components=S=[];for(var $=l[this._type],x=0,b=$.length;x<b;x++){var H=$[x].call(this,O&&O[x]);H!=null&&(S[x]=H)}}return this._components=S,this._properties=o[this._type],this._alpha=k,A&&(this.__read=P),this},set:"#initialize",_serialize:function(p,y){var I=this.getComponents();return s.serialize(/^(gray|rgb)$/.test(this._type)?I:[this._type].concat(I),p,!0,y)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(p){var y;return this._type===p?this._components.slice():(y=v[this._type+"-"+p])?y.apply(this,this._components):v["rgb-"+p].apply(this,v[this._type+"-rgb"].apply(this,this._components))},convert:function(p){return new Ke(p,this._convert(p),this._alpha)},getType:function(){return this._type},setType:function(p){this._components=this._convert(p),this._properties=o[p],this._type=p},getComponents:function(){var p=this._components.slice();return this._alpha!=null&&p.push(this._alpha),p},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(p){this._alpha=p==null?null:Math.min(Math.max(p,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(p){var y=s.isPlainValue(p,!0)?Ke.read(arguments):p;return y===this||y&&this._class===y._class&&this._type===y._type&&this.getAlpha()===y.getAlpha()&&s.equals(this._components,y._components)||!1},toString:function(){for(var p=this._properties,y=[],I=this._type==="gradient",A=_.instance,P=0,C=p.length;P<C;P++){var S=this._components[P];S!=null&&y.push(p[P]+": "+(I?S:A.number(S)))}return this._alpha!=null&&y.push("alpha: "+A.number(this._alpha)),"{ "+y.join(", ")+" }"},toCSS:function(p){var y=this._convert("rgb"),I=p||this._alpha==null?1:this._alpha;function A(P){return Math.round((P<0?0:P>1?1:P)*255)}return y=[A(y[0]),A(y[1]),A(y[2])],I<1&&y.push(I<0?0:I),p?"#"+((1<<24)+(y[0]<<16)+(y[1]<<8)+y[2]).toString(16).slice(1):(y.length==4?"rgba(":"rgb(")+y.join(",")+")"},toCanvasStyle:function(p,y){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var I=this._components,A=I[0],P=A._stops,C=I[1],S=I[2],k=I[3],O=y&&y.inverted(),F;if(O&&(C=O._transformPoint(C),S=O._transformPoint(S),k&&(k=O._transformPoint(k))),A._radial){var N=S.getDistance(C);if(k){var D=k.subtract(C);D.getLength()>N&&(k=C.add(D.normalize(N-.1)))}var x=k||C;F=p.createRadialGradient(x.x,x.y,0,C.x,C.y,N)}else F=p.createLinearGradient(C.x,C.y,S.x,S.y);for(var b=0,M=P.length;b<M;b++){var L=P[b],$=L._offset;F.addColorStop($??b/(M-1),L._color.toCanvasStyle())}return this._canvasStyle=F},transform:function(p){if(this._type==="gradient"){for(var y=this._components,I=1,A=y.length;I<A;I++){var P=y[I];p._transformPoint(P,P,!0)}this._changed()}},statics:{_types:o,random:function(){var p=Math.random;return new Ke(p(),p(),p())},_setOwner:function(p,y,I){return p&&(p._owner&&y&&p._owner!==y&&(p=p.clone()),!p._owner^!y&&(p._owner=y||null,p._setter=I||null)),p}}})},new function(){var o={add:function(l,c){return l+c},subtract:function(l,c){return l-c},multiply:function(l,c){return l*c},divide:function(l,c){return l/c}};return s.each(o,function(l,c){this[c]=function(d){d=Ke.read(arguments);for(var f=this._type,m=this._components,v=d._convert(f),p=0,y=m.length;p<y;p++)v[p]=l(m[p],v[p]);return new Ke(f,v,this._alpha!=null?l(this._alpha,d.getAlpha()):null)}},{})}),sn=s.extend({_class:"Gradient",initialize:function(l,c){this._id=T.get(),l&&s.isPlainObject(l)&&(this.set(l),l=c=null),this._stops==null&&this.setStops(l||["white","black"]),this._radial==null&&this.setRadial(typeof c=="string"&&c==="radial"||c||!1)},_serialize:function(o,l){return l.add(this,function(){return s.serialize([this._stops,this._radial],o,!0,l)})},_changed:function(){for(var o=0,l=this._owners&&this._owners.length;o<l;o++)this._owners[o]._changed()},_addOwner:function(o){this._owners||(this._owners=[]),this._owners.push(o)},_removeOwner:function(o){var l=this._owners?this._owners.indexOf(o):-1;l!=-1&&(this._owners.splice(l,1),this._owners.length||(this._owners=n))},clone:function(){for(var o=[],l=0,c=this._stops.length;l<c;l++)o[l]=this._stops[l].clone();return new sn(o,this._radial)},getStops:function(){return this._stops},setStops:function(o){if(o.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var l=this._stops;if(l)for(var c=0,d=l.length;c<d;c++)l[c]._owner=n;l=this._stops=yn.readList(o,0,{clone:!0});for(var c=0,d=l.length;c<d;c++)l[c]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(o){this._radial=o,this._changed()},equals:function(o){if(o===this)return!0;if(o&&this._class===o._class){var l=this._stops,c=o._stops,d=l.length;if(d===c.length){for(var f=0;f<d;f++)if(!l[f].equals(c[f]))return!1;return!0}}return!1}}),yn=s.extend({_class:"GradientStop",initialize:function(l,c){var d=l,f=c;typeof l=="object"&&c===n&&(Array.isArray(l)&&typeof l[0]!="number"?(d=l[0],f=l[1]):("color"in l||"offset"in l||"rampPoint"in l)&&(d=l.color,f=l.offset||l.rampPoint||0)),this.setColor(d),this.setOffset(f)},clone:function(){return new yn(this._color.clone(),this._offset)},_serialize:function(o,l){var c=this._color,d=this._offset;return s.serialize(d==null?[c]:[c,d],o,!0,l)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(o){this._offset=o,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){Ke._setOwner(this._color,null),this._color=Ke._setOwner(Ke.read(arguments,0),this,"setColor"),this._changed()},equals:function(o){return o===this||o&&this._class===o._class&&this._color.equals(o._color)&&this._offset==o._offset||!1}}),Zi=s.extend(new function(){var o={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new E,selectedColor:null},l=s.set({},o,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),c=s.set({},l,{fillColor:new Ke}),d={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},f={beans:!0},m={_class:"Style",beans:!0,initialize:function(p,y,I){this._values={},this._owner=y,this._project=y&&y._project||I||de.project,this._defaults=!y||y instanceof ae?l:y instanceof nt?c:o,p&&this.set(p)}};return s.each(l,function(v,p){var y=/Color$/.test(p),I=p==="shadowOffset",A=s.capitalize(p),P=d[p],C="set"+A,S="get"+A;m[C]=function(k){var O=this._owner,F=O&&O._children,N=F&&F.length>0&&!(O instanceof De);if(N)for(var D=0,x=F.length;D<x;D++)F[D]._style[C](k);if((p==="selectedColor"||!N)&&p in this._defaults){var b=this._values[p];b!==k&&(y&&(b&&(Ke._setOwner(b,null),b._canvasStyle=null),k&&k.constructor===Ke&&(k=Ke._setOwner(k,O,N&&C))),this._values[p]=k,O&&O._changed(P||129))}},m[S]=function(k){var O=this._owner,F=O&&O._children,N=F&&F.length>0&&!(O instanceof De),D;if(N&&!k)for(var x=0,b=F.length;x<b;x++){var M=F[x]._style[S]();if(!x)D=M;else if(!s.equals(D,M))return n}else if(p in this._defaults){var D=this._values[p];if(D===n)D=this._defaults[p],D&&D.clone&&(D=D.clone());else{var L=y?Ke:I?E:null;L&&!(D&&D.constructor===L)&&(this._values[p]=D=L.read([D],0,{readNull:!0,clone:!0}))}}return D&&y&&(D=Ke._setOwner(D,O,N&&C)),D},f[S]=function(k){return this._style[S](k)},f[C]=function(k){this._style[C](k)}}),s.each({Font:"FontFamily",WindingRule:"FillRule"},function(v,p){var y="get"+p,I="set"+p;m[y]=f[y]="#get"+v,m[I]=f[I]="#set"+v}),te.inject(f),m},{set:function(o){var l=o instanceof Zi,c=l?o._values:o;if(c){for(var d in c)if(d in this._defaults){var f=c[d];this[d]=f&&l&&f.clone?f.clone():f}}},equals:function(o){function l(c,d,f){var m=c._values,v=d._values,p=d._defaults;for(var y in m){var I=m[y],A=v[y];if(!(f&&y in v)&&!s.equals(I,A===n?p[y]:A))return!1}return!0}return o===this||o&&this._class===o._class&&l(this,o)&&l(o,this,!0)||!1},_dispose:function(){var o;o=this.getFillColor(),o&&(o._canvasStyle=null),o=this.getStrokeColor(),o&&(o._canvasStyle=null),o=this.getShadowColor(),o&&(o._canvasStyle=null)},hasFill:function(){var o=this.getFillColor();return!!o&&o.alpha>0},hasStroke:function(){var o=this.getStrokeColor();return!!o&&o.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var o=this.getShadowColor();return!!o&&o.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var o=this.getFontSize();return this.getFontWeight()+" "+o+(/[a-z]/i.test(o+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function o(){var l=o.base.call(this),c=this.getFontSize();return/pt|em|%|px/.test(c)&&(c=this.getView().getPixelSize(c)),l??c*1.2}}),Ct=new function(){function o(l,c,d,f){for(var m=["","webkit","moz","Moz","ms","o"],v=c[0].toUpperCase()+c.substring(1),p=0;p<6;p++){var y=m[p],I=y?y+v:c;if(I in l){if(d)l[I]=f;else return l[I];break}}}return{getStyles:function(l){var c=l&&l.nodeType!==9?l.ownerDocument:l,d=c&&c.defaultView;return d&&d.getComputedStyle(l,"")},getBounds:function(l,c){var d=l.ownerDocument,f=d.body,m=d.documentElement,v;try{v=l.getBoundingClientRect()}catch{v={left:0,top:0,width:0,height:0}}var p=v.left-(m.clientLeft||f.clientLeft||0),y=v.top-(m.clientTop||f.clientTop||0);if(!c){var I=d.defaultView;p+=I.pageXOffset||m.scrollLeft||f.scrollLeft,y+=I.pageYOffset||m.scrollTop||f.scrollTop}return new V(p,y,v.width,v.height)},getViewportBounds:function(l){var c=l.ownerDocument,d=c.defaultView,f=c.documentElement;return new V(0,0,d.innerWidth||f.clientWidth,d.innerHeight||f.clientHeight)},getOffset:function(l,c){return Ct.getBounds(l,c).getPoint()},getSize:function(l){return Ct.getBounds(l,!0).getSize()},isInvisible:function(l){return Ct.getSize(l).equals(new j(0,0))},isInView:function(l){return!Ct.isInvisible(l)&&Ct.getViewportBounds(l).intersects(Ct.getBounds(l,!0))},isInserted:function(l){return i.body.contains(l)},getPrefixed:function(l,c){return l&&o(l,c)},setPrefixed:function(l,c,d){if(typeof c=="object")for(var f in c)o(l,f,!0,c[f]);else o(l,c,!0,d)}}},Bt={add:function(o,l){if(o)for(var c in l)for(var d=l[c],f=c.split(/[\s,]+/g),m=0,v=f.length;m<v;m++){var p=f[m],y=o===i&&(p==="touchstart"||p==="touchmove")?{passive:!1}:!1;o.addEventListener(p,d,y)}},remove:function(o,l){if(o)for(var c in l)for(var d=l[c],f=c.split(/[\s,]+/g),m=0,v=f.length;m<v;m++)o.removeEventListener(f[m],d,!1)},getPoint:function(o){var l=o.targetTouches?o.targetTouches.length?o.targetTouches[0]:o.changedTouches[0]:o;return new E(l.pageX||l.clientX+i.documentElement.scrollLeft,l.pageY||l.clientY+i.documentElement.scrollTop)},getTarget:function(o){return o.target||o.srcElement},getRelatedTarget:function(o){return o.relatedTarget||o.toElement},getOffset:function(o,l){return Bt.getPoint(o).subtract(Ct.getOffset(l||Bt.getTarget(o)))}};Bt.requestAnimationFrame=new function(){var o=Ct.getPrefixed(r,"requestAnimationFrame"),l=!1,c=[],d;function f(){var m=c;c=[];for(var v=0,p=m.length;v<p;v++)m[v]();l=o&&c.length,l&&o(f)}return function(m){c.push(m),o?l||(o(f),l=!0):d||(d=setInterval(f,1e3/60))}};var Pt=s.extend(a,{_class:"View",initialize:function o(l,c){function d(P){return c[P]||parseInt(c.getAttribute(P),10)}function f(){var P=Ct.getSize(c);return P.isNaN()||P.isZero()?new j(d("width"),d("height")):P}var m;if(r&&c){this._id=c.getAttribute("id"),this._id==null&&c.setAttribute("id",this._id="paper-view-"+o._id++),Bt.add(c,this._viewEvents);var v="none";if(Ct.setPrefixed(c.style,{userDrag:v,userSelect:v,touchCallout:v,contentZooming:v,tapHighlightColor:"rgba(0,0,0,0)"}),u.hasAttribute(c,"resize")){var p=this;Bt.add(r,this._windowEvents={resize:function(){p.setViewSize(f())}})}if(m=f(),u.hasAttribute(c,"stats")&&typeof Stats<"u"){this._stats=new Stats;var y=this._stats.domElement,I=y.style,A=Ct.getOffset(c);I.position="absolute",I.left=A.x+"px",I.top=A.y+"px",i.body.appendChild(y)}}else m=new j(c),c=null;this._project=l,this._scope=l._scope,this._element=c,this._pixelRatio||(this._pixelRatio=r&&r.devicePixelRatio||1),this._setElementSize(m.width,m.height),this._viewSize=m,o._views.push(this),o._viewsById[this._id]=this,(this._matrix=new U)._owner=this,o._focused||(o._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!de.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Pt._focused===this&&(Pt._focused=null),Pt._views.splice(Pt._views.indexOf(this),1),delete Pt._viewsById[this._id];var o=this._project;return o._view===this&&(o._view=null),Bt.remove(this._element,this._viewEvents),Bt.remove(r,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:s.each(te._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(o){this[o]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(o){this._autoUpdate=o,o&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var o=this;Bt.requestAnimationFrame(function(){if(o._requested=!1,o._animate){o.requestUpdate();var l=o._element;(!Ct.getPrefixed(i,"hidden")||u.getAttribute(l,"keepalive")==="true")&&Ct.isInView(l)&&o._handleFrame()}o._autoUpdate&&o.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){de=this._scope;var o=Date.now()/1e3,l=this._last?o-this._last:0;this._last=o,this.emit("frame",new s({delta:l,time:this._time+=l,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(o,l){var c=this._frameItems;l?(c[o._id]={item:o,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete c[o._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(o){for(var l in this._frameItems){var c=this._frameItems[l];c.item.emit("frame",new s(o,{time:c.time+=o.delta,count:c.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var o=this._viewSize;return new J(o.width,o.height,this,"setViewSize")},setViewSize:function(){var o=j.read(arguments),l=o.subtract(this._viewSize);l.isZero()||(this._setElementSize(o.width,o.height),this._viewSize.set(o),this._changed(),this.emit("resize",{size:o,delta:l}),this._autoUpdate&&this.update())},_setElementSize:function(o,l){var c=this._element;c&&(c.width!==o&&(c.width=o),c.height!==l&&(c.height=l))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new V(new E,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return Ct.isInView(this._element)},isInserted:function(){return Ct.isInserted(this._element)},getPixelSize:function(o){var l=this._element,c;if(l){var d=l.parentNode,f=i.createElement("div");f.style.fontSize=o,d.appendChild(f),c=parseFloat(Ct.getStyles(f).fontSize),d.removeChild(f)}else c=parseFloat(c);return c},getTextWidth:function(o,l){return 0}},s.each(["rotate","scale","shear","skew"],function(o){var l=o==="rotate";this[o]=function(){var c=arguments,d=(l?s:E).read(c),f=E.read(c,0,{readNull:!0});return this.transform(new U()[o](d,f||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var o=new U;return this.transform(o.translate.apply(o,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var o=E.read(arguments);this.translate(this.getCenter().subtract(o))},getZoom:function(){var o=this._decompose().scaling;return(o.x+o.y)/2},setZoom:function(o){this.transform(new U().scale(o/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(o){var l=this.getRotation();l!=null&&o!=null&&this.rotate(o-l)},getScaling:function(){var o=this._decompose().scaling;return new z(o.x,o.y,this,"setScaling")},setScaling:function(){var o=this.getScaling(),l=E.read(arguments,0,{clone:!0,readNull:!0});o&&l&&this.scale(l.x/o.x,l.y/o.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var o=this._matrix;o.set.apply(o,arguments)},transform:function(o){this._matrix.append(o)},scrollBy:function(){this.translate(E.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(E.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(E.read(arguments))},getEventPoint:function(o){return this.viewToProject(Bt.getOffset(o,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(o,l){i&&typeof l=="string"&&(l=i.getElementById(l));var c=r?Lo:Pt;return new c(o,l)}}},new function(){if(!r)return;var o,l,c=!1,d=!1;function f(K){var Y=Bt.getTarget(K);return Y.getAttribute&&Pt._viewsById[Y.getAttribute("id")]}function m(){var K=Pt._focused;if(!K||!K.isVisible()){for(var Y=0,ee=Pt._views.length;Y<ee;Y++)if((K=Pt._views[Y]).isVisible()){Pt._focused=l=K;break}}}function v(K,Y,ee){K._handleMouseEvent("mousemove",Y,ee)}var p=r.navigator,y,I,A;p.pointerEnabled||p.msPointerEnabled?(y="pointerdown MSPointerDown",I="pointermove MSPointerMove",A="pointerup pointercancel MSPointerUp MSPointerCancel"):(y="touchstart",I="touchmove",A="touchend touchcancel","ontouchstart"in r&&p.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(y+=" mousedown",I+=" mousemove",A+=" mouseup"));var P={},C={mouseout:function(K){var Y=Pt._focused,ee=Bt.getRelatedTarget(K);if(Y&&(!ee||ee.nodeName==="HTML")){var re=Bt.getOffset(K,Y._element),oe=re.x,le=Math.abs,Ie=le(oe),Se=1<<25,be=Ie-Se;re.x=le(be)<Ie?be*(oe<0?-1:1):oe,v(Y,K,Y.viewToProject(re))}},scroll:m};P[y]=function(K){var Y=Pt._focused=f(K);c||(c=!0,Y._handleMouseEvent("mousedown",K))},C[I]=function(K){var Y=Pt._focused;if(!d){var ee=f(K);ee?Y!==ee&&(Y&&v(Y,K),o||(o=Y),Y=Pt._focused=l=ee):l&&l===Y&&(o&&!o.isInserted()&&(o=null),Y=Pt._focused=o,o=null,m())}Y&&v(Y,K)},C[y]=function(){d=!0},C[A]=function(K){var Y=Pt._focused;Y&&c&&Y._handleMouseEvent("mouseup",K),d=c=!1},Bt.add(i,C),Bt.add(r,{load:m});var S=!1,k=!1,O={doubleclick:"click",mousedrag:"mousemove"},F=!1,N,D,x,b,M,L,$,H;function q(K,Y,ee,re,oe,le,Ie){var Se=!1,be;function We($e,ze){if($e.responds(ze)){if(be||(be=new Vo(ze,re,oe,Y||$e,le?oe.subtract(le):null)),$e.emit(ze,be)&&(S=!0,be.prevented&&(k=!0),be.stopped))return Se=!0}else{var je=O[ze];if(je)return We($e,je)}}for(;K&&K!==Ie&&!We(K,ee);)K=K._parent;return Se}function W(K,Y,ee,re,oe,le){return K._project.removeOn(ee),k=S=!1,M&&q(M,null,ee,re,oe,le)||Y&&Y!==M&&!Y.isDescendant(M)&&q(Y,null,ee==="mousedrag"?"mousemove":ee,re,oe,le,M)||q(K,M||Y||K,ee,re,oe,le)}var Q={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:P,_handleMouseEvent:function(K,Y,ee){var re=this._itemEvents,oe=re.native[K],le=K==="mousemove",Ie=this._scope.tool,Se=this;function be(yt){return re.virtual[yt]||Se.responds(yt)||Ie&&Ie.responds(yt)}le&&c&&be("mousedrag")&&(K="mousedrag"),ee||(ee=this.getEventPoint(Y));var We=this.getBounds().contains(ee),$e=oe&&We&&Se._project.hitTest(ee,{tolerance:0,fill:!0,stroke:!0}),ze=$e&&$e.item||null,je=!1,Je={};if(Je[K.substr(5)]=!0,oe&&ze!==b&&(b&&q(b,null,"mouseleave",Y,ee),ze&&q(ze,null,"mouseenter",Y,ee),b=ze),F^We&&(q(this,null,We?"mouseenter":"mouseleave",Y,ee),je=!0),(We||Je.drag)&&!ee.equals(D)&&(W(this,ze,le?K:"mousemove",Y,ee,D),je=!0),F=We,Je.down&&We||Je.up&&N){if(W(this,ze,K,Y,ee,N),Je.down){if(H=ze===L&&Date.now()-$<300,x=L=ze,!k&&ze){for(var Ge=ze;Ge&&!Ge.responds("mousedrag");)Ge=Ge._parent;Ge&&(M=ze)}N=ee}else Je.up&&(!k&&ze===x&&($=Date.now(),W(this,ze,H?"doubleclick":"click",Y,ee,N),H=!1),x=M=null);F=!1,je=!0}D=ee,je&&Ie&&(S=Ie._handleMouseEvent(K,Y,ee,Je)||S),Y.cancelable!==!1&&(S&&!Je.move||Je.down&&be("mouseup"))&&Y.preventDefault()},_handleKeyEvent:function(K,Y,ee,re){var oe=this._scope,le=oe.tool,Ie;function Se(be){be.responds(K)&&(de=oe,be.emit(K,Ie=Ie||new Hr(K,Y,ee,re)))}this.isVisible()&&(Se(this),le&&le.responds(K)&&Se(le))},_countItemEvent:function(K,Y){var ee=this._itemEvents,re=ee.native,oe=ee.virtual;for(var le in Q)re[le]=(re[le]||0)+(Q[le][K]||0)*Y;oe[K]=(oe[K]||0)+Y},statics:{updateFocus:m,_resetState:function(){c=d=S=F=!1,o=l=N=D=x=b=M=L=$=H=null}}}}),Lo=Pt.extend({_class:"CanvasView",initialize:function(l,c){if(!(c instanceof r.HTMLCanvasElement)){var d=j.read(arguments,1);if(d.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+s.slice(arguments,1));c=ie.getCanvas(d)}var f=this._context=c.getContext("2d");if(f.save(),this._pixelRatio=1,!/^off|false$/.test(u.getAttribute(c,"hidpi"))){var m=r.devicePixelRatio||1,v=Ct.getPrefixed(f,"backingStorePixelRatio")||1;this._pixelRatio=m/v}Pt.call(this,l,c),this._needsUpdate=!0},remove:function o(){return this._context.restore(),o.base.call(this)},_setElementSize:function o(l,c){var d=this._pixelRatio;if(o.base.call(this,l*d,c*d),d!==1){var f=this._element,m=this._context;if(!u.hasAttribute(f,"resize")){var v=f.style;v.width=l+"px",v.height=c+"px"}m.restore(),m.save(),m.scale(d,d)}},getContext:function(){return this._context},getPixelSize:function o(l){var c=de.agent,d;if(c&&c.firefox)d=o.base.call(this,l);else{var f=this._context,m=f.font;f.font=l+" serif",d=parseFloat(f.font),f.font=m}return d},getTextWidth:function(o,l){var c=this._context,d=c.font,f=0;c.font=o;for(var m=0,v=l.length;m<v;m++)f=Math.max(f,c.measureText(l[m]).width);return c.font=d,f},update:function(){if(!this._needsUpdate)return!1;var o=this._project,l=this._context,c=this._viewSize;return l.clearRect(0,0,c.width+1,c.height+1),o&&o.draw(l,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Zn=s.extend({_class:"Event",initialize:function(l){this.event=l,this.type=l&&l.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return qr.modifiers}}),Hr=Zn.extend({_class:"KeyEvent",initialize:function(l,c,d,f){this.type=l,this.event=c,this.key=d,this.character=f},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),qr=new function(){var o={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},l={tab:"	",space:" ",enter:"\r"},c={},d={},f,m,v=new s({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var I=de&&de.agent;return I&&I.mac?this.meta:this.control}}});function p(I){var A=I.key||I.keyIdentifier;return A=/^U\+/.test(A)?String.fromCharCode(parseInt(A.substr(2),16)):/^Arrow[A-Z]/.test(A)?A.substr(5):A==="Unidentified"||A===n?String.fromCharCode(I.keyCode):A,o[A]||(A.length>1?s.hyphenate(A):A.toLowerCase())}function y(I,A,P,C){var S=Pt._focused,k;if(c[A]=I,I?d[A]=P:delete d[A],A.length>1&&(k=s.camelize(A))in v){v[k]=I;var O=de&&de.agent;if(k==="meta"&&O&&O.mac)if(I)f={};else{for(var F in f)F in d&&y(!1,F,f[F],C);f=null}}else I&&f&&(f[A]=P);S&&S._handleKeyEvent(I?"keydown":"keyup",C,A,P)}return Bt.add(i,{keydown:function(I){var A=p(I),P=de&&de.agent;A.length>1||P&&P.chrome&&(I.altKey||P.mac&&I.metaKey||!P.mac&&I.ctrlKey)?y(!0,A,l[A]||(A.length>1?"":A),I):m=A},keypress:function(I){if(m){var A=p(I),P=I.charCode,C=P>=32?String.fromCharCode(P):A.length>1?"":A;A!==m&&(A=C.toLowerCase()),y(!0,A,C,I),m=null}},keyup:function(I){var A=p(I);A in d&&y(!1,A,d[A],I)}}),Bt.add(r,{blur:function(I){for(var A in d)y(!1,A,d[A],I)}}),{modifiers:v,isDown:function(I){return!!c[I]}}},Vo=Zn.extend({_class:"MouseEvent",initialize:function(l,c,d,f,m){this.type=l,this.event=c,this.point=d,this.target=f,this.delta=m},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Fo=Zn.extend({_class:"ToolEvent",_item:null,initialize:function(l,c,d){this.tool=l,this.type=c,this.event=d},_choosePoint:function(o,l){return o||(l?l.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(o){this._point=o},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(o){this._lastPoint=o},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(o){this._downPoint=o},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(o){this._middlePoint=o},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(o){this._delta=o},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(o){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=o},getItem:function(){if(!this._item){var o=this.tool._scope.project.hitTest(this.getPoint());if(o){for(var l=o.item,c=l._parent;/^(Group|CompoundPath)$/.test(c._class);)l=c,c=c._parent;this._item=l}}return this._item},setItem:function(o){this._item=o},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}});h.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(l){h.call(this),this._moveCount=-1,this._downCount=-1,this.set(l)},getMinDistance:function(){return this._minDistance},setMinDistance:function(o){this._minDistance=o,o!=null&&this._maxDistance!=null&&o>this._maxDistance&&(this._maxDistance=o)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(o){this._maxDistance=o,this._minDistance!=null&&o!=null&&o<this._minDistance&&(this._minDistance=o)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(o){this._minDistance=this._maxDistance=o},_handleMouseEvent:function(o,l,c,d){de=this._scope,d.drag&&!this.responds(o)&&(o="mousemove");var f=d.move||d.drag,m=this.responds(o),v=this.minDistance,p=this.maxDistance,y=!1,I=this;function A(C,S){var k=c,O=f?I._point:I._downPoint||k;if(f){if(I._moveCount>=0&&k.equals(O))return!1;if(O&&(C!=null||S!=null)){var F=k.subtract(O),N=F.getLength();if(N<(C||0))return!1;S&&(k=O.add(F.normalize(Math.min(N,S))))}I._moveCount++}return I._point=k,I._lastPoint=O||k,d.down&&(I._moveCount=-1,I._downPoint=k,I._downCount++),!0}function P(){m&&(y=I.emit(o,new Fo(I,o,l))||y)}if(d.down)A(),P();else if(d.up)A(null,p),P();else if(m)for(;A(v,p);)P();return y}});var id=s.extend(a,{_class:"Tween",statics:{easings:new s({linear:function(o){return o},easeInQuad:function(o){return o*o},easeOutQuad:function(o){return o*(2-o)},easeInOutQuad:function(o){return o<.5?2*o*o:-1+2*(2-o)*o},easeInCubic:function(o){return o*o*o},easeOutCubic:function(o){return--o*o*o+1},easeInOutCubic:function(o){return o<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1},easeInQuart:function(o){return o*o*o*o},easeOutQuart:function(o){return 1- --o*o*o*o},easeInOutQuart:function(o){return o<.5?8*o*o*o*o:1-8*--o*o*o*o},easeInQuint:function(o){return o*o*o*o*o},easeOutQuint:function(o){return 1+--o*o*o*o*o},easeInOutQuint:function(o){return o<.5?16*o*o*o*o*o:1+16*--o*o*o*o*o}})},initialize:function o(l,c,d,f,m,v){this.object=l;var p=typeof m,y=p==="function";this.type=y?p:p==="string"?m:"linear",this.easing=y?m:o.easings[this.type],this.duration=f,this.running=!1,this._then=null,this._startTime=null;var I=c||d;this._keys=I?Object.keys(I):[],this._parsedKeys=this._parseKeys(this._keys),this._from=I&&this._getState(c),this._to=I&&this._getState(d),v!==!1&&this.start()},then:function(o){return this._then=o,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(o){if(this.running){o>=1&&(o=1,this.running=!1);for(var l=this.easing(o),c=this._keys,d=function(A){return typeof A=="function"?A(l,o):A},f=0,m=c&&c.length;f<m;f++){var v=c[f],p=d(this._from[v]),y=d(this._to[v]),I=p&&y&&p.__add&&y.__add?y.__subtract(p).__multiply(l).__add(p):(y-p)*l+p;this._setProperty(this._parsedKeys[v],I)}this.responds("update")&&this.emit("update",new s({progress:o,factor:l})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(o){var l=this._startTime,c=l?(o-l)/this.duration:0;l||(this._startTime=o),this.update(c)},_getState:function(o){for(var l=this._keys,c={},d=0,f=l.length;d<f;d++){var m=l[d],v=this._parsedKeys[m],p=this._getProperty(v),y;if(o){var I=this._resolveValue(p,o[m]);this._setProperty(v,I),y=this._getProperty(v),y=y&&y.clone?y.clone():y,this._setProperty(v,p)}else y=p&&p.clone?p.clone():p;c[m]=y}return c},_resolveValue:function(o,l){if(l){if(Array.isArray(l)&&l.length===2){var c=l[0];return c&&c.match&&c.match(/^[+\-\*\/]=/)?this._calculate(o,c[0],l[1]):l}else if(typeof l=="string"){var d=l.match(/^[+\-*/]=(.*)/);if(d){var f=JSON.parse(d[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(o,l[0],f)}}}return l},_calculate:function(o,l,c){return de.PaperScript.calculateBinary(o,l,c)},_parseKeys:function(o){for(var l={},c=0,d=o.length;c<d;c++){var f=o[c],m=f.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");l[f]=m.split("/")}return l},_getProperty:function(o,l){for(var c=this.object,d=0,f=o.length-(l||0);d<f&&c;d++)c=c[o[d]];return c},_setProperty:function(o,l){var c=this._getProperty(o,1);c&&(c[o[o.length-1]]=l)}}),X={request:function(o){var l=new e.XMLHttpRequest;return l.open((o.method||"get").toUpperCase(),o.url,s.pick(o.async,!0)),o.mimeType&&l.overrideMimeType(o.mimeType),l.onload=function(){var c=l.status;c===0||c===200?o.onLoad&&o.onLoad.call(l,l.responseText):l.onerror()},l.onerror=function(){var c=l.status,d='Could not load "'+o.url+'" (Status: '+c+")";if(o.onError)o.onError(d,c);else throw new Error(d)},l.send(null)}},ie=s.exports.CanvasProvider={canvases:[],getCanvas:function(o,l,c){if(!r)return null;var d,f=!0;typeof o=="object"&&(l=o.height,o=o.width),this.canvases.length?d=this.canvases.pop():(d=i.createElement("canvas"),f=!1);var m=d.getContext("2d",c||{});if(!m)throw new Error("Canvas "+d+" is unable to provide a 2D context.");return d.width===o&&d.height===l?f&&m.clearRect(0,0,o+1,l+1):(d.width=o,d.height=l),m.save(),d},getContext:function(o,l,c){var d=this.getCanvas(o,l,c);return d?d.getContext("2d",c||{}):null},release:function(o){var l=o&&o.canvas?o.canvas:o;l&&l.getContext&&(l.getContext("2d").restore(),this.canvases.push(l))}},ge=new function(){var o=Math.min,l=Math.max,c=Math.abs,d,f,m,v,p,y,I,A,P,C,S;function k(M,L,$){return .2989*M+.587*L+.114*$}function O(M,L,$,W){var q=W-k(M,L,$);P=M+q,C=L+q,S=$+q;var W=k(P,C,S),Q=o(P,C,S),K=l(P,C,S);if(Q<0){var Y=W-Q;P=W+(P-W)*W/Y,C=W+(C-W)*W/Y,S=W+(S-W)*W/Y}if(K>255){var ee=255-W,re=K-W;P=W+(P-W)*ee/re,C=W+(C-W)*ee/re,S=W+(S-W)*ee/re}}function F(M,L,$){return l(M,L,$)-o(M,L,$)}function N(M,L,$,H){var q=[M,L,$],W=l(M,L,$),Q=o(M,L,$),K;Q=Q===M?0:Q===L?1:2,W=W===M?0:W===L?1:2,K=o(Q,W)===0?l(Q,W)===1?2:1:0,q[W]>q[Q]?(q[K]=(q[K]-q[Q])*H/(q[W]-q[Q]),q[W]=H):q[K]=q[W]=0,q[Q]=0,P=q[0],C=q[1],S=q[2]}var D={multiply:function(){P=p*d/255,C=y*f/255,S=I*m/255},screen:function(){P=p+d-p*d/255,C=y+f-y*f/255,S=I+m-I*m/255},overlay:function(){P=p<128?2*p*d/255:255-2*(255-p)*(255-d)/255,C=y<128?2*y*f/255:255-2*(255-y)*(255-f)/255,S=I<128?2*I*m/255:255-2*(255-I)*(255-m)/255},"soft-light":function(){var M=d*p/255;P=M+p*(255-(255-p)*(255-d)/255-M)/255,M=f*y/255,C=M+y*(255-(255-y)*(255-f)/255-M)/255,M=m*I/255,S=M+I*(255-(255-I)*(255-m)/255-M)/255},"hard-light":function(){P=d<128?2*d*p/255:255-2*(255-d)*(255-p)/255,C=f<128?2*f*y/255:255-2*(255-f)*(255-y)/255,S=m<128?2*m*I/255:255-2*(255-m)*(255-I)/255},"color-dodge":function(){P=p===0?0:d===255?255:o(255,255*p/(255-d)),C=y===0?0:f===255?255:o(255,255*y/(255-f)),S=I===0?0:m===255?255:o(255,255*I/(255-m))},"color-burn":function(){P=p===255?255:d===0?0:l(0,255-(255-p)*255/d),C=y===255?255:f===0?0:l(0,255-(255-y)*255/f),S=I===255?255:m===0?0:l(0,255-(255-I)*255/m)},darken:function(){P=p<d?p:d,C=y<f?y:f,S=I<m?I:m},lighten:function(){P=p>d?p:d,C=y>f?y:f,S=I>m?I:m},difference:function(){P=p-d,P<0&&(P=-P),C=y-f,C<0&&(C=-C),S=I-m,S<0&&(S=-S)},exclusion:function(){P=p+d*(255-p-p)/255,C=y+f*(255-y-y)/255,S=I+m*(255-I-I)/255},hue:function(){N(d,f,m,F(p,y,I)),O(P,C,S,k(p,y,I))},saturation:function(){N(p,y,I,F(d,f,m)),O(P,C,S,k(p,y,I))},luminosity:function(){O(p,y,I,k(d,f,m))},color:function(){O(d,f,m,k(p,y,I))},add:function(){P=o(p+d,255),C=o(y+f,255),S=o(I+m,255)},subtract:function(){P=l(p-d,0),C=l(y-f,0),S=l(I-m,0)},average:function(){P=(p+d)/2,C=(y+f)/2,S=(I+m)/2},negation:function(){P=255-c(255-d-p),C=255-c(255-f-y),S=255-c(255-m-I)}},x=this.nativeModes=s.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(M){this[M]=!0},{}),b=ie.getContext(1,1,{willReadFrequently:!0});b&&(s.each(D,function(M,L){var $=L==="darken",H=!1;b.save();try{b.fillStyle=$?"#300":"#a00",b.fillRect(0,0,1,1),b.globalCompositeOperation=L,b.globalCompositeOperation===L&&(b.fillStyle=$?"#a00":"#300",b.fillRect(0,0,1,1),H=b.getImageData(0,0,1,1).data[0]!==$?170:51)}catch{}b.restore(),x[L]=H}),ie.release(b)),this.process=function(M,L,$,H,q){var W=L.canvas,Q=M==="normal";if(Q||x[M])$.save(),$.setTransform(1,0,0,1,0,0),$.globalAlpha=H,Q||($.globalCompositeOperation=M),$.drawImage(W,q.x,q.y),$.restore();else{var K=D[M];if(!K)return;for(var Y=$.getImageData(q.x,q.y,W.width,W.height),ee=Y.data,re=L.getImageData(0,0,W.width,W.height).data,oe=0,le=ee.length;oe<le;oe+=4){d=re[oe],p=ee[oe],f=re[oe+1],y=ee[oe+1],m=re[oe+2],I=ee[oe+2],v=re[oe+3],A=ee[oe+3],K();var Ie=v*H/255,Se=1-Ie;ee[oe]=Ie*P+Se*p,ee[oe+1]=Ie*C+Se*y,ee[oe+2]=Ie*S+Se*I,ee[oe+3]=v*H+Se*A}$.putImageData(Y,q.x,q.y)}}},Ae=new function(){var o="http://www.w3.org/2000/svg",l="http://www.w3.org/2000/xmlns",c="http://www.w3.org/1999/xlink",d={href:c,xlink:l,xmlns:l+"/","xmlns:xlink":l+"/"};function f(p,y,I){return v(i.createElementNS(o,p),y,I)}function m(p,y){var I=d[y],A=I?p.getAttributeNS(I,y):p.getAttribute(y);return A==="null"?null:A}function v(p,y,I){for(var A in y){var P=y[A],C=d[A];typeof P=="number"&&I&&(P=I.number(P)),C?p.setAttributeNS(C,A,P):p.setAttribute(A,P)}return p}return{svg:o,xmlns:l,xlink:c,create:f,get:m,set:v}},Re=s.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(o,l){return!l&&(o instanceof Ce||o instanceof _e||o instanceof nt)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(o,l){var c=s.capitalize(l),d=o[2];this[l]={type:o[1],property:l,attribute:o[0],toSVG:d,fromSVG:d&&s.each(d,function(f,m){this[f]=m},{}),exportFilter:o[3],get:"get"+c,set:"set"+c}},{});new function(){var o;function l(D,x,b){var M=new s,L=D.getTranslation();if(x){var $;D.isInvertible()?(D=D._shiftless(),$=D._inverseTransform(L),L=null):$=new E,M[b?"cx":"x"]=$.x,M[b?"cy":"y"]=$.y}if(!D.isIdentity()){var H=D.decompose();if(H){var q=[],W=H.rotation,Q=H.scaling,K=H.skewing;L&&!L.isZero()&&q.push("translate("+o.point(L)+")"),W&&q.push("rotate("+o.number(W)+")"),(!w.isZero(Q.x-1)||!w.isZero(Q.y-1))&&q.push("scale("+o.point(Q)+")"),K.x&&q.push("skewX("+o.number(K.x)+")"),K.y&&q.push("skewY("+o.number(K.y)+")"),M.transform=q.join(" ")}else M.transform="matrix("+D.getValues().join(",")+")"}return M}function c(D,x){for(var b=l(D._matrix),M=D._children,L=Ae.create("g",b,o),$=0,H=M.length;$<H;$++){var q=M[$],W=F(q,x);if(W)if(q.isClipMask()){var Q=Ae.create("clipPath");Q.appendChild(W),k(q,Q,"clip"),Ae.set(L,{"clip-path":"url(#"+Q.id+")"})}else L.appendChild(W)}return L}function d(D,x){var b=l(D._matrix,!0),M=D.getSize(),L=D.getImage();return b.x-=M.width/2,b.y-=M.height/2,b.width=M.width,b.height=M.height,b.href=x.embedImages==!1&&L&&L.src||D.toDataURL(),Ae.create("image",b,o)}function f(D,x){var b=x.matchShapes;if(b){var M=D.toShape(!1);if(M)return m(M)}var L=D._segments,$=L.length,H,q=l(D._matrix);if(b&&$>=2&&!D.hasHandles())if($>2){H=D._closed?"polygon":"polyline";for(var W=[],Q=0;Q<$;Q++)W.push(o.point(L[Q]._point));q.points=W.join(" ")}else{H="line";var K=L[0]._point,Y=L[1]._point;q.set({x1:K.x,y1:K.y,x2:Y.x,y2:Y.y})}else H="path",q.d=D.getPathData(null,x.precision);return Ae.create(H,q,o)}function m(D){var x=D._type,b=D._radius,M=l(D._matrix,!0,x!=="rectangle");if(x==="rectangle"){x="rect";var L=D._size,$=L.width,H=L.height;M.x-=$/2,M.y-=H/2,M.width=$,M.height=H,b.isZero()&&(b=null)}return b&&(x==="circle"?M.r=b:(M.rx=b.width,M.ry=b.height)),Ae.create(x,M,o)}function v(D,x){var b=l(D._matrix),M=D.getPathData(null,x.precision);return M&&(b.d=M),Ae.create("path",b,o)}function p(D,x){var b=l(D._matrix,!0),M=D._definition,L=S(M,"symbol"),$=M._item,H=$.getStrokeBounds();return L||(L=Ae.create("symbol",{viewBox:o.rectangle(H)}),L.appendChild(F($,x)),k(M,L,"symbol")),b.href="#"+L.id,b.x+=H.x,b.y+=H.y,b.width=H.width,b.height=H.height,b.overflow="visible",Ae.create("use",b,o)}function y(D){var x=S(D,"color");if(!x){var b=D.getGradient(),M=b._radial,L=D.getOrigin(),$=D.getDestination(),H;if(M){H={cx:L.x,cy:L.y,r:L.getDistance($)};var q=D.getHighlight();q&&(H.fx=q.x,H.fy=q.y)}else H={x1:L.x,y1:L.y,x2:$.x,y2:$.y};H.gradientUnits="userSpaceOnUse",x=Ae.create((M?"radial":"linear")+"Gradient",H,o);for(var W=b._stops,Q=0,K=W.length;Q<K;Q++){var Y=W[Q],ee=Y._color,re=ee.getAlpha(),oe=Y._offset;H={offset:oe??Q/(K-1)},ee&&(H["stop-color"]=ee.toCSS(!0)),re<1&&(H["stop-opacity"]=re),x.appendChild(Ae.create("stop",H,o))}k(D,x,"color")}return"url(#"+x.id+")"}function I(D){var x=Ae.create("text",l(D._matrix,!0),o);return x.textContent=D._content,x}var A={Group:c,Layer:c,Raster:d,Path:f,Shape:m,CompoundPath:v,SymbolItem:p,PointText:I};function P(D,x,b){var M={},L=!b&&D.getParent(),$=[];return D._name!=null&&(M.id=D._name),s.each(Re,function(H){var q=H.get,W=H.type,Q=D[q]();if(H.exportFilter?H.exportFilter(D,Q):!L||!s.equals(L[q](),Q)){if(W==="color"&&Q!=null){var K=Q.getAlpha();K<1&&(M[H.attribute+"-opacity"]=K)}W==="style"?$.push(H.attribute+": "+Q):M[H.attribute]=Q==null?"none":W==="color"?Q.gradient?y(Q):Q.toCSS(!0):W==="array"?Q.join(","):W==="lookup"?H.toSVG[Q]:Q}}),$.length&&(M.style=$.join(";")),M.opacity===1&&delete M.opacity,D._visible||(M.visibility="hidden"),Ae.set(x,M,o)}var C;function S(D,x){return C||(C={ids:{},svgs:{}}),D&&C.svgs[x+"-"+(D._id||D.__id||(D.__id=T.get("svg")))]}function k(D,x,b){C||S();var M=C.ids[b]=(C.ids[b]||0)+1;x.id=b+"-"+M,C.svgs[b+"-"+(D._id||D.__id)]=x}function O(D,x){var b=D,M=null;if(C){b=D.nodeName.toLowerCase()==="svg"&&D;for(var L in C.svgs)M||(b||(b=Ae.create("svg"),b.appendChild(D)),M=b.insertBefore(Ae.create("defs"),b.firstChild)),M.appendChild(C.svgs[L]);C=null}return x.asString?new e.XMLSerializer().serializeToString(b):b}function F(D,x,b){var M=A[D._class],L=M&&M(D,x);if(L){var $=x.onExport;$&&(L=$(D,L,x)||L);var H=JSON.stringify(D._data);H&&H!=="{}"&&H!=="null"&&L.setAttribute("data-paper-data",H)}return L&&P(D,L,b)}function N(D){return D||(D={}),o=new _(D.precision),D}te.inject({exportSVG:function(D){return D=N(D),O(F(this,D,!0),D)}}),ne.inject({exportSVG:function(D){D=N(D);var x=this._children,b=this.getView(),M=s.pick(D.bounds,"view"),L=D.matrix||M==="view"&&b._matrix,$=L&&U.read([L]),H=M==="view"?new V([0,0],b.getViewSize()):M==="content"?te._getBounds(x,$,{stroke:!0}).rect:V.read([M],0,{readNull:!0}),q={version:"1.1",xmlns:Ae.svg,"xmlns:xlink":Ae.xlink};H&&(q.width=H.width,q.height=H.height,(H.x||H.x===0||H.y||H.y===0)&&(q.viewBox=o.rectangle(H)));var W=Ae.create("svg",q,o),Q=W;$&&!$.isIdentity()&&(Q=W.appendChild(Ae.create("g",l($),o)));for(var K=0,Y=x.length;K<Y;K++)Q.appendChild(F(x[K],D,!0));return O(W,D)}})},new function(){var o={},l;function c(x,b,M,L,$,H){var q=Ae.get(x,b)||H,W=q==null?L?null:M?"":0:M?q:parseFloat(q);return/%\s*$/.test(q)?W/100*($?1:l[/x|^width/.test(b)?"width":"height"]):W}function d(x,b,M,L,$,H,q){return b=c(x,b||"x",!1,L,$,H),M=c(x,M||"y",!1,L,$,q),L&&(b==null||M==null)?null:new E(b,M)}function f(x,b,M,L,$){return b=c(x,b||"width",!1,L,$),M=c(x,M||"height",!1,L,$),L&&(b==null||M==null)?null:new j(b,M)}function m(x,b,M){return x==="none"?null:b==="number"?parseFloat(x):b==="array"?x?x.split(/[\s,]+/g).map(parseFloat):[]:b==="color"?F(x)||x:b==="lookup"?M[x]:x}function v(x,b,M,L){var $=x.childNodes,H=b==="clippath",q=b==="defs",W=new ae,Q=W._project,K=Q._currentStyle,Y=[];if(!H&&!q&&(W=O(W,x,L),Q._currentStyle=W._style.clone()),L)for(var ee=x.querySelectorAll("defs"),re=0,oe=ee.length;re<oe;re++)N(ee[re],M,!1);for(var re=0,oe=$.length;re<oe;re++){var le=$[re],Ie;le.nodeType===1&&!/^defs$/i.test(le.nodeName)&&(Ie=N(le,M,!1))&&!(Ie instanceof Oe)&&Y.push(Ie)}return W.addChildren(Y),H&&(W=O(W.reduce(),x,L)),Q._currentStyle=K,(H||q)&&(W.remove(),W=null),W}function p(x,b){for(var M=x.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),L=[],$=0,H=M.length;$<H;$+=2)L.push(new E(parseFloat(M[$]),parseFloat(M[$+1])));var q=new Te(L);return b==="polygon"&&q.closePath(),q}function y(x){return Ce.create(x.getAttribute("d"))}function I(x,b){var M=(c(x,"href",!0)||"").substring(1),L=b==="radialgradient",$;if(M)$=o[M].getGradient(),$._radial^L&&($=$.clone(),$._radial=L);else{for(var H=x.childNodes,q=[],W=0,Q=H.length;W<Q;W++){var K=H[W];K.nodeType===1&&q.push(O(new yn,K))}$=new sn(q,L)}var Y,ee,re,oe=c(x,"gradientUnits",!0)!=="userSpaceOnUse";L?(Y=d(x,"cx","cy",!1,oe,"50%","50%"),ee=Y.add(c(x,"r",!1,!1,oe,"50%"),0),re=d(x,"fx","fy",!0,oe)):(Y=d(x,"x1","y1",!1,oe,"0%","0%"),ee=d(x,"x2","y2",!1,oe,"100%","0%"));var le=O(new Ke($,Y,ee,re),x);return le._scaleToBounds=oe,null}var A={"#document":function(x,b,M,L){for(var $=x.childNodes,H=0,q=$.length;H<q;H++){var W=$[H];if(W.nodeType===1)return N(W,M,L)}},g:v,svg:v,clippath:v,polygon:p,polyline:p,path:y,lineargradient:I,radialgradient:I,image:function(x){var b=new me(c(x,"href",!0));return b.on("load",function(){var M=f(x);this.setSize(M);var L=d(x).add(M.divide(2));this._matrix.append(new U().translate(L))}),b},symbol:function(x,b,M,L){return new Oe(v(x,b,M,L),!0)},defs:v,use:function(x){var b=(c(x,"href",!0)||"").substring(1),M=o[b],L=d(x);return M?M instanceof Oe?M.place(L):M.clone().translate(L):null},circle:function(x){return new _e.Circle(d(x,"cx","cy"),c(x,"r"))},ellipse:function(x){return new _e.Ellipse({center:d(x,"cx","cy"),radius:f(x,"rx","ry")})},rect:function(x){return new _e.Rectangle(new V(d(x),f(x)),f(x,"rx","ry"))},line:function(x){return new Te.Line(d(x,"x1","y1"),d(x,"x2","y2"))},text:function(x){var b=new Dt(d(x).add(d(x,"dx","dy")));return b.setContent(x.textContent.trim()||""),b},switch:v};function P(x,b,M,L){if(x.transform){for(var $=(L.getAttribute(M)||"").split(/\)\s*/g),H=new U,q=0,W=$.length;q<W;q++){var Q=$[q];if(!Q)break;for(var K=Q.split(/\(\s*/),Y=K[0],ee=K[1].split(/[\s,]+/g),re=0,oe=ee.length;re<oe;re++)ee[re]=parseFloat(ee[re]);switch(Y){case"matrix":H.append(new U(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]));break;case"rotate":H.rotate(ee[0],ee[1]||0,ee[2]||0);break;case"translate":H.translate(ee[0],ee[1]||0);break;case"scale":H.scale(ee);break;case"skewX":H.skew(ee[0],0);break;case"skewY":H.skew(0,ee[0]);break}}x.transform(H)}}function C(x,b,M){var L=M==="fill-opacity"?"getFillColor":"getStrokeColor",$=x[L]&&x[L]();$&&$.setAlpha(parseFloat(b))}var S=s.set(s.each(Re,function(x){this[x.attribute]=function(b,M){if(b[x.set]&&(b[x.set](m(M,x.type,x.fromSVG)),x.type==="color")){var L=b[x.get]();if(L&&L._scaleToBounds){var $=b.getBounds();L.transform(new U().translate($.getPoint()).scale($.getSize()))}}}},{}),{id:function(x,b){o[b]=x,x.setName&&x.setName(b)},"clip-path":function(x,b){var M=F(b);if(M)if(M=M.clone(),M.setClipMask(!0),x instanceof ae)x.insertChild(0,M);else return new ae(M,x)},gradientTransform:P,transform:P,"fill-opacity":C,"stroke-opacity":C,visibility:function(x,b){x.setVisible&&x.setVisible(b==="visible")},display:function(x,b){x.setVisible&&x.setVisible(b!==null)},"stop-color":function(x,b){x.setColor&&x.setColor(b)},"stop-opacity":function(x,b){x._color&&x._color.setAlpha(parseFloat(b))},offset:function(x,b){if(x.setOffset){var M=b.match(/(.*)%$/);x.setOffset(M?M[1]/100:parseFloat(b))}},viewBox:function(x,b,M,L,$){var H=new V(m(b,"array")),q=f(L,null,null,!0),W,Q;if(x instanceof ae){var K=q?q.divide(H.getSize()):1,Q=new U().scale(K).translate(H.getPoint().negate());W=x}else x instanceof Oe&&(q&&H.setSize(q),W=x._item);if(W){if(k(L,"overflow",$)!=="visible"){var Y=new _e.Rectangle(H);Y.setClipMask(!0),W.addChild(Y)}Q&&W.transform(Q)}}});function k(x,b,M){var L=x.attributes[b],$=L&&L.value;if(!$&&x.style){var H=s.camelize(b);$=x.style[H],!$&&M.node[H]!==M.parent[H]&&($=M.node[H])}return $?$==="none"?null:$:n}function O(x,b,M){var L=b.parentNode,$={node:Ct.getStyles(b)||{},parent:!M&&!/^defs$/i.test(L.tagName)&&Ct.getStyles(L)||{}};return s.each(S,function(H,q){var W=k(b,q,$);x=W!==n&&H(x,W,q,b,$)||x}),x}function F(x){var b=x&&x.match(/\((?:["'#]*)([^"')]+)/),M=b&&b[1],L=M&&o[r?M.replace(r.location.href.split("#")[0]+"#",""):M];return L&&L._scaleToBounds&&(L=L.clone(),L._scaleToBounds=!0),L}function N(x,b,M){var L=x.nodeName.toLowerCase(),$=L!=="#document",H=i.body,q,W,Q;M&&$&&(l=de.getView().getSize(),l=f(x,null,null,!0)||l,q=Ae.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),W=x.parentNode,Q=x.nextSibling,q.appendChild(x),H.appendChild(q));var K=de.settings,Y=K.applyMatrix,ee=K.insertItems;K.applyMatrix=!1,K.insertItems=!1;var re=A[L],oe=re&&re(x,L,b,M)||null;if(K.insertItems=ee,K.applyMatrix=Y,oe){$&&!(oe instanceof ae)&&(oe=O(oe,x,M));var le=b.onImport,Ie=$&&x.getAttribute("data-paper-data");le&&(oe=le(x,oe,b)||oe),b.expandShapes&&oe instanceof _e&&(oe.remove(),oe=oe.toPath()),Ie&&(oe._data=JSON.parse(Ie))}return q&&(H.removeChild(q),W&&(Q?W.insertBefore(x,Q):W.appendChild(x))),M&&(o={},oe&&s.pick(b.applyMatrix,Y)&&oe.matrix.apply(!0,!0)),oe}function D(x,b,M){if(!x)return null;b=typeof b=="function"?{onLoad:b}:b||{};var L=de,$=null;function H(K){try{var Y=typeof K=="object"?K:new e.DOMParser().parseFromString(K.trim(),"image/svg+xml");if(!Y.nodeName)throw Y=null,new Error("Unsupported SVG source: "+x);de=L,$=N(Y,b,!0),(!b||b.insert!==!1)&&M._insertItem(n,$);var ee=b.onLoad;ee&&ee($,K)}catch(re){q(re)}}function q(K,Y){var ee=b.onError;if(ee)ee(K,Y);else throw new Error(K)}if(typeof x=="string"&&!/^[\s\S]*</.test(x)){var W=i.getElementById(x);W?H(W):X.request({url:x,async:!0,onLoad:H,onError:q})}else if(typeof File<"u"&&x instanceof File){var Q=new FileReader;return Q.onload=function(){H(Q.result)},Q.onerror=function(){q(Q.error)},Q.readAsText(x)}else H(x);return $}te.inject({importSVG:function(x,b){return D(x,b,this)}}),ne.inject({importSVG:function(x,b){return this.activate(),D(x,b,this)}})};var de=new(u.inject(s.exports,{Base:s,Numerical:w,Key:qr,DomEvent:Bt,DomElement:Ct,document:i,window:r,Symbol:Oe,PlacedSymbol:Ze}));return de.agent.node&&tS(de),typeof n=="function"&&n.amd?n("paper",de):t&&(t.exports=de),de}).call(x2,typeof self=="object"?self:null)})(a2);var m8=a2.exports;const He=lS(m8),p8=t=>{const e=He.project.importSVG(`<path d="${t}" />`,{applyMatrix:!0,insert:!1}),n={path:e.exportSVG().getAttribute("d"),edges:e.curves.length,height:Math.round(e.bounds.height),width:Math.round(e.bounds.width),length:Math.round(e.length)};if(e.remove(),n.edges<3||n.edges>23)throw new Error("Invalid path");return n},_8=({tangram:t,deferred:e})=>{const{tangramsStarredBy:n}=G.useContext(br),r=G.useMemo(()=>{let i=0;for(const s in n[t.id])n[t.id][s]&&(i+=1);return i},[t,n]);return R.jsx(Ji,{onClose:()=>e.reject(an),css:{gap:3},children:R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1",alignItems:"center"},children:[R.jsx(ed,{selected:!0,tangram:t}),R.jsx(Ye,{css:{fontSize:2},children:R.jsx(wt,{id:"Earned {stars}",values:{stars:r,starIcon:()=>R.jsx(yr,{icon:Eo,css:{fill:"currentColor"}})}})})]})})},v8=({tangram:t,deferred:e})=>{const n=Yt(),r=G.useContext(si),{currentUser:i}=G.useContext(zn),[s,a]=G.useState(()=>({...t})),{tangramsStarredBy:u}=G.useContext(br),h=i&&!t.id,g=G.useMemo(()=>({path:t.path,category:t.category,emoji:t.category!=="digits"&&t.category!=="letters"?t.emoji:eS(),letterIndex:t.category==="letters"?ic.indexOf(t.emoji):void 0,digitIndex:t.category==="digits"?rc.indexOf(t.emoji):void 0}),[t]),{handleSubmit:_,register:w,watch:T,setError:E,clearErrors:z,formState:j}=Ha({defaultValues:g}),{path:J,category:V,emoji:B,letterIndex:U,digitIndex:Z}=T();G.useEffect(()=>{try{const ce=p8(J);a(_e=>({..._e,...ce})),z("path")}catch{E("path",{type:"invalid",message:n.formatMessage({id:"Invalid path"})})}},[J,E,z,n]),G.useEffect(()=>{const ce=V==="letters"?ic[U]:V==="digits"?rc[Z]:B||eS();a(_e=>({..._e,emoji:ce}))},[V,B,U,Z]),G.useEffect(()=>{a(ce=>({...ce,category:V}))},[V]);const ne=async()=>{window.confirm(n.formatMessage({id:"Are you sure you want to delete this tangram?"}))&&(await Rt.firestore().collection("tangrams").doc(t.id).delete(),r(n.formatMessage({id:"Tangram deleted successfuly"})),e.resolve())},te=async()=>{h?(await Rt.firestore().collection("tangrams").add({...s,uid:i.uid,approved:!1}),r(n.formatMessage({id:"Tangram submitted for review"}))):(await Rt.firestore().collection("tangrams").doc(t.id).update(s),r(n.formatMessage({id:"Tangram modified successfuly"}))),e.resolve()},ae=G.useMemo(()=>{if(!t.approved)return 0;let ce=0;for(const _e in u[t.id])u[t.id][_e]&&(ce+=1);return ce},[t,u]);return R.jsxs(Ji,{title:R.jsx(Vr,{children:h?n.formatMessage({id:"Submit your tangram"}):n.formatMessage({id:"Edit your tangram"})}),onClose:()=>e.reject(an),as:"form",onSubmit:_(te),css:{gap:3},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsx(ed,{showStroke:i.isAdmin,selected:!0,completed:!0,tangram:s,css:{alignSelf:"center"}}),t.approved&&R.jsx(Ye,{css:{alignSelf:"center",fontSize:2},children:R.jsx(wt,{id:"Earned {stars}",values:{stars:ae,starIcon:()=>R.jsx(yr,{icon:Eo,css:{fill:"currentColor"}})}})}),h&&!i.isAdmin&&R.jsx(as,{children:R.jsx(wt,{id:"A moderator will have to approve your tangram. It can be deleted or edited at any time.",values:{br:()=>R.jsx("br",{})}})}),i&&i.isAdmin&&R.jsx(R.Fragment,{children:R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Path"})}),R.jsx(cn,{as:"textarea",...w("path")}),j.errors.path&&R.jsx(xr,{children:j.errors.path.message})]})}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Category"})}),R.jsx(cn,{as:"select",...w("category"),children:S2.map(ce=>R.jsx("option",{value:ce,children:n.formatMessage({id:ce})},ce))})]}),V==="digits"?R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(cn,{as:"select",...w("digitIndex"),children:rc.map((ce,_e)=>R.jsx("option",{value:_e,children:ce},_e))})]}):V==="letters"?R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(cn,{as:"select",...w("letterIndex"),children:ic.map((ce,_e)=>R.jsx("option",{value:_e,children:ce},_e))})]}):R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(cn,{...w("emoji")}),R.jsx(as,{children:n.formatMessage({id:"Leave empty for random emoji"})})]})]}),R.jsx(ar,{type:"submit",children:h?n.formatMessage({id:"Submit!"}):n.formatMessage({id:"Edit!"})}),!h&&R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(vi,{onClick:ne,children:n.formatMessage({id:"Or delete tangram"})})})]})},y8=({tangram:t,deferred:e})=>{const{currentUser:n}=G.useContext(zn);return n&&(n.isAdmin||!t.id||t.uid===n.uid)?R.jsx(v8,{tangram:t,deferred:e}):R.jsx(_8,{tangram:t,deferred:e})};class is{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}const l2=G.createContext([!0,()=>{}]),oI=()=>G.useContext(l2),w8=({children:t})=>{const[e,n]=G.useState(!0);G.useEffect(()=>{const s=window.localStorage.getItem("showBackgroundPattern");if(s===null){n(!0);return}try{const a=JSON.parse(s);n(!!JSON.parse(a))}catch{window.localStorage.removeItem("showBackgroundPattern")}},[]);const r=G.useCallback(()=>{const s=!e;n(s),window.localStorage.setItem("showBackgroundPattern",JSON.stringify(s))},[e]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(l2.Provider,{value:i,children:t})},u2=G.createContext(["",()=>{}]),c2=()=>G.useContext(u2),nS="css-system-theme",rS={breakpoints:{s:"40em",m:"52em",l:"64em"},space:[0,4,8,16,32,64,128,256,512],sizes:{menu:40,inline:16,logo:128,icon:24,badge:32,badgeBig:86},borderWidths:{loader:8},radii:[0,4,8,16,32],fontSizes:[10,12,14,18,22,30,46,62,70]},Vd={light:{...rS,colors:{pieces:{st1:"#FECA57",st2:"#48DBFB",mt1:"#1DD1A1",lt1:"#FF6B6B",lt2:"#8557E0",sq:"#FF9FF3",rh:"#54A0FF"},difficulties:["#10ac84","#2e86de","#ee5253"],shape:"#121212",background:"#fff",dialogBackground:"#d9d9d9",dialogText:"#303030",inputBackground:"#fff",errorText:"#bd0808",notificationBackground:"#FFFFFFdd"}},dark:{...rS,colors:{pieces:{st1:"#CE9518",st2:"#1CACCB",mt1:"#0CA57C",lt1:"#C33B3B",lt2:"#5C2DB9",sq:"#C95EBC",rh:"#2E75CF"},difficulties:["#0b8767","#1a6cbd","#ce3737"],shape:"#595959",background:"#15141a",dialogBackground:"#383838",dialogText:"#d8d8d8",inputBackground:"#595959",errorText:"#e63c3c",notificationBackground:"#000000dd"}}},I8="light",E8=({children:t})=>{const[e,n]=G.useState(I8);G.useEffect(()=>{const s=window.localStorage.getItem(nS);Vd[s]&&n(s)},[]);const r=G.useCallback(s=>{Vd[s]&&(n(s),window.localStorage.setItem(nS,s))},[Vd]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(u2.Provider,{value:i,children:R.jsx(Ti.Provider,{value:Vd[e],children:t})})},aI=G.createContext(),T8=({deferred:t,tip:{id:e,title:n=R.jsx(Vr,{children:R.jsx(wt,{id:"Random tip"})}),content:r}})=>{const i=Yt(),[s,a]=G.useState(!1);return R.jsxs(Ji,{onClose:()=>t.reject(an),title:n,css:{gap:3},children:[r,R.jsx(ar,{onClick:()=>t.resolve(s),children:i.formatMessage({id:"Got it!"})}),e!=="welcome"&&R.jsxs(fe,{as:"label",css:{gap:1,flexDirection:"row",cursor:"pointer",alignItems:"flex-end"},children:[R.jsx("input",{type:"checkbox",checked:s,onChange:()=>a(!s)}),R.jsx(Ye,{as:"small",children:i.formatMessage({id:"I don't want to see tips anymore"})})]})]})},er={settingsIcon:R.jsx(yr,{icon:Qk}),accountIcon:R.jsx(yr,{icon:Xk}),menuIcon:R.jsx(yr,{icon:Wk}),galleryIcon:R.jsx(yr,{icon:Gk}),shareIcon:R.jsx(yr,{icon:Yk}),createIcon:R.jsx(yr,{icon:Kk}),leaderboardIcon:R.jsx(yr,{icon:qk}),starIcon:R.jsx(yr,{icon:Eo}),br:()=>R.jsx("br",{})},S8=[{id:"particles",predicate:({particles:t})=>t,content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.particles",values:er})})},{id:"menu",content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.menu",values:er})})},{id:"gallery",content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.gallery",values:er})})},{id:"difficulty",predicate:({showBackgroundPattern:t})=>t,content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.difficulty",values:er})})},{id:"theme",predicate:({themeKey:t})=>t!=="dark",content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.theme",values:er})})},{id:"sound",predicate:({soundEnabled:t})=>t,content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.sound",values:er})})},{id:"account1",predicate:({currentUser:t})=>!t,content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.account1",values:er})})},{id:"account2",predicate:({currentUser:t})=>!t,content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.account2",values:er})})},{id:"stars",predicate:({currentUser:t})=>t,content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.stars",values:er})})},{id:"create",predicate:({currentUser:t,approvedTangrams:e,isTangramCompleted:n})=>{if(t){let r=0;for(const{id:i}of e)if(n(i)&&(r+=1,r===10))return!0}return!1},content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.create",values:er})})},{id:"share",content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.share",values:er})})},{id:"card",content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.card",values:er})})},{id:"leaderboard",content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.leaderboard",values:er})})}],x8=({children:t})=>{const e=Yt(),n=G.useContext(si),[r,i]=G.useState(null),[s,a]=G.useState(!0),{soundEnabled:u}=G.useContext(oi),[h]=c2(),[g]=oI(),{currentUser:_}=G.useContext(zn),{approvedTangrams:w}=G.useContext(Oo),{isTangramCompleted:T}=G.useContext(br);G.useEffect(()=>{a(window.localStorage.getItem("hideTips")===null)},[]),G.useEffect(()=>{s?window.localStorage.removeItem("hideTips"):window.localStorage.setItem("hideTips",!0)},[s]);const E=()=>{let Z=[];const ne=localStorage.getItem("seenTips");if(ne)try{const te=JSON.parse(ne);if(!Array.isArray(te))throw new Error("Invalid data for seenTips : "+te);Z=te}catch{localStorage.removeItem("seenTips")}return Z},z=G.useCallback(Z=>{const ne=E(),te=new is;return i({deferred:te,tip:Z}),te.promise.then(ae=>{ae&&a(!1)}).finally(()=>{localStorage.setItem("seenTips",JSON.stringify([...ne,Z.id])),i(null)})},[]),j=G.useCallback(()=>{!s||E().includes("welcome")||(!_||!w.some(ne=>T(ne.id)))&&z({id:"welcome",title:R.jsx(Vr,{children:R.jsx(wt,{id:"Welcome to Amstangram",values:er})}),content:R.jsx(Ye,{css:{textAlign:"justify"},children:R.jsx(wt,{id:"tips.welcome",values:er})})})},[z,s,_,w,T]),J=G.useCallback(()=>{if(!s)return;const Z=E(),ne=S8.filter(({id:ae,predicate:ce=()=>!0})=>!Z.includes(ae)&&ce({themeKey:h,showBackgroundPattern:g,currentUser:_,approvedTangrams:w,isTangramCompleted:T,soundEnabled:u}));if(!ne.length)return;const te=ne[0];z(te)},[z,w,T,h,_,g,u,s]),V=G.useCallback(()=>{a(Z=>!Z)},[]),B=G.useCallback(()=>{a(!0),window.localStorage.removeItem("seenTips"),n(e.formatMessage({id:"Tips reseted successfuly"}))},[n,e]),U=G.useMemo(()=>({showRandomTip:J,showWelcome:j,tipsEnabled:s,toggleTips:V,resetTips:B}),[J,j,s,V,B]);return R.jsxs(aI.Provider,{value:U,children:[t,r&&R.jsx(T8,{...r})]})},Fd=20,$u=({leftComponent:t,leftValue:e,rightComponent:n,rightValue:r,value:i,onChange:s,invertSounds:a})=>{const{playToggle:u,soundEnabled:h}=G.useContext(oi),g=G.useContext(Ti),_=G.useMemo(()=>i===r?"right":"left",[i,r]),w=()=>{a?h||u({forceSoundEnabled:!0}):u()},T=()=>{s((_==="left"?"right":"left")==="right"?r:e),w()},E=z=>{z!==_&&(s(z==="right"?r:e),w())};return R.jsxs(fe,{css:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:3},children:[R.jsx(fe,{css:{cursor:"pointer",flex:"1",alignItems:"flex-end"},onClick:()=>E("left"),children:t}),R.jsx(fe,{onClick:T,css:{cursor:"pointer",position:"relative",bg:"inputBackground",width:`${2*Fd}px`,height:`${Fd}px`,borderRadius:"99999px"},children:R.jsx(fe,{css:{position:"absolute",size:`${Fd}px`,borderRadius:"99999px",bg:"dialogText",boxShadow:`0 0 0 2px ${g.colors.inputBackground}`,transition:"left 250ms ease-in-out"},style:{left:_==="left"?0:Fd}})}),R.jsx(fe,{css:{cursor:"pointer",flex:"1",alignItems:"flex-start"},onClick:()=>E("right"),children:n})]})},h2=G.createContext([!0,()=>{}]),d2=()=>G.useContext(h2),C8=({children:t})=>{const[e,n]=G.useState(!0);G.useEffect(()=>{const s=window.localStorage.getItem("showParticles");if(s===null){n(!0);return}try{const a=JSON.parse(s);n(!!JSON.parse(a))}catch{window.localStorage.removeItem("showParticles")}},[]);const r=G.useCallback(()=>{const s=!e;n(s),window.localStorage.setItem("showParticles",JSON.stringify(s))},[e]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(h2.Provider,{value:i,children:t})},A8=({deferred:t})=>{const{soundEnabled:e,toggleSound:n}=G.useContext(oi),{tipsEnabled:r,toggleTips:i,resetTips:s}=G.useContext(aI),[a,u]=oI(),[h,g]=d2(),{language:_,setLanguage:w}=G.useContext(sI),T=Yt(),[E,z]=c2(),j=J=>{w(J.target.value)};return R.jsxs(Ji,{title:R.jsx(Vr,{children:T.formatMessage({id:"Settings"})}),onClose:()=>t.reject(an),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Language"})}),R.jsx(cn,{as:"select",onChange:j,value:_,children:Zv.map(J=>R.jsx("option",{value:J,children:T.formatMessage({id:J})},J))})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Difficulty"})}),R.jsx($u,{value:a,onChange:u,leftComponent:R.jsx(Ye,{children:T.formatMessage({id:"Easy"})}),leftValue:!0,rightComponent:R.jsx(Ye,{children:T.formatMessage({id:"Hard"})}),rightValue:!1})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Theme"})}),R.jsx($u,{value:E,onChange:z,leftComponent:R.jsx(fe,{as:hz,css:{size:"icon"}}),leftValue:"light",rightComponent:R.jsx(fe,{as:uz,css:{size:"icon"}}),rightValue:"dark"})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Sounds"})}),R.jsx($u,{invertSounds:!0,value:e,onChange:n,leftComponent:R.jsx(fe,{as:fz,css:{size:"icon"}}),leftValue:!1,rightComponent:R.jsx(fe,{as:dz,css:{size:"icon"}}),rightValue:!0})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Show particles"})}),R.jsx($u,{value:h,onChange:g,leftComponent:R.jsx(Ye,{children:T.formatMessage({id:"Yes"})}),leftValue:!0,rightComponent:R.jsx(Ye,{children:T.formatMessage({id:"No"})}),rightValue:!1})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:T.formatMessage({id:"Show tips"})}),R.jsx($u,{value:r,onChange:i,leftComponent:R.jsx(Ye,{children:T.formatMessage({id:"Yes"})}),leftValue:!0,rightComponent:R.jsx(Ye,{children:T.formatMessage({id:"No"})}),rightValue:!1})]})]}),R.jsx(Sz,{onClick:s,children:T.formatMessage({id:"Reset tips"})})]})},rd=G.createContext(),P8=({children:t})=>{const{initialized:e}=G.useContext(zn),{playlist:n,setPlaylist:r,startRandomPlaylist:i,initialized:s}=G.useContext(br),{initialized:a,approvedTangrams:u}=G.useContext(Oo),[h,g]=G.useState(!1),[_,w]=G.useState(null),T=G.useCallback(async et=>{const he=new is;w({uid:et,deferred:he});try{await he.promise}catch(it){if(it!==an)throw it}finally{w(null)}},[]),[E,z]=G.useState(null),j=G.useCallback(async()=>{const et=new is;z(et);try{await et.promise}catch(he){if(he!==an)throw he}finally{z(null)}},[]),[J,V]=G.useState(null),B=G.useCallback(async()=>{const et=new is;V(et);try{await et.promise}catch(he){if(he!==an)throw he}finally{V(null)}},[]),[U,Z]=G.useState(null),ne=G.useCallback(async()=>{const et=new is;Z(et);try{await et.promise}catch(he){if(he!==an)throw he}finally{Z(null)}},[]),[te,ae]=G.useState(null),ce=G.useCallback(async et=>{const he=new is;ae({deferred:he,tangram:et});try{await he.promise}catch(it){if(it!==an)throw it}finally{ae(null)}},[]),[_e,me]=G.useState(null),Ze=G.useCallback(async()=>{const et=new is;me(et);try{await et.promise}catch(he){if(he!==an)throw he}finally{me(null)}},[]),[Oe,xe]=G.useState(null);G.useEffect(()=>{(async()=>{if(a&&s&&e&&!h){let he=!1;if(!n&&window.location.search){const it=new URLSearchParams(window.location.search);if(it.has("tangrams")){const Ce=it.get("tangrams").split(","),Te=it.get("uid"),De=u.filter(Qe=>Ce.includes(Qe.id));if(De.length){window.history.replaceState({},document.title,window.location.origin);const Qe=new is;xe({deferred:Qe,tangrams:De,uid:Te});try{await Qe.promise,he=!0,r(De)}catch(vt){if(vt!==an)throw vt}finally{xe(null)}}}}he||i(!0),g(!0)}})()},[a,s,e,h]);const we=G.useMemo(()=>({showProfile:T,showLeaderboard:j,showGallery:B,showLogin:ne,showTangram:ce,showSettings:Ze}),[T,j,B,ne,ce,Ze]);return R.jsxs(rd.Provider,{value:we,children:[t,U&&R.jsx(r8,{deferred:U}),J&&R.jsx(Dz,{deferred:J}),te&&R.jsx(y8,{...te}),_&&R.jsx(d8,{..._}),E&&R.jsx(Mz,{deferred:E}),Oe&&R.jsx(Pz,{...Oe}),_e&&R.jsx(A8,{deferred:_e})]})},tl=({action:t,icon:e,text:n})=>{const{playButton:r}=G.useContext(oi);return R.jsxs(fe,{css:{alignItems:"center",flexDirection:"row",gap:3,cursor:"pointer",py:3},onClick:()=>{r(),t()},children:[R.jsx(fe,{as:e,css:{size:"icon"}}),R.jsx(Ye,{css:{fontSize:3},children:n})]})},b8=()=>{const{playlist:t,saveRequestId:e}=G.useContext(br),{currentUser:n}=G.useContext(zn),{playButton:r}=G.useContext(oi),i=Yt(),{showLeaderboard:s,showGallery:a,showLogin:u,showProfile:h,showSettings:g}=G.useContext(rd),[_,w]=G.useState();G.useEffect(()=>{_&&_.reject(an)},[t,e]);const{requestSave:T}=G.useContext(br),E=async()=>{r();const J=new is;w(J);try{await J.promise}catch(V){if(V!==an)throw V}finally{w(null)}},z=_f({0:{color:"pieces.lt2"},14:{color:"pieces.rh"},28:{color:"pieces.st2"},42:{color:"pieces.mt1"},57:{color:"pieces.st1"},71:{color:"pieces.lt1"},85:{color:"pieces.sq"},100:{color:"pieces.lt2"}}),j=_f({from:{transform:"translate(0, 0)"},to:{transform:"translate(30px, -30px)"}});return R.jsxs(R.Fragment,{children:[R.jsx(fe,{css:{position:"fixed",top:3,left:3,animation:`${z} 20s linear infinite both`},children:R.jsx(fe,{as:Wk,css:{size:"menu",cursor:"pointer"},onClick:E})}),_&&R.jsxs(Ji,{onClose:()=>_.reject(an),title:R.jsxs(fe,{css:{flexDirection:"row",gap:3,alignItems:"center"},children:[R.jsx(lA,{css:{size:"badge",ml:"-2px",mr:"-6px",overflow:"visible","& > g":{animation:`${j} ${Wr}ms ${Kp}ms ease both`}}}),R.jsx(Vr,{children:i.formatMessage({id:"Amstangram"})})]}),css:{gap:3,overflow:"initial"},children:[R.jsxs(fe,{children:[n?R.jsx(tl,{action:()=>h(n.uid),icon:()=>R.jsx(zm,{css:{mx:-1},uid:n.uid,size:"badge"}),text:i.formatMessage({id:"See my profile"})}):R.jsx(tl,{action:u,icon:Xk,text:i.formatMessage({id:"Log in"})}),R.jsx(tl,{action:a,icon:Gk,text:i.formatMessage({id:"Tangram gallery"})}),R.jsx(tl,{action:T,icon:Kk,text:i.formatMessage({id:"Save tangram"})}),R.jsx(tl,{action:s,icon:qk,text:i.formatMessage({id:"Leaderboard"})}),R.jsx(tl,{action:g,icon:Qk,text:i.formatMessage({id:"Settings"})})]}),R.jsxs(fe,{css:{flexDirection:"row",alignItems:"baseline",justifyContent:"space-between"},children:[R.jsx(as,{as:$1,href:`mailto:millagou.benjamin@gmail.com?subject=${i.formatMessage({id:"A word about Amstangram"})}`,target:"_blank",rel:"noopener, noreferrer",children:i.formatMessage({id:"Contact ðŸ’Œ"})}),R.jsx(as,{as:$1,href:"https://github.com/myagoo/amstangram",target:"_blank",rel:"noopener, noreferrer",children:i.formatMessage({id:"Version {code}"},{code:"âœ¨.ðŸ¥¸.ðŸš€"})})]})]})]})};var Bd=Math.PI*2;function f2(t,e){const n=e.x-t.x,r=e.y-t.y,i=Math.sqrt(n*n+r*r);return{x:-r/i,y:n/i}}function R8(t,e){var n=f2(t,e);return{x:-n.x,y:-n.y}}function lI(t){const e=[];let n=t.length>0?t[0].x:void 0,r=t.length>0?t[0].y:void 0,i=n,s=r;for(let u=0;u<t.length;u++){const h=t[u],g=t[(u+1)%t.length],_=R8(h,g),w=f2(h,g),T={vertex1:h,vertex2:g,index:u,outwardNormal:_,inwardNormal:w};e.push(T);const E=t[u].x,z=t[u].y;n=Math.min(E,n),r=Math.min(z,r),i=Math.max(E,i),s=Math.max(z,s)}return{vertices:t,edges:e,minX:n,minY:r,maxX:i,maxY:s}}function g2(t,e){const n=(e.vertex2.y-e.vertex1.y)*(t.vertex2.x-t.vertex1.x)-(e.vertex2.x-e.vertex1.x)*(t.vertex2.y-t.vertex1.y);if(n==0)return null;const r=((e.vertex2.x-e.vertex1.x)*(t.vertex1.y-e.vertex1.y)-(e.vertex2.y-e.vertex1.y)*(t.vertex1.x-e.vertex1.x))/n,i=((t.vertex2.x-t.vertex1.x)*(t.vertex1.y-e.vertex1.y)-(t.vertex2.y-t.vertex1.y)*(t.vertex1.x-e.vertex1.x))/n,s=r<0||i<0||r>1||i>1;return{x:t.vertex1.x+r*(t.vertex2.x-t.vertex1.x),y:t.vertex1.y+r*(t.vertex2.y-t.vertex1.y),isIntersectionOutside:s}}function m2(t,e,n,r,i,s,a){var u=Math.atan2(i.y-n.y,i.x-n.x),h=Math.atan2(s.y-n.y,s.x-n.x);u<0&&(u+=Bd),h<0&&(h+=Bd);const g=u>h?u-h:u+Bd-h,_=(a?-g:Bd-g)/t;e.push(i);for(let w=1;w<t;++w){const T=u+_*w,E={x:n.x+Math.cos(T)*r,y:n.y+Math.sin(T)*r};e.push(E)}e.push(s)}function p2(t,e,n){return{vertex1:{x:t.vertex1.x+e,y:t.vertex1.y+n},vertex2:{x:t.vertex2.x+e,y:t.vertex2.y+n}}}function k8(t,e,n){const r=[];for(let a=0;a<t.edges.length;a++){const u=t.edges[a],h=u.outwardNormal.x*e,g=u.outwardNormal.y*e;r.push(p2(u,h,g))}const i=[];for(let a=0;a<r.length;a++){const u=r[a],h=r[(a+r.length-1)%r.length],g=g2(h,u);if(g&&(!g.isIntersectionOutside||n<1))i.push({x:g.x,y:g.y});else{const _=t.edges[a].vertex1;m2(n,i,_,e,h.vertex2,u.vertex1,!1)}}const s=lI(i);return s.offsetEdges=r,s}function N8(t,e,n){const r=[];for(let a=0;a<t.edges.length;a++){const u=t.edges[a],h=u.inwardNormal.x*e,g=u.inwardNormal.y*e;r.push(p2(u,h,g))}const i=[];for(let a=0;a<r.length;a++){const u=r[a],h=r[(a+r.length-1)%r.length],g=g2(h,u);if(g&&(!g.isIntersectionOutside||n<1))i.push({x:g.x,y:g.y});else{const _=t.edges[a].vertex1;m2(n,i,_,e,h.vertex2,u.vertex1,!0)}}const s=lI(i);return s.offsetEdges=r,s}function D8(t,e,n=0){const r=lI(t);return e>0?k8(r,e,n).vertices:N8(r,-e,n).vertices}const yh=(t,e)=>D8(t,e,0),M8=t=>{const e=t[1].getDistance(t[2]),n=t[0].getDistance(t[2]),r=t[0].getDistance(t[1]),i=e+n+r,s=(t[0].x*e+t[1].x*n+t[2].x*r)/i,a=(t[0].y*e+t[1].y*n+t[2].y*r)/i;return new He.Point(s,a)},Hu=(t,e)=>{const n=[new He.Point(0,0),new He.Point(t*2,0),new He.Point(t,t)],r=new He.Path({name:"display",segments:n,closed:!0}),i=new He.Path({name:"collision",segments:yh(n,-Jo),closed:!0}),s=new He.Path({name:"insetBorder",segments:yh(n,-os),closed:!0,strokeWidth:os}),a=M8(n),u=new He.Point(He.view.center.x+a.x-r.bounds.width/2,He.view.center.y+a.y-r.bounds.height/2);return new He.Group({children:[r,i,s],position:He.view.center,pivot:u,data:{id:e,collisions:new Set},applyMatrix:!0})},O8=(t,e)=>{const n=[new He.Point(0,0),new He.Point(t*2,0),new He.Point(t*3,t),new He.Point(t,t)],r=new He.Path({name:"display",segments:n,closed:!0}),i=new He.Path({name:"collision",segments:yh(n,-Jo),closed:!0,strokeWidth:Jo}),s=new He.Path({name:"insetBorder",segments:yh(n,-os),closed:!0,strokeWidth:os});return new He.Group({children:[r,i,s],position:He.view.center,data:{id:e,collisions:new Set},applyMatrix:!0})},L8=(t,e)=>{const n=new He.Path.Rectangle({name:"display",point:[0,0],size:[t,t]}),r=new He.Path.Rectangle({name:"collision",point:[Jo,Jo],size:[t-Jo*2,t-Jo*2]}),i=new He.Path.Rectangle({name:"insetBorder",point:[os,os],size:[t-os*2,t-os*2],strokeWidth:os});return new He.Group({children:[n,r,i],position:He.view.center,data:{id:e,collisions:new Set},applyMatrix:!0,rotation:Math.round(Math.random()*7)*45})},V8=()=>{const t=v2,e=Math.sqrt(Math.pow(t,2)*2),n=Math.sqrt(Math.pow(e,2)*2);return new He.Group([Hu(t,"st1"),Hu(t,"st2"),Hu(e,"mt1"),Hu(n,"lt1"),Hu(n,"lt2"),L8(e,"sq"),O8(t,"rh")])},F8=(t,e)=>{let n;for(const h of t.children){const g=h.children.display;n?n=n.unite(g,{insert:!1}):n=g}n.scale(1/e),n.position=new He.Point(n.bounds.width/2,n.bounds.height/2);const r=n.exportSVG().getAttribute("d"),i=n.curves.length,s=Math.round(n.bounds.width),a=Math.round(n.bounds.height),u=Math.round(n.length);return n.remove(),{width:s,height:a,length:u,path:r,edges:i}},iS=(t,e,n)=>{const r={x:n.x-e.x,y:n.y-e.y},i={x:t.x-e.x,y:t.y-e.y},s=r.x*r.x+r.y*r.y;let a=i.x*r.x+i.y*r.y;const u=Math.min(1,Math.max(0,a/s));return a=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x),new He.Point(e.x+r.x*u,e.y+r.y*u)},sS=(t,e,n)=>{for(const r of e)for(const{point:i}of r.segments)for(const{point:s}of t.segments){const a=s.getDistance(i);a<n.distance&&(n.distance=a,n.shape=r,n.vector=i.subtract(s))}if(!n.vector)for(const r of e){for(const{point:i}of t.segments)for(const{point:s,next:{point:a}}of r.segments){const u=iS(i,s,a),h=u.getDistance(i);h<n.distance&&(n.distance=h,n.vector=u.subtract(i),n.shape=r,n.segment=[s,a],n.point=i)}for(const{point:i}of r.segments)for(const{point:s,next:{point:a}}of t.segments){const u=iS(i,s,a),h=u.getDistance(i);h<n.distance&&(n.distance=h,n.vector=i.subtract(u),n.shape=t,n.segment=[s,a])}}return n},oS=(t,e,n)=>{if(n.segment){let r=n.maxDistance,i;const[s,a]=n.segment,u=Math.atan2(a.y-s.y,a.x-s.x),h=Math.atan2(s.y-a.y,s.x-a.x);for(const g of[u,h])for(const{point:_}of t.segments){if(_===n.point)continue;const w=_.add(n.vector),T=new He.Point(w.x+n.maxDistance*Math.cos(g),w.y+n.maxDistance*Math.sin(g)),E=new He.Path.Line({from:w,to:T,insert:!1});for(const z of e){const j=E.getIntersections(z);for(const{point:J}of j){const V=J.subtract(w).add(n.vector);V.length<n.maxDistance&&V.length<=r&&(r=V.length,i=V)}}}i&&(n.vector=i)}},B8=(t,e,n,r)=>{let i={maxDistance:t,distance:t};return sS(e,n,i),r&&sS(e,r,i),oS(e,n.filter(s=>s.shape!==i.shape),i),r&&oS(e,r,i),i.vector},U8=(t,e,n)=>{let r=t;for(const i of e.children){if(i.data.collisions.size>0)return;r=r.unite(new He.Path({segments:yh(i.children.display.segments.map(({point:s})=>s),-n),closed:!0,insert:!1}),{insert:!1})}return Math.round(r.length*1e3)===Math.round(t.length*1e3)},j8=t=>{for(const e of t.children)if(e.data.collisions.size>0)return!1;return!0},Ud=(t,e)=>{const n=t.pivot?t.pivot.subtract(t.bounds.center):new He.Point;t.bounds.x<0&&(t.position.x=t.bounds.width/2+n.x),t.bounds.y<0&&(t.position.y=t.bounds.height/2+n.y),t.bounds.x+t.bounds.width>e.width/window.devicePixelRatio&&(t.position.x=e.width/window.devicePixelRatio-t.bounds.width/2+n.x),t.bounds.y+t.bounds.height>e.height/window.devicePixelRatio&&(t.position.y=e.height/window.devicePixelRatio-t.bounds.height/2+n.y)},z8=(t,e)=>{const n=new He.Point(He.project.view.bounds.width,He.project.view.bounds.height).subtract(cI*2);if(t.position=He.Point.random().multiply(n).add(cI),t.data.id==="rh"){const r=Math.round(Math.random()*3)*45;t.rotation=r,t.data.rotation=r}else t.rotation=Math.round(Math.random()*7)*45},aS=(t,e)=>e.segments.every(n=>t.contains(n.point)),Wp=(t,e)=>{for(const r of e.children){if(r===t)continue;const i=t.children.collision,s=r.children.collision;i.intersects(s)||aS(i,s)||aS(s,i)?(t.data.collisions.add(r.data.id),r.data.collisions.add(t.data.id)):(t.data.collisions.delete(r.data.id),r.data.collisions.delete(t.data.id))}let n=!0;for(const r of e.children)r.data.collisions.size>0?(n=!1,r.children.display.opacity=y2):r.children.display.opacity=1;return n},$8=({tangram:t,onStop:e,onNext:n,onApprove:r,onStarToggle:i})=>{const s=Yt(),[a,u]=G.useState(!1),{playStar:h}=G.useContext(oi),{tangramsStarredBy:g,isTangramStarred:_}=G.useContext(br),w=G.useMemo(()=>{let j=0;for(const J in g[t.id])g[t.id][J]&&(j+=1);return j},[t,g]),T=_(t.id),E=_f({0:{opacity:"0",transform:"rotate(0) scale(0)"},100:{opacity:1,transform:`rotate(${360*5}deg) scale(1)`}}),z=()=>{setTimeout(()=>u(!0),1e3)};return R.jsx(fe,{css:{position:"absolute",top:0,left:0,right:0,bottom:0,alignItems:"center",justifyContent:"center",gap:3},children:R.jsxs(fe,{css:{position:"relative"},children:[R.jsx(fe,{onAnimationEnd:z,css:{textShadow:"0px 5px 10px #00000080",fontSize:"30vmin",animation:`2000ms ${E} cubic-bezier(.6,1.56,.58,.92) forwards`},children:t.emoji},"emojiSpin"),a&&R.jsxs(fe,{css:{mt:3,position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",flexDirection:"row",gap:3,animation:`${Wr}ms fadeIn ease both`},children:[r&&R.jsxs(fe,{as:ar,onClick:r,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:lz,css:{size:"icon"}}),R.jsx(Ye,{children:s.formatMessage({id:"Approve"})})]}),i&&R.jsxs(fe,{as:ar,mute:!0,onClick:()=>{h(),i()},css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(Ye,{children:w}),R.jsx(fe,{as:Eo,css:{size:"icon",fill:T?"currentColor":void 0},deps:[T]})]}),n?R.jsxs(fe,{as:ar,onClick:n,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:cz,css:{size:"icon"}}),R.jsx(Ye,{children:s.formatMessage({id:"Next"})})]}):R.jsxs(fe,{as:ar,onClick:e,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:Jk,css:{size:"icon"}}),R.jsx(Ye,{children:s.formatMessage({id:"Quit"})})]})]})]})})},H8=()=>{const t=Yt(),{showRandomTip:e,showWelcome:n}=G.useContext(aI),{showLogin:r,showTangram:i}=G.useContext(rd),{playTangram:s,playVictory:a}=G.useContext(oi),u=G.useRef();u.current={tangram:s,victory:a};const{currentUser:h}=G.useContext(zn),g=G.useRef();g.current=h;const _=G.useContext(Ti),w=G.useContext(si),[T]=oI(),[E]=d2(),{saveRequestId:z,playlist:j,setPlaylist:J,markTangramAsComplete:V,toggleTangramStar:B}=G.useContext(br),U=G.useRef();U.current=V;const[Z,ne]=G.useState(0),[te,ae]=G.useState(!1),ce=G.useRef(),_e=G.useRef(),me=G.useRef(),Ze=G.useRef(),Oe=G.useRef(),xe=G.useRef(),we=G.useRef(),et=G.useRef(),he=G.useMemo(()=>j&&j[Z],[j,Z]),it=()=>{ae(!1),ne(Z+1),e()},Ce=()=>{ae(!1),J(null),e()},Te=async()=>{await Rt.firestore().collection("tangrams").doc(he.id).update({approved:!0}),w(t.formatMessage({id:"Tangram approved"}))};return G.useEffect(()=>{ne(0)},[j]),G.useEffect(()=>{if(z){if(!j8(me.current)){w(t.formatMessage({id:"You can't save an invalid tangram"}));return}const De=F8(me.current,_e.current);if(De.edges===23){w(t.formatMessage({id:"You can't save such an easy tangram"}));return}(async()=>{h||await r(),await i(De)})()}},[z]),G.useEffect(()=>{const De=()=>{if(ce.current&&me.current)for(const Qe of me.current.children)Ud(Qe,ce.current)};return window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]),G.useLayoutEffect(()=>{const De=Date.now(),Qe=nt=>{let Dt=null,Ke=null,sn=null,yn=null;const Zi=Zn=>{document.activeElement===ce.current&&(document.body.style.cursor="pointer")},Ct=Zn=>{document.body.style.cursor="default"},Bt=Zn=>{sn=Date.now(),yn=Zn.point,Dt=Zn.point.subtract(nt.position),Ke=nt.clone({insert:!1,deep:!0}),nt.bringToFront()},Pt=Zn=>{document.body.style.cursor="move";const qr=Zn.point.subtract(nt.position).subtract(Dt);Ke.position=nt.position.add(qr);const Vo=Ke.children["display 1"],Fo=me.current.children.filter(ie=>ie!==nt).map(({children:ie})=>ie.display),id=we.current&&xe.current?xe.current.children?xe.current.children:[xe.current]:null,X=B8(uI,Vo,Fo,id);X&&(Ke.position.x+=X.x,Ke.position.y+=X.y),Ud(Ke,ce.current),nt.position=Ke.position,Wp(nt,me.current)},Lo=Zn=>{if(document.body.style.cursor="pointer",Zn.point.subtract(yn).length<uI&&Date.now()-sn<E2&&(nt.rotation+=45,nt.data.id==="rh"&&(nt.data.rotation+=45,nt.data.rotation===180&&(nt.data.rotation=0,nt.scale(-1,1))),u.current.tangram(),Ud(nt,ce.current),Wp(nt,me.current),sn=null,yn=null),Dt=null,Ke&&Ke.remove(),Ke=null,!!xe.current&&(we.current===!1&&(xe.current.position=me.current.position),U8(xe.current,me.current,we.current?w2:I2))){U.current(he,Date.now()-De);for(const Hr of me.current.children)Hr.data.removeListeners();if(document.body.style.cursor="default",!et.current){u.current.victory(),ae(!0);return}He.project.activeLayer.tween({opacity:0},{duration:od,easing:"easeInCubic"});for(const Hr of Oe.current)Hr.data.animation.stop(),Hr.tween({"position.x":me.current.position.x,"position.y":me.current.position.y,opacity:gI},{duration:od,easing:"easeInCubic"});setTimeout(()=>{u.current.victory(),He.project.activeLayer.tween({opacity:1},{duration:Wr,easing:"easeOutCubic"});const Hr=Math.max(He.view.bounds.width,He.view.bounds.height)/2;for(const qr of Oe.current){qr.data.animation.stop();const Vo=Math.random()*Math.PI*2,Fo=Math.random()*Hr;qr.tween({"position.x":qr.position.x+Fo*Math.cos(Vo),"position.y":qr.position.y+Fo*Math.sin(Vo),opacity:0},{duration:od,easing:"easeOutCubic"})}ae(!0)},od)}};nt.on({mouseenter:Zi,mouseleave:Ct,mousedown:Bt,mousedrag:Pt,mouseup:Lo}),nt.data.removeListeners=()=>nt.off({mouseenter:Zi,mouseleave:Ct,mousedown:Bt,mousedrag:Pt,mouseup:Lo})};return(()=>{He.setup(ce.current),me.current=V8(),he&&(xe.current=He.project.importSVG(`<path d="${he.path}" />`,{applyMatrix:!0}),xe.current.sendToBack(),xe.current.fillRule="evenodd",xe.current.closed=!0);const nt=He.project.view.bounds,Dt=xe.current?xe.current.bounds:me.current.children[3].bounds.scale(2);nt.width>nt.height?_e.current=Math.min(Math.min(nt.width*.7,700)/Dt.width,Math.min(nt.height*.8,600)/Dt.height):_e.current=Math.min(Math.min(nt.width*.8,600)/Dt.width,Math.min(nt.height*.7,700)/Dt.height),xe.current&&(xe.current.scale(_e.current),xe.current.position=He.view.center);for(const Ke of me.current.children)Ke.scale(_e.current),z8(Ke,ce.current),Qe(Ke),Ud(Ke,ce.current),Wp(Ke,me.current)})(),()=>{He.project.remove(),Oe.current=null,me.current=null,xe.current=null}},[he]),G.useLayoutEffect(()=>{we.current=T,xe.current&&(T?(xe.current.fillColor=_.colors.shape,xe.current.position=He.view.center):xe.current.fillColor="transparent")},[he,T,_]),G.useLayoutEffect(()=>{if(et.current=E,!E)return;const De=new He.Group;De.sendToBack();const Qe=new He.Point(ce.current.width,ce.current.height).divide(window.devicePixelRatio),vt=()=>Math.random()*(T2-dI)+dI,nt=()=>Math.random()*(gI-fI)+fI;Oe.current=new Array(hI);for(let Dt=0;Dt<hI;Dt++){const Ke=new He.Path.Circle({center:He.Point.random().multiply(Qe),radius:vt(),opacity:nt(),parent:De,data:{index:Dt}}),sn=()=>{const yn={radius:vt(),opacity:nt(),"position.x":Math.min(ce.current.width/window.devicePixelRatio,Math.max(0,Ke.position.x+Math.random()*200-100)),"position.y":Math.min(ce.current.height/window.devicePixelRatio,Math.max(0,Ke.position.y+Math.random()*200-100))};Ke.data.animation=Ke.tween(yn,{duration:Math.random()*1e4+5e3,easing:"easeInOutQuad"}).then(sn)};sn(),Oe.current[Dt]=Ke}},[he,E]),G.useLayoutEffect(()=>{!E&&Ze.current&&(Ze.current.remove(),Ze.current=null,Oe.current=null)},[E]),G.useLayoutEffect(()=>{for(const Qe of me.current.children)Qe.children.display.fillColor=_.colors.pieces[Qe.data.id],Qe.children.insetBorder.strokeColor=_.colors.pieces[Qe.data.id];const De=Object.values(_.colors.pieces);if(E)for(const Qe of Oe.current)Qe.fillColor=De[Math.floor(Math.random()*De.length)]},[_.colors,he,E]),G.useEffect(()=>{n()},[]),R.jsxs(fe,{css:{flex:"1",position:"relative",color:"dialogText",animation:`${Wr}ms fadeIn ease`},children:[he&&T===!1&&R.jsx(fe,{css:{zIndex:-1,position:"absolute",top:3,right:3,cursor:"pointer"},children:R.jsx(ed,{tangram:he,selected:!0,hideBadge:!0})}),R.jsx(fe,{as:"canvas",ref:ce,css:{minHeight:"auto",flex:1}}),he&&te&&R.jsx($8,{tangram:he,onStop:Ce,onNext:Z<j.length-1?it:void 0,onApprove:h&&h.isAdmin&&!he.approved?Te:void 0,onStarToggle:h&&he.approved?()=>B(he):void 0})]})},q8=()=>{const t=Yt(),e=G.useContext(si),[n,r]=G.useState(!1),[i,s]=G.useState(!1),[a,u]=G.useState(!1),[h,g]=G.useState(!1),{initialized:_}=G.useContext(Oo),{playlist:w,initialized:T}=G.useContext(br),{currentUser:E,initialized:z}=G.useContext(zn),j=z&&_&&T&&w;if(G.useEffect(()=>{setTimeout(()=>r(!0),Wr*2),u(setTimeout(()=>s(!0),Wr*2))},[]),G.useEffect(()=>{j&&(clearTimeout(a),s(!1))},[j]),h)return R.jsxs(R.Fragment,{children:[R.jsx(H8,{}),R.jsx(b8,{})]});const J=()=>{g(!0),E&&e(t.formatMessage({id:"Logged in as {username}"},{username:E.username}))};return R.jsxs(fe,{css:{flex:"1",alignItems:"center",justifyContent:"center",gap:3,animation:j&&n?`${Wr}ms fadeIn ease ${Kp}ms forwards reverse`:void 0},deps:[j,n],onAnimationEnd:V=>{V.currentTarget===V.target&&J()},children:[R.jsx(fe,{css:{animation:`${Wr}ms fadeIn ease ${Kp}ms both`},children:R.jsx(lA,{css:{size:"logo",overflow:"visible","& > g":{transition:`all ${Wr}ms ease`,transform:j&&n?"translate(30px, -30px)":"translate(0, 0)"}},deps:[j,n]})}),R.jsx(Vr,{css:{transition:`opacity ${Wr}ms ease`,opacity:i?1:0},deps:[i],children:t.formatMessage({id:"Loading..."})})]})};window.isSecureContext&&navigator.serviceWorker.getRegistrations().then(function(t){for(let e of t)e.unregister()});const G8=()=>(G.useEffect(()=>{matchMedia("hover: none").matches&&(window.oncontextmenu=function(){return!1})},[]),hN({body:{m:0,bg:"background",fontFamily:"'Comic Neue', cursive",fontWeight:"bolder","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",transition:`background-color ${mf}ms`},"body, html, #root":{height:"100%"},"#root":{display:"flex",flexDirection:"column",padding:`
        env(safe-area-inset-top, 0)
        env(safe-area-inset-right, 0)
        env(safe-area-inset-bottom, 0)
        env(safe-area-inset-left, 0)
      `},"*":{boxSizing:"border-box",userSelect:"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"},"input, textarea":{"-webkit-user-select":"initial","-moz-user-select":"initial","-ms-user-select":"initial",userSelect:"initial"}}),R.jsx(Tz,{children:R.jsx(l8,{children:R.jsx(nz,{children:R.jsx(rz,{children:R.jsx(iz,{children:R.jsx(w8,{children:R.jsx(C8,{children:R.jsx(sz,{children:R.jsx(x8,{children:R.jsx(P8,{children:R.jsx(fe,{css:{flex:"1",color:"dialogText",fontSize:3},children:R.jsx(q8,{})})})})})})})})})})})}));n_.createRoot(document.getElementById("root")).render(R.jsx(E8,{children:R.jsx(G8,{})}));export{x2 as c,lS as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}