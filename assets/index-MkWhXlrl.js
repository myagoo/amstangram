(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var eO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _C(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tO(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var vC={exports:{}},cp={},yC={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zh=Symbol.for("react.element"),nO=Symbol.for("react.portal"),rO=Symbol.for("react.fragment"),iO=Symbol.for("react.strict_mode"),sO=Symbol.for("react.profiler"),oO=Symbol.for("react.provider"),aO=Symbol.for("react.context"),uO=Symbol.for("react.forward_ref"),lO=Symbol.for("react.suspense"),cO=Symbol.for("react.memo"),hO=Symbol.for("react.lazy"),HI=Symbol.iterator;function dO(t){return t===null||typeof t!="object"?null:(t=HI&&t[HI]||t["@@iterator"],typeof t=="function"?t:null)}var wC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EC=Object.assign,IC={};function kl(t,e,n){this.props=t,this.context=e,this.refs=IC,this.updater=n||wC}kl.prototype.isReactComponent={};kl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};kl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function SC(){}SC.prototype=kl.prototype;function C0(t,e,n){this.props=t,this.context=e,this.refs=IC,this.updater=n||wC}var b0=C0.prototype=new SC;b0.constructor=C0;EC(b0,kl.prototype);b0.isPureReactComponent=!0;var qI=Array.isArray,TC=Object.prototype.hasOwnProperty,A0={current:null},xC={key:!0,ref:!0,__self:!0,__source:!0};function CC(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)TC.call(e,r)&&!xC.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var h=Array(l),g=0;g<l;g++)h[g]=arguments[g+2];i.children=h}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Zh,type:t,key:s,ref:a,props:i,_owner:A0.current}}function fO(t,e){return{$$typeof:Zh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function P0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zh}function gO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var GI=/\/+/g;function Qm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gO(""+t.key):e.toString(36)}function Af(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Zh:case nO:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Qm(a,0):r,qI(i)?(n="",t!=null&&(n=t.replace(GI,"$&/")+"/"),Af(i,e,n,"",function(g){return g})):i!=null&&(P0(i)&&(i=fO(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(GI,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",qI(t))for(var l=0;l<t.length;l++){s=t[l];var h=r+Qm(s,l);a+=Af(s,e,n,h,i)}else if(h=dO(t),typeof h=="function")for(t=h.call(t),l=0;!(s=t.next()).done;)s=s.value,h=r+Qm(s,l++),a+=Af(s,e,n,h,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function jd(t,e,n){if(t==null)return t;var r=[],i=0;return Af(t,r,"","",function(s){return e.call(n,s,i++)}),r}function pO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vr={current:null},Pf={transition:null},mO={ReactCurrentDispatcher:vr,ReactCurrentBatchConfig:Pf,ReactCurrentOwner:A0};lt.Children={map:jd,forEach:function(t,e,n){jd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return jd(t,function(){e++}),e},toArray:function(t){return jd(t,function(e){return e})||[]},only:function(t){if(!P0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};lt.Component=kl;lt.Fragment=rO;lt.Profiler=sO;lt.PureComponent=C0;lt.StrictMode=iO;lt.Suspense=lO;lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mO;lt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=EC({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=A0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)TC.call(e,h)&&!xC.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&l!==void 0?l[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=n;else if(1<h){l=Array(h);for(var g=0;g<h;g++)l[g]=arguments[g+2];r.children=l}return{$$typeof:Zh,type:t.type,key:i,ref:s,props:r,_owner:a}};lt.createContext=function(t){return t={$$typeof:aO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:oO,_context:t},t.Consumer=t};lt.createElement=CC;lt.createFactory=function(t){var e=CC.bind(null,t);return e.type=t,e};lt.createRef=function(){return{current:null}};lt.forwardRef=function(t){return{$$typeof:uO,render:t}};lt.isValidElement=P0;lt.lazy=function(t){return{$$typeof:hO,_payload:{_status:-1,_result:t},_init:pO}};lt.memo=function(t,e){return{$$typeof:cO,type:t,compare:e===void 0?null:e}};lt.startTransition=function(t){var e=Pf.transition;Pf.transition={};try{t()}finally{Pf.transition=e}};lt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};lt.useCallback=function(t,e){return vr.current.useCallback(t,e)};lt.useContext=function(t){return vr.current.useContext(t)};lt.useDebugValue=function(){};lt.useDeferredValue=function(t){return vr.current.useDeferredValue(t)};lt.useEffect=function(t,e){return vr.current.useEffect(t,e)};lt.useId=function(){return vr.current.useId()};lt.useImperativeHandle=function(t,e,n){return vr.current.useImperativeHandle(t,e,n)};lt.useInsertionEffect=function(t,e){return vr.current.useInsertionEffect(t,e)};lt.useLayoutEffect=function(t,e){return vr.current.useLayoutEffect(t,e)};lt.useMemo=function(t,e){return vr.current.useMemo(t,e)};lt.useReducer=function(t,e,n){return vr.current.useReducer(t,e,n)};lt.useRef=function(t){return vr.current.useRef(t)};lt.useState=function(t){return vr.current.useState(t)};lt.useSyncExternalStore=function(t,e,n){return vr.current.useSyncExternalStore(t,e,n)};lt.useTransition=function(){return vr.current.useTransition()};lt.version="18.2.0";yC.exports=lt;var G=yC.exports;const It=_C(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _O=G,vO=Symbol.for("react.element"),yO=Symbol.for("react.fragment"),wO=Object.prototype.hasOwnProperty,EO=_O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IO={key:!0,ref:!0,__self:!0,__source:!0};function bC(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)wO.call(e,r)&&!IO.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:vO,type:t,key:s,ref:a,props:i,_owner:EO.current}}cp.Fragment=yO;cp.jsx=bC;cp.jsxs=bC;vC.exports=cp;var R=vC.exports;const AC=Object.prototype.toString;function PC(t){switch(AC.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Ra(t,Error)}}function Nl(t,e){return AC.call(t)===`[object ${e}]`}function R0(t){return Nl(t,"ErrorEvent")}function WI(t){return Nl(t,"DOMError")}function SO(t){return Nl(t,"DOMException")}function xs(t){return Nl(t,"String")}function k0(t){return t===null||typeof t!="object"&&typeof t!="function"}function il(t){return Nl(t,"Object")}function hp(t){return typeof Event<"u"&&Ra(t,Event)}function TO(t){return typeof Element<"u"&&Ra(t,Element)}function xO(t){return Nl(t,"RegExp")}function N0(t){return!!(t&&t.then&&typeof t.then=="function")}function CO(t){return il(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function bO(t){return typeof t=="number"&&t!==t}function Ra(t,e){try{return t instanceof e}catch{return!1}}function RC(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function Hu(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function KI(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{RC(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function AO(t,e,n=!1){return xs(t)?xO(e)?e.test(t):xs(e)?n?t===e:t.includes(e):!1:!1}function dp(t,e=[],n=!1){return e.some(r=>AO(t,r,n))}function PO(t,e,n=250,r,i,s,a){if(!s.exception||!s.exception.values||!a||!Ra(a.originalException,Error))return;const l=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;l&&(s.exception.values=RO(iv(t,e,i,a.originalException,r,s.exception.values,l,0),n))}function iv(t,e,n,r,i,s,a,l){if(s.length>=n+1)return s;let h=[...s];if(Ra(r[i],Error)){QI(a,l);const g=t(e,r[i]),m=h.length;YI(g,i,m,l),h=iv(t,e,n,r[i],i,[g,...h],g,m)}return Array.isArray(r.errors)&&r.errors.forEach((g,m)=>{if(Ra(g,Error)){QI(a,l);const v=t(e,g),I=h.length;YI(v,`errors[${m}]`,I,l),h=iv(t,e,n,g,i,[v,...h],v,I)}}),h}function QI(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function YI(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function RO(t,e){return t.map(n=>(n.value&&(n.value=Hu(n.value,e)),n))}function zd(t){return t&&t.Math==Math?t:void 0}const Rt=typeof globalThis=="object"&&zd(globalThis)||typeof window=="object"&&zd(window)||typeof self=="object"&&zd(self)||typeof global=="object"&&zd(global)||function(){return this}()||{};function fp(){return Rt}function kC(t,e,n){const r=n||Rt,i=r.__SENTRY__=r.__SENTRY__||{};return i[t]||(i[t]=e())}const kO=fp(),NO=80;function sv(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let s=0,a=0;const l=" > ",h=l.length;let g;const m=Array.isArray(e)?e:e.keyAttrs,v=!Array.isArray(e)&&e.maxStringLength||NO;for(;n&&s++<r&&(g=DO(n,m),!(g==="html"||s>1&&a+i.length*h+g.length>=v));)i.push(g),a+=g.length,n=n.parentNode;return i.reverse().join(l)}catch{return"<unknown>"}}function DO(t,e){const n=t,r=[];let i,s,a,l,h;if(!n||!n.tagName)return"";r.push(n.tagName.toLowerCase());const g=e&&e.length?e.filter(v=>n.getAttribute(v)).map(v=>[v,n.getAttribute(v)]):null;if(g&&g.length)g.forEach(v=>{r.push(`[${v[0]}="${v[1]}"]`)});else if(n.id&&r.push(`#${n.id}`),i=n.className,i&&xs(i))for(s=i.split(/\s+/),h=0;h<s.length;h++)r.push(`.${s[h]}`);const m=["aria-label","type","name","title","alt"];for(h=0;h<m.length;h++)a=m[h],l=n.getAttribute(a),l&&r.push(`[${a}="${l}"]`);return r.join("")}function OO(){try{return kO.document.location.href}catch{return""}}const ed=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,MO="Sentry Logger ",ov=["debug","info","warn","error","log","assert","trace"],ng={};function gp(t){if(!("console"in Rt))return t();const e=Rt.console,n={},r=Object.keys(ng);r.forEach(i=>{const s=ng[i];n[i]=e[i],e[i]=s});try{return t()}finally{r.forEach(i=>{e[i]=n[i]})}}function LO(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return ed?ov.forEach(n=>{e[n]=(...r)=>{t&&gp(()=>{Rt.console[n](`${MO}[${n}]:`,...r)})}}):ov.forEach(n=>{e[n]=()=>{}}),e}const tt=LO(),VO=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function FO(t){return t==="http"||t==="https"}function pp(t,e=!1){const{host:n,path:r,pass:i,port:s,projectId:a,protocol:l,publicKey:h}=t;return`${l}://${h}${e&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${a}`}function BO(t){const e=VO.exec(t);if(!e){gp(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,i="",s,a="",l]=e.slice(1);let h="",g=l;const m=g.split("/");if(m.length>1&&(h=m.slice(0,-1).join("/"),g=m.pop()),g){const v=g.match(/^\d+/);v&&(g=v[0])}return NC({host:s,pass:i,path:h,projectId:g,port:a,protocol:n,publicKey:r})}function NC(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function UO(t){if(!ed)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(a=>t[a]?!1:(tt.error(`Invalid Sentry Dsn: ${a} missing`),!0))?!1:n.match(/^\d+$/)?FO(r)?e&&isNaN(parseInt(e,10))?(tt.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(tt.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(tt.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function jO(t){const e=typeof t=="string"?BO(t):NC(t);if(!(!e||!UO(e)))return e}class Bi extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function Un(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&DC(i,r),t[e]=i}function th(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{ed&&tt.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function DC(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,th(t,"__sentry_original__",e)}catch{}}function D0(t){return t.__sentry_original__}function zO(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function OC(t){if(PC(t))return{message:t.message,name:t.name,stack:t.stack,...JI(t)};if(hp(t)){const e={type:t.type,target:XI(t.target),currentTarget:XI(t.currentTarget),...JI(t)};return typeof CustomEvent<"u"&&Ra(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function XI(t){try{return TO(t)?sv(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function JI(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function $O(t,e=40){const n=Object.keys(OC(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return Hu(n[0],e);for(let r=n.length;r>0;r--){const i=n.slice(0,r).join(", ");if(!(i.length>e))return r===n.length?i:Hu(i,e)}return""}function mp(t){return av(t,new Map)}function av(t,e){if(il(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.keys(t))typeof t[i]<"u"&&(r[i]=av(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(i=>{r.push(av(i,e))}),r}return t}const MC=50,ZI=/\(error: (.*)\)/,eS=/captureMessage|captureException/;function LC(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0)=>{const i=[],s=n.split(`
`);for(let a=r;a<s.length;a++){const l=s[a];if(l.length>1024)continue;const h=ZI.test(l)?l.replace(ZI,"$1"):l;if(!h.match(/\S*Error: /)){for(const g of e){const m=g(h);if(m){i.push(m);break}}if(i.length>=MC)break}}return qO(i)}}function HO(t){return Array.isArray(t)?LC(...t):t}function qO(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),eS.test(e[e.length-1].function||"")&&(e.pop(),eS.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,MC).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const Ym="<anonymous>";function xo(t){try{return!t||typeof t!="function"?Ym:t.name||Ym}catch{return Ym}}const Rf={},tS={};function Xa(t,e){Rf[t]=Rf[t]||[],Rf[t].push(e)}function Ja(t,e){tS[t]||(e(),tS[t]=!0)}function Si(t,e){const n=t&&Rf[t];if(n)for(const r of n)try{r(e)}catch(i){ed&&tt.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${xo(r)}
Error:`,i)}}function GO(t){const e="console";Xa(e,t),Ja(e,WO)}function WO(){"console"in Rt&&ov.forEach(function(t){t in Rt.console&&Un(Rt.console,t,function(e){return ng[t]=e,function(...n){Si("console",{args:n,level:t});const i=ng[t];i&&i.apply(Rt.console,n)}})})}function Cs(){const t=Rt,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>e.getRandomValues(new Uint8Array(1))[0])}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function VC(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function eo(t){const{message:e,event_id:n}=t;if(e)return e;const r=VC(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function uv(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function nh(t,e){const n=VC(t);if(!n)return;const r={type:"generic",handled:!0},i=n.mechanism;if(n.mechanism={...r,...i,...e},e&&"data"in e){const s={...i&&i.data,...e.data};n.mechanism.data=s}}function nS(t){if(t&&t.__sentry_captured__)return!0;try{th(t,"__sentry_captured__",!0)}catch{}return!1}function FC(t){return Array.isArray(t)?t:[t]}const Su=Rt,KO=1e3;let rS,lv,cv;function QO(t){const e="dom";Xa(e,t),Ja(e,YO)}function YO(){if(!Su.document)return;const t=Si.bind(null,"dom"),e=iS(t,!0);Su.document.addEventListener("click",e,!1),Su.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=Su[n]&&Su[n].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(Un(r,"addEventListener",function(i){return function(s,a,l){if(s==="click"||s=="keypress")try{const h=this,g=h.__sentry_instrumentation_handlers__=h.__sentry_instrumentation_handlers__||{},m=g[s]=g[s]||{refCount:0};if(!m.handler){const v=iS(t);m.handler=v,i.call(this,s,v,l)}m.refCount++}catch{}return i.call(this,s,a,l)}}),Un(r,"removeEventListener",function(i){return function(s,a,l){if(s==="click"||s=="keypress")try{const h=this,g=h.__sentry_instrumentation_handlers__||{},m=g[s];m&&(m.refCount--,m.refCount<=0&&(i.call(this,s,m.handler,l),m.handler=void 0,delete g[s]),Object.keys(g).length===0&&delete h.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,a,l)}}))})}function XO(t){if(t.type!==lv)return!1;try{if(!t.target||t.target._sentryId!==cv)return!1}catch{}return!0}function JO(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function iS(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=ZO(n);if(JO(n.type,r))return;th(n,"_sentryCaptured",!0),r&&!r._sentryId&&th(r,"_sentryId",Cs());const i=n.type==="keypress"?"input":n.type;XO(n)||(t({event:n,name:i,global:e}),lv=n.type,cv=r?r._sentryId:void 0),clearTimeout(rS),rS=Su.setTimeout(()=>{cv=void 0,lv=void 0},KO)}}function ZO(t){try{return t.target}catch{return null}}const hv=fp();function BC(){if(!("fetch"in hv))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function dv(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function eM(){if(typeof EdgeRuntime=="string")return!0;if(!BC())return!1;if(dv(hv.fetch))return!0;let t=!1;const e=hv.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=dv(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){ed&&tt.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function tM(t){const e="fetch";Xa(e,t),Ja(e,nM)}function nM(){eM()&&Un(Rt,"fetch",function(t){return function(...e){const{method:n,url:r}=rM(e),i={args:e,fetchData:{method:n,url:r},startTimestamp:Date.now()};return Si("fetch",{...i}),t.apply(Rt,e).then(s=>{const a={...i,endTimestamp:Date.now(),response:s};return Si("fetch",a),s},s=>{const a={...i,endTimestamp:Date.now(),error:s};throw Si("fetch",a),s})}})}function fv(t,e){return!!t&&typeof t=="object"&&!!t[e]}function sS(t){return typeof t=="string"?t:t?fv(t,"url")?t.url:t.toString?t.toString():"":""}function rM(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:sS(n),method:fv(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:sS(e),method:fv(e,"method")?String(e.method).toUpperCase():"GET"}}let $d=null;function iM(t){const e="error";Xa(e,t),Ja(e,sM)}function sM(){$d=Rt.onerror,Rt.onerror=function(t,e,n,r,i){return Si("error",{column:r,error:i,line:n,msg:t,url:e}),$d&&!$d.__SENTRY_LOADER__?$d.apply(this,arguments):!1},Rt.onerror.__SENTRY_INSTRUMENTED__=!0}let Hd=null;function oM(t){const e="unhandledrejection";Xa(e,t),Ja(e,aM)}function aM(){Hd=Rt.onunhandledrejection,Rt.onunhandledrejection=function(t){return Si("unhandledrejection",t),Hd&&!Hd.__SENTRY_LOADER__?Hd.apply(this,arguments):!0},Rt.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const qd=fp();function uM(){const t=qd.chrome,e=t&&t.app&&t.app.runtime,n="history"in qd&&!!qd.history.pushState&&!!qd.history.replaceState;return!e&&n}const Jl=Rt;let Gd;function UC(t){const e="history";Xa(e,t),Ja(e,lM)}function lM(){if(!uM())return;const t=Jl.onpopstate;Jl.onpopstate=function(...n){const r=Jl.location.href,i=Gd;if(Gd=r,Si("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=Gd,a=String(i);Gd=a,Si("history",{from:s,to:a})}return n.apply(this,r)}}Un(Jl.history,"pushState",e),Un(Jl.history,"replaceState",e)}const cM=Rt,wc="__sentry_xhr_v3__";function hM(t){const e="xhr";Xa(e,t),Ja(e,dM)}function dM(){if(!cM.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;Un(t,"open",function(e){return function(...n){const r=Date.now(),i=xs(n[0])?n[0].toUpperCase():void 0,s=fM(n[1]);if(!i||!s)return;this[wc]={method:i,url:s,request_headers:{}},i==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const a=()=>{const l=this[wc];if(l&&this.readyState===4){try{l.status_code=this.status}catch{}const h={args:[i,s],endTimestamp:Date.now(),startTimestamp:r,xhr:this};Si("xhr",h)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?Un(this,"onreadystatechange",function(l){return function(...h){return a(),l.apply(this,h)}}):this.addEventListener("readystatechange",a),Un(this,"setRequestHeader",function(l){return function(...h){const[g,m]=h,v=this[wc];return v&&xs(g)&&xs(m)&&(v.request_headers[g.toLowerCase()]=m),l.apply(this,h)}}),e.apply(this,n)}}),Un(t,"send",function(e){return function(...n){const r=this[wc];if(!r)return;n[0]!==void 0&&(r.body=n[0]);const i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return Si("xhr",i),e.apply(this,n)}})}function fM(t){if(xs(t))return t;try{return t.toString()}catch{}}function gM(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function pM(){return"npm"}function mM(){return!gM()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function _M(t,e){return t.require(e)}function vM(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(i){if(t)return e.has(i)?!0:(e.add(i),!1);for(let s=0;s<e.length;s++)if(e[s]===i)return!0;return e.push(i),!1}function r(i){if(t)e.delete(i);else for(let s=0;s<e.length;s++)if(e[s]===i){e.splice(s,1);break}}return[n,r]}function Xs(t,e=100,n=1/0){try{return gv("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function jC(t,e=3,n=100*1024){const r=Xs(t,e);return IM(r)>n?jC(t,e-1,n):r}function gv(t,e,n=1/0,r=1/0,i=vM()){const[s,a]=i;if(e==null||["number","boolean","string"].includes(typeof e)&&!bO(e))return e;const l=yM(t,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;const h=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(h===0)return l.replace("object ","");if(s(e))return"[Circular ~]";const g=e;if(g&&typeof g.toJSON=="function")try{const S=g.toJSON();return gv("",S,h-1,r,i)}catch{}const m=Array.isArray(e)?[]:{};let v=0;const I=OC(e);for(const S in I){if(!Object.prototype.hasOwnProperty.call(I,S))continue;if(v>=r){m[S]="[MaxProperties ~]";break}const j=I[S];m[S]=gv(S,j,h-1,r,i),v++}return a(e),m}function yM(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(RC(e))return"[VueViewModel]";if(CO(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${xo(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=wM(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function wM(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function EM(t){return~-encodeURI(t).split(/%..|./).length}function IM(t){return EM(JSON.stringify(t))}var fs;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(fs||(fs={}));function ka(t){return new Fr(e=>{e(t)})}function O0(t){return new Fr((e,n)=>{n(t)})}class Fr{constructor(e){Fr.prototype.__init.call(this),Fr.prototype.__init2.call(this),Fr.prototype.__init3.call(this),Fr.prototype.__init4.call(this),this._state=fs.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new Fr((r,i)=>{this._handlers.push([!1,s=>{if(!e)r(s);else try{r(e(s))}catch(a){i(a)}},s=>{if(!n)i(s);else try{r(n(s))}catch(a){i(a)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Fr((n,r)=>{let i,s;return this.then(a=>{s=!1,i=a,e&&e()},a=>{s=!0,i=a,e&&e()}).then(()=>{if(s){r(i);return}n(i)})})}__init(){this._resolve=e=>{this._setResult(fs.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(fs.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===fs.PENDING){if(N0(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===fs.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===fs.RESOLVED&&n[1](this._value),this._state===fs.REJECTED&&n[2](this._value),n[0]=!0)})}}}function SM(t){const e=[];function n(){return t===void 0||e.length<t}function r(a){return e.splice(e.indexOf(a),1)[0]}function i(a){if(!n())return O0(new Bi("Not adding Promise because buffer limit was reached."));const l=a();return e.indexOf(l)===-1&&e.push(l),l.then(()=>r(l)).then(null,()=>r(l).then(null,()=>{})),l}function s(a){return new Fr((l,h)=>{let g=e.length;if(!g)return l(!0);const m=setTimeout(()=>{a&&a>0&&l(!1)},a);e.forEach(v=>{ka(v).then(()=>{--g||(clearTimeout(m),l(!0))},h)})})}return{$:e,add:i,drain:s}}function Xm(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const TM=["fatal","error","warning","log","info","debug"];function xM(t){return t==="warn"?"warning":TM.includes(t)?t:"log"}const zC=fp(),pv={nowSeconds:()=>Date.now()/1e3};function CM(){const{performance:t}=zC;if(!t||!t.now)return;const e=Date.now()-t.now();return{now:()=>t.now(),timeOrigin:e}}function bM(){try{return _M(module,"perf_hooks").performance}catch{return}}const Jm=mM()?bM():CM(),oS=Jm===void 0?pv:{nowSeconds:()=>(Jm.timeOrigin+Jm.now())/1e3},_p=pv.nowSeconds.bind(pv),$C=oS.nowSeconds.bind(oS);(()=>{const{performance:t}=zC;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),i=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,s=i<e,a=t.timing&&t.timing.navigationStart,h=typeof a=="number"?Math.abs(a+n-r):e,g=h<e;return s||g?i<=h?t.timeOrigin:a:r})();function td(t,e=[]){return[t,e]}function AM(t,e){const[n,r]=t;return[n,[...r,e]]}function aS(t,e){const n=t[1];for(const r of n){const i=r[0].type;if(e(r,i))return!0}return!1}function mv(t,e){return(e||new TextEncoder).encode(t)}function PM(t,e){const[n,r]=t;let i=JSON.stringify(n);function s(a){typeof i=="string"?i=typeof a=="string"?i+a:[mv(i,e),a]:i.push(typeof a=="string"?mv(a,e):a)}for(const a of r){const[l,h]=a;if(s(`
${JSON.stringify(l)}
`),typeof h=="string"||h instanceof Uint8Array)s(h);else{let g;try{g=JSON.stringify(h)}catch{g=JSON.stringify(Xs(h))}s(g)}}return typeof i=="string"?i:RM(i)}function RM(t){const e=t.reduce((i,s)=>i+s.length,0),n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}function kM(t,e){const n=typeof t.data=="string"?mv(t.data,e):t.data;return[mp({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const NM={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function uS(t){return NM[t]}function HC(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function DM(t,e,n,r){const i=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:pp(r)},...i&&{trace:mp({...i})}}}function OM(t,e,n){const r=[{type:"client_report"},{timestamp:n||_p(),discarded_events:t}];return td(e?{dsn:e}:{},[r])}const MM=60*1e3;function LM(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?MM:r-e}function VM(t,e){return t[e]||t.all||0}function FM(t,e,n=Date.now()){return VM(t,e)>n}function BM(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(const l of s.trim().split(",")){const[h,g]=l.split(":",2),m=parseInt(h,10),v=(isNaN(m)?60:m)*1e3;if(!g)i.all=r+v;else for(const I of g.split(";"))i[I]=r+v}else a?i.all=r+LM(a,r):e===429&&(i.all=r+60*1e3);return i}const Ht=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,M0="production";function L0(){return kC("globalEventProcessors",()=>[])}function UM(t){L0().push(t)}function rg(t,e,n,r=0){return new Fr((i,s)=>{const a=t[r];if(e===null||typeof a!="function")i(e);else{const l=a({...e},n);Ht&&a.id&&l===null&&tt.log(`Event processor "${a.id}" dropped event`),N0(l)?l.then(h=>rg(t,h,n,r+1).then(i)).then(null,s):rg(t,l,n,r+1).then(i).then(null,s)}})}function jM(t){const e=$C(),n={sid:Cs(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>$M(n)};return t&&sl(n,t),n}function sl(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||$C(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Cs()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function zM(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),sl(t,n)}function $M(t){return mp({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}const HM=100;class ho{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=lS()}static clone(e){const n=new ho;return e&&(n._breadcrumbs=[...e._breadcrumbs],n._tags={...e._tags},n._extra={...e._extra},n._contexts={...e._contexts},n._user=e._user,n._level=e._level,n._span=e._span,n._session=e._session,n._transactionName=e._transactionName,n._fingerprint=e._fingerprint,n._eventProcessors=[...e._eventProcessors],n._requestSession=e._requestSession,n._attachments=[...e._attachments],n._sdkProcessingMetadata={...e._sdkProcessingMetadata},n._propagationContext={...e._propagationContext}),n}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{},this._session&&sl(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this.getSpan();return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof ho?n:this}return e instanceof ho?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):il(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=lS(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:HM;if(r<=0)return this;const i={timestamp:_p(),...e},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(e,n={},r){if(this._extra&&Object.keys(this._extra).length&&(e.extra={...this._extra,...e.extra}),this._tags&&Object.keys(this._tags).length&&(e.tags={...this._tags,...e.tags}),this._user&&Object.keys(this._user).length&&(e.user={...this._user,...e.user}),this._contexts&&Object.keys(this._contexts).length&&(e.contexts={...this._contexts,...e.contexts}),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts={trace:this._span.getTraceContext(),...e.contexts};const a=this._span.transaction;if(a){e.sdkProcessingMetadata={dynamicSamplingContext:a.getDynamicSamplingContext(),...e.sdkProcessingMetadata};const l=a.name;l&&(e.tags={transaction:l,...e.tags})}}this._applyFingerprint(e);const i=this._getBreadcrumbs(),s=[...e.breadcrumbs||[],...i];return e.breadcrumbs=s.length>0?s:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},rg([...r||[],...L0(),...this._eventProcessors],e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}_getBreadcrumbs(){return this._breadcrumbs}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}_applyFingerprint(e){e.fingerprint=e.fingerprint?FC(e.fingerprint):[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}}function lS(){return{traceId:Cs(),spanId:Cs().substring(16)}}const qC=4,qM=100;class GC{constructor(e,n=new ho,r=qC){this._version=r,this._stack=[{scope:n}],e&&this.bindClient(e)}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=ho.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();try{e(n)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Cs(),i=new Error("Sentry syntheticException");return this._withClient((s,a)=>{s.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},a)}),r}captureMessage(e,n,r){const i=this._lastEventId=r&&r.event_id?r.event_id:Cs(),s=new Error(e);return this._withClient((a,l)=>{a.captureMessage(e,n,{originalException:e,syntheticException:s,...r,event_id:i},l)}),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Cs();return e.type||(this._lastEventId=r),this._withClient((i,s)=>{i.captureEvent(e,{...n,event_id:r},s)}),r}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:r,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:a=qM}=i.getOptions&&i.getOptions()||{};if(a<=0)return;const h={timestamp:_p(),...e},g=s?gp(()=>s(h,n)):h;g!==null&&(i.emit&&i.emit("beforeAddBreadcrumb",g,n),r.addBreadcrumb(g,a))}setUser(e){this.getScope().setUser(e)}setTags(e){this.getScope().setTags(e)}setExtras(e){this.getScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n)}configureScope(e){const{scope:n,client:r}=this.getStackTop();r&&e(n)}run(e){const n=cS(this);try{e(this)}finally{cS(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return Ht&&tt.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const r=this._callExtensionMethod("startTransaction",e,n);return Ht&&!r&&(this.getClient()?tt.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):tt.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&zM(r),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:r}=this.getStackTop(),{release:i,environment:s=M0}=r&&r.getOptions()||{},{userAgent:a}=Rt.navigator||{},l=jM({release:i,environment:s,user:n.getUser(),...a&&{userAgent:a},...e}),h=n.getSession&&n.getSession();return h&&h.status==="ok"&&sl(h,{status:"exited"}),this.endSession(),n.setSession(l),l}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),r=e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_withClient(e){const{scope:n,client:r}=this.getStackTop();r&&e(r,n)}_callExtensionMethod(e,...n){const i=vp().__SENTRY__;if(i&&i.extensions&&typeof i.extensions[e]=="function")return i.extensions[e].apply(this,n);Ht&&tt.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function vp(){return Rt.__SENTRY__=Rt.__SENTRY__||{extensions:{},hub:void 0},Rt}function cS(t){const e=vp(),n=_v(e);return WC(e,t),n}function nr(){const t=vp();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return GM(t)}function GM(t=vp()){return(!WM(t)||_v(t).isOlderThan(qC))&&WC(t,new GC),_v(t)}function WM(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function _v(t){return kC("hub",()=>new GC,t)}function WC(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function KM(t,e,n){const r=e.getOptions(),{publicKey:i}=e.getDsn()||{},{segment:s}=n&&n.getUser()||{},a=mp({environment:r.environment||M0,release:r.release,user_segment:s,public_key:i,trace_id:t});return e.emit&&e.emit("createDsc",a),a}function QM(t,e,n,r,i){const{normalizeDepth:s=3,normalizeMaxBreadth:a=1e3}=t,l={...e,event_id:e.event_id||n.event_id||Cs(),timestamp:e.timestamp||_p()},h=n.integrations||t.integrations.map(I=>I.name);YM(l,t),ZM(l,h),e.type===void 0&&XM(l,t.stackParser);let g=r;n.captureContext&&(g=ho.clone(g).update(n.captureContext)),n.mechanism&&nh(l,n.mechanism);let m=ka(l);const v=i&&i.getEventProcessors?i.getEventProcessors():[];if(g){if(g.getAttachments){const I=[...n.attachments||[],...g.getAttachments()];I.length&&(n.attachments=I)}m=g.applyToEvent(l,n,v)}else m=rg([...v,...L0()],l,n);return m.then(I=>(I&&JM(I),typeof s=="number"&&s>0?eL(I,s,a):I))}function YM(t,e){const{environment:n,release:r,dist:i,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:M0),t.release===void 0&&r!==void 0&&(t.release=r),t.dist===void 0&&i!==void 0&&(t.dist=i),t.message&&(t.message=Hu(t.message,s));const a=t.exception&&t.exception.values&&t.exception.values[0];a&&a.value&&(a.value=Hu(a.value,s));const l=t.request;l&&l.url&&(l.url=Hu(l.url,s))}const hS=new WeakMap;function XM(t,e){const n=Rt._sentryDebugIds;if(!n)return;let r;const i=hS.get(e);i?r=i:(r=new Map,hS.set(e,r));const s=Object.keys(n).reduce((a,l)=>{let h;const g=r.get(l);g?h=g:(h=e(l),r.set(l,h));for(let m=h.length-1;m>=0;m--){const v=h[m];if(v.filename){a[v.filename]=n[l];break}}return a},{});try{t.exception.values.forEach(a=>{a.stacktrace.frames.forEach(l=>{l.filename&&(l.debug_id=s[l.filename])})})}catch{}}function JM(t){const e={};try{t.exception.values.forEach(r=>{r.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?e[i.abs_path]=i.debug_id:i.filename&&(e[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(r=>{n.push({type:"sourcemap",code_file:r,debug_id:e[r]})})}function ZM(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function eL(t,e,n){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(i=>({...i,...i.data&&{data:Xs(i.data,e,n)}}))},...t.user&&{user:Xs(t.user,e,n)},...t.contexts&&{contexts:Xs(t.contexts,e,n)},...t.extra&&{extra:Xs(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=Xs(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(i=>(i.data&&(i.data=Xs(i.data,e,n)),i))),r}function tL(t){if(t)return nL(t)?{captureContext:t}:iL(t)?{captureContext:t}:t}function nL(t){return t instanceof ho||typeof t=="function"}const rL=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function iL(t){return Object.keys(t).some(e=>rL.includes(e))}function sL(t,e){return nr().captureException(t,tL(e))}function oL(t){nr().withScope(t)}function aL(){return nr().getClient()}function uL(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function lL(t,e,n,r){const i=HC(n),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!r&&e&&{dsn:pp(e)}},a="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return td(s,[a])}function cL(t,e,n,r){const i=HC(n),s=t.type&&t.type!=="replay_event"?t.type:"event";uL(t,n&&n.sdk);const a=DM(t,i,r,e);return delete t.sdkProcessingMetadata,td(a,[[{type:s},t]])}const hL="7";function dL(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function fL(t){return`${dL(t)}${t.projectId}/envelope/`}function gL(t,e){return zO({sentry_key:t.publicKey,sentry_version:hL,...e&&{sentry_client:`${e.name}/${e.version}`}})}function pL(t,e={}){const n=typeof e=="string"?e:e.tunnel,r=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${fL(t)}?${gL(t,r)}`}const dS=[];function mL(t){const e={};return t.forEach(n=>{const{name:r}=n,i=e[r];i&&!i.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.keys(e).map(n=>e[n])}function _L(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(a=>{a.isDefaultInstance=!0});let r;Array.isArray(n)?r=[...e,...n]:typeof n=="function"?r=FC(n(e)):r=e;const i=mL(r),s=yL(i,a=>a.name==="Debug");if(s!==-1){const[a]=i.splice(s,1);i.push(a)}return i}function vL(t,e){const n={};return e.forEach(r=>{r&&KC(t,r,n)}),n}function KC(t,e,n){if(n[e.name]=e,dS.indexOf(e.name)===-1&&(e.setupOnce(UM,nr),dS.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>r(i,s,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign((s,a)=>r(s,a,t),{id:e.name});t.addEventProcessor(i)}Ht&&tt.log(`Integration installed: ${e.name}`)}function yL(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}const fS="Not capturing exception because it's already been captured.";class wL{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=jO(e.dsn):Ht&&tt.warn("No DSN provided, client will not send events."),this._dsn){const n=pL(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){if(nS(e)){Ht&&tt.log(fS);return}let i=n&&n.event_id;return this._process(this.eventFromException(e,n).then(s=>this._captureEvent(s,n,r)).then(s=>{i=s})),i}captureMessage(e,n,r,i){let s=r&&r.event_id;const a=k0(e)?this.eventFromMessage(String(e),n,r):this.eventFromException(e,r);return this._process(a.then(l=>this._captureEvent(l,r,i)).then(l=>{s=l})),s}captureEvent(e,n,r){if(n&&n.originalException&&nS(n.originalException)){Ht&&tt.log(fS);return}let i=n&&n.event_id;return this._process(this._captureEvent(e,n,r).then(s=>{i=s})),i}captureSession(e){typeof e.release!="string"?Ht&&tt.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),sl(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?this._isClientDoneProcessing(e).then(r=>n.flush(e).then(i=>r&&i)):ka(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&(this._integrations=vL(this,this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return Ht&&tt.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){KC(this,e,this._integrations)}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=cL(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=AM(r,kM(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=lL(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=`${e}:${n}`;Ht&&tt.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(r=>r(...n))}_updateSessionFromEvent(e,n){let r=!1,i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const h of s){const g=h.mechanism;if(g&&g.handled===!1){r=!0;break}}}const a=e.status==="ok";(a&&e.errors===0||a&&r)&&(sl(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Fr(n=>{let r=0;const i=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(r+=i,e&&r>=e&&(clearInterval(s),n(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r){const i=this.getOptions(),s=Object.keys(this._integrations);return!n.integrations&&s.length>0&&(n.integrations=s),this.emit("preprocessEvent",e,n),QM(i,e,n,r,this).then(a=>{if(a===null)return a;const{propagationContext:l}=a.sdkProcessingMetadata||{};if(!(a.contexts&&a.contexts.trace)&&l){const{traceId:g,spanId:m,parentSpanId:v,dsc:I}=l;a.contexts={trace:{trace_id:g,span_id:m,parent_span_id:v},...a.contexts};const S=I||KM(g,this,r);a.sdkProcessingMetadata={dynamicSamplingContext:S,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(i=>i.event_id,i=>{if(Ht){const s=i;s.logLevel==="log"?tt.log(s.message):tt.warn(s)}})}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:s}=i,a=YC(e),l=QC(e),h=e.type||"error",g=`before send for type \`${h}\``;if(l&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",e),O0(new Bi(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const m=h==="replay_event"?"replay":h;return this._prepareEvent(e,n,r).then(v=>{if(v===null)throw this.recordDroppedEvent("event_processor",m,e),new Bi("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return v;const S=IL(i,v,n);return EL(S,g)}).then(v=>{if(v===null)throw this.recordDroppedEvent("before_send",m,e),new Bi(`${g} returned \`null\`, will not send event.`,"log");const I=r&&r.getSession();!a&&I&&this._updateSessionFromEvent(I,v);const S=v.transaction_info;if(a&&S&&v.transaction!==e.transaction){const j="custom";v.transaction_info={...S,source:j}}return this.sendEvent(v,n),v}).then(null,v=>{throw v instanceof Bi?v:(this.captureException(v,{data:{__sentry__:!0},originalException:v}),new Bi(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${v}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{Ht&&tt.error("Error while sending event:",n)});Ht&&tt.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[r,i]=n.split(":");return{reason:r,category:i,quantity:e[n]}})}}function EL(t,e){const n=`${e} must return \`null\` or a valid event.`;if(N0(t))return t.then(r=>{if(!il(r)&&r!==null)throw new Bi(n);return r},r=>{throw new Bi(`${e} rejected with ${r}`)});if(!il(t)&&t!==null)throw new Bi(n);return t}function IL(t,e,n){const{beforeSend:r,beforeSendTransaction:i}=t;return QC(e)&&r?r(e,n):YC(e)&&i?i(e,n):e}function QC(t){return t.type===void 0}function YC(t){return t.type==="transaction"}function SL(t,e){e.debug===!0&&(Ht?tt.enable():gp(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}));const n=nr();n.getScope().update(e.initialScope);const i=new t(e);n.bindClient(i)}const TL=30;function XC(t,e,n=SM(t.bufferSize||TL)){let r={};const i=a=>n.drain(a);function s(a){const l=[];if(aS(a,(v,I)=>{const S=uS(I);if(FM(r,S)){const j=gS(v,I);t.recordDroppedEvent("ratelimit_backoff",S,j)}else l.push(v)}),l.length===0)return ka();const h=td(a[0],l),g=v=>{aS(h,(I,S)=>{const j=gS(I,S);t.recordDroppedEvent(v,uS(S),j)})},m=()=>e({body:PM(h,t.textEncoder)}).then(v=>(v.statusCode!==void 0&&(v.statusCode<200||v.statusCode>=300)&&Ht&&tt.warn(`Sentry responded with status code ${v.statusCode} to sent event.`),r=BM(r,v),v),v=>{throw g("network_error"),v});return n.add(m).then(v=>v,v=>{if(v instanceof Bi)return Ht&&tt.error("Skipped sending event because buffer is full."),g("queue_overflow"),ka();throw v})}return s.__sentry__baseTransport__=!0,{send:s,flush:i}}function gS(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}const pS="7.83.0";let mS;class yp{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=yp.id}setupOnce(){mS=Function.prototype.toString;try{Function.prototype.toString=function(...e){const n=D0(this)||this;return mS.apply(n,e)}}catch{}}}yp.__initStatic();const xL=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],CL=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/];class wp{static __initStatic(){this.id="InboundFilters"}constructor(e={}){this.name=wp.id,this._options=e}setupOnce(e,n){}processEvent(e,n,r){const i=r.getOptions(),s=bL(this._options,i);return AL(e,s)?null:e}}wp.__initStatic();function bL(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:xL],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:CL],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function AL(t,e){return e.ignoreInternal&&OL(t)?(Ht&&tt.warn(`Event dropped due to being internal Sentry Error.
Event: ${eo(t)}`),!0):PL(t,e.ignoreErrors)?(Ht&&tt.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${eo(t)}`),!0):RL(t,e.ignoreTransactions)?(Ht&&tt.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${eo(t)}`),!0):kL(t,e.denyUrls)?(Ht&&tt.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${eo(t)}.
Url: ${ig(t)}`),!0):NL(t,e.allowUrls)?!1:(Ht&&tt.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${eo(t)}.
Url: ${ig(t)}`),!0)}function PL(t,e){return t.type||!e||!e.length?!1:DL(t).some(n=>dp(n,e))}function RL(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?dp(n,e):!1}function kL(t,e){if(!e||!e.length)return!1;const n=ig(t);return n?dp(n,e):!1}function NL(t,e){if(!e||!e.length)return!0;const n=ig(t);return n?dp(n,e):!0}function DL(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),Ht&&e.length===0&&tt.error(`Could not extract message for event ${eo(t)}`),e}function OL(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function ML(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function ig(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?ML(e):null}catch{return Ht&&tt.error(`Cannot extract url for event ${eo(t)}`),null}}const Pt=Rt;let vv=0;function JC(){return vv>0}function LL(){vv++,setTimeout(()=>{vv--})}function ol(t,e={},n){if(typeof t!="function")return t;try{const i=t.__sentry_wrapped__;if(i)return i;if(D0(t))return t}catch{return t}const r=function(){const i=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=i.map(a=>ol(a,e));return t.apply(this,s)}catch(s){throw LL(),oL(a=>{a.addEventProcessor(l=>(e.mechanism&&(uv(l,void 0,void 0),nh(l,e.mechanism)),l.extra={...l.extra,arguments:i},l)),sL(s)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}DC(r,t),th(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}const ys=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function ZC(t,e){const n=V0(t,e),r={type:e&&e.name,value:UL(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function VL(t,e,n,r){const s=nr().getClient(),a=s&&s.getOptions().normalizeDepth,l={exception:{values:[{type:hp(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:$L(e,{isUnhandledRejection:r})}]},extra:{__serialized__:jC(e,a)}};if(n){const h=V0(t,n);h.length&&(l.exception.values[0].stacktrace={frames:h})}return l}function Zm(t,e){return{exception:{values:[ZC(t,e)]}}}function V0(t,e){const n=e.stacktrace||e.stack||"",r=BL(e);try{return t(n,r)}catch{}return[]}const FL=/Minified React error #\d+;/i;function BL(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(FL.test(t.message))return 1}return 0}function UL(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function jL(t,e,n,r){const i=n&&n.syntheticException||void 0,s=F0(t,e,i,r);return nh(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),ka(s)}function zL(t,e,n="info",r,i){const s=r&&r.syntheticException||void 0,a=yv(t,e,s,i);return a.level=n,r&&r.event_id&&(a.event_id=r.event_id),ka(a)}function F0(t,e,n,r,i){let s;if(R0(e)&&e.error)return Zm(t,e.error);if(WI(e)||SO(e)){const a=e;if("stack"in e)s=Zm(t,e);else{const l=a.name||(WI(a)?"DOMError":"DOMException"),h=a.message?`${l}: ${a.message}`:l;s=yv(t,h,n,r),uv(s,h)}return"code"in a&&(s.tags={...s.tags,"DOMException.code":`${a.code}`}),s}return PC(e)?Zm(t,e):il(e)||hp(e)?(s=VL(t,e,n,i),nh(s,{synthetic:!0}),s):(s=yv(t,e,n,r),uv(s,`${e}`,void 0),nh(s,{synthetic:!0}),s)}function yv(t,e,n,r){const i={message:e};if(r&&n){const s=V0(t,n);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]})}return i}function $L(t,{isUnhandledRejection:e}){const n=$O(t),r=e?"promise rejection":"exception";return R0(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:hp(t)?`Event \`${HL(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function HL(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function qL(t,{metadata:e,tunnel:n,dsn:r}){const i={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!r&&{dsn:pp(r)}},s=GL(t);return td(i,[s])}function GL(t){return[{type:"user_report"},t]}class WL extends wL{constructor(e){const n=Pt.SENTRY_SDK_SOURCE||pM();e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${n}:@sentry/browser`,version:pS}],version:pS},super(e),e.sendClientReports&&Pt.document&&Pt.document.addEventListener("visibilitychange",()=>{Pt.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return jL(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return zL(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){ys&&tt.warn("SDK not enabled, will not capture user feedback.");return}const n=qL(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){ys&&tt.log("No outcomes to send");return}if(!this._dsn){ys&&tt.log("No dsn provided, will not send outcomes");return}ys&&tt.log("Sending outcomes:",e);const n=OM(e,this._options.tunnel&&pp(this._dsn));this._sendEnvelope(n)}}let Ec;function KL(){if(Ec)return Ec;if(dv(Pt.fetch))return Ec=Pt.fetch.bind(Pt);const t=Pt.document;let e=Pt.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const r=n.contentWindow;r&&r.fetch&&(e=r.fetch),t.head.removeChild(n)}catch(n){ys&&tt.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return Ec=e.bind(Pt)}function QL(){Ec=void 0}function YL(t,e=KL()){let n=0,r=0;function i(s){const a=s.body.length;n+=a,r++;const l={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};try{return e(t.url,l).then(h=>(n-=a,r--,{statusCode:h.status,headers:{"x-sentry-rate-limits":h.headers.get("X-Sentry-Rate-Limits"),"retry-after":h.headers.get("Retry-After")}}))}catch(h){return QL(),n-=a,r--,O0(h)}}return XC(t,i)}const XL=4;function JL(t){function e(n){return new Fr((r,i)=>{const s=new XMLHttpRequest;s.onerror=i,s.onreadystatechange=()=>{s.readyState===XL&&r({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",t.url);for(const a in t.headers)Object.prototype.hasOwnProperty.call(t.headers,a)&&s.setRequestHeader(a,t.headers[a]);s.send(n.body)})}return XC(t,e)}const Ep="?",ZL=30,eV=40,tV=50;function B0(t,e,n,r){const i={filename:t,function:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const nV=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,rV=/\((\S*)(?::(\d+))(?::(\d+))\)/,iV=t=>{const e=nV.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const s=rV.exec(e[2]);s&&(e[2]=s[1],e[3]=s[2],e[4]=s[3])}const[r,i]=eb(e[1]||Ep,e[2]);return B0(i,r,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},sV=[ZL,iV],oV=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,aV=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,uV=t=>{const e=oV.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=aV.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let r=e[3],i=e[1]||Ep;return[i,r]=eb(i,r),B0(r,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},lV=[tV,uV],cV=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,hV=t=>{const e=cV.exec(t);return e?B0(e[2],e[1]||Ep,+e[3],e[4]?+e[4]:void 0):void 0},dV=[eV,hV],fV=[sV,lV,dV],gV=LC(...fV),eb=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ep,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]};class Dl{static __initStatic(){this.id="GlobalHandlers"}constructor(e){this.name=Dl.id,this._options={onerror:!0,onunhandledrejection:!0,...e},this._installFunc={onerror:pV,onunhandledrejection:mV}}setupOnce(){Error.stackTraceLimit=50;const e=this._options;for(const n in e){const r=this._installFunc[n];r&&e[n]&&(wV(n),r(),this._installFunc[n]=void 0)}}}Dl.__initStatic();function pV(){iM(t=>{const[e,n,r]=nb();if(!e.getIntegration(Dl))return;const{msg:i,url:s,line:a,column:l,error:h}=t;if(JC())return;const g=h===void 0&&xs(i)?yV(i,s,a,l):tb(F0(n,h||i,void 0,r,!1),s,a,l);g.level="error",e.captureEvent(g,{originalException:h,mechanism:{handled:!1,type:"onerror"}})})}function mV(){oM(t=>{const[e,n,r]=nb();if(!e.getIntegration(Dl))return;if(JC())return!0;const i=_V(t),s=k0(i)?vV(i):F0(n,i,void 0,r,!0);s.level="error",e.captureEvent(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function _V(t){if(k0(t))return t;const e=t;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return t}function vV(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function yV(t,e,n,r){const i=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=R0(t)?t.message:t,a="Error";const l=s.match(i);return l&&(a=l[1],s=l[2]),tb({exception:{values:[{type:a,value:s}]}},e,n,r)}function tb(t,e,n,r){const i=t.exception=t.exception||{},s=i.values=i.values||[],a=s[0]=s[0]||{},l=a.stacktrace=a.stacktrace||{},h=l.frames=l.frames||[],g=isNaN(parseInt(r,10))?void 0:r,m=isNaN(parseInt(n,10))?void 0:n,v=xs(e)&&e.length>0?e:OO();return h.length===0&&h.push({colno:g,filename:v,function:"?",in_app:!0,lineno:m}),t}function wV(t){ys&&tt.log(`Global Handler attached: ${t}`)}function nb(){const t=nr(),e=t.getClient(),n=e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[t,n.stackParser,n.attachStacktrace]}const EV=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Ip{static __initStatic(){this.id="TryCatch"}constructor(e){this.name=Ip.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e}}setupOnce(){this._options.setTimeout&&Un(Pt,"setTimeout",_S),this._options.setInterval&&Un(Pt,"setInterval",_S),this._options.requestAnimationFrame&&Un(Pt,"requestAnimationFrame",IV),this._options.XMLHttpRequest&&"XMLHttpRequest"in Pt&&Un(XMLHttpRequest.prototype,"send",SV);const e=this._options.eventTarget;e&&(Array.isArray(e)?e:EV).forEach(TV)}}Ip.__initStatic();function _S(t){return function(...e){const n=e[0];return e[0]=ol(n,{mechanism:{data:{function:xo(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function IV(t){return function(e){return t.apply(this,[ol(e,{mechanism:{data:{function:"requestAnimationFrame",handler:xo(t)},handled:!1,type:"instrument"}})])}}function SV(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in n&&typeof n[i]=="function"&&Un(n,i,function(s){const a={mechanism:{data:{function:i,handler:xo(s)},handled:!1,type:"instrument"}},l=D0(s);return l&&(a.mechanism.data.handler=xo(l)),ol(s,a)})}),t.apply(this,e)}}function TV(t){const e=Pt,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(Un(n,"addEventListener",function(r){return function(i,s,a){try{typeof s.handleEvent=="function"&&(s.handleEvent=ol(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:xo(s),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,ol(s,{mechanism:{data:{function:"addEventListener",handler:xo(s),target:t},handled:!1,type:"instrument"}}),a])}}),Un(n,"removeEventListener",function(r){return function(i,s,a){const l=s;try{const h=l&&l.__sentry_wrapped__;h&&r.call(this,i,h,a)}catch{}return r.call(this,i,l,a)}}))}const xV="cause",CV=5;class Sp{static __initStatic(){this.id="LinkedErrors"}constructor(e={}){this.name=Sp.id,this._key=e.key||xV,this._limit=e.limit||CV}setupOnce(){}preprocessEvent(e,n,r){const i=r.getOptions();PO(ZC,i.stackParser,i.maxValueLength,this._key,this._limit,e,n)}}Sp.__initStatic();class Tp{static __initStatic(){this.id="HttpContext"}constructor(){this.name=Tp.id}setupOnce(){}preprocessEvent(e){if(!Pt.navigator&&!Pt.location&&!Pt.document)return;const n=e.request&&e.request.url||Pt.location&&Pt.location.href,{referrer:r}=Pt.document||{},{userAgent:i}=Pt.navigator||{},s={...e.request&&e.request.headers,...r&&{Referer:r},...i&&{"User-Agent":i}},a={...e.request,...n&&{url:n},headers:s};e.request=a}}Tp.__initStatic();class xp{static __initStatic(){this.id="Dedupe"}constructor(){this.name=xp.id}setupOnce(e,n){}processEvent(e){if(e.type)return e;try{if(bV(e,this._previousEvent))return ys&&tt.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return this._previousEvent=e}}xp.__initStatic();function bV(t,e){return e?!!(AV(t,e)||PV(t,e)):!1}function AV(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!ib(t,e)||!rb(t,e))}function PV(t,e){const n=vS(e),r=vS(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!ib(t,e)||!rb(t,e))}function rb(t,e){let n=yS(t),r=yS(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let i=0;i<r.length;i++){const s=r[i],a=n[i];if(s.filename!==a.filename||s.lineno!==a.lineno||s.colno!==a.colno||s.function!==a.function)return!1}return!0}function ib(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function vS(t){return t.exception&&t.exception.values&&t.exception.values[0]}function yS(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const Wd=1024;class Cp{static __initStatic(){this.id="Breadcrumbs"}constructor(e){this.name=Cp.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e}}setupOnce(){if(this.options.console&&GO(NV),this.options.dom&&QO(kV(this.options.dom)),this.options.xhr&&hM(DV),this.options.fetch&&tM(OV),this.options.history&&UC(MV),this.options.sentry){const e=aL();e&&e.on&&e.on("beforeSendEvent",RV)}}}Cp.__initStatic();function RV(t){nr().addBreadcrumb({category:`sentry.${t.type==="transaction"?"transaction":"event"}`,event_id:t.event_id,level:t.level,message:eo(t)},{event:t})}function kV(t){function e(n){let r,i=typeof t=="object"?t.serializeAttribute:void 0,s=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;s&&s>Wd&&(ys&&tt.warn(`\`dom.maxStringLength\` cannot exceed ${Wd}, but a value of ${s} was configured. Sentry will use ${Wd} instead.`),s=Wd),typeof i=="string"&&(i=[i]);try{const a=n.event;r=LV(a)?sv(a.target,{keyAttrs:i,maxStringLength:s}):sv(a,{keyAttrs:i,maxStringLength:s})}catch{r="<unknown>"}r.length!==0&&nr().addBreadcrumb({category:`ui.${n.name}`,message:r},{event:n.event,name:n.name,global:n.global})}return e}function NV(t){const e={category:"console",data:{arguments:t.args,logger:"console"},level:xM(t.level),message:KI(t.args," ")};if(t.level==="assert")if(t.args[0]===!1)e.message=`Assertion failed: ${KI(t.args.slice(1)," ")||"console.assert"}`,e.data.arguments=t.args.slice(1);else return;nr().addBreadcrumb(e,{input:t.args,level:t.level})}function DV(t){const{startTimestamp:e,endTimestamp:n}=t,r=t.xhr[wc];if(!e||!n||!r)return;const{method:i,url:s,status_code:a,body:l}=r,h={method:i,url:s,status_code:a},g={xhr:t.xhr,input:l,startTimestamp:e,endTimestamp:n};nr().addBreadcrumb({category:"xhr",data:h,type:"http"},g)}function OV(t){const{startTimestamp:e,endTimestamp:n}=t;if(n&&!(t.fetchData.url.match(/sentry_key/)&&t.fetchData.method==="POST"))if(t.error){const r=t.fetchData,i={data:t.error,input:t.args,startTimestamp:e,endTimestamp:n};nr().addBreadcrumb({category:"fetch",data:r,level:"error",type:"http"},i)}else{const r=t.response,i={...t.fetchData,status_code:r&&r.status},s={input:t.args,response:r,startTimestamp:e,endTimestamp:n};nr().addBreadcrumb({category:"fetch",data:i,type:"http"},s)}}function MV(t){let e=t.from,n=t.to;const r=Xm(Pt.location.href);let i=e?Xm(e):void 0;const s=Xm(n);(!i||!i.path)&&(i=r),r.protocol===s.protocol&&r.host===s.host&&(n=s.relative),r.protocol===i.protocol&&r.host===i.host&&(e=i.relative),nr().addBreadcrumb({category:"navigation",data:{from:e,to:n}})}function LV(t){return!!t&&!!t.target}const VV=[new wp,new yp,new Ip,new Cp,new Dl,new Sp,new xp,new Tp];function FV(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=VV),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),Pt.SENTRY_RELEASE&&Pt.SENTRY_RELEASE.id&&(t.release=Pt.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:HO(t.stackParser||gV),integrations:_L(t),transport:t.transport||(BC()?YL:JL)};SL(WL,e),t.autoSessionTracking&&BV()}function wS(t){t.startSession({ignoreDuration:!0}),t.captureSession()}function BV(){if(typeof Pt.document>"u"){ys&&tt.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const t=nr();t.captureSession&&(wS(t),UC(({from:e,to:n})=>{e!==void 0&&e!==n&&wS(nr())}))}const UV=50,jV=.25,ga=1,_s=4,zV=2,$V=5,ES=10,HV=300,Kd=1500,IS=100,sg=250,Zr=1e3,wv=500,cn="DIALOG_CLOSED_REASON",SS=60,qV=5,TS=2,xS=.25,CS=.75,GV=["animals","letters","digits","people","geometric","stuff"],Oc=["0","1","2","3","4","5","6","7","8","9"],Mc=["","","","","","","","","","","","","","","","","","","","","","","","","",""];{let t=function(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","G-F7R3KZMTTS",{anonymize_ip:!0,cookie_expires:0})}FV({dsn:"https://1b2f34262d80460298da419637b59901@o375098.ingest.sentry.io/5194058",environment:"production",enabled:!0,beforeSend:(t,e)=>e.originalException===cn?null:t});var WV={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ev=function(t,e){return Ev=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Ev(t,e)};function sb(t,e){Ev(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ur=function(){return Ur=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ur.apply(this,arguments)};function rh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function al(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var s=arguments[e],a=0,l=s.length;a<l;a++,i++)r[i]=s[a];return r}function KV(t,e){for(;t.length<e;)t="0"+t;return t}function cs(t,e){var n,r,i;if(e.length===0)return t;for(n=0,i=e.length;n<i;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t<0?t*-2:t}function QV(t,e,n){return Object.keys(e).sort().reduce(r,t);function r(i,s){return ob(i,e[s],s,n)}}function ob(t,e,n,r){var i=cs(cs(cs(t,n),YV(e)),typeof e);if(e===null)return cs(i,"null");if(e===void 0)return cs(i,"undefined");if(typeof e=="object"||typeof e=="function"){if(r.indexOf(e)!==-1)return cs(i,"[Circular]"+n);r.push(e);var s=QV(i,e,r);if(!("valueOf"in e)||typeof e.valueOf!="function")return s;try{return cs(s,String(e.valueOf()))}catch(a){return cs(s,"[valueOf exception]"+(a.stack||a.message))}}return cs(i,e.toString())}function YV(t){return Object.prototype.toString.call(t)}function XV(t){return KV(ob(0,t,"",[]).toString(16),8)}var U0=XV,JV={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ZV={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},eF={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],size:["width","height"]},tF={color:"colors",backgroundColor:"colors",borderColor:"colors",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",outlineColor:"colors",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",fill:"colors",stroke:"colors"},nF={margin:1,marginTop:1,marginRight:1,marginBottom:1,marginLeft:1,marginX:1,marginY:1,top:1,bottom:1,left:1,right:1},wi={unitlessProperties:JV,propertyAliases:ZV,multiplePropertyAliases:eF,propertyScales:tF,negativeProperties:nF},jr=function(t,e,n){for(var r=t,i=typeof e=="string"?e.split("."):[e],s=0,a=i;s<a.length;s++){var l=a[s];r=r?r[l]:void 0}return r===void 0?n:r},ab=function(t,e){if(typeof e!="number"||e>=0)return jr(t,e,e);var n=Math.abs(e),r=jr(t,n,n);return typeof r=="string"?"-"+r:r*-1},Iv=function(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!(t in wi.unitlessProperties)?e+"px":String(e).trim()},Sv=function(t){return t.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})},rF=function(t,e){var n={},r=jr(e,"breakpoints"),i=Object.entries(r).reduce(function(S,j,z){var J,V=j[0],B=j[1];return Ur(Ur({},S),(J={},J[V]="@media screen and (min-width: #"+z+"#"+B+")",J))},{_:null});for(var s in t){var a=t[s],l=typeof a;if(a!=null){if(s.includes("&")||s.startsWith("@")||l==="string"||l==="number"){n[s]=a;continue}for(var h=Object.keys(a),g=0,m=h;g<m.length;g++){var v=m[g],I=i[v];if(!I){n[s]=a[v];continue}n[I]=n[I]||{},a[v]!=null&&(n[I][s]=a[v])}}}return n},j0=function(t,e){var n={},r=rF(t,e);for(var i in r){var s=r[i];if(s&&typeof s=="object"){n[i]=j0(s,e);continue}var a=jr(wi.propertyAliases,i,i),l=jr(wi.propertyScales,a),h=jr(e,l,jr(e,a,{})),g=a in wi.negativeProperties?ab(h,s):jr(h,s,s);if(wi.multiplePropertyAliases[a])for(var m=wi.multiplePropertyAliases[a],v=0;v<m.length;v++)n[m[v]]=g;else n[a]=g}return n},Tv=function(t,e,n){Object.keys(e).forEach(function(r){var i=e[r];typeof i=="string"||typeof i=="number"?(n[t]||(n[t]=""),n[t]+=Sv(r)+":"+Iv(r,i)+";"):typeof i=="object"&&(r.startsWith("@media")||r.startsWith("@supports")?(n[r]||(n[r]={}),Tv(t,i,n[r])):Tv(r.replace(/&/g,t),i,n))})},ub=function(t){var e={};return Tv("&",t,e),e},z0=[],fo="global",og="data-css-system-id",xv="data-css-system-ids",Cv=" ",iF=typeof process=="object"&&WV&&!1,bv=function(){function t(e){var n=this;this.createdIds={};var r=document.querySelector("style["+og+'="'+e+'"]');if(r===null)r=document.createElement("style"),r.setAttribute(og,e),document.head.appendChild(r);else{var i=r.getAttribute(xv);i!==null&&i.split(Cv).forEach(function(s){return n.createdIds[s]=!0})}this.element=r}return t.prototype.insertRule=function(e){var n=this.element.sheet;n.insertRule(e,n.cssRules.length)},t.prototype.remove=function(){this.element.remove()},t}(),bS=function(t){sb(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.insertRule=function(n){this.element.textContent+=n+`
`},e}(bv),lb=function(){function t(){var e;this.styleSheets=(e={},e[fo]=new bv(fo),e)}return t.prototype.getGlobalStyleSheet=function(){return this.styleSheets[fo]},t.prototype.createStyleSheet=function(e){return this.styleSheets[e]=new bv(e),this.styleSheets[e]},t.prototype.removeStyleSheet=function(e){this.styleSheets[e]&&(this.styleSheets[e].remove(),delete this.styleSheets[e])},t}(),sF=function(t){sb(e,t);function e(){var n,r=t!==null&&t.apply(this,arguments)||this;return r.styleSheets=(n={},n[fo]=new bS(fo),n),r}return e.prototype.createStyleSheet=function(n){return this.styleSheets[n]=new bS(n),this.styleSheets[n]},e}(lb),AS=function(){function t(e){this.rules=[],this.createdIds={},this.id=e}return t.prototype.insertRule=function(e){this.rules.push(e)},t.prototype.getStyleTag=function(){return"<style "+og+'="'+this.id+'" '+xv+'="'+Object.keys(this.createdIds).join(Cv)+'">'+this.rules.join(`
`)+"</style>"},t.prototype.getStyleComponent=function(){var e;return G.createElement("style",(e={},e[og]=this.id,e[xv]=Object.keys(this.createdIds).join(Cv),e.dangerouslySetInnerHTML={__html:this.rules.join(`
`)},e))},t}(),oF=function(){function t(){var e;this.styleSheets=(e={},e[fo]=new AS(fo),e)}return t.prototype.getGlobalStyleSheet=function(){return this.styleSheets[fo]},t.prototype.createStyleSheet=function(e){return this.styleSheets[e]=new AS(e),this.styleSheets[e]},t.prototype.removeStyleSheet=function(e){delete this.styleSheets[e]},t.prototype.getStyleTags=function(){return Object.values(this.styleSheets).map(function(e){return e.getStyleTag()}).join(`
`)},t.prototype.getStyleComponents=function(){return Object.values(this.styleSheets).map(function(e){return e.getStyleComponent()})},t}(),aF=typeof document<"u",$0=G.createContext(aF?iF?new sF:new lb:new oF),uF={breakpoints:{s:"40em",m:"52em",l:"64em"},space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},ki=G.createContext(uF),lF=function(t,e){e===void 0&&(e=z0);var n=G.useContext($0),r=G.useContext(ki),i=G.useMemo(function(){var s=j0(t,r),a=U0(s),l="style-"+a,h=n.getGlobalStyleSheet();if(!h.createdIds[l]){for(var g=ub(s),m=Object.keys(g).sort(function(Z,ne){return Z<ne?-1:Z>ne?1:0}),v=0,I=m;v<I.length;v++){var S=I[v];if(typeof g[S]=="string"){var j=S.replace(/&/g,"."+l),z=g[S];h.insertRule(j+"{"+z+"}")}else{var J=S,V=g[J],B="";for(var U in V){var j=U.replace(/&/g,"."+l),z=V[U];B+=j+"{"+z+"}"}h.insertRule(J.replace(/#\d#/,"")+"{"+B+"}")}}h.createdIds[l]=!0}return l},al([r],e));return i},cF=function(t,e){e===void 0&&(e=z0);var n=G.useContext($0),r=G.useContext(ki),i=G.useMemo(function(){var s=U0({systemObject:t,theme:r}),a=n.createStyleSheet(s);for(var l in t)for(var h=j0(t[l],r),g=ub(h),m=Object.keys(g).sort(function(Z,ne){return Z<ne?-1:Z>ne?1:0}),v=0,I=m;v<I.length;v++){var S=I[v];if(typeof g[S]=="string"){var j=S.replace(/&/g,l).replace(/#\d#/,""),z=g[S];a.insertRule(j+"{"+z+"}")}else{var J=S,V=g[J],B="";for(var U in V){var j=U.replace(/&/g,l),z=V[U];B+=j+"{"+z+"}"}a.insertRule(J.replace(/#\d#/,"")+"{"+B+"}")}}return s},al([r],e));G.useEffect(function(){return function(){return n.removeStyleSheet(i)}},al([i,r],e))},hF=function(t,e){var n="";for(var r in t){var i=t[r],s=jr(wi.propertyAliases,r,r),a=jr(wi.propertyScales,s),l=jr(e,a,jr(e,s,{})),h=s in wi.negativeProperties?ab(l,i):jr(l,i,i);if(wi.multiplePropertyAliases[s])for(var g=wi.multiplePropertyAliases[s],m=0;m<g.length;m++)n+=Sv(g[m])+":"+Iv(s,h)+";";else n+=Sv(s)+":"+Iv(s,h)+";"}return n},ag=function(t,e){e===void 0&&(e=z0);var n=G.useContext($0),r=G.useContext(ki),i=G.useMemo(function(){var s="keyframes-"+U0({keyframesObject:t,theme:r}),a=n.getGlobalStyleSheet();if(!a.createdIds[s]){var l="";for(var h in t){var g=t[h],m=isNaN(h)?h:h+"%",v=hF(g,r);l+=m+"{"+v+"}"}a.insertRule("@keyframes "+s+"{"+l+"}"),a.createdIds[s]=!0}return s},al([r],e));return i},cb=function(t){var e=t.css,n=rh(t,["css"]);return function(r){var i=r.css,s=rh(r,["css"]);return Ur(Ur(Ur({},n),{css:Ur(Ur({},e),i)}),s)}},nd=function(t,e){var n=typeof e=="function"?e:cb(e);return It.forwardRef(function(r,i){var s=n(r),a=s.as,l=a===void 0?t:a,h=s.css,g=s.deps,m=s.className,v=rh(s,["as","css","deps","className"]),I=lF(h,g),S=m?m+" "+I:I;return It.createElement(l,Ur({ref:i},v,{className:S}))})},as=function(t,e){var n=typeof e=="function"?e:cb(e);return It.forwardRef(function(r,i){var s=n(r),a=s.css,l=rh(s,["css"]);return It.createElement(t,Ur({ref:i,css:a},l))})},dF=function(t){var e=t.gap,n=rh(t,["gap"]),r=n.flexDirection,i=G.useContext(ki),s=G.useMemo(function(){var a;if(e&&r){if(typeof r=="string"){var l=r==="column"||r==="column-reverse";return{"& > * + *":(a={},a[l?"mt":"ml"]=e,a)}}for(var h=void 0,g=void 0,m=typeof e=="object"?e:{_:e},v=r,I=new Set(al(Object.keys(v),Object.keys(m))),S={},j={},z=al(["_"],Object.keys(i.breakpoints)),J=0,V=z;J<V.length;J++){var B=V[J];if(I.has(B)!==!1){var U=B,Z=v[U]!=null?v[U]:h;h=Z;var ne=m[U]!=null?m[U]:g;g=ne;var l=Z==="column"||Z==="column-reverse";l?(S[U]=ne,j[U]=0):(j[U]=ne,S[U]=0)}}return{"& > * + *":{mt:S,ml:j}}}},[e,r,i]);return e?Ur(Ur({},n),s):n},Av={},hb={exports:{}},Qr={},db={exports:{}},fb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(xe,ye){var De=xe.length;xe.push(ye);e:for(;0<De;){var it=De-1>>>1,ze=xe[it];if(0<i(ze,ye))xe[it]=ye,xe[De]=ze,De=it;else break e}}function n(xe){return xe.length===0?null:xe[0]}function r(xe){if(xe.length===0)return null;var ye=xe[0],De=xe.pop();if(De!==ye){xe[0]=De;e:for(var it=0,ze=xe.length,kt=ze>>>1;it<kt;){var ht=2*(it+1)-1,yt=xe[ht],pn=ht+1,ir=xe[pn];if(0>i(yt,De))pn<ze&&0>i(ir,yt)?(xe[it]=ir,xe[pn]=De,it=pn):(xe[it]=yt,xe[ht]=De,it=ht);else if(pn<ze&&0>i(ir,De))xe[it]=ir,xe[pn]=De,it=pn;else break e}}return ye}function i(xe,ye){var De=xe.sortIndex-ye.sortIndex;return De!==0?De:xe.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var h=[],g=[],m=1,v=null,I=3,S=!1,j=!1,z=!1,J=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(xe){for(var ye=n(g);ye!==null;){if(ye.callback===null)r(g);else if(ye.startTime<=xe)r(g),ye.sortIndex=ye.expirationTime,e(h,ye);else break;ye=n(g)}}function Z(xe){if(z=!1,U(xe),!j)if(n(h)!==null)j=!0,he(ne);else{var ye=n(g);ye!==null&&rt(Z,ye.startTime-xe)}}function ne(xe,ye){j=!1,z&&(z=!1,V(ce),ce=-1),S=!0;var De=I;try{for(U(ye),v=n(h);v!==null&&(!(v.expirationTime>ye)||xe&&!Ye());){var it=v.callback;if(typeof it=="function"){v.callback=null,I=v.priorityLevel;var ze=it(v.expirationTime<=ye);ye=t.unstable_now(),typeof ze=="function"?v.callback=ze:v===n(h)&&r(h),U(ye)}else r(h);v=n(h)}if(v!==null)var kt=!0;else{var ht=n(g);ht!==null&&rt(Z,ht.startTime-ye),kt=!1}return kt}finally{v=null,I=De,S=!1}}var te=!1,oe=null,ce=-1,_e=5,pe=-1;function Ye(){return!(t.unstable_now()-pe<_e)}function be(){if(oe!==null){var xe=t.unstable_now();pe=xe;var ye=!0;try{ye=oe(!0,xe)}finally{ye?Me():(te=!1,oe=null)}}else te=!1}var Me;if(typeof B=="function")Me=function(){B(be)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,je=Se.port2;Se.port1.onmessage=be,Me=function(){je.postMessage(null)}}else Me=function(){J(be,0)};function he(xe){oe=xe,te||(te=!0,Me())}function rt(xe,ye){ce=J(function(){xe(t.unstable_now())},ye)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(xe){xe.callback=null},t.unstable_continueExecution=function(){j||S||(j=!0,he(ne))},t.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_e=0<xe?Math.floor(1e3/xe):5},t.unstable_getCurrentPriorityLevel=function(){return I},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(xe){switch(I){case 1:case 2:case 3:var ye=3;break;default:ye=I}var De=I;I=ye;try{return xe()}finally{I=De}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(xe,ye){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var De=I;I=xe;try{return ye()}finally{I=De}},t.unstable_scheduleCallback=function(xe,ye,De){var it=t.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?it+De:it):De=it,xe){case 1:var ze=-1;break;case 2:ze=250;break;case 5:ze=1073741823;break;case 4:ze=1e4;break;default:ze=5e3}return ze=De+ze,xe={id:m++,callback:ye,priorityLevel:xe,startTime:De,expirationTime:ze,sortIndex:-1},De>it?(xe.sortIndex=De,e(g,xe),n(h)===null&&xe===n(g)&&(z?(V(ce),ce=-1):z=!0,rt(Z,De-it))):(xe.sortIndex=ze,e(h,xe),j||S||(j=!0,he(ne))),xe},t.unstable_shouldYield=Ye,t.unstable_wrapCallback=function(xe){var ye=I;return function(){var De=I;I=ye;try{return xe.apply(this,arguments)}finally{I=De}}}})(fb);db.exports=fb;var fF=db.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb=G,Gr=fF;function we(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pb=new Set,ih={};function Za(t,e){ul(t,e),ul(t+"Capture",e)}function ul(t,e){for(ih[t]=e,t=0;t<e.length;t++)pb.add(e[t])}var Rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pv=Object.prototype.hasOwnProperty,gF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PS={},RS={};function pF(t){return Pv.call(RS,t)?!0:Pv.call(PS,t)?!1:gF.test(t)?RS[t]=!0:(PS[t]=!0,!1)}function mF(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _F(t,e,n,r){if(e===null||typeof e>"u"||mF(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function yr(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Hn[t]=new yr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Hn[e]=new yr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Hn[t]=new yr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Hn[t]=new yr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Hn[t]=new yr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Hn[t]=new yr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Hn[t]=new yr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Hn[t]=new yr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Hn[t]=new yr(t,5,!1,t.toLowerCase(),null,!1,!1)});var H0=/[\-:]([a-z])/g;function q0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(H0,q0);Hn[e]=new yr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(H0,q0);Hn[e]=new yr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(H0,q0);Hn[e]=new yr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Hn[t]=new yr(t,1,!1,t.toLowerCase(),null,!1,!1)});Hn.xlinkHref=new yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Hn[t]=new yr(t,1,!1,t.toLowerCase(),null,!0,!0)});function G0(t,e,n,r){var i=Hn.hasOwnProperty(e)?Hn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_F(e,n,i,r)&&(n=null),r||i===null?pF(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Fs=gb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qd=Symbol.for("react.element"),Pu=Symbol.for("react.portal"),Ru=Symbol.for("react.fragment"),W0=Symbol.for("react.strict_mode"),Rv=Symbol.for("react.profiler"),mb=Symbol.for("react.provider"),_b=Symbol.for("react.context"),K0=Symbol.for("react.forward_ref"),kv=Symbol.for("react.suspense"),Nv=Symbol.for("react.suspense_list"),Q0=Symbol.for("react.memo"),Js=Symbol.for("react.lazy"),vb=Symbol.for("react.offscreen"),kS=Symbol.iterator;function Zl(t){return t===null||typeof t!="object"?null:(t=kS&&t[kS]||t["@@iterator"],typeof t=="function"?t:null)}var Jt=Object.assign,e_;function Ic(t){if(e_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);e_=e&&e[1]||""}return`
`+e_+t}var t_=!1;function n_(t,e){if(!t||t_)return"";t_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(g){var r=g}Reflect.construct(t,[],e)}else{try{e.call()}catch(g){r=g}t.call(e.prototype)}else{try{throw Error()}catch(g){r=g}t()}}catch(g){if(g&&r&&typeof g.stack=="string"){for(var i=g.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var h=`
`+i[a].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=a&&0<=l);break}}}finally{t_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ic(t):""}function vF(t){switch(t.tag){case 5:return Ic(t.type);case 16:return Ic("Lazy");case 13:return Ic("Suspense");case 19:return Ic("SuspenseList");case 0:case 2:case 15:return t=n_(t.type,!1),t;case 11:return t=n_(t.type.render,!1),t;case 1:return t=n_(t.type,!0),t;default:return""}}function Dv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ru:return"Fragment";case Pu:return"Portal";case Rv:return"Profiler";case W0:return"StrictMode";case kv:return"Suspense";case Nv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _b:return(t.displayName||"Context")+".Consumer";case mb:return(t._context.displayName||"Context")+".Provider";case K0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Q0:return e=t.displayName||null,e!==null?e:Dv(t.type)||"Memo";case Js:e=t._payload,t=t._init;try{return Dv(t(e))}catch{}}return null}function yF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dv(e);case 8:return e===W0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Co(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yb(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wF(t){var e=yb(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Yd(t){t._valueTracker||(t._valueTracker=wF(t))}function wb(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=yb(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ug(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ov(t,e){var n=e.checked;return Jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function NS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Co(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Eb(t,e){e=e.checked,e!=null&&G0(t,"checked",e,!1)}function Mv(t,e){Eb(t,e);var n=Co(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Lv(t,e.type,Co(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function DS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Lv(t,e,n){(e!=="number"||ug(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Sc=Array.isArray;function qu(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Co(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Vv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(we(91));return Jt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function OS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(we(92));if(Sc(n)){if(1<n.length)throw Error(we(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Co(n)}}function Ib(t,e){var n=Co(e.value),r=Co(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function MS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Sb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Sb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xd,Tb=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xd=Xd||document.createElement("div"),Xd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Lc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EF=["Webkit","ms","Moz","O"];Object.keys(Lc).forEach(function(t){EF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Lc[e]=Lc[t]})});function xb(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Lc.hasOwnProperty(t)&&Lc[t]?(""+e).trim():e+"px"}function Cb(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=xb(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var IF=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bv(t,e){if(e){if(IF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(we(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(we(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(we(61))}if(e.style!=null&&typeof e.style!="object")throw Error(we(62))}}function Uv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jv=null;function Y0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zv=null,Gu=null,Wu=null;function LS(t){if(t=sd(t)){if(typeof zv!="function")throw Error(we(280));var e=t.stateNode;e&&(e=kp(e),zv(t.stateNode,t.type,e))}}function bb(t){Gu?Wu?Wu.push(t):Wu=[t]:Gu=t}function Ab(){if(Gu){var t=Gu,e=Wu;if(Wu=Gu=null,LS(t),e)for(t=0;t<e.length;t++)LS(e[t])}}function Pb(t,e){return t(e)}function Rb(){}var r_=!1;function kb(t,e,n){if(r_)return t(e,n);r_=!0;try{return Pb(t,e,n)}finally{r_=!1,(Gu!==null||Wu!==null)&&(Rb(),Ab())}}function oh(t,e){var n=t.stateNode;if(n===null)return null;var r=kp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(we(231,e,typeof n));return n}var $v=!1;if(Rs)try{var ec={};Object.defineProperty(ec,"passive",{get:function(){$v=!0}}),window.addEventListener("test",ec,ec),window.removeEventListener("test",ec,ec)}catch{$v=!1}function SF(t,e,n,r,i,s,a,l,h){var g=Array.prototype.slice.call(arguments,3);try{e.apply(n,g)}catch(m){this.onError(m)}}var Vc=!1,lg=null,cg=!1,Hv=null,TF={onError:function(t){Vc=!0,lg=t}};function xF(t,e,n,r,i,s,a,l,h){Vc=!1,lg=null,SF.apply(TF,arguments)}function CF(t,e,n,r,i,s,a,l,h){if(xF.apply(this,arguments),Vc){if(Vc){var g=lg;Vc=!1,lg=null}else throw Error(we(198));cg||(cg=!0,Hv=g)}}function eu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Nb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function VS(t){if(eu(t)!==t)throw Error(we(188))}function bF(t){var e=t.alternate;if(!e){if(e=eu(t),e===null)throw Error(we(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return VS(i),t;if(s===r)return VS(i),e;s=s.sibling}throw Error(we(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(we(189))}}if(n.alternate!==r)throw Error(we(190))}if(n.tag!==3)throw Error(we(188));return n.stateNode.current===n?t:e}function Db(t){return t=bF(t),t!==null?Ob(t):null}function Ob(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ob(t);if(e!==null)return e;t=t.sibling}return null}var Mb=Gr.unstable_scheduleCallback,FS=Gr.unstable_cancelCallback,AF=Gr.unstable_shouldYield,PF=Gr.unstable_requestPaint,hn=Gr.unstable_now,RF=Gr.unstable_getCurrentPriorityLevel,X0=Gr.unstable_ImmediatePriority,Lb=Gr.unstable_UserBlockingPriority,hg=Gr.unstable_NormalPriority,kF=Gr.unstable_LowPriority,Vb=Gr.unstable_IdlePriority,bp=null,Ji=null;function NF(t){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(bp,t,void 0,(t.current.flags&128)===128)}catch{}}var Ti=Math.clz32?Math.clz32:MF,DF=Math.log,OF=Math.LN2;function MF(t){return t>>>=0,t===0?32:31-(DF(t)/OF|0)|0}var Jd=64,Zd=4194304;function Tc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dg(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~i;l!==0?r=Tc(l):(s&=a,s!==0&&(r=Tc(s)))}else a=n&~i,a!==0?r=Tc(a):s!==0&&(r=Tc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ti(e),i=1<<n,r|=t[n],e&=~i;return r}function LF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VF(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Ti(s),l=1<<a,h=i[a];h===-1?(!(l&n)||l&r)&&(i[a]=LF(l,e)):h<=e&&(t.expiredLanes|=l),s&=~l}}function qv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Fb(){var t=Jd;return Jd<<=1,!(Jd&4194240)&&(Jd=64),t}function i_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function rd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ti(e),t[e]=n}function FF(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ti(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function J0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ti(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Tt=0;function Bb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ub,Z0,jb,zb,$b,Gv=!1,ef=[],go=null,po=null,mo=null,ah=new Map,uh=new Map,to=[],BF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function BS(t,e){switch(t){case"focusin":case"focusout":go=null;break;case"dragenter":case"dragleave":po=null;break;case"mouseover":case"mouseout":mo=null;break;case"pointerover":case"pointerout":ah.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":uh.delete(e.pointerId)}}function tc(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=sd(e),e!==null&&Z0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function UF(t,e,n,r,i){switch(e){case"focusin":return go=tc(go,t,e,n,r,i),!0;case"dragenter":return po=tc(po,t,e,n,r,i),!0;case"mouseover":return mo=tc(mo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ah.set(s,tc(ah.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,uh.set(s,tc(uh.get(s)||null,t,e,n,r,i)),!0}return!1}function Hb(t){var e=pa(t.target);if(e!==null){var n=eu(e);if(n!==null){if(e=n.tag,e===13){if(e=Nb(n),e!==null){t.blockedOn=e,$b(t.priority,function(){jb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Wv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);jv=r,n.target.dispatchEvent(r),jv=null}else return e=sd(n),e!==null&&Z0(e),t.blockedOn=n,!1;e.shift()}return!0}function US(t,e,n){kf(t)&&n.delete(e)}function jF(){Gv=!1,go!==null&&kf(go)&&(go=null),po!==null&&kf(po)&&(po=null),mo!==null&&kf(mo)&&(mo=null),ah.forEach(US),uh.forEach(US)}function nc(t,e){t.blockedOn===e&&(t.blockedOn=null,Gv||(Gv=!0,Gr.unstable_scheduleCallback(Gr.unstable_NormalPriority,jF)))}function lh(t){function e(i){return nc(i,t)}if(0<ef.length){nc(ef[0],t);for(var n=1;n<ef.length;n++){var r=ef[n];r.blockedOn===t&&(r.blockedOn=null)}}for(go!==null&&nc(go,t),po!==null&&nc(po,t),mo!==null&&nc(mo,t),ah.forEach(e),uh.forEach(e),n=0;n<to.length;n++)r=to[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<to.length&&(n=to[0],n.blockedOn===null);)Hb(n),n.blockedOn===null&&to.shift()}var Ku=Fs.ReactCurrentBatchConfig,fg=!0;function zF(t,e,n,r){var i=Tt,s=Ku.transition;Ku.transition=null;try{Tt=1,ew(t,e,n,r)}finally{Tt=i,Ku.transition=s}}function $F(t,e,n,r){var i=Tt,s=Ku.transition;Ku.transition=null;try{Tt=4,ew(t,e,n,r)}finally{Tt=i,Ku.transition=s}}function ew(t,e,n,r){if(fg){var i=Wv(t,e,n,r);if(i===null)g_(t,e,r,gg,n),BS(t,r);else if(UF(i,t,e,n,r))r.stopPropagation();else if(BS(t,r),e&4&&-1<BF.indexOf(t)){for(;i!==null;){var s=sd(i);if(s!==null&&Ub(s),s=Wv(t,e,n,r),s===null&&g_(t,e,r,gg,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else g_(t,e,r,null,n)}}var gg=null;function Wv(t,e,n,r){if(gg=null,t=Y0(r),t=pa(t),t!==null)if(e=eu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Nb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gg=t,null}function qb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RF()){case X0:return 1;case Lb:return 4;case hg:case kF:return 16;case Vb:return 536870912;default:return 16}default:return 16}}var oo=null,tw=null,Nf=null;function Gb(){if(Nf)return Nf;var t,e=tw,n=e.length,r,i="value"in oo?oo.value:oo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Nf=i.slice(t,1<r?1-r:void 0)}function Df(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function tf(){return!0}function jS(){return!1}function Yr(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?tf:jS,this.isPropagationStopped=jS,this}return Jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=tf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=tf)},persist:function(){},isPersistent:tf}),e}var Ol={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nw=Yr(Ol),id=Jt({},Ol,{view:0,detail:0}),HF=Yr(id),s_,o_,rc,Ap=Jt({},id,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==rc&&(rc&&t.type==="mousemove"?(s_=t.screenX-rc.screenX,o_=t.screenY-rc.screenY):o_=s_=0,rc=t),s_)},movementY:function(t){return"movementY"in t?t.movementY:o_}}),zS=Yr(Ap),qF=Jt({},Ap,{dataTransfer:0}),GF=Yr(qF),WF=Jt({},id,{relatedTarget:0}),a_=Yr(WF),KF=Jt({},Ol,{animationName:0,elapsedTime:0,pseudoElement:0}),QF=Yr(KF),YF=Jt({},Ol,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),XF=Yr(YF),JF=Jt({},Ol,{data:0}),$S=Yr(JF),ZF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},e5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},t5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function n5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=t5[t])?!!e[t]:!1}function rw(){return n5}var r5=Jt({},id,{key:function(t){if(t.key){var e=ZF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Df(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?e5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rw,charCode:function(t){return t.type==="keypress"?Df(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Df(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),i5=Yr(r5),s5=Jt({},Ap,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),HS=Yr(s5),o5=Jt({},id,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rw}),a5=Yr(o5),u5=Jt({},Ol,{propertyName:0,elapsedTime:0,pseudoElement:0}),l5=Yr(u5),c5=Jt({},Ap,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),h5=Yr(c5),d5=[9,13,27,32],iw=Rs&&"CompositionEvent"in window,Fc=null;Rs&&"documentMode"in document&&(Fc=document.documentMode);var f5=Rs&&"TextEvent"in window&&!Fc,Wb=Rs&&(!iw||Fc&&8<Fc&&11>=Fc),qS=" ",GS=!1;function Kb(t,e){switch(t){case"keyup":return d5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ku=!1;function g5(t,e){switch(t){case"compositionend":return Qb(e);case"keypress":return e.which!==32?null:(GS=!0,qS);case"textInput":return t=e.data,t===qS&&GS?null:t;default:return null}}function p5(t,e){if(ku)return t==="compositionend"||!iw&&Kb(t,e)?(t=Gb(),Nf=tw=oo=null,ku=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wb&&e.locale!=="ko"?null:e.data;default:return null}}var m5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!m5[t.type]:e==="textarea"}function Yb(t,e,n,r){bb(r),e=pg(e,"onChange"),0<e.length&&(n=new nw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bc=null,ch=null;function _5(t){aA(t,0)}function Pp(t){var e=Ou(t);if(wb(e))return t}function v5(t,e){if(t==="change")return e}var Xb=!1;if(Rs){var u_;if(Rs){var l_="oninput"in document;if(!l_){var KS=document.createElement("div");KS.setAttribute("oninput","return;"),l_=typeof KS.oninput=="function"}u_=l_}else u_=!1;Xb=u_&&(!document.documentMode||9<document.documentMode)}function QS(){Bc&&(Bc.detachEvent("onpropertychange",Jb),ch=Bc=null)}function Jb(t){if(t.propertyName==="value"&&Pp(ch)){var e=[];Yb(e,ch,t,Y0(t)),kb(_5,e)}}function y5(t,e,n){t==="focusin"?(QS(),Bc=e,ch=n,Bc.attachEvent("onpropertychange",Jb)):t==="focusout"&&QS()}function w5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pp(ch)}function E5(t,e){if(t==="click")return Pp(e)}function I5(t,e){if(t==="input"||t==="change")return Pp(e)}function S5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bi=typeof Object.is=="function"?Object.is:S5;function hh(t,e){if(bi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Pv.call(e,i)||!bi(t[i],e[i]))return!1}return!0}function YS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function XS(t,e){var n=YS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=YS(n)}}function Zb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Zb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eA(){for(var t=window,e=ug();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ug(t.document)}return e}function sw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function T5(t){var e=eA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Zb(n.ownerDocument.documentElement,n)){if(r!==null&&sw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=XS(n,s);var a=XS(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var x5=Rs&&"documentMode"in document&&11>=document.documentMode,Nu=null,Kv=null,Uc=null,Qv=!1;function JS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qv||Nu==null||Nu!==ug(r)||(r=Nu,"selectionStart"in r&&sw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Uc&&hh(Uc,r)||(Uc=r,r=pg(Kv,"onSelect"),0<r.length&&(e=new nw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Nu)))}function nf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Du={animationend:nf("Animation","AnimationEnd"),animationiteration:nf("Animation","AnimationIteration"),animationstart:nf("Animation","AnimationStart"),transitionend:nf("Transition","TransitionEnd")},c_={},tA={};Rs&&(tA=document.createElement("div").style,"AnimationEvent"in window||(delete Du.animationend.animation,delete Du.animationiteration.animation,delete Du.animationstart.animation),"TransitionEvent"in window||delete Du.transitionend.transition);function Rp(t){if(c_[t])return c_[t];if(!Du[t])return t;var e=Du[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in tA)return c_[t]=e[n];return t}var nA=Rp("animationend"),rA=Rp("animationiteration"),iA=Rp("animationstart"),sA=Rp("transitionend"),oA=new Map,ZS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jo(t,e){oA.set(t,e),Za(e,[t])}for(var h_=0;h_<ZS.length;h_++){var d_=ZS[h_],C5=d_.toLowerCase(),b5=d_[0].toUpperCase()+d_.slice(1);jo(C5,"on"+b5)}jo(nA,"onAnimationEnd");jo(rA,"onAnimationIteration");jo(iA,"onAnimationStart");jo("dblclick","onDoubleClick");jo("focusin","onFocus");jo("focusout","onBlur");jo(sA,"onTransitionEnd");ul("onMouseEnter",["mouseout","mouseover"]);ul("onMouseLeave",["mouseout","mouseover"]);ul("onPointerEnter",["pointerout","pointerover"]);ul("onPointerLeave",["pointerout","pointerover"]);Za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Za("onBeforeInput",["compositionend","keypress","textInput","paste"]);Za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),A5=new Set("cancel close invalid load scroll toggle".split(" ").concat(xc));function eT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,CF(r,e,void 0,t),t.currentTarget=null}function aA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],h=l.instance,g=l.currentTarget;if(l=l.listener,h!==s&&i.isPropagationStopped())break e;eT(i,l,g),s=h}else for(a=0;a<r.length;a++){if(l=r[a],h=l.instance,g=l.currentTarget,l=l.listener,h!==s&&i.isPropagationStopped())break e;eT(i,l,g),s=h}}}if(cg)throw t=Hv,cg=!1,Hv=null,t}function Vt(t,e){var n=e[ey];n===void 0&&(n=e[ey]=new Set);var r=t+"__bubble";n.has(r)||(uA(e,t,2,!1),n.add(r))}function f_(t,e,n){var r=0;e&&(r|=4),uA(n,t,r,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function dh(t){if(!t[rf]){t[rf]=!0,pb.forEach(function(n){n!=="selectionchange"&&(A5.has(n)||f_(n,!1,t),f_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[rf]||(e[rf]=!0,f_("selectionchange",!1,e))}}function uA(t,e,n,r){switch(qb(e)){case 1:var i=zF;break;case 4:i=$F;break;default:i=ew}n=i.bind(null,e,n,t),i=void 0,!$v||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function g_(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var h=a.tag;if((h===3||h===4)&&(h=a.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;a=a.return}for(;l!==null;){if(a=pa(l),a===null)return;if(h=a.tag,h===5||h===6){r=s=a;continue e}l=l.parentNode}}r=r.return}kb(function(){var g=s,m=Y0(n),v=[];e:{var I=oA.get(t);if(I!==void 0){var S=nw,j=t;switch(t){case"keypress":if(Df(n)===0)break e;case"keydown":case"keyup":S=i5;break;case"focusin":j="focus",S=a_;break;case"focusout":j="blur",S=a_;break;case"beforeblur":case"afterblur":S=a_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=zS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=GF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=a5;break;case nA:case rA:case iA:S=QF;break;case sA:S=l5;break;case"scroll":S=HF;break;case"wheel":S=h5;break;case"copy":case"cut":case"paste":S=XF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=HS}var z=(e&4)!==0,J=!z&&t==="scroll",V=z?I!==null?I+"Capture":null:I;z=[];for(var B=g,U;B!==null;){U=B;var Z=U.stateNode;if(U.tag===5&&Z!==null&&(U=Z,V!==null&&(Z=oh(B,V),Z!=null&&z.push(fh(B,Z,U)))),J)break;B=B.return}0<z.length&&(I=new S(I,j,null,n,m),v.push({event:I,listeners:z}))}}if(!(e&7)){e:{if(I=t==="mouseover"||t==="pointerover",S=t==="mouseout"||t==="pointerout",I&&n!==jv&&(j=n.relatedTarget||n.fromElement)&&(pa(j)||j[ks]))break e;if((S||I)&&(I=m.window===m?m:(I=m.ownerDocument)?I.defaultView||I.parentWindow:window,S?(j=n.relatedTarget||n.toElement,S=g,j=j?pa(j):null,j!==null&&(J=eu(j),j!==J||j.tag!==5&&j.tag!==6)&&(j=null)):(S=null,j=g),S!==j)){if(z=zS,Z="onMouseLeave",V="onMouseEnter",B="mouse",(t==="pointerout"||t==="pointerover")&&(z=HS,Z="onPointerLeave",V="onPointerEnter",B="pointer"),J=S==null?I:Ou(S),U=j==null?I:Ou(j),I=new z(Z,B+"leave",S,n,m),I.target=J,I.relatedTarget=U,Z=null,pa(m)===g&&(z=new z(V,B+"enter",j,n,m),z.target=U,z.relatedTarget=J,Z=z),J=Z,S&&j)t:{for(z=S,V=j,B=0,U=z;U;U=du(U))B++;for(U=0,Z=V;Z;Z=du(Z))U++;for(;0<B-U;)z=du(z),B--;for(;0<U-B;)V=du(V),U--;for(;B--;){if(z===V||V!==null&&z===V.alternate)break t;z=du(z),V=du(V)}z=null}else z=null;S!==null&&tT(v,I,S,z,!1),j!==null&&J!==null&&tT(v,J,j,z,!0)}}e:{if(I=g?Ou(g):window,S=I.nodeName&&I.nodeName.toLowerCase(),S==="select"||S==="input"&&I.type==="file")var ne=v5;else if(WS(I))if(Xb)ne=I5;else{ne=w5;var te=y5}else(S=I.nodeName)&&S.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(ne=E5);if(ne&&(ne=ne(t,g))){Yb(v,ne,n,m);break e}te&&te(t,I,g),t==="focusout"&&(te=I._wrapperState)&&te.controlled&&I.type==="number"&&Lv(I,"number",I.value)}switch(te=g?Ou(g):window,t){case"focusin":(WS(te)||te.contentEditable==="true")&&(Nu=te,Kv=g,Uc=null);break;case"focusout":Uc=Kv=Nu=null;break;case"mousedown":Qv=!0;break;case"contextmenu":case"mouseup":case"dragend":Qv=!1,JS(v,n,m);break;case"selectionchange":if(x5)break;case"keydown":case"keyup":JS(v,n,m)}var oe;if(iw)e:{switch(t){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else ku?Kb(t,n)&&(ce="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ce="onCompositionStart");ce&&(Wb&&n.locale!=="ko"&&(ku||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&ku&&(oe=Gb()):(oo=m,tw="value"in oo?oo.value:oo.textContent,ku=!0)),te=pg(g,ce),0<te.length&&(ce=new $S(ce,t,null,n,m),v.push({event:ce,listeners:te}),oe?ce.data=oe:(oe=Qb(n),oe!==null&&(ce.data=oe)))),(oe=f5?g5(t,n):p5(t,n))&&(g=pg(g,"onBeforeInput"),0<g.length&&(m=new $S("onBeforeInput","beforeinput",null,n,m),v.push({event:m,listeners:g}),m.data=oe))}aA(v,e)})}function fh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pg(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=oh(t,n),s!=null&&r.unshift(fh(t,s,i)),s=oh(t,e),s!=null&&r.push(fh(t,s,i))),t=t.return}return r}function du(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tT(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var l=n,h=l.alternate,g=l.stateNode;if(h!==null&&h===r)break;l.tag===5&&g!==null&&(l=g,i?(h=oh(n,s),h!=null&&a.unshift(fh(n,h,l))):i||(h=oh(n,s),h!=null&&a.push(fh(n,h,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var P5=/\r\n?/g,R5=/\u0000|\uFFFD/g;function nT(t){return(typeof t=="string"?t:""+t).replace(P5,`
`).replace(R5,"")}function sf(t,e,n){if(e=nT(e),nT(t)!==e&&n)throw Error(we(425))}function mg(){}var Yv=null,Xv=null;function Jv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zv=typeof setTimeout=="function"?setTimeout:void 0,k5=typeof clearTimeout=="function"?clearTimeout:void 0,rT=typeof Promise=="function"?Promise:void 0,N5=typeof queueMicrotask=="function"?queueMicrotask:typeof rT<"u"?function(t){return rT.resolve(null).then(t).catch(D5)}:Zv;function D5(t){setTimeout(function(){throw t})}function p_(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),lh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);lh(e)}function _o(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function iT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ml=Math.random().toString(36).slice(2),Ui="__reactFiber$"+Ml,gh="__reactProps$"+Ml,ks="__reactContainer$"+Ml,ey="__reactEvents$"+Ml,O5="__reactListeners$"+Ml,M5="__reactHandles$"+Ml;function pa(t){var e=t[Ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ks]||n[Ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=iT(t);t!==null;){if(n=t[Ui])return n;t=iT(t)}return e}t=n,n=t.parentNode}return null}function sd(t){return t=t[Ui]||t[ks],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ou(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(we(33))}function kp(t){return t[gh]||null}var ty=[],Mu=-1;function zo(t){return{current:t}}function jt(t){0>Mu||(t.current=ty[Mu],ty[Mu]=null,Mu--)}function Mt(t,e){Mu++,ty[Mu]=t.current,t.current=e}var bo={},rr=zo(bo),Nr=zo(!1),Na=bo;function ll(t,e){var n=t.type.contextTypes;if(!n)return bo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Dr(t){return t=t.childContextTypes,t!=null}function _g(){jt(Nr),jt(rr)}function sT(t,e,n){if(rr.current!==bo)throw Error(we(168));Mt(rr,e),Mt(Nr,n)}function lA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(we(108,yF(t)||"Unknown",i));return Jt({},n,r)}function vg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bo,Na=rr.current,Mt(rr,t),Mt(Nr,Nr.current),!0}function oT(t,e,n){var r=t.stateNode;if(!r)throw Error(we(169));n?(t=lA(t,e,Na),r.__reactInternalMemoizedMergedChildContext=t,jt(Nr),jt(rr),Mt(rr,t)):jt(Nr),Mt(Nr,n)}var ms=null,Np=!1,m_=!1;function cA(t){ms===null?ms=[t]:ms.push(t)}function L5(t){Np=!0,cA(t)}function $o(){if(!m_&&ms!==null){m_=!0;var t=0,e=Tt;try{var n=ms;for(Tt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ms=null,Np=!1}catch(i){throw ms!==null&&(ms=ms.slice(t+1)),Mb(X0,$o),i}finally{Tt=e,m_=!1}}return null}var Lu=[],Vu=0,yg=null,wg=0,ei=[],ti=0,Da=null,ws=1,Es="";function sa(t,e){Lu[Vu++]=wg,Lu[Vu++]=yg,yg=t,wg=e}function hA(t,e,n){ei[ti++]=ws,ei[ti++]=Es,ei[ti++]=Da,Da=t;var r=ws;t=Es;var i=32-Ti(r)-1;r&=~(1<<i),n+=1;var s=32-Ti(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,ws=1<<32-Ti(e)+i|n<<i|r,Es=s+t}else ws=1<<s|n<<i|r,Es=t}function ow(t){t.return!==null&&(sa(t,1),hA(t,1,0))}function aw(t){for(;t===yg;)yg=Lu[--Vu],Lu[Vu]=null,wg=Lu[--Vu],Lu[Vu]=null;for(;t===Da;)Da=ei[--ti],ei[ti]=null,Es=ei[--ti],ei[ti]=null,ws=ei[--ti],ei[ti]=null}var Hr=null,zr=null,qt=!1,yi=null;function dA(t,e){var n=ri(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function aT(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Hr=t,zr=_o(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Hr=t,zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Da!==null?{id:ws,overflow:Es}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ri(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Hr=t,zr=null,!0):!1;default:return!1}}function ny(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ry(t){if(qt){var e=zr;if(e){var n=e;if(!aT(t,e)){if(ny(t))throw Error(we(418));e=_o(n.nextSibling);var r=Hr;e&&aT(t,e)?dA(r,n):(t.flags=t.flags&-4097|2,qt=!1,Hr=t)}}else{if(ny(t))throw Error(we(418));t.flags=t.flags&-4097|2,qt=!1,Hr=t}}}function uT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Hr=t}function of(t){if(t!==Hr)return!1;if(!qt)return uT(t),qt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jv(t.type,t.memoizedProps)),e&&(e=zr)){if(ny(t))throw fA(),Error(we(418));for(;e;)dA(t,e),e=_o(e.nextSibling)}if(uT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(we(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){zr=_o(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}zr=null}}else zr=Hr?_o(t.stateNode.nextSibling):null;return!0}function fA(){for(var t=zr;t;)t=_o(t.nextSibling)}function cl(){zr=Hr=null,qt=!1}function uw(t){yi===null?yi=[t]:yi.push(t)}var V5=Fs.ReactCurrentBatchConfig;function _i(t,e){if(t&&t.defaultProps){e=Jt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Eg=zo(null),Ig=null,Fu=null,lw=null;function cw(){lw=Fu=Ig=null}function hw(t){var e=Eg.current;jt(Eg),t._currentValue=e}function iy(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qu(t,e){Ig=t,lw=Fu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(br=!0),t.firstContext=null)}function oi(t){var e=t._currentValue;if(lw!==t)if(t={context:t,memoizedValue:e,next:null},Fu===null){if(Ig===null)throw Error(we(308));Fu=t,Ig.dependencies={lanes:0,firstContext:t}}else Fu=Fu.next=t;return e}var ma=null;function dw(t){ma===null?ma=[t]:ma.push(t)}function gA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,dw(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ns(t,r)}function Ns(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zs=!1;function fw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function bs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,_t&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ns(t,n)}return i=r.interleaved,i===null?(e.next=e,dw(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ns(t,n)}function Of(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,J0(t,n)}}function lT(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sg(t,e,n,r){var i=t.updateQueue;Zs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var h=l,g=h.next;h.next=null,a===null?s=g:a.next=g,a=h;var m=t.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==a&&(l===null?m.firstBaseUpdate=g:l.next=g,m.lastBaseUpdate=h))}if(s!==null){var v=i.baseState;a=0,m=g=h=null,l=s;do{var I=l.lane,S=l.eventTime;if((r&I)===I){m!==null&&(m=m.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var j=t,z=l;switch(I=e,S=n,z.tag){case 1:if(j=z.payload,typeof j=="function"){v=j.call(S,v,I);break e}v=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=z.payload,I=typeof j=="function"?j.call(S,v,I):j,I==null)break e;v=Jt({},v,I);break e;case 2:Zs=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,I=i.effects,I===null?i.effects=[l]:I.push(l))}else S={eventTime:S,lane:I,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(g=m=S,h=v):m=m.next=S,a|=I;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;I=l,l=I.next,I.next=null,i.lastBaseUpdate=I,i.shared.pending=null}}while(!0);if(m===null&&(h=v),i.baseState=h,i.firstBaseUpdate=g,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ma|=a,t.lanes=a,t.memoizedState=v}}function cT(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(we(191,i));i.call(r)}}}var mA=new gb.Component().refs;function sy(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Jt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dp={isMounted:function(t){return(t=t._reactInternals)?eu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fr(),i=wo(t),s=bs(r,i);s.payload=e,n!=null&&(s.callback=n),e=vo(t,s,i),e!==null&&(xi(e,t,i,r),Of(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fr(),i=wo(t),s=bs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=vo(t,s,i),e!==null&&(xi(e,t,i,r),Of(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fr(),r=wo(t),i=bs(n,r);i.tag=2,e!=null&&(i.callback=e),e=vo(t,i,r),e!==null&&(xi(e,t,r,n),Of(e,t,r))}};function hT(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!hh(n,r)||!hh(i,s):!0}function _A(t,e,n){var r=!1,i=bo,s=e.contextType;return typeof s=="object"&&s!==null?s=oi(s):(i=Dr(e)?Na:rr.current,r=e.contextTypes,s=(r=r!=null)?ll(t,i):bo),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function dT(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dp.enqueueReplaceState(e,e.state,null)}function oy(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=mA,fw(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=oi(s):(s=Dr(e)?Na:rr.current,i.context=ll(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(sy(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dp.enqueueReplaceState(i,i.state,null),Sg(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ic(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(we(309));var r=n.stateNode}if(!r)throw Error(we(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=i.refs;l===mA&&(l=i.refs={}),a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(we(284));if(!n._owner)throw Error(we(290,t))}return t}function af(t,e){throw t=Object.prototype.toString.call(e),Error(we(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fT(t){var e=t._init;return e(t._payload)}function vA(t){function e(V,B){if(t){var U=V.deletions;U===null?(V.deletions=[B],V.flags|=16):U.push(B)}}function n(V,B){if(!t)return null;for(;B!==null;)e(V,B),B=B.sibling;return null}function r(V,B){for(V=new Map;B!==null;)B.key!==null?V.set(B.key,B):V.set(B.index,B),B=B.sibling;return V}function i(V,B){return V=Eo(V,B),V.index=0,V.sibling=null,V}function s(V,B,U){return V.index=U,t?(U=V.alternate,U!==null?(U=U.index,U<B?(V.flags|=2,B):U):(V.flags|=2,B)):(V.flags|=1048576,B)}function a(V){return t&&V.alternate===null&&(V.flags|=2),V}function l(V,B,U,Z){return B===null||B.tag!==6?(B=S_(U,V.mode,Z),B.return=V,B):(B=i(B,U),B.return=V,B)}function h(V,B,U,Z){var ne=U.type;return ne===Ru?m(V,B,U.props.children,Z,U.key):B!==null&&(B.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===Js&&fT(ne)===B.type)?(Z=i(B,U.props),Z.ref=ic(V,B,U),Z.return=V,Z):(Z=Uf(U.type,U.key,U.props,null,V.mode,Z),Z.ref=ic(V,B,U),Z.return=V,Z)}function g(V,B,U,Z){return B===null||B.tag!==4||B.stateNode.containerInfo!==U.containerInfo||B.stateNode.implementation!==U.implementation?(B=T_(U,V.mode,Z),B.return=V,B):(B=i(B,U.children||[]),B.return=V,B)}function m(V,B,U,Z,ne){return B===null||B.tag!==7?(B=xa(U,V.mode,Z,ne),B.return=V,B):(B=i(B,U),B.return=V,B)}function v(V,B,U){if(typeof B=="string"&&B!==""||typeof B=="number")return B=S_(""+B,V.mode,U),B.return=V,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Qd:return U=Uf(B.type,B.key,B.props,null,V.mode,U),U.ref=ic(V,null,B),U.return=V,U;case Pu:return B=T_(B,V.mode,U),B.return=V,B;case Js:var Z=B._init;return v(V,Z(B._payload),U)}if(Sc(B)||Zl(B))return B=xa(B,V.mode,U,null),B.return=V,B;af(V,B)}return null}function I(V,B,U,Z){var ne=B!==null?B.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return ne!==null?null:l(V,B,""+U,Z);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Qd:return U.key===ne?h(V,B,U,Z):null;case Pu:return U.key===ne?g(V,B,U,Z):null;case Js:return ne=U._init,I(V,B,ne(U._payload),Z)}if(Sc(U)||Zl(U))return ne!==null?null:m(V,B,U,Z,null);af(V,U)}return null}function S(V,B,U,Z,ne){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return V=V.get(U)||null,l(B,V,""+Z,ne);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case Qd:return V=V.get(Z.key===null?U:Z.key)||null,h(B,V,Z,ne);case Pu:return V=V.get(Z.key===null?U:Z.key)||null,g(B,V,Z,ne);case Js:var te=Z._init;return S(V,B,U,te(Z._payload),ne)}if(Sc(Z)||Zl(Z))return V=V.get(U)||null,m(B,V,Z,ne,null);af(B,Z)}return null}function j(V,B,U,Z){for(var ne=null,te=null,oe=B,ce=B=0,_e=null;oe!==null&&ce<U.length;ce++){oe.index>ce?(_e=oe,oe=null):_e=oe.sibling;var pe=I(V,oe,U[ce],Z);if(pe===null){oe===null&&(oe=_e);break}t&&oe&&pe.alternate===null&&e(V,oe),B=s(pe,B,ce),te===null?ne=pe:te.sibling=pe,te=pe,oe=_e}if(ce===U.length)return n(V,oe),qt&&sa(V,ce),ne;if(oe===null){for(;ce<U.length;ce++)oe=v(V,U[ce],Z),oe!==null&&(B=s(oe,B,ce),te===null?ne=oe:te.sibling=oe,te=oe);return qt&&sa(V,ce),ne}for(oe=r(V,oe);ce<U.length;ce++)_e=S(oe,V,ce,U[ce],Z),_e!==null&&(t&&_e.alternate!==null&&oe.delete(_e.key===null?ce:_e.key),B=s(_e,B,ce),te===null?ne=_e:te.sibling=_e,te=_e);return t&&oe.forEach(function(Ye){return e(V,Ye)}),qt&&sa(V,ce),ne}function z(V,B,U,Z){var ne=Zl(U);if(typeof ne!="function")throw Error(we(150));if(U=ne.call(U),U==null)throw Error(we(151));for(var te=ne=null,oe=B,ce=B=0,_e=null,pe=U.next();oe!==null&&!pe.done;ce++,pe=U.next()){oe.index>ce?(_e=oe,oe=null):_e=oe.sibling;var Ye=I(V,oe,pe.value,Z);if(Ye===null){oe===null&&(oe=_e);break}t&&oe&&Ye.alternate===null&&e(V,oe),B=s(Ye,B,ce),te===null?ne=Ye:te.sibling=Ye,te=Ye,oe=_e}if(pe.done)return n(V,oe),qt&&sa(V,ce),ne;if(oe===null){for(;!pe.done;ce++,pe=U.next())pe=v(V,pe.value,Z),pe!==null&&(B=s(pe,B,ce),te===null?ne=pe:te.sibling=pe,te=pe);return qt&&sa(V,ce),ne}for(oe=r(V,oe);!pe.done;ce++,pe=U.next())pe=S(oe,V,ce,pe.value,Z),pe!==null&&(t&&pe.alternate!==null&&oe.delete(pe.key===null?ce:pe.key),B=s(pe,B,ce),te===null?ne=pe:te.sibling=pe,te=pe);return t&&oe.forEach(function(be){return e(V,be)}),qt&&sa(V,ce),ne}function J(V,B,U,Z){if(typeof U=="object"&&U!==null&&U.type===Ru&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case Qd:e:{for(var ne=U.key,te=B;te!==null;){if(te.key===ne){if(ne=U.type,ne===Ru){if(te.tag===7){n(V,te.sibling),B=i(te,U.props.children),B.return=V,V=B;break e}}else if(te.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===Js&&fT(ne)===te.type){n(V,te.sibling),B=i(te,U.props),B.ref=ic(V,te,U),B.return=V,V=B;break e}n(V,te);break}else e(V,te);te=te.sibling}U.type===Ru?(B=xa(U.props.children,V.mode,Z,U.key),B.return=V,V=B):(Z=Uf(U.type,U.key,U.props,null,V.mode,Z),Z.ref=ic(V,B,U),Z.return=V,V=Z)}return a(V);case Pu:e:{for(te=U.key;B!==null;){if(B.key===te)if(B.tag===4&&B.stateNode.containerInfo===U.containerInfo&&B.stateNode.implementation===U.implementation){n(V,B.sibling),B=i(B,U.children||[]),B.return=V,V=B;break e}else{n(V,B);break}else e(V,B);B=B.sibling}B=T_(U,V.mode,Z),B.return=V,V=B}return a(V);case Js:return te=U._init,J(V,B,te(U._payload),Z)}if(Sc(U))return j(V,B,U,Z);if(Zl(U))return z(V,B,U,Z);af(V,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,B!==null&&B.tag===6?(n(V,B.sibling),B=i(B,U),B.return=V,V=B):(n(V,B),B=S_(U,V.mode,Z),B.return=V,V=B),a(V)):n(V,B)}return J}var hl=vA(!0),yA=vA(!1),od={},Zi=zo(od),ph=zo(od),mh=zo(od);function _a(t){if(t===od)throw Error(we(174));return t}function gw(t,e){switch(Mt(mh,e),Mt(ph,t),Mt(Zi,od),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fv(e,t)}jt(Zi),Mt(Zi,e)}function dl(){jt(Zi),jt(ph),jt(mh)}function wA(t){_a(mh.current);var e=_a(Zi.current),n=Fv(e,t.type);e!==n&&(Mt(ph,t),Mt(Zi,n))}function pw(t){ph.current===t&&(jt(Zi),jt(ph))}var Qt=zo(0);function Tg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var __=[];function mw(){for(var t=0;t<__.length;t++)__[t]._workInProgressVersionPrimary=null;__.length=0}var Mf=Fs.ReactCurrentDispatcher,v_=Fs.ReactCurrentBatchConfig,Oa=0,Yt=null,yn=null,Cn=null,xg=!1,jc=!1,_h=0,F5=0;function Yn(){throw Error(we(321))}function _w(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bi(t[n],e[n]))return!1;return!0}function vw(t,e,n,r,i,s){if(Oa=s,Yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Mf.current=t===null||t.memoizedState===null?z5:$5,t=n(r,i),jc){s=0;do{if(jc=!1,_h=0,25<=s)throw Error(we(301));s+=1,Cn=yn=null,e.updateQueue=null,Mf.current=H5,t=n(r,i)}while(jc)}if(Mf.current=Cg,e=yn!==null&&yn.next!==null,Oa=0,Cn=yn=Yt=null,xg=!1,e)throw Error(we(300));return t}function yw(){var t=_h!==0;return _h=0,t}function Mi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Yt.memoizedState=Cn=t:Cn=Cn.next=t,Cn}function ai(){if(yn===null){var t=Yt.alternate;t=t!==null?t.memoizedState:null}else t=yn.next;var e=Cn===null?Yt.memoizedState:Cn.next;if(e!==null)Cn=e,yn=t;else{if(t===null)throw Error(we(310));yn=t,t={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},Cn===null?Yt.memoizedState=Cn=t:Cn=Cn.next=t}return Cn}function vh(t,e){return typeof e=="function"?e(t):e}function y_(t){var e=ai(),n=e.queue;if(n===null)throw Error(we(311));n.lastRenderedReducer=t;var r=yn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,h=null,g=s;do{var m=g.lane;if((Oa&m)===m)h!==null&&(h=h.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),r=g.hasEagerState?g.eagerState:t(r,g.action);else{var v={lane:m,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};h===null?(l=h=v,a=r):h=h.next=v,Yt.lanes|=m,Ma|=m}g=g.next}while(g!==null&&g!==s);h===null?a=r:h.next=l,bi(r,e.memoizedState)||(br=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=h,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Yt.lanes|=s,Ma|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function w_(t){var e=ai(),n=e.queue;if(n===null)throw Error(we(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);bi(s,e.memoizedState)||(br=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function EA(){}function IA(t,e){var n=Yt,r=ai(),i=e(),s=!bi(r.memoizedState,i);if(s&&(r.memoizedState=i,br=!0),r=r.queue,ww(xA.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Cn!==null&&Cn.memoizedState.tag&1){if(n.flags|=2048,yh(9,TA.bind(null,n,r,i,e),void 0,null),An===null)throw Error(we(349));Oa&30||SA(n,e,i)}return i}function SA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function TA(t,e,n,r){e.value=n,e.getSnapshot=r,CA(e)&&bA(t)}function xA(t,e,n){return n(function(){CA(e)&&bA(t)})}function CA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bi(t,n)}catch{return!0}}function bA(t){var e=Ns(t,1);e!==null&&xi(e,t,1,-1)}function gT(t){var e=Mi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vh,lastRenderedState:t},e.queue=t,t=t.dispatch=j5.bind(null,Yt,t),[e.memoizedState,t]}function yh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AA(){return ai().memoizedState}function Lf(t,e,n,r){var i=Mi();Yt.flags|=t,i.memoizedState=yh(1|e,n,void 0,r===void 0?null:r)}function Op(t,e,n,r){var i=ai();r=r===void 0?null:r;var s=void 0;if(yn!==null){var a=yn.memoizedState;if(s=a.destroy,r!==null&&_w(r,a.deps)){i.memoizedState=yh(e,n,s,r);return}}Yt.flags|=t,i.memoizedState=yh(1|e,n,s,r)}function pT(t,e){return Lf(8390656,8,t,e)}function ww(t,e){return Op(2048,8,t,e)}function PA(t,e){return Op(4,2,t,e)}function RA(t,e){return Op(4,4,t,e)}function kA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function NA(t,e,n){return n=n!=null?n.concat([t]):null,Op(4,4,kA.bind(null,e,t),n)}function Ew(){}function DA(t,e){var n=ai();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_w(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function OA(t,e){var n=ai();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_w(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function MA(t,e,n){return Oa&21?(bi(n,e)||(n=Fb(),Yt.lanes|=n,Ma|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,br=!0),t.memoizedState=n)}function B5(t,e){var n=Tt;Tt=n!==0&&4>n?n:4,t(!0);var r=v_.transition;v_.transition={};try{t(!1),e()}finally{Tt=n,v_.transition=r}}function LA(){return ai().memoizedState}function U5(t,e,n){var r=wo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},VA(t))FA(e,n);else if(n=gA(t,e,n,r),n!==null){var i=fr();xi(n,t,r,i),BA(n,e,r)}}function j5(t,e,n){var r=wo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(VA(t))FA(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,n);if(i.hasEagerState=!0,i.eagerState=l,bi(l,a)){var h=e.interleaved;h===null?(i.next=i,dw(e)):(i.next=h.next,h.next=i),e.interleaved=i;return}}catch{}finally{}n=gA(t,e,i,r),n!==null&&(i=fr(),xi(n,t,r,i),BA(n,e,r))}}function VA(t){var e=t.alternate;return t===Yt||e!==null&&e===Yt}function FA(t,e){jc=xg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BA(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,J0(t,n)}}var Cg={readContext:oi,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useInsertionEffect:Yn,useLayoutEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useMutableSource:Yn,useSyncExternalStore:Yn,useId:Yn,unstable_isNewReconciler:!1},z5={readContext:oi,useCallback:function(t,e){return Mi().memoizedState=[t,e===void 0?null:e],t},useContext:oi,useEffect:pT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lf(4194308,4,kA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lf(4,2,t,e)},useMemo:function(t,e){var n=Mi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Mi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=U5.bind(null,Yt,t),[r.memoizedState,t]},useRef:function(t){var e=Mi();return t={current:t},e.memoizedState=t},useState:gT,useDebugValue:Ew,useDeferredValue:function(t){return Mi().memoizedState=t},useTransition:function(){var t=gT(!1),e=t[0];return t=B5.bind(null,t[1]),Mi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Yt,i=Mi();if(qt){if(n===void 0)throw Error(we(407));n=n()}else{if(n=e(),An===null)throw Error(we(349));Oa&30||SA(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,pT(xA.bind(null,r,s,t),[t]),r.flags|=2048,yh(9,TA.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Mi(),e=An.identifierPrefix;if(qt){var n=Es,r=ws;n=(r&~(1<<32-Ti(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=_h++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=F5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$5={readContext:oi,useCallback:DA,useContext:oi,useEffect:ww,useImperativeHandle:NA,useInsertionEffect:PA,useLayoutEffect:RA,useMemo:OA,useReducer:y_,useRef:AA,useState:function(){return y_(vh)},useDebugValue:Ew,useDeferredValue:function(t){var e=ai();return MA(e,yn.memoizedState,t)},useTransition:function(){var t=y_(vh)[0],e=ai().memoizedState;return[t,e]},useMutableSource:EA,useSyncExternalStore:IA,useId:LA,unstable_isNewReconciler:!1},H5={readContext:oi,useCallback:DA,useContext:oi,useEffect:ww,useImperativeHandle:NA,useInsertionEffect:PA,useLayoutEffect:RA,useMemo:OA,useReducer:w_,useRef:AA,useState:function(){return w_(vh)},useDebugValue:Ew,useDeferredValue:function(t){var e=ai();return yn===null?e.memoizedState=t:MA(e,yn.memoizedState,t)},useTransition:function(){var t=w_(vh)[0],e=ai().memoizedState;return[t,e]},useMutableSource:EA,useSyncExternalStore:IA,useId:LA,unstable_isNewReconciler:!1};function fl(t,e){try{var n="",r=e;do n+=vF(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function E_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ay(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var q5=typeof WeakMap=="function"?WeakMap:Map;function UA(t,e,n){n=bs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ag||(Ag=!0,_y=r),ay(t,e)},n}function jA(t,e,n){n=bs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ay(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ay(t,e),typeof r!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function mT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new q5;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=s4.bind(null,t,e,n),e.then(t,t))}function _T(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vT(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=bs(-1,1),e.tag=2,vo(n,e,1))),n.lanes|=1),t)}var G5=Fs.ReactCurrentOwner,br=!1;function ar(t,e,n,r){e.child=t===null?yA(e,null,n,r):hl(e,t.child,n,r)}function yT(t,e,n,r,i){n=n.render;var s=e.ref;return Qu(e,i),r=vw(t,e,n,r,s,i),n=yw(),t!==null&&!br?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ds(t,e,i)):(qt&&n&&ow(e),e.flags|=1,ar(t,e,r,i),e.child)}function wT(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Pw(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,zA(t,e,s,r,i)):(t=Uf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:hh,n(a,r)&&t.ref===e.ref)return Ds(t,e,i)}return e.flags|=1,t=Eo(s,r),t.ref=e.ref,t.return=e,e.child=t}function zA(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(hh(s,r)&&t.ref===e.ref)if(br=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(br=!0);else return e.lanes=t.lanes,Ds(t,e,i)}return uy(t,e,n,r,i)}function $A(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mt(Uu,Vr),Vr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mt(Uu,Vr),Vr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Mt(Uu,Vr),Vr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Mt(Uu,Vr),Vr|=r;return ar(t,e,i,n),e.child}function HA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function uy(t,e,n,r,i){var s=Dr(n)?Na:rr.current;return s=ll(e,s),Qu(e,i),n=vw(t,e,n,r,s,i),r=yw(),t!==null&&!br?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ds(t,e,i)):(qt&&r&&ow(e),e.flags|=1,ar(t,e,n,i),e.child)}function ET(t,e,n,r,i){if(Dr(n)){var s=!0;vg(e)}else s=!1;if(Qu(e,i),e.stateNode===null)Vf(t,e),_A(e,n,r),oy(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var h=a.context,g=n.contextType;typeof g=="object"&&g!==null?g=oi(g):(g=Dr(n)?Na:rr.current,g=ll(e,g));var m=n.getDerivedStateFromProps,v=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||h!==g)&&dT(e,a,r,g),Zs=!1;var I=e.memoizedState;a.state=I,Sg(e,r,a,i),h=e.memoizedState,l!==r||I!==h||Nr.current||Zs?(typeof m=="function"&&(sy(e,n,m,r),h=e.memoizedState),(l=Zs||hT(e,n,l,r,I,h,g))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=g,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,pA(t,e),l=e.memoizedProps,g=e.type===e.elementType?l:_i(e.type,l),a.props=g,v=e.pendingProps,I=a.context,h=n.contextType,typeof h=="object"&&h!==null?h=oi(h):(h=Dr(n)?Na:rr.current,h=ll(e,h));var S=n.getDerivedStateFromProps;(m=typeof S=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==v||I!==h)&&dT(e,a,r,h),Zs=!1,I=e.memoizedState,a.state=I,Sg(e,r,a,i);var j=e.memoizedState;l!==v||I!==j||Nr.current||Zs?(typeof S=="function"&&(sy(e,n,S,r),j=e.memoizedState),(g=Zs||hT(e,n,g,r,I,j,h)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,j,h),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,j,h)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=j),a.props=r,a.state=j,a.context=h,r=g):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),r=!1)}return ly(t,e,n,r,s,i)}function ly(t,e,n,r,i,s){HA(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&oT(e,n,!1),Ds(t,e,s);r=e.stateNode,G5.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=hl(e,t.child,null,s),e.child=hl(e,null,l,s)):ar(t,e,l,s),e.memoizedState=r.state,i&&oT(e,n,!0),e.child}function qA(t){var e=t.stateNode;e.pendingContext?sT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sT(t,e.context,!1),gw(t,e.containerInfo)}function IT(t,e,n,r,i){return cl(),uw(i),e.flags|=256,ar(t,e,n,r),e.child}var cy={dehydrated:null,treeContext:null,retryLane:0};function hy(t){return{baseLanes:t,cachePool:null,transitions:null}}function GA(t,e,n){var r=e.pendingProps,i=Qt.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Mt(Qt,i&1),t===null)return ry(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Vp(a,r,0,null),t=xa(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=hy(n),e.memoizedState=cy,t):Iw(e,a));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return W5(t,e,a,r,l,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,l=i.sibling;var h={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=Eo(i,h),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Eo(l,s):(s=xa(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?hy(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=cy,r}return s=t.child,t=s.sibling,r=Eo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Iw(t,e){return e=Vp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function uf(t,e,n,r){return r!==null&&uw(r),hl(e,t.child,null,n),t=Iw(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function W5(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=E_(Error(we(422))),uf(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Vp({mode:"visible",children:r.children},i,0,null),s=xa(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&hl(e,t.child,null,a),e.child.memoizedState=hy(a),e.memoizedState=cy,s);if(!(e.mode&1))return uf(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(we(419)),r=E_(s,r,void 0),uf(t,e,a,r)}if(l=(a&t.childLanes)!==0,br||l){if(r=An,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ns(t,i),xi(r,t,i,-1))}return Aw(),r=E_(Error(we(421))),uf(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=o4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,zr=_o(i.nextSibling),Hr=e,qt=!0,yi=null,t!==null&&(ei[ti++]=ws,ei[ti++]=Es,ei[ti++]=Da,ws=t.id,Es=t.overflow,Da=e),e=Iw(e,r.children),e.flags|=4096,e)}function ST(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),iy(t.return,e,n)}function I_(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WA(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ar(t,e,r.children,n),r=Qt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ST(t,n,e);else if(t.tag===19)ST(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Mt(Qt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Tg(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),I_(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Tg(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}I_(e,!0,n,null,s);break;case"together":I_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ds(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ma|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(we(153));if(e.child!==null){for(t=e.child,n=Eo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Eo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function K5(t,e,n){switch(e.tag){case 3:qA(e),cl();break;case 5:wA(e);break;case 1:Dr(e.type)&&vg(e);break;case 4:gw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Mt(Eg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Mt(Qt,Qt.current&1),e.flags|=128,null):n&e.child.childLanes?GA(t,e,n):(Mt(Qt,Qt.current&1),t=Ds(t,e,n),t!==null?t.sibling:null);Mt(Qt,Qt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WA(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Mt(Qt,Qt.current),r)break;return null;case 22:case 23:return e.lanes=0,$A(t,e,n)}return Ds(t,e,n)}var KA,dy,QA,YA;KA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dy=function(){};QA=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,_a(Zi.current);var s=null;switch(n){case"input":i=Ov(t,i),r=Ov(t,r),s=[];break;case"select":i=Jt({},i,{value:void 0}),r=Jt({},r,{value:void 0}),s=[];break;case"textarea":i=Vv(t,i),r=Vv(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=mg)}Bv(n,r);var a;n=null;for(g in i)if(!r.hasOwnProperty(g)&&i.hasOwnProperty(g)&&i[g]!=null)if(g==="style"){var l=i[g];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(ih.hasOwnProperty(g)?s||(s=[]):(s=s||[]).push(g,null));for(g in r){var h=r[g];if(l=i!=null?i[g]:void 0,r.hasOwnProperty(g)&&h!==l&&(h!=null||l!=null))if(g==="style")if(l){for(a in l)!l.hasOwnProperty(a)||h&&h.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in h)h.hasOwnProperty(a)&&l[a]!==h[a]&&(n||(n={}),n[a]=h[a])}else n||(s||(s=[]),s.push(g,n)),n=h;else g==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,l=l?l.__html:void 0,h!=null&&l!==h&&(s=s||[]).push(g,h)):g==="children"?typeof h!="string"&&typeof h!="number"||(s=s||[]).push(g,""+h):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(ih.hasOwnProperty(g)?(h!=null&&g==="onScroll"&&Vt("scroll",t),s||l===h||(s=[])):(s=s||[]).push(g,h))}n&&(s=s||[]).push("style",n);var g=s;(e.updateQueue=g)&&(e.flags|=4)}};YA=function(t,e,n,r){n!==r&&(e.flags|=4)};function sc(t,e){if(!qt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Q5(t,e,n){var r=e.pendingProps;switch(aw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(e),null;case 1:return Dr(e.type)&&_g(),Xn(e),null;case 3:return r=e.stateNode,dl(),jt(Nr),jt(rr),mw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(of(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yi!==null&&(wy(yi),yi=null))),dy(t,e),Xn(e),null;case 5:pw(e);var i=_a(mh.current);if(n=e.type,t!==null&&e.stateNode!=null)QA(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(we(166));return Xn(e),null}if(t=_a(Zi.current),of(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ui]=e,r[gh]=s,t=(e.mode&1)!==0,n){case"dialog":Vt("cancel",r),Vt("close",r);break;case"iframe":case"object":case"embed":Vt("load",r);break;case"video":case"audio":for(i=0;i<xc.length;i++)Vt(xc[i],r);break;case"source":Vt("error",r);break;case"img":case"image":case"link":Vt("error",r),Vt("load",r);break;case"details":Vt("toggle",r);break;case"input":NS(r,s),Vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Vt("invalid",r);break;case"textarea":OS(r,s),Vt("invalid",r)}Bv(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&sf(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&sf(r.textContent,l,t),i=["children",""+l]):ih.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Vt("scroll",r)}switch(n){case"input":Yd(r),DS(r,s,!0);break;case"textarea":Yd(r),MS(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=mg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Sb(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Ui]=e,t[gh]=r,KA(t,e,!1,!1),e.stateNode=t;e:{switch(a=Uv(n,r),n){case"dialog":Vt("cancel",t),Vt("close",t),i=r;break;case"iframe":case"object":case"embed":Vt("load",t),i=r;break;case"video":case"audio":for(i=0;i<xc.length;i++)Vt(xc[i],t);i=r;break;case"source":Vt("error",t),i=r;break;case"img":case"image":case"link":Vt("error",t),Vt("load",t),i=r;break;case"details":Vt("toggle",t),i=r;break;case"input":NS(t,r),i=Ov(t,r),Vt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Jt({},r,{value:void 0}),Vt("invalid",t);break;case"textarea":OS(t,r),i=Vv(t,r),Vt("invalid",t);break;default:i=r}Bv(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var h=l[s];s==="style"?Cb(t,h):s==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&Tb(t,h)):s==="children"?typeof h=="string"?(n!=="textarea"||h!=="")&&sh(t,h):typeof h=="number"&&sh(t,""+h):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ih.hasOwnProperty(s)?h!=null&&s==="onScroll"&&Vt("scroll",t):h!=null&&G0(t,s,h,a))}switch(n){case"input":Yd(t),DS(t,r,!1);break;case"textarea":Yd(t),MS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Co(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?qu(t,!!r.multiple,s,!1):r.defaultValue!=null&&qu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=mg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xn(e),null;case 6:if(t&&e.stateNode!=null)YA(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(we(166));if(n=_a(mh.current),_a(Zi.current),of(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ui]=e,(s=r.nodeValue!==n)&&(t=Hr,t!==null))switch(t.tag){case 3:sf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ui]=e,e.stateNode=r}return Xn(e),null;case 13:if(jt(Qt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(qt&&zr!==null&&e.mode&1&&!(e.flags&128))fA(),cl(),e.flags|=98560,s=!1;else if(s=of(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(we(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(we(317));s[Ui]=e}else cl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xn(e),s=!1}else yi!==null&&(wy(yi),yi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Qt.current&1?wn===0&&(wn=3):Aw())),e.updateQueue!==null&&(e.flags|=4),Xn(e),null);case 4:return dl(),dy(t,e),t===null&&dh(e.stateNode.containerInfo),Xn(e),null;case 10:return hw(e.type._context),Xn(e),null;case 17:return Dr(e.type)&&_g(),Xn(e),null;case 19:if(jt(Qt),s=e.memoizedState,s===null)return Xn(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)sc(s,!1);else{if(wn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Tg(t),a!==null){for(e.flags|=128,sc(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Mt(Qt,Qt.current&1|2),e.child}t=t.sibling}s.tail!==null&&hn()>gl&&(e.flags|=128,r=!0,sc(s,!1),e.lanes=4194304)}else{if(!r)if(t=Tg(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),sc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!qt)return Xn(e),null}else 2*hn()-s.renderingStartTime>gl&&n!==1073741824&&(e.flags|=128,r=!0,sc(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=hn(),e.sibling=null,n=Qt.current,Mt(Qt,r?n&1|2:n&1),e):(Xn(e),null);case 22:case 23:return bw(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vr&1073741824&&(Xn(e),e.subtreeFlags&6&&(e.flags|=8192)):Xn(e),null;case 24:return null;case 25:return null}throw Error(we(156,e.tag))}function Y5(t,e){switch(aw(e),e.tag){case 1:return Dr(e.type)&&_g(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return dl(),jt(Nr),jt(rr),mw(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pw(e),null;case 13:if(jt(Qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(we(340));cl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return jt(Qt),null;case 4:return dl(),null;case 10:return hw(e.type._context),null;case 22:case 23:return bw(),null;case 24:return null;default:return null}}var lf=!1,Zn=!1,X5=typeof WeakSet=="function"?WeakSet:Set,Le=null;function Bu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tn(t,e,r)}else n.current=null}function fy(t,e,n){try{n()}catch(r){tn(t,e,r)}}var TT=!1;function J5(t,e){if(Yv=fg,t=eA(),sw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,h=-1,g=0,m=0,v=t,I=null;t:for(;;){for(var S;v!==n||i!==0&&v.nodeType!==3||(l=a+i),v!==s||r!==0&&v.nodeType!==3||(h=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(S=v.firstChild)!==null;)I=v,v=S;for(;;){if(v===t)break t;if(I===n&&++g===i&&(l=a),I===s&&++m===r&&(h=a),(S=v.nextSibling)!==null)break;v=I,I=v.parentNode}v=S}n=l===-1||h===-1?null:{start:l,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xv={focusedElem:t,selectionRange:n},fg=!1,Le=e;Le!==null;)if(e=Le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Le=t;else for(;Le!==null;){e=Le;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var z=j.memoizedProps,J=j.memoizedState,V=e.stateNode,B=V.getSnapshotBeforeUpdate(e.elementType===e.type?z:_i(e.type,z),J);V.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var U=e.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(Z){tn(e,e.return,Z)}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}return j=TT,TT=!1,j}function zc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&fy(e,n,s)}i=i.next}while(i!==r)}}function Mp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gy(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function XA(t){var e=t.alternate;e!==null&&(t.alternate=null,XA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ui],delete e[gh],delete e[ey],delete e[O5],delete e[M5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function JA(t){return t.tag===5||t.tag===3||t.tag===4}function xT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||JA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function py(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=mg));else if(r!==4&&(t=t.child,t!==null))for(py(t,e,n),t=t.sibling;t!==null;)py(t,e,n),t=t.sibling}function my(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(my(t,e,n),t=t.sibling;t!==null;)my(t,e,n),t=t.sibling}var Ln=null,vi=!1;function Gs(t,e,n){for(n=n.child;n!==null;)ZA(t,e,n),n=n.sibling}function ZA(t,e,n){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(bp,n)}catch{}switch(n.tag){case 5:Zn||Bu(n,e);case 6:var r=Ln,i=vi;Ln=null,Gs(t,e,n),Ln=r,vi=i,Ln!==null&&(vi?(t=Ln,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ln.removeChild(n.stateNode));break;case 18:Ln!==null&&(vi?(t=Ln,n=n.stateNode,t.nodeType===8?p_(t.parentNode,n):t.nodeType===1&&p_(t,n),lh(t)):p_(Ln,n.stateNode));break;case 4:r=Ln,i=vi,Ln=n.stateNode.containerInfo,vi=!0,Gs(t,e,n),Ln=r,vi=i;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&fy(n,e,a),i=i.next}while(i!==r)}Gs(t,e,n);break;case 1:if(!Zn&&(Bu(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){tn(n,e,l)}Gs(t,e,n);break;case 21:Gs(t,e,n);break;case 22:n.mode&1?(Zn=(r=Zn)||n.memoizedState!==null,Gs(t,e,n),Zn=r):Gs(t,e,n);break;default:Gs(t,e,n)}}function CT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new X5),e.forEach(function(r){var i=a4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function mi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Ln=l.stateNode,vi=!1;break e;case 3:Ln=l.stateNode.containerInfo,vi=!0;break e;case 4:Ln=l.stateNode.containerInfo,vi=!0;break e}l=l.return}if(Ln===null)throw Error(we(160));ZA(s,a,i),Ln=null,vi=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(g){tn(i,e,g)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)eP(e,t),e=e.sibling}function eP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(mi(e,t),Oi(t),r&4){try{zc(3,t,t.return),Mp(3,t)}catch(z){tn(t,t.return,z)}try{zc(5,t,t.return)}catch(z){tn(t,t.return,z)}}break;case 1:mi(e,t),Oi(t),r&512&&n!==null&&Bu(n,n.return);break;case 5:if(mi(e,t),Oi(t),r&512&&n!==null&&Bu(n,n.return),t.flags&32){var i=t.stateNode;try{sh(i,"")}catch(z){tn(t,t.return,z)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,l=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Eb(i,s),Uv(l,a);var g=Uv(l,s);for(a=0;a<h.length;a+=2){var m=h[a],v=h[a+1];m==="style"?Cb(i,v):m==="dangerouslySetInnerHTML"?Tb(i,v):m==="children"?sh(i,v):G0(i,m,v,g)}switch(l){case"input":Mv(i,s);break;case"textarea":Ib(i,s);break;case"select":var I=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var S=s.value;S!=null?qu(i,!!s.multiple,S,!1):I!==!!s.multiple&&(s.defaultValue!=null?qu(i,!!s.multiple,s.defaultValue,!0):qu(i,!!s.multiple,s.multiple?[]:"",!1))}i[gh]=s}catch(z){tn(t,t.return,z)}}break;case 6:if(mi(e,t),Oi(t),r&4){if(t.stateNode===null)throw Error(we(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(z){tn(t,t.return,z)}}break;case 3:if(mi(e,t),Oi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{lh(e.containerInfo)}catch(z){tn(t,t.return,z)}break;case 4:mi(e,t),Oi(t);break;case 13:mi(e,t),Oi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(xw=hn())),r&4&&CT(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(Zn=(g=Zn)||m,mi(e,t),Zn=g):mi(e,t),Oi(t),r&8192){if(g=t.memoizedState!==null,(t.stateNode.isHidden=g)&&!m&&t.mode&1)for(Le=t,m=t.child;m!==null;){for(v=Le=m;Le!==null;){switch(I=Le,S=I.child,I.tag){case 0:case 11:case 14:case 15:zc(4,I,I.return);break;case 1:Bu(I,I.return);var j=I.stateNode;if(typeof j.componentWillUnmount=="function"){r=I,n=I.return;try{e=r,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(z){tn(r,n,z)}}break;case 5:Bu(I,I.return);break;case 22:if(I.memoizedState!==null){AT(v);continue}}S!==null?(S.return=I,Le=S):AT(v)}m=m.sibling}e:for(m=null,v=t;;){if(v.tag===5){if(m===null){m=v;try{i=v.stateNode,g?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=v.stateNode,h=v.memoizedProps.style,a=h!=null&&h.hasOwnProperty("display")?h.display:null,l.style.display=xb("display",a))}catch(z){tn(t,t.return,z)}}}else if(v.tag===6){if(m===null)try{v.stateNode.nodeValue=g?"":v.memoizedProps}catch(z){tn(t,t.return,z)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;m===v&&(m=null),v=v.return}m===v&&(m=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:mi(e,t),Oi(t),r&4&&CT(t);break;case 21:break;default:mi(e,t),Oi(t)}}function Oi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(JA(n)){var r=n;break e}n=n.return}throw Error(we(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(sh(i,""),r.flags&=-33);var s=xT(t);my(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=xT(t);py(t,l,a);break;default:throw Error(we(161))}}catch(h){tn(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Z5(t,e,n){Le=t,tP(t)}function tP(t,e,n){for(var r=(t.mode&1)!==0;Le!==null;){var i=Le,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||lf;if(!a){var l=i.alternate,h=l!==null&&l.memoizedState!==null||Zn;l=lf;var g=Zn;if(lf=a,(Zn=h)&&!g)for(Le=i;Le!==null;)a=Le,h=a.child,a.tag===22&&a.memoizedState!==null?PT(i):h!==null?(h.return=a,Le=h):PT(i);for(;s!==null;)Le=s,tP(s),s=s.sibling;Le=i,lf=l,Zn=g}bT(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Le=s):bT(t)}}function bT(t){for(;Le!==null;){var e=Le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zn||Mp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:_i(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cT(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cT(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var g=e.alternate;if(g!==null){var m=g.memoizedState;if(m!==null){var v=m.dehydrated;v!==null&&lh(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}Zn||e.flags&512&&gy(e)}catch(I){tn(e,e.return,I)}}if(e===t){Le=null;break}if(n=e.sibling,n!==null){n.return=e.return,Le=n;break}Le=e.return}}function AT(t){for(;Le!==null;){var e=Le;if(e===t){Le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Le=n;break}Le=e.return}}function PT(t){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Mp(4,e)}catch(h){tn(e,n,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(h){tn(e,i,h)}}var s=e.return;try{gy(e)}catch(h){tn(e,s,h)}break;case 5:var a=e.return;try{gy(e)}catch(h){tn(e,a,h)}}}catch(h){tn(e,e.return,h)}if(e===t){Le=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Le=l;break}Le=e.return}}var e4=Math.ceil,bg=Fs.ReactCurrentDispatcher,Sw=Fs.ReactCurrentOwner,si=Fs.ReactCurrentBatchConfig,_t=0,An=null,vn=null,jn=0,Vr=0,Uu=zo(0),wn=0,wh=null,Ma=0,Lp=0,Tw=0,$c=null,Cr=null,xw=0,gl=1/0,gs=null,Ag=!1,_y=null,yo=null,cf=!1,ao=null,Pg=0,Hc=0,vy=null,Ff=-1,Bf=0;function fr(){return _t&6?hn():Ff!==-1?Ff:Ff=hn()}function wo(t){return t.mode&1?_t&2&&jn!==0?jn&-jn:V5.transition!==null?(Bf===0&&(Bf=Fb()),Bf):(t=Tt,t!==0||(t=window.event,t=t===void 0?16:qb(t.type)),t):1}function xi(t,e,n,r){if(50<Hc)throw Hc=0,vy=null,Error(we(185));rd(t,n,r),(!(_t&2)||t!==An)&&(t===An&&(!(_t&2)&&(Lp|=n),wn===4&&no(t,jn)),Or(t,r),n===1&&_t===0&&!(e.mode&1)&&(gl=hn()+500,Np&&$o()))}function Or(t,e){var n=t.callbackNode;VF(t,e);var r=dg(t,t===An?jn:0);if(r===0)n!==null&&FS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&FS(n),e===1)t.tag===0?L5(RT.bind(null,t)):cA(RT.bind(null,t)),N5(function(){!(_t&6)&&$o()}),n=null;else{switch(Bb(r)){case 1:n=X0;break;case 4:n=Lb;break;case 16:n=hg;break;case 536870912:n=Vb;break;default:n=hg}n=lP(n,nP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function nP(t,e){if(Ff=-1,Bf=0,_t&6)throw Error(we(327));var n=t.callbackNode;if(Yu()&&t.callbackNode!==n)return null;var r=dg(t,t===An?jn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Rg(t,r);else{e=r;var i=_t;_t|=2;var s=iP();(An!==t||jn!==e)&&(gs=null,gl=hn()+500,Ta(t,e));do try{r4();break}catch(l){rP(t,l)}while(!0);cw(),bg.current=s,_t=i,vn!==null?e=0:(An=null,jn=0,e=wn)}if(e!==0){if(e===2&&(i=qv(t),i!==0&&(r=i,e=yy(t,i))),e===1)throw n=wh,Ta(t,0),no(t,r),Or(t,hn()),n;if(e===6)no(t,r);else{if(i=t.current.alternate,!(r&30)&&!t4(i)&&(e=Rg(t,r),e===2&&(s=qv(t),s!==0&&(r=s,e=yy(t,s))),e===1))throw n=wh,Ta(t,0),no(t,r),Or(t,hn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(we(345));case 2:oa(t,Cr,gs);break;case 3:if(no(t,r),(r&130023424)===r&&(e=xw+500-hn(),10<e)){if(dg(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){fr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Zv(oa.bind(null,t,Cr,gs),e);break}oa(t,Cr,gs);break;case 4:if(no(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Ti(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=hn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*e4(r/1960))-r,10<r){t.timeoutHandle=Zv(oa.bind(null,t,Cr,gs),r);break}oa(t,Cr,gs);break;case 5:oa(t,Cr,gs);break;default:throw Error(we(329))}}}return Or(t,hn()),t.callbackNode===n?nP.bind(null,t):null}function yy(t,e){var n=$c;return t.current.memoizedState.isDehydrated&&(Ta(t,e).flags|=256),t=Rg(t,e),t!==2&&(e=Cr,Cr=n,e!==null&&wy(e)),t}function wy(t){Cr===null?Cr=t:Cr.push.apply(Cr,t)}function t4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!bi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function no(t,e){for(e&=~Tw,e&=~Lp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ti(e),r=1<<n;t[n]=-1,e&=~r}}function RT(t){if(_t&6)throw Error(we(327));Yu();var e=dg(t,0);if(!(e&1))return Or(t,hn()),null;var n=Rg(t,e);if(t.tag!==0&&n===2){var r=qv(t);r!==0&&(e=r,n=yy(t,r))}if(n===1)throw n=wh,Ta(t,0),no(t,e),Or(t,hn()),n;if(n===6)throw Error(we(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,oa(t,Cr,gs),Or(t,hn()),null}function Cw(t,e){var n=_t;_t|=1;try{return t(e)}finally{_t=n,_t===0&&(gl=hn()+500,Np&&$o())}}function La(t){ao!==null&&ao.tag===0&&!(_t&6)&&Yu();var e=_t;_t|=1;var n=si.transition,r=Tt;try{if(si.transition=null,Tt=1,t)return t()}finally{Tt=r,si.transition=n,_t=e,!(_t&6)&&$o()}}function bw(){Vr=Uu.current,jt(Uu)}function Ta(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,k5(n)),vn!==null)for(n=vn.return;n!==null;){var r=n;switch(aw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_g();break;case 3:dl(),jt(Nr),jt(rr),mw();break;case 5:pw(r);break;case 4:dl();break;case 13:jt(Qt);break;case 19:jt(Qt);break;case 10:hw(r.type._context);break;case 22:case 23:bw()}n=n.return}if(An=t,vn=t=Eo(t.current,null),jn=Vr=e,wn=0,wh=null,Tw=Lp=Ma=0,Cr=$c=null,ma!==null){for(e=0;e<ma.length;e++)if(n=ma[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ma=null}return t}function rP(t,e){do{var n=vn;try{if(cw(),Mf.current=Cg,xg){for(var r=Yt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}xg=!1}if(Oa=0,Cn=yn=Yt=null,jc=!1,_h=0,Sw.current=null,n===null||n.return===null){wn=1,wh=e,vn=null;break}e:{var s=t,a=n.return,l=n,h=e;if(e=jn,l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var g=h,m=l,v=m.tag;if(!(m.mode&1)&&(v===0||v===11||v===15)){var I=m.alternate;I?(m.updateQueue=I.updateQueue,m.memoizedState=I.memoizedState,m.lanes=I.lanes):(m.updateQueue=null,m.memoizedState=null)}var S=_T(a);if(S!==null){S.flags&=-257,vT(S,a,l,s,e),S.mode&1&&mT(s,g,e),e=S,h=g;var j=e.updateQueue;if(j===null){var z=new Set;z.add(h),e.updateQueue=z}else j.add(h);break e}else{if(!(e&1)){mT(s,g,e),Aw();break e}h=Error(we(426))}}else if(qt&&l.mode&1){var J=_T(a);if(J!==null){!(J.flags&65536)&&(J.flags|=256),vT(J,a,l,s,e),uw(fl(h,l));break e}}s=h=fl(h,l),wn!==4&&(wn=2),$c===null?$c=[s]:$c.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var V=UA(s,h,e);lT(s,V);break e;case 1:l=h;var B=s.type,U=s.stateNode;if(!(s.flags&128)&&(typeof B.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(yo===null||!yo.has(U)))){s.flags|=65536,e&=-e,s.lanes|=e;var Z=jA(s,l,e);lT(s,Z);break e}}s=s.return}while(s!==null)}oP(n)}catch(ne){e=ne,vn===n&&n!==null&&(vn=n=n.return);continue}break}while(!0)}function iP(){var t=bg.current;return bg.current=Cg,t===null?Cg:t}function Aw(){(wn===0||wn===3||wn===2)&&(wn=4),An===null||!(Ma&268435455)&&!(Lp&268435455)||no(An,jn)}function Rg(t,e){var n=_t;_t|=2;var r=iP();(An!==t||jn!==e)&&(gs=null,Ta(t,e));do try{n4();break}catch(i){rP(t,i)}while(!0);if(cw(),_t=n,bg.current=r,vn!==null)throw Error(we(261));return An=null,jn=0,wn}function n4(){for(;vn!==null;)sP(vn)}function r4(){for(;vn!==null&&!AF();)sP(vn)}function sP(t){var e=uP(t.alternate,t,Vr);t.memoizedProps=t.pendingProps,e===null?oP(t):vn=e,Sw.current=null}function oP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Y5(n,e),n!==null){n.flags&=32767,vn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wn=6,vn=null;return}}else if(n=Q5(n,e,Vr),n!==null){vn=n;return}if(e=e.sibling,e!==null){vn=e;return}vn=e=t}while(e!==null);wn===0&&(wn=5)}function oa(t,e,n){var r=Tt,i=si.transition;try{si.transition=null,Tt=1,i4(t,e,n,r)}finally{si.transition=i,Tt=r}return null}function i4(t,e,n,r){do Yu();while(ao!==null);if(_t&6)throw Error(we(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(we(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(FF(t,s),t===An&&(vn=An=null,jn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||cf||(cf=!0,lP(hg,function(){return Yu(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=si.transition,si.transition=null;var a=Tt;Tt=1;var l=_t;_t|=4,Sw.current=null,J5(t,n),eP(n,t),T5(Xv),fg=!!Yv,Xv=Yv=null,t.current=n,Z5(n),PF(),_t=l,Tt=a,si.transition=s}else t.current=n;if(cf&&(cf=!1,ao=t,Pg=i),s=t.pendingLanes,s===0&&(yo=null),NF(n.stateNode),Or(t,hn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ag)throw Ag=!1,t=_y,_y=null,t;return Pg&1&&t.tag!==0&&Yu(),s=t.pendingLanes,s&1?t===vy?Hc++:(Hc=0,vy=t):Hc=0,$o(),null}function Yu(){if(ao!==null){var t=Bb(Pg),e=si.transition,n=Tt;try{if(si.transition=null,Tt=16>t?16:t,ao===null)var r=!1;else{if(t=ao,ao=null,Pg=0,_t&6)throw Error(we(331));var i=_t;for(_t|=4,Le=t.current;Le!==null;){var s=Le,a=s.child;if(Le.flags&16){var l=s.deletions;if(l!==null){for(var h=0;h<l.length;h++){var g=l[h];for(Le=g;Le!==null;){var m=Le;switch(m.tag){case 0:case 11:case 15:zc(8,m,s)}var v=m.child;if(v!==null)v.return=m,Le=v;else for(;Le!==null;){m=Le;var I=m.sibling,S=m.return;if(XA(m),m===g){Le=null;break}if(I!==null){I.return=S,Le=I;break}Le=S}}}var j=s.alternate;if(j!==null){var z=j.child;if(z!==null){j.child=null;do{var J=z.sibling;z.sibling=null,z=J}while(z!==null)}}Le=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Le=a;else e:for(;Le!==null;){if(s=Le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zc(9,s,s.return)}var V=s.sibling;if(V!==null){V.return=s.return,Le=V;break e}Le=s.return}}var B=t.current;for(Le=B;Le!==null;){a=Le;var U=a.child;if(a.subtreeFlags&2064&&U!==null)U.return=a,Le=U;else e:for(a=B;Le!==null;){if(l=Le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Mp(9,l)}}catch(ne){tn(l,l.return,ne)}if(l===a){Le=null;break e}var Z=l.sibling;if(Z!==null){Z.return=l.return,Le=Z;break e}Le=l.return}}if(_t=i,$o(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(bp,t)}catch{}r=!0}return r}finally{Tt=n,si.transition=e}}return!1}function kT(t,e,n){e=fl(n,e),e=UA(t,e,1),t=vo(t,e,1),e=fr(),t!==null&&(rd(t,1,e),Or(t,e))}function tn(t,e,n){if(t.tag===3)kT(t,t,n);else for(;e!==null;){if(e.tag===3){kT(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(yo===null||!yo.has(r))){t=fl(n,t),t=jA(e,t,1),e=vo(e,t,1),t=fr(),e!==null&&(rd(e,1,t),Or(e,t));break}}e=e.return}}function s4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fr(),t.pingedLanes|=t.suspendedLanes&n,An===t&&(jn&n)===n&&(wn===4||wn===3&&(jn&130023424)===jn&&500>hn()-xw?Ta(t,0):Tw|=n),Or(t,e)}function aP(t,e){e===0&&(t.mode&1?(e=Zd,Zd<<=1,!(Zd&130023424)&&(Zd=4194304)):e=1);var n=fr();t=Ns(t,e),t!==null&&(rd(t,e,n),Or(t,n))}function o4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),aP(t,n)}function a4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(we(314))}r!==null&&r.delete(e),aP(t,n)}var uP;uP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Nr.current)br=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return br=!1,K5(t,e,n);br=!!(t.flags&131072)}else br=!1,qt&&e.flags&1048576&&hA(e,wg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Vf(t,e),t=e.pendingProps;var i=ll(e,rr.current);Qu(e,n),i=vw(null,e,r,t,i,n);var s=yw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Dr(r)?(s=!0,vg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,fw(e),i.updater=Dp,e.stateNode=i,i._reactInternals=e,oy(e,r,t,n),e=ly(null,e,r,!0,s,n)):(e.tag=0,qt&&s&&ow(e),ar(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Vf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=l4(r),t=_i(r,t),i){case 0:e=uy(null,e,r,t,n);break e;case 1:e=ET(null,e,r,t,n);break e;case 11:e=yT(null,e,r,t,n);break e;case 14:e=wT(null,e,r,_i(r.type,t),n);break e}throw Error(we(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),uy(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),ET(t,e,r,i,n);case 3:e:{if(qA(e),t===null)throw Error(we(387));r=e.pendingProps,s=e.memoizedState,i=s.element,pA(t,e),Sg(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=fl(Error(we(423)),e),e=IT(t,e,r,n,i);break e}else if(r!==i){i=fl(Error(we(424)),e),e=IT(t,e,r,n,i);break e}else for(zr=_o(e.stateNode.containerInfo.firstChild),Hr=e,qt=!0,yi=null,n=yA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cl(),r===i){e=Ds(t,e,n);break e}ar(t,e,r,n)}e=e.child}return e;case 5:return wA(e),t===null&&ry(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Jv(r,i)?a=null:s!==null&&Jv(r,s)&&(e.flags|=32),HA(t,e),ar(t,e,a,n),e.child;case 6:return t===null&&ry(e),null;case 13:return GA(t,e,n);case 4:return gw(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hl(e,null,r,n):ar(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),yT(t,e,r,i,n);case 7:return ar(t,e,e.pendingProps,n),e.child;case 8:return ar(t,e,e.pendingProps.children,n),e.child;case 12:return ar(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Mt(Eg,r._currentValue),r._currentValue=a,s!==null)if(bi(s.value,a)){if(s.children===i.children&&!Nr.current){e=Ds(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var h=l.firstContext;h!==null;){if(h.context===r){if(s.tag===1){h=bs(-1,n&-n),h.tag=2;var g=s.updateQueue;if(g!==null){g=g.shared;var m=g.pending;m===null?h.next=h:(h.next=m.next,m.next=h),g.pending=h}}s.lanes|=n,h=s.alternate,h!==null&&(h.lanes|=n),iy(s.return,n,e),l.lanes|=n;break}h=h.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(we(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),iy(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ar(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Qu(e,n),i=oi(i),r=r(i),e.flags|=1,ar(t,e,r,n),e.child;case 14:return r=e.type,i=_i(r,e.pendingProps),i=_i(r.type,i),wT(t,e,r,i,n);case 15:return zA(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),Vf(t,e),e.tag=1,Dr(r)?(t=!0,vg(e)):t=!1,Qu(e,n),_A(e,r,i),oy(e,r,i,n),ly(null,e,r,!0,t,n);case 19:return WA(t,e,n);case 22:return $A(t,e,n)}throw Error(we(156,e.tag))};function lP(t,e){return Mb(t,e)}function u4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ri(t,e,n,r){return new u4(t,e,n,r)}function Pw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function l4(t){if(typeof t=="function")return Pw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===K0)return 11;if(t===Q0)return 14}return 2}function Eo(t,e){var n=t.alternate;return n===null?(n=ri(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Uf(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")Pw(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ru:return xa(n.children,i,s,e);case W0:a=8,i|=8;break;case Rv:return t=ri(12,n,e,i|2),t.elementType=Rv,t.lanes=s,t;case kv:return t=ri(13,n,e,i),t.elementType=kv,t.lanes=s,t;case Nv:return t=ri(19,n,e,i),t.elementType=Nv,t.lanes=s,t;case vb:return Vp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mb:a=10;break e;case _b:a=9;break e;case K0:a=11;break e;case Q0:a=14;break e;case Js:a=16,r=null;break e}throw Error(we(130,t==null?t:typeof t,""))}return e=ri(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function xa(t,e,n,r){return t=ri(7,t,r,e),t.lanes=n,t}function Vp(t,e,n,r){return t=ri(22,t,r,e),t.elementType=vb,t.lanes=n,t.stateNode={isHidden:!1},t}function S_(t,e,n){return t=ri(6,t,null,e),t.lanes=n,t}function T_(t,e,n){return e=ri(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function c4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=i_(0),this.expirationTimes=i_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=i_(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rw(t,e,n,r,i,s,a,l,h){return t=new c4(t,e,n,l,h),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ri(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},fw(s),t}function h4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function cP(t){if(!t)return bo;t=t._reactInternals;e:{if(eu(t)!==t||t.tag!==1)throw Error(we(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Dr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(we(171))}if(t.tag===1){var n=t.type;if(Dr(n))return lA(t,n,e)}return e}function hP(t,e,n,r,i,s,a,l,h){return t=Rw(n,r,!0,t,i,s,a,l,h),t.context=cP(null),n=t.current,r=fr(),i=wo(n),s=bs(r,i),s.callback=e??null,vo(n,s,i),t.current.lanes=i,rd(t,i,r),Or(t,r),t}function Fp(t,e,n,r){var i=e.current,s=fr(),a=wo(i);return n=cP(n),e.context===null?e.context=n:e.pendingContext=n,e=bs(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=vo(i,e,a),t!==null&&(xi(t,i,a,s),Of(t,i,a)),a}function kg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function NT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function kw(t,e){NT(t,e),(t=t.alternate)&&NT(t,e)}function d4(){return null}var dP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Nw(t){this._internalRoot=t}Bp.prototype.render=Nw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(we(409));Fp(t,e,null,null)};Bp.prototype.unmount=Nw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;La(function(){Fp(null,t,null,null)}),e[ks]=null}};function Bp(t){this._internalRoot=t}Bp.prototype.unstable_scheduleHydration=function(t){if(t){var e=zb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<to.length&&e!==0&&e<to[n].priority;n++);to.splice(n,0,t),n===0&&Hb(t)}};function Dw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Up(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function DT(){}function f4(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var g=kg(a);s.call(g)}}var a=hP(e,r,t,0,null,!1,!1,"",DT);return t._reactRootContainer=a,t[ks]=a.current,dh(t.nodeType===8?t.parentNode:t),La(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var g=kg(h);l.call(g)}}var h=Rw(t,0,!1,null,null,!1,!1,"",DT);return t._reactRootContainer=h,t[ks]=h.current,dh(t.nodeType===8?t.parentNode:t),La(function(){Fp(e,h,n,r)}),h}function jp(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var h=kg(a);l.call(h)}}Fp(e,a,t,i)}else a=f4(n,e,t,i,r);return kg(a)}Ub=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Tc(e.pendingLanes);n!==0&&(J0(e,n|1),Or(e,hn()),!(_t&6)&&(gl=hn()+500,$o()))}break;case 13:La(function(){var r=Ns(t,1);if(r!==null){var i=fr();xi(r,t,1,i)}}),kw(t,1)}};Z0=function(t){if(t.tag===13){var e=Ns(t,134217728);if(e!==null){var n=fr();xi(e,t,134217728,n)}kw(t,134217728)}};jb=function(t){if(t.tag===13){var e=wo(t),n=Ns(t,e);if(n!==null){var r=fr();xi(n,t,e,r)}kw(t,e)}};zb=function(){return Tt};$b=function(t,e){var n=Tt;try{return Tt=t,e()}finally{Tt=n}};zv=function(t,e,n){switch(e){case"input":if(Mv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=kp(r);if(!i)throw Error(we(90));wb(r),Mv(r,i)}}}break;case"textarea":Ib(t,n);break;case"select":e=n.value,e!=null&&qu(t,!!n.multiple,e,!1)}};Pb=Cw;Rb=La;var g4={usingClientEntryPoint:!1,Events:[sd,Ou,kp,bb,Ab,Cw]},oc={findFiberByHostInstance:pa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},p4={bundleType:oc.bundleType,version:oc.version,rendererPackageName:oc.rendererPackageName,rendererConfig:oc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Db(t),t===null?null:t.stateNode},findFiberByHostInstance:oc.findFiberByHostInstance||d4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hf.isDisabled&&hf.supportsFiber)try{bp=hf.inject(p4),Ji=hf}catch{}}Qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g4;Qr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dw(e))throw Error(we(200));return h4(t,e,null,n)};Qr.createRoot=function(t,e){if(!Dw(t))throw Error(we(299));var n=!1,r="",i=dP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rw(t,1,!1,null,null,n,!1,r,i),t[ks]=e.current,dh(t.nodeType===8?t.parentNode:t),new Nw(e)};Qr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(we(188)):(t=Object.keys(t).join(","),Error(we(268,t)));return t=Db(e),t=t===null?null:t.stateNode,t};Qr.flushSync=function(t){return La(t)};Qr.hydrate=function(t,e,n){if(!Up(e))throw Error(we(200));return jp(null,t,e,!0,n)};Qr.hydrateRoot=function(t,e,n){if(!Dw(t))throw Error(we(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=dP;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=hP(e,null,t,1,n??null,i,!1,s,a),t[ks]=e.current,dh(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Bp(e)};Qr.render=function(t,e,n){if(!Up(e))throw Error(we(200));return jp(null,t,e,!1,n)};Qr.unmountComponentAtNode=function(t){if(!Up(t))throw Error(we(40));return t._reactRootContainer?(La(function(){jp(null,null,t,!1,function(){t._reactRootContainer=null,t[ks]=null})}),!0):!1};Qr.unstable_batchedUpdates=Cw;Qr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Up(n))throw Error(we(200));if(t==null||t._reactInternals===void 0)throw Error(we(38));return jp(t,e,n,!1,r)};Qr.version="18.2.0-next-9e3b772b8-20220608";function fP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fP)}catch(t){console.error(t)}}fP(),hb.exports=Qr;var Ow=hb.exports,OT=Ow;Av.createRoot=OT.createRoot,Av.hydrateRoot=OT.hydrateRoot;var Ey=function(t,e){return Ey=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ey(t,e)};function li(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ey(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ve=function(){return Ve=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ve.apply(this,arguments)};function Os(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Fi(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var gP={exports:{}},Ct={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kn=typeof Symbol=="function"&&Symbol.for,Mw=kn?Symbol.for("react.element"):60103,Lw=kn?Symbol.for("react.portal"):60106,zp=kn?Symbol.for("react.fragment"):60107,$p=kn?Symbol.for("react.strict_mode"):60108,Hp=kn?Symbol.for("react.profiler"):60114,qp=kn?Symbol.for("react.provider"):60109,Gp=kn?Symbol.for("react.context"):60110,Vw=kn?Symbol.for("react.async_mode"):60111,Wp=kn?Symbol.for("react.concurrent_mode"):60111,Kp=kn?Symbol.for("react.forward_ref"):60112,Qp=kn?Symbol.for("react.suspense"):60113,m4=kn?Symbol.for("react.suspense_list"):60120,Yp=kn?Symbol.for("react.memo"):60115,Xp=kn?Symbol.for("react.lazy"):60116,_4=kn?Symbol.for("react.block"):60121,v4=kn?Symbol.for("react.fundamental"):60117,y4=kn?Symbol.for("react.responder"):60118,w4=kn?Symbol.for("react.scope"):60119;function Xr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Mw:switch(t=t.type,t){case Vw:case Wp:case zp:case Hp:case $p:case Qp:return t;default:switch(t=t&&t.$$typeof,t){case Gp:case Kp:case Xp:case Yp:case qp:return t;default:return e}}case Lw:return e}}}function pP(t){return Xr(t)===Wp}Ct.AsyncMode=Vw;Ct.ConcurrentMode=Wp;Ct.ContextConsumer=Gp;Ct.ContextProvider=qp;Ct.Element=Mw;Ct.ForwardRef=Kp;Ct.Fragment=zp;Ct.Lazy=Xp;Ct.Memo=Yp;Ct.Portal=Lw;Ct.Profiler=Hp;Ct.StrictMode=$p;Ct.Suspense=Qp;Ct.isAsyncMode=function(t){return pP(t)||Xr(t)===Vw};Ct.isConcurrentMode=pP;Ct.isContextConsumer=function(t){return Xr(t)===Gp};Ct.isContextProvider=function(t){return Xr(t)===qp};Ct.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mw};Ct.isForwardRef=function(t){return Xr(t)===Kp};Ct.isFragment=function(t){return Xr(t)===zp};Ct.isLazy=function(t){return Xr(t)===Xp};Ct.isMemo=function(t){return Xr(t)===Yp};Ct.isPortal=function(t){return Xr(t)===Lw};Ct.isProfiler=function(t){return Xr(t)===Hp};Ct.isStrictMode=function(t){return Xr(t)===$p};Ct.isSuspense=function(t){return Xr(t)===Qp};Ct.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===zp||t===Wp||t===Hp||t===$p||t===Qp||t===m4||typeof t=="object"&&t!==null&&(t.$$typeof===Xp||t.$$typeof===Yp||t.$$typeof===qp||t.$$typeof===Gp||t.$$typeof===Kp||t.$$typeof===v4||t.$$typeof===y4||t.$$typeof===w4||t.$$typeof===_4)};Ct.typeOf=Xr;gP.exports=Ct;var E4=gP.exports,mP=E4,I4={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},S4={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},_P={};_P[mP.ForwardRef]=I4;_P[mP.Memo]=S4;function vP(t,e,n){if(n===void 0&&(n=Error),!t)throw new n(e)}var ct;(function(t){t[t.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",t[t.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",t[t.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",t[t.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",t[t.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",t[t.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",t[t.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",t[t.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",t[t.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",t[t.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",t[t.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",t[t.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",t[t.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",t[t.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",t[t.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",t[t.INVALID_TAG=23]="INVALID_TAG",t[t.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",t[t.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",t[t.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(ct||(ct={}));var Ft;(function(t){t[t.literal=0]="literal",t[t.argument=1]="argument",t[t.number=2]="number",t[t.date=3]="date",t[t.time=4]="time",t[t.select=5]="select",t[t.plural=6]="plural",t[t.pound=7]="pound",t[t.tag=8]="tag"})(Ft||(Ft={}));var pl;(function(t){t[t.number=0]="number",t[t.dateTime=1]="dateTime"})(pl||(pl={}));function MT(t){return t.type===Ft.literal}function T4(t){return t.type===Ft.argument}function yP(t){return t.type===Ft.number}function wP(t){return t.type===Ft.date}function EP(t){return t.type===Ft.time}function IP(t){return t.type===Ft.select}function SP(t){return t.type===Ft.plural}function x4(t){return t.type===Ft.pound}function TP(t){return t.type===Ft.tag}function xP(t){return!!(t&&typeof t=="object"&&t.type===pl.number)}function Iy(t){return!!(t&&typeof t=="object"&&t.type===pl.dateTime)}var CP=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,C4=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function b4(t){var e={};return t.replace(C4,function(n){var r=n.length;switch(n[0]){case"G":e.era=r===4?"long":r===5?"narrow":"short";break;case"y":e.year=r===2?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":e.month=["numeric","2-digit","short","long","narrow"][r-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":e.day=["numeric","2-digit"][r-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":e.weekday=r===4?"long":r===5?"narrow":"short";break;case"e":if(r<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][r-4];break;case"c":if(r<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][r-4];break;case"a":e.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":e.hourCycle="h12",e.hour=["numeric","2-digit"][r-1];break;case"H":e.hourCycle="h23",e.hour=["numeric","2-digit"][r-1];break;case"K":e.hourCycle="h11",e.hour=["numeric","2-digit"][r-1];break;case"k":e.hourCycle="h24",e.hour=["numeric","2-digit"][r-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":e.minute=["numeric","2-digit"][r-1];break;case"s":e.second=["numeric","2-digit"][r-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":e.timeZoneName=r<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),e}var A4=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function P4(t){if(t.length===0)throw new Error("Number skeleton cannot be empty");for(var e=t.split(A4).filter(function(I){return I.length>0}),n=[],r=0,i=e;r<i.length;r++){var s=i[r],a=s.split("/");if(a.length===0)throw new Error("Invalid number skeleton");for(var l=a[0],h=a.slice(1),g=0,m=h;g<m.length;g++){var v=m[g];if(v.length===0)throw new Error("Invalid number skeleton")}n.push({stem:l,options:h})}return n}function R4(t){return t.replace(/^(.*?)-/,"")}var LT=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,bP=/^(@+)?(\+|#+)?[rs]?$/g,k4=/(\*)(0+)|(#+)(0+)|(0+)/g,AP=/^(0+)$/;function VT(t){var e={};return t[t.length-1]==="r"?e.roundingPriority="morePrecision":t[t.length-1]==="s"&&(e.roundingPriority="lessPrecision"),t.replace(bP,function(n,r,i){return typeof i!="string"?(e.minimumSignificantDigits=r.length,e.maximumSignificantDigits=r.length):i==="+"?e.minimumSignificantDigits=r.length:r[0]==="#"?e.maximumSignificantDigits=r.length:(e.minimumSignificantDigits=r.length,e.maximumSignificantDigits=r.length+(typeof i=="string"?i.length:0)),""}),e}function PP(t){switch(t){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function N4(t){var e;if(t[0]==="E"&&t[1]==="E"?(e={notation:"engineering"},t=t.slice(2)):t[0]==="E"&&(e={notation:"scientific"},t=t.slice(1)),e){var n=t.slice(0,2);if(n==="+!"?(e.signDisplay="always",t=t.slice(2)):n==="+?"&&(e.signDisplay="exceptZero",t=t.slice(2)),!AP.test(t))throw new Error("Malformed concise eng/scientific notation");e.minimumIntegerDigits=t.length}return e}function FT(t){var e={},n=PP(t);return n||e}function D4(t){for(var e={},n=0,r=t;n<r.length;n++){var i=r[n];switch(i.stem){case"percent":case"%":e.style="percent";continue;case"%x100":e.style="percent",e.scale=100;continue;case"currency":e.style="currency",e.currency=i.options[0];continue;case"group-off":case",_":e.useGrouping=!1;continue;case"precision-integer":case".":e.maximumFractionDigits=0;continue;case"measure-unit":case"unit":e.style="unit",e.unit=R4(i.options[0]);continue;case"compact-short":case"K":e.notation="compact",e.compactDisplay="short";continue;case"compact-long":case"KK":e.notation="compact",e.compactDisplay="long";continue;case"scientific":e=Ve(Ve(Ve({},e),{notation:"scientific"}),i.options.reduce(function(h,g){return Ve(Ve({},h),FT(g))},{}));continue;case"engineering":e=Ve(Ve(Ve({},e),{notation:"engineering"}),i.options.reduce(function(h,g){return Ve(Ve({},h),FT(g))},{}));continue;case"notation-simple":e.notation="standard";continue;case"unit-width-narrow":e.currencyDisplay="narrowSymbol",e.unitDisplay="narrow";continue;case"unit-width-short":e.currencyDisplay="code",e.unitDisplay="short";continue;case"unit-width-full-name":e.currencyDisplay="name",e.unitDisplay="long";continue;case"unit-width-iso-code":e.currencyDisplay="symbol";continue;case"scale":e.scale=parseFloat(i.options[0]);continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(k4,function(h,g,m,v,I,S){if(g)e.minimumIntegerDigits=m.length;else{if(v&&I)throw new Error("We currently do not support maximum integer digits");if(S)throw new Error("We currently do not support exact integer digits")}return""});continue}if(AP.test(i.stem)){e.minimumIntegerDigits=i.stem.length;continue}if(LT.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(LT,function(h,g,m,v,I,S){return m==="*"?e.minimumFractionDigits=g.length:v&&v[0]==="#"?e.maximumFractionDigits=v.length:I&&S?(e.minimumFractionDigits=I.length,e.maximumFractionDigits=I.length+S.length):(e.minimumFractionDigits=g.length,e.maximumFractionDigits=g.length),""});var s=i.options[0];s==="w"?e=Ve(Ve({},e),{trailingZeroDisplay:"stripIfInteger"}):s&&(e=Ve(Ve({},e),VT(s)));continue}if(bP.test(i.stem)){e=Ve(Ve({},e),VT(i.stem));continue}var a=PP(i.stem);a&&(e=Ve(Ve({},e),a));var l=N4(i.stem);l&&(e=Ve(Ve({},e),l))}return e}var df={"001":["H","h"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["H","h","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["H","hB","h","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["H","h","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["H","hB","h","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["H","h","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["H","h","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["H","h","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["H","h","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["H","hB","h","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["H","h","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["H","h","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["H","h","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function O4(t,e){for(var n="",r=0;r<t.length;r++){var i=t.charAt(r);if(i==="j"){for(var s=0;r+1<t.length&&t.charAt(r+1)===i;)s++,r++;var a=1+(s&1),l=s<2?1:3+(s>>1),h="a",g=M4(e);for((g=="H"||g=="k")&&(l=0);l-- >0;)n+=h;for(;a-- >0;)n=g+n}else i==="J"?n+="H":n+=i}return n}function M4(t){var e=t.hourCycle;if(e===void 0&&t.hourCycles&&t.hourCycles.length&&(e=t.hourCycles[0]),e)switch(e){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n=t.language,r;n!=="root"&&(r=t.maximize().region);var i=df[r||""]||df[n||""]||df["".concat(n,"-001")]||df["001"];return i[0]}var x_,L4=new RegExp("^".concat(CP.source,"*")),V4=new RegExp("".concat(CP.source,"*$"));function ft(t,e){return{start:t,end:e}}var F4=!!String.prototype.startsWith&&"_a".startsWith("a",1),B4=!!String.fromCodePoint,U4=!!Object.fromEntries,j4=!!String.prototype.codePointAt,z4=!!String.prototype.trimStart,$4=!!String.prototype.trimEnd,H4=!!Number.isSafeInteger,q4=H4?Number.isSafeInteger:function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<=9007199254740991},Sy=!0;try{var G4=kP("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");Sy=((x_=G4.exec("a"))===null||x_===void 0?void 0:x_[0])==="a"}catch{Sy=!1}var BT=F4?function(e,n,r){return e.startsWith(n,r)}:function(e,n,r){return e.slice(r,r+n.length)===n},Ty=B4?String.fromCodePoint:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r="",i=e.length,s=0,a;i>s;){if(a=e[s++],a>1114111)throw RangeError(a+" is not a valid code point");r+=a<65536?String.fromCharCode(a):String.fromCharCode(((a-=65536)>>10)+55296,a%1024+56320)}return r},UT=U4?Object.fromEntries:function(e){for(var n={},r=0,i=e;r<i.length;r++){var s=i[r],a=s[0],l=s[1];n[a]=l}return n},RP=j4?function(e,n){return e.codePointAt(n)}:function(e,n){var r=e.length;if(!(n<0||n>=r)){var i=e.charCodeAt(n),s;return i<55296||i>56319||n+1===r||(s=e.charCodeAt(n+1))<56320||s>57343?i:(i-55296<<10)+(s-56320)+65536}},W4=z4?function(e){return e.trimStart()}:function(e){return e.replace(L4,"")},K4=$4?function(e){return e.trimEnd()}:function(e){return e.replace(V4,"")};function kP(t,e){return new RegExp(t,e)}var xy;if(Sy){var jT=kP("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");xy=function(e,n){var r;jT.lastIndex=n;var i=jT.exec(e);return(r=i[1])!==null&&r!==void 0?r:""}}else xy=function(e,n){for(var r=[];;){var i=RP(e,n);if(i===void 0||NP(i)||J4(i))break;r.push(i),n+=i>=65536?2:1}return Ty.apply(void 0,r)};var Q4=function(){function t(e,n){n===void 0&&(n={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!n.ignoreTag,this.locale=n.locale,this.requiresOtherClause=!!n.requiresOtherClause,this.shouldParseSkeletons=!!n.shouldParseSkeletons}return t.prototype.parse=function(){if(this.offset()!==0)throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},t.prototype.parseMessage=function(e,n,r){for(var i=[];!this.isEOF();){var s=this.char();if(s===123){var a=this.parseArgument(e,r);if(a.err)return a;i.push(a.val)}else{if(s===125&&e>0)break;if(s===35&&(n==="plural"||n==="selectordinal")){var l=this.clonePosition();this.bump(),i.push({type:Ft.pound,location:ft(l,this.clonePosition())})}else if(s===60&&!this.ignoreTag&&this.peek()===47){if(r)break;return this.error(ct.UNMATCHED_CLOSING_TAG,ft(this.clonePosition(),this.clonePosition()))}else if(s===60&&!this.ignoreTag&&Cy(this.peek()||0)){var a=this.parseTag(e,n);if(a.err)return a;i.push(a.val)}else{var a=this.parseLiteral(e,n);if(a.err)return a;i.push(a.val)}}}return{val:i,err:null}},t.prototype.parseTag=function(e,n){var r=this.clonePosition();this.bump();var i=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Ft.literal,value:"<".concat(i,"/>"),location:ft(r,this.clonePosition())},err:null};if(this.bumpIf(">")){var s=this.parseMessage(e+1,n,!0);if(s.err)return s;var a=s.val,l=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!Cy(this.char()))return this.error(ct.INVALID_TAG,ft(l,this.clonePosition()));var h=this.clonePosition(),g=this.parseTagName();return i!==g?this.error(ct.UNMATCHED_CLOSING_TAG,ft(h,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Ft.tag,value:i,children:a,location:ft(r,this.clonePosition())},err:null}:this.error(ct.INVALID_TAG,ft(l,this.clonePosition())))}else return this.error(ct.UNCLOSED_TAG,ft(r,this.clonePosition()))}else return this.error(ct.INVALID_TAG,ft(r,this.clonePosition()))},t.prototype.parseTagName=function(){var e=this.offset();for(this.bump();!this.isEOF()&&X4(this.char());)this.bump();return this.message.slice(e,this.offset())},t.prototype.parseLiteral=function(e,n){for(var r=this.clonePosition(),i="";;){var s=this.tryParseQuote(n);if(s){i+=s;continue}var a=this.tryParseUnquoted(e,n);if(a){i+=a;continue}var l=this.tryParseLeftAngleBracket();if(l){i+=l;continue}break}var h=ft(r,this.clonePosition());return{val:{type:Ft.literal,value:i,location:h},err:null}},t.prototype.tryParseLeftAngleBracket=function(){return!this.isEOF()&&this.char()===60&&(this.ignoreTag||!Y4(this.peek()||0))?(this.bump(),"<"):null},t.prototype.tryParseQuote=function(e){if(this.isEOF()||this.char()!==39)return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if(e==="plural"||e==="selectordinal")break;return null;default:return null}this.bump();var n=[this.char()];for(this.bump();!this.isEOF();){var r=this.char();if(r===39)if(this.peek()===39)n.push(39),this.bump();else{this.bump();break}else n.push(r);this.bump()}return Ty.apply(void 0,n)},t.prototype.tryParseUnquoted=function(e,n){if(this.isEOF())return null;var r=this.char();return r===60||r===123||r===35&&(n==="plural"||n==="selectordinal")||r===125&&e>0?null:(this.bump(),Ty(r))},t.prototype.parseArgument=function(e,n){var r=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,ft(r,this.clonePosition()));if(this.char()===125)return this.bump(),this.error(ct.EMPTY_ARGUMENT,ft(r,this.clonePosition()));var i=this.parseIdentifierIfPossible().value;if(!i)return this.error(ct.MALFORMED_ARGUMENT,ft(r,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,ft(r,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Ft.argument,value:i,location:ft(r,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,ft(r,this.clonePosition())):this.parseArgumentOptions(e,n,i,r);default:return this.error(ct.MALFORMED_ARGUMENT,ft(r,this.clonePosition()))}},t.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),n=this.offset(),r=xy(this.message,n),i=n+r.length;this.bumpTo(i);var s=this.clonePosition(),a=ft(e,s);return{value:r,location:a}},t.prototype.parseArgumentOptions=function(e,n,r,i){var s,a=this.clonePosition(),l=this.parseIdentifierIfPossible().value,h=this.clonePosition();switch(l){case"":return this.error(ct.EXPECT_ARGUMENT_TYPE,ft(a,h));case"number":case"date":case"time":{this.bumpSpace();var g=null;if(this.bumpIf(",")){this.bumpSpace();var m=this.clonePosition(),v=this.parseSimpleArgStyleIfPossible();if(v.err)return v;var I=K4(v.val);if(I.length===0)return this.error(ct.EXPECT_ARGUMENT_STYLE,ft(this.clonePosition(),this.clonePosition()));var S=ft(m,this.clonePosition());g={style:I,styleLocation:S}}var j=this.tryParseArgumentClose(i);if(j.err)return j;var z=ft(i,this.clonePosition());if(g&&BT(g==null?void 0:g.style,"::",0)){var J=W4(g.style.slice(2));if(l==="number"){var v=this.parseNumberSkeletonFromString(J,g.styleLocation);return v.err?v:{val:{type:Ft.number,value:r,location:z,style:v.val},err:null}}else{if(J.length===0)return this.error(ct.EXPECT_DATE_TIME_SKELETON,z);var V=J;this.locale&&(V=O4(J,this.locale));var I={type:pl.dateTime,pattern:V,location:g.styleLocation,parsedOptions:this.shouldParseSkeletons?b4(V):{}},B=l==="date"?Ft.date:Ft.time;return{val:{type:B,value:r,location:z,style:I},err:null}}}return{val:{type:l==="number"?Ft.number:l==="date"?Ft.date:Ft.time,value:r,location:z,style:(s=g==null?void 0:g.style)!==null&&s!==void 0?s:null},err:null}}case"plural":case"selectordinal":case"select":{var U=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(ct.EXPECT_SELECT_ARGUMENT_OPTIONS,ft(U,Ve({},U)));this.bumpSpace();var Z=this.parseIdentifierIfPossible(),ne=0;if(l!=="select"&&Z.value==="offset"){if(!this.bumpIf(":"))return this.error(ct.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,ft(this.clonePosition(),this.clonePosition()));this.bumpSpace();var v=this.tryParseDecimalInteger(ct.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,ct.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(v.err)return v;this.bumpSpace(),Z=this.parseIdentifierIfPossible(),ne=v.val}var te=this.tryParsePluralOrSelectOptions(e,l,n,Z);if(te.err)return te;var j=this.tryParseArgumentClose(i);if(j.err)return j;var oe=ft(i,this.clonePosition());return l==="select"?{val:{type:Ft.select,value:r,options:UT(te.val),location:oe},err:null}:{val:{type:Ft.plural,value:r,options:UT(te.val),offset:ne,pluralType:l==="plural"?"cardinal":"ordinal",location:oe},err:null}}default:return this.error(ct.INVALID_ARGUMENT_TYPE,ft(a,h))}},t.prototype.tryParseArgumentClose=function(e){return this.isEOF()||this.char()!==125?this.error(ct.EXPECT_ARGUMENT_CLOSING_BRACE,ft(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},t.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,n=this.clonePosition();!this.isEOF();){var r=this.char();switch(r){case 39:{this.bump();var i=this.clonePosition();if(!this.bumpUntil("'"))return this.error(ct.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,ft(i,this.clonePosition()));this.bump();break}case 123:{e+=1,this.bump();break}case 125:{if(e>0)e-=1;else return{val:this.message.slice(n.offset,this.offset()),err:null};break}default:this.bump();break}}return{val:this.message.slice(n.offset,this.offset()),err:null}},t.prototype.parseNumberSkeletonFromString=function(e,n){var r=[];try{r=P4(e)}catch{return this.error(ct.INVALID_NUMBER_SKELETON,n)}return{val:{type:pl.number,tokens:r,location:n,parsedOptions:this.shouldParseSkeletons?D4(r):{}},err:null}},t.prototype.tryParsePluralOrSelectOptions=function(e,n,r,i){for(var s,a=!1,l=[],h=new Set,g=i.value,m=i.location;;){if(g.length===0){var v=this.clonePosition();if(n!=="select"&&this.bumpIf("=")){var I=this.tryParseDecimalInteger(ct.EXPECT_PLURAL_ARGUMENT_SELECTOR,ct.INVALID_PLURAL_ARGUMENT_SELECTOR);if(I.err)return I;m=ft(v,this.clonePosition()),g=this.message.slice(v.offset,this.offset())}else break}if(h.has(g))return this.error(n==="select"?ct.DUPLICATE_SELECT_ARGUMENT_SELECTOR:ct.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,m);g==="other"&&(a=!0),this.bumpSpace();var S=this.clonePosition();if(!this.bumpIf("{"))return this.error(n==="select"?ct.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:ct.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,ft(this.clonePosition(),this.clonePosition()));var j=this.parseMessage(e+1,n,r);if(j.err)return j;var z=this.tryParseArgumentClose(S);if(z.err)return z;l.push([g,{value:j.val,location:ft(S,this.clonePosition())}]),h.add(g),this.bumpSpace(),s=this.parseIdentifierIfPossible(),g=s.value,m=s.location}return l.length===0?this.error(n==="select"?ct.EXPECT_SELECT_ARGUMENT_SELECTOR:ct.EXPECT_PLURAL_ARGUMENT_SELECTOR,ft(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!a?this.error(ct.MISSING_OTHER_CLAUSE,ft(this.clonePosition(),this.clonePosition())):{val:l,err:null}},t.prototype.tryParseDecimalInteger=function(e,n){var r=1,i=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(r=-1);for(var s=!1,a=0;!this.isEOF();){var l=this.char();if(l>=48&&l<=57)s=!0,a=a*10+(l-48),this.bump();else break}var h=ft(i,this.clonePosition());return s?(a*=r,q4(a)?{val:a,err:null}:this.error(n,h)):this.error(e,h)},t.prototype.offset=function(){return this.position.offset},t.prototype.isEOF=function(){return this.offset()===this.message.length},t.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},t.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var n=RP(this.message,e);if(n===void 0)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return n},t.prototype.error=function(e,n){return{val:null,err:{kind:e,message:this.message,location:n}}},t.prototype.bump=function(){if(!this.isEOF()){var e=this.char();e===10?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},t.prototype.bumpIf=function(e){if(BT(this.message,e,this.offset())){for(var n=0;n<e.length;n++)this.bump();return!0}return!1},t.prototype.bumpUntil=function(e){var n=this.offset(),r=this.message.indexOf(e,n);return r>=0?(this.bumpTo(r),!0):(this.bumpTo(this.message.length),!1)},t.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var n=this.offset();if(n===e)break;if(n>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},t.prototype.bumpSpace=function(){for(;!this.isEOF()&&NP(this.char());)this.bump()},t.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),n=this.offset(),r=this.message.charCodeAt(n+(e>=65536?2:1));return r??null},t}();function Cy(t){return t>=97&&t<=122||t>=65&&t<=90}function Y4(t){return Cy(t)||t===47}function X4(t){return t===45||t===46||t>=48&&t<=57||t===95||t>=97&&t<=122||t>=65&&t<=90||t==183||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function NP(t){return t>=9&&t<=13||t===32||t===133||t>=8206&&t<=8207||t===8232||t===8233}function J4(t){return t>=33&&t<=35||t===36||t>=37&&t<=39||t===40||t===41||t===42||t===43||t===44||t===45||t>=46&&t<=47||t>=58&&t<=59||t>=60&&t<=62||t>=63&&t<=64||t===91||t===92||t===93||t===94||t===96||t===123||t===124||t===125||t===126||t===161||t>=162&&t<=165||t===166||t===167||t===169||t===171||t===172||t===174||t===176||t===177||t===182||t===187||t===191||t===215||t===247||t>=8208&&t<=8213||t>=8214&&t<=8215||t===8216||t===8217||t===8218||t>=8219&&t<=8220||t===8221||t===8222||t===8223||t>=8224&&t<=8231||t>=8240&&t<=8248||t===8249||t===8250||t>=8251&&t<=8254||t>=8257&&t<=8259||t===8260||t===8261||t===8262||t>=8263&&t<=8273||t===8274||t===8275||t>=8277&&t<=8286||t>=8592&&t<=8596||t>=8597&&t<=8601||t>=8602&&t<=8603||t>=8604&&t<=8607||t===8608||t>=8609&&t<=8610||t===8611||t>=8612&&t<=8613||t===8614||t>=8615&&t<=8621||t===8622||t>=8623&&t<=8653||t>=8654&&t<=8655||t>=8656&&t<=8657||t===8658||t===8659||t===8660||t>=8661&&t<=8691||t>=8692&&t<=8959||t>=8960&&t<=8967||t===8968||t===8969||t===8970||t===8971||t>=8972&&t<=8991||t>=8992&&t<=8993||t>=8994&&t<=9e3||t===9001||t===9002||t>=9003&&t<=9083||t===9084||t>=9085&&t<=9114||t>=9115&&t<=9139||t>=9140&&t<=9179||t>=9180&&t<=9185||t>=9186&&t<=9254||t>=9255&&t<=9279||t>=9280&&t<=9290||t>=9291&&t<=9311||t>=9472&&t<=9654||t===9655||t>=9656&&t<=9664||t===9665||t>=9666&&t<=9719||t>=9720&&t<=9727||t>=9728&&t<=9838||t===9839||t>=9840&&t<=10087||t===10088||t===10089||t===10090||t===10091||t===10092||t===10093||t===10094||t===10095||t===10096||t===10097||t===10098||t===10099||t===10100||t===10101||t>=10132&&t<=10175||t>=10176&&t<=10180||t===10181||t===10182||t>=10183&&t<=10213||t===10214||t===10215||t===10216||t===10217||t===10218||t===10219||t===10220||t===10221||t===10222||t===10223||t>=10224&&t<=10239||t>=10240&&t<=10495||t>=10496&&t<=10626||t===10627||t===10628||t===10629||t===10630||t===10631||t===10632||t===10633||t===10634||t===10635||t===10636||t===10637||t===10638||t===10639||t===10640||t===10641||t===10642||t===10643||t===10644||t===10645||t===10646||t===10647||t===10648||t>=10649&&t<=10711||t===10712||t===10713||t===10714||t===10715||t>=10716&&t<=10747||t===10748||t===10749||t>=10750&&t<=11007||t>=11008&&t<=11055||t>=11056&&t<=11076||t>=11077&&t<=11078||t>=11079&&t<=11084||t>=11085&&t<=11123||t>=11124&&t<=11125||t>=11126&&t<=11157||t===11158||t>=11159&&t<=11263||t>=11776&&t<=11777||t===11778||t===11779||t===11780||t===11781||t>=11782&&t<=11784||t===11785||t===11786||t===11787||t===11788||t===11789||t>=11790&&t<=11798||t===11799||t>=11800&&t<=11801||t===11802||t===11803||t===11804||t===11805||t>=11806&&t<=11807||t===11808||t===11809||t===11810||t===11811||t===11812||t===11813||t===11814||t===11815||t===11816||t===11817||t>=11818&&t<=11822||t===11823||t>=11824&&t<=11833||t>=11834&&t<=11835||t>=11836&&t<=11839||t===11840||t===11841||t===11842||t>=11843&&t<=11855||t>=11856&&t<=11857||t===11858||t>=11859&&t<=11903||t>=12289&&t<=12291||t===12296||t===12297||t===12298||t===12299||t===12300||t===12301||t===12302||t===12303||t===12304||t===12305||t>=12306&&t<=12307||t===12308||t===12309||t===12310||t===12311||t===12312||t===12313||t===12314||t===12315||t===12316||t===12317||t>=12318&&t<=12319||t===12320||t===12336||t===64830||t===64831||t>=65093&&t<=65094}function by(t){t.forEach(function(e){if(delete e.location,IP(e)||SP(e))for(var n in e.options)delete e.options[n].location,by(e.options[n].value);else yP(e)&&xP(e.style)||(wP(e)||EP(e))&&Iy(e.style)?delete e.style.location:TP(e)&&by(e.children)})}function Z4(t,e){e===void 0&&(e={}),e=Ve({shouldParseSkeletons:!0,requiresOtherClause:!0},e);var n=new Q4(t,e).parse();if(n.err){var r=SyntaxError(ct[n.err.kind]);throw r.location=n.err.location,r.originalMessage=n.err.message,r}return e!=null&&e.captureLocation||by(n.val),n.val}function Li(t,e){var n=e&&e.cache?e.cache:s3,r=e&&e.serializer?e.serializer:i3,i=e&&e.strategy?e.strategy:t3;return i(t,{cache:n,serializer:r})}function e3(t){return t==null||typeof t=="number"||typeof t=="boolean"}function DP(t,e,n,r){var i=e3(r)?r:n(r),s=e.get(i);return typeof s>"u"&&(s=t.call(this,r),e.set(i,s)),s}function OP(t,e,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),s=e.get(i);return typeof s>"u"&&(s=t.apply(this,r),e.set(i,s)),s}function Fw(t,e,n,r,i){return n.bind(e,t,r,i)}function t3(t,e){var n=t.length===1?DP:OP;return Fw(t,this,n,e.cache.create(),e.serializer)}function n3(t,e){return Fw(t,this,OP,e.cache.create(),e.serializer)}function r3(t,e){return Fw(t,this,DP,e.cache.create(),e.serializer)}var i3=function(){return JSON.stringify(arguments)};function Bw(){this.cache=Object.create(null)}Bw.prototype.get=function(t){return this.cache[t]};Bw.prototype.set=function(t,e){this.cache[t]=e};var s3={create:function(){return new Bw}},Vi={variadic:n3,monadic:r3},ns;(function(t){t.MISSING_VALUE="MISSING_VALUE",t.INVALID_VALUE="INVALID_VALUE",t.MISSING_INTL_API="MISSING_INTL_API"})(ns||(ns={}));var Ho=function(t){li(e,t);function e(n,r,i){var s=t.call(this,n)||this;return s.code=r,s.originalMessage=i,s}return e.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},e}(Error),zT=function(t){li(e,t);function e(n,r,i,s){return t.call(this,'Invalid values for "'.concat(n,'": "').concat(r,'". Options are "').concat(Object.keys(i).join('", "'),'"'),ns.INVALID_VALUE,s)||this}return e}(Ho),o3=function(t){li(e,t);function e(n,r,i){return t.call(this,'Value for "'.concat(n,'" must be of type ').concat(r),ns.INVALID_VALUE,i)||this}return e}(Ho),a3=function(t){li(e,t);function e(n,r){return t.call(this,'The intl string context variable "'.concat(n,'" was not provided to the string "').concat(r,'"'),ns.MISSING_VALUE,r)||this}return e}(Ho),or;(function(t){t[t.literal=0]="literal",t[t.object=1]="object"})(or||(or={}));function u3(t){return t.length<2?t:t.reduce(function(e,n){var r=e[e.length-1];return!r||r.type!==or.literal||n.type!==or.literal?e.push(n):r.value+=n.value,e},[])}function MP(t){return typeof t=="function"}function jf(t,e,n,r,i,s,a){if(t.length===1&&MT(t[0]))return[{type:or.literal,value:t[0].value}];for(var l=[],h=0,g=t;h<g.length;h++){var m=g[h];if(MT(m)){l.push({type:or.literal,value:m.value});continue}if(x4(m)){typeof s=="number"&&l.push({type:or.literal,value:n.getNumberFormat(e).format(s)});continue}var v=m.value;if(!(i&&v in i))throw new a3(v,a);var I=i[v];if(T4(m)){(!I||typeof I=="string"||typeof I=="number")&&(I=typeof I=="string"||typeof I=="number"?String(I):""),l.push({type:typeof I=="string"?or.literal:or.object,value:I});continue}if(wP(m)){var S=typeof m.style=="string"?r.date[m.style]:Iy(m.style)?m.style.parsedOptions:void 0;l.push({type:or.literal,value:n.getDateTimeFormat(e,S).format(I)});continue}if(EP(m)){var S=typeof m.style=="string"?r.time[m.style]:Iy(m.style)?m.style.parsedOptions:r.time.medium;l.push({type:or.literal,value:n.getDateTimeFormat(e,S).format(I)});continue}if(yP(m)){var S=typeof m.style=="string"?r.number[m.style]:xP(m.style)?m.style.parsedOptions:void 0;S&&S.scale&&(I=I*(S.scale||1)),l.push({type:or.literal,value:n.getNumberFormat(e,S).format(I)});continue}if(TP(m)){var j=m.children,z=m.value,J=i[z];if(!MP(J))throw new o3(z,"function",a);var V=jf(j,e,n,r,i,s),B=J(V.map(function(ne){return ne.value}));Array.isArray(B)||(B=[B]),l.push.apply(l,B.map(function(ne){return{type:typeof ne=="string"?or.literal:or.object,value:ne}}))}if(IP(m)){var U=m.options[I]||m.options.other;if(!U)throw new zT(m.value,I,Object.keys(m.options),a);l.push.apply(l,jf(U.value,e,n,r,i));continue}if(SP(m)){var U=m.options["=".concat(I)];if(!U){if(!Intl.PluralRules)throw new Ho(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ns.MISSING_INTL_API,a);var Z=n.getPluralRules(e,{type:m.pluralType}).select(I-(m.offset||0));U=m.options[Z]||m.options.other}if(!U)throw new zT(m.value,I,Object.keys(m.options),a);l.push.apply(l,jf(U.value,e,n,r,i,I-(m.offset||0)));continue}}return u3(l)}function l3(t,e){return e?Ve(Ve(Ve({},t||{}),e||{}),Object.keys(t).reduce(function(n,r){return n[r]=Ve(Ve({},t[r]),e[r]||{}),n},{})):t}function c3(t,e){return e?Object.keys(t).reduce(function(n,r){return n[r]=l3(t[r],e[r]),n},Ve({},t)):t}function C_(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}function h3(t){return t===void 0&&(t={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Li(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.NumberFormat).bind.apply(e,Fi([void 0],n,!1)))},{cache:C_(t.number),strategy:Vi.variadic}),getDateTimeFormat:Li(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.DateTimeFormat).bind.apply(e,Fi([void 0],n,!1)))},{cache:C_(t.dateTime),strategy:Vi.variadic}),getPluralRules:Li(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new((e=Intl.PluralRules).bind.apply(e,Fi([void 0],n,!1)))},{cache:C_(t.pluralRules),strategy:Vi.variadic})}}var LP=function(){function t(e,n,r,i){var s=this;if(n===void 0&&(n=t.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(h){var g=s.formatToParts(h);if(g.length===1)return g[0].value;var m=g.reduce(function(v,I){return!v.length||I.type!==or.literal||typeof v[v.length-1]!="string"?v.push(I.value):v[v.length-1]+=I.value,v},[]);return m.length<=1?m[0]||"":m},this.formatToParts=function(h){return jf(s.ast,s.locales,s.formatters,s.formats,h,void 0,s.message)},this.resolvedOptions=function(){var h;return{locale:((h=s.resolvedLocale)===null||h===void 0?void 0:h.toString())||Intl.NumberFormat.supportedLocalesOf(s.locales)[0]}},this.getAst=function(){return s.ast},this.locales=n,this.resolvedLocale=t.resolveLocale(n),typeof e=="string"){if(this.message=e,!t.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var a=i||{};a.formatters;var l=Os(a,["formatters"]);this.ast=t.__parse(e,Ve(Ve({},l),{locale:this.resolvedLocale}))}else this.ast=e;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=c3(t.formats,r),this.formatters=i&&i.formatters||h3(this.formatterCache)}return Object.defineProperty(t,"defaultLocale",{get:function(){return t.memoizedDefaultLocale||(t.memoizedDefaultLocale=new Intl.NumberFormat().resolvedOptions().locale),t.memoizedDefaultLocale},enumerable:!1,configurable:!0}),t.memoizedDefaultLocale=null,t.resolveLocale=function(e){if(!(typeof Intl.Locale>"u")){var n=Intl.NumberFormat.supportedLocalesOf(e);return n.length>0?new Intl.Locale(n[0]):new Intl.Locale(typeof e=="string"?e:e[0])}},t.__parse=Z4,t.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},t}(),Va;(function(t){t.FORMAT_ERROR="FORMAT_ERROR",t.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",t.INVALID_CONFIG="INVALID_CONFIG",t.MISSING_DATA="MISSING_DATA",t.MISSING_TRANSLATION="MISSING_TRANSLATION"})(Va||(Va={}));var ad=function(t){li(e,t);function e(n,r,i){var s=this,a=i?i instanceof Error?i:new Error(String(i)):void 0;return s=t.call(this,"[@formatjs/intl Error ".concat(n,"] ").concat(r,`
`).concat(a?`
`.concat(a.message,`
`).concat(a.stack):""))||this,s.code=n,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(s,e),s}return e}(Error),d3=function(t){li(e,t);function e(n,r){return t.call(this,Va.UNSUPPORTED_FORMATTER,n,r)||this}return e}(ad),f3=function(t){li(e,t);function e(n,r){return t.call(this,Va.INVALID_CONFIG,n,r)||this}return e}(ad),$T=function(t){li(e,t);function e(n,r){return t.call(this,Va.MISSING_DATA,n,r)||this}return e}(ad),ci=function(t){li(e,t);function e(n,r,i){var s=t.call(this,Va.FORMAT_ERROR,"".concat(n,`
Locale: `).concat(r,`
`),i)||this;return s.locale=r,s}return e}(ad),b_=function(t){li(e,t);function e(n,r,i,s){var a=t.call(this,"".concat(n,`
MessageID: `).concat(i==null?void 0:i.id,`
Default Message: `).concat(i==null?void 0:i.defaultMessage,`
Description: `).concat(i==null?void 0:i.description,`
`),r,s)||this;return a.descriptor=i,a.locale=r,a}return e}(ci),g3=function(t){li(e,t);function e(n,r){var i=t.call(this,Va.MISSING_TRANSLATION,'Missing message: "'.concat(n.id,'" for locale "').concat(r,'", using ').concat(n.defaultMessage?"default message (".concat(typeof n.defaultMessage=="string"?n.defaultMessage:n.defaultMessage.map(function(s){var a;return(a=s.value)!==null&&a!==void 0?a:JSON.stringify(s)}).join(),")"):"id"," as fallback."))||this;return i.descriptor=n,i}return e}(ad);function tu(t,e,n){return n===void 0&&(n={}),e.reduce(function(r,i){return i in t?r[i]=t[i]:i in n&&(r[i]=n[i]),r},{})}var p3=function(t){},m3=function(t){},VP={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:p3,onWarn:m3};function FP(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function ra(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}function _3(t){t===void 0&&(t=FP());var e=Intl.RelativeTimeFormat,n=Intl.ListFormat,r=Intl.DisplayNames,i=Li(function(){for(var l,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((l=Intl.DateTimeFormat).bind.apply(l,Fi([void 0],h,!1)))},{cache:ra(t.dateTime),strategy:Vi.variadic}),s=Li(function(){for(var l,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((l=Intl.NumberFormat).bind.apply(l,Fi([void 0],h,!1)))},{cache:ra(t.number),strategy:Vi.variadic}),a=Li(function(){for(var l,h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return new((l=Intl.PluralRules).bind.apply(l,Fi([void 0],h,!1)))},{cache:ra(t.pluralRules),strategy:Vi.variadic});return{getDateTimeFormat:i,getNumberFormat:s,getMessageFormat:Li(function(l,h,g,m){return new LP(l,h,g,Ve({formatters:{getNumberFormat:s,getDateTimeFormat:i,getPluralRules:a}},m||{}))},{cache:ra(t.message),strategy:Vi.variadic}),getRelativeTimeFormat:Li(function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];return new(e.bind.apply(e,Fi([void 0],l,!1)))},{cache:ra(t.relativeTime),strategy:Vi.variadic}),getPluralRules:a,getListFormat:Li(function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];return new(n.bind.apply(n,Fi([void 0],l,!1)))},{cache:ra(t.list),strategy:Vi.variadic}),getDisplayNames:Li(function(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];return new(r.bind.apply(r,Fi([void 0],l,!1)))},{cache:ra(t.displayNames),strategy:Vi.variadic})}}function Uw(t,e,n,r){var i=t&&t[e],s;if(i&&(s=i[n]),s)return s;r(new d3("No ".concat(e," format named: ").concat(n)))}function ff(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=Ve({timeZone:e},t[r]),n},{})}function HT(t,e){var n=Object.keys(Ve(Ve({},t),e));return n.reduce(function(r,i){return r[i]=Ve(Ve({},t[i]||{}),e[i]||{}),r},{})}function qT(t,e){if(!e)return t;var n=LP.formats;return Ve(Ve(Ve({},n),t),{date:HT(ff(n.date,e),ff(t.date||{},e)),time:HT(ff(n.time,e),ff(t.time||{},e))})}var Ay=function(t,e,n,r,i){var s=t.locale,a=t.formats,l=t.messages,h=t.defaultLocale,g=t.defaultFormats,m=t.fallbackOnEmptyString,v=t.onError,I=t.timeZone,S=t.defaultRichTextElements;n===void 0&&(n={id:""});var j=n.id,z=n.defaultMessage;vP(!!j,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var J=String(j),V=l&&Object.prototype.hasOwnProperty.call(l,J)&&l[J];if(Array.isArray(V)&&V.length===1&&V[0].type===Ft.literal)return V[0].value;if(!r&&V&&typeof V=="string"&&!S)return V.replace(/'\{(.*?)\}'/gi,"{$1}");if(r=Ve(Ve({},S),r||{}),a=qT(a,I),g=qT(g,I),!V){if(m===!1&&V==="")return V;if((!z||s&&s.toLowerCase()!==h.toLowerCase())&&v(new g3(n,s)),z)try{var B=e.getMessageFormat(z,h,g,i);return B.format(r)}catch(U){return v(new b_('Error formatting default message for: "'.concat(J,'", rendering default message verbatim'),s,n,U)),typeof z=="string"?z:J}return J}try{var B=e.getMessageFormat(V,s,a,Ve({formatters:e},i||{}));return B.format(r)}catch(U){v(new b_('Error formatting message: "'.concat(J,'", using ').concat(z?"default message":"id"," as fallback."),s,n,U))}if(z)try{var B=e.getMessageFormat(z,h,g,i);return B.format(r)}catch(U){v(new b_('Error formatting the default message for: "'.concat(J,'", rendering message verbatim'),s,n,U))}return typeof V=="string"?V:typeof z=="string"?z:J},BP=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function Jp(t,e,n,r){var i=t.locale,s=t.formats,a=t.onError,l=t.timeZone;r===void 0&&(r={});var h=r.format,g=Ve(Ve({},l&&{timeZone:l}),h&&Uw(s,e,h,a)),m=tu(r,BP,g);return e==="time"&&!m.hour&&!m.minute&&!m.second&&!m.timeStyle&&!m.dateStyle&&(m=Ve(Ve({},m),{hour:"numeric",minute:"numeric"})),n(i,m)}function v3(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,l=typeof i=="string"?new Date(i||0):i;try{return Jp(t,"date",e,a).format(l)}catch(h){t.onError(new ci("Error formatting date.",t.locale,h))}return String(l)}function y3(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,l=typeof i=="string"?new Date(i||0):i;try{return Jp(t,"time",e,a).format(l)}catch(h){t.onError(new ci("Error formatting time.",t.locale,h))}return String(l)}function w3(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=n[2],l=a===void 0?{}:a,h=t.timeZone,g=t.locale,m=t.onError,v=tu(l,BP,h?{timeZone:h}:{});try{return e(g,v).formatRange(i,s)}catch(I){m(new ci("Error formatting date time range.",t.locale,I))}return String(i)}function E3(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,l=typeof i=="string"?new Date(i||0):i;try{return Jp(t,"date",e,a).formatToParts(l)}catch(h){t.onError(new ci("Error formatting date.",t.locale,h))}return[]}function I3(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],s=n[1],a=s===void 0?{}:s,l=typeof i=="string"?new Date(i||0):i;try{return Jp(t,"time",e,a).formatToParts(l)}catch(h){t.onError(new ci("Error formatting time.",t.locale,h))}return[]}var S3=["style","type","fallback","languageDisplay"];function T3(t,e,n,r){var i=t.locale,s=t.onError,a=Intl.DisplayNames;a||s(new Ho(`Intl.DisplayNames is not available in this environment.
Try polyfilling it using "@formatjs/intl-displaynames"
`,ns.MISSING_INTL_API));var l=tu(r,S3);try{return e(i,l).of(n)}catch(h){s(new ci("Error formatting display name.",i,h))}}var x3=["type","style"],GT=Date.now();function C3(t){return"".concat(GT,"_").concat(t,"_").concat(GT)}function b3(t,e,n,r){r===void 0&&(r={});var i=UP(t,e,n,r).reduce(function(s,a){var l=a.value;return typeof l!="string"?s.push(l):typeof s[s.length-1]=="string"?s[s.length-1]+=l:s.push(l),s},[]);return i.length===1?i[0]:i.length===0?"":i}function UP(t,e,n,r){var i=t.locale,s=t.onError;r===void 0&&(r={});var a=Intl.ListFormat;a||s(new Ho(`Intl.ListFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-listformat"
`,ns.MISSING_INTL_API));var l=tu(r,x3);try{var h={},g=n.map(function(m,v){if(typeof m=="object"){var I=C3(v);return h[I]=m,I}return String(m)});return e(i,l).formatToParts(g).map(function(m){return m.type==="literal"?m:Ve(Ve({},m),{value:h[m.value]||m.value})})}catch(m){s(new ci("Error formatting list.",i,m))}return n}var A3=["type"];function P3(t,e,n,r){var i=t.locale,s=t.onError;r===void 0&&(r={}),Intl.PluralRules||s(new Ho(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ns.MISSING_INTL_API));var a=tu(r,A3);try{return e(i,a).select(n)}catch(l){s(new ci("Error formatting plural.",i,l))}return"other"}var R3=["numeric","style"];function k3(t,e,n){var r=t.locale,i=t.formats,s=t.onError;n===void 0&&(n={});var a=n.format,l=!!a&&Uw(i,"relative",a,s)||{},h=tu(n,R3,l);return e(r,h)}function N3(t,e,n,r,i){i===void 0&&(i={}),r||(r="second");var s=Intl.RelativeTimeFormat;s||t.onError(new Ho(`Intl.RelativeTimeFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-relativetimeformat"
`,ns.MISSING_INTL_API));try{return k3(t,e,i).format(n,r)}catch(a){t.onError(new ci("Error formatting relative time.",t.locale,a))}return String(n)}var D3=["style","currency","currencyDisplay","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem"];function jP(t,e,n){var r=t.locale,i=t.formats,s=t.onError;n===void 0&&(n={});var a=n.format,l=a&&Uw(i,"number",a,s)||{},h=tu(n,D3,l);return e(r,h)}function O3(t,e,n,r){r===void 0&&(r={});try{return jP(t,e,r).format(n)}catch(i){t.onError(new ci("Error formatting number.",t.locale,i))}return String(n)}function M3(t,e,n,r){r===void 0&&(r={});try{return jP(t,e,r).formatToParts(n)}catch(i){t.onError(new ci("Error formatting number.",t.locale,i))}return[]}function L3(t){var e=t?t[Object.keys(t)[0]]:void 0;return typeof e=="string"}function V3(t){t.onWarn&&t.defaultRichTextElements&&L3(t.messages||{})&&t.onWarn(`[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. 
Please consider using "@formatjs/cli" to pre-compile your messages for performance.
For more details see https://formatjs.io/docs/getting-started/message-distribution`)}function F3(t,e){var n=_3(e),r=Ve(Ve({},VP),t),i=r.locale,s=r.defaultLocale,a=r.onError;return i?!Intl.NumberFormat.supportedLocalesOf(i).length&&a?a(new $T('Missing locale data for locale: "'.concat(i,'" in Intl.NumberFormat. Using default locale: "').concat(s,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(i).length&&a&&a(new $T('Missing locale data for locale: "'.concat(i,'" in Intl.DateTimeFormat. Using default locale: "').concat(s,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(a&&a(new f3('"locale" was not configured, using "'.concat(s,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),r.locale=r.defaultLocale||"en"),V3(r),Ve(Ve({},r),{formatters:n,formatNumber:O3.bind(null,r,n.getNumberFormat),formatNumberToParts:M3.bind(null,r,n.getNumberFormat),formatRelativeTime:N3.bind(null,r,n.getRelativeTimeFormat),formatDate:v3.bind(null,r,n.getDateTimeFormat),formatDateToParts:E3.bind(null,r,n.getDateTimeFormat),formatTime:y3.bind(null,r,n.getDateTimeFormat),formatDateTimeRange:w3.bind(null,r,n.getDateTimeFormat),formatTimeToParts:I3.bind(null,r,n.getDateTimeFormat),formatPlural:P3.bind(null,r,n.getPluralRules),formatMessage:Ay.bind(null,r,n),$t:Ay.bind(null,r,n),formatList:b3.bind(null,r,n.getListFormat),formatListToParts:UP.bind(null,r,n.getListFormat),formatDisplayName:T3.bind(null,r,n.getDisplayNames)})}function zP(t){vP(t,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var $P=Ve(Ve({},VP),{textComponent:G.Fragment});function B3(t){return function(e){return t(G.Children.toArray(e))}}function Py(t,e){if(t===e)return!0;if(!t||!e)return!1;var n=Object.keys(t),r=Object.keys(e),i=n.length;if(r.length!==i)return!1;for(var s=0;s<i;s++){var a=n[s];if(t[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}var jw=typeof window<"u"&&!window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=G.createContext(null)):G.createContext(null);jw.Consumer;var U3=jw.Provider,j3=U3,z3=jw;function en(){var t=G.useContext(z3);return zP(t),t}var Ry;(function(t){t.formatDate="FormattedDate",t.formatTime="FormattedTime",t.formatNumber="FormattedNumber",t.formatList="FormattedList",t.formatDisplayName="FormattedDisplayName"})(Ry||(Ry={}));var ky;(function(t){t.formatDate="FormattedDateParts",t.formatTime="FormattedTimeParts",t.formatNumber="FormattedNumberParts",t.formatList="FormattedListParts"})(ky||(ky={}));function HP(t){var e=function(n){var r=en(),i=n.value,s=n.children,a=Os(n,["value","children"]),l=typeof i=="string"?new Date(i||0):i,h=t==="formatDate"?r.formatDateToParts(l,a):r.formatTimeToParts(l,a);return s(h)};return e.displayName=ky[t],e}function ud(t){var e=function(n){var r=en(),i=n.value,s=n.children,a=Os(n,["value","children"]),l=r[t](i,a);if(typeof s=="function")return s(l);var h=r.textComponent||G.Fragment;return G.createElement(h,null,l)};return e.displayName=Ry[t],e}function A_(t){return{locale:t.locale,timeZone:t.timeZone,fallbackOnEmptyString:t.fallbackOnEmptyString,formats:t.formats,textComponent:t.textComponent,messages:t.messages,defaultLocale:t.defaultLocale,defaultFormats:t.defaultFormats,onError:t.onError,onWarn:t.onWarn,wrapRichTextChunksInFragment:t.wrapRichTextChunksInFragment,defaultRichTextElements:t.defaultRichTextElements}}function qP(t){return t&&Object.keys(t).reduce(function(e,n){var r=t[n];return e[n]=MP(r)?B3(r):r,e},{})}var WT=function(t,e,n,r){for(var i=[],s=4;s<arguments.length;s++)i[s-4]=arguments[s];var a=qP(r),l=Ay.apply(void 0,Fi([t,e,n,a],i,!1));return Array.isArray(l)?G.Children.toArray(l):l},KT=function(t,e){var n=t.defaultRichTextElements,r=Os(t,["defaultRichTextElements"]),i=qP(n),s=F3(Ve(Ve(Ve({},$P),r),{defaultRichTextElements:i}),e),a={locale:s.locale,timeZone:s.timeZone,fallbackOnEmptyString:s.fallbackOnEmptyString,formats:s.formats,defaultLocale:s.defaultLocale,defaultFormats:s.defaultFormats,messages:s.messages,onError:s.onError,defaultRichTextElements:i};return Ve(Ve({},s),{formatMessage:WT.bind(null,a,s.formatters),$t:WT.bind(null,a,s.formatters)})},$3=function(t){li(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.cache=FP(),n.state={cache:n.cache,intl:KT(A_(n.props),n.cache),prevConfig:A_(n.props)},n}return e.getDerivedStateFromProps=function(n,r){var i=r.prevConfig,s=r.cache,a=A_(n);return Py(i,a)?null:{intl:KT(a,s),prevConfig:a}},e.prototype.render=function(){return zP(this.state.intl),G.createElement(j3,{value:this.state.intl},this.props.children)},e.displayName="IntlProvider",e.defaultProps=$P,e}(G.PureComponent);const H3=$3;function q3(t,e){var n=t.values,r=Os(t,["values"]),i=e.values,s=Os(e,["values"]);return Py(i,n)&&Py(r,s)}function GP(t){var e=en(),n=e.formatMessage,r=e.textComponent,i=r===void 0?G.Fragment:r,s=t.id,a=t.description,l=t.defaultMessage,h=t.values,g=t.children,m=t.tagName,v=m===void 0?i:m,I=t.ignoreTag,S={id:s,description:a,defaultMessage:l},j=n(S,h,{ignoreTag:I});return typeof g=="function"?g(Array.isArray(j)?j:[j]):v?G.createElement(v,null,G.Children.toArray(j)):G.createElement(G.Fragment,null,j)}GP.displayName="FormattedMessage";var WP=G.memo(GP,q3);WP.displayName="MemoizedFormattedMessage";const Et=WP;ud("formatDate");ud("formatTime");ud("formatNumber");ud("formatList");ud("formatDisplayName");HP("formatDate");HP("formatTime");const fe=nd("div",({css:t,...e})=>({css:dF({display:"flex",minWidth:0,minHeight:0,flex:"none",alignSelf:"auto",alignItems:"stretch",flexDirection:"column",justifyContent:"flex-start",...t}),...e})),KP=t=>{const e=G.useContext(ki);return R.jsxs(fe,{as:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 467.27 512",...t,children:[R.jsx("polygon",{fill:e.colors.shape,points:"352.33 159.67 432.16 239.45 432.16 399.13 319.29 512 93.55 512 159.67 445.87 0 286.25 319.29 286.25 272.55 239.45 272.55 79.84 352.33 0 465.26 112.87 352.33 112.87 352.33 159.67"}),R.jsxs("g",{children:[R.jsx("polygon",{fill:e.colors.pieces.mt1,points:"272.57 79.84 272.57 239.45 352.36 319.29 432.19 399.13 432.19 239.45 352.36 159.67 352.36 112.87 465.29 112.87 352.36 0 272.57 79.84"}),R.jsx("polygon",{fill:e.colors.pieces.st1,points:"93.58 512 319.32 512 432.19 399.13 319.32 286.25 93.58 512"}),R.jsx("polygon",{fill:e.colors.pieces.lt2,points:"159.67 445.87 239.48 366.05 319.31 286.24 0.03 286.24 159.67 445.87"})]})]})};var QT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},G3=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],l=t[n++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},YP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,l=a?t[i+1]:0,h=i+2<t.length,g=h?t[i+2]:0,m=s>>2,v=(s&3)<<4|l>>4;let I=(l&15)<<2|g>>6,S=g&63;h||(S=64,a||(I=64)),r.push(n[m],n[v],n[I],n[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(QP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):G3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const g=i<t.length?n[t.charAt(i)]:64;++i;const v=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||g==null||v==null)throw new W3;const I=s<<2|l>>4;if(r.push(I),g!==64){const S=l<<4&240|g>>2;if(r.push(S),v!==64){const j=g<<6&192|v;r.push(j)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class W3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K3=function(t){const e=QP(t);return YP.encodeByteArray(e,!0)},Ng=function(t){return K3(t).replace(/\./g,"")},XP=function(t){try{return YP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Dg(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Q3(n)||(t[n]=Dg(t[n],e[n]));return t}function Q3(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3=()=>Y3().__FIREBASE_DEFAULTS__,J3=()=>{if(typeof process>"u"||typeof QT>"u")return;const t=QT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Z3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&XP(t[1]);return e&&JSON.parse(e)},zw=()=>{try{return X3()||J3()||Z3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},JP=()=>{var t;return(t=zw())===null||t===void 0?void 0:t.config},eB=t=>{var e;return(e=zw())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tB=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Ng(JSON.stringify(n)),Ng(JSON.stringify(a)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zt())}function $w(){var t;const e=(t=zw())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iB(){return typeof self=="object"&&self.self===self}function ZP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Hw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eR(){const t=Zt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function sB(){return!$w()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Eh(){try{return typeof indexedDB=="object"}catch{return!1}}function oB(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aB="FirebaseError";class gr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=aB,Object.setPrototypeOf(this,gr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nu.prototype.create)}}class nu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?uB(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new gr(i,l,r)}}function uB(t,e){return t.replace(lB,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const lB=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function cB(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ny(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(XT(s)&&XT(a)){if(!Ny(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function XT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ju(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Cc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function tR(t,e){const n=new hB(t,e);return n.subscribe.bind(n)}class hB{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");dB(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=P_),i.error===void 0&&(i.error=P_),i.complete===void 0&&(i.complete=P_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dB(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function P_(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(t){return t&&t._delegate?t._delegate:t}class rs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new tB;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pB(e))try{this.getOrInitializeService({instanceIdentifier:aa})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=aa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=aa){return this.instances.has(e)}getOptions(e=aa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gB(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=aa){return this.component?this.component.multipleInstances?e:aa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gB(t){return t===aa?void 0:t}function pB(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new fB(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=[];var ot;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ot||(ot={}));const nR={debug:ot.DEBUG,verbose:ot.VERBOSE,info:ot.INFO,warn:ot.WARN,error:ot.ERROR,silent:ot.SILENT},_B=ot.INFO,vB={[ot.DEBUG]:"log",[ot.VERBOSE]:"log",[ot.INFO]:"info",[ot.WARN]:"warn",[ot.ERROR]:"error"},yB=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=vB[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zp{constructor(e){this.name=e,this._logLevel=_B,this._logHandler=yB,this._userLogHandler=null,qw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ot))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ot.DEBUG,...e),this._logHandler(this,ot.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ot.VERBOSE,...e),this._logHandler(this,ot.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ot.INFO,...e),this._logHandler(this,ot.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ot.WARN,...e),this._logHandler(this,ot.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ot.ERROR,...e),this._logHandler(this,ot.ERROR,...e)}}function wB(t){qw.forEach(e=>{e.setLogLevel(t)})}function EB(t,e){for(const n of qw){let r=null;e&&e.level&&(r=nR[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&t({level:ot[s].toLowerCase(),message:l,args:a,type:i.name})}}}const IB=(t,e)=>e.some(n=>t instanceof n);let JT,ZT;function SB(){return JT||(JT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TB(){return ZT||(ZT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rR=new WeakMap,Dy=new WeakMap,iR=new WeakMap,R_=new WeakMap,Gw=new WeakMap;function xB(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(Io(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&rR.set(n,t)}).catch(()=>{}),Gw.set(e,t),e}function CB(t){if(Dy.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Dy.set(t,e)}let Oy={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dy.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iR.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Io(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bB(t){Oy=t(Oy)}function AB(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(k_(this),e,...n);return iR.set(r,e.sort?e.sort():[e]),Io(r)}:TB().includes(t)?function(...e){return t.apply(k_(this),e),Io(rR.get(this))}:function(...e){return Io(t.apply(k_(this),e))}}function PB(t){return typeof t=="function"?AB(t):(t instanceof IDBTransaction&&CB(t),IB(t,SB())?new Proxy(t,Oy):t)}function Io(t){if(t instanceof IDBRequest)return xB(t);if(R_.has(t))return R_.get(t);const e=PB(t);return e!==t&&(R_.set(t,e),Gw.set(e,t)),e}const k_=t=>Gw.get(t);function RB(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),l=Io(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Io(a.result),h.oldVersion,h.newVersion,Io(a.transaction),h)}),n&&a.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),l}const kB=["get","getKey","getAll","getAllKeys","count"],NB=["put","add","delete","clear"],N_=new Map;function e1(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(N_.get(e))return N_.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=NB.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||kB.includes(n)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(l.shift())),(await Promise.all([g[n](...l),i&&h.done]))[0]};return N_.set(e,s),s}bB(t=>({...t,get:(e,n,r)=>e1(e,n)||t.get(e,n,r),has:(e,n)=>!!e1(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(OB(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function OB(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const My="@firebase/app",t1="0.9.24";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa=new Zp("@firebase/app"),MB="@firebase/app-compat",LB="@firebase/analytics-compat",VB="@firebase/analytics",FB="@firebase/app-check-compat",BB="@firebase/app-check",UB="@firebase/auth",jB="@firebase/auth-compat",zB="@firebase/database",$B="@firebase/database-compat",HB="@firebase/functions",qB="@firebase/functions-compat",GB="@firebase/installations",WB="@firebase/installations-compat",KB="@firebase/messaging",QB="@firebase/messaging-compat",YB="@firebase/performance",XB="@firebase/performance-compat",JB="@firebase/remote-config",ZB="@firebase/remote-config-compat",eU="@firebase/storage",tU="@firebase/storage-compat",nU="@firebase/firestore",rU="@firebase/firestore-compat",iU="firebase",sU="10.7.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao="[DEFAULT]",oU={[My]:"fire-core",[MB]:"fire-core-compat",[VB]:"fire-analytics",[LB]:"fire-analytics-compat",[BB]:"fire-app-check",[FB]:"fire-app-check-compat",[UB]:"fire-auth",[jB]:"fire-auth-compat",[zB]:"fire-rtdb",[$B]:"fire-rtdb-compat",[HB]:"fire-fn",[qB]:"fire-fn-compat",[GB]:"fire-iid",[WB]:"fire-iid-compat",[KB]:"fire-fcm",[QB]:"fire-fcm-compat",[YB]:"fire-perf",[XB]:"fire-perf-compat",[JB]:"fire-rc",[ZB]:"fire-rc-compat",[eU]:"fire-gcs",[tU]:"fire-gcs-compat",[nU]:"fire-fst",[rU]:"fire-fst-compat","fire-js":"fire-js",[iU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=new Map,Ih=new Map;function Og(t,e){try{t.container.addComponent(e)}catch(n){Fa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function sR(t,e){t.container.addOrOverwriteComponent(e)}function Ro(t){const e=t.name;if(Ih.has(e))return Fa.debug(`There were multiple attempts to register component ${e}.`),!1;Ih.set(e,t);for(const n of Po.values())Og(n,t);return!0}function oR(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function aU(t,e,n=Ao){oR(t,e).clearInstance(n)}function uU(){Ih.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},As=new nu("app","Firebase",lU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cU=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new rs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw As.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=sU;function Ww(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Ao,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw As.create("bad-app-name",{appName:String(i)});if(n||(n=JP()),!n)throw As.create("no-options");const s=Po.get(i);if(s){if(Ny(n,s.options)&&Ny(r,s.config))return s;throw As.create("duplicate-app",{appName:i})}const a=new mB(i);for(const h of Ih.values())a.addComponent(h);const l=new cU(n,r,a);return Po.set(i,l),l}function hU(t=Ao){const e=Po.get(t);if(!e&&t===Ao&&JP())return Ww();if(!e)throw As.create("no-app",{appName:t});return e}function dU(){return Array.from(Po.values())}async function aR(t){const e=t.name;Po.has(e)&&(Po.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function es(t,e,n){var r;let i=(r=oU[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fa.warn(l.join(" "));return}Ro(new rs(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function uR(t,e){if(t!==null&&typeof t!="function")throw As.create("invalid-log-argument");EB(t,e)}function lR(t){wB(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU="firebase-heartbeat-database",gU=1,Sh="firebase-heartbeat-store";let D_=null;function cR(){return D_||(D_=RB(fU,gU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Sh)}}}).catch(t=>{throw As.create("idb-open",{originalErrorMessage:t.message})})),D_}async function pU(t){try{return await(await cR()).transaction(Sh).objectStore(Sh).get(hR(t))}catch(e){if(e instanceof gr)Fa.warn(e.message);else{const n=As.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fa.warn(n.message)}}}async function n1(t,e){try{const r=(await cR()).transaction(Sh,"readwrite");await r.objectStore(Sh).put(e,hR(t)),await r.done}catch(n){if(n instanceof gr)Fa.warn(n.message);else{const r=As.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Fa.warn(r.message)}}}function hR(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mU=1024,_U=30*24*60*60*1e3;class vU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new wU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=r1();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=_U}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=r1(),{heartbeatsToSend:r,unsentEntries:i}=yU(this._heartbeatsCache.heartbeats),s=Ng(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function r1(){return new Date().toISOString().substring(0,10)}function yU(t,e=mU){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),i1(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),i1(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class wU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Eh()?oB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await pU(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return n1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return n1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function i1(t){return Ng(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EU(t){Ro(new rs("platform-logger",e=>new DB(e),"PRIVATE")),Ro(new rs("heartbeat",e=>new vU(e),"PRIVATE")),es(My,t1,t),es(My,t1,"esm2017"),es("fire-js","")}EU("");const IU=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:gr,SDK_VERSION:qo,_DEFAULT_ENTRY_NAME:Ao,_addComponent:Og,_addOrOverwriteComponent:sR,_apps:Po,_clearComponents:uU,_components:Ih,_getProvider:oR,_registerComponent:Ro,_removeServiceInstance:aU,deleteApp:aR,getApp:hU,getApps:dU,initializeApp:Ww,onLog:uR,registerVersion:es,setLogLevel:lR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e,n){this._delegate=e,this.firebase=n,Og(e,new rs("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),aR(this._delegate)))}_getService(e,n=Ao){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=Ao){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Og(this._delegate,e)}_addOrOverwriteComponent(e){sR(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},s1=new nu("app-compat","Firebase",TU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xU(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:es,setLogLevel:lR,onLog:uR,apps:null,SDK_VERSION:qo,INTERNAL:{registerComponent:l,removeApp:r,useAsService:h,modularAPIs:IU}};n.default=n,Object.defineProperty(n,"apps",{get:a});function r(g){delete e[g]}function i(g){if(g=g||Ao,!YT(e,g))throw s1.create("no-app",{appName:g});return e[g]}i.App=t;function s(g,m={}){const v=Ww(g,m);if(YT(e,v.name))return e[v.name];const I=new t(v,n);return e[v.name]=I,I}function a(){return Object.keys(e).map(g=>e[g])}function l(g){const m=g.name,v=m.replace("-compat","");if(Ro(g)&&g.type==="PUBLIC"){const I=(S=i())=>{if(typeof S[v]!="function")throw s1.create("invalid-app-argument",{appName:m});return S[v]()};g.serviceProps!==void 0&&Dg(I,g.serviceProps),n[v]=I,t.prototype[v]=function(...S){return this._getService.bind(this,m).apply(this,g.multipleInstances?S:[])}}return g.type==="PUBLIC"?n[v]:null}function h(g,m){return m==="serverAuth"?null:m}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dR(){const t=xU(SU);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:dR,extendNamespace:e,createSubscribe:tR,ErrorFactory:nu,deepExtend:Dg});function e(n){Dg(t,n)}return t}const CU=dR();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1=new Zp("@firebase/app-compat"),bU="@firebase/app-compat",AU="0.2.24";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(t){es(bU,AU,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(iB()&&self.firebase!==void 0){o1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&o1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Ot=CU;PU();var RU="firebase",kU="10.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ot.registerVersion(RU,kU,"app-compat");const ac={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},fu={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NU(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function fR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const DU=NU,OU=fR,gR=new nu("auth","Firebase",fR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg=new Zp("@firebase/auth");function MU(t,...e){Mg.logLevel<=ot.WARN&&Mg.warn(`Auth (${qo}): ${t}`,...e)}function zf(t,...e){Mg.logLevel<=ot.ERROR&&Mg.error(`Auth (${qo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(t,...e){throw Kw(t,...e)}function zn(t,...e){return Kw(t,...e)}function pR(t,e,n){const r=Object.assign(Object.assign({},OU()),{[e]:n});return new nu("auth","Firebase",r).create(e,{appName:t.name})}function Vl(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&qn(t,"argument-error"),pR(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kw(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return gR.create(t,...e)}function Ie(t,e,...n){if(!t)throw Kw(e,...n)}function Gi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zf(e),new Error(e)}function Ai(t,e){t||Gi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Qw(){return a1()==="http:"||a1()==="https:"}function a1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Qw()||ZP()||"connection"in navigator)?navigator.onLine:!0}function VU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ai(n>e,"Short delay should be less than long delay!"),this.isMobile=rB()||Hw()}get(){return LU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t,e){Ai(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BU=new ld(3e4,6e4);function an(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function un(t,e,n,r,i={}){return _R(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=Ll(Object.assign({key:t.config.apiKey},a)).slice(1),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode),mR.fetch()(vR(t,t.config.apiHost,n,l),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function _R(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},FU),e);try{const i=new jU(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw bc(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[h,g]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw bc(t,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw bc(t,"email-already-in-use",a);if(h==="USER_DISABLED")throw bc(t,"user-disabled",a);const m=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw pR(t,m,g);qn(t,m)}}catch(i){if(i instanceof gr)throw i;qn(t,"network-request-failed",{message:String(i)})}}async function Bs(t,e,n,r,i={}){const s=await un(t,e,n,r,i);return"mfaPendingCredential"in s&&qn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function vR(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Yw(t.config,i):`${t.config.apiScheme}://${i}`}function UU(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jU{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(zn(this.auth,"network-request-failed")),BU.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function bc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=zn(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(t){return t!==void 0&&t.getResponse!==void 0}function l1(t){return t!==void 0&&t.enterprise!==void 0}class zU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return UU(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $U(t){return(await un(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function HU(t,e){return un(t,"GET","/v2/recaptchaConfig",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qU(t,e){return un(t,"POST","/v1/accounts:delete",e)}async function GU(t,e){return un(t,"POST","/v1/accounts:update",e)}async function WU(t,e){return un(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function KU(t,e=!1){const n=We(t),r=await n.getIdToken(e),i=em(r);Ie(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:qc(O_(i.auth_time)),issuedAtTime:qc(O_(i.iat)),expirationTime:qc(O_(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function O_(t){return Number(t)*1e3}function em(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return zf("JWT malformed, contained fewer than 3 sections"),null;try{const i=XP(n);return i?JSON.parse(i):(zf("Failed to decode base64 JWT payload"),null)}catch(i){return zf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function QU(t){const e=em(t);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ms(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof gr&&YU(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function YU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=qc(this.lastLoginAt),this.creationTime=qc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ms(t,WU(n,{idToken:r}));Ie(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?ej(s.providerUserInfo):[],l=ZU(t.providerData,a),h=t.isAnonymous,g=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),m=h?g:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new yR(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(t,v)}async function JU(t){const e=We(t);await xh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZU(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function ej(t){return t.map(e=>{var{providerId:n}=e,r=Os(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tj(t,e){const n=await _R(t,{},async()=>{const r=Ll({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=vR(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",mR.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nj(t,e){return un(t,"POST","/v2/accounts:revokeToken",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):QU(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return Ie(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await tj(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new Ch;return r&&(Ie(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ie(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ie(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ch,this.toJSON())}_performRefresh(){return Gi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(t,e){Ie(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ca{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Os(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new XU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new yR(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ms(this,this.stsTokenManager.getToken(this.auth,e));return Ie(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return KU(this,e)}reload(){return JU(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ca(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await xh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ms(this,qU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,a,l,h,g,m;const v=(r=n.displayName)!==null&&r!==void 0?r:void 0,I=(i=n.email)!==null&&i!==void 0?i:void 0,S=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,j=(a=n.photoURL)!==null&&a!==void 0?a:void 0,z=(l=n.tenantId)!==null&&l!==void 0?l:void 0,J=(h=n._redirectEventId)!==null&&h!==void 0?h:void 0,V=(g=n.createdAt)!==null&&g!==void 0?g:void 0,B=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:U,emailVerified:Z,isAnonymous:ne,providerData:te,stsTokenManager:oe}=n;Ie(U&&oe,e,"internal-error");const ce=Ch.fromJSON(this.name,oe);Ie(typeof U=="string",e,"internal-error"),Ws(v,e.name),Ws(I,e.name),Ie(typeof Z=="boolean",e,"internal-error"),Ie(typeof ne=="boolean",e,"internal-error"),Ws(S,e.name),Ws(j,e.name),Ws(z,e.name),Ws(J,e.name),Ws(V,e.name),Ws(B,e.name);const _e=new Ca({uid:U,auth:e,email:I,emailVerified:Z,displayName:v,isAnonymous:ne,photoURL:j,phoneNumber:S,tenantId:z,stsTokenManager:ce,createdAt:V,lastLoginAt:B});return te&&Array.isArray(te)&&(_e.providerData=te.map(pe=>Object.assign({},pe))),J&&(_e._redirectEventId=J),_e}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ch;i.updateFromServerResponse(n);const s=new Ca({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await xh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=new Map;function $r(t){Ai(t instanceof Function,"Expected a class definition");let e=c1.get(t);return e?(Ai(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,c1.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}wR.type="NONE";const ml=wR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(t,e,n){return`firebase:${t}:${e}:${n}`}class Xu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=ba(this.userKey,i.apiKey,s),this.fullPersistenceKey=ba("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ca._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Xu($r(ml),e,r);const i=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let s=i[0]||$r(ml);const a=ba(r,e.config.apiKey,e.name);let l=null;for(const g of n)try{const m=await g._get(a);if(m){const v=Ca._fromJSON(e,m);g!==s&&(l=v),s=g;break}}catch{}const h=i.filter(g=>g._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Xu(s,e,r):(s=h[0],l&&await s._set(a,l.toJSON()),await Promise.all(n.map(async g=>{if(g!==s)try{await g._remove(a)}catch{}})),new Xu(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(SR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ER(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TR(e))return"Blackberry";if(xR(e))return"Webos";if(Xw(e))return"Safari";if((e.includes("chrome/")||IR(e))&&!e.includes("edge/"))return"Chrome";if(cd(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ER(t=Zt()){return/firefox\//i.test(t)}function Xw(t=Zt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IR(t=Zt()){return/crios\//i.test(t)}function SR(t=Zt()){return/iemobile/i.test(t)}function cd(t=Zt()){return/android/i.test(t)}function TR(t=Zt()){return/blackberry/i.test(t)}function xR(t=Zt()){return/webos/i.test(t)}function Fl(t=Zt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rj(t=Zt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function ij(t=Zt()){var e;return Fl(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function sj(){return eR()&&document.documentMode===10}function CR(t=Zt()){return Fl(t)||cd(t)||xR(t)||TR(t)||/windows phone/i.test(t)||SR(t)}function oj(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(t,e=[]){let n;switch(t){case"Browser":n=h1(Zt());break;case"Worker":n=`${h1(Zt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${qo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,l)=>{try{const h=e(s);a(h)}catch(h){l(h)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uj(t,e={}){return un(t,"GET","/v2/passwordPolicy",an(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=6;class cj{constructor(e){var n,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:lj,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,a,l;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(n=h.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new d1(this),this.idTokenSubscription=new d1(this),this.beforeStateQueue=new aj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$r(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Xu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===l)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await xh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?We(e):null;return n&&Ie(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uj(this),n=new cj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new nu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await nj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$r(e)||this._popupRedirectResolver;Ie(n,this,"argument-error"),this.redirectPersistenceManager=await Xu.create(this,[$r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const h=e.addObserver(n,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(n);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&MU(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function rn(t){return We(t)}class d1{constructor(e){this.auth=e,this.observer=null,this.addObserver=tR(n=>this.observer=n)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function Jw(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=zn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",dj().appendChild(r)})}function AR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const fj="https://www.google.com/recaptcha/enterprise.js?render=",gj="recaptcha-enterprise",pj="NO_RECAPTCHA";class mj{constructor(e){this.type=gj,this.auth=rn(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{HU(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const g=new zU(h);return s.tenantId==null?s._agentRecaptchaConfig=g:s._tenantRecaptchaConfigs[s.tenantId]=g,a(g.siteKey)}}).catch(h=>{l(h)})})}function i(s,a,l){const h=window.grecaptcha;l1(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(g=>{a(g)}).catch(()=>{a(pj)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!n&&l1(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}Jw(fj+l).then(()=>{i(l,s,a)}).catch(h=>{a(h)})}}).catch(l=>{a(l)})})}}async function f1(t,e,n,r=!1){const i=new mj(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function bh(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await f1(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await f1(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(s)})}function _j(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map($r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function vj(t,e,n){const r=rn(t);Ie(r._canInitEmulator,r,"emulator-config-failed"),Ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=PR(e),{host:a,port:l}=yj(e),h=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||wj()}function PR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function yj(t){const e=PR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:g1(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:g1(a)}}}function g1(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function wj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gi("not implemented")}_getIdTokenResponse(e){return Gi("not implemented")}_linkToIdToken(e,n){return Gi("not implemented")}_getReauthenticationResolver(e){return Gi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RR(t,e){return un(t,"POST","/v1/accounts:resetPassword",an(t,e))}async function Ej(t,e){return un(t,"POST","/v1/accounts:update",e)}async function Ij(t,e){return un(t,"POST","/v1/accounts:signUp",e)}async function Sj(t,e){return un(t,"POST","/v1/accounts:update",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tj(t,e){return Bs(t,"POST","/v1/accounts:signInWithPassword",an(t,e))}async function tm(t,e){return un(t,"POST","/v1/accounts:sendOobCode",an(t,e))}async function xj(t,e){return tm(t,e)}async function Cj(t,e){return tm(t,e)}async function bj(t,e){return tm(t,e)}async function Aj(t,e){return tm(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pj(t,e){return Bs(t,"POST","/v1/accounts:signInWithEmailLink",an(t,e))}async function Rj(t,e){return Bs(t,"POST","/v1/accounts:signInWithEmailLink",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah extends Bl{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Ah(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ah(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return bh(e,n,"signInWithPassword",Tj);case"emailLink":return Pj(e,{email:this._email,oobCode:this._password});default:qn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return bh(e,r,"signUpPassword",Ij);case"emailLink":return Rj(e,{idToken:n,email:this._email,oobCode:this._password});default:qn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ps(t,e){return Bs(t,"POST","/v1/accounts:signInWithIdp",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kj="http://localhost";class is extends Bl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new is(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):qn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Os(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new is(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Ps(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ps(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ps(e,n)}buildRequest(){const e={requestUri:kj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ll(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nj(t,e){return un(t,"POST","/v1/accounts:sendVerificationCode",an(t,e))}async function Dj(t,e){return Bs(t,"POST","/v1/accounts:signInWithPhoneNumber",an(t,e))}async function Oj(t,e){const n=await Bs(t,"POST","/v1/accounts:signInWithPhoneNumber",an(t,e));if(n.temporaryProof)throw bc(t,"account-exists-with-different-credential",n);return n}const Mj={USER_NOT_FOUND:"user-not-found"};async function Lj(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Bs(t,"POST","/v1/accounts:signInWithPhoneNumber",an(t,n),Mj)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends Bl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Aa({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Aa({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return Dj(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return Oj(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Lj(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Aa({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Fj(t){const e=ju(Cc(t)).link,n=e?ju(Cc(e)).deep_link_id:null,r=ju(Cc(t)).deep_link_id;return(r?ju(Cc(r)).link:null)||r||n||e||t}class nm{constructor(e){var n,r,i,s,a,l;const h=ju(Cc(e)),g=(n=h.apiKey)!==null&&n!==void 0?n:null,m=(r=h.oobCode)!==null&&r!==void 0?r:null,v=Vj((i=h.mode)!==null&&i!==void 0?i:null);Ie(g&&m&&v,"argument-error"),this.apiKey=g,this.operation=v,this.code=m,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=h.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=Fj(e);try{return new nm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.providerId=Go.PROVIDER_ID}static credential(e,n){return Ah._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=nm.parseLink(n);return Ie(r,"argument-error"),Ah._fromEmailAndCode(e,r.code,r.tenantId)}}Go.PROVIDER_ID="password";Go.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Go.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul extends Us{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ju extends Ul{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return Ie("providerId"in n&&"signInMethod"in n,"argument-error"),is._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Ie(e.idToken||e.accessToken,"argument-error"),is._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ju.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ju.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:l}=e;if(!r&&!i&&!n&&!s||!l)return null;try{return new Ju(l)._credential({idToken:n,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends Ul{constructor(){super("facebook.com")}static credential(e){return is._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ji.credential(e.oauthAccessToken)}catch{return null}}}ji.FACEBOOK_SIGN_IN_METHOD="facebook.com";ji.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends Ul{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return is._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return zi.credential(n,r)}catch{return null}}}zi.GOOGLE_SIGN_IN_METHOD="google.com";zi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends Ul{constructor(){super("github.com")}static credential(e){return is._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.GITHUB_SIGN_IN_METHOD="github.com";$i.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="http://localhost";class _l extends Bl{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Ps(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ps(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ps(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new _l(r,s)}static _create(e,n){return new _l(e,n)}buildRequest(){return{requestUri:Bj,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj="saml.";class Lg extends Us{constructor(e){Ie(e.startsWith(Uj),"argument-error"),super(e)}static credentialFromResult(e){return Lg.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Lg.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=_l.fromJSON(e);return Ie(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return _l._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Ul{constructor(){super("twitter.com")}static credential(e,n){return is._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Hi.credential(n,r)}catch{return null}}}Hi.TWITTER_SIGN_IN_METHOD="twitter.com";Hi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kR(t,e){return Bs(t,"POST","/v1/accounts:signUp",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ca._fromIdTokenResponse(e,r,i),a=p1(r);return new ui({user:s,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=p1(r);return new ui({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function p1(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jj(t){var e;const n=rn(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new ui({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await kR(n,{returnSecureToken:!0}),i=await ui._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg extends gr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Vg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Vg(e,n,r,i)}}function NR(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Vg._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zj(t,e){const n=We(t);await rm(!0,n,e);const{providerUserInfo:r}=await GU(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=DR(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Zw(t,e,n=!1){const r=await Ms(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ui._forOperation(t,"link",r)}async function rm(t,e,n){await xh(e);const r=DR(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";Ie(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OR(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const s=await Ms(t,NR(r,i,e,t),n);Ie(s.idToken,r,"internal-error");const a=em(s.idToken);Ie(a,r,"internal-error");const{sub:l}=a;return Ie(t.uid===l,r,"user-mismatch"),ui._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&qn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MR(t,e,n=!1){const r="signIn",i=await NR(t,r,e),s=await ui._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function im(t,e){return MR(rn(t),e)}async function LR(t,e){const n=We(t);return await rm(!1,n,e.providerId),Zw(n,e)}async function VR(t,e){return OR(We(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $j(t,e){return Bs(t,"POST","/v1/accounts:signInWithCustomToken",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hj(t,e){const n=rn(t),r=await $j(n,{token:e,returnSecureToken:!0}),i=await ui._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?eE._fromServerResponse(e,n):"totpInfo"in n?tE._fromServerResponse(e,n):qn(e,"internal-error")}}class eE extends hd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new eE(n)}}class tE extends hd{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new tE(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(t,e,n){var r;Ie(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),Ie(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Ie(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(Ie(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nE(t){const e=rn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function qj(t,e,n){const r=rn(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&sm(r,i,n),await bh(r,i,"getOobCode",Cj)}async function Gj(t,e,n){await RR(We(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nE(t),r})}async function Wj(t,e){await Sj(We(t),{oobCode:e})}async function FR(t,e){const n=We(t),r=await RR(n,{oobCode:e}),i=r.requestType;switch(Ie(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ie(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ie(r.mfaInfo,n,"internal-error");default:Ie(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=hd._fromServerResponse(rn(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Kj(t,e){const{data:n}=await FR(We(t),e);return n.email}async function Qj(t,e,n){const r=rn(t),a=await bh(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kR).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&nE(t),h}),l=await ui._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function Yj(t,e,n){return im(We(t),Go.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nE(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xj(t,e,n){const r=rn(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,l){Ie(l.handleCodeInApp,r,"argument-error"),l&&sm(r,a,l)}s(i,n),await bh(r,i,"getOobCode",bj)}function Jj(t,e){const n=nm.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function Zj(t,e,n){const r=We(t),i=Go.credentialWithLink(e,n||Th());return Ie(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),im(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e6(t,e){return un(t,"POST","/v1/accounts:createAuthUri",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t6(t,e){const n=Qw()?Th():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await e6(We(t),r);return i||[]}async function n6(t,e){const n=We(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&sm(n.auth,i,e);const{email:s}=await xj(n.auth,i);s!==t.email&&await t.reload()}async function r6(t,e,n){const r=We(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&sm(r.auth,s,n);const{email:a}=await Aj(r.auth,s);a!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i6(t,e){return un(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=We(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await Ms(r,i6(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:h})=>h==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function o6(t,e){return BR(We(t),e,null)}function a6(t,e){return BR(We(t),null,e)}async function BR(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const a=await Ms(t,Ej(r,s));await t._updateTokensIfNecessary(a,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const a=(n=(e=em(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Zu(s,l)}}if(!r)return null;switch(r){case"facebook.com":return new l6(s,i);case"github.com":return new c6(s,i);case"google.com":return new h6(s,i);case"twitter.com":return new d6(s,i,t.screenName||null);case"custom":case"anonymous":return new Zu(s,null);default:return new Zu(s,r,i)}}class Zu{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class UR extends Zu{constructor(e,n,r,i){super(e,n,r),this.username=i}}class l6 extends Zu{constructor(e,n){super(e,"facebook.com",n)}}class c6 extends UR{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class h6 extends Zu{constructor(e,n){super(e,"google.com",n)}}class d6 extends UR{constructor(e,n,r){super(e,"twitter.com",n,r)}}function f6(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:u6(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new va("enroll",e,n)}static _fromMfaPendingCredential(e){return new va("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return va._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return va._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=rn(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>hd._fromServerResponse(r,l));Ie(i.mfaPendingCredential,r,"internal-error");const a=va._fromMfaPendingCredential(i.mfaPendingCredential);return new rE(a,s,async l=>{const h=await l._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const g=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(n.operationType){case"signIn":const m=await ui._fromIdTokenResponse(r,n.operationType,g);return await r._updateCurrentUser(m.user),m;case"reauthenticate":return Ie(n.user,r,"internal-error"),ui._forOperation(n.user,n.operationType,g);default:qn(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function g6(t,e){var n;const r=We(t),i=e;return Ie(e.customData.operationType,r,"argument-error"),Ie((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),rE._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p6(t,e){return un(t,"POST","/v2/accounts/mfaEnrollment:start",an(t,e))}function m6(t,e){return un(t,"POST","/v2/accounts/mfaEnrollment:finalize",an(t,e))}function _6(t,e){return un(t,"POST","/v2/accounts/mfaEnrollment:withdraw",an(t,e))}class iE{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>hd._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new iE(e)}async getSession(){return va._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await Ms(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Ms(this.user,_6(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const M_=new WeakMap;function v6(t){const e=We(t);return M_.has(e)||M_.set(e,iE._fromUser(e)),M_.get(e)}const Fg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Fg,"1"),this.storage.removeItem(Fg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y6(){const t=Zt();return Xw(t)||Fl(t)}const w6=1e3,E6=10;class zR extends jR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=y6()&&oj(),this.fallbackToPolling=CR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);sj()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,E6):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},w6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}zR.type="LOCAL";const sE=zR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R extends jR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}$R.type="SESSION";const Ba=$R;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new om(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async g=>g(n.origin,s)),h=await I6(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}om.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,h)=>{const g=dd("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(v){const I=v;if(I.data.eventId===g)switch(I.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(I.data.response);break;default:clearTimeout(m),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return window}function T6(t){_n().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(){return typeof _n().WorkerGlobalScope<"u"&&typeof _n().importScripts=="function"}async function x6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function C6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function b6(){return oE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR="firebaseLocalStorageDb",A6=1,Bg="firebaseLocalStorage",qR="fbase_key";class fd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function am(t,e){return t.transaction([Bg],e?"readwrite":"readonly").objectStore(Bg)}function P6(){const t=indexedDB.deleteDatabase(HR);return new fd(t).toPromise()}function Ly(){const t=indexedDB.open(HR,A6);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Bg,{keyPath:qR})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Bg)?e(r):(r.close(),await P6(),e(await Ly()))})})}async function m1(t,e,n){const r=am(t,!0).put({[qR]:e,value:n});return new fd(r).toPromise()}async function R6(t,e){const n=am(t,!1).get(e),r=await new fd(n).toPromise();return r===void 0?null:r.value}function _1(t,e){const n=am(t,!0).delete(e);return new fd(n).toPromise()}const k6=800,N6=3;class GR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ly(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>N6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=om._getInstance(b6()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await x6(),!this.activeServiceWorker)return;this.sender=new S6(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||C6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ly();return await m1(e,Fg,"1"),await _1(e,Fg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>m1(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>R6(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>_1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=am(i,!1).getAll();return new fd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),k6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}GR.type="LOCAL";const Ph=GR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(t,e){return un(t,"POST","/v2/accounts/mfaSignIn:start",an(t,e))}function O6(t,e){return un(t,"POST","/v2/accounts/mfaSignIn:finalize",an(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M6=500,L6=6e4,gf=1e12;class V6{constructor(e){this.auth=e,this.counter=gf,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new F6(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||gf;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||gf;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||gf;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class F6{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;Ie(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=B6(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},L6)},M6))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function B6(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_=AR("rcb"),U6=new ld(3e4,6e4),j6="https://www.google.com/recaptcha/api.js?";class z6{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=_n().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return Ie($6(n),e,"argument-error"),this.shouldResolveImmediately(n)&&u1(_n().grecaptcha)?Promise.resolve(_n().grecaptcha):new Promise((r,i)=>{const s=_n().setTimeout(()=>{i(zn(e,"network-request-failed"))},U6.get());_n()[L_]=()=>{_n().clearTimeout(s),delete _n()[L_];const l=_n().grecaptcha;if(!l||!u1(l)){i(zn(e,"internal-error"));return}const h=l.render;l.render=(g,m)=>{const v=h(g,m);return this.counter++,v},this.hostLanguage=n,r(l)};const a=`${j6}?${Ll({onload:L_,render:"explicit",hl:n})}`;Jw(a).catch(()=>{clearTimeout(s),i(zn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=_n().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function $6(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class H6{async load(e){return new V6(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="recaptcha",q6={theme:"light",type:"image"};let G6=class{constructor(e,n,r=Object.assign({},q6)){this.parameters=r,this.type=WR,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=rn(e),this.isInvisible=this.parameters.size==="invisible",Ie(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;Ie(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new H6:new z6,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Ie(!this.parameters.sitekey,this.auth,"argument-error"),Ie(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ie(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=_n()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){Ie(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Ie(Qw()&&!oE(),this.auth,"internal-error"),await W6(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await $U(this.auth);Ie(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Ie(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function W6(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Aa._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function K6(t,e,n){const r=rn(t),i=await um(r,e,We(n));return new aE(i,s=>im(r,s))}async function Q6(t,e,n){const r=We(t);await rm(!1,r,"phone");const i=await um(r.auth,e,We(n));return new aE(i,s=>LR(r,s))}async function Y6(t,e,n){const r=We(t),i=await um(r.auth,e,We(n));return new aE(i,s=>VR(r,s))}async function um(t,e,n){var r;const i=await n.verify();try{Ie(typeof i=="string",t,"argument-error"),Ie(n.type===WR,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return Ie(a.type==="enroll",t,"internal-error"),(await p6(t,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{Ie(a.type==="signin",t,"internal-error");const l=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return Ie(l,t,"missing-multi-factor-info"),(await D6(t,{mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await Nj(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{n._reset()}}async function X6(t,e){await Zw(We(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ua=class $f{constructor(e){this.providerId=$f.PROVIDER_ID,this.auth=rn(e)}verifyPhoneNumber(e,n){return um(this.auth,e,We(n))}static credential(e,n){return Aa._fromVerification(e,n)}static credentialFromResult(e){const n=e;return $f.credentialFromTaggedObject(n)}static credentialFromError(e){return $f.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Aa._fromTokenResponse(n,r):null}};Ua.PROVIDER_ID="phone";Ua.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(t,e){return e?$r(e):(Ie(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE extends Bl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ps(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ps(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ps(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function J6(t){return MR(t.auth,new uE(t),t.bypassAuthState)}function Z6(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),OR(n,new uE(t),t.bypassAuthState)}async function e9(t){const{auth:e,user:n}=t;return Ie(n,e,"internal-error"),Zw(n,new uE(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return J6;case"linkViaPopup":case"linkViaRedirect":return e9;case"reauthViaPopup":case"reauthViaRedirect":return Z6;default:qn(this.auth,"internal-error")}}resolve(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t9=new ld(2e3,1e4);async function n9(t,e,n){const r=rn(t);Vl(t,e,Us);const i=ru(r,n);return new Is(r,"signInViaPopup",e,i).executeNotNull()}async function r9(t,e,n){const r=We(t);Vl(r.auth,e,Us);const i=ru(r.auth,n);return new Is(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function i9(t,e,n){const r=We(t);Vl(r.auth,e,Us);const i=ru(r.auth,n);return new Is(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class Is extends KR{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Is.currentPopupAction&&Is.currentPopupAction.cancel(),Is.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){Ai(this.filter.length===1,"Popup operations only handle one event");const e=dd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Is.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t9.get())};e()}}Is.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9="pendingRedirect",Gc=new Map;class o9 extends KR{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Gc.get(this.auth._key());if(!e){try{const r=await a9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Gc.set(this.auth._key(),e)}return this.bypassAuthState||Gc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a9(t,e){const n=YR(e),r=QR(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function lE(t,e){return QR(t)._set(YR(e),"true")}function u9(){Gc.clear()}function cE(t,e){Gc.set(t._key(),e)}function QR(t){return $r(t._redirectPersistence)}function YR(t){return ba(s9,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l9(t,e,n){return c9(t,e,n)}async function c9(t,e,n){const r=rn(t);Vl(t,e,Us),await r._initializationPromise;const i=ru(r,n);return await lE(i,r),i._openRedirect(r,e,"signInViaRedirect")}function h9(t,e,n){return d9(t,e,n)}async function d9(t,e,n){const r=We(t);Vl(r.auth,e,Us),await r.auth._initializationPromise;const i=ru(r.auth,n);await lE(i,r.auth);const s=await XR(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function f9(t,e,n){return g9(t,e,n)}async function g9(t,e,n){const r=We(t);Vl(r.auth,e,Us),await r.auth._initializationPromise;const i=ru(r.auth,n);await rm(!1,r,e.providerId),await lE(i,r.auth);const s=await XR(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function p9(t,e){return await rn(t)._initializationPromise,lm(t,e,!1)}async function lm(t,e,n=!1){const r=rn(t),i=ru(r,e),a=await new o9(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function XR(t){const e=dd(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9=10*60*1e3;class JR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_9(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!ZR(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(zn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=m9&&this.cachedEventUids.clear(),this.cachedEventUids.has(v1(e))}saveEventToCache(e){this.cachedEventUids.add(v1(e)),this.lastProcessedEventTime=Date.now()}}function v1(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ZR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ek(t,e={}){return un(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,y9=/^https?/;async function w9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ek(t);for(const n of e)try{if(E9(n))return}catch{}qn(t,"unauthorized-domain")}function E9(t){const e=Th(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!y9.test(n))return!1;if(v9.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I9=new ld(3e4,6e4);function y1(){const t=_n().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function S9(t){return new Promise((e,n)=>{var r,i,s;function a(){y1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{y1(),n(zn(t,"network-request-failed"))},timeout:I9.get()})}if(!((i=(r=_n().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=_n().gapi)===null||s===void 0)&&s.load)a();else{const l=AR("iframefcb");return _n()[l]=()=>{gapi.load?a():n(zn(t,"network-request-failed"))},Jw(`https://apis.google.com/js/api.js?onload=${l}`).catch(h=>n(h))}}).catch(e=>{throw Hf=null,e})}let Hf=null;function T9(t){return Hf=Hf||S9(t),Hf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x9=new ld(5e3,15e3),C9="__/auth/iframe",b9="emulator/auth/iframe",A9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},P9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function R9(t){const e=t.config;Ie(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Yw(e,b9):`https://${t.config.authDomain}/${C9}`,r={apiKey:e.apiKey,appName:t.name,v:qo},i=P9.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ll(r).slice(1)}`}async function k9(t){const e=await T9(t),n=_n().gapi;return Ie(n,t,"internal-error"),e.open({where:document.body,url:R9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:A9,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=zn(t,"network-request-failed"),l=_n().setTimeout(()=>{s(a)},x9.get());function h(){_n().clearTimeout(l),i(r)}r.ping(h).then(h,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D9=500,O9=600,M9="_blank",L9="http://localhost";class w1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function V9(t,e,n,r=D9,i=O9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const h=Object.assign(Object.assign({},N9),{width:r.toString(),height:i.toString(),top:s,left:a}),g=Zt().toLowerCase();n&&(l=IR(g)?M9:n),ER(g)&&(e=e||L9,h.scrollbars="yes");const m=Object.entries(h).reduce((I,[S,j])=>`${I}${S}=${j},`,"");if(ij(g)&&l!=="_self")return F9(e||"",l),new w1(null);const v=window.open(e||"",l,m);Ie(v,t,"popup-blocked");try{v.focus()}catch{}return new w1(v)}function F9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9="__/auth/handler",U9="emulator/auth/handler",j9=encodeURIComponent("fac");async function Vy(t,e,n,r,i,s){Ie(t.config.authDomain,t,"auth-domain-config-required"),Ie(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:qo,eventId:i};if(e instanceof Us){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",cB(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,v]of Object.entries(s||{}))a[m]=v}if(e instanceof Ul){const m=e.getScopes().filter(v=>v!=="");m.length>0&&(a.scopes=m.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const h=await t._getAppCheckToken(),g=h?`#${j9}=${encodeURIComponent(h)}`:"";return`${z9(t)}?${Ll(l).slice(1)}${g}`}function z9({config:t}){return t.emulator?Yw(t,U9):`https://${t.authDomain}/${B9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_="webStorageSupport";class $9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ba,this._completeRedirectFn=lm,this._overrideRedirectResult=cE}async _openPopup(e,n,r,i){var s;Ai((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Vy(e,n,r,Th(),i);return V9(e,a,dd())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Vy(e,n,r,Th(),i);return T6(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Ai(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await k9(e),r=new JR(e);return n.register("authEvent",i=>(Ie(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(V_,{type:V_},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[V_];a!==void 0&&n(!!a),qn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=w9(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return CR()||Xw()||Fl()}}const H9=$9;class q9{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Gi("unexpected MultiFactorSessionType")}}}class hE extends q9{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new hE(e)}_finalizeEnroll(e,n,r){return m6(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return O6(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class tk{constructor(){}static assertion(e){return hE._fromCredential(e)}}tk.FACTOR_ID="phone";var E1="@firebase/auth",I1="1.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function K9(t){Ro(new rs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;Ie(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bR(t)},g=new hj(r,i,s,h);return _j(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ro(new rs("auth-internal",e=>{const n=rn(e.getProvider("auth").getImmediate());return(r=>new G9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),es(E1,I1,W9(t)),es(E1,I1,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9=5*60;eB("authIdTokenMaxAge");K9("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ja(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y9=2e3;async function X9(t,e,n){var r;const{BuildInfo:i}=ja();Ai(e.sessionId,"AuthEvent did not contain a session ID");const s=await nz(e.sessionId),a={};return Fl()?a.ibi=i.packageName:cd()?a.apn=i.packageName:qn(t,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,Vy(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function J9(t){const{BuildInfo:e}=ja(),n={};Fl()?n.iosBundleId=e.packageName:cd()?n.androidPackageName=e.packageName:qn(t,"operation-not-supported-in-this-environment"),await ek(t,n)}function Z9(t){const{cordova:e}=ja();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,rj()?"_blank":"_system","location=yes"),n(i)})})}async function ez(t,e,n){const{cordova:r}=ja();let i=()=>{};try{await new Promise((s,a)=>{let l=null;function h(){var v;s();const I=(v=r.plugins.browsertab)===null||v===void 0?void 0:v.close;typeof I=="function"&&I(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function g(){l||(l=window.setTimeout(()=>{a(zn(t,"redirect-cancelled-by-user"))},Y9))}function m(){(document==null?void 0:document.visibilityState)==="visible"&&g()}e.addPassiveListener(h),document.addEventListener("resume",g,!1),cd()&&document.addEventListener("visibilitychange",m,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",g,!1),document.removeEventListener("visibilitychange",m,!1),l&&window.clearTimeout(l)}})}finally{i()}}function tz(t){var e,n,r,i,s,a,l,h,g,m;const v=ja();Ie(typeof((e=v==null?void 0:v.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Ie(typeof((n=v==null?void 0:v.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Ie(typeof((s=(i=(r=v==null?void 0:v.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ie(typeof((h=(l=(a=v==null?void 0:v.cordova)===null||a===void 0?void 0:a.plugins)===null||l===void 0?void 0:l.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Ie(typeof((m=(g=v==null?void 0:v.cordova)===null||g===void 0?void 0:g.InAppBrowser)===null||m===void 0?void 0:m.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function nz(t){const e=rz(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function rz(t){if(Ai(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz=20;class sz extends JR{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function oz(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:lz(),postBody:null,tenantId:t.tenantId,error:zn(t,"no-auth-event")}}function az(t,e){return Fy()._set(By(t),e)}async function S1(t){const e=await Fy()._get(By(t));return e&&await Fy()._remove(By(t)),e}function uz(t,e){var n,r;const i=hz(e);if(i.includes("/__/auth/callback")){const s=qf(i),a=s.firebaseError?cz(decodeURIComponent(s.firebaseError)):null,l=(r=(n=a==null?void 0:a.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],h=l?zn(l):null;return h?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function lz(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<iz;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Fy(){return $r(sE)}function By(t){return ba("authEvent",t.config.apiKey,t.name)}function cz(t){try{return JSON.parse(t)}catch{return null}}function hz(t){const e=qf(t),n=e.link?decodeURIComponent(e.link):void 0,r=qf(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return qf(i).link||i||r||n||t}function qf(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return ju(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz=500;class fz{constructor(){this._redirectPersistence=Ba,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=lm,this._overrideRedirectResult=cE}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new sz(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){qn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){tz(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),u9(),await this._originValidation(e);const a=oz(e,r,i);await az(e,a);const l=await X9(e,a,n),h=await Z9(l);return ez(e,s,h)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=J9(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=ja(),a=setTimeout(async()=>{await S1(e),n.onEvent(T1())},dz),l=async m=>{clearTimeout(a);const v=await S1(e);let I=null;v&&(m!=null&&m.url)&&(I=uz(v,m.url)),n.onEvent(I||T1())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const h=i,g=`${s.packageName.toLowerCase()}://`;ja().handleOpenURL=async m=>{if(m.toLowerCase().startsWith(g)&&l({url:m}),typeof h=="function")try{h(m)}catch(v){console.error(v)}}}}const gz=fz;function T1(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:zn("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(t,e){rn(t)._logFramework(e)}var mz="@firebase/auth-compat",_z="0.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz=1e3;function Wc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function yz(){return Wc()==="http:"||Wc()==="https:"}function nk(t=Zt()){return!!((Wc()==="file:"||Wc()==="ionic:"||Wc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function wz(){return Hw()||$w()}function Ez(){return eR()&&(document==null?void 0:document.documentMode)===11}function Iz(t=Zt()){return/Edge\/\d+/.test(t)}function Sz(t=Zt()){return Ez()||Iz(t)}function rk(){try{const t=self.localStorage,e=dd();if(t)return t.setItem(e,"1"),t.removeItem(e),Sz()?Eh():!0}catch{return dE()&&Eh()}return!1}function dE(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function F_(){return(yz()||ZP()||nk())&&!wz()&&rk()&&!dE()}function ik(){return nk()&&typeof document<"u"}async function Tz(){return ik()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},vz);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function xz(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br={LOCAL:"local",NONE:"none",SESSION:"session"},uc=Ie,sk="persistence";function Cz(t,e){if(uc(Object.values(Br).includes(e),t,"invalid-persistence-type"),Hw()){uc(e!==Br.SESSION,t,"unsupported-persistence-type");return}if($w()){uc(e===Br.NONE,t,"unsupported-persistence-type");return}if(dE()){uc(e===Br.NONE||e===Br.LOCAL&&Eh(),t,"unsupported-persistence-type");return}uc(e===Br.NONE||rk(),t,"unsupported-persistence-type")}async function Uy(t){await t._initializationPromise;const e=ok(),n=ba(sk,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function bz(t,e){const n=ok();if(!n)return[];const r=ba(sk,t,e);switch(n.getItem(r)){case Br.NONE:return[ml];case Br.LOCAL:return[Ph,Ba];case Br.SESSION:return[Ba];default:return[]}}function ok(){var t;try{return((t=xz())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Az=Ie;class uo{constructor(){this.browserResolver=$r(H9),this.cordovaResolver=$r(gz),this.underlyingResolver=null,this._redirectPersistence=Ba,this._completeRedirectFn=lm,this._overrideRedirectResult=cE}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return ik()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Az(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await Tz();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(t){return t.unwrap()}function Pz(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rz(t){return uk(t)}function kz(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new Nz(t,g6(t,e))}else if(r){const i=uk(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function uk(t){const{_tokenResponse:e}=t instanceof gr?t.customData:t;if(!e)return null;if(!(t instanceof gr)&&"temporaryProof"in e&&"phoneNumber"in e)return Ua.credentialFromResult(t);const n=e.providerId;if(!n||n===ac.PASSWORD)return null;let r;switch(n){case ac.GOOGLE:r=zi;break;case ac.FACEBOOK:r=ji;break;case ac.GITHUB:r=$i;break;case ac.TWITTER:r=Hi;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:h}=e;return!s&&!a&&!i&&!l?null:l?n.startsWith("saml.")?_l._create(n,l):is._fromParams({providerId:n,signInMethod:n,pendingToken:l,idToken:i,accessToken:s}):new Ju(n).credential({idToken:i,accessToken:s,rawNonce:h})}return t instanceof gr?r.credentialFromError(t):r.credentialFromResult(t)}function Sr(t,e){return e.catch(n=>{throw n instanceof gr&&kz(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:Rz(n),additionalUserInfo:f6(n),user:cm.getOrCreate(i)}})}async function jy(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>Sr(t,n.confirm(r))}}class Nz{constructor(e,n){this.resolver=n,this.auth=Pz(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Sr(ak(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm=class Ac{constructor(e){this._delegate=e,this.multiFactor=v6(e)}static getOrCreate(e){return Ac.USER_MAP.has(e)||Ac.USER_MAP.set(e,new Ac(e)),Ac.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Sr(this.auth,LR(this._delegate,e))}async linkWithPhoneNumber(e,n){return jy(this.auth,Q6(this._delegate,e,n))}async linkWithPopup(e){return Sr(this.auth,i9(this._delegate,e,uo))}async linkWithRedirect(e){return await Uy(rn(this.auth)),f9(this._delegate,e,uo)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Sr(this.auth,VR(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return jy(this.auth,Y6(this._delegate,e,n))}reauthenticateWithPopup(e){return Sr(this.auth,r9(this._delegate,e,uo))}async reauthenticateWithRedirect(e){return await Uy(rn(this.auth)),h9(this._delegate,e,uo)}sendEmailVerification(e){return n6(this._delegate,e)}async unlink(e){return await zj(this._delegate,e),this}updateEmail(e){return o6(this._delegate,e)}updatePassword(e){return a6(this._delegate,e)}updatePhoneNumber(e){return X6(this._delegate,e)}updateProfile(e){return s6(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return r6(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};cm.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=Ie;class zy{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;lc(r,"invalid-api-key",{appName:e.name}),lc(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?uo:void 0;this._delegate=n.initialize({options:{persistence:Dz(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(DU),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?cm.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){vj(this._delegate,e,n)}applyActionCode(e){return Wj(this._delegate,e)}checkActionCode(e){return FR(this._delegate,e)}confirmPasswordReset(e,n){return Gj(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Sr(this._delegate,Qj(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return t6(this._delegate,e)}isSignInWithEmailLink(e){return Jj(this._delegate,e)}async getRedirectResult(){lc(F_(),this._delegate,"operation-not-supported-in-this-environment");const e=await p9(this._delegate,uo);return e?Sr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){pz(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:a}=x1(e,n,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:a}=x1(e,n,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,n){return Xj(this._delegate,e,n)}sendPasswordResetEmail(e,n){return qj(this._delegate,e,n||void 0)}async setPersistence(e){Cz(this._delegate,e);let n;switch(e){case Br.SESSION:n=Ba;break;case Br.LOCAL:n=await $r(Ph)._isAvailable()?Ph:sE;break;case Br.NONE:n=ml;break;default:return qn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Sr(this._delegate,jj(this._delegate))}signInWithCredential(e){return Sr(this._delegate,im(this._delegate,e))}signInWithCustomToken(e){return Sr(this._delegate,Hj(this._delegate,e))}signInWithEmailAndPassword(e,n){return Sr(this._delegate,Yj(this._delegate,e,n))}signInWithEmailLink(e,n){return Sr(this._delegate,Zj(this._delegate,e,n))}signInWithPhoneNumber(e,n){return jy(this._delegate,K6(this._delegate,e,n))}async signInWithPopup(e){return lc(F_(),this._delegate,"operation-not-supported-in-this-environment"),Sr(this._delegate,n9(this._delegate,e,uo))}async signInWithRedirect(e){return lc(F_(),this._delegate,"operation-not-supported-in-this-environment"),await Uy(this._delegate),l9(this._delegate,e,uo)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return Kj(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}zy.Persistence=Br;function x1(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:a=>i(a&&cm.getOrCreate(a)),error:e,complete:n}}function Dz(t,e){const n=bz(t,e);if(typeof self<"u"&&!n.includes(Ph)&&n.push(Ph),typeof window<"u")for(const r of[sE,Ba])n.includes(r)||n.push(r);return n.includes(ml)||n.push(ml),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(){this.providerId="phone",this._delegate=new Ua(ak(Ot.auth()))}static credential(e,n){return Ua.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}fE.PHONE_SIGN_IN_METHOD=Ua.PHONE_SIGN_IN_METHOD;fE.PROVIDER_ID=Ua.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oz=Ie;class Mz{constructor(e,n,r=Ot.app()){var i;Oz((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new G6(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lz="auth-compat";function Vz(t){t.INTERNAL.registerComponent(new rs(Lz,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new zy(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:fu.EMAIL_SIGNIN,PASSWORD_RESET:fu.PASSWORD_RESET,RECOVER_EMAIL:fu.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:fu.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:fu.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:fu.VERIFY_EMAIL}},EmailAuthProvider:Go,FacebookAuthProvider:ji,GithubAuthProvider:$i,GoogleAuthProvider:zi,OAuthProvider:Ju,SAMLAuthProvider:Lg,PhoneAuthProvider:fE,PhoneMultiFactorGenerator:tk,RecaptchaVerifier:Mz,TwitterAuthProvider:Hi,Auth:zy,AuthCredential:Bl,Error:gr}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(mz,_z)}Vz(Ot);var Fz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ne,gE=gE||{},Je=Fz||self;function hm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function gd(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Bz(t){return Object.prototype.hasOwnProperty.call(t,B_)&&t[B_]||(t[B_]=++Uz)}var B_="closure_uid_"+(1e9*Math.random()>>>0),Uz=0;function jz(t,e,n){return t.call.apply(t.bind,arguments)}function zz(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function er(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?er=jz:er=zz,er.apply(null,arguments)}function pf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Nn(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[i].apply(r,a)}}function Wo(){this.s=this.s,this.o=this.o}var $z=0;Wo.prototype.s=!1;Wo.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),$z!=0)&&Bz(this)};Wo.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const lk=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function pE(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function C1(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(hm(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let a=0;a<s;a++)t[i+a]=r[a]}else t.push(r)}}function tr(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}tr.prototype.h=function(){this.defaultPrevented=!0};var Hz=function(){if(!Je.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};Je.addEventListener("test",n,e),Je.removeEventListener("test",n,e)}catch{}return t}();function Rh(t){return/^[\s\xa0]*$/.test(t)}function dm(){var t=Je.navigator;return t&&(t=t.userAgent)?t:""}function qi(t){return dm().indexOf(t)!=-1}function mE(t){return mE[" "](t),t}mE[" "]=function(){};function qz(t,e){var n=V$;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var Gz=qi("Opera"),vl=qi("Trident")||qi("MSIE"),ck=qi("Edge"),$y=ck||vl,hk=qi("Gecko")&&!(dm().toLowerCase().indexOf("webkit")!=-1&&!qi("Edge"))&&!(qi("Trident")||qi("MSIE"))&&!qi("Edge"),Wz=dm().toLowerCase().indexOf("webkit")!=-1&&!qi("Edge");function dk(){var t=Je.document;return t?t.documentMode:void 0}var Hy;e:{var U_="",j_=function(){var t=dm();if(hk)return/rv:([^\);]+)(\)|;)/.exec(t);if(ck)return/Edge\/([\d\.]+)/.exec(t);if(vl)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Wz)return/WebKit\/(\S+)/.exec(t);if(Gz)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(j_&&(U_=j_?j_[1]:""),vl){var z_=dk();if(z_!=null&&z_>parseFloat(U_)){Hy=String(z_);break e}}Hy=U_}var qy;if(Je.document&&vl){var b1=dk();qy=b1||parseInt(Hy,10)||void 0}else qy=void 0;var Kz=qy;function kh(t,e){if(tr.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(hk){e:{try{mE(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Qz[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&kh.$.h.call(this)}}Nn(kh,tr);var Qz={2:"touch",3:"pen",4:"mouse"};kh.prototype.h=function(){kh.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var pd="closure_listenable_"+(1e6*Math.random()|0),Yz=0;function Xz(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Yz,this.fa=this.ia=!1}function fm(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function _E(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Jz(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function fk(t){const e={};for(const n in t)e[n]=t[n];return e}const A1="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function gk(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<A1.length;s++)n=A1[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function gm(t){this.src=t,this.g={},this.h=0}gm.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var a=Wy(t,e,r,i);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new Xz(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Gy(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=lk(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(fm(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Wy(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var vE="closure_lm_"+(1e6*Math.random()|0),$_={};function pk(t,e,n,r,i){if(r&&r.once)return _k(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)pk(t,e[s],n,r,i);return null}return n=EE(n),t&&t[pd]?t.O(e,n,gd(r)?!!r.capture:!!r,i):mk(t,e,n,!1,r,i)}function mk(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var a=gd(i)?!!i.capture:!!i,l=wE(t);if(l||(t[vE]=l=new gm(t)),n=l.add(e,n,r,a,s),n.proxy)return n;if(r=Zz(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Hz||(i=a),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(yk(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Zz(){function t(n){return e.call(t.src,t.listener,n)}const e=e$;return t}function _k(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)_k(t,e[s],n,r,i);return null}return n=EE(n),t&&t[pd]?t.P(e,n,gd(r)?!!r.capture:!!r,i):mk(t,e,n,!0,r,i)}function vk(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)vk(t,e[s],n,r,i);else r=gd(r)?!!r.capture:!!r,n=EE(n),t&&t[pd]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Wy(s,n,r,i),-1<n&&(fm(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=wE(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Wy(e,n,r,i)),(n=-1<t?e[t]:null)&&yE(n))}function yE(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[pd])Gy(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(yk(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=wE(e))?(Gy(n,t),n.h==0&&(n.src=null,e[vE]=null)):fm(t)}}}function yk(t){return t in $_?$_[t]:$_[t]="on"+t}function e$(t,e){if(t.fa)t=!0;else{e=new kh(e,this);var n=t.listener,r=t.la||t.src;t.ia&&yE(t),t=n.call(r,e)}return t}function wE(t){return t=t[vE],t instanceof gm?t:null}var H_="__closure_events_fn_"+(1e9*Math.random()>>>0);function EE(t){return typeof t=="function"?t:(t[H_]||(t[H_]=function(e){return t.handleEvent(e)}),t[H_])}function Rn(){Wo.call(this),this.i=new gm(this),this.S=this,this.J=null}Nn(Rn,Wo);Rn.prototype[pd]=!0;Rn.prototype.removeEventListener=function(t,e,n,r){vk(this,t,e,n,r)};function $n(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new tr(e,t);else if(e instanceof tr)e.target=e.target||t;else{var i=e;e=new tr(r,t),gk(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=e.g=n[s];i=mf(a,r,!0,e)&&i}if(a=e.g=t,i=mf(a,r,!0,e)&&i,i=mf(a,r,!1,e)&&i,n)for(s=0;s<n.length;s++)a=e.g=n[s],i=mf(a,r,!1,e)&&i}Rn.prototype.N=function(){if(Rn.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)fm(n[r]);delete t.g[e],t.h--}}this.J=null};Rn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Rn.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function mf(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==n){var l=a.listener,h=a.la||a.src;a.ia&&Gy(t.i,a),i=l.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var IE=Je.JSON.stringify;class t${constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function n$(){var t=SE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class r${constructor(){this.h=this.g=null}add(e,n){const r=wk.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var wk=new t$(()=>new i$,t=>t.reset());class i${constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function s$(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function o$(t){Je.setTimeout(()=>{throw t},0)}let Nh,Dh=!1,SE=new r$,Ek=()=>{const t=Je.Promise.resolve(void 0);Nh=()=>{t.then(a$)}};var a$=()=>{for(var t;t=n$();){try{t.h.call(t.g)}catch(n){o$(n)}var e=wk;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Dh=!1};function pm(t,e){Rn.call(this),this.h=t||1,this.g=e||Je,this.j=er(this.qb,this),this.l=Date.now()}Nn(pm,Rn);Ne=pm.prototype;Ne.ga=!1;Ne.T=null;Ne.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),$n(this,"tick"),this.ga&&(TE(this),this.start()))}};Ne.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function TE(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}Ne.N=function(){pm.$.N.call(this),TE(this),delete this.g};function xE(t,e,n){if(typeof t=="function")n&&(t=er(t,n));else if(t&&typeof t.handleEvent=="function")t=er(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Je.setTimeout(t,e||0)}function Ik(t){t.g=xE(()=>{t.g=null,t.i&&(t.i=!1,Ik(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class u$ extends Wo{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ik(this)}N(){super.N(),this.g&&(Je.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oh(t){Wo.call(this),this.h=t,this.g={}}Nn(Oh,Wo);var P1=[];function Sk(t,e,n,r){Array.isArray(n)||(n&&(P1[0]=n.toString()),n=P1);for(var i=0;i<n.length;i++){var s=pk(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Tk(t){_E(t.g,function(e,n){this.g.hasOwnProperty(n)&&yE(e)},t),t.g={}}Oh.prototype.N=function(){Oh.$.N.call(this),Tk(this)};Oh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function mm(){this.g=!0}mm.prototype.Ea=function(){this.g=!1};function l$(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var a="",l=s.split("&"),h=0;h<l.length;h++){var g=l[h].split("=");if(1<g.length){var m=g[0];g=g[1];var v=m.split("_");a=2<=v.length&&v[1]=="type"?a+(m+"="+g+"&"):a+(m+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+a})}function c$(t,e,n,r,i,s,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+a})}function zu(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+d$(t,n)+(r?" "+r:"")})}function h$(t,e){t.info(function(){return"TIMEOUT: "+e})}mm.prototype.info=function(){};function d$(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return IE(n)}catch{return e}}var iu={},R1=null;function _m(){return R1=R1||new Rn}iu.Ta="serverreachability";function xk(t){tr.call(this,iu.Ta,t)}Nn(xk,tr);function Mh(t){const e=_m();$n(e,new xk(e))}iu.STAT_EVENT="statevent";function Ck(t,e){tr.call(this,iu.STAT_EVENT,t),this.stat=e}Nn(Ck,tr);function hr(t){const e=_m();$n(e,new Ck(e,t))}iu.Ua="timingevent";function bk(t,e){tr.call(this,iu.Ua,t),this.size=e}Nn(bk,tr);function md(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Je.setTimeout(function(){t()},e)}var vm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ak={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function CE(){}CE.prototype.h=null;function k1(t){return t.h||(t.h=t.i())}function Pk(){}var _d={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function bE(){tr.call(this,"d")}Nn(bE,tr);function AE(){tr.call(this,"c")}Nn(AE,tr);var Ky;function ym(){}Nn(ym,CE);ym.prototype.g=function(){return new XMLHttpRequest};ym.prototype.i=function(){return{}};Ky=new ym;function vd(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Oh(this),this.P=f$,t=$y?125:void 0,this.V=new pm(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Rk}function Rk(){this.i=null,this.g="",this.h=!1}var f$=45e3,kk={},Qy={};Ne=vd.prototype;Ne.setTimeout=function(t){this.P=t};function Yy(t,e,n){t.L=1,t.A=Em(Ls(e)),t.u=n,t.S=!0,Nk(t,null)}function Nk(t,e){t.G=Date.now(),yd(t),t.B=Ls(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Uk(n.i,"t",r),t.o=0,n=t.l.J,t.h=new Rk,t.g=a2(t.l,n?e:null,!t.u),0<t.O&&(t.M=new u$(er(t.Pa,t,t.g),t.O)),Sk(t.U,t.g,"readystatechange",t.nb),e=t.I?fk(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Mh(),l$(t.j,t.v,t.B,t.m,t.W,t.u)}Ne.nb=function(t){t=t.target;const e=this.M;e&&Wi(t)==3?e.l():this.Pa(t)};Ne.Pa=function(t){try{if(t==this.g)e:{const m=Wi(this.g);var e=this.g.Ia();const v=this.g.da();if(!(3>m)&&(m!=3||$y||this.g&&(this.h.h||this.g.ja()||M1(this.g)))){this.J||m!=4||e==7||(e==8||0>=v?Mh(3):Mh(2)),wm(this);var n=this.g.da();this.ca=n;t:if(Dk(this)){var r=M1(this.g);t="";var i=r.length,s=Wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ya(this),Kc(this);var a="";break t}this.h.i=new Je.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,c$(this.j,this.v,this.B,this.m,this.W,m,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Rh(l)){var g=l;break t}}g=null}if(n=g)zu(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xy(this,n);else{this.i=!1,this.s=3,hr(12),ya(this),Kc(this);break e}}this.S?(Ok(this,m,a),$y&&this.i&&m==3&&(Sk(this.U,this.V,"tick",this.mb),this.V.start())):(zu(this.j,this.m,a,null),Xy(this,a)),m==4&&ya(this),this.i&&!this.J&&(m==4?r2(this.l,this):(this.i=!1,yd(this)))}else O$(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.s=3,hr(12)):(this.s=0,hr(13)),ya(this),Kc(this)}}}catch{}finally{}};function Dk(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function Ok(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=g$(t,n),i==Qy){e==4&&(t.s=4,hr(14),r=!1),zu(t.j,t.m,null,"[Incomplete Response]");break}else if(i==kk){t.s=4,hr(15),zu(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else zu(t.j,t.m,i,null),Xy(t,i);Dk(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,hr(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),OE(e),e.M=!0,hr(11))):(zu(t.j,t.m,n,"[Invalid Chunked Response]"),ya(t),Kc(t))}Ne.mb=function(){if(this.g){var t=Wi(this.g),e=this.g.ja();this.o<e.length&&(wm(this),Ok(this,t,e),this.i&&t!=4&&yd(this))}};function g$(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Qy:(n=Number(e.substring(n,r)),isNaN(n)?kk:(r+=1,r+n>e.length?Qy:(e=e.slice(r,r+n),t.o=r+n,e)))}Ne.cancel=function(){this.J=!0,ya(this)};function yd(t){t.Y=Date.now()+t.P,Mk(t,t.P)}function Mk(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=md(er(t.lb,t),e)}function wm(t){t.C&&(Je.clearTimeout(t.C),t.C=null)}Ne.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(h$(this.j,this.B),this.L!=2&&(Mh(),hr(17)),ya(this),this.s=2,Kc(this)):Mk(this,this.Y-t)};function Kc(t){t.l.H==0||t.J||r2(t.l,t)}function ya(t){wm(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,TE(t.V),Tk(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Xy(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Jy(n.i,t))){if(!t.K&&Jy(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)zg(n),xm(n);else break e;DE(n),hr(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=md(er(n.ib,n),6e3));if(1>=$k(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else wa(n,11)}else if((t.K||n.g==t)&&zg(n),!Rh(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let g=i[e];if(n.V=g[0],g=g[1],n.H==2)if(g[0]=="c"){n.K=g[1],n.pa=g[2];const m=g[3];m!=null&&(n.ra=m,n.l.info("VER="+n.ra));const v=g[4];v!=null&&(n.Ga=v,n.l.info("SVER="+n.Ga));const I=g[5];I!=null&&typeof I=="number"&&0<I&&(r=1.5*I,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const S=t.g;if(S){const j=S.g?S.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(j){var s=r.i;s.g||j.indexOf("spdy")==-1&&j.indexOf("quic")==-1&&j.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(PE(s,s.h),s.h=null))}if(r.F){const z=S.g?S.g.getResponseHeader("X-HTTP-Session-Id"):null;z&&(r.Da=z,Bt(r.I,r.F,z))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=o2(r,r.J?r.pa:null,r.Y),a.K){Hk(r.i,a);var l=a,h=r.L;h&&l.setTimeout(h),l.C&&(wm(l),yd(l)),r.g=a}else t2(r);0<n.j.length&&Cm(n)}else g[0]!="stop"&&g[0]!="close"||wa(n,7);else n.H==3&&(g[0]=="stop"||g[0]=="close"?g[0]=="stop"?wa(n,7):NE(n):g[0]!="noop"&&n.h&&n.h.Aa(g),n.A=0)}}Mh(4)}catch{}}function p$(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(hm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function m$(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(hm(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function Lk(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(hm(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=m$(t),r=p$(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var Vk=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _$(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Pa(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Pa){this.h=t.h,Ug(this,t.j),this.s=t.s,this.g=t.g,jg(this,t.m),this.l=t.l;var e=t.i,n=new Lh;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),N1(this,n),this.o=t.o}else t&&(e=String(t).match(Vk))?(this.h=!1,Ug(this,e[1]||"",!0),this.s=Pc(e[2]||""),this.g=Pc(e[3]||"",!0),jg(this,e[4]),this.l=Pc(e[5]||"",!0),N1(this,e[6]||"",!0),this.o=Pc(e[7]||"")):(this.h=!1,this.i=new Lh(null,this.h))}Pa.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Rc(e,D1,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Rc(e,D1,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Rc(n,n.charAt(0)=="/"?w$:y$,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Rc(n,I$)),t.join("")};function Ls(t){return new Pa(t)}function Ug(t,e,n){t.j=n?Pc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function jg(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function N1(t,e,n){e instanceof Lh?(t.i=e,S$(t.i,t.h)):(n||(e=Rc(e,E$)),t.i=new Lh(e,t.h))}function Bt(t,e,n){t.i.set(e,n)}function Em(t){return Bt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Pc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Rc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,v$),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function v$(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var D1=/[#\/\?@]/g,y$=/[#\?:]/g,w$=/[#\?]/g,E$=/[#\?@]/g,I$=/#/g;function Lh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ko(t){t.g||(t.g=new Map,t.h=0,t.i&&_$(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}Ne=Lh.prototype;Ne.add=function(t,e){Ko(this),this.i=null,t=jl(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Fk(t,e){Ko(t),e=jl(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Bk(t,e){return Ko(t),e=jl(t,e),t.g.has(e)}Ne.forEach=function(t,e){Ko(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};Ne.ta=function(){Ko(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};Ne.Z=function(t){Ko(this);let e=[];if(typeof t=="string")Bk(this,t)&&(e=e.concat(this.g.get(jl(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};Ne.set=function(t,e){return Ko(this),this.i=null,t=jl(this,t),Bk(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};Ne.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function Uk(t,e,n){Fk(t,e),0<n.length&&(t.i=null,t.g.set(jl(t,e),pE(n)),t.h+=n.length)}Ne.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),t.push(i)}}return this.i=t.join("&")};function jl(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function S$(t,e){e&&!t.j&&(Ko(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(Fk(this,r),Uk(this,i,n))},t)),t.j=e}var T$=class{constructor(t,e){this.g=t,this.map=e}};function jk(t){this.l=t||x$,Je.PerformanceNavigationTiming?(t=Je.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Je.g&&Je.g.Ka&&Je.g.Ka()&&Je.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var x$=10;function zk(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function $k(t){return t.h?1:t.g?t.g.size:0}function Jy(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function PE(t,e){t.g?t.g.add(e):t.h=e}function Hk(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}jk.prototype.cancel=function(){if(this.i=qk(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function qk(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return pE(t.i)}var C$=class{stringify(t){return Je.JSON.stringify(t,void 0)}parse(t){return Je.JSON.parse(t,void 0)}};function b$(){this.g=new C$}function A$(t,e,n){const r=n||"";try{Lk(t,function(i,s){let a=i;gd(i)&&(a=IE(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function P$(t,e){const n=new mm;if(Je.Image){const r=new Image;r.onload=pf(_f,n,r,"TestLoadImage: loaded",!0,e),r.onerror=pf(_f,n,r,"TestLoadImage: error",!1,e),r.onabort=pf(_f,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=pf(_f,n,r,"TestLoadImage: timeout",!1,e),Je.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function _f(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Im(t){this.l=t.ec||null,this.j=t.ob||!1}Nn(Im,CE);Im.prototype.g=function(){return new Sm(this.l,this.j)};Im.prototype.i=function(t){return function(){return t}}({});function Sm(t,e){Rn.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=RE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Nn(Sm,Rn);var RE=0;Ne=Sm.prototype;Ne.open=function(t,e){if(this.readyState!=RE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Vh(this)};Ne.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Je).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};Ne.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,wd(this)),this.readyState=RE};Ne.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Vh(this)),this.g&&(this.readyState=3,Vh(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Je.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Gk(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function Gk(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}Ne.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?wd(this):Vh(this),this.readyState==3&&Gk(this)}};Ne.Za=function(t){this.g&&(this.response=this.responseText=t,wd(this))};Ne.Ya=function(t){this.g&&(this.response=t,wd(this))};Ne.ka=function(){this.g&&wd(this)};function wd(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Vh(t)}Ne.setRequestHeader=function(t,e){this.v.append(t,e)};Ne.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};Ne.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Vh(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Sm.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var R$=Je.JSON.parse;function sn(t){Rn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Wk,this.L=this.M=!1}Nn(sn,Rn);var Wk="",k$=/^https?$/i,N$=["POST","PUT"];Ne=sn.prototype;Ne.Oa=function(t){this.M=t};Ne.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ky.g(),this.C=this.u?k1(this.u):k1(Ky),this.g.onreadystatechange=er(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){O1(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Je.FormData&&t instanceof Je.FormData,!(0<=lk(N$,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Yk(this),0<this.B&&((this.L=D$(this.g))?(this.g.timeout=this.B,this.g.ontimeout=er(this.ua,this)):this.A=xE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){O1(this,s)}};function D$(t){return vl&&typeof t.timeout=="number"&&t.ontimeout!==void 0}Ne.ua=function(){typeof gE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$n(this,"timeout"),this.abort(8))};function O1(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Kk(t),Tm(t)}function Kk(t){t.F||(t.F=!0,$n(t,"complete"),$n(t,"error"))}Ne.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,$n(this,"complete"),$n(this,"abort"),Tm(this))};Ne.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Tm(this,!0)),sn.$.N.call(this)};Ne.La=function(){this.s||(this.G||this.v||this.l?Qk(this):this.kb())};Ne.kb=function(){Qk(this)};function Qk(t){if(t.h&&typeof gE<"u"&&(!t.C[1]||Wi(t)!=4||t.da()!=2)){if(t.v&&Wi(t)==4)xE(t.La,0,t);else if($n(t,"readystatechange"),Wi(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var i=String(t.I).match(Vk)[1]||null;!i&&Je.self&&Je.self.location&&(i=Je.self.location.protocol.slice(0,-1)),r=!k$.test(i?i.toLowerCase():"")}n=r}if(n)$n(t,"complete"),$n(t,"success");else{t.m=6;try{var s=2<Wi(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Kk(t)}}finally{Tm(t)}}}}function Tm(t,e){if(t.g){Yk(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||$n(t,"ready");try{n.onreadystatechange=r}catch{}}}function Yk(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Je.clearTimeout(t.A),t.A=null)}Ne.isActive=function(){return!!this.g};function Wi(t){return t.g?t.g.readyState:0}Ne.da=function(){try{return 2<Wi(this)?this.g.status:-1}catch{return-1}};Ne.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};Ne.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),R$(e)}};function M1(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Wk:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function O$(t){const e={};t=(t.g&&2<=Wi(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Rh(t[r]))continue;var n=s$(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}Jz(e,function(r){return r.join(", ")})}Ne.Ia=function(){return this.m};Ne.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Xk(t){let e="";return _E(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function kE(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Xk(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Bt(t,e,n))}function cc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Jk(t){this.Ga=0,this.j=[],this.l=new mm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=cc("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=cc("baseRetryDelayMs",5e3,t),this.hb=cc("retryDelaySeedMs",1e4,t),this.eb=cc("forwardChannelMaxRetries",2,t),this.xa=cc("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new jk(t&&t.concurrentRequestLimit),this.Ja=new b$,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}Ne=Jk.prototype;Ne.ra=8;Ne.H=1;function NE(t){if(Zk(t),t.H==3){var e=t.W++,n=Ls(t.I);if(Bt(n,"SID",t.K),Bt(n,"RID",e),Bt(n,"TYPE","terminate"),Ed(t,n),e=new vd(t,t.l,e),e.L=2,e.A=Em(Ls(n)),n=!1,Je.navigator&&Je.navigator.sendBeacon)try{n=Je.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Je.Image&&(new Image().src=e.A,n=!0),n||(e.g=a2(e.l,null),e.g.ha(e.A)),e.G=Date.now(),yd(e)}s2(t)}function xm(t){t.g&&(OE(t),t.g.cancel(),t.g=null)}function Zk(t){xm(t),t.u&&(Je.clearTimeout(t.u),t.u=null),zg(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Je.clearTimeout(t.m),t.m=null)}function Cm(t){if(!zk(t.i)&&!t.m){t.m=!0;var e=t.Na;Nh||Ek(),Dh||(Nh(),Dh=!0),SE.add(e,t),t.C=0}}function M$(t,e){return $k(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=md(er(t.Na,t,e),i2(t,t.C)),t.C++,!0)}Ne.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new vd(this,this.l,t);let s=this.s;if(this.U&&(s?(s=fk(s),gk(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=e2(this,i,e),n=Ls(this.I),Bt(n,"RID",t),Bt(n,"CVER",22),this.F&&Bt(n,"X-HTTP-Session-Id",this.F),Ed(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Xk(s)))+"&"+e:this.o&&kE(n,this.o,s)),PE(this.i,i),this.bb&&Bt(n,"TYPE","init"),this.P?(Bt(n,"$req",e),Bt(n,"SID","null"),i.aa=!0,Yy(i,n,null)):Yy(i,n,e),this.H=2}}else this.H==3&&(t?L1(this,t):this.j.length==0||zk(this.i)||L1(this))};function L1(t,e){var n;e?n=e.m:n=t.W++;const r=Ls(t.I);Bt(r,"SID",t.K),Bt(r,"RID",n),Bt(r,"AID",t.V),Ed(t,r),t.o&&t.s&&kE(r,t.o,t.s),n=new vd(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=e2(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),PE(t.i,n),Yy(n,r,e)}function Ed(t,e){t.na&&_E(t.na,function(n,r){Bt(e,r,n)}),t.h&&Lk({},function(n,r){Bt(e,r,n)})}function e2(t,e,n){n=Math.min(t.j.length,n);var r=t.h?er(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const a=["count="+n];s==-1?0<n?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let l=!0;for(let h=0;h<n;h++){let g=i[h].g;const m=i[h].map;if(g-=s,0>g)s=Math.max(0,i[h].g-100),l=!1;else try{A$(m,a,"req"+g+"_")}catch{r&&r(m)}}if(l){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function t2(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Nh||Ek(),Dh||(Nh(),Dh=!0),SE.add(e,t),t.A=0}}function DE(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=md(er(t.Ma,t),i2(t,t.A)),t.A++,!0)}Ne.Ma=function(){if(this.u=null,n2(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=md(er(this.jb,this),t)}};Ne.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,hr(10),xm(this),n2(this))};function OE(t){t.B!=null&&(Je.clearTimeout(t.B),t.B=null)}function n2(t){t.g=new vd(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ls(t.wa);Bt(e,"RID","rpc"),Bt(e,"SID",t.K),Bt(e,"AID",t.V),Bt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Bt(e,"TO",t.qa),Bt(e,"TYPE","xmlhttp"),Ed(t,e),t.o&&t.s&&kE(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Em(Ls(e)),n.u=null,n.S=!0,Nk(n,t)}Ne.ib=function(){this.v!=null&&(this.v=null,xm(this),DE(this),hr(19))};function zg(t){t.v!=null&&(Je.clearTimeout(t.v),t.v=null)}function r2(t,e){var n=null;if(t.g==e){zg(t),OE(t),t.g=null;var r=2}else if(Jy(t.i,e))n=e.F,Hk(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=_m(),$n(r,new bk(r,n)),Cm(t)}else t2(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&M$(t,e)||r==2&&DE(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:wa(t,5);break;case 4:wa(t,10);break;case 3:wa(t,6);break;default:wa(t,2)}}}function i2(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function wa(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=er(t.pb,t);n||(n=new Pa("//www.google.com/images/cleardot.gif"),Je.location&&Je.location.protocol=="http"||Ug(n,"https"),Em(n)),P$(n.toString(),r)}else hr(2);t.H=0,t.h&&t.h.za(e),s2(t),Zk(t)}Ne.pb=function(t){t?(this.l.info("Successfully pinged google.com"),hr(2)):(this.l.info("Failed to ping google.com"),hr(1))};function s2(t){if(t.H=0,t.ma=[],t.h){const e=qk(t.i);(e.length!=0||t.j.length!=0)&&(C1(t.ma,e),C1(t.ma,t.j),t.i.i.length=0,pE(t.j),t.j.length=0),t.h.ya()}}function o2(t,e,n){var r=n instanceof Pa?Ls(n):new Pa(n);if(r.g!="")e&&(r.g=e+"."+r.g),jg(r,r.m);else{var i=Je.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Pa(null);r&&Ug(s,r),e&&(s.g=e),i&&jg(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Bt(r,n,e),Bt(r,"VER",t.ra),Ed(t,r),r}function a2(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new sn(new Im({ob:n})):new sn(t.va),e.Oa(t.J),e}Ne.isActive=function(){return!!this.h&&this.h.isActive(this)};function u2(){}Ne=u2.prototype;Ne.Ba=function(){};Ne.Aa=function(){};Ne.za=function(){};Ne.ya=function(){};Ne.isActive=function(){return!0};Ne.Va=function(){};function $g(){if(vl&&!(10<=Number(Kz)))throw Error("Environmental error: no available transport.")}$g.prototype.g=function(t,e){return new Wr(t,e)};function Wr(t,e){Rn.call(this),this.g=new Jk(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Rh(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Rh(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new zl(this)}Nn(Wr,Rn);Wr.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;hr(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=o2(t,null,t.Y),Cm(t)};Wr.prototype.close=function(){NE(this.g)};Wr.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=IE(t),t=n);e.j.push(new T$(e.fb++,t)),e.H==3&&Cm(e)};Wr.prototype.N=function(){this.g.h=null,delete this.j,NE(this.g),delete this.g,Wr.$.N.call(this)};function l2(t){bE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Nn(l2,bE);function c2(){AE.call(this),this.status=1}Nn(c2,AE);function zl(t){this.g=t}Nn(zl,u2);zl.prototype.Ba=function(){$n(this.g,"a")};zl.prototype.Aa=function(t){$n(this.g,new l2(t))};zl.prototype.za=function(t){$n(this.g,new c2)};zl.prototype.ya=function(){$n(this.g,"b")};function L$(){this.blockSize=-1}function Pi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Nn(Pi,L$);Pi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function q_(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],a=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(a<<20&4294967295|a>>>12),a=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(a<<23&4294967295|a>>>9),a=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(a<<21&4294967295|a>>>11),a=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Pi.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)q_(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){q_(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){q_(this,r),i=0;break}}this.h=i,this.i+=e};Pi.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function xt(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var V$={};function ME(t){return-128<=t&&128>t?qz(t,function(e){return new xt([e|0],0>e?-1:0)}):new xt([t|0],0>t?-1:0)}function Ki(t){if(isNaN(t)||!isFinite(t))return el;if(0>t)return Fn(Ki(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Zy;return new xt(e,0)}function h2(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Fn(h2(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ki(Math.pow(e,8)),r=el,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),a=parseInt(t.substring(i,i+s),e);8>s?(s=Ki(Math.pow(e,s)),r=r.R(s).add(Ki(a))):(r=r.R(n),r=r.add(Ki(a)))}return r}var Zy=4294967296,el=ME(0),e0=ME(1),V1=ME(16777216);Ne=xt.prototype;Ne.ea=function(){if(ni(this))return-Fn(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Zy+r)*e,e*=Zy}return t};Ne.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Ss(this))return"0";if(ni(this))return"-"+Fn(this).toString(t);for(var e=Ki(Math.pow(t,6)),n=this,r="";;){var i=qg(n,e).g;n=Hg(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Ss(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};Ne.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Ss(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function ni(t){return t.h==-1}Ne.X=function(t){return t=Hg(this,t),ni(t)?-1:Ss(t)?0:1};function Fn(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new xt(n,~t.h).add(e0)}Ne.abs=function(){return ni(this)?Fn(this):this};Ne.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new xt(n,n[n.length-1]&-2147483648?-1:0)};function Hg(t,e){return t.add(Fn(e))}Ne.R=function(t){if(Ss(this)||Ss(t))return el;if(ni(this))return ni(t)?Fn(this).R(Fn(t)):Fn(Fn(this).R(t));if(ni(t))return Fn(this.R(Fn(t)));if(0>this.X(V1)&&0>t.X(V1))return Ki(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,l=t.D(i)>>>16,h=t.D(i)&65535;n[2*r+2*i]+=a*h,vf(n,2*r+2*i),n[2*r+2*i+1]+=s*h,vf(n,2*r+2*i+1),n[2*r+2*i+1]+=a*l,vf(n,2*r+2*i+1),n[2*r+2*i+2]+=s*l,vf(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new xt(n,0)};function vf(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function hc(t,e){this.g=t,this.h=e}function qg(t,e){if(Ss(e))throw Error("division by zero");if(Ss(t))return new hc(el,el);if(ni(t))return e=qg(Fn(t),e),new hc(Fn(e.g),Fn(e.h));if(ni(e))return e=qg(t,Fn(e)),new hc(Fn(e.g),e.h);if(30<t.g.length){if(ni(t)||ni(e))throw Error("slowDivide_ only works with positive integers.");for(var n=e0,r=e;0>=r.X(t);)n=F1(n),r=F1(r);var i=gu(n,1),s=gu(r,1);for(r=gu(r,2),n=gu(n,2);!Ss(r);){var a=s.add(r);0>=a.X(t)&&(i=i.add(n),s=a),r=gu(r,1),n=gu(n,1)}return e=Hg(t,i.R(e)),new hc(i,e)}for(i=el;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ki(n),a=s.R(e);ni(a)||0<a.X(t);)n-=r,s=Ki(n),a=s.R(e);Ss(s)&&(s=e0),i=i.add(s),t=Hg(t,a)}return new hc(i,t)}Ne.gb=function(t){return qg(this,t).h};Ne.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new xt(n,this.h&t.h)};Ne.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new xt(n,this.h|t.h)};Ne.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new xt(n,this.h^t.h)};function F1(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new xt(n,t.h)}function gu(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new xt(i,t.h)}$g.prototype.createWebChannel=$g.prototype.g;Wr.prototype.send=Wr.prototype.u;Wr.prototype.open=Wr.prototype.m;Wr.prototype.close=Wr.prototype.close;vm.NO_ERROR=0;vm.TIMEOUT=8;vm.HTTP_ERROR=6;Ak.COMPLETE="complete";Pk.EventType=_d;_d.OPEN="a";_d.CLOSE="b";_d.ERROR="c";_d.MESSAGE="d";Rn.prototype.listen=Rn.prototype.O;sn.prototype.listenOnce=sn.prototype.P;sn.prototype.getLastError=sn.prototype.Sa;sn.prototype.getLastErrorCode=sn.prototype.Ia;sn.prototype.getStatus=sn.prototype.da;sn.prototype.getResponseJson=sn.prototype.Wa;sn.prototype.getResponseText=sn.prototype.ja;sn.prototype.send=sn.prototype.ha;sn.prototype.setWithCredentials=sn.prototype.Oa;Pi.prototype.digest=Pi.prototype.l;Pi.prototype.reset=Pi.prototype.reset;Pi.prototype.update=Pi.prototype.j;xt.prototype.add=xt.prototype.add;xt.prototype.multiply=xt.prototype.R;xt.prototype.modulo=xt.prototype.gb;xt.prototype.compare=xt.prototype.X;xt.prototype.toNumber=xt.prototype.ea;xt.prototype.toString=xt.prototype.toString;xt.prototype.getBits=xt.prototype.D;xt.fromNumber=Ki;xt.fromString=h2;var F$=function(){return new $g},B$=function(){return _m()},G_=vm,U$=Ak,j$=iu,B1={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},yf=Pk,z$=sn,$$=Pi,tl=xt,H$={};const U1="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bn.UNAUTHENTICATED=new bn(null),bn.GOOGLE_CREDENTIALS=new bn("google-credentials-uid"),bn.FIRST_PARTY=new bn("first-party-uid"),bn.MOCK_USER=new bn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $l="10.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko=new Zp("@firebase/firestore");function Tu(){return ko.logLevel}function q$(t){ko.setLogLevel(t)}function ve(t,...e){if(ko.logLevel<=ot.DEBUG){const n=e.map(LE);ko.debug(`Firestore (${$l}): ${t}`,...n)}}function dn(t,...e){if(ko.logLevel<=ot.ERROR){const n=e.map(LE);ko.error(`Firestore (${$l}): ${t}`,...n)}}function Ri(t,...e){if(ko.logLevel<=ot.WARN){const n=e.map(LE);ko.warn(`Firestore (${$l}): ${t}`,...n)}}function LE(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(t="Unexpected state"){const e=`FIRESTORE (${$l}) INTERNAL ASSERTION FAILED: `+t;throw dn(e),new Error(e)}function Fe(t,e){t||Oe()}function G$(t,e){t||Oe()}function ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends gr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class W${getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(bn.UNAUTHENTICATED))}shutdown(){}}class K${constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Q${constructor(e){this.t=e,this.currentUser=bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve();let s=new Pn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Pn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},l=h=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Pn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string"),new d2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string"),new bn(e)}}class Y${constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=bn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class X${constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Y$(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(bn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class J${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Z${constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,ve("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Fe(typeof n.token=="string"),this.R=n.token,new J$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=e8(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function et(t,e){return t<e?-1:t>e?1:0}function yl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function g2(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new me(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new me(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new me(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Kt.fromMillis(Date.now())}static fromDate(e){return Kt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Kt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?et(this.nanoseconds,e.nanoseconds):et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new Kt(0,0))}static max(){return new Ue(new Kt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n,r){n===void 0?n=0:n>e.length&&Oe(),r===void 0?r=e.length-n:r>e.length-n&&Oe(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Fh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Fh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class pt extends Fh{construct(e,n,r){return new pt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new me(le.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new pt(n)}static emptyPath(){return new pt([])}}const t8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gt extends Fh{construct(e,n,r){return new Gt(e,n,r)}static isValidIdentifier(e){return t8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Gt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new me(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new me(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new me(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new me(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gt(n)}static emptyPath(){return new Gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(pt.fromString(e))}static fromName(e){return new Ae(pt.fromString(e).popFirst(5))}static empty(){return new Ae(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return pt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new pt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function t0(t){return t.fields.find(e=>e.kind===2)}function ua(t){return t.fields.filter(e=>e.kind!==2)}Gg.UNKNOWN_ID=-1;class Gf{constructor(e,n){this.fieldPath=e,this.kind=n}}class Bh{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Bh(0,Kr.min())}}function p2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(r===1e9?new Kt(n+1,0):new Kt(n,r));return new Kr(i,Ae.empty(),e)}function m2(t){return new Kr(t.readTime,t.key,-1)}class Kr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Kr(Ue.min(),Ae.empty(),-1)}static max(){return new Kr(Ue.max(),Ae.empty(),-1)}}function VE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ae.comparator(t.documentKey,e.documentKey),n!==0?n:et(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class v2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(t){if(t.code!==le.FAILED_PRECONDITION||t.message!==_2)throw t;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ie((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ie?n:ie.resolve(n)}catch(n){return ie.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ie.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ie.reject(n)}static resolve(e){return new ie((n,r)=>{n(e)})}static reject(e){return new ie((n,r)=>{r(e)})}static waitFor(e){return new ie((n,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&n()},h=>r(h))}),a=!0,s===i&&n()})}static or(e){let n=ie.resolve(!1);for(const r of e)n=n.next(i=>i?ie.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new ie((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const g=h;n(e[g]).next(m=>{a[g]=m,++l,l===s&&r(a)},m=>i(m))}})}static doWhile(e,n){return new ie((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Pn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Qc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=FE(r.target.error);this.V.reject(new Qc(e,i))}}static open(e,n,r,i){try{return new bm(n,e.transaction(i,r))}catch(s){throw new Qc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ve("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new r8(n)}}class Ii{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Ii.S(Zt())===12.2&&dn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ve("SimpleDb","Removing database:",e),la(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Eh())return!1;if(Ii.C())return!0;const e=Zt(),n=Ii.S(e),r=0<n&&n<10,i=Ii.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=H$)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(ve("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;n(a)},i.onblocked=()=>{r(new Qc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new me(le.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new me(le.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Qc(e,a))},i.onupgradeneeded=s=>{ve("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{ve("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const l=bm.open(this.db,e,s?"readonly":"readwrite",r),h=i(l).next(g=>(l.g(),g)).catch(g=>(l.abort(g),ie.reject(g))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,g=h.name!=="FirebaseError"&&a<3;if(ve("SimpleDb","Transaction failed with error:",h.message,"Retrying:",g),this.close(),!g)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class n8{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return la(this.k.delete())}}class Qc extends me{constructor(e,n){super(le.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Yo(t){return t.name==="IndexedDbTransactionError"}class r8{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ve("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(ve("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),la(r)}add(e){return ve("SimpleDb","ADD",this.store.name,e,e),la(this.store.add(e))}get(e){return la(this.store.get(e)).next(n=>(n===void 0&&(n=null),ve("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return ve("SimpleDb","DELETE",this.store.name,e),la(this.store.delete(e))}count(){return ve("SimpleDb","COUNT",this.store.name),la(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new ie((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ie((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,n){ve("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,l)=>l.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new ie((r,i)=>{n.onerror=s=>{const a=FE(s.target.error);i(a)},n.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}G(e,n){const r=[];return new ie((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void i();const h=new n8(l),g=n(l.primaryKey,l.value,h);if(g instanceof ie){const m=g.catch(v=>(h.done(),ie.reject(v)));r.push(m)}h.isDone?i():h.$===null?l.continue():l.continue(h.$)}}).next(()=>ie.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function la(t){return new ie((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=FE(r.target.error);n(i)}})}let j1=!1;function FE(t){const e=Ii.S(Zt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new me("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return j1||(j1=!0,setTimeout(()=>{throw r},0)),r}}return t}class i8{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){ve("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{ve("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(n){Yo(n)?ve("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Qo(n)}await this.ee(6e4)})}}class s8{constructor(e,n){this.localStore=e,this.persistence=n}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))}ne(e,n){const r=new Set;let i=n,s=!0;return ie.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return ve("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(l=>{i-=l,r.add(a)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(l=>(ve("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>a.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const a=m2(s);VE(a,r)>0&&(r=a)}),new Kr(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}Ar._e=-1;function Id(t){return t==null}function Uh(t){return t===0&&1/t==-1/0}function y2(t){return typeof t=="number"&&Number.isInteger(t)&&!Uh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=z1(e)),e=o8(t.get(n),e);return z1(e)}function o8(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function z1(t){return t+""}function Qi(t){const e=t.length;if(Fe(e>=2),e===2)return Fe(t.charAt(0)===""&&t.charAt(1)===""),pt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const a=t.indexOf("",s);switch((a<0||a>n)&&Oe(),t.charAt(a+1)){case"":const l=t.substring(s,a);let h;i.length===0?h=l:(i+=l,h=i,i=""),r.push(h);break;case"":i+=t.substring(s,a),i+="\0";break;case"":i+=t.substring(s,a+1);break;default:Oe()}s=a+2}return new pt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(t,e){return[t,pr(e)]}function w2(t,e,n){return[t,pr(e),n]}const a8={},u8=["prefixPath","collectionGroup","readTime","documentId"],l8=["prefixPath","collectionGroup","documentId"],c8=["collectionGroup","readTime","prefixPath","documentId"],h8=["canonicalId","targetId"],d8=["targetId","path"],f8=["path","targetId"],g8=["collectionId","parent"],p8=["indexId","uid"],m8=["uid","sequenceNumber"],_8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],v8=["indexId","uid","orderedDocumentKey"],y8=["userId","collectionPath","documentId"],w8=["userId","collectionPath","largestBatchId"],E8=["userId","collectionGroup","largestBatchId"],E2=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],I8=[...E2,"documentOverlays"],I2=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],S2=I2,S8=[...S2,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0 extends v2{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function Dn(t,e){const n=ke(t);return Ii.M(n.ae,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function su(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function T2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,n){this.comparator=e,this.root=n||Vn.EMPTY}insert(e,n){return new Lt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vn.BLACK,null,null))}remove(e){return new Lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wf(this.root,e,this.comparator,!1)}getReverseIterator(){return new wf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wf(this.root,e,this.comparator,!0)}}class wf{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Vn.RED,this.left=i??Vn.EMPTY,this.right=s??Vn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Vn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Vn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Oe();const e=this.left.check();if(e!==this.right.check())throw Oe();return e+(this.isRed()?0:1)}}Vn.EMPTY=null,Vn.RED=!0,Vn.BLACK=!1;Vn.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe()}get value(){throw Oe()}get color(){throw Oe()}get left(){throw Oe()}get right(){throw Oe()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Vn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.comparator=e,this.data=new Lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new q1(this.data.getIterator())}getIteratorFrom(e){return new q1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof At)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new At(this.comparator);return n.data=e,n}}class q1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function pu(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.fields=e,e.sort(Gt.comparator)}static empty(){return new Pr([])}unionWith(e){let n=new At(Gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Pr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T8(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new x2("Invalid base64 string: "+s):s}}(e);return new En(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new En(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}En.EMPTY_BYTE_STRING=new En("");const x8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function No(t){if(Fe(!!t),typeof t=="string"){let e=0;const n=x8.exec(t);if(Fe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nn(t.seconds),nanos:nn(t.nanos)}}function nn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Do(t){return typeof t=="string"?En.fromBase64String(t):En.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function BE(t){const e=t.mapValue.fields.__previous_value__;return Am(e)?BE(e):e}function jh(t){const e=No(t.mapValue.fields.__local_write_time__.timestampValue);return new Kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C8{constructor(e,n,r,i,s,a,l,h,g){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=g}}class Oo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Oo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Kf={nullValue:"NULL_VALUE"};function za(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Am(t)?4:C2(t)?9007199254740991:10:Oe()}function ss(t,e){if(t===e)return!0;const n=za(t);if(n!==za(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jh(t).isEqual(jh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=No(i.timestampValue),l=No(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Do(i.bytesValue).isEqual(Do(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nn(i.geoPointValue.latitude)===nn(s.geoPointValue.latitude)&&nn(i.geoPointValue.longitude)===nn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nn(i.integerValue)===nn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=nn(i.doubleValue),l=nn(s.doubleValue);return a===l?Uh(a)===Uh(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return yl(t.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(H1(a)!==H1(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!ss(a[h],l[h])))return!1;return!0}(t,e);default:return Oe()}}function zh(t,e){return(t.values||[]).find(n=>ss(n,e))!==void 0}function Mo(t,e){if(t===e)return 0;const n=za(t),r=za(e);if(n!==r)return et(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return et(t.booleanValue,e.booleanValue);case 2:return function(s,a){const l=nn(s.integerValue||s.doubleValue),h=nn(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(t,e);case 3:return G1(t.timestampValue,e.timestampValue);case 4:return G1(jh(t),jh(e));case 5:return et(t.stringValue,e.stringValue);case 6:return function(s,a){const l=Do(s),h=Do(a);return l.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let g=0;g<l.length&&g<h.length;g++){const m=et(l[g],h[g]);if(m!==0)return m}return et(l.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const l=et(nn(s.latitude),nn(a.latitude));return l!==0?l:et(nn(s.longitude),nn(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],h=a.values||[];for(let g=0;g<l.length&&g<h.length;++g){const m=Mo(l[g],h[g]);if(m)return m}return et(l.length,h.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===lo.mapValue&&a===lo.mapValue)return 0;if(s===lo.mapValue)return 1;if(a===lo.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),g=a.fields||{},m=Object.keys(g);h.sort(),m.sort();for(let v=0;v<h.length&&v<m.length;++v){const I=et(h[v],m[v]);if(I!==0)return I;const S=Mo(l[h[v]],g[m[v]]);if(S!==0)return S}return et(h.length,m.length)}(t.mapValue,e.mapValue);default:throw Oe()}}function G1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return et(t,e);const n=No(t),r=No(e),i=et(n.seconds,r.seconds);return i!==0?i:et(n.nanos,r.nanos)}function wl(t){return r0(t)}function r0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=No(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Do(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=r0(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${r0(n.fields[a])}`;return i+"}"}(t.mapValue):Oe()}function $a(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function i0(t){return!!t&&"integerValue"in t}function $h(t){return!!t&&"arrayValue"in t}function W1(t){return!!t&&"nullValue"in t}function K1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qf(t){return!!t&&"mapValue"in t}function Yc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return su(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Yc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Yc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function C2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function b8(t){return"nullValue"in t?Kf:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?$a(Oo.empty(),Ae.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Oe()}function A8(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?$a(Oo.empty(),Ae.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?lo:Oe()}function Q1(t,e){const n=Mo(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Y1(t,e){const n=Mo(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.value=e}static empty(){return new Bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Qf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yc(n)}setAll(e){let n=Gt.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const h=this.getFieldsMap(n);this.applyChanges(h,r,i),r={},i=[],n=l.popLast()}a?r[l.lastSegment()]=Yc(a):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Qf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Qf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){su(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Bn(Yc(this.value))}}function b2(t){const e=[];return su(t.fields,(n,r)=>{const i=new Gt([n]);if(Qf(r)){const s=b2(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Pr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,n,r,i,s,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Ut(e,0,Ue.min(),Ue.min(),Ue.min(),Bn.empty(),0)}static newFoundDocument(e,n,r,i){return new Ut(e,1,n,Ue.min(),r,i,0)}static newNoDocument(e,n){return new Ut(e,2,n,Ue.min(),Ue.min(),Bn.empty(),0)}static newUnknownDocument(e,n){return new Ut(e,3,n,Ue.min(),Ue.min(),Bn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,n){this.position=e,this.inclusive=n}}function X1(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=Ae.comparator(Ae.fromName(a.referenceValue),n.key):r=Mo(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function J1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ss(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,n="asc"){this.field=e,this.dir=n}}function P8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{}class ut extends A2{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new R8(e,n,r):n==="array-contains"?new D8(e,r):n==="in"?new O2(e,r):n==="not-in"?new O8(e,r):n==="array-contains-any"?new M8(e,r):new ut(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new k8(e,r):new N8(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Mo(n,this.value)):n!==null&&za(this.value)===za(n)&&this.matchesComparison(Mo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends A2{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new St(e,n)}matches(e){return El(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function El(t){return t.op==="and"}function s0(t){return t.op==="or"}function UE(t){return P2(t)&&El(t)}function P2(t){for(const e of t.filters)if(e instanceof St)return!1;return!0}function o0(t){if(t instanceof ut)return t.field.canonicalString()+t.op.toString()+wl(t.value);if(UE(t))return t.filters.map(e=>o0(e)).join(",");{const e=t.filters.map(n=>o0(n)).join(",");return`${t.op}(${e})`}}function R2(t,e){return t instanceof ut?function(r,i){return i instanceof ut&&r.op===i.op&&r.field.isEqual(i.field)&&ss(r.value,i.value)}(t,e):t instanceof St?function(r,i){return i instanceof St&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&R2(a,i.filters[l]),!0):!1}(t,e):void Oe()}function k2(t,e){const n=t.filters.concat(e);return St.create(n,t.op)}function N2(t){return t instanceof ut?function(n){return`${n.field.canonicalString()} ${n.op} ${wl(n.value)}`}(t):t instanceof St?function(n){return n.op.toString()+" {"+n.getFilters().map(N2).join(" ,")+"}"}(t):"Filter"}class R8 extends ut{constructor(e,n,r){super(e,n,r),this.key=Ae.fromName(r.referenceValue)}matches(e){const n=Ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class k8 extends ut{constructor(e,n){super(e,"in",n),this.keys=D2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class N8 extends ut{constructor(e,n){super(e,"not-in",n),this.keys=D2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function D2(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ae.fromName(r.referenceValue))}class D8 extends ut{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return $h(n)&&zh(n.arrayValue,this.value)}}class O2 extends ut{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&zh(this.value.arrayValue,n)}}class O8 extends ut{constructor(e,n){super(e,"not-in",n)}matches(e){if(zh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!zh(this.value.arrayValue,n)}}class M8 extends ut{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!$h(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(e,n=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ce=null}}function a0(t,e=null,n=[],r=[],i=null,s=null,a=null){return new L8(t,e,n,r,i,s,a)}function Ha(t){const e=ke(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>o0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Id(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wl(r)).join(",")),e.ce=n}return e.ce}function Sd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!P8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!R2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!J1(t.startAt,e.startAt)&&J1(t.endAt,e.endAt)}function Wg(t){return Ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Kg(t,e){return t.filters.filter(n=>n instanceof ut&&n.field.isEqual(e))}function Z1(t,e,n){let r=Kf,i=!0;for(const s of Kg(t,e)){let a=Kf,l=!0;switch(s.op){case"<":case"<=":a=b8(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Kf}Q1({value:r,inclusive:i},{value:a,inclusive:l})<0&&(r=a,i=l)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const a=n.position[s];Q1({value:r,inclusive:i},{value:a,inclusive:n.inclusive})<0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}function ex(t,e,n){let r=lo,i=!0;for(const s of Kg(t,e)){let a=lo,l=!0;switch(s.op){case">=":case">":a=A8(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=lo}Y1({value:r,inclusive:i},{value:a,inclusive:l})>0&&(r=a,i=l)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const a=n.position[s];Y1({value:r,inclusive:i},{value:a,inclusive:n.inclusive})>0&&(r=a,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n=null,r=[],i=[],s=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function M2(t,e,n,r,i,s,a,l){return new js(t,e,n,r,i,s,a,l)}function Hl(t){return new js(t)}function tx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jE(t){return t.collectionGroup!==null}function nl(t){const e=ke(t);if(e.le===null){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new At(Gt.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(g=>{g.isInequality()&&(l=l.add(g.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new Hh(s,r))}),n.has(Gt.keyField().canonicalString())||e.le.push(new Hh(Gt.keyField(),r))}return e.le}function mr(t){const e=ke(t);return e.he||(e.he=V8(e,nl(t))),e.he}function V8(t,e){if(t.limitType==="F")return a0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Hh(i.field,s)});const n=t.endAt?new Lo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Lo(t.startAt.position,t.startAt.inclusive):null;return a0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function u0(t,e){const n=t.filters.concat([e]);return new js(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Qg(t,e,n){return new js(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Td(t,e){return Sd(mr(t),mr(e))&&t.limitType===e.limitType}function L2(t){return`${Ha(mr(t))}|lt:${t.limitType}`}function xu(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>N2(i)).join(", ")}]`),Id(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>wl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>wl(i)).join(",")),`Target(${r})`}(mr(t))}; limitType=${t.limitType})`}function xd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Ae.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of nl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){const g=X1(a,l,h);return a.inclusive?g<=0:g<0}(r.startAt,nl(r),i)||r.endAt&&!function(a,l,h){const g=X1(a,l,h);return a.inclusive?g>=0:g>0}(r.endAt,nl(r),i))}(t,e)}function V2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function F2(t){return(e,n)=>{let r=!1;for(const i of nl(t)){const s=F8(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function F8(t,e,n){const r=t.field.isKeyField()?Ae.comparator(e.key,n.key):function(s,a,l){const h=a.data.field(s),g=l.data.field(s);return h!==null&&g!==null?Mo(h,g):Oe()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){su(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return T2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8=new Lt(Ae.comparator);function Rr(){return B8}const B2=new Lt(Ae.comparator);function kc(...t){let e=B2;for(const n of t)e=e.insert(n.key,n);return e}function U2(t){let e=B2;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Yi(){return Xc()}function j2(){return Xc()}function Xc(){return new Xo(t=>t.toString(),(t,e)=>t.isEqual(e))}const U8=new Lt(Ae.comparator),j8=new At(Ae.comparator);function nt(...t){let e=j8;for(const n of t)e=e.add(n);return e}const z8=new At(et);function zE(){return z8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z2(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uh(e)?"-0":e}}function $2(t){return{integerValue:""+t}}function H2(t,e){return y2(e)?$2(e):z2(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(){this._=void 0}}function $8(t,e,n){return t instanceof Il?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Am(s)&&(s=BE(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof qa?G2(t,e):t instanceof Ga?W2(t,e):function(i,s){const a=q2(i,s),l=nx(a)+nx(i.Ie);return i0(a)&&i0(i.Ie)?$2(l):z2(i.serializer,l)}(t,e)}function H8(t,e,n){return t instanceof qa?G2(t,e):t instanceof Ga?W2(t,e):n}function q2(t,e){return t instanceof Sl?function(r){return i0(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Il extends Pm{}class qa extends Pm{constructor(e){super(),this.elements=e}}function G2(t,e){const n=K2(e);for(const r of t.elements)n.some(i=>ss(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ga extends Pm{constructor(e){super(),this.elements=e}}function W2(t,e){let n=K2(e);for(const r of t.elements)n=n.filter(i=>!ss(i,r));return{arrayValue:{values:n}}}class Sl extends Pm{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function nx(t){return nn(t.integerValue||t.doubleValue)}function K2(t){return $h(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e,n){this.field=e,this.transform=n}}function q8(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof qa&&i instanceof qa||r instanceof Ga&&i instanceof Ga?yl(r.elements,i.elements,ss):r instanceof Sl&&i instanceof Sl?ss(r.Ie,i.Ie):r instanceof Il&&i instanceof Il}(t.transform,e.transform)}class G8{constructor(e,n){this.version=e,this.transformResults=n}}class Wt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Wt}static exists(e){return new Wt(void 0,e)}static updateTime(e){return new Wt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Rm{}function Q2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gl(t.key,Wt.none()):new ql(t.key,t.data,Wt.none());{const n=t.data,r=Bn.empty();let i=new At(Gt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new zs(t.key,r,new Pr(i.toArray()),Wt.none())}}function W8(t,e,n){t instanceof ql?function(i,s,a){const l=i.value.clone(),h=ix(i.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof zs?function(i,s,a){if(!Yf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=ix(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(Y2(i)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Jc(t,e,n,r){return t instanceof ql?function(s,a,l,h){if(!Yf(s.precondition,a))return l;const g=s.value.clone(),m=sx(s.fieldTransforms,h,a);return g.setAll(m),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null}(t,e,n,r):t instanceof zs?function(s,a,l,h){if(!Yf(s.precondition,a))return l;const g=sx(s.fieldTransforms,h,a),m=a.data;return m.setAll(Y2(s)),m.setAll(g),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(v=>v.field))}(t,e,n,r):function(s,a,l){return Yf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function K8(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=q2(r.transform,i||null);s!=null&&(n===null&&(n=Bn.empty()),n.set(r.field,s))}return n||null}function rx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&yl(r,i,(s,a)=>q8(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ql extends Rm{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class zs extends Rm{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Y2(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ix(t,e,n){const r=new Map;Fe(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,H8(a,l,n[i]))}return r}function sx(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,$8(s,a,e))}return r}class Gl extends Rm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $E extends Rm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&W8(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=j2();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=n.has(i.key)?null:l;const h=Q2(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),nt())}isEqual(e){return this.batchId===e.batchId&&yl(this.mutations,e.mutations,(n,r)=>rx(n,r))&&yl(this.baseMutations,e.baseMutations,(n,r)=>rx(n,r))}}class qE{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Fe(e.mutations.length===r.length);let i=function(){return U8}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new qE(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,gt;function X2(t){switch(t){default:return Oe();case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0}}function J2(t){if(t===void 0)return dn("GRPC error has no .code"),le.UNKNOWN;switch(t){case mn.OK:return le.OK;case mn.CANCELLED:return le.CANCELLED;case mn.UNKNOWN:return le.UNKNOWN;case mn.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case mn.INTERNAL:return le.INTERNAL;case mn.UNAVAILABLE:return le.UNAVAILABLE;case mn.UNAUTHENTICATED:return le.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case mn.NOT_FOUND:return le.NOT_FOUND;case mn.ALREADY_EXISTS:return le.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return le.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case mn.ABORTED:return le.ABORTED;case mn.OUT_OF_RANGE:return le.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return le.UNIMPLEMENTED;case mn.DATA_LOSS:return le.DATA_LOSS;default:return Oe()}}(gt=mn||(mn={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y8=new tl([4294967295,4294967295],0);function ox(t){const e=Z2().encode(t),n=new $$;return n.update(e),new Uint8Array(n.digest())}function ax(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new tl([n,r],0),new tl([i,s],0)]}class WE{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Nc(`Invalid padding: ${n}`);if(r<0)throw new Nc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Nc(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=tl.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(tl.fromNumber(r)));return i.compare(Y8)===1&&(i=new tl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=ox(e),[r,i]=ax(n);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new WE(s,i,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Te===0)return;const n=ox(e),[r,i]=ax(n);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Ad.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new bd(Ue.min(),i,new Lt(et),Rr(),nt())}}class Ad{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ad(r,n,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class eN{constructor(e,n){this.targetId=e,this.fe=n}}class tN{constructor(e,n,r=En.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ux{constructor(){this.ge=0,this.pe=cx(),this.ye=En.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=nt(),n=nt(),r=nt();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Oe()}}),new Ad(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=cx()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Fe(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class X8{constructor(e){this.Le=e,this.ke=new Map,this.qe=Rr(),this.Qe=lx(),this.Ke=new Lt(et)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:Oe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(Wg(s))if(r===0){const a=new Ae(s.path);this.We(n,a,Ut.newNoDocument(a,Ue.min()))}else Fe(r===1);else{const a=this.Ze(n);if(a!==r){const l=this.Xe(e),h=l?this.et(l,e,a):1;if(h!==0){this.He(n);const g=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,g)}}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,l;try{a=Do(r).toUint8Array()}catch(h){if(h instanceof x2)return Ri("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new WE(a,i,s)}catch(h){return Ri(h instanceof Nc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Te===0?null:l}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Le.nt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,a)=>{const l=this.Ye(a);if(l){if(s.current&&Wg(l.target)){const h=new Ae(l.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,Ut.newNoDocument(h,e))}s.De&&(n.set(a,s.ve()),s.Fe())}});let r=nt();this.Qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const g=this.Ye(h);return!g||g.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new bd(e,n,this.Ke,this.qe,r);return this.qe=Rr(),this.Qe=lx(),this.Ke=new Lt(et),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new ux,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new At(et),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||ve("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new ux),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function lx(){return new Lt(Ae.comparator)}function cx(){return new Lt(Ae.comparator)}const J8={asc:"ASCENDING",desc:"DESCENDING"},Z8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eH={and:"AND",or:"OR"};class tH{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function l0(t,e){return t.useProto3Json||Id(e)?e:{value:e}}function Tl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function nH(t,e){return Tl(t,e.toTimestamp())}function gn(t){return Fe(!!t),Ue.fromTimestamp(function(n){const r=No(n);return new Kt(r.seconds,r.nanos)}(t))}function KE(t,e){return function(r){return new pt(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function rN(t){const e=pt.fromString(t);return Fe(dN(e)),e}function qh(t,e){return KE(t.databaseId,e.path)}function ts(t,e){const n=rN(e);if(n.get(1)!==t.databaseId.projectId)throw new me(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new me(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ae(sN(n))}function c0(t,e){return KE(t.databaseId,e)}function iN(t){const e=rN(t);return e.length===4?pt.emptyPath():sN(e)}function Gh(t){return new pt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sN(t){return Fe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function hx(t,e,n){return{name:qh(t,e),fields:n.value.mapValue.fields}}function oN(t,e,n){const r=ts(t,e.name),i=gn(e.updateTime),s=e.createTime?gn(e.createTime):Ue.min(),a=new Bn({mapValue:{fields:e.fields}}),l=Ut.newFoundDocument(r,i,s,a);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function rH(t,e){return"found"in e?function(r,i){Fe(!!i.found),i.found.name,i.found.updateTime;const s=ts(r,i.found.name),a=gn(i.found.updateTime),l=i.found.createTime?gn(i.found.createTime):Ue.min(),h=new Bn({mapValue:{fields:i.found.fields}});return Ut.newFoundDocument(s,a,l,h)}(t,e):"missing"in e?function(r,i){Fe(!!i.missing),Fe(!!i.readTime);const s=ts(r,i.missing),a=gn(i.readTime);return Ut.newNoDocument(s,a)}(t,e):Oe()}function iH(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(g,m){return g.useProto3Json?(Fe(m===void 0||typeof m=="string"),En.fromBase64String(m||"")):(Fe(m===void 0||m instanceof Uint8Array),En.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(g){const m=g.code===void 0?le.UNKNOWN:J2(g.code);return new me(m,g.message||"")}(a);n=new tN(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ts(t,r.document.name),s=gn(r.document.updateTime),a=r.document.createTime?gn(r.document.createTime):Ue.min(),l=new Bn({mapValue:{fields:r.document.fields}}),h=Ut.newFoundDocument(i,s,a,l),g=r.targetIds||[],m=r.removedTargetIds||[];n=new Xf(g,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ts(t,r.document),s=r.readTime?gn(r.readTime):Ue.min(),a=Ut.newNoDocument(i,s),l=r.removedTargetIds||[];n=new Xf([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ts(t,r.document),s=r.removedTargetIds||[];n=new Xf([],s,i,null)}else{if(!("filter"in e))return Oe();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Q8(i,s),l=r.targetId;n=new eN(l,a)}}return n}function Wh(t,e){let n;if(e instanceof ql)n={update:hx(t,e.key,e.value)};else if(e instanceof Gl)n={delete:qh(t,e.key)};else if(e instanceof zs)n={update:hx(t,e.key,e.data),updateMask:cH(e.fieldMask)};else{if(!(e instanceof $E))return Oe();n={verify:qh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Il)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof qa)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ga)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Sl)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw Oe()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:nH(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Oe()}(t,e.precondition)),n}function h0(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Wt.updateTime(gn(s.updateTime)):s.exists!==void 0?Wt.exists(s.exists):Wt.none()}(e.currentDocument):Wt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;if("setToServerValue"in l)Fe(l.setToServerValue==="REQUEST_TIME"),h=new Il;else if("appendMissingElements"in l){const m=l.appendMissingElements.values||[];h=new qa(m)}else if("removeAllFromArray"in l){const m=l.removeAllFromArray.values||[];h=new Ga(m)}else"increment"in l?h=new Sl(a,l.increment):Oe();const g=Gt.fromServerFormat(l.fieldPath);return new Cd(g,h)}(t,i)):[];if(e.update){e.update.name;const i=ts(t,e.update.name),s=new Bn({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const g=h.fieldPaths||[];return new Pr(g.map(m=>Gt.fromServerFormat(m)))}(e.updateMask);return new zs(i,s,a,n,r)}return new ql(i,s,n,r)}if(e.delete){const i=ts(t,e.delete);return new Gl(i,n)}if(e.verify){const i=ts(t,e.verify);return new $E(i,n)}return Oe()}function sH(t,e){return t&&t.length>0?(Fe(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?gn(i.updateTime):gn(s);return a.isEqual(Ue.min())&&(a=gn(s)),new G8(a,i.transformResults||[])}(n,e))):[]}function aN(t,e){return{documents:[c0(t,e.path)]}}function uN(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=c0(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=c0(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return hN(St.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(g=>function(v){return{field:Cu(v.field),direction:aH(v.dir)}}(g))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const a=l0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),n}function lN(t){let e=iN(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Fe(r===1);const m=n.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];n.where&&(s=function(v){const I=cN(v);return I instanceof St&&UE(I)?I.getFilters():[I]}(n.where));let a=[];n.orderBy&&(a=function(v){return v.map(I=>function(j){return new Hh(bu(j.field),function(J){switch(J){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(j.direction))}(I))}(n.orderBy));let l=null;n.limit&&(l=function(v){let I;return I=typeof v=="object"?v.value:v,Id(I)?null:I}(n.limit));let h=null;n.startAt&&(h=function(v){const I=!!v.before,S=v.values||[];return new Lo(S,I)}(n.startAt));let g=null;return n.endAt&&(g=function(v){const I=!v.before,S=v.values||[];return new Lo(S,I)}(n.endAt)),M2(e,i,a,s,l,"F",h,g)}function oH(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function cN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=bu(n.unaryFilter.field);return ut.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=bu(n.unaryFilter.field);return ut.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bu(n.unaryFilter.field);return ut.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=bu(n.unaryFilter.field);return ut.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Oe()}}(t):t.fieldFilter!==void 0?function(n){return ut.create(bu(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Oe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return St.create(n.compositeFilter.filters.map(r=>cN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Oe()}}(n.compositeFilter.op))}(t):Oe()}function aH(t){return J8[t]}function uH(t){return Z8[t]}function lH(t){return eH[t]}function Cu(t){return{fieldPath:t.canonicalString()}}function bu(t){return Gt.fromServerFormat(t.fieldPath)}function hN(t){return t instanceof ut?function(n){if(n.op==="=="){if(K1(n.value))return{unaryFilter:{field:Cu(n.field),op:"IS_NAN"}};if(W1(n.value))return{unaryFilter:{field:Cu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(K1(n.value))return{unaryFilter:{field:Cu(n.field),op:"IS_NOT_NAN"}};if(W1(n.value))return{unaryFilter:{field:Cu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cu(n.field),op:uH(n.op),value:n.value}}}(t):t instanceof St?function(n){const r=n.getFilters().map(i=>hN(i));return r.length===1?r[0]:{compositeFilter:{op:lH(n.op),filters:r}}}(t):Oe()}function cH(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function dN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,n,r,i,s=Ue.min(),a=Ue.min(),l=En.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new Ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.ut=e}}function hH(t,e){let n;if(e.document)n=oN(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ae.fromSegments(e.noDocument.path),i=Ka(e.noDocument.readTime);n=Ut.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Oe();{const r=Ae.fromSegments(e.unknownDocument.path),i=Ka(e.unknownDocument.version);n=Ut.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Kt(i[0],i[1]);return Ue.fromTimestamp(s)}(e.readTime)),n}function dx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Yg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:qh(s,a.key),fields:a.data.value.mapValue.fields,updateTime:Tl(s,a.version.toTimestamp()),createTime:Tl(s,a.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Wa(e.version)};else{if(!e.isUnknownDocument())return Oe();r.unknownDocument={path:n.path.toArray(),version:Wa(e.version)}}return r}function Yg(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Wa(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ka(t){const e=new Kt(t.seconds,t.nanoseconds);return Ue.fromTimestamp(e)}function ca(t,e){const n=(e.baseMutations||[]).map(s=>h0(t.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>h0(t.ut,s)),i=Kt.fromMillis(e.localWriteTimeMs);return new HE(e.batchId,i,n,r)}function Dc(t){const e=Ka(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ka(t.lastLimboFreeSnapshotVersion):Ue.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return Fe(s.documents.length===1),mr(Hl(iN(s.documents[0])))}(t.query):function(s){return mr(lN(s))}(t.query),new Ts(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,En.fromBase64String(t.resumeToken))}function gN(t,e){const n=Wa(e.snapshotVersion),r=Wa(e.lastLimboFreeSnapshotVersion);let i;i=Wg(e.target)?aN(t.ut,e.target):uN(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ha(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function QE(t){const e=lN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Qg(e,e.limit,"L"):e}function W_(t,e){return new GE(e.largestBatchId,h0(t.ut,e.overlayMutation))}function fx(t,e){const n=e.path.lastSegment();return[t,pr(e.path.popLast()),n]}function gx(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Wa(r.readTime),documentKey:pr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dH{getBundleMetadata(e,n){return px(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ka(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return px(e).put(function(i){return{bundleId:i.id,createTime:Wa(gn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return mx(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:QE(s.bundledQuery),readTime:Ka(s.readTime)}}(r)})}saveNamedQuery(e,n){return mx(e).put(function(i){return{name:i.name,readTime:Wa(gn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function px(t){return Dn(t,"bundles")}function mx(t){return Dn(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){const r=n.uid||"";return new km(e,r)}getOverlay(e,n){return dc(e).get(fx(this.userId,n)).next(r=>r?W_(this.serializer,r):null)}getOverlays(e,n){const r=Yi();return ie.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,a)=>{const l=new GE(n,a);i.push(this.lt(e,l))}),ie.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(a=>i.add(pr(a.getCollectionPath())));const s=[];return i.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(dc(e).H("collectionPathOverlayIndex",l))}),ie.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Yi(),s=pr(n),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return dc(e).W("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const g=W_(this.serializer,h);i.set(g.getKey(),g)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Yi();let a;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return dc(e).Y({index:"collectionGroupOverlayIndex",range:l},(h,g,m)=>{const v=W_(this.serializer,g);s.size()<i||v.largestBatchId===a?(s.set(v.getKey(),v),a=v.largestBatchId):m.done()}).next(()=>s)}lt(e,n){return dc(e).put(function(i,s,a){const[l,h,g]=fx(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:g,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Wh(i.ut,a.mutation)}}(this.serializer,this.userId,n))}}function dc(t){return Dn(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(nn(e.integerValue));else if("doubleValue"in e){const r=nn(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Uh(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(Do(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?C2(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):Oe()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),Ae.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}ha.St=new ha;function fH(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function _x(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=fH(255&r[s]);if(i+=a,a!==8)break}return i}(t);return Math.ceil(e/8)}class gH{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=_x(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=_x(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class pH{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class mH{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class fc{constructor(){this.Wt=new gH,this.Gt=new pH(this.Wt),this.zt=new mH(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new da(this.indexId,this.documentKey,this.arrayValue,r)}}function Ks(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=vx(t.arrayValue,e.arrayValue),n!==0?n:(n=vx(t.directionalValue,e.directionalValue),n!==0?n:Ae.comparator(t.documentKey,e.documentKey)))}function vx(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(e){this.Jt=new At((n,r)=>Gt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Fe(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=t0(e);if(n!==void 0&&!this.tn(n))return!1;const r=ua(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const l=this.Jt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const h=r[s];if(!this.nn(l,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const l=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],l))return!1}return!0}sn(){if(this.Xt)return null;let e=new At(Gt.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Gf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Gf(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Gf(r.field,r.dir==="asc"?0:1)));return new Gg(Gg.UNKNOWN_ID,this.collectionId,n,Bh.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(t){var e,n;if(Fe(t instanceof ut||t instanceof St),t instanceof ut){if(t instanceof O2){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>ut.create(t.field,"==",s)))||[];return St.create(i,"or")}return t}const r=t.filters.map(i=>pN(i));return St.create(r,t.op)}function _H(t){if(t.getFilters().length===0)return[];const e=g0(pN(t));return Fe(mN(e)),d0(e)||f0(e)?[e]:e.getFilters()}function d0(t){return t instanceof ut}function f0(t){return t instanceof St&&UE(t)}function mN(t){return d0(t)||f0(t)||function(n){if(n instanceof St&&s0(n)){for(const r of n.getFilters())if(!d0(r)&&!f0(r))return!1;return!0}return!1}(t)}function g0(t){if(Fe(t instanceof ut||t instanceof St),t instanceof ut)return t;if(t.filters.length===1)return g0(t.filters[0]);const e=t.filters.map(r=>g0(r));let n=St.create(e,t.op);return n=Xg(n),mN(n)?n:(Fe(n instanceof St),Fe(El(n)),Fe(n.filters.length>1),n.filters.reduce((r,i)=>YE(r,i)))}function YE(t,e){let n;return Fe(t instanceof ut||t instanceof St),Fe(e instanceof ut||e instanceof St),n=t instanceof ut?e instanceof ut?function(i,s){return St.create([i,s],"and")}(t,e):wx(t,e):e instanceof ut?wx(e,t):function(i,s){if(Fe(i.filters.length>0&&s.filters.length>0),El(i)&&El(s))return k2(i,s.getFilters());const a=s0(i)?i:s,l=s0(i)?s:i,h=a.filters.map(g=>YE(g,l));return St.create(h,"or")}(t,e),Xg(n)}function wx(t,e){if(El(e))return k2(e,t.getFilters());{const n=e.filters.map(r=>YE(t,r));return St.create(n,"or")}}function Xg(t){if(Fe(t instanceof ut||t instanceof St),t instanceof ut)return t;const e=t.getFilters();if(e.length===1)return Xg(e[0]);if(P2(t))return t;const n=e.map(i=>Xg(i)),r=[];return n.forEach(i=>{i instanceof ut?r.push(i):i instanceof St&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:St.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vH{constructor(){this.on=new XE}addToCollectionParentIndex(e,n){return this.on.add(n),ie.resolve()}getCollectionParents(e,n){return ie.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return ie.resolve()}deleteFieldIndex(e,n){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,n){return ie.resolve()}getDocumentsMatchingTarget(e,n){return ie.resolve(null)}getIndexType(e,n){return ie.resolve(0)}getFieldIndexes(e,n){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,n){return ie.resolve(Kr.min())}getMinOffsetFromCollectionGroup(e,n){return ie.resolve(Kr.min())}updateCollectionGroup(e,n,r){return ie.resolve()}updateIndexEntries(e,n){return ie.resolve()}}class XE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new At(pt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new At(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef=new Uint8Array(0);class yH{constructor(e,n){this.user=e,this.databaseId=n,this._n=new XE,this.an=new Xo(r=>Ha(r),(r,i)=>Sd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:pr(i)};return Ex(e).put(s)}return ie.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[g2(n),""],!1,!0);return Ex(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==n)break;r.push(Qi(a.parent))}return r})}addFieldIndex(e,n){const r=gc(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const a=_u(e);return s.next(l=>{a.put(gx(l,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=gc(e),i=_u(e),s=mu(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=gc(e),r=mu(e),i=_u(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return ie.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new yx(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=mu(e);let i=!0;const s=new Map;return ie.forEach(this.un(n),a=>this.cn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=nt();const l=[];return ie.forEach(s,(h,g)=>{ve("IndexedDbIndexManager",`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(Z=>`${Z.fieldPath}:${Z.kind}`).join(",")}`}(h)} to execute ${Ha(n)}`);const m=function(U,Z){const ne=t0(Z);if(ne===void 0)return null;for(const te of Kg(U,ne.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null}(g,h),v=function(U,Z){const ne=new Map;for(const te of ua(Z))for(const oe of Kg(U,te.fieldPath))switch(oe.op){case"==":case"in":ne.set(te.fieldPath.canonicalString(),oe.value);break;case"not-in":case"!=":return ne.set(te.fieldPath.canonicalString(),oe.value),Array.from(ne.values())}return null}(g,h),I=function(U,Z){const ne=[];let te=!0;for(const oe of ua(Z)){const ce=oe.kind===0?Z1(U,oe.fieldPath,U.startAt):ex(U,oe.fieldPath,U.startAt);ne.push(ce.value),te&&(te=ce.inclusive)}return new Lo(ne,te)}(g,h),S=function(U,Z){const ne=[];let te=!0;for(const oe of ua(Z)){const ce=oe.kind===0?ex(U,oe.fieldPath,U.endAt):Z1(U,oe.fieldPath,U.endAt);ne.push(ce.value),te&&(te=ce.inclusive)}return new Lo(ne,te)}(g,h),j=this.ln(h,g,I),z=this.ln(h,g,S),J=this.hn(h,g,v),V=this.Pn(h.indexId,m,j,I.inclusive,z,S.inclusive,J);return ie.forEach(V,B=>r.j(B,n.limit).next(U=>{U.forEach(Z=>{const ne=Ae.fromSegments(Z.documentKey);a.has(ne)||(a=a.add(ne),l.push(ne))})}))}).next(()=>l)}return ie.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=_H(St.create(e.filters,"and")).map(r=>a0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,a,l){const h=(n!=null?n.length:1)*Math.max(r.length,s.length),g=h/(n!=null?n.length:1),m=[];for(let v=0;v<h;++v){const I=n?this.In(n[v/g]):Ef,S=this.Tn(e,I,r[v%g],i),j=this.En(e,I,s[v%g],a),z=l.map(J=>this.Tn(e,I,J,!0));m.push(...this.createRange(S,j,z))}return m}Tn(e,n,r,i){const s=new da(e,Ae.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new da(e,Ae.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new yx(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const l of s)r.en(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,n){let r=2;const i=this.un(n);return ie.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let g=new At(Gt.comparator),m=!1;for(const v of h.filters)for(const I of v.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?m=!0:g=g.add(I.field));for(const v of h.orderBy)v.field.isKeyField()||(g=g.add(v.field));return g.size+(m?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(n)&&i.length>1&&r===2?1:r)}dn(e,n){const r=new fc;for(const i of ua(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);ha.St.ht(s,a)}return r.Ut()}In(e){const n=new fc;return ha.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new fc;return ha.St.ht($a(this.databaseId,n),r.jt(function(s){const a=ua(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let i=[];i.push(new fc);let s=0;for(const a of ua(e)){const l=r[s++];for(const h of i)if(this.Rn(n,a.fieldPath)&&$h(l))i=this.Vn(i,a,l);else{const g=h.jt(a.kind);ha.St.ht(l,g)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const l of i){const h=new fc;h.seed(l.Ut()),ha.St.ht(a,h.jt(n.kind)),s.push(h)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof ut&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=gc(e),i=_u(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const a=[];return ie.forEach(s,l=>i.get([l.indexId,this.uid]).next(h=>{a.push(function(m,v){const I=v?new Bh(v.sequenceNumber,new Kr(Ka(v.readTime),new Ae(Qi(v.documentKey)),v.largestBatchId)):Bh.empty(),S=m.fields.map(([j,z])=>new Gf(Gt.fromServerFormat(j),z));return new Gg(m.indexId,m.collectionGroup,S,I)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:et(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=gc(e),s=_u(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>ie.forEach(l,h=>s.put(gx(h.indexId,this.user,a,r)))))}updateIndexEntries(e,n){const r=new Map;return ie.forEach(n,(i,s)=>{const a=r.get(i.collectionGroup);return(a?ie.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),ie.forEach(l,h=>this.gn(e,i,h).next(g=>{const m=this.pn(s,h);return g.isEqual(m)?ie.resolve():this.yn(e,s,h,g,m)}))))})}wn(e,n,r,i){return mu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return mu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=mu(e);let s=new At(Ks);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(a,l)=>{s=s.add(new da(r.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>s)}pn(e,n){let r=new At(Ks);const i=this.dn(n,e);if(i==null)return r;const s=t0(n);if(s!=null){const a=e.data.field(s.fieldPath);if($h(a))for(const l of a.arrayValue.values||[])r=r.add(new da(n.indexId,e.key,this.In(l),i))}else r=r.add(new da(n.indexId,e.key,Ef,i));return r}yn(e,n,r,i,s){ve("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const a=[];return function(h,g,m,v,I){const S=h.getIterator(),j=g.getIterator();let z=pu(S),J=pu(j);for(;z||J;){let V=!1,B=!1;if(z&&J){const U=m(z,J);U<0?B=!0:U>0&&(V=!0)}else z!=null?B=!0:V=!0;V?(v(J),J=pu(j)):B?(I(z),z=pu(S)):(z=pu(S),J=pu(j))}}(i,s,Ks,l=>{a.push(this.wn(e,n,r,l))},l=>{a.push(this.Sn(e,n,r,l))}),ie.waitFor(a)}fn(e){let n=1;return _u(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((a,l)=>Ks(a,l)).filter((a,l,h)=>!l||Ks(a,h[l-1])!==0);const i=[];i.push(e);for(const a of r){const l=Ks(a,e),h=Ks(a,n);if(l===0)i[0]=e.Ht();else if(l>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(n);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Ef,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Ef,[]];s.push(IDBKeyRange.bound(l,h))}return s}bn(e,n){return Ks(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Ix)}getMinOffset(e,n){return ie.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||Oe())).next(Ix)}}function Ex(t){return Dn(t,"collectionParents")}function mu(t){return Dn(t,"indexEntries")}function gc(t){return Dn(t,"indexConfiguration")}function _u(t){return Dn(t,"indexState")}function Ix(t){Fe(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;VE(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Kr(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Tr{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _N(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],a=IDBKeyRange.only(n.batchId);let l=0;const h=r.Y({range:a},(m,v,I)=>(l++,I.delete()));s.push(h.next(()=>{Fe(l===1)}));const g=[];for(const m of n.mutations){const v=w2(e,m.key.path,n.batchId);s.push(i.delete(v)),g.push(m.key)}return ie.waitFor(s).next(()=>g)}function Jg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Oe();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(41943040,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);class Nm{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){Fe(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Nm(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{n=!1,a.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Au(e),a=Qs(e);return a.add({}).next(l=>{Fe(typeof l=="number");const h=new HE(l,n,r,i),g=function(S,j,z){const J=z.baseMutations.map(B=>Wh(S.ut,B)),V=z.mutations.map(B=>Wh(S.ut,B));return{userId:j,batchId:z.batchId,localWriteTimeMs:z.localWriteTime.toMillis(),baseMutations:J,mutations:V}}(this.serializer,this.userId,h),m=[];let v=new At((I,S)=>et(I.canonicalString(),S.canonicalString()));for(const I of i){const S=w2(this.userId,I.key.path,l);v=v.add(I.key.path.popLast()),m.push(a.put(g)),m.push(s.put(S,a8))}return v.forEach(I=>{m.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Dn[l]=h.keys()}),ie.waitFor(m).next(()=>h)})}lookupMutationBatch(e,n){return Qs(e).get(n).next(r=>r?(Fe(r.userId===this.userId),ca(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?ie.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Qs(e).Y({index:"userMutationsIndex",range:i},(a,l,h)=>{l.userId===this.userId&&(Fe(l.batchId>=r),s=ca(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Qs(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).W("userMutationsIndex",n).next(r=>r.map(i=>ca(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Wf(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Au(e).Y({range:i},(a,l,h)=>{const[g,m,v]=a,I=Qi(m);if(g===this.userId&&n.path.isEqual(I))return Qs(e).get(v).next(S=>{if(!S)throw Oe();Fe(S.userId===this.userId),s.push(ca(this.serializer,S))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new At(et);const i=[];return n.forEach(s=>{const a=Wf(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=Au(e).Y({range:l},(g,m,v)=>{const[I,S,j]=g,z=Qi(S);I===this.userId&&s.path.isEqual(z)?r=r.add(j):v.done()});i.push(h)}),ie.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Wf(this.userId,r),a=IDBKeyRange.lowerBound(s);let l=new At(et);return Au(e).Y({range:a},(h,g,m)=>{const[v,I,S]=h,j=Qi(I);v===this.userId&&r.isPrefixOf(j)?j.length===i&&(l=l.add(S)):m.done()}).next(()=>this.vn(e,l))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Qs(e).get(s).next(a=>{if(a===null)throw Oe();Fe(a.userId===this.userId),r.push(ca(this.serializer,a))}))}),ie.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return _N(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),ie.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ie.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Au(e).Y({range:r},(s,a,l)=>{if(s[0]===this.userId){const h=Qi(s[1]);i.push(h)}else l.done()}).next(()=>{Fe(i.length===0)})})}containsKey(e,n){return vN(e,this.userId,n)}Mn(e){return yN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function vN(t,e,n){const r=Wf(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Au(t).Y({range:s,J:!0},(l,h,g)=>{const[m,v,I]=l;m===e&&v===i&&(a=!0),g.done()}).next(()=>a)}function Qs(t){return Dn(t,"mutations")}function Au(t){return Dn(t,"documentMutations")}function yN(t){return Dn(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Qa(0)}static Nn(){return new Qa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wH{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new Qa(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>Ue.fromTimestamp(new Kt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>vu(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(Fe(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return vu(e).Y((a,l)=>{const h=Dc(l);h.sequenceNumber<=n&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>ie.waitFor(s)).next(()=>i)}forEachTarget(e,n){return vu(e).Y((r,i)=>{const s=Dc(i);n(s)})}Bn(e){return Tx(e).get("targetGlobalKey").next(n=>(Fe(n!==null),n))}Ln(e,n){return Tx(e).put("targetGlobalKey",n)}kn(e,n){return vu(e).put(gN(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ha(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return vu(e).Y({range:i,index:"queryTargetsIndex"},(a,l,h)=>{const g=Dc(l);Sd(n,g.target)&&(s=g,h.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=ro(e);return n.forEach(a=>{const l=pr(a.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,a))}),ie.waitFor(i)}removeMatchingKeys(e,n,r){const i=ro(e);return ie.forEach(n,s=>{const a=pr(s.path);return ie.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=ro(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=ro(e);let s=nt();return i.Y({range:r,J:!0},(a,l,h)=>{const g=Qi(a[1]),m=new Ae(g);s=s.add(m)}).next(()=>s)}containsKey(e,n){const r=pr(n.path),i=IDBKeyRange.bound([r],[g2(r)],!1,!0);let s=0;return ro(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,l],h,g)=>{a!==0&&(s++,g.done())}).next(()=>s>0)}_t(e,n){return vu(e).get(n).next(r=>r?Dc(r):null)}}function vu(t){return Dn(t,"targets")}function Tx(t){return Dn(t,"targetGlobal")}function ro(t){return Dn(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xx([t,e],[n,r]){const i=et(t,n);return i===0?et(e,r):i}class EH{constructor(e){this.Qn=e,this.buffer=new At(xx),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();xx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class IH{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){ve("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Yo(n)?ve("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Qo(n)}await this.Gn(3e5)})}}class SH{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ie.resolve(Ar._e);const r=new EH(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(Sx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sx):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,a,l,h,g;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,l=Date.now(),this.removeTargets(e,r,n))).next(v=>(s=v,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(g=Date.now(),Tu()<=ot.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${v} documents in `+(g-h)+`ms
Total Duration: ${g-m}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:v})))}}function TH(t,e){return new SH(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xH{constructor(e,n){this.db=e,this.garbageCollector=TH(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return If(e,r)}removeReference(e,n,r){return If(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return If(e,n)}Xn(e,n){return function(i,s){let a=!1;return yN(i).Z(l=>vN(i,l,s).next(h=>(h&&(a=!0),ie.resolve(!h)))).next(()=>a)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,l)=>{if(l<=n){const h=this.Xn(e,a).next(g=>{if(!g)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Ue.min()),ro(e).delete(function(v){return[0,pr(v.path)]}(a))))});i.push(h)}}).next(()=>ie.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return If(e,n)}Zn(e,n){const r=ro(e);let i,s=Ar._e;return r.Y({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:g})=>{a===0?(s!==Ar._e&&n(new Ae(Qi(i)),s),s=g,i=h):s=Ar._e}).next(()=>{s!==Ar._e&&n(new Ae(Qi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function If(t,e){return ro(t).put(function(r,i){return{targetId:0,path:pr(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(){this.changes=new Xo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ut.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ie.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ia(e).put(r)}removeEntry(e,n,r){return ia(e).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Yg(a),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=Ut.newInvalidDocument(n);return ia(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(pc(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:Ut.newInvalidDocument(n)};return ia(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(pc(n))},(i,s)=>{r={document:this.tr(n,s),size:Jg(s)}}).next(()=>r)}getEntries(e,n){let r=Rr();return this.rr(e,n,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,n){let r=Rr(),i=new Lt(Ae.comparator);return this.rr(e,n,(s,a)=>{const l=this.tr(s,a);r=r.insert(s,l),i=i.insert(s,Jg(a))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return ie.resolve();let i=new At(Ax);n.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(pc(i.first()),pc(i.last())),a=i.getIterator();let l=a.getNext();return ia(e).Y({index:"documentKeyIndex",range:s},(h,g,m)=>{const v=Ae.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;l&&Ax(l,v)<0;)r(l,null),l=a.getNext();l&&l.isEqual(v)&&(r(l,g),l=a.hasNext()?a.getNext():null),l?m.U(pc(l)):m.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const a=n.path,l=[a.popLast().toArray(),a.lastSegment(),Yg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ia(e).W(IDBKeyRange.bound(l,h,!0)).next(g=>{s==null||s.incrementDocumentReadCount(g.length);let m=Rr();for(const v of g){const I=this.tr(Ae.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);I.isFoundDocument()&&(xd(n,I)||i.has(I.key))&&(m=m.insert(I.key,I))}return m})}getAllFromCollectionGroup(e,n,r,i){let s=Rr();const a=bx(n,r),l=bx(n,Kr.max());return ia(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,g,m)=>{const v=this.tr(Ae.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);s=s.insert(v.key,v),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new bH(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Cx(e).get("remoteDocumentGlobalKey").next(n=>(Fe(!!n),n))}er(e,n){return Cx(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=hH(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Ue.min())))return r}return Ut.newInvalidDocument(e)}}function EN(t){return new CH(t)}class bH extends wN{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Xo(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new At((s,a)=>et(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,l.readTime)),a.isValidDocument()){const h=dx(this._r.serializer,a);i=i.add(s.path.popLast());const g=Jg(h);r+=g-l.size,n.push(this._r.addEntry(e,s,h))}else if(r-=l.size,this.trackRemovals){const h=dx(this._r.serializer,a.convertToNoDocument(Ue.min()));n.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),ie.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function Cx(t){return Dn(t,"remoteDocumentGlobal")}function ia(t){return Dn(t,"remoteDocumentsV14")}function pc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function bx(t,e){const n=e.documentKey.path.toArray();return[t,Yg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Ax(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=et(n[s],r[s]),i)return i;return i=et(n.length,r.length),i||(i=et(n[n.length-2],r[r.length-2]),i||et(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AH{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Jc(r.mutation,i,Pr.empty(),Kt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,nt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=nt()){const i=Yi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=kc();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Yi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,nt()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,i){let s=Rr();const a=Xc(),l=function(){return Xc()}();return n.forEach((h,g)=>{const m=r.get(g.key);i.has(g.key)&&(m===void 0||m.mutation instanceof zs)?s=s.insert(g.key,g):m!==void 0?(a.set(g.key,m.mutation.getFieldMask()),Jc(m.mutation,g,m.mutation.getFieldMask(),Kt.now())):a.set(g.key,Pr.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((g,m)=>a.set(g,m)),n.forEach((g,m)=>{var v;return l.set(g,new AH(m,(v=a.get(g))!==null&&v!==void 0?v:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Xc();let i=new Lt((a,l)=>a-l),s=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(h=>{const g=n.get(h);if(g===null)return;let m=r.get(h)||Pr.empty();m=l.applyToLocalView(g,m),r.set(h,m);const v=(i.get(l.batchId)||nt()).add(h);i=i.insert(l.batchId,v)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),g=h.key,m=h.value,v=j2();m.forEach(I=>{if(!s.has(I)){const S=Q2(n.get(I),r.get(I));S!==null&&v.set(I,S),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,g,v))}return ie.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return Ae.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):jE(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):ie.resolve(Yi());let l=-1,h=s;return a.next(g=>ie.forEach(g,(m,v)=>(l<v.largestBatchId&&(l=v.largestBatchId),s.get(m)?ie.resolve():this.remoteDocumentCache.getEntry(e,m).next(I=>{h=h.insert(m,I)}))).next(()=>this.populateOverlays(e,g,s)).next(()=>this.computeViews(e,h,g,nt())).next(m=>({batchId:l,changes:U2(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ae(n)).next(r=>{let i=kc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=kc();return this.indexManager.getCollectionParents(e,s).next(l=>ie.forEach(l,h=>{const g=function(v,I){return new js(I,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,g,r,i).next(m=>{m.forEach((v,I)=>{a=a.insert(v,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((h,g)=>{const m=g.getKey();a.get(m)===null&&(a=a.insert(m,Ut.newInvalidDocument(m)))});let l=kc();return a.forEach((h,g)=>{const m=s.get(h);m!==void 0&&Jc(m.mutation,g,Pr.empty(),Kt.now()),xd(n,g)&&(l=l.insert(h,g))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return ie.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:gn(i.createTime)}}(n)),ie.resolve()}getNamedQuery(e,n){return ie.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:QE(i.bundledQuery),readTime:gn(i.readTime)}}(n)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{constructor(){this.overlays=new Lt(Ae.comparator),this.lr=new Map}getOverlay(e,n){return ie.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Yi();return ie.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),ie.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),ie.resolve()}getOverlaysForCollection(e,n,r){const i=Yi(),s=n.length+1,a=new Ae(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,g=h.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Lt((g,m)=>g-m);const a=this.overlays.getIterator();for(;a.hasNext();){const g=a.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>r){let m=s.get(g.largestBatchId);m===null&&(m=Yi(),s=s.insert(g.largestBatchId,m)),m.set(g.getKey(),g)}}const l=Yi(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((g,m)=>l.set(g,m)),!(l.size()>=i)););return ie.resolve(l)}lt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new GE(n,r));let s=this.lr.get(n);s===void 0&&(s=nt(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(){this.hr=new At(xn.Pr),this.Ir=new At(xn.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new xn(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new xn(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new Ae(new pt([])),r=new xn(n,e),i=new xn(n,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new Ae(new pt([])),r=new xn(n,e),i=new xn(n,e+1);let s=nt();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new xn(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xn{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return Ae.comparator(e.key,n.key)||et(e.gr,n.gr)}static Tr(e,n){return et(e.gr,n.gr)||Ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new At(xn.Pr)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new HE(s,n,r,i);this.mutationQueue.push(a);for(const l of i)this.yr=this.yr.add(new xn(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ie.resolve(a)}lookupMutationBatch(e,n){return ie.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Sr(r),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xn(n,0),i=new xn(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const l=this.wr(a.gr);s.push(l)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new At(et);return n.forEach(i=>{const s=new xn(i,0),a=new xn(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],l=>{r=r.add(l.gr)})}),ie.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Ae.isDocumentKey(s)||(s=s.child(""));const a=new xn(new Ae(s),0);let l=new At(et);return this.yr.forEachWhile(h=>{const g=h.key.path;return!!r.isPrefixOf(g)&&(g.length===i&&(l=l.add(h.gr)),!0)},a),ie.resolve(this.br(l))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Fe(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return ie.forEach(n.mutations,i=>{const s=new xn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new xn(n,0),i=this.yr.firstAfterOrEqual(r);return ie.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NH{constructor(e){this.Cr=e,this.docs=function(){return new Lt(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ie.resolve(r?r.document.mutableCopy():Ut.newInvalidDocument(n))}getEntries(e,n){let r=Rr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ut.newInvalidDocument(i))}),ie.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Rr();const a=n.path,l=new Ae(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:g,value:{document:m}}=h.getNext();if(!a.isPrefixOf(g.path))break;g.path.length>a.length+1||VE(m2(m),r)<=0||(i.has(m.key)||xd(n,m))&&(s=s.insert(m.key,m.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Oe()}vr(e,n){return ie.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new DH(this)}getSize(e){return ie.resolve(this.size)}}class DH extends wN{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),ie.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OH{constructor(e){this.persistence=e,this.Fr=new Xo(n=>Ha(n),Sd),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.Mr=0,this.Or=new JE,this.targetCount=0,this.Nr=Qa.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),ie.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Qa(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,ie.resolve()}updateTargetData(e,n){return this.kn(n),ie.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return ie.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),ie.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),ie.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return ie.resolve(r)}containsKey(e,n){return ie.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,n){this.Br={},this.overlays={},this.Lr=new Ar(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new OH(this),this.indexManager=new vH,this.remoteDocumentCache=function(i){return new NH(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new fN(n),this.Kr=new PH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new RH,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new kH(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){ve("MemoryPersistence","Starting transaction:",e);const i=new MH(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return ie.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class MH extends v2{constructor(e){super(),this.currentSequenceNumber=e}}class Dm{constructor(e){this.persistence=e,this.Gr=new JE,this.zr=null}static jr(e){return new Dm(e)}get Hr(){if(this.zr)return this.zr;throw Oe()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),ie.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),ie.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),ie.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.Hr,r=>{const i=Ae.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,Ue.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return ie.or([()=>ie.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LH{constructor(e){this.serializer=e}N(e,n,r,i){const s=new bm("createOrUpgrade",n);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$1,{unique:!0}),h.createObjectStore("documentMutations")}(e),Px(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=ie.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),Px(e)),a=a.next(()=>function(h){const g=h.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ue.min().toTimestamp(),targetCount:0};return g.put("targetGlobalKey",m)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,g){return g.store("mutations").W().next(m=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$1,{unique:!0});const v=g.store("mutations"),I=m.map(S=>v.put(S));return ie.waitFor(I)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const g=h.createObjectStore("documentOverlays",{keyPath:y8});g.createIndex("collectionPathOverlayIndex",w8,{unique:!1}),g.createIndex("collectionGroupOverlayIndex",E8,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const g=h.createObjectStore("remoteDocumentsV14",{keyPath:u8});g.createIndex("documentKeyIndex",l8),g.createIndex("collectionGroupIndex",c8)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:p8}).createIndex("sequenceNumberIndex",m8,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:_8}).createIndex("documentKeyIndex",v8,{unique:!1})}(e))),a}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Jg(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>ie.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(l=>ie.forEach(l,h=>{Fe(h.userId===s.userId);const g=ca(this.serializer,h);return _N(e,s.userId,g).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,l)=>{const h=new pt(a),g=function(v){return[0,pr(v)]}(h);s.push(n.get(g).next(m=>m?ie.resolve():(v=>n.put({targetId:0,path:pr(v),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>ie.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:g8});const r=n.store("collectionParents"),i=new XE,s=a=>{if(i.add(a)){const l=a.lastSegment(),h=a.popLast();return r.put({collectionId:l,parent:pr(h)})}};return n.store("remoteDocuments").Y({J:!0},(a,l)=>{const h=new pt(a);return s(h.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([a,l,h],g)=>{const m=Qi(l);return s(m.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=Dc(i),a=gN(this.serializer,s);return n.put(a)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const l=n.store("remoteDocumentsV14"),h=function(v){return v.document?new Ae(pt.fromString(v.document.name).popFirst(5)):v.noDocument?Ae.fromSegments(v.noDocument.path):v.unknownDocument?Ae.fromSegments(v.unknownDocument.path):Oe()}(a).path.toArray(),g={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(g))}).next(()=>ie.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=EN(this.serializer),s=new SN(Dm.jr,this.serializer.ut);return r.W().next(a=>{const l=new Map;return a.forEach(h=>{var g;let m=(g=l.get(h.userId))!==null&&g!==void 0?g:nt();ca(this.serializer,h).keys().forEach(v=>m=m.add(v)),l.set(h.userId,m)}),ie.forEach(l,(h,g)=>{const m=new bn(g),v=km.ct(this.serializer,m),I=s.getIndexManager(m),S=Nm.ct(m,this.serializer,I,s.referenceDelegate);return new IN(i,S,v,I).recalculateAndSaveOverlaysForDocumentKeys(new n0(n,Ar._e),h).next()})})}}function Px(t){t.createObjectStore("targetDocuments",{keyPath:d8}).createIndex("documentTargetsIndex",f8,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",h8,{unique:!0}),t.createObjectStore("targetGlobal")}const K_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ZE{constructor(e,n,r,i,s,a,l,h,g,m,v=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=a,this.document=l,this.oi=g,this._i=m,this.ai=v,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=I=>Promise.resolve(),!ZE.D())throw new me(le.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xH(this,i),this.Ii=n+"main",this.serializer=new fN(h),this.Ti=new Ii(this.Ii,this.ai,new LH(this.serializer)),this.qr=new wH(this.referenceDelegate,this.serializer),this.remoteDocumentCache=EN(this.serializer),this.Kr=new dH,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,m===!1&&dn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new me(le.FAILED_PRECONDITION,K_);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Ar(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Yo(e))return ve("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ve("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return mc(e).get("owner").next(n=>ie.resolve(this.wi(n)))}Si(e){return Sf(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Dn(n,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return ie.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const n of e)this.Ei.removeItem(this.vi(n.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?ie.resolve(!0):mc(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new me(le.FAILED_PRECONDITION,K_);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sf(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ve("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new n0(e,Ar._e);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Sf(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return Nm.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yH(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return km.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){ve("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(h){return h===15?S8:h===14?S2:h===13?I2:h===12?I8:h===11?E2:void Oe()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,l=>(a=new n0(l,this.Lr?this.Lr.next():Ar._e),n==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw dn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new me(le.FAILED_PRECONDITION,_2);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Li(e){return mc(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new me(le.FAILED_PRECONDITION,K_)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return mc(e).put("owner",n)}static D(){return Ii.D()}pi(e){const n=mc(e);return n.get("owner").next(r=>this.wi(r)?(ve("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):ie.resolve())}Di(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(dn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;sB()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return ve("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){dn("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function mc(t){return Dn(t,"owner")}function Sf(t){return Dn(t,"clientMetadata")}function eI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=nt(),i=nt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new tI(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new VH;return this.Hi(e,n,a).next(l=>{if(s.result=l,this.$i)return this.Ji(e,n,a,l.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Tu()<=ot.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",xu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),ie.resolve()):(Tu()<=ot.DEBUG&&ve("QueryEngine","Query:",xu(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Tu()<=ot.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",xu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mr(n))):ie.resolve())}zi(e,n){if(tx(n))return ie.resolve(null);let r=mr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Qg(n,null,"F"),r=mr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=nt(...s);return this.Gi.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{const g=this.Yi(n,l);return this.Zi(n,g,a,h.readTime)?this.zi(e,Qg(n,null,"F")):this.Xi(e,g,n,h)}))})))}ji(e,n,r,i){return tx(n)||i.isEqual(Ue.min())?ie.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(n,s);return this.Zi(n,a,r,i)?ie.resolve(null):(Tu()<=ot.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xu(n)),this.Xi(e,a,n,p2(i,-1)).next(l=>l))})}Yi(e,n){let r=new At(F2(e));return n.forEach((i,s)=>{xd(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Tu()<=ot.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",xu(n)),this.Gi.getDocumentsMatchingQuery(e,n,Kr.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FH{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Lt(et),this.ns=new Xo(s=>Ha(s),Sd),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IN(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function xN(t,e,n,r){return new FH(t,e,n,r)}async function CN(t,e){const n=ke(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let h=nt();for(const g of i){a.push(g.batchId);for(const m of g.mutations)h=h.add(m.key)}for(const g of s){l.push(g.batchId);for(const m of g.mutations)h=h.add(m.key)}return n.localDocuments.getDocuments(r,h).next(g=>({_s:g,removedBatchIds:a,addedBatchIds:l}))})})}function BH(t,e){const n=ke(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(l,h,g,m){const v=g.batch,I=v.keys();let S=ie.resolve();return I.forEach(j=>{S=S.next(()=>m.getEntry(h,j)).next(z=>{const J=g.docVersions.get(j);Fe(J!==null),z.version.compareTo(J)<0&&(v.applyToRemoteDocument(z,g),z.isValidDocument()&&(z.setReadTime(g.commitVersion),m.addEntry(z)))})}),S.next(()=>l.mutationQueue.removeMutationBatch(h,v))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=nt();for(let g=0;g<l.mutationResults.length;++g)l.mutationResults[g].transformResults.length>0&&(h=h.add(l.batch.mutations[g].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function bN(t){const e=ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function UH(t,e){const n=ke(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const l=[];e.targetChanges.forEach((m,v)=>{const I=i.get(v);if(!I)return;l.push(n.qr.removeMatchingKeys(s,m.removedDocuments,v).next(()=>n.qr.addMatchingKeys(s,m.addedDocuments,v)));let S=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(En.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):m.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(m.resumeToken,r)),i=i.insert(v,S),function(z,J,V){return z.resumeToken.approximateByteSize()===0||J.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(I,S,m)&&l.push(n.qr.updateTargetData(s,S))});let h=Rr(),g=nt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(AN(s,a,e.documentUpdates).next(m=>{h=m.us,g=m.cs})),!r.isEqual(Ue.min())){const m=n.qr.getLastRemoteSnapshotVersion(s).next(v=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(m)}return ie.waitFor(l).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,h,g)).next(()=>h)}).then(s=>(n.ts=i,s))}function AN(t,e,n){let r=nt(),i=nt();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=Rr();return n.forEach((l,h)=>{const g=s.get(l);h.isFoundDocument()!==g.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(Ue.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!g.isValidDocument()||h.version.compareTo(g.version)>0||h.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):ve("LocalStore","Ignoring outdated watch update for ",l,". Current version:",g.version," Watch version:",h.version)}),{us:a,cs:i}})}function jH(t,e){const n=ke(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function xl(t,e){const n=ke(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,ie.resolve(i)):n.qr.allocateTargetId(r).next(a=>(i=new Ts(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function Cl(t,e,n){const r=ke(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Yo(a))throw a;ve("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function Zg(t,e,n){const r=ke(t);let i=Ue.min(),s=nt();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,g,m){const v=ke(h),I=v.ns.get(m);return I!==void 0?ie.resolve(v.ts.get(I)):v.qr.getTargetData(g,m)}(r,a,mr(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,n?i:Ue.min(),n?s:nt())).next(l=>(kN(r,V2(e),l),{documents:l,ls:s})))}function PN(t,e){const n=ke(t),r=ke(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function RN(t,e){const n=ke(t),r=n.rs.get(e)||Ue.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,p2(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(kN(n,e,i),i))}function kN(t,e,n){let r=t.rs.get(e)||Ue.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}async function zH(t,e,n,r){const i=ke(t);let s=nt(),a=Rr();for(const g of n){const m=e.hs(g.metadata.name);g.document&&(s=s.add(m));const v=e.Ps(g);v.setReadTime(e.Is(g.metadata.readTime)),a=a.insert(m,v)}const l=i.ss.newChangeBuffer({trackRemovals:!0}),h=await xl(i,function(m){return mr(Hl(pt.fromString(`__bundle__/docs/${m}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",g=>AN(g,l,a).next(m=>(l.apply(g),m)).next(m=>i.qr.removeMatchingKeysForTargetId(g,h.targetId).next(()=>i.qr.addMatchingKeys(g,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(g,m.us,m.cs)).next(()=>m.us)))}async function $H(t,e,n=nt()){const r=await xl(t,mr(QE(e.bundledQuery))),i=ke(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=gn(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const l=r.withResumeToken(En.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(l.targetId,l),i.qr.updateTargetData(s,l).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function Rx(t,e){return`firestore_clients_${t}_${e}`}function kx(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Q_(t,e){return`firestore_targets_${t}_${e}`}class ep{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new me(i.error.code,i.error.message))),a?new ep(e,n,i.state,s):(dn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new me(r.error.code,r.error.message))),s?new Zc(e,r.state,i):(dn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class tp{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=zE();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=y2(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new tp(e,s):(dn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class nI{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new nI(n.clientId,n.onlineState):(dn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class p0{constructor(){this.activeTargetIds=zE()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Y_{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Lt(et),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=Rx(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new p0),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(Rx(this.persistenceKey,r));if(i){const s=tp.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const n=this.storage.getItem(this.Cs);if(n){const r=this.Ms(n);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Q_(this.persistenceKey,e));if(r){const i=Zc.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Q_(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ve("SharedClientState","READ",e,n),n}setItem(e,n){ve("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){ve("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const n=e;if(n.storageArea===this.storage){if(ve("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void dn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){const r=this.Ks(n.key);return this.$s(r,null)}{const r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){const r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){const r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){const r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){const r=function(s){let a=Ar._e;if(s!=null)try{const l=JSON.parse(s);Fe(typeof l=="number"),a=l}catch(l){dn("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(n.newValue);r!==Ar._e&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){const r=this.Hs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(n)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new ep(this.currentUser,e,n,r),s=kx(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=kx(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){const n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){const i=Q_(this.persistenceKey,e),s=new Zc(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return tp.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return ep.Ts(new bn(s),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return Zc.Ts(i,n)}Ms(e){return nI.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);ve("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],l=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.Xs(a,l).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=zE();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class NN{constructor(){this.eo=new p0,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new p0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HH{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){ve("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){ve("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf=null;function X_(){return Tf===null?Tf=function(){return 268435456+Math.round(2147483648*Math.random())}():Tf++,"0x"+Tf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn="WebChannelConnection";class WH extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,a){const l=X_(),h=this.So(n,r);ve("RestConnection",`Sending RPC '${n}' ${l}:`,h,i);const g={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(g,s,a),this.Do(n,h,g,i).then(m=>(ve("RestConnection",`Received RPC '${n}' ${l}: `,m),m),m=>{throw Ri("RestConnection",`RPC '${n}' ${l} failed with error: `,m,"url: ",h,"request:",i),m})}Co(n,r,i,s,a,l){return this.wo(n,r,i,s,a)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$l}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}So(n,r){const i=qH[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=X_();return new Promise((a,l)=>{const h=new z$;h.setWithCredentials(!0),h.listenOnce(U$.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case G_.NO_ERROR:const m=h.getResponseJson();ve(Jn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),a(m);break;case G_.TIMEOUT:ve(Jn,`RPC '${e}' ${s} timed out`),l(new me(le.DEADLINE_EXCEEDED,"Request time out"));break;case G_.HTTP_ERROR:const v=h.getStatus();if(ve(Jn,`RPC '${e}' ${s} failed with status:`,v,"response text:",h.getResponseText()),v>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const S=I==null?void 0:I.error;if(S&&S.status&&S.message){const j=function(J){const V=J.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(V)>=0?V:le.UNKNOWN}(S.status);l(new me(j,S.message))}else l(new me(le.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new me(le.UNAVAILABLE,"Connection failed."));break;default:Oe()}}finally{ve(Jn,`RPC '${e}' ${s} completed.`)}});const g=JSON.stringify(i);ve(Jn,`RPC '${e}' ${s} sending request:`,i),h.send(n,"POST",g,r,15)})}vo(e,n,r){const i=X_(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=F$(),l=B$(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(h.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;const m=s.join("");ve(Jn,`Creating RPC '${e}' stream ${i}: ${m}`,h);const v=a.createWebChannel(m,h);let I=!1,S=!1;const j=new GH({co:J=>{S?ve(Jn,`Not sending because RPC '${e}' stream ${i} is closed:`,J):(I||(ve(Jn,`Opening RPC '${e}' stream ${i} transport.`),v.open(),I=!0),ve(Jn,`RPC '${e}' stream ${i} sending:`,J),v.send(J))},lo:()=>v.close()}),z=(J,V,B)=>{J.listen(V,U=>{try{B(U)}catch(Z){setTimeout(()=>{throw Z},0)}})};return z(v,yf.EventType.OPEN,()=>{S||ve(Jn,`RPC '${e}' stream ${i} transport opened.`)}),z(v,yf.EventType.CLOSE,()=>{S||(S=!0,ve(Jn,`RPC '${e}' stream ${i} transport closed`),j.Ro())}),z(v,yf.EventType.ERROR,J=>{S||(S=!0,Ri(Jn,`RPC '${e}' stream ${i} transport errored:`,J),j.Ro(new me(le.UNAVAILABLE,"The operation could not be completed")))}),z(v,yf.EventType.MESSAGE,J=>{var V;if(!S){const B=J.data[0];Fe(!!B);const U=B,Z=U.error||((V=U[0])===null||V===void 0?void 0:V.error);if(Z){ve(Jn,`RPC '${e}' stream ${i} received error:`,Z);const ne=Z.status;let te=function(_e){const pe=mn[_e];if(pe!==void 0)return J2(pe)}(ne),oe=Z.message;te===void 0&&(te=le.INTERNAL,oe="Unknown error status: "+ne+" with message "+Z.message),S=!0,j.Ro(new me(te,oe)),v.close()}else ve(Jn,`RPC '${e}' stream ${i} received:`,B),j.Vo(B)}}),z(l,j$.STAT_EVENT,J=>{J.stat===B1.PROXY?ve(Jn,`RPC '${e}' stream ${i} detected buffering proxy`):J.stat===B1.NOPROXY&&ve(Jn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{j.Ao()},0),j}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(){return typeof window<"u"?window:null}function Jf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(t){return new tH(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,n,r,i,s,a,l,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new rI(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,n){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===le.RESOURCE_EXHAUSTED?(dn(n.toString()),dn("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(n)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new me(le.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return ve("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(ve("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class KH extends ON{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=iH(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?gn(a.readTime):Ue.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=Gh(this.serializer),n.addTarget=function(s,a){let l;const h=a.target;if(l=Wg(h)?{documents:aN(s,h)}:{query:uN(s,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=nN(s,a.resumeToken);const g=l0(s,a.expectedCount);g!==null&&(l.expectedCount=g)}else if(a.snapshotVersion.compareTo(Ue.min())>0){l.readTime=Tl(s,a.snapshotVersion.toTimestamp());const g=l0(s,a.expectedCount);g!==null&&(l.expectedCount=g)}return l}(this.serializer,e);const r=oH(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=Gh(this.serializer),n.removeTarget=e,this.e_(n)}}class QH extends ON{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=sH(e.writeResults,e.commitTime),r=gn(e.commitTime);return this.listener.I_(r,n)}return Fe(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Gh(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Wh(this.serializer,r))};this.e_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YH extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new me(le.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new me(le.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,n,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new me(le.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class XH{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(dn(n),this.f_=!1):ve("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JH{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{Jo(this)&&(ve("RemoteStore","Restarting streams for network reachability change."),await async function(h){const g=ke(h);g.C_.add(4),await Wl(g),g.M_.set("Unknown"),g.C_.delete(4),await Rd(g)}(this))})}),this.M_=new XH(r,i)}}async function Rd(t){if(Jo(t))for(const e of t.v_)await e(!0)}async function Wl(t){for(const e of t.v_)await e(!1)}function Om(t,e){const n=ke(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),oI(n)?sI(n):Ql(n).Ho()&&iI(n,e))}function Kh(t,e){const n=ke(t),r=Ql(n);n.D_.delete(e),r.Ho()&&MN(n,e),n.D_.size===0&&(r.Ho()?r.Zo():Jo(n)&&n.M_.set("Unknown"))}function iI(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ql(t).u_(e)}function MN(t,e){t.x_.Oe(e),Ql(t).c_(e)}function sI(t){t.x_=new X8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Ql(t).start(),t.M_.g_()}function oI(t){return Jo(t)&&!Ql(t).jo()&&t.D_.size>0}function Jo(t){return ke(t).C_.size===0}function LN(t){t.x_=void 0}async function ZH(t){t.D_.forEach((e,n)=>{iI(t,e)})}async function e7(t,e){LN(t),oI(t)?(t.M_.w_(e),sI(t)):t.M_.set("Unknown")}async function t7(t,e,n){if(t.M_.set("Online"),e instanceof tN&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.D_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.D_.delete(l),i.x_.removeTarget(l))}(t,e)}catch(r){ve("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await np(t,r)}else if(e instanceof Xf?t.x_.$e(e):e instanceof eN?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(Ue.min()))try{const r=await bN(t.localStore);n.compareTo(r)>=0&&await function(s,a){const l=s.x_.it(a);return l.targetChanges.forEach((h,g)=>{if(h.resumeToken.approximateByteSize()>0){const m=s.D_.get(g);m&&s.D_.set(g,m.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,g)=>{const m=s.D_.get(h);if(!m)return;s.D_.set(h,m.withResumeToken(En.EMPTY_BYTE_STRING,m.snapshotVersion)),MN(s,h);const v=new Ts(m.target,h,g,m.sequenceNumber);iI(s,v)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ve("RemoteStore","Failed to raise snapshot:",r),await np(t,r)}}async function np(t,e,n){if(!Yo(e))throw e;t.C_.add(1),await Wl(t),t.M_.set("Offline"),n||(n=()=>bN(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ve("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await Rd(t)})}function VN(t,e){return e().catch(n=>np(t,n,e))}async function Kl(t){const e=ke(t),n=Vo(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;n7(e);)try{const i=await jH(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,r7(e,i)}catch(i){await np(e,i)}FN(e)&&BN(e)}function n7(t){return Jo(t)&&t.b_.length<10}function r7(t,e){t.b_.push(e);const n=Vo(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function FN(t){return Jo(t)&&!Vo(t).jo()&&t.b_.length>0}function BN(t){Vo(t).start()}async function i7(t){Vo(t).E_()}async function s7(t){const e=Vo(t);for(const n of t.b_)e.P_(n.mutations)}async function o7(t,e,n){const r=t.b_.shift(),i=qE.from(r,e,n);await VN(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Kl(t)}async function a7(t,e){e&&Vo(t).h_&&await async function(r,i){if(function(a){return X2(a)&&a!==le.ABORTED}(i.code)){const s=r.b_.shift();Vo(r).Yo(),await VN(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Kl(r)}}(t,e),FN(t)&&BN(t)}async function Dx(t,e){const n=ke(t);n.asyncQueue.verifyOperationInProgress(),ve("RemoteStore","RemoteStore received new credentials");const r=Jo(n);n.C_.add(3),await Wl(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await Rd(n)}async function m0(t,e){const n=ke(t);e?(n.C_.delete(2),await Rd(n)):e||(n.C_.add(2),await Wl(n),n.M_.set("Unknown"))}function Ql(t){return t.O_||(t.O_=function(n,r,i){const s=ke(n);return s.A_(),new KH(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:ZH.bind(null,t),Io:e7.bind(null,t),a_:t7.bind(null,t)}),t.v_.push(async e=>{e?(t.O_.Yo(),oI(t)?sI(t):t.M_.set("Unknown")):(await t.O_.stop(),LN(t))})),t.O_}function Vo(t){return t.N_||(t.N_=function(n,r,i){const s=ke(n);return s.A_(),new QH(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:i7.bind(null,t),Io:a7.bind(null,t),T_:s7.bind(null,t),I_:o7.bind(null,t)}),t.v_.push(async e=>{e?(t.N_.Yo(),await Kl(t)):(await t.N_.stop(),t.b_.length>0&&(ve("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))})),t.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,l=new aI(e,n,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yl(t,e){if(dn("AsyncQueue",`${e}: ${t}`),Yo(t))return new me(le.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ae.comparator(n.key,r.key):(n,r)=>Ae.comparator(n.key,r.key),this.keyedMap=kc(),this.sortedSet=new Lt(this.comparator)}static emptySet(e){return new rl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof rl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new rl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(){this.B_=new Lt(Ae.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):Oe():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class bl{constructor(e,n,r,i,s,a,l,h,g){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=g}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new bl(e,n,rl.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Td(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u7{constructor(){this.k_=void 0,this.listeners=[]}}class l7{constructor(){this.queries=new Xo(e=>L2(e),Td),this.onlineState="Unknown",this.q_=new Set}}async function uI(t,e){const n=ke(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new u7),i)try{s.k_=await n.onListen(r)}catch(a){const l=Yl(a,`Initialization of query '${xu(e.query)}' failed`);return void e.onError(l)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&cI(n)}async function lI(t,e){const n=ke(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function c7(t,e){const n=ke(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const l of a.listeners)l.K_(i)&&(r=!0);a.k_=i}}r&&cI(n)}function h7(t,e,n){const r=ke(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function cI(t){t.q_.forEach(e=>{e.next()})}class hI{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new bl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=bl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d7{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e){this.serializer=e}hs(e){return ts(this.serializer,e)}Ps(e){return e.metadata.exists?oN(this.serializer,e.document,!1):Ut.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return gn(e)}}class f7{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=UN(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=pt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new Mx(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const l=(n.get(a)||nt()).add(s);n.set(a,l)}}return n}async complete(){const e=await zH(this.localStore,new Mx(this.serializer),this.documents,this.X_.id),n=this.ta(this.documents);for(const r of this.queries)await $H(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function UN(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.key=e}}class zN{constructor(e){this.key=e}}class $N{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=nt(),this.mutatedKeys=nt(),this._a=F2(e),this.aa=new rl(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new Ox,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,l=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,g=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,v)=>{const I=i.get(m),S=xd(this.query,v)?v:null,j=!!I&&this.mutatedKeys.has(I.key),z=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let J=!1;I&&S?I.data.isEqual(S.data)?j!==z&&(r.track({type:3,doc:S}),J=!0):this.ha(I,S)||(r.track({type:2,doc:S}),J=!0,(h&&this._a(S,h)>0||g&&this._a(S,g)<0)&&(l=!0)):!I&&S?(r.track({type:0,doc:S}),J=!0):I&&!S&&(r.track({type:1,doc:I}),J=!0,(h||g)&&(l=!0)),J&&(S?(a=a.add(S),s=z?s.add(m):s.delete(m)):(a=a.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{aa:a,la:r,Zi:l,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((m,v)=>function(S,j){const z=J=>{switch(J){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe()}};return z(S)-z(j)}(m.type,v.type)||this._a(m.doc,v.doc)),this.Pa(r),i=i!=null&&i;const l=n&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,g=h!==this.sa;return this.sa=h,a.length!==0||g?{snapshot:new bl(this.query,e.aa,s,a,e.mutatedKeys,h===0,g,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new Ox,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=nt(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new zN(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new jN(r))}),n}da(e){this.ia=e.ls,this.oa=nt();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return bl.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class g7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class p7{constructor(e){this.key=e,this.Ra=!1}}class m7{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new Xo(l=>L2(l),Td),this.fa=new Map,this.ga=new Set,this.pa=new Lt(Ae.comparator),this.ya=new Map,this.wa=new JE,this.Sa={},this.ba=new Map,this.Da=Qa.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function _7(t,e){const n=mI(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await xl(n.localStore,mr(e)),l=n.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await dI(n,e,r,l==="current",a.resumeToken),n.isPrimaryClient&&Om(n.remoteStore,a)}return i}async function dI(t,e,n,r,i){t.va=(v,I,S)=>async function(z,J,V,B){let U=J.view.ca(V);U.Zi&&(U=await Zg(z.localStore,J.query,!1).then(({documents:oe})=>J.view.ca(oe,U)));const Z=B&&B.targetChanges.get(J.targetId),ne=B&&B.targetMismatches.get(J.targetId)!=null,te=J.view.applyChanges(U,z.isPrimaryClient,Z,ne);return _0(z,J.targetId,te.Ta),te.snapshot}(t,v,I,S);const s=await Zg(t.localStore,e,!0),a=new $N(e,s.ls),l=a.ca(s.documents),h=Ad.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),g=a.applyChanges(l,t.isPrimaryClient,h);_0(t,n,g.Ta);const m=new g7(e,n,a);return t.ma.set(e,m),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),g.snapshot}async function v7(t,e){const n=ke(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!Td(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Cl(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Kh(n.remoteStore,r.targetId),Al(n,r.targetId)}).catch(Qo)):(Al(n,r.targetId),await Cl(n.localStore,r.targetId,!0))}async function y7(t,e,n){const r=_I(t);try{const i=await function(a,l){const h=ke(a),g=Kt.now(),m=l.reduce((S,j)=>S.add(j.key),nt());let v,I;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let j=Rr(),z=nt();return h.ss.getEntries(S,m).next(J=>{j=J,j.forEach((V,B)=>{B.isValidDocument()||(z=z.add(V))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,j)).next(J=>{v=J;const V=[];for(const B of l){const U=K8(B,v.get(B.key).overlayedDocument);U!=null&&V.push(new zs(B.key,U,b2(U.value.mapValue),Wt.exists(!0)))}return h.mutationQueue.addMutationBatch(S,g,V,l)}).next(J=>{I=J;const V=J.applyToLocalDocumentSet(v,z);return h.documentOverlayCache.saveOverlays(S,J.batchId,V)})}).then(()=>({batchId:I.batchId,changes:U2(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let g=a.Sa[a.currentUser.toKey()];g||(g=new Lt(et)),g=g.insert(l,h),a.Sa[a.currentUser.toKey()]=g}(r,i.batchId,n),await $s(r,i.changes),await Kl(r.remoteStore)}catch(i){const s=Yl(i,"Failed to persist write");n.reject(s)}}async function HN(t,e){const n=ke(t);try{const r=await UH(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.ya.get(s);a&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?Fe(a.Ra):i.removedDocuments.size>0&&(Fe(a.Ra),a.Ra=!1))}),await $s(n,r,e)}catch(r){await Qo(r)}}function Lx(t,e,n){const r=ke(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.ma.forEach((s,a)=>{const l=a.view.Q_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const h=ke(a);h.onlineState=l;let g=!1;h.queries.forEach((m,v)=>{for(const I of v.listeners)I.Q_(l)&&(g=!0)}),g&&cI(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function w7(t,e,n){const r=ke(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Lt(Ae.comparator);a=a.insert(s,Ut.newNoDocument(s,Ue.min()));const l=nt().add(s),h=new bd(Ue.min(),new Map,new Lt(et),a,l);await HN(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),pI(r)}else await Cl(r.localStore,e,!1).then(()=>Al(r,e,n)).catch(Qo)}async function E7(t,e){const n=ke(t),r=e.batch.batchId;try{const i=await BH(n.localStore,e);gI(n,r,null),fI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $s(n,i)}catch(i){await Qo(i)}}async function I7(t,e,n){const r=ke(t);try{const i=await function(a,l){const h=ke(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let m;return h.mutationQueue.lookupMutationBatch(g,l).next(v=>(Fe(v!==null),m=v.keys(),h.mutationQueue.removeMutationBatch(g,v))).next(()=>h.mutationQueue.performConsistencyCheck(g)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(g,m,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,m)).next(()=>h.localDocuments.getDocuments(g,m))})}(r.localStore,e);gI(r,e,n),fI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $s(r,i)}catch(i){await Qo(i)}}async function S7(t,e){const n=ke(t);Jo(n.remoteStore)||ve("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const l=ke(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=Yl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function fI(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function gI(t,e,n){const r=ke(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Al(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||qN(t,r)})}function qN(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);n!==null&&(Kh(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),pI(t))}function _0(t,e,n){for(const r of n)r instanceof jN?(t.wa.addReference(r.key,e),T7(t,r)):r instanceof zN?(ve("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||qN(t,r.key)):Oe()}function T7(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(ve("SyncEngine","New document in limbo: "+n),t.ga.add(r),pI(t))}function pI(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new Ae(pt.fromString(e)),r=t.Da.next();t.ya.set(r,new p7(n)),t.pa=t.pa.insert(n,r),Om(t.remoteStore,new Ts(mr(Hl(n.path)),r,"TargetPurposeLimboResolution",Ar._e))}}async function $s(t,e,n){const r=ke(t),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((l,h)=>{a.push(r.va(h,e,n).then(g=>{if((g||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,g!=null&&g.fromCache?"not-current":"current"),g){i.push(g);const m=tI.Qi(h.targetId,g);s.push(m)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,g){const m=ke(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>ie.forEach(g,I=>ie.forEach(I.ki,S=>m.persistence.referenceDelegate.addReference(v,I.targetId,S)).next(()=>ie.forEach(I.qi,S=>m.persistence.referenceDelegate.removeReference(v,I.targetId,S)))))}catch(v){if(!Yo(v))throw v;ve("LocalStore","Failed to update sequence numbers: "+v)}for(const v of g){const I=v.targetId;if(!v.fromCache){const S=m.ts.get(I),j=S.snapshotVersion,z=S.withLastLimboFreeSnapshotVersion(j);m.ts=m.ts.insert(I,z)}}}(r.localStore,s))}async function x7(t,e){const n=ke(t);if(!n.currentUser.isEqual(e)){ve("SyncEngine","User change. New user:",e.toKey());const r=await CN(n.localStore,e);n.currentUser=e,function(s,a){s.ba.forEach(l=>{l.forEach(h=>{h.reject(new me(le.CANCELLED,a))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $s(n,r._s)}}function C7(t,e){const n=ke(t),r=n.ya.get(e);if(r&&r.Ra)return nt().add(r.key);{let i=nt();const s=n.fa.get(e);if(!s)return i;for(const a of s){const l=n.ma.get(a);i=i.unionWith(l.view.ua)}return i}}async function b7(t,e){const n=ke(t),r=await Zg(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&_0(n,e.targetId,i.Ta),i}async function A7(t,e){const n=ke(t);return RN(n.localStore,e).then(r=>$s(n,r))}async function P7(t,e,n,r){const i=ke(t),s=await function(l,h){const g=ke(l),m=ke(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",v=>m.Cn(v,h).next(I=>I?g.localDocuments.getDocuments(v,I):ie.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Kl(i.remoteStore):n==="acknowledged"||n==="rejected"?(gI(i,e,r||null),fI(i,e),function(l,h){ke(ke(l).mutationQueue).Fn(h)}(i.localStore,e)):Oe(),await $s(i,s)):ve("SyncEngine","Cannot apply mutation batch with id: "+e)}async function R7(t,e){const n=ke(t);if(mI(n),_I(n),e===!0&&n.Ca!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await Vx(n,r.toArray());n.Ca=!0,await m0(n.remoteStore,!0);for(const s of i)Om(n.remoteStore,s)}else if(e===!1&&n.Ca!==!1){const r=[];let i=Promise.resolve();n.fa.forEach((s,a)=>{n.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Al(n,a),Cl(n.localStore,a,!0))),Kh(n.remoteStore,a)}),await i,await Vx(n,r),function(a){const l=ke(a);l.ya.forEach((h,g)=>{Kh(l.remoteStore,g)}),l.wa.Vr(),l.ya=new Map,l.pa=new Lt(Ae.comparator)}(n),n.Ca=!1,await m0(n.remoteStore,!1)}}async function Vx(t,e,n){const r=ke(t),i=[],s=[];for(const a of e){let l;const h=r.fa.get(a);if(h&&h.length!==0){l=await xl(r.localStore,mr(h[0]));for(const g of h){const m=r.ma.get(g),v=await b7(r,m);v.snapshot&&s.push(v.snapshot)}}else{const g=await PN(r.localStore,a);l=await xl(r.localStore,g),await dI(r,GN(g),a,!1,l.resumeToken)}i.push(l)}return r.Va.a_(s),i}function GN(t){return M2(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function k7(t){return function(n){return ke(ke(n).persistence).Bi()}(ke(t).localStore)}async function N7(t,e,n,r){const i=ke(t);if(i.Ca)return void ve("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const a=await RN(i.localStore,V2(s[0])),l=bd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",En.EMPTY_BYTE_STRING);await $s(i,a,l);break}case"rejected":await Cl(i.localStore,e,!0),Al(i,e,r);break;default:Oe()}}async function D7(t,e,n){const r=mI(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){ve("SyncEngine","Adding an already active target "+i);continue}const s=await PN(r.localStore,i),a=await xl(r.localStore,s);await dI(r,GN(s),a.targetId,!1,a.resumeToken),Om(r.remoteStore,a)}for(const i of n)r.fa.has(i)&&await Cl(r.localStore,i,!1).then(()=>{Kh(r.remoteStore,i),Al(r,i)}).catch(Qo)}}function mI(t){const e=ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=HN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=C7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=w7.bind(null,e),e.Va.a_=c7.bind(null,e.eventManager),e.Va.Fa=h7.bind(null,e.eventManager),e}function _I(t){const e=ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=E7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=I7.bind(null,e),e}function O7(t,e,n){const r=ke(t);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(S,j){const z=ke(S),J=gn(j.createTime);return z.persistence.runTransaction("hasNewerBundle","readonly",V=>z.Kr.getBundleMetadata(V,j.id)).then(V=>!!V&&V.createTime.compareTo(J)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(UN(h));const g=new f7(h,s.localStore,a.serializer);let m=await a.Ma();for(;m;){const I=await g.ea(m);I&&l._updateProgress(I),m=await a.Ma()}const v=await g.complete();return await $s(s,v.ra,void 0),await function(S,j){const z=ke(S);return z.persistence.runTransaction("Save bundle","readwrite",J=>z.Kr.saveBundleMetadata(J,j))}(s.localStore,h),l._completeWith(v.progress),Promise.resolve(v.na)}catch(h){return Ri("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class v0{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Pd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return xN(this.persistence,new TN,e.initialUser,this.serializer)}createPersistence(e){return new SN(Dm.jr,this.serializer)}createSharedClientState(e){return new NN}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class WN extends v0{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await _I(this.xa.syncEngine),await Kl(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return xN(this.persistence,new TN,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new IH(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new s8(n,this.persistence);return new i8(e.asyncQueue,r)}createPersistence(e){const n=eI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new ZE(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,DN(),Jf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new NN}}class M7 extends WN{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xa.syncEngine;this.sharedClientState instanceof Y_&&(this.sharedClientState.syncEngine={Ys:P7.bind(null,n),Zs:N7.bind(null,n),Xs:D7.bind(null,n),Bi:k7.bind(null,n),Js:A7.bind(null,n)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await R7(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=DN();if(!Y_.D(n))throw new me(le.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=eI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Y_(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class vI{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Lx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=x7.bind(null,this.syncEngine),await m0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new l7}()}createDatastore(e){const n=Pd(e.databaseInfo.databaseId),r=function(s){return new WH(s)}(e.databaseInfo);return function(s,a,l,h){return new YH(s,a,l,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,l){return new JH(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Lx(this.syncEngine,n,0),function(){return Nx.D()?new Nx:new HH}())}createSyncEngine(e,n){return function(i,s,a,l,h,g,m){const v=new m7(i,s,a,l,h,g);return m&&(v.Ca=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=ke(n);ve("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await Wl(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):dn("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Pn,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const n=this.La.decode(e),r=Number(n);isNaN(r)&&this.Qa(`length string (${n}) is not valid number`);const i=await this.Ka(r);return new d7(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e===123)}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const n=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new me(le.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,s){const a=ke(i),l=Gh(a.serializer)+"/documents",h={documents:s.map(I=>qh(a.serializer,I))},g=await a.Co("BatchGetDocuments",l,h,s.length),m=new Map;g.forEach(I=>{const S=rH(a.serializer,I);m.set(S.key.toString(),S)});const v=[];return s.forEach(I=>{const S=m.get(I.toString());Fe(!!S),v.push(S)}),v}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Gl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=Ae.fromPath(r);this.mutations.push(new $E(i,this.precondition(i)))}),await async function(r,i){const s=ke(r),a=Gh(s.serializer)+"/documents",l={writes:i.map(h=>Wh(s.serializer,h))};await s.wo("Commit",a,l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Oe();n=Ue.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new me(le.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ue.min())?Wt.exists(!1):Wt.updateTime(n):Wt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ue.min()))throw new me(le.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Wt.updateTime(n)}return Wt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F7{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new rI(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new V7(this.datastore),n=this.za(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const n=this.updateFunction(e);return!Id(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!X2(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=bn.UNAUTHENTICATED,this.clientId=f2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{ve("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(ve("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new me(le.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Yl(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Zf(t,e){t.asyncQueue.verifyOperationInProgress(),ve("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await CN(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function y0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await yI(t);ve("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>Dx(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>Dx(e.remoteStore,s)),t._onlineComponents=e}function KN(t){return t.name==="FirebaseError"?t.code===le.FAILED_PRECONDITION||t.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function yI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ve("FirestoreClient","Using user provided OfflineComponentProvider");try{await Zf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!KN(n))throw n;Ri("Error using user provided cache. Falling back to memory cache: "+n),await Zf(t,new v0)}}else ve("FirestoreClient","Using default OfflineComponentProvider"),await Zf(t,new v0);return t._offlineComponents}async function Lm(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ve("FirestoreClient","Using user provided OnlineComponentProvider"),await y0(t,t._uninitializedComponentsProvider._online)):(ve("FirestoreClient","Using default OnlineComponentProvider"),await y0(t,new vI))),t._onlineComponents}function QN(t){return yI(t).then(e=>e.persistence)}function wI(t){return yI(t).then(e=>e.localStore)}function YN(t){return Lm(t).then(e=>e.remoteStore)}function EI(t){return Lm(t).then(e=>e.syncEngine)}function U7(t){return Lm(t).then(e=>e.datastore)}async function Pl(t){const e=await Lm(t),n=e.eventManager;return n.onListen=_7.bind(null,e.syncEngine),n.onUnlisten=v7.bind(null,e.syncEngine),n}function j7(t){return t.asyncQueue.enqueue(async()=>{const e=await QN(t),n=await YN(t);return e.setNetworkEnabled(!0),function(i){const s=ke(i);return s.C_.delete(0),Rd(s)}(n)})}function z7(t){return t.asyncQueue.enqueue(async()=>{const e=await QN(t),n=await YN(t);return e.setNetworkEnabled(!1),async function(i){const s=ke(i);s.C_.add(0),await Wl(s),s.M_.set("Offline")}(n)})}function $7(t,e){const n=new Pn;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await function(g,m){const v=ke(g);return v.persistence.runTransaction("read document","readonly",I=>v.localDocuments.getDocument(I,m))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new me(le.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=Yl(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await wI(t),e,n)),n.promise}function XN(t,e,n={}){const r=new Pn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,g){const m=new Mm({next:I=>{a.enqueueAndForget(()=>lI(s,v));const S=I.docs.has(l);!S&&I.fromCache?g.reject(new me(le.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&I.fromCache&&h&&h.source==="server"?g.reject(new me(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(I)},error:I=>g.reject(I)}),v=new hI(Hl(l.path),m,{includeMetadataChanges:!0,J_:!0});return uI(s,v)}(await Pl(t),t.asyncQueue,e,n,r)),r.promise}function H7(t,e){const n=new Pn;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await Zg(i,s,!0),h=new $N(s,l.ls),g=h.ca(l.documents),m=h.applyChanges(g,!1);a.resolve(m.snapshot)}catch(l){const h=Yl(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await wI(t),e,n)),n.promise}function JN(t,e,n={}){const r=new Pn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,g){const m=new Mm({next:I=>{a.enqueueAndForget(()=>lI(s,v)),I.fromCache&&h.source==="server"?g.reject(new me(le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(I)},error:I=>g.reject(I)}),v=new hI(l,m,{includeMetadataChanges:!0,J_:!0});return uI(s,v)}(await Pl(t),t.asyncQueue,e,n,r)),r.promise}function q7(t,e){const n=new Mm(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){ke(i).q_.add(s),s.next()}(await Pl(t),n)),()=>{n.Na(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){ke(i).q_.delete(s)}(await Pl(t),n))}}function G7(t,e,n,r){const i=function(a,l){let h;return h=typeof a=="string"?Z2().encode(a):a,function(m,v){return new L7(m,v)}(function(m,v){if(m instanceof Uint8Array)return Fx(m,v);if(m instanceof ArrayBuffer)return Fx(new Uint8Array(m),v);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(n,Pd(e));t.asyncQueue.enqueueAndForget(async()=>{O7(await EI(t),i,r)})}function W7(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=ke(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await wI(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function II(t,e,n){if(!n)throw new me(le.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eD(t,e,n,r){if(e===!0&&r===!0)throw new me(le.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ux(t){if(!Ae.isDocumentKey(t))throw new me(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function jx(t){if(Ae.isDocumentKey(t))throw new me(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Oe()}function vt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new me(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Vm(t);throw new me(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function tD(t,e){if(e<=0)throw new me(le.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new me(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new me(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZN((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new me(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new me(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new me(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zx({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new me(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new me(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zx(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new W$;switch(r.type){case"firstParty":return new X$(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new me(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Bx.get(n);r&&(ve("ComponentProvider","Removing Datastore"),Bx.delete(n),r.terminate())}(this),Promise.resolve()}}function K7(t,e,n,r={}){var i;const s=(t=vt(t,kd))._getSettings(),a=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Ri("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=bn.MOCK_USER;else{l=nB(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new me(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new bn(g)}t._authCredentials=new K$(new d2(l,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _r=class nD{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new nD(this.firestore,e,this._query)}},Xt=class rD{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new So(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rD(this.firestore,e,this._key)}},So=class iD extends _r{constructor(e,n,r){super(e,n,Hl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xt(this.firestore,null,new Ae(e))}withConverter(e){return new iD(this.firestore,e,this._path)}};function sD(t,e,...n){if(t=We(t),II("collection","path",e),t instanceof kd){const r=pt.fromString(e,...n);return jx(r),new So(t,null,r)}{if(!(t instanceof Xt||t instanceof So))throw new me(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(pt.fromString(e,...n));return jx(r),new So(t.firestore,null,r)}}function Q7(t,e){if(t=vt(t,kd),II("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new me(le.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new _r(t,null,function(r){return new js(pt.emptyPath(),r)}(e))}function rp(t,e,...n){if(t=We(t),arguments.length===1&&(e=f2.newId()),II("doc","path",e),t instanceof kd){const r=pt.fromString(e,...n);return Ux(r),new Xt(t,null,new Ae(r))}{if(!(t instanceof Xt||t instanceof So))throw new me(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(pt.fromString(e,...n));return Ux(r),new Xt(t.firestore,t instanceof So?t.converter:null,new Ae(r))}}function oD(t,e){return t=We(t),e=We(e),(t instanceof Xt||t instanceof So)&&(e instanceof Xt||e instanceof So)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function aD(t,e){return t=We(t),e=We(e),t instanceof _r&&e instanceof _r&&t.firestore===e.firestore&&Td(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new rI(this,"async_queue_retry"),this.iu=()=>{const n=Jf();n&&ve("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=Jf();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=Jf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new Pn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Yo(e))throw e;ve("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw dn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=aI.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Oe()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function w0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class X7{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J7=-1;let on=class extends kd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new Y7}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||uD(this),this._firestoreClient.terminate()}};function On(t){return t._firestoreClient||uD(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function uD(t){var e,n,r;const i=t._freezeSettings(),s=function(l,h,g,m){return new C8(l,h,g,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,ZN(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new B7(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Z7(t,e){cD(t=vt(t,on));const n=On(t);if(n._uninitializedComponentsProvider)throw new me(le.FAILED_PRECONDITION,"SDK cache is already specified.");Ri("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new vI;return lD(n,i,new WN(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function eq(t){cD(t=vt(t,on));const e=On(t);if(e._uninitializedComponentsProvider)throw new me(le.FAILED_PRECONDITION,"SDK cache is already specified.");Ri("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new vI;return lD(e,r,new M7(r,n.cacheSizeBytes))}function lD(t,e,n){const r=new Pn;return t.asyncQueue.enqueue(async()=>{try{await Zf(t,n),await y0(t,e),r.resolve()}catch(i){const s=i;if(!KN(s))throw s;Ri("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function tq(t){if(t._initialized&&!t._terminated)throw new me(le.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Pn;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Ii.D())return Promise.resolve();const i=r+"main";await Ii.delete(i)}(eI(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function nq(t){return function(n){const r=new Pn;return n.asyncQueue.enqueueAndForget(async()=>S7(await EI(n),r)),r.promise}(On(t=vt(t,on)))}function rq(t){return j7(On(t=vt(t,on)))}function iq(t){return z7(On(t=vt(t,on)))}function sq(t,e){const n=On(t=vt(t,on)),r=new X7;return G7(n,t._databaseId,e,r),r}function oq(t,e){return W7(On(t=vt(t,on)),e).then(n=>n?new _r(t,null,n.query):null)}function cD(t){if(t._initialized||t._terminated)throw new me(le.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new os(En.fromBase64String(e))}catch(n){throw new me(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new os(En.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fo=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new me(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ou=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new me(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new me(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return et(this._lat,e._lat)||et(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aq=/^__.*__$/;class uq{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zs(e,this.data,this.fieldMask,n,this.fieldTransforms):new ql(e,this.data,n,this.fieldTransforms)}}class hD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function dD(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe()}}class Bm{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Bm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return ip(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(dD(this.Iu)&&aq.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class lq{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pd(e)}pu(e,n,r,i=!1){return new Bm({Iu:e,methodName:n,gu:r,path:Gt.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function au(t){const e=t._freezeSettings(),n=Pd(t._databaseId);return new lq(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Um(t,e,n,r,i,s={}){const a=t.pu(s.merge||s.mergeFields?2:0,e,n,i);CI("Data must be an object, but it was:",a,r);const l=pD(r,a);let h,g;if(s.merge)h=new Pr(a.fieldMask),g=a.fieldTransforms;else if(s.mergeFields){const m=[];for(const v of s.mergeFields){const I=E0(e,v,n);if(!a.contains(I))throw new me(le.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);_D(m,I)||m.push(I)}h=new Pr(m),g=a.fieldTransforms.filter(v=>h.covers(v.field))}else h=null,g=a.fieldTransforms;return new uq(new Bn(l),h,g)}class Nd extends ou{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nd}}function fD(t,e,n){return new Bm({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class SI extends ou{_toFieldTransform(e){return new Cd(e.path,new Il)}isEqual(e){return e instanceof SI}}class cq extends ou{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=fD(this,e,!0),r=this.yu.map(s=>uu(s,n)),i=new qa(r);return new Cd(e.path,i)}isEqual(e){return this===e}}class hq extends ou{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=fD(this,e,!0),r=this.yu.map(s=>uu(s,n)),i=new Ga(r);return new Cd(e.path,i)}isEqual(e){return this===e}}class dq extends ou{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new Sl(e.serializer,H2(e.serializer,this.wu));return new Cd(e.path,n)}isEqual(e){return this===e}}function TI(t,e,n,r){const i=t.pu(1,e,n);CI("Data must be an object, but it was:",i,r);const s=[],a=Bn.empty();su(r,(h,g)=>{const m=bI(e,h,n);g=We(g);const v=i.Ru(m);if(g instanceof Nd)s.push(m);else{const I=uu(g,v);I!=null&&(s.push(m),a.set(m,I))}});const l=new Pr(s);return new hD(a,l,i.fieldTransforms)}function xI(t,e,n,r,i,s){const a=t.pu(1,e,n),l=[E0(e,r,n)],h=[i];if(s.length%2!=0)throw new me(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)l.push(E0(e,s[I])),h.push(s[I+1]);const g=[],m=Bn.empty();for(let I=l.length-1;I>=0;--I)if(!_D(g,l[I])){const S=l[I];let j=h[I];j=We(j);const z=a.Ru(S);if(j instanceof Nd)g.push(S);else{const J=uu(j,z);J!=null&&(g.push(S),m.set(S,J))}}const v=new Pr(g);return new hD(m,v,a.fieldTransforms)}function gD(t,e,n,r=!1){return uu(n,t.pu(r?4:3,e))}function uu(t,e){if(mD(t=We(t)))return CI("Unsupported field value:",e,t),pD(t,e);if(t instanceof ou)return function(r,i){if(!dD(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let h=uu(l,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=We(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return H2(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Kt.fromDate(r);return{timestampValue:Tl(i.serializer,s)}}if(r instanceof Kt){const s=new Kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Tl(i.serializer,s)}}if(r instanceof Fm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof os)return{bytesValue:nN(i.serializer,r._byteString)};if(r instanceof Xt){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:KE(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${Vm(r)}`)}(t,e)}function pD(t,e){const n={};return T2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):su(t,(r,i)=>{const s=uu(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function mD(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Kt||t instanceof Fm||t instanceof os||t instanceof Xt||t instanceof ou)}function CI(t,e,n){if(!mD(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Vm(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function E0(t,e,n){if((e=We(e))instanceof Fo)return e._internalPath;if(typeof e=="string")return bI(t,e);throw ip("Field path arguments must be of type string or ",t,!1,void 0,n)}const fq=new RegExp("[~\\*/\\[\\]]");function bI(t,e,n){if(e.search(fq)>=0)throw ip(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fo(...e.split("."))._internalPath}catch{throw ip(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ip(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new me(le.INVALID_ARGUMENT,l+t+h)}function _D(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(jm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class gq extends Qh{data(){return super.data()}}function jm(t,e){return typeof e=="string"?bI(t,e):e instanceof Fo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new me(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AI{}class Dd extends AI{}function Ys(t,e,...n){let r=[];e instanceof AI&&r.push(e),r=r.concat(n),function(s){const a=s.filter(h=>h instanceof PI).length,l=s.filter(h=>h instanceof zm).length;if(a>1||a>0&&l>0)throw new me(le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class zm extends Dd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new zm(e,n,r)}_apply(e){const n=this._parse(e);return wD(e._query,n),new _r(e.firestore,e.converter,u0(e._query,n))}_parse(e){const n=au(e.firestore);return function(s,a,l,h,g,m,v){let I;if(g.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new me(le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Hx(v,m);const S=[];for(const j of v)S.push($x(h,s,j));I={arrayValue:{values:S}}}else I=$x(h,s,v)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Hx(v,m),I=gD(l,a,v,m==="in"||m==="not-in");return ut.create(g,m,I)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function pq(t,e,n){const r=e,i=jm("where",t);return zm._create(i,r,n)}class PI extends AI{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new PI(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:St.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const h of l)wD(a,h),a=u0(a,h)}(e._query,n),new _r(e.firestore,e.converter,u0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class RI extends Dd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new RI(e,n)}_apply(e){const n=function(i,s,a){if(i.startAt!==null)throw new me(le.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new me(le.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hh(s,a)}(e._query,this._field,this._direction);return new _r(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new js(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function mq(t,e="asc"){const n=e,r=jm("orderBy",t);return RI._create(r,n)}class $m extends Dd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new $m(e,n,r)}_apply(e){return new _r(e.firestore,e.converter,Qg(e._query,this._limit,this._limitType))}}function _q(t){return tD("limit",t),$m._create("limit",t,"F")}function vq(t){return tD("limitToLast",t),$m._create("limitToLast",t,"L")}class Hm extends Dd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Hm(e,n,r)}_apply(e){const n=yD(e,this.type,this._docOrFields,this._inclusive);return new _r(e.firestore,e.converter,function(i,s){return new js(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function yq(...t){return Hm._create("startAt",t,!0)}function wq(...t){return Hm._create("startAfter",t,!1)}class qm extends Dd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new qm(e,n,r)}_apply(e){const n=yD(e,this.type,this._docOrFields,this._inclusive);return new _r(e.firestore,e.converter,function(i,s){return new js(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function Eq(...t){return qm._create("endBefore",t,!1)}function Iq(...t){return qm._create("endAt",t,!0)}function yD(t,e,n,r){if(n[0]=We(n[0]),n[0]instanceof Qh)return function(s,a,l,h,g){if(!h)throw new me(le.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const m=[];for(const v of nl(s))if(v.field.isKeyField())m.push($a(a,h.key));else{const I=h.data.field(v.field);if(Am(I))throw new me(le.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const S=v.field.canonicalString();throw new me(le.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}m.push(I)}return new Lo(m,g)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=au(t.firestore);return function(a,l,h,g,m,v){const I=a.explicitOrderBy;if(m.length>I.length)throw new me(le.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let j=0;j<m.length;j++){const z=m[j];if(I[j].field.isKeyField()){if(typeof z!="string")throw new me(le.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof z}`);if(!jE(a)&&z.indexOf("/")!==-1)throw new me(le.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${z}' contains a slash.`);const J=a.path.child(pt.fromString(z));if(!Ae.isDocumentKey(J))throw new me(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${J}' is not because it contains an odd number of segments.`);const V=new Ae(J);S.push($a(l,V))}else{const J=gD(h,g,z);S.push(J)}}return new Lo(S,v)}(t._query,t.firestore._databaseId,i,e,n,r)}}function $x(t,e,n){if(typeof(n=We(n))=="string"){if(n==="")throw new me(le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jE(e)&&n.indexOf("/")!==-1)throw new me(le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(pt.fromString(n));if(!Ae.isDocumentKey(r))throw new me(le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $a(t,new Ae(r))}if(n instanceof Xt)return $a(t,n._key);throw new me(le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vm(n)}.`)}function Hx(t,e){if(!Array.isArray(t)||t.length===0)throw new me(le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wD(t,e){const n=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new me(le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class kI{convertValue(e,n="none"){switch(za(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Do(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Oe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return su(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Fm(nn(e.latitude),nn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=BE(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jh(e));default:return null}}convertTimestamp(e){const n=No(e);return new Kt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=pt.fromString(e);Fe(dN(r));const i=new Oo(r.get(1),r.get(3)),s=new Ae(r.popFirst(5));return i.isEqual(n)||dn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Sq extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new os(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xt(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Vs=class extends Qh{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(jm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},eh=class extends Vs{data(e={}){return super.data(e)}},Bo=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ea(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new eh(this._firestore,this._userDataWriter,r.key,r,new Ea(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new me(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const h=new eh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ea(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new eh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ea(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let g=-1,m=-1;return l.type!==0&&(g=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),m=a.indexOf(l.doc.key)),{type:Tq(l.type),doc:h,oldIndex:g,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function Tq(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe()}}function ED(t,e){return t instanceof Vs&&e instanceof Vs?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Bo&&e instanceof Bo&&t._firestore===e._firestore&&aD(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xq(t){t=vt(t,Xt);const e=vt(t.firestore,on);return XN(On(e),t._key).then(n=>NI(e,t,n))}class lu extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new os(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xt(this.firestore,null,n)}}function Cq(t){t=vt(t,Xt);const e=vt(t.firestore,on),n=On(e),r=new lu(e);return $7(n,t._key).then(i=>new Vs(e,r,t._key,i,new Ea(i!==null&&i.hasLocalMutations,!0),t.converter))}function bq(t){t=vt(t,Xt);const e=vt(t.firestore,on);return XN(On(e),t._key,{source:"server"}).then(n=>NI(e,t,n))}function Aq(t){t=vt(t,_r);const e=vt(t.firestore,on),n=On(e),r=new lu(e);return vD(t._query),JN(n,t._query).then(i=>new Bo(e,r,t,i))}function Pq(t){t=vt(t,_r);const e=vt(t.firestore,on),n=On(e),r=new lu(e);return H7(n,t._query).then(i=>new Bo(e,r,t,i))}function Rq(t){t=vt(t,_r);const e=vt(t.firestore,on),n=On(e),r=new lu(e);return JN(n,t._query,{source:"server"}).then(i=>new Bo(e,r,t,i))}function qx(t,e,n){t=vt(t,Xt);const r=vt(t.firestore,on),i=Gm(t.converter,e,n);return Od(r,[Um(au(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Wt.none())])}function Gx(t,e,n,...r){t=vt(t,Xt);const i=vt(t.firestore,on),s=au(i);let a;return a=typeof(e=We(e))=="string"||e instanceof Fo?xI(s,"updateDoc",t._key,e,n,r):TI(s,"updateDoc",t._key,e),Od(i,[a.toMutation(t._key,Wt.exists(!0))])}function kq(t){return Od(vt(t.firestore,on),[new Gl(t._key,Wt.none())])}function Nq(t,e){const n=vt(t.firestore,on),r=rp(t),i=Gm(t.converter,e);return Od(n,[Um(au(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Wt.exists(!1))]).then(()=>r)}function ID(t,...e){var n,r,i;t=We(t);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||w0(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges};if(w0(e[a])){const v=e[a];e[a]=(n=v.next)===null||n===void 0?void 0:n.bind(v),e[a+1]=(r=v.error)===null||r===void 0?void 0:r.bind(v),e[a+2]=(i=v.complete)===null||i===void 0?void 0:i.bind(v)}let h,g,m;if(t instanceof Xt)g=vt(t.firestore,on),m=Hl(t._key.path),h={next:v=>{e[a]&&e[a](NI(g,t,v))},error:e[a+1],complete:e[a+2]};else{const v=vt(t,_r);g=vt(v.firestore,on),m=v._query;const I=new lu(g);h={next:S=>{e[a]&&e[a](new Bo(g,I,v,S))},error:e[a+1],complete:e[a+2]},vD(t._query)}return function(I,S,j,z){const J=new Mm(z),V=new hI(S,J,j);return I.asyncQueue.enqueueAndForget(async()=>uI(await Pl(I),V)),()=>{J.Na(),I.asyncQueue.enqueueAndForget(async()=>lI(await Pl(I),V))}}(On(g),m,l,h)}function Dq(t,e){return q7(On(t=vt(t,on)),w0(e)?e:{next:e})}function Od(t,e){return function(r,i){const s=new Pn;return r.asyncQueue.enqueueAndForget(async()=>y7(await EI(r),i,s)),s.promise}(On(t),e)}function NI(t,e,n){const r=n.docs.get(e._key),i=new lu(t);return new Vs(t,i,e._key,r,new Ea(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oq={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mq=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=au(e)}set(e,n,r){this._verifyNotCommitted();const i=io(e,this._firestore),s=Gm(i.converter,n,r),a=Um(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Wt.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=io(e,this._firestore);let a;return a=typeof(n=We(n))=="string"||n instanceof Fo?xI(this._dataReader,"WriteBatch.update",s._key,n,r,i):TI(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(a.toMutation(s._key,Wt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=io(e,this._firestore);return this._mutations=this._mutations.concat(new Gl(n._key,Wt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new me(le.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function io(t,e){if((t=We(t)).firestore!==e)throw new me(le.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lq=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=au(n)}get(n){const r=io(n,this._firestore),i=new Sq(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Oe();const a=s[0];if(a.isFoundDocument())return new Qh(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Qh(this._firestore,i,r._key,null,r.converter);throw Oe()})}set(n,r,i){const s=io(n,this._firestore),a=Gm(s.converter,r,i),l=Um(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(n,r,i,...s){const a=io(n,this._firestore);let l;return l=typeof(r=We(r))=="string"||r instanceof Fo?xI(this._dataReader,"Transaction.update",a._key,r,i,s):TI(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,l),this}delete(n){const r=io(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=io(e,this._firestore),r=new lu(this._firestore);return super.get(e).then(i=>new Vs(this._firestore,r,n._key,i._document,new Ea(!1,!1),n.converter))}};function Vq(t,e,n){t=vt(t,on);const r=Object.assign(Object.assign({},Oq),n);return function(s){if(s.maxAttempts<1)throw new me(le.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,l){const h=new Pn;return s.asyncQueue.enqueueAndForget(async()=>{const g=await U7(s);new F7(s.asyncQueue,g,l,a,h).run()}),h.promise}(On(t),i=>e(new Lq(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fq(){return new Nd("deleteField")}function Bq(){return new SI("serverTimestamp")}function Uq(...t){return new cq("arrayUnion",t)}function jq(...t){return new hq("arrayRemove",t)}function zq(t){return new dq("increment",t)}(function(e,n=!0){(function(i){$l=i})(qo),Ro(new rs("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new on(new Q$(r.getProvider("auth-internal")),new Z$(r.getProvider("app-check-internal")),function(g,m){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new me(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Oo(g.options.projectId,m)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),es(U1,"4.4.0",e),es(U1,"4.4.0","esm2017")})();const $q="@firebase/firestore-compat",Hq="0.3.23";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new me("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(){if(typeof Uint8Array>"u")throw new me("unimplemented","Uint8Arrays are not available in this environment.")}function Kx(){if(!T8())throw new me("unimplemented","Blobs are unavailable in Firestore in this environment.")}let SD=class I0{constructor(e){this._delegate=e}static fromBase64String(e){return Kx(),new I0(os.fromBase64String(e))}static fromUint8Array(e){return Wx(),new I0(os.fromUint8Array(e))}toBase64(){return Kx(),this._delegate.toBase64()}toUint8Array(){return Wx(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(t){return qq(t,["next","error","complete"])}function qq(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gq{enableIndexedDbPersistence(e,n){return Z7(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return eq(e._delegate)}clearIndexedDbPersistence(e){return tq(e._delegate)}}class TD{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Oo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ri("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){K7(this._delegate,e,n,r)}enableNetwork(){return rq(this._delegate)}disableNetwork(){return iq(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,eD("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return nq(this._delegate)}onSnapshotsInSync(e){return Dq(this._delegate,e)}get app(){if(!this._appCompat)throw new me("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Rl(this,sD(this._delegate,e))}catch(n){throw lr(n,"collection()","Firestore.collection()")}}doc(e){try{return new ii(this,rp(this._delegate,e))}catch(n){throw lr(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ur(this,Q7(this._delegate,e))}catch(n){throw lr(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Vq(this._delegate,n=>e(new xD(this,n)))}batch(){return On(this._delegate),new CD(new Mq(this._delegate,e=>Od(this._delegate,e)))}loadBundle(e){return sq(this._delegate,e)}namedQuery(e){return oq(this._delegate,e).then(n=>n?new ur(this,n):null)}}class Wm extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new SD(new os(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return ii.forKey(n,this.firestore,null)}}function Wq(t){q$(t)}class xD{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Wm(e)}get(e){const n=Ia(e);return this._delegate.get(n).then(r=>new Yh(this._firestore,new Vs(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Ia(e);return r?(DI("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Ia(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Ia(e);return this._delegate.delete(n),this}}class CD{constructor(e){this._delegate=e}set(e,n,r){const i=Ia(e);return r?(DI("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Ia(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Ia(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Ya{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new eh(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Xh(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Ya.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Ya(e,new Wm(e),n),i.set(n,s)),s}}Ya.INSTANCES=new WeakMap;class ii{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Wm(e)}static forPath(e,n,r){if(e.length%2!==0)throw new me("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ii(n,new Xt(n._delegate,r,new Ae(e)))}static forKey(e,n,r){return new ii(n,new Xt(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Rl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Rl(this.firestore,sD(this._delegate,e))}catch(n){throw lr(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=We(e),e instanceof Xt?oD(this._delegate,e):!1}set(e,n){n=DI("DocumentReference.set",n);try{return n?qx(this._delegate,e,n):qx(this._delegate,e)}catch(r){throw lr(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Gx(this._delegate,e):Gx(this._delegate,e,n,...r)}catch(i){throw lr(i,"updateDoc()","DocumentReference.update()")}}delete(){return kq(this._delegate)}onSnapshot(...e){const n=bD(e),r=AD(e,i=>new Yh(this.firestore,new Vs(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return ID(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=Cq(this._delegate):(e==null?void 0:e.source)==="server"?n=bq(this._delegate):n=xq(this._delegate),n.then(r=>new Yh(this.firestore,new Vs(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ii(this.firestore,e?this._delegate.withConverter(Ya.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function lr(t,e,n){return t.message=t.message.replace(e,n),t}function bD(t){for(const e of t)if(typeof e=="object"&&!S0(e))return e;return{}}function AD(t,e){var n,r;let i;return S0(t[0])?i=t[0]:S0(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Yh{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new ii(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return ED(this._delegate,e._delegate)}}class Xh extends Yh{data(e){const n=this._delegate.data(e);return this._delegate._converter||G$(n!==void 0),n}}class ur{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Wm(e)}where(e,n,r){try{return new ur(this.firestore,Ys(this._delegate,pq(e,n,r)))}catch(i){throw lr(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new ur(this.firestore,Ys(this._delegate,mq(e,n)))}catch(r){throw lr(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ur(this.firestore,Ys(this._delegate,_q(e)))}catch(n){throw lr(n,"limit()","Query.limit()")}}limitToLast(e){try{return new ur(this.firestore,Ys(this._delegate,vq(e)))}catch(n){throw lr(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ur(this.firestore,Ys(this._delegate,yq(...e)))}catch(n){throw lr(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ur(this.firestore,Ys(this._delegate,wq(...e)))}catch(n){throw lr(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ur(this.firestore,Ys(this._delegate,Eq(...e)))}catch(n){throw lr(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ur(this.firestore,Ys(this._delegate,Iq(...e)))}catch(n){throw lr(n,"endAt()","Query.endAt()")}}isEqual(e){return aD(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=Pq(this._delegate):(e==null?void 0:e.source)==="server"?n=Rq(this._delegate):n=Aq(this._delegate),n.then(r=>new T0(this.firestore,new Bo(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=bD(e),r=AD(e,i=>new T0(this.firestore,new Bo(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return ID(this._delegate,n,r)}withConverter(e){return new ur(this.firestore,e?this._delegate.withConverter(Ya.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Kq{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Xh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class T0{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ur(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Xh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Kq(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Xh(this._firestore,r))})}isEqual(e){return ED(this._delegate,e._delegate)}}class Rl extends ur{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ii(this.firestore,e):null}doc(e){try{return e===void 0?new ii(this.firestore,rp(this._delegate)):new ii(this.firestore,rp(this._delegate,e))}catch(n){throw lr(n,"doc()","CollectionReference.doc()")}}add(e){return Nq(this._delegate,e).then(n=>new ii(this.firestore,n))}isEqual(e){return oD(this._delegate,e._delegate)}withConverter(e){return new Rl(this.firestore,e?this._delegate.withConverter(Ya.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ia(t){return vt(t,Xt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(...e){this._delegate=new Fo(...e)}static documentId(){return new OI(Gt.keyField().canonicalString())}isEqual(e){return e=We(e),e instanceof Fo?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this._delegate=e}static serverTimestamp(){const e=Bq();return e._methodName="FieldValue.serverTimestamp",new fa(e)}static delete(){const e=Fq();return e._methodName="FieldValue.delete",new fa(e)}static arrayUnion(...e){const n=Uq(...e);return n._methodName="FieldValue.arrayUnion",new fa(n)}static arrayRemove(...e){const n=jq(...e);return n._methodName="FieldValue.arrayRemove",new fa(n)}static increment(e){const n=zq(e);return n._methodName="FieldValue.increment",new fa(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qq={Firestore:TD,GeoPoint:Fm,Timestamp:Kt,Blob:SD,Transaction:xD,WriteBatch:CD,DocumentReference:ii,DocumentSnapshot:Yh,Query:ur,QueryDocumentSnapshot:Xh,QuerySnapshot:T0,CollectionReference:Rl,FieldPath:OI,FieldValue:fa,setLogLevel:Wq,CACHE_SIZE_UNLIMITED:J7};function Yq(t,e){t.INTERNAL.registerComponent(new rs("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Qq)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xq(t){Yq(t,(e,n)=>new TD(e,n,new Gq)),t.registerVersion($q,Hq)}Xq(Ot);Ot.initializeApp({apiKey:"AIzaSyAHOemftrTSOUjtoA6K3VR2hkOU5H-ScSI",authDomain:"amstangram.firebaseapp.com",databaseURL:"https://amstangram.firebaseio.com",projectId:"amstangram",storageBucket:"amstangram.appspot.com",messagingSenderId:"1075176148116",appId:"1:1075176148116:web:e61e6512cd983a75533881",measurementId:"G-PLH3BSWLM2"});const Jq=t=>{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},Zq=t=>{let e=t.length,n,r;for(;e!==0;)r=Math.floor(Math.random()*e),e-=1,n=t[e],t[e]=t[r],t[r]=n;return t},eG=as(fe,{css:{fontSize:3,p:2,borderRadius:1,bg:"notificationBackground",color:"dialogText",animation:`${Zr/2}ms fadeIn both`,boxShadow:"0px 0px 10px #00000080"}}),hi=G.createContext(null),tG=({children:t})=>{const e=G.useRef(),[n,r]=G.useState(null),i=G.useCallback(s=>{r(a=>(a&&clearTimeout(a.timeoutId),{content:s,timeoutId:setTimeout(()=>{r(null)},2e3)}))},[]);return R.jsxs(hi.Provider,{value:i,children:[t,n&&Ow.createPortal(R.jsx(fe,{css:{position:"fixed",top:0,left:0,bottom:0,right:0,pointerEvents:"none",alignItems:"center",justifyContent:"center"},children:R.jsx(eG,{ref:e,children:n.content})}),document.getElementById("notificationContainer"))]})},Gn=G.createContext(null),nG=({children:t})=>{const[e,n]=G.useState(void 0),[r,i]=G.useState(null),[s,a]=G.useState(!1);G.useEffect(()=>{e!==void 0&&r!==null&&a(!0)},[e,r]),G.useEffect(()=>Ot.auth().onAuthStateChanged(async I=>{if(!I)n(null);else{const j=(await Ot.firestore().collection("users").doc(I.uid).get()).data();n({uid:I.uid,...j,firebaseUser:I})}}),[]),G.useEffect(()=>Ot.firestore().collection("users").onSnapshot(I=>{const S={};for(const j of I.docs){const z=j.data();S[j.id]=z}i(S)}),[]);const l=G.useCallback(async(v,I)=>{await v.firebaseUser.updateProfile({displayName:I}),await Ot.firestore().collection("users").doc(v.uid).update({username:I}),n({...v,username:I})},[]),h=G.useCallback(async(v,I,S)=>{const j=Ot.auth.EmailAuthProvider.credential(v.firebaseUser.email,I);await v.firebaseUser.reauthenticateWithCredential(j),await v.firebaseUser.updatePassword(S)},[]),g=G.useCallback(async(v,I,S)=>{const j=Ot.auth.EmailAuthProvider.credential(v.firebaseUser.email,S);await v.firebaseUser.reauthenticateWithCredential(j),await v.firebaseUser.updateEmail(I)},[]),m=G.useMemo(()=>({initialized:s,currentUser:e,usersMetadata:r,updateUsername:l,updatePassword:h,updateEmail:g}),[s,e,r,l,h,g]);return R.jsx(Gn.Provider,{value:m,children:t})},Zo=G.createContext([]),rG=({children:t})=>{const{currentUser:e}=G.useContext(Gn),[n,r]=G.useState(null);G.useEffect(()=>Ot.firestore().collection("tangrams").onSnapshot(a=>{const l=[];for(const h of a.docs){const g=h.id,{...m}=h.data();l.push({id:g,...m})}r(l)}),[]);const i=G.useMemo(()=>{if(!n)return{initialized:!1,approvedTangrams:null,pendingTangrams:null,approvedTangramsByCategory:null};const s=[],a=[];for(const l of n)l.approved?s.push(l):e&&(e.isAdmin||l.uid===e.uid)&&a.push(l);return{initialized:!0,approvedTangrams:s,pendingTangrams:a}},[e,n]);return R.jsx(Zo.Provider,{value:i,children:t})},Mr=G.createContext(null),iG=({children:t})=>{const e=en(),n=G.useContext(hi),{currentUser:r}=G.useContext(Gn),{approvedTangrams:i}=G.useContext(Zo),[s,a]=G.useState(null),[l,h]=G.useState(null),[g,m]=G.useState(null),[v,I]=G.useState(0),[S,j]=G.useState(!1);G.useEffect(()=>{s&&l&&j(!0)},[s,l]),G.useEffect(()=>Ot.firestore().collection("stats").onSnapshot(ce=>{const _e={},pe={};for(const Ye of ce.docs){const be=Ye.id,Me=Ye.data();_e[be]||(_e[be]={},pe[be]={});for(const Se in Me)_e[be][Se]=Me[Se].completed,pe[be][Se]=Me[Se].starred}a(_e),h(pe)}),[]);const z=G.useCallback(oe=>!r||!l[oe]?!1:l[oe][r.uid]===!0,[r,l]),J=G.useCallback(oe=>!r||!s[oe]?!1:s[oe][r.uid]!==void 0,[r,s]),V=G.useCallback(oe=>{let ce=`${window.location.origin}/?tangrams=${oe.map(({id:_e})=>_e).join(",")}`;r&&(ce+=`&uid=${r.uid}`),Jq(ce),n(e.formatMessage({id:"Challenge link copied to clipboard"}))},[n,r,e]),B=G.useCallback(()=>{I(oe=>oe+1)},[]),U=G.useCallback(oe=>{const ce=oe?({id:pe,edges:Ye},{id:be,edges:Me})=>{const Se=J(pe),je=J(be);return!Se&&!je?Me-Ye:Se-je}:({id:pe},{id:Ye})=>{const be=J(pe),Me=J(Ye);return be-Me},_e=Zq([...i]).sort(ce);m(_e)},[i,J]),Z=G.useCallback(async(oe,ce)=>{r&&i.some(_e=>_e.id===oe.id)&&!J(oe.id)&&await Ot.firestore().collection("stats").doc(oe.id).set({[r.uid]:{completed:ce}},{merge:!0})},[i,r,J]),ne=G.useCallback(async oe=>{if(r&&i.some(ce=>ce.id===oe.id)){const ce=z(oe.id);await Ot.firestore().collection("stats").doc(oe.id).set({[r.uid]:{starred:!ce}},{merge:!0})}},[i,r,z]),te=G.useMemo(()=>({initialized:S,requestSave:B,saveRequestId:v,playlist:g,setPlaylist:m,shareTangrams:V,startRandomPlaylist:U,tangramsCompletedBy:s,tangramsStarredBy:l,toggleTangramStar:ne,markTangramAsComplete:Z,isTangramCompleted:J,isTangramStarred:z}),[S,B,v,g,V,U,s,l,ne,Z,J,z]);return R.jsx(Mr.Provider,{value:te,children:t})};var PD={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Qx=It.createContext&&It.createContext(PD),To=function(){return To=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},To.apply(this,arguments)},sG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function RD(t){return t&&t.map(function(e,n){return It.createElement(e.tag,To({key:n},e.attr),RD(e.child))})}function wr(t){return function(e){return It.createElement(oG,To({attr:To({},t.attr)},e),RD(t.child))}}function oG(t){var e=function(n){var r=t.attr,i=t.size,s=t.title,a=sG(t,["attr","size","title"]),l=i||n.size||"1em",h;return n.className&&(h=n.className),t.className&&(h=(h?h+" ":"")+t.className),It.createElement("svg",To({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:h,style:To(To({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&It.createElement("title",null,s),t.children)};return Qx!==void 0?It.createElement(Qx.Consumer,null,function(n){return e(n)}):e(PD)}function kD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"}},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"}}]})(t)}function aG(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(t)}function ND(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"}},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"}}]})(t)}function DD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(t)}function uG(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}}]})(t)}function lG(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"}}]})(t)}function OD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(t)}function MD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(t)}function LD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"}},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"}},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"}}]})(t)}function Uo(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(t)}function cG(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"}},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"}},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"}},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}}]})(t)}function VD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(t)}function hG(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"path",attr:{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"}}]})(t)}function dG(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"line",attr:{x1:"23",y1:"9",x2:"17",y2:"15"}},{tag:"line",attr:{x1:"17",y1:"9",x2:"23",y2:"15"}}]})(t)}function FD(t){return wr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(t)}const fG="modulepreload",gG=function(t){return"/"+t},Yx={},pG=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=gG(s),s in Yx)return;Yx[s]=!0;const a=s.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!r)for(let m=i.length-1;m>=0;m--){const v=i[m];if(v.href===s&&(!a||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const g=document.createElement("link");if(g.rel=a?"stylesheet":fG,a||(g.as="script",g.crossOrigin=""),g.href=s,document.head.appendChild(g),a)return new Promise((m,v)=>{g.addEventListener("load",m),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};function sp(){return sp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sp.apply(this,arguments)}function mG(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function _G(t){G.useEffect(t,[])}function yu(t,e){e===void 0&&(e={});var n=e,r=n.volume,i=r===void 0?1:r,s=n.playbackRate,a=s===void 0?1:s,l=n.soundEnabled,h=l===void 0?!0:l,g=n.interrupt,m=g===void 0?!1:g,v=n.onload,I=mG(n,["id","volume","playbackRate","soundEnabled","interrupt","onload"]),S=It.useRef(null),j=It.useRef(!1),z=It.useState(null),J=z[0],V=z[1],B=It.useState(null),U=B[0],Z=B[1],ne=function(){typeof v=="function"&&v.call(this),j.current&&V(this.duration()*1e3),Z(this)};_G(function(){return pG(()=>import("./howler-fMpnjdjv.js").then(pe=>pe.h),__vite__mapDeps([])).then(function(pe){if(!j.current){var Ye;S.current=(Ye=pe.Howl)!==null&&Ye!==void 0?Ye:pe.default.Howl,j.current=!0,new S.current(sp({src:Array.isArray(t)?t:[t],volume:i,rate:a,onload:ne},I))}}),function(){j.current=!1}}),It.useEffect(function(){S.current&&U&&Z(new S.current(sp({src:Array.isArray(t)?t:[t],volume:i,onload:ne},I)))},[JSON.stringify(t)]),It.useEffect(function(){U&&(U.volume(i),U.rate(a))},[i,a]);var te=It.useCallback(function(pe){typeof pe>"u"&&(pe={}),!(!U||!h&&!pe.forceSoundEnabled)&&(m&&U.stop(),pe.playbackRate&&U.rate(pe.playbackRate),U.play(pe.id))},[U,h,m]),oe=It.useCallback(function(pe){U&&U.stop(pe)},[U]),ce=It.useCallback(function(pe){U&&U.pause(pe)},[U]),_e=[te,{sound:U,stop:oe,pause:ce,duration:J}];return _e}const vG="/assets/star-wql4oqhK.wav",Xx="/assets/button-J_WJeIQM.wav",yG="/assets/card-xj0x2Eh2.wav",wG="/assets/pop-DwoHE_6m.wav",EG="/assets/victory-gnOqf9qL.wav",di=G.createContext([!0,()=>{}]),IG=({children:t})=>{const[e,n]=G.useState(!0),[r]=yu(vG,{soundEnabled:e}),[i]=yu(Xx,{soundEnabled:e}),[s]=yu(Xx,{soundEnabled:e}),[a]=yu(yG,{soundEnabled:e}),[l]=yu(wG,{soundEnabled:e}),[h]=yu(EG,{soundEnabled:e});G.useEffect(()=>{n(window.localStorage.getItem("sound")!=="off")},[]);const g=G.useCallback(()=>{const v=!e;n(v),window.localStorage.setItem("sound",v?"on":"off")},[e]),m=G.useMemo(()=>({soundEnabled:e,toggleSound:g,playButton:i,playToggle:s,playCard:a,playStar:r,playTangram:l,playVictory:h}),[e,g,i,s,a,r,l,h]);return R.jsx(di.Provider,{value:m,children:t})},MI=nd("button",({css:t,onClick:e,mute:n,...r})=>{const{playButton:i}=G.useContext(di);return{css:{borderRadius:2,minWidth:0,minHeight:0,flex:"none",fontWeight:"bold",border:"none",fontSize:"inherit",color:"inherit",background:"none",cursor:"pointer",p:3,"&:disabled":{opacity:.3,cursor:"not-allowed"},"&:focus":{outline:"none"},...t},onClick:s=>{n||i(),e&&e(s)},...r}}),SG=as(MI,{css:{border:"2px solid",borderRadius:2}}),TG=as(MI,{css:{border:"2px solid",color:"errorText"}}),dr=as(MI,({css:t,...e})=>({css:{animation:`${ag({0:{bg:"pieces.lt2"},14:{bg:"pieces.rh"},28:{bg:"pieces.st2"},42:{bg:"pieces.mt1"},57:{bg:"pieces.st1"},71:{bg:"pieces.lt1"},85:{bg:"pieces.sq"},100:{bg:"pieces.lt2"}})} 20s linear infinite both`,color:"#FFFFFFDD",...t},...e})),Km=({uid:t,size:e="badge",css:n,onClick:r,...i})=>{const{playButton:s}=G.useContext(di),a=G.useContext(ki),l=G.useMemo(()=>{const h=Object.values(a.colors.pieces);return h[t.charCodeAt(0)%h.length].slice(1)},[a,t]);return R.jsx(fe,{as:"img",src:`https://api.dicebear.com/7.x/croodles-neutral/svg?seed=${t}&backgroundColor=${encodeURIComponent(l)}`,css:{m:"2px",boxShadow:`0 0 0 2px ${a.colors.dialogText}`,borderRadius:"50%",backgroundColor:l,size:e,...n},onClick:r?h=>{s(),r(h)}:void 0,...i})},xG=(t,e)=>{const[n,r]=G.useState(null),i=l=>{if(n&&l.touches&&l.touches.length!==1)clearTimeout(n.timeoutId);else{const h=l.touches?l.touches.item(0):l;r({timeoutId:setTimeout(t,e),startEvent:{clientX:h.clientX,clientY:h.clientY}})}},s=l=>{if(!n)return;let h=l.touches?l.touches.item(0):l;Math.sqrt(Math.pow(h.clientX-n.startEvent.clientX,2)+Math.pow(h.clientY-n.startEvent.clientY,2))>10&&clearTimeout(n.timeoutId)},a=()=>{n&&clearTimeout(n.timeoutId)};return{onMouseDown:i,onMouseUp:a,onMouseMove:s,onMouseLeave:a,onTouchStart:i,onTouchEnd:a,onTouchMove:s}},CG=t=>t.edges>16?0:t.edges>8?1:2,Md=({showStroke:t,tangram:e,completed:n,selected:r,css:i,onBadgeClick:s,onClick:a,onLongPress:l,hideBadge:h,...g})=>{const{path:m,width:v,height:I,uid:S,approved:j,emoji:z}=e,J=G.useMemo(()=>CG(e),[e]),{playCard:V}=G.useContext(di),U=G.useContext(ki).colors.difficulties[J],Z=G.useCallback(()=>{l&&l(e)},[l,e]),ne=xG(Z,1e3);return R.jsx(fe,{css:i,onClick:a?()=>{V(),a(e)}:void 0,...ne,...g,children:R.jsxs(fe,{css:{opacity:S&&j===!1?.5:1,borderRadius:5,boxShadow:r?`0px 0px 0px 4px ${U}`:"0px 0px 0px 1px rgba(0, 0, 0, 0.1)",m:1,bg:"background",transition:`background-color ${sg}ms`,p:3,textAlign:"center",position:"relative",cursor:a||l?"pointer":void 0,width:128,height:178},deps:[U,r,S,j],children:[R.jsx(fe,{as:"svg",css:{flex:"1",justifyContent:"center",fill:U,stroke:t?"lime":void 0,strokeWidth:t?8:void 0},deps:[t,U],viewBox:`0 0 ${v} ${I}`,dangerouslySetInnerHTML:{__html:`<path d="${m}" />`}}),n&&R.jsx(fe,{css:{position:"absolute",top:1,left:1,fontSize:"30px"},children:z}),S&&!h&&R.jsx(Km,{uid:S,css:{position:"absolute",bottom:1,right:1,cursor:s?"pointer":void 0},onClick:s?te=>{te.stopPropagation(),s(S)}:void 0})]})})},us=({children:t,title:e,onClose:n,big:r,css:i,...s})=>{const{playButton:a}=G.useContext(di);return Ow.createPortal(R.jsx(fe,{onClick:n,css:{position:"fixed",top:0,left:0,right:0,bottom:0,bg:"#00000080",alignItems:"center",justifyContent:"center",animation:`${Zr/2}ms fadeIn ease both`,p:3},children:R.jsxs(fe,{css:{flex:"0 1 auto",bg:"dialogBackground",color:"dialogText",borderRadius:3,transition:`background-color ${sg}ms, color ${sg}ms`,fontSize:3,p:3,gap:3,maxWidth:"95vw",width:r?"568px":"400px"},onClick:l=>l.stopPropagation(),children:[R.jsxs(fe,{css:{flexDirection:"row",gap:3,alignItems:"center",justifyContent:"space-between",zIndex:1},children:[e,R.jsx(fe,{as:FD,css:{cursor:"pointer",size:"badge",ml:e?void 0:"auto"},onClick:()=>{a(),n()}})]}),R.jsx(fe,{css:{overflow:"auto",flex:"1",maxWidth:"100%",...i},...s,children:t})]})}),document.getElementById("dialogContainer"))},Xe=nd("div",{css:{display:"inline",minWidth:0,minHeight:0,flex:"none"}}),kr=as(Xe,{css:{fontSize:2,color:"errorText"}}),vs=as(Xe,{css:{fontSize:2,opacity:.75}}),qr=as(Xe,{css:{fontSize:4,fontWeight:"bold"}}),wu=as(Xe,{css:{fontSize:3,fontWeight:"bold"}}),Jx=nd("a",{css:{cursor:"pointer",textDecoration:"underline",color:"inherit","&:visited":{color:"inherit"}}}),Ci=as(Xe,{css:{cursor:"pointer",textDecoration:"underline"}}),xr=({icon:t,css:e})=>R.jsx(Xe,{as:t,css:{position:"relative",top:"0.1em",size:"0.9em",...e}}),bG=({uid:t,tangrams:e,deferred:n})=>{const r=en(),{usersMetadata:i}=G.useContext(Gn);G.useContext(Mr);const s=i[t]?i[t].username:null;return R.jsxs(us,{big:!0,title:R.jsx(qr,{children:s?r.formatMessage({id:"{username} challenged you"},{username:s}):r.formatMessage({id:"Rise to the challenge"},{username:s})}),onClose:()=>n.reject(cn),css:{gap:3,overflow:"initial",maxWidth:"568px"},children:[R.jsx(fe,{css:{flex:"1",overflow:"auto",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",m:-1},children:e.map(a=>R.jsx(Md,{selected:!0,tangram:a,css:{m:1}},a.id))}),R.jsx(dr,{onClick:()=>{n.resolve()},children:r.formatMessage({id:"Let's go!"})})]})},AG=(t,e)=>e.edges===t.edges?e.length-t.length:e.edges-t.edges,PG=(t,e)=>Oc.indexOf(t.emoji)-Oc.indexOf(e.emoji),RG=(t,e)=>Mc.indexOf(t.emoji)-Mc.indexOf(e.emoji),fn=nd("input",{type:"text",css:{color:"inherit",fontSize:"inherit",bg:"inputBackground",border:"none",borderRadius:2,borderColor:"currentColor",p:2,"&:disabled":{opacity:.5,cursor:"not-allowed"},"&:focus":{outline:"none"}}}),kG=as(fe,({css:t,...e})=>({css:{p:3,alignItems:"center",position:"sticky",top:0,zIndex:1,background:`linear-gradient(0deg, rgba(0,0,0,0) 0%, ${G.useContext(ki).colors.dialogBackground} 50%)`,...t},...e})),NG=({deferred:t})=>{const e=en(),{currentUser:n}=G.useContext(Gn),{pendingTangrams:r,approvedTangrams:i}=G.useContext(Zo),{showProfile:s,showTangram:a}=G.useContext(Fd),{setPlaylist:l,shareTangrams:h,startRandomPlaylist:g,isTangramCompleted:m,isTangramStarred:v}=G.useContext(Mr),[I,S]=G.useState([]),[j,z]=G.useState(()=>{const te=window.localStorage.getItem("selectedGalleryFilter");return["all","uncompleted","starred","pending"].includes(te)?te:"all"}),J=te=>{z(te.target.value),window.localStorage.setItem("selectedGalleryFilter",te.target.value)},V=G.useCallback(te=>{S(oe=>oe.some(ce=>ce.id===te.id)?oe.filter(ce=>ce.id!==te.id):[...oe,te])},[]),B=()=>{I.length?l(I):g(),t.resolve()},U=()=>t.reject(cn),Z=G.useMemo(()=>{const te=j==="pending"?r:i,oe={};for(const _e of te)j==="uncompleted"&&m(_e.id)||j==="starred"&&!v(_e.id)||(oe[_e.category]||(oe[_e.category]=[]),oe[_e.category].push(_e));const ce={};for(const _e of Object.keys(oe).sort())ce[_e]=oe[_e].sort(_e==="letters"?RG:_e==="digits"?PG:AG);return ce},[r,i,j,m,v]),ne=Object.keys(Z);return R.jsx(R.Fragment,{children:R.jsx(us,{big:!0,title:R.jsx(qr,{children:e.formatMessage({id:"Tangram gallery"})}),css:{gap:3,width:"568px"},onClose:U,children:R.jsxs(R.Fragment,{children:[R.jsxs(fn,{as:"select",value:j,onChange:J,children:[R.jsx("option",{value:"all",children:e.formatMessage({id:"All tangrams"})}),R.jsx("option",{value:"uncompleted",children:e.formatMessage({id:"Uncompleted tangrams"})}),R.jsx("option",{value:"starred",children:e.formatMessage({id:" Starred tangrams"})}),R.jsx("option",{value:"pending",children:e.formatMessage({id:"Pending approbation tangrams"})})]}),R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:3},children:ne.length===0?R.jsx(fe,{css:{gap:3,alignItems:"center"},children:j==="uncompleted"?R.jsxs(R.Fragment,{children:[R.jsx(Xe,{css:{fontSize:"8em"},children:""}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(wu,{css:{textAlign:"center"},children:R.jsx(Et,{id:"You've completed all tangrams"})}),R.jsx(vs,{children:R.jsx(Et,{id:"Come back later for more or create your own tangrams"})})]})]}):j==="pending"?n&&n.isAdmin?R.jsxs(R.Fragment,{children:[R.jsx(Xe,{css:{fontSize:"8em"},children:""}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(wu,{css:{textAlign:"center"},children:R.jsx(Et,{id:"No tangram left to approve"})}),R.jsx(vs,{children:R.jsx(Et,{id:"Good job moderator {username}!",values:{username:n.username}})})]})]}):R.jsxs(R.Fragment,{children:[R.jsx(Xe,{css:{fontSize:"8em"},children:""}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(wu,{css:{textAlign:"center"},children:R.jsx(Et,{id:"All your tangrams have been approved"})}),R.jsx(vs,{children:R.jsx(Et,{id:"Create more tangrams and earn <starIcon></starIcon>",values:{starIcon:()=>R.jsx(xr,{icon:Uo,css:{fill:"currentColor"}})}})})]})]}):j==="starred"?R.jsxs(R.Fragment,{children:[R.jsx(Xe,{css:{fontSize:"8em"},children:""}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(wu,{css:{textAlign:"center"},children:R.jsx(Et,{id:"No starred tangrams yet"})}),R.jsx(vs,{children:R.jsx(Et,{id:"Press <starIcon></starIcon> to star a tangram and show your love",values:{starIcon:()=>R.jsx(xr,{icon:Uo,css:{fill:"currentColor"}})}})})]})]}):R.jsxs(R.Fragment,{children:[R.jsx(Xe,{css:{fontSize:"8em"},children:""}),R.jsxs(fe,{css:{gap:2,alignItems:"center",px:3},children:[R.jsx(wu,{css:{textAlign:"center"},children:R.jsx(Et,{id:"Nothing to see here"})}),R.jsx(vs,{children:R.jsx(Et,{id:"Something might have gone wrong"})})]})]})},"noresult"):R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:3},children:ne.map(te=>R.jsxs(fe,{children:[R.jsx(kG,{children:R.jsx(wu,{children:e.formatMessage({id:te})})}),R.jsx(fe,{css:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 136px)",gridColumnGap:2,gridRowGap:2,justifyContent:"center",justifyItems:"center",alignItems:"center"},children:Z[te].map(oe=>R.jsx(Md,{showStroke:j==="pending"&&n&&n.isAdmin,tangram:oe,completed:m(oe.id),selected:I.some(ce=>ce.id===oe.id),onClick:V,onBadgeClick:s,onLongPress:a},oe.id))})]},te))},"results")}),R.jsxs(fe,{css:{flexDirection:"row",gap:2},children:[R.jsx(dr,{onClick:B,css:{flex:"1"},children:I.length===0?e.formatMessage({id:"Play now!"}):I.length===1?e.formatMessage({id:"Start 1 tangram!"}):e.formatMessage({id:"Start {count} tangrams!"},{count:I.length})}),R.jsx(dr,{disabled:I.length===0,onClick:()=>h(I),children:R.jsx(fe,{as:LD,css:{size:"icon",m:"-2px"}})})]})]})})})},DG=({deferred:t})=>{const e=en(),{showProfile:n}=G.useContext(Fd),{currentUser:r,usersMetadata:i}=G.useContext(Gn),{approvedTangrams:s}=G.useContext(Zo),{tangramsStarredBy:a,tangramsCompletedBy:l}=G.useContext(Mr),[h,g]=G.useState(()=>{const j=window.localStorage.getItem("selectedLeaderboard");return["stars","completed","created"].includes(j)?j:"stars"}),m=j=>{g(j.target.value),window.localStorage.setItem("selectedLeaderboard",j.target.value)},v=j=>{n(j)},I=G.useMemo(()=>{const j={},z={},J={};for(const{id:V,uid:B}of s){z[B]||(z[B]=0,j[B]=0);for(const U in a[V])U!==B&&a[V][U]&&(j[B]+=1);z[B]+=1;for(const U in l[V])J[U]||(J[U]=0),J[U]+=1}return Object.keys(i).map(V=>{const B=i[V];return{uid:V,...B,stars:j[V]||0,completed:J[V]||0,created:z[V]||0}})},[s,a,l,i]),S=G.useMemo(()=>{if(I)return I.sort((j,z)=>z[h]-j[h])},[I,h]);return R.jsx(us,{title:R.jsx(qr,{children:e.formatMessage({id:"Leaderboard"})}),onClose:()=>t.reject(cn),css:{gap:3},children:R.jsxs(R.Fragment,{children:[R.jsxs(fn,{as:"select",value:h,onChange:m,children:[R.jsx("option",{value:"stars",children:e.formatMessage({id:"Stars earned"})}),R.jsx("option",{value:"completed",children:e.formatMessage({id:"Completed tangrams"})}),R.jsx("option",{value:"created",children:e.formatMessage({id:"Created tangrams"})})]}),R.jsx(fe,{css:{flex:"1",overflow:"auto",gap:2},children:S.map(({uid:j,username:z,...J},V)=>R.jsxs(fe,{css:{flexDirection:"row",gap:2,alignItems:"center",fontSize:V===0?"1.6em":V===1?"1.4em":V===2?"1.2em":void 0},deps:[V],children:[R.jsx(Km,{uid:j,size:"badge",onClick:()=>v(j)}),R.jsx(Xe,{css:{flex:"1",fontWeight:r&&r.uid===j?"bold":void 0},deps:[r,j],children:z}),R.jsxs(Xe,{children:[J[h],h==="stars"&&R.jsxs(R.Fragment,{children:[" ",R.jsx(xr,{icon:Uo,css:{fill:"currentColor"}})]})]})]},j))})]})})};var Ld=t=>t.type==="checkbox",$u=t=>t instanceof Date,cr=t=>t==null;const BD=t=>typeof t=="object";var In=t=>!cr(t)&&!Array.isArray(t)&&BD(t)&&!$u(t),OG=t=>In(t)&&t.target?Ld(t.target)?t.target.checked:t.target.value:t,MG=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,LG=(t,e)=>t.has(MG(e)),VG=t=>{const e=t.constructor&&t.constructor.prototype;return In(e)&&e.hasOwnProperty("isPrototypeOf")},LI=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ds(t){let e;const n=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(LI&&(t instanceof Blob||t instanceof FileList))&&(n||In(t)))if(e=n?[]:{},!n&&!VG(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=ds(t[r]));else return t;return e}var Vd=t=>Array.isArray(t)?t.filter(Boolean):[],ln=t=>t===void 0,Be=(t,e,n)=>{if(!e||!In(t))return n;const r=Vd(e.split(/[,[\].]+?/)).reduce((i,s)=>cr(i)?i:i[s],t);return ln(r)||r===t?ln(t[e])?n:t[e]:r},so=t=>typeof t=="boolean";const Zx={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ei={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},hs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};It.createContext(null);var FG=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const a=s;return e._proxyFormState[a]!==Ei.all&&(e._proxyFormState[a]=!r||Ei.all),n&&(n[a]=!0),t[a]}});return i},Jr=t=>In(t)&&!Object.keys(t).length,BG=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return Jr(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(a=>e[a]===(!r||Ei.all))},J_=t=>Array.isArray(t)?t:[t];function UG(t){const e=It.useRef(t);e.current=t,It.useEffect(()=>{const n=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{n&&n.unsubscribe()}},[t.disabled])}var Xi=t=>typeof t=="string",jG=(t,e,n,r,i)=>Xi(t)?(r&&e.watch.add(t),Be(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),Be(n,s))):(r&&(e.watchAll=!0),n),VI=t=>/^\w*$/.test(t),UD=t=>Vd(t.replace(/["|']|\]/g,"").split(/\.|\[/));function $t(t,e,n){let r=-1;const i=VI(e)?[e]:UD(e),s=i.length,a=s-1;for(;++r<s;){const l=i[r];let h=n;if(r!==a){const g=t[l];h=In(g)||Array.isArray(g)?g:isNaN(+i[r+1])?{}:[]}t[l]=h,t=t[l]}return t}var zG=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},eC=t=>({isOnSubmit:!t||t===Ei.onSubmit,isOnBlur:t===Ei.onBlur,isOnChange:t===Ei.onChange,isOnAll:t===Ei.all,isOnTouch:t===Ei.onTouched}),tC=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const eg=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=Be(t,i);if(s){const{_f:a,...l}=s;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],i)&&!r)break;if(a.ref&&e(a.ref,a.name)&&!r)break}else In(l)&&eg(l,e)}}};var $G=(t,e,n)=>{const r=Vd(Be(t,n));return $t(r,"root",e[n]),$t(t,n,r),t},FI=t=>t.type==="file",co=t=>typeof t=="function",op=t=>{if(!LI)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},tg=t=>Xi(t),BI=t=>t.type==="radio",ap=t=>t instanceof RegExp;const nC={value:!1,isValid:!1},rC={value:!0,isValid:!0};var jD=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ln(t[0].attributes.value)?ln(t[0].value)||t[0].value===""?rC:{value:t[0].value,isValid:!0}:rC:nC}return nC};const iC={isValid:!1,value:null};var zD=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,iC):iC;function sC(t,e,n="validate"){if(tg(t)||Array.isArray(t)&&t.every(tg)||so(t)&&!t)return{type:n,message:tg(t)?t:"",ref:e}}var Eu=t=>In(t)&&!ap(t)?t:{value:t,message:""},oC=async(t,e,n,r,i)=>{const{ref:s,refs:a,required:l,maxLength:h,minLength:g,min:m,max:v,pattern:I,validate:S,name:j,valueAsNumber:z,mount:J,disabled:V}=t._f,B=Be(e,j);if(!J||V)return{};const U=a?a[0]:s,Z=be=>{r&&U.reportValidity&&(U.setCustomValidity(so(be)?"":be||""),U.reportValidity())},ne={},te=BI(s),oe=Ld(s),ce=te||oe,_e=(z||FI(s))&&ln(s.value)&&ln(B)||op(s)&&s.value===""||B===""||Array.isArray(B)&&!B.length,pe=zG.bind(null,j,n,ne),Ye=(be,Me,Se,je=hs.maxLength,he=hs.minLength)=>{const rt=be?Me:Se;ne[j]={type:be?je:he,message:rt,ref:s,...pe(be?je:he,rt)}};if(i?!Array.isArray(B)||!B.length:l&&(!ce&&(_e||cr(B))||so(B)&&!B||oe&&!jD(a).isValid||te&&!zD(a).isValid)){const{value:be,message:Me}=tg(l)?{value:!!l,message:l}:Eu(l);if(be&&(ne[j]={type:hs.required,message:Me,ref:U,...pe(hs.required,Me)},!n))return Z(Me),ne}if(!_e&&(!cr(m)||!cr(v))){let be,Me;const Se=Eu(v),je=Eu(m);if(!cr(B)&&!isNaN(B)){const he=s.valueAsNumber||B&&+B;cr(Se.value)||(be=he>Se.value),cr(je.value)||(Me=he<je.value)}else{const he=s.valueAsDate||new Date(B),rt=De=>new Date(new Date().toDateString()+" "+De),xe=s.type=="time",ye=s.type=="week";Xi(Se.value)&&B&&(be=xe?rt(B)>rt(Se.value):ye?B>Se.value:he>new Date(Se.value)),Xi(je.value)&&B&&(Me=xe?rt(B)<rt(je.value):ye?B<je.value:he<new Date(je.value))}if((be||Me)&&(Ye(!!be,Se.message,je.message,hs.max,hs.min),!n))return Z(ne[j].message),ne}if((h||g)&&!_e&&(Xi(B)||i&&Array.isArray(B))){const be=Eu(h),Me=Eu(g),Se=!cr(be.value)&&B.length>+be.value,je=!cr(Me.value)&&B.length<+Me.value;if((Se||je)&&(Ye(Se,be.message,Me.message),!n))return Z(ne[j].message),ne}if(I&&!_e&&Xi(B)){const{value:be,message:Me}=Eu(I);if(ap(be)&&!B.match(be)&&(ne[j]={type:hs.pattern,message:Me,ref:s,...pe(hs.pattern,Me)},!n))return Z(Me),ne}if(S){if(co(S)){const be=await S(B,e),Me=sC(be,U);if(Me&&(ne[j]={...Me,...pe(hs.validate,Me.message)},!n))return Z(Me.message),ne}else if(In(S)){let be={};for(const Me in S){if(!Jr(be)&&!n)break;const Se=sC(await S[Me](B,e),U,Me);Se&&(be={...Se,...pe(Me,Se.message)},Z(Se.message),n&&(ne[j]=be))}if(!Jr(be)&&(ne[j]={ref:U,...be},!n))return ne}}return Z(!0),ne};function HG(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=ln(t)?r++:t[e[r++]];return t}function qG(t){for(const e in t)if(t.hasOwnProperty(e)&&!ln(t[e]))return!1;return!0}function Mn(t,e){const n=Array.isArray(e)?e:VI(e)?[e]:UD(e),r=n.length===1?t:HG(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(In(r)&&Jr(r)||Array.isArray(r)&&qG(r))&&Mn(t,n.slice(0,-1)),t}function Z_(){let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}}var up=t=>cr(t)||!BD(t);function Sa(t,e){if(up(t)||up(e))return t===e;if($u(t)&&$u(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n){const s=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const a=e[i];if($u(s)&&$u(a)||In(s)&&In(a)||Array.isArray(s)&&Array.isArray(a)?!Sa(s,a):s!==a)return!1}}return!0}var $D=t=>t.type==="select-multiple",GG=t=>BI(t)||Ld(t),ev=t=>op(t)&&t.isConnected,HD=t=>{for(const e in t)if(co(t[e]))return!0;return!1};function lp(t,e={}){const n=Array.isArray(t);if(In(t)||n)for(const r in t)Array.isArray(t[r])||In(t[r])&&!HD(t[r])?(e[r]=Array.isArray(t[r])?[]:{},lp(t[r],e[r])):cr(t[r])||(e[r]=!0);return e}function qD(t,e,n){const r=Array.isArray(t);if(In(t)||r)for(const i in t)Array.isArray(t[i])||In(t[i])&&!HD(t[i])?ln(e)||up(n[i])?n[i]=Array.isArray(t[i])?lp(t[i],[]):{...lp(t[i])}:qD(t[i],cr(e)?{}:e[i],n[i]):n[i]=!Sa(t[i],e[i]);return n}var tv=(t,e)=>qD(t,e,lp(e)),GD=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>ln(t)?t:e?t===""?NaN:t&&+t:n&&Xi(t)?new Date(t):r?r(t):t;function nv(t){const e=t.ref;if(!(t.refs?t.refs.every(n=>n.disabled):e.disabled))return FI(e)?e.files:BI(e)?zD(t.refs).value:$D(e)?[...e.selectedOptions].map(({value:n})=>n):Ld(e)?jD(t.refs).value:GD(ln(e.value)?t.ref.value:e.value,t)}var WG=(t,e,n,r)=>{const i={};for(const s of t){const a=Be(e,s);a&&$t(i,s,a._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},_c=t=>ln(t)?t:ap(t)?t.source:In(t)?ap(t.value)?t.value.source:t.value:t,KG=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function aC(t,e,n){const r=Be(t,n);if(r||VI(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),a=Be(e,s),l=Be(t,s);if(a&&!Array.isArray(a)&&n!==s)return{name:n};if(l&&l.type)return{name:s,error:l};i.pop()}return{name:n}}var QG=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,YG=(t,e)=>!Vd(Be(t,e)).length&&Mn(t,e);const XG={mode:Ei.onSubmit,reValidateMode:Ei.onChange,shouldFocusError:!0};function JG(t={},e){let n={...XG,...t},r={submitCount:0,isDirty:!1,isLoading:co(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{},disabled:!1},i={},s=In(n.defaultValues)||In(n.values)?ds(n.defaultValues||n.values)||{}:{},a=n.shouldUnregister?{}:ds(s),l={action:!1,mount:!1,watch:!1},h={mount:new Set,unMount:new Set,array:new Set,watch:new Set},g,m=0;const v={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},I={values:Z_(),array:Z_(),state:Z_()},S=t.resetOptions&&t.resetOptions.keepDirtyValues,j=eC(n.mode),z=eC(n.reValidateMode),J=n.criteriaMode===Ei.all,V=X=>ae=>{clearTimeout(m),m=setTimeout(X,ae)},B=async X=>{if(v.isValid||X){const ae=n.resolver?Jr((await _e()).errors):await Ye(i,!0);ae!==r.isValid&&I.state.next({isValid:ae})}},U=X=>v.isValidating&&I.state.next({isValidating:X}),Z=(X,ae=[],ge,Ce,Re=!0,de=!0)=>{if(Ce&&ge){if(l.action=!0,de&&Array.isArray(Be(i,X))){const o=ge(Be(i,X),Ce.argA,Ce.argB);Re&&$t(i,X,o)}if(de&&Array.isArray(Be(r.errors,X))){const o=ge(Be(r.errors,X),Ce.argA,Ce.argB);Re&&$t(r.errors,X,o),YG(r.errors,X)}if(v.touchedFields&&de&&Array.isArray(Be(r.touchedFields,X))){const o=ge(Be(r.touchedFields,X),Ce.argA,Ce.argB);Re&&$t(r.touchedFields,X,o)}v.dirtyFields&&(r.dirtyFields=tv(s,a)),I.state.next({name:X,isDirty:Me(X,ae),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else $t(a,X,ae)},ne=(X,ae)=>{$t(r.errors,X,ae),I.state.next({errors:r.errors})},te=(X,ae,ge,Ce)=>{const Re=Be(i,X);if(Re){const de=Be(a,X,ln(ge)?Be(s,X):ge);ln(de)||Ce&&Ce.defaultChecked||ae?$t(a,X,ae?de:nv(Re._f)):he(X,de),l.mount&&B()}},oe=(X,ae,ge,Ce,Re)=>{let de=!1,o=!1;const u={name:X};if(!ge||Ce){v.isDirty&&(o=r.isDirty,r.isDirty=u.isDirty=Me(),de=o!==u.isDirty);const c=Sa(Be(s,X),ae);o=Be(r.dirtyFields,X),c?Mn(r.dirtyFields,X):$t(r.dirtyFields,X,!0),u.dirtyFields=r.dirtyFields,de=de||v.dirtyFields&&o!==!c}if(ge){const c=Be(r.touchedFields,X);c||($t(r.touchedFields,X,ge),u.touchedFields=r.touchedFields,de=de||v.touchedFields&&c!==ge)}return de&&Re&&I.state.next(u),de?u:{}},ce=(X,ae,ge,Ce)=>{const Re=Be(r.errors,X),de=v.isValid&&so(ae)&&r.isValid!==ae;if(t.delayError&&ge?(g=V(()=>ne(X,ge)),g(t.delayError)):(clearTimeout(m),g=null,ge?$t(r.errors,X,ge):Mn(r.errors,X)),(ge?!Sa(Re,ge):Re)||!Jr(Ce)||de){const o={...Ce,...de&&so(ae)?{isValid:ae}:{},errors:r.errors,name:X};r={...r,...o},I.state.next(o)}U(!1)},_e=async X=>n.resolver(a,n.context,WG(X||h.mount,i,n.criteriaMode,n.shouldUseNativeValidation)),pe=async X=>{const{errors:ae}=await _e(X);if(X)for(const ge of X){const Ce=Be(ae,ge);Ce?$t(r.errors,ge,Ce):Mn(r.errors,ge)}else r.errors=ae;return ae},Ye=async(X,ae,ge={valid:!0})=>{for(const Ce in X){const Re=X[Ce];if(Re){const{_f:de,...o}=Re;if(de){const u=h.array.has(de.name),c=await oC(Re,a,J,n.shouldUseNativeValidation&&!ae,u);if(c[de.name]&&(ge.valid=!1,ae))break;!ae&&(Be(c,de.name)?u?$G(r.errors,c,de.name):$t(r.errors,de.name,c[de.name]):Mn(r.errors,de.name))}o&&await Ye(o,ae,ge)}}return ge.valid},be=()=>{for(const X of h.unMount){const ae=Be(i,X);ae&&(ae._f.refs?ae._f.refs.every(ge=>!ev(ge)):!ev(ae._f.ref))&&ir(X)}h.unMount=new Set},Me=(X,ae)=>(X&&ae&&$t(a,X,ae),!Sa(ze(),s)),Se=(X,ae,ge)=>jG(X,h,{...l.mount?a:ln(ae)?s:Xi(X)?{[X]:ae}:ae},ge,ae),je=X=>Vd(Be(l.mount?a:s,X,t.shouldUnregister?Be(s,X,[]):[])),he=(X,ae,ge={})=>{const Ce=Be(i,X);let Re=ae;if(Ce){const de=Ce._f;de&&(!de.disabled&&$t(a,X,GD(ae,de)),Re=op(de.ref)&&cr(ae)?"":ae,$D(de.ref)?[...de.ref.options].forEach(o=>o.selected=Re.includes(o.value)):de.refs?Ld(de.ref)?de.refs.length>1?de.refs.forEach(o=>(!o.defaultChecked||!o.disabled)&&(o.checked=Array.isArray(Re)?!!Re.find(u=>u===o.value):Re===o.value)):de.refs[0]&&(de.refs[0].checked=!!Re):de.refs.forEach(o=>o.checked=o.value===Re):FI(de.ref)?de.ref.value="":(de.ref.value=Re,de.ref.type||I.values.next({name:X,values:{...a}})))}(ge.shouldDirty||ge.shouldTouch)&&oe(X,Re,ge.shouldTouch,ge.shouldDirty,!0),ge.shouldValidate&&it(X)},rt=(X,ae,ge)=>{for(const Ce in ae){const Re=ae[Ce],de=`${X}.${Ce}`,o=Be(i,de);(h.array.has(X)||!up(Re)||o&&!o._f)&&!$u(Re)?rt(de,Re,ge):he(de,Re,ge)}},xe=(X,ae,ge={})=>{const Ce=Be(i,X),Re=h.array.has(X),de=ds(ae);$t(a,X,de),Re?(I.array.next({name:X,values:{...a}}),(v.isDirty||v.dirtyFields)&&ge.shouldDirty&&I.state.next({name:X,dirtyFields:tv(s,a),isDirty:Me(X,de)})):Ce&&!Ce._f&&!cr(de)?rt(X,de,ge):he(X,de,ge),tC(X,h)&&I.state.next({...r}),I.values.next({name:X,values:{...a}}),!l.mount&&e()},ye=async X=>{const ae=X.target;let ge=ae.name,Ce=!0;const Re=Be(i,ge),de=()=>ae.type?nv(Re._f):OG(X),o=u=>{Ce=Number.isNaN(u)||u===Be(a,ge,u)};if(Re){let u,c;const d=de(),f=X.type===Zx.BLUR||X.type===Zx.FOCUS_OUT,p=!KG(Re._f)&&!n.resolver&&!Be(r.errors,ge)&&!Re._f.deps||QG(f,Be(r.touchedFields,ge),r.isSubmitted,z,j),y=tC(ge,h,f);$t(a,ge,d),f?(Re._f.onBlur&&Re._f.onBlur(X),g&&g(0)):Re._f.onChange&&Re._f.onChange(X);const _=oe(ge,d,f,!1),w=!Jr(_)||y;if(!f&&I.values.next({name:ge,type:X.type,values:{...a}}),p)return v.isValid&&B(),w&&I.state.next({name:ge,...y?{}:_});if(!f&&y&&I.state.next({...r}),U(!0),n.resolver){const{errors:E}=await _e([ge]);if(o(d),Ce){const b=aC(r.errors,i,ge),A=aC(E,i,b.name||ge);u=A.error,ge=A.name,c=Jr(E)}}else u=(await oC(Re,a,J,n.shouldUseNativeValidation))[ge],o(d),Ce&&(u?c=!1:v.isValid&&(c=await Ye(i,!0)));Ce&&(Re._f.deps&&it(Re._f.deps),ce(ge,c,u,_))}},De=(X,ae)=>{if(Be(r.errors,ae)&&X.focus)return X.focus(),1},it=async(X,ae={})=>{let ge,Ce;const Re=J_(X);if(U(!0),n.resolver){const de=await pe(ln(X)?X:Re);ge=Jr(de),Ce=X?!Re.some(o=>Be(de,o)):ge}else X?(Ce=(await Promise.all(Re.map(async de=>{const o=Be(i,de);return await Ye(o&&o._f?{[de]:o}:o)}))).every(Boolean),!(!Ce&&!r.isValid)&&B()):Ce=ge=await Ye(i);return I.state.next({...!Xi(X)||v.isValid&&ge!==r.isValid?{}:{name:X},...n.resolver||!X?{isValid:ge}:{},errors:r.errors,isValidating:!1}),ae.shouldFocus&&!Ce&&eg(i,De,X?Re:h.mount),Ce},ze=X=>{const ae={...s,...l.mount?a:{}};return ln(X)?ae:Xi(X)?Be(ae,X):X.map(ge=>Be(ae,ge))},kt=(X,ae)=>({invalid:!!Be((ae||r).errors,X),isDirty:!!Be((ae||r).dirtyFields,X),isTouched:!!Be((ae||r).touchedFields,X),error:Be((ae||r).errors,X)}),ht=X=>{X&&J_(X).forEach(ae=>Mn(r.errors,ae)),I.state.next({errors:X?r.errors:{}})},yt=(X,ae,ge)=>{const Ce=(Be(i,X,{_f:{}})._f||{}).ref;$t(r.errors,X,{...ae,ref:Ce}),I.state.next({name:X,errors:r.errors,isValid:!1}),ge&&ge.shouldFocus&&Ce&&Ce.focus&&Ce.focus()},pn=(X,ae)=>co(X)?I.values.subscribe({next:ge=>X(Se(void 0,ae),ge)}):Se(X,ae,!0),ir=(X,ae={})=>{for(const ge of X?J_(X):h.mount)h.mount.delete(ge),h.array.delete(ge),ae.keepValue||(Mn(i,ge),Mn(a,ge)),!ae.keepError&&Mn(r.errors,ge),!ae.keepDirty&&Mn(r.dirtyFields,ge),!ae.keepTouched&&Mn(r.touchedFields,ge),!n.shouldUnregister&&!ae.keepDefaultValue&&Mn(s,ge);I.values.next({values:{...a}}),I.state.next({...r,...ae.keepDirty?{isDirty:Me()}:{}}),!ae.keepIsValid&&B()},ls=({disabled:X,name:ae,field:ge,fields:Ce,value:Re})=>{if(so(X)){const de=X?void 0:ln(Re)?nv(ge?ge._f:Be(Ce,ae)._f):Re;$t(a,ae,de),oe(ae,de,!1,!1,!0)}},bt=(X,ae={})=>{let ge=Be(i,X);const Ce=so(ae.disabled);return $t(i,X,{...ge||{},_f:{...ge&&ge._f?ge._f:{ref:{name:X}},name:X,mount:!0,...ae}}),h.mount.add(X),ge?ls({field:ge,disabled:ae.disabled,name:X}):te(X,!0,ae.value),{...Ce?{disabled:ae.disabled}:{},...n.progressive?{required:!!ae.required,min:_c(ae.min),max:_c(ae.max),minLength:_c(ae.minLength),maxLength:_c(ae.maxLength),pattern:_c(ae.pattern)}:{},name:X,onChange:ye,onBlur:ye,ref:Re=>{if(Re){bt(X,ae),ge=Be(i,X);const de=ln(Re.value)&&Re.querySelectorAll&&Re.querySelectorAll("input,select,textarea")[0]||Re,o=GG(de),u=ge._f.refs||[];if(o?u.find(c=>c===de):de===ge._f.ref)return;$t(i,X,{_f:{...ge._f,...o?{refs:[...u.filter(ev),de,...Array.isArray(Be(s,X))?[{}]:[]],ref:{type:de.type,name:X}}:{ref:de}}}),te(X,!1,void 0,de)}else ge=Be(i,X,{}),ge._f&&(ge._f.mount=!1),(n.shouldUnregister||ae.shouldUnregister)&&!(LG(h.array,X)&&l.action)&&h.unMount.add(X)}}},zt=()=>n.shouldFocusError&&eg(i,De,h.mount),Nt=X=>{so(X)&&(I.state.next({disabled:X}),eg(i,ae=>{ae.disabled=X},0,!1))},Lr=(X,ae)=>async ge=>{ge&&(ge.preventDefault&&ge.preventDefault(),ge.persist&&ge.persist());let Ce=ds(a);if(I.state.next({isSubmitting:!0}),n.resolver){const{errors:Re,values:de}=await _e();r.errors=Re,Ce=de}else await Ye(i);Mn(r.errors,"root"),Jr(r.errors)?(I.state.next({errors:{}}),await X(Ce,ge)):(ae&&await ae({...r.errors},ge),zt(),setTimeout(zt)),I.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Jr(r.errors),submitCount:r.submitCount+1,errors:r.errors})},Er=(X,ae={})=>{Be(i,X)&&(ln(ae.defaultValue)?xe(X,Be(s,X)):(xe(X,ae.defaultValue),$t(s,X,ae.defaultValue)),ae.keepTouched||Mn(r.touchedFields,X),ae.keepDirty||(Mn(r.dirtyFields,X),r.isDirty=ae.defaultValue?Me(X,Be(s,X)):Me()),ae.keepError||(Mn(r.errors,X),v.isValid&&B()),I.state.next({...r}))},fi=(X,ae={})=>{const ge=X?ds(X):s,Ce=ds(ge),Re=X&&!Jr(X)?Ce:s;if(ae.keepDefaultValues||(s=ge),!ae.keepValues){if(ae.keepDirtyValues||S)for(const de of h.mount)Be(r.dirtyFields,de)?$t(Re,de,Be(a,de)):xe(de,Be(Re,de));else{if(LI&&ln(X))for(const de of h.mount){const o=Be(i,de);if(o&&o._f){const u=Array.isArray(o._f.refs)?o._f.refs[0]:o._f.ref;if(op(u)){const c=u.closest("form");if(c){c.reset();break}}}}i={}}a=t.shouldUnregister?ae.keepDefaultValues?ds(s):{}:ds(Re),I.array.next({values:{...Re}}),I.values.next({values:{...Re}})}h={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!l.mount&&e(),l.mount=!v.isValid||!!ae.keepIsValid,l.watch=!!t.shouldUnregister,I.state.next({submitCount:ae.keepSubmitCount?r.submitCount:0,isDirty:ae.keepDirty?r.isDirty:!!(ae.keepDefaultValues&&!Sa(X,s)),isSubmitted:ae.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:ae.keepDirtyValues?r.dirtyFields:ae.keepDefaultValues&&X?tv(s,X):{},touchedFields:ae.keepTouched?r.touchedFields:{},errors:ae.keepErrors?r.errors:{},isSubmitSuccessful:ae.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Ni=(X,ae)=>fi(co(X)?X(a):X,ae);return{control:{register:bt,unregister:ir,getFieldState:kt,handleSubmit:Lr,setError:yt,_executeSchema:_e,_getWatch:Se,_getDirty:Me,_updateValid:B,_removeUnmounted:be,_updateFieldArray:Z,_updateDisabledField:ls,_getFieldArray:je,_reset:fi,_resetDefaultValues:()=>co(n.defaultValues)&&n.defaultValues().then(X=>{Ni(X,n.resetOptions),I.state.next({isLoading:!1})}),_updateFormState:X=>{r={...r,...X}},_disableForm:Nt,_subjects:I,_proxyFormState:v,get _fields(){return i},get _formValues(){return a},get _state(){return l},set _state(X){l=X},get _defaultValues(){return s},get _names(){return h},set _names(X){h=X},get _formState(){return r},set _formState(X){r=X},get _options(){return n},set _options(X){n={...n,...X}}},trigger:it,register:bt,handleSubmit:Lr,watch:pn,setValue:xe,getValues:ze,reset:Ni,resetField:Er,clearErrors:ht,unregister:ir,setError:yt,setFocus:(X,ae={})=>{const ge=Be(i,X),Ce=ge&&ge._f;if(Ce){const Re=Ce.refs?Ce.refs[0]:Ce.ref;Re.focus&&(Re.focus(),ae.shouldSelect&&Re.select())}},getFieldState:kt}}function cu(t={}){const e=It.useRef(),n=It.useRef(),[r,i]=It.useState({isDirty:!1,isValidating:!1,isLoading:co(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},disabled:!1,defaultValues:co(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...JG(t,()=>i(a=>({...a}))),formState:r});const s=e.current.control;return s._options=t,UG({subject:s._subjects.state,next:a=>{BG(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),It.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),It.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==r.isDirty&&s._subjects.state.next({isDirty:a})}},[s,r.isDirty]),It.useEffect(()=>{t.values&&!Sa(t.values,n.current)?(s._reset(t.values,s._options.resetOptions),n.current=t.values):s._resetDefaultValues()},[t.values,s]),It.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=FG(r,s),e.current}const ZG=({setTab:t})=>{const e=en(),n=G.useContext(hi),{handleSubmit:r,register:i,setError:s,formState:a}=cu(),l=G.useCallback(async({email:h})=>{try{await Ot.auth().sendPasswordResetEmail(h),t("signin"),n(e.formatMessage({id:"Reset password email sent"}))}catch(g){switch(g.code){case"auth/invalid-email":case"auth/user-not-found":case"auth/user-disabled":s("email",{type:"invalid",message:e.formatMessage({id:"Unknown email address"})});break;default:n(e.formatMessage({id:"An error occured, please retry later"},{email:h}))}}},[s,e,n,t]);return R.jsxs(fe,{as:"form",name:"reset",onSubmit:r(l),css:{gap:4},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:e.formatMessage({id:"Email address"})}),R.jsx(fn,{type:"email",...i("email",{required:e.formatMessage({id:"Email address is required"})})}),a.errors.email&&R.jsx(kr,{children:a.errors.email.message})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(dr,{type:"submit",disabled:a.isSubmitting,children:e.formatMessage({id:"Send the reset mail!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:()=>t("signin"),children:e.formatMessage({id:"Back"})})})]})]})},eW=({onSignUp:t,setTab:e})=>{const n=en(),{handleSubmit:r,register:i,watch:s,setError:a,formState:l}=cu(),h=s("password"),g=G.useCallback(async({email:m,username:v,password:I})=>{try{const{user:S}=await Ot.auth().createUserWithEmailAndPassword(m,I),j={username:v,signupDate:Date.now()};await Ot.firestore().collection("users").doc(S.uid).set(j),t({uid:S.uid,...j,firebaseUser:S})}catch(S){switch(S.code){case"auth/weak-password":a("password",{type:"weakPassword",message:n.formatMessage({id:"Password is too weak"})});break;case"auth/email-already-in-use":a("email",{type:"alreadyExists",message:n.formatMessage({id:"Email address already in use"})});break;case"auth/invalid-email":a("email",{type:"invalid",message:n.formatMessage({id:"Invalid email address"})});break;default:return}}},[t,a,n]);return R.jsxs(fe,{as:"form",name:"signup",autoComplete:"off",onSubmit:r(g),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Username"})}),R.jsx(fn,{...i("username",{required:n.formatMessage({id:"Username is required"})})}),l.errors.username&&R.jsx(kr,{children:l.errors.username.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Email address"})}),R.jsx(fn,{type:"email",...i("email",{required:n.formatMessage({id:"Email address is required"})})}),l.errors.email&&R.jsx(kr,{children:l.errors.email.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(fn,{autoComplete:"new-password",type:"password",...i("password",{required:n.formatMessage({id:"Password is required"})})}),l.errors.password&&R.jsx(kr,{children:l.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Confirm password"})}),R.jsx(fn,{autoComplete:"off",type:"password",...i("passwordConfirm",{required:"Password is required",validate:m=>m===h||n.formatMessage({id:"Passwords must match"})})}),l.errors.passwordConfirm&&R.jsx(kr,{children:l.errors.passwordConfirm.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(dr,{disabled:l.isSubmitting,type:"submit",children:n.formatMessage({id:"Sign me up!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:()=>e("signin"),children:n.formatMessage({id:"I already have an account"})})})]})]})},tW=({onSignIn:t,setTab:e})=>{const n=en(),{handleSubmit:r,register:i,setError:s,formState:a}=cu(),l=G.useCallback(async({email:h,password:g})=>{try{const{user:m}=await Ot.auth().signInWithEmailAndPassword(h,g),I=(await Ot.firestore().collection("users").doc(m.uid).get()).data();t({uid:m.uid,...I,firebaseUser:m})}catch(m){switch(m.code){case"auth/invalid-email":case"auth/user-not-found":case"auth/user-disabled":s("email",{type:"invalid",message:n.formatMessage({id:"Unknown email address"})});break;case"auth/wrong-password":s("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:return}}},[t,s,n]);return R.jsxs(fe,{as:"form",name:"signin",onSubmit:r(l),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Email address"})}),R.jsx(fn,{type:"email",...i("email",{required:n.formatMessage({id:"Email address is required"})})}),a.errors.email&&R.jsx(kr,{children:a.errors.email.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(fn,{type:"password",...i("password",{required:n.formatMessage({id:"Password is required"})})}),a.errors.password&&R.jsx(kr,{children:a.errors.password.message}),R.jsx(Ci,{css:{alignSelf:"flex-end",fontSize:2},onClick:()=>e("reset"),children:n.formatMessage({id:"Forgot password?"})})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(dr,{type:"submit",disabled:a.isSubmitting,children:n.formatMessage({id:"Sign me in!"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:()=>e("signup"),children:n.formatMessage({id:"I don't have an account"})})})]})]})},nW=({deferred:t})=>{const e=en(),n=G.useContext(hi),[r,i]=G.useState("signup"),s=a=>{t.resolve(a),n(e.formatMessage({id:"Logged in as {username}"},{username:a.username}))};return R.jsx(us,{title:r==="signup"?R.jsx(qr,{children:e.formatMessage({id:"Create your account"})}):r==="signin"?R.jsx(qr,{children:e.formatMessage({id:"Connect to your account"})}):R.jsx(qr,{children:e.formatMessage({id:"Reset your password"})}),onClose:()=>t.reject(cn),children:r==="signup"?R.jsx(eW,{onSignUp:s,setTab:i}):r==="signin"?R.jsx(tW,{onSignIn:s,setTab:i}):R.jsx(ZG,{setTab:i})})},rW={Amstangram:"Amstangram",Language:"Language",en:"English",fr:"French",Theme:"Theme","Logged in as {username}":"Logged in as {username}",Settings:"Settings",Difficulty:"Difficulty",Easy:"Easy",Hard:"Hard","Tangram approved":"Tangram approved","You can't save an invalid tangram":"You can't save an invalid tangram","You can't save such an easy tangram":"You can't save such an easy tangram","Tangram submitted for review":"Tangram submitted for review","Logged out":"Logged out","Tangram gallery":"Tangram gallery","All tangrams":"All tangrams","Uncompleted tangrams":"Uncompleted tangrams"," Starred tangrams":" Starred tangrams","Pending approbation tangrams":"Pending approbation tangrams","You've completed all tangrams":"You've completed all tangrams","Come back later for more or create your own tangrams":"Come back later for more or create your own tangrams","No tangram left to approve":"No tangram left to approve","Good job moderator {username}!":"Good job moderator {username}!","All your tangrams have been approved":"All your tangrams have been approved","Create more tangrams and earn <starIcon></starIcon>":"Create more tangrams and earn <starIcon></starIcon>","No starred tangrams yet":"No starred tangrams yet","Press <starIcon></starIcon> to star a tangram and show your love":"Press <starIcon></starIcon> to star a tangram and show your love","Nothing to see here":"Nothing to see here","Something might have gone wrong":"Something might have gone wrong","Play now!":"Play now !","Start 1 tangram!":"Start 1 tangram !","Start {count} tangrams!":"Start {count} tangrams !","Password is too weak":"Password is too weak","Email address already in use":"Email address already in use","Invalid email address":"Invalid email address","Email address":"Email address","Email address is required":"Email address is required",Username:"Username","Username is required":"Username is required",Password:"Password","Password is required":"Password is required","Confirm password":"Confirm password","Passwords must match":"Passwords must match","Sign me up!":"Sign me up!","I already have an account":"I already have an account","Unknown email address":"Unknown email address","Incorrect password":"Incorrect password","Sign me in!":"Sign me in!","I don't have an account":"I don't have an account","Create your account":"Create your account","Connect to your account":"Connect to your account","A moderator will have to approve your tangram. It can be deleted or edited at any time.":"A moderator will have to approve your tangram.<br></br>It can be deleted or edited at any time.","Submit your tangram":"Submit your tangram","Edit your tangram":"Edit your tangram",Path:"Path","Invalid path":"Invalid path",Category:"Category","Victory emoji":"Victory emoji","Leave empty for random emoji":"Leave empty for random emoji",Order:"Order","Submit!":"Submit!","Edit!":"Edit!","Or delete tangram":"Or delete tangram",animals:"Animals",geometric:"Geometric",digits:"Digits",letters:"Alphabet",people:"People",stuff:"Stuff","Joined {signupDate}":"Joined {signupDate}","Log out":"Log out","Are you sure you want to log out?":"Are you sure you want to log out?","Change email address":"Change email address","Change username":"Change username","Change password":"Change password",Back:"Back","Confirm new password":"Confirm new password","New password":"New password","Current password":"Current password","Password changed successfuly":"Password changed successfuly","New username":"New username","Username updated successfuly":"Username updated successfuly","Email address updated successfuly":"Email address updated successfuly","New email address":"New email address","An error occured, please retry later":"An error occured, please retry later",Sounds:"Sounds","Are you sure you want to delete this tangram?":"Are you sure you want to delete this tangram?","Tangram deleted successfuly":"Tangram deleted successfuly","Tangram modified successfuly":"Tangram modified successfuly","Challenge link copied to clipboard":"Challenge link copied to clipboard","{username} challenged you":"{username} challenged you","Rise to the challenge":"Rise to the challenge","Let's go!":"Let's go!",Leaderboard:"Leaderboard","Completed {completed}/{total} tangrams":"Completed {completed}/{total} tangrams","Created {created} tangrams":"Created {created} tangrams","Earned {stars}":"Earned {stars} <starIcon></starIcon>","Stars earned":"Stars earned","Completed tangrams":"Completed tangrams","Created tangrams":"Created tangrams","Random tip":"Random tip","Got it!":"Got it!","Welcome to Amstangram":"Welcome to Amstangram","tips.welcome":"Reproduce the black shape by moving the pieces, you can rotate a piece by pressing it.<br></br><br></br>Have fun !","tips.menu":"You can access the tangram gallery {galleryIcon}, settings {settingsIcon} and more by pressing {menuIcon}","tips.account1":"You can create an account by pressing {accountIcon} in the menu {menuIcon}","tips.account2":"Signup in order to save your progression and create your very own tangrams","tips.gallery":"You can create your own tangram playlist by selecting tangrams in the gallery {galleryIcon}","tips.share":"You can share playlist with your friends by pressing {shareIcon} in the gallery {galleryIcon}","tips.create":"You can create your own tangrams by pressing {createIcon} in the menu {menuIcon}","tips.stars":"Did you liked this tangram?<br></br>Give a star to its creator by pressing {starIcon}","tips.difficulty":"Having it too easy?<br></br>You can change difficulty by pressing {settingsIcon} in the menu {menuIcon}","tips.theme":"Too bright for your eyes?<br></br>You can toggle dark mode by pressing {settingsIcon} in the menu {menuIcon}","tips.sound":"Too much noise?<br></br>You can disable sounds by pressing {settingsIcon} in the menu {menuIcon}","tips.card":"You can acces tangram details or edit your own tangrams by long pressing a card in the gallery {galleryIcon}","tips.leaderboard":"Check the leaderboard to see who's the best by pressing {leaderboardIcon} in the menu {menuIcon}","tips.particles":"Disable particle effects by pressing {settingsIcon} in the menu {menuIcon}. It can improve performances.","I don't want to see tips anymore":"I don't want to see tips anymore","Show tips":"Show tips","Show particles":"Show particles",Yes:"Yes",No:"No","Reset tips":"Reset tips","Tips reseted successfuly":"Tips reseted successfuly","Loading...":"Loading...",Approve:"Approve",Next:"Next",Quit:"Quit","See my profile":"See my profile","Log in":"Log in","Save tangram":"Save tangram","Contact ":"Contact ","A word about Amstangram":"A word about Amstangram","Version {code}":"Version {code}","Forgot password?":"Forgot password?","Reset your password":"Reset your password","Send the reset mail!":"Send the reset mail!","Reset password email sent":"Reset password email sent"},iW={Amstangram:"Amstangram",Language:"Langage",en:"Anglais",fr:"Francais",Theme:"Thme","Logged in as {username}":"Connect en tant que {username}",Settings:"Rglages",Difficulty:"Difficult",Easy:"Facile",Hard:"Difficile","Tangram approved":"Tangram approuv","You can't save an invalid tangram":"Tangram invalide","You can't save such an easy tangram":"Tangram trop facile","Tangram submitted for review":"Tangram soumis pour vrification","Logged out":"Dconnect.e","Tangram gallery":"Galerie des tangrams","All tangrams":"Tous les tangrams","Uncompleted tangrams":"Tangrams non complts"," Starred tangrams":"Tangrams toils ","Pending approbation tangrams":"Tangrams en attente d'approbation","You've completed all tangrams":"Tu as complt tous les tangrams","Come back later for more or create your own tangrams":"Reviens plus tard ou crs tes propres tangrams","No tangram left to approve":"Il ne reste plus de tangram  approuver","Good job moderator {username}!":"Bon boulot modrateur {username} !","All your tangrams have been approved":"Tous tes tangrams ont t approuvs","Create more tangrams and earn <starIcon></starIcon>":"Crs d'autres tangrams et gagne des <starIcon></starIcon>","No starred tangrams yet":"Tu n'as pas encore donn d'toile","Press <starIcon></starIcon> to star a tangram and show your love":"Appuie sur <starIcon></starIcon> pour donner une toile et montrer que tu aimes un tangram","Nothing to see here":"Rien  voir","Something might have gone wrong":"Il semble y avoir un problme","Play now!":"Commencer  jouer !","Start 1 tangram!":"Lancer 1 tangram","Start {count} tangrams!":"Lancer {count} tangrams","Password is too weak":"Mot de passe trop faible","Email address already in use":"Adresse email dj prise","Invalid email address":"Adresse email invalide","Email address":"Adresse Email","Email address is required":"Adresse email requise",Username:"Nom d'utilisateur","Username is required":"Nom d'utilisateur requis",Password:"Mot de passe","Password is required":"Mot de passe requis","Confirm password":"Confirmer le mot de passe","Passwords must match":"Les mots de passe doivent correspondre","Sign me up!":"Je cr mon compte !","I already have an account":"J'ai dj un compte","Unknown email address":"Adresse email inconnu","Incorrect password":"Mot de passe incorrect","Sign me in!":"Je me connecte !","I don't have an account":"Je n'ai pas de compte","Create your account":"Crer un compte","Connect to your account":"Se connecter","Submit your tangram":"Envoyer votre tangram","Edit your tangram":"diter votre tangram",Category:"Catgorie",Path:"Chemin","Invalid path":"Chemin invalide","Victory emoji":"Emoji de succs","Leave empty for random emoji":"Laisser vide pour un emoji au hasard",Order:"Ordre","A moderator will have to approve your tangram. It can be deleted or edited at any time.":"Un modrateur doit approuver votre tangram.<br></br>Il peut tre supprim ou modifi n'importe quand.","Submit!":"Envoyer !","Edit!":"diter !","Or delete tangram":"Ou supprimer le tangram",animals:"Animaux",geometric:"Gomtrique",digits:"Chiffres",letters:"Alphabet",people:"Personnes",stuff:"Trucs","Joined {signupDate}":"Inscrit le {signupDate}","Log out":"Se dconnecter","Are you sure you want to log out?":"Es-tu sr.e de vouloir te dconnecter ?","Change email address":"Modifier l'adresse email","Change username":"Modifier le nom d'utilisateur","Change password":"Modifier le mot de passe",Back:"Retour","Confirm new password":"Confirmer le nouveau mot de passe","New password":"Nouveau mot de passe","Current password":"Mot de passe actuel","Password changed successfuly":"Mot de passe chang avec succs","New username":"Nouveau nom d'utilisateur","Username updated successfuly":"Nom d'utilisateur chang avec succs","Email address updated successfuly":"Adresse email chang avec succs","New email address":"Nouvelle adresse email","An error occured, please retry later":"Une erreur est survenue, veuillez ressayer plus tard",Sounds:"Sons","Are you sure you want to delete this tangram?":"Es-tu sr.e de vouloir supprimer ce tangram ?","Tangram deleted successfuly":"Tangram supprim avec succs","Tangram modified successfuly":"Tangram modifi avec succs","Challenge link copied to clipboard":"Lien de dfi copi dans le presse papier","{username} challenged you":"{username} te met au dfi","Rise to the challenge":"Relevez le dfi","Let's go!":"C'est parti !",Leaderboard:"Classement","Completed {completed}/{total} tangrams":"{completed}/{total} tangrams complts","Created {created} tangrams":"{created} tangrams crs","Earned {stars}":"{stars} <starIcon></starIcon> gagnes","Stars earned":"toiles gagnes","Completed tangrams":"Tangrams complts","Created tangrams":"Tangrams crs","Random tip":"Astuce","Got it!":"J'ai compris !","Welcome to Amstangram":"Bienvenue sur Amstangram","tips.welcome":"Reproduis la forme noire en dplaant les pices, tu peux faire tourner une pice en appuyant dessus.<br></br><br></br>Amuse-toi bien !","tips.menu":"Tu peux accder  la galerie des tangrams {galleryIcon}, aux rglages {settingsIcon} et plus encore en appuyant sur {menuIcon}","tips.account1":"Crer ton compte utilisateur en appuyant sur {accountIcon} dans le menu {menuIcon}","tips.account2":"Crer ton compte utilisateur pour sauvegarder ta progression crer tes propres tangrams","tips.gallery":"Tu peux crer ta propre playlist en slectionnant les tangrams dans la galerie {galleryIcon}","tips.share":"Tu peux partager ta playlist avec tes amis en appuyant sur {shareIcon} dans la galerie {galleryIcon}","tips.create":"Tu peux crer tes propres tangrams en appuyant sur {createIcon} dans le menu {menuIcon}","tips.stars":"T'as aim ce tangram ?<br></br>Envoie une toile  son crateur en appuyant sur {starIcon}","tips.difficulty":"Trop facile pour toi ?<br></br>Essayes le mode difficile en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.theme":"Envie de passer du ct obscur ?<br></br>Tu peux activer le mode sombre en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.sound":"Trop de bruits ?<br></br>Tu peux dsactiver les sons en appuyant sur {settingsIcon} dans le menu {menuIcon}","tips.card":"Tu peux accder aux dtails d'un tangram ou mme diter les tiens en faisant un appui long sur une carte dans la galerie {galleryIcon}","tips.leaderboard":"Jette un oeil au classement pour savoir qui est le meilleur en appuyant sur {leaderboardIcon} dans le menu {menuIcon}","tips.particles":"Dsactive les effets de particule en appuyant sur {settingsIcon} dans le menu {menuIcon}. Cela peut amliorer les performances.","I don't want to see tips anymore":"Je ne veux plus voir les astuces","Show tips":"Afficher les astuces","Show particles":"Afficher les particles",Yes:"Oui",No:"Non","Reset tips":"Rinitialiser les astuces","Tips reseted successfuly":"Astuces rinitilises avec succs","Loading...":"Chargement...",Approve:"Approuver",Next:"Suivant",Quit:"Quitter","See my profile":"Voir mon profil","Log in":"Se connecter","Save tangram":"Sauvegarder le tangram","Contact ":"Contact ","A word about Amstangram":"Quelques mots  propos d'Amstangram","Version {code}":"Version {code}","Forgot password?":"Mot de passe oubli ?","Reset your password":"Rinitialiser le mot de passe","Send the reset mail!":"Envoyer le mail de rinitialisation","Reset password email sent":"Email de rinitialisation envoy"},sW={en:rW,fr:iW},UI="fr",x0=["en","fr"],jI=G.createContext({language:UI,setLanguage:()=>{}}),oW=()=>{const t=localStorage.getItem("language");if(x0.includes(t))return t;const e=navigator.languages;for(const n of e){const r=x0.find(i=>n.includes(i));if(r)return r}return UI},aW=({children:t})=>{const[e,n]=G.useState(UI);G.useEffect(()=>{const i=oW();n(i)},[]);const r=G.useMemo(()=>({language:e,setLanguage:i=>{n(i),localStorage.setItem("language",i)}}),[e]);return R.jsx(H3,{locale:e,messages:sW[e],onError:console.warn,children:R.jsx(jI.Provider,{value:r,children:t})})},uW=({currentUser:t,onClose:e})=>{const n=en(),{updateEmail:r}=G.useContext(Gn),i=G.useContext(hi),{handleSubmit:s,register:a,setError:l,formState:h}=cu(),g=G.useCallback(async({password:m,newEmail:v})=>{try{await r(t,m,v),i(n.formatMessage({id:"Email address updated successfuly"})),e()}catch(I){switch(I.code){case"auth/email-already-in-use":l("newEmail",{type:"alreadyExists",message:n.formatMessage({id:"Email address already in use"})});break;case"auth/invalid-email":l("newEmail",{type:"invalid",message:n.formatMessage({id:"Invalid email address"})});break;case"auth/wrong-password":l("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:throw i(n.formatMessage({id:"An error occured, please retry later"})),I}}},[t,r,l,e,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(g),css:{flex:"1",gap:4},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Password"})}),R.jsx(fn,{type:"password",...a("password",{required:n.formatMessage({id:"Password is required"})})}),h.errors.password&&R.jsx(kr,{children:h.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New email address"})}),R.jsx(fn,{type:"email",...a("newEmail",{required:n.formatMessage({id:"Email address is required"})})}),h.errors.newEmail&&R.jsx(kr,{children:h.errors.newEmail.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(dr,{disabled:h.isSubmitting,type:"submit",children:n.formatMessage({id:"Change email address"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},lW=({currentUser:t,onClose:e})=>{const n=en(),{updateUsername:r}=G.useContext(Gn),i=G.useContext(hi),{handleSubmit:s,register:a,formState:l}=cu(),h=G.useCallback(async({newUsername:g})=>{try{await r(t,g),i(n.formatMessage({id:"Username updated successfuly"})),e()}catch(m){throw i(n.formatMessage({id:"An error occured, please retry later"})),m}},[t,r,e,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(h),css:{flex:"1",gap:4},children:[R.jsx(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New username"})}),R.jsx(fn,{type:"text",...a("newUsername",{required:n.formatMessage({id:"Username is required"})})}),l.errors.newUsername&&R.jsx(kr,{children:l.errors.newUsername.message})]})}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(dr,{disabled:l.isSubmitting,type:"submit",children:n.formatMessage({id:"Change username"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},cW=({currentUser:t,onClose:e})=>{const n=en(),{updateUsername:r}=G.useContext(Gn),i=G.useContext(hi),{handleSubmit:s,register:a,watch:l,setError:h,formState:g}=cu(),m=l("newPassword"),v=G.useCallback(async({password:I,newPassword:S})=>{try{await r(t,I,S),i(n.formatMessage({id:"Password changed successfuly"})),e()}catch(j){switch(j.code){case"auth/weak-password":h("newPassword",{type:"weakPassword",message:n.formatMessage({id:"Password is too weak"})});break;case"auth/wrong-password":h("password",{type:"mismatch",message:n.formatMessage({id:"Incorrect password"})});break;default:i(n.formatMessage({id:"An error occured, please retry later"}));return}}},[t,r,e,h,i,n]);return R.jsxs(fe,{as:"form",onSubmit:s(v),css:{flex:"1",gap:4},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Current password"})}),R.jsx(fn,{type:"password",...a("password",{required:n.formatMessage({id:"Password is required"})})}),g.errors.password&&R.jsx(kr,{children:g.errors.password.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"New password"})}),R.jsx(fn,{type:"password",autoComplete:"new-password",...a("newPassword",{required:n.formatMessage({id:"Password is required"})})}),g.errors.newPassword&&R.jsx(kr,{children:g.errors.newPassword.message})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Confirm new password"})}),R.jsx(fn,{type:"password",...a("newPasswordConfirm",{required:"Password is required",validate:I=>I===m||n.formatMessage({id:"Passwords must match"})})}),g.errors.newPasswordConfirm&&R.jsx(kr,{children:g.errors.newPasswordConfirm.message})]})]}),R.jsxs(fe,{css:{gap:3},children:[R.jsx(dr,{disabled:g.isSubmitting,type:"submit",children:n.formatMessage({id:"Change password"})}),R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:e,children:n.formatMessage({id:"Back"})})})]})]})},hW=({uid:t,deferred:e})=>{const n=en(),r=G.useContext(hi),{language:i}=G.useContext(jI),{currentUser:s,usersMetadata:a}=G.useContext(Gn),{username:l,signupDate:h}=a[t],[g,m]=G.useState(!1),[v,I]=G.useState(!1),[S,j]=G.useState(!1),{approvedTangrams:z}=G.useContext(Zo),{tangramsStarredBy:J,tangramsCompletedBy:V}=G.useContext(Mr),{stars:B,completed:U,created:Z}=G.useMemo(()=>{let te=0,oe=0,ce=0;for(const _e of z){if(_e.uid===t){oe++;for(const pe in J[_e.id])pe!==t&&J[_e.id][pe]&&(te+=1)}for(const pe in V[_e.id])pe===t&&(ce+=1)}return{stars:te,completed:ce,created:oe}},[z,V,J,t]),ne=async()=>{window.confirm(n.formatMessage({id:"Are you sure you want to log out?"}))&&(await Ot.auth().signOut(),e.reject(cn),r(n.formatMessage({id:"Logged out"})))};return R.jsx(us,{onClose:()=>e.reject(cn),css:{overflow:"auto",pt:4,mt:-4,gap:3},children:g?R.jsx(uW,{currentUser:s,onClose:()=>m(!1)}):v?R.jsx(lW,{currentUser:s,onClose:()=>I(!1)}):S?R.jsx(cW,{currentUser:s,onClose:()=>j(!1)}):R.jsxs(fe,{css:{gap:4,mt:-4},children:[R.jsxs(fe,{css:{gap:3,alignItems:"center"},children:[R.jsx(Km,{uid:t,size:"badgeBig"}),R.jsx(qr,{children:l}),R.jsxs(fe,{css:{gap:2,fontSize:2,alignItems:"center"},children:[s&&t===s.uid&&R.jsx(Xe,{children:s.firebaseUser.email}),R.jsx(Xe,{children:n.formatMessage({id:"Joined {signupDate}"},{signupDate:new Intl.DateTimeFormat(i).format(h)})}),R.jsx(Xe,{children:n.formatMessage({id:"Completed {completed}/{total} tangrams"},{completed:U,total:z.length})}),R.jsx(Xe,{children:n.formatMessage({id:"Created {created} tangrams"},{created:Z})}),R.jsx(Xe,{children:R.jsx(Et,{id:"Earned {stars}",values:{stars:B,starIcon:()=>R.jsx(xr,{icon:Uo,css:{fill:"currentColor"}})}})})]})]}),s&&s.uid===t&&R.jsxs(R.Fragment,{children:[R.jsxs(fe,{css:{gap:3,alignItems:"center"},children:[R.jsx(Ci,{onClick:()=>m(!0),children:n.formatMessage({id:"Change email address"})}),R.jsx(Ci,{onClick:()=>I(!0),children:n.formatMessage({id:"Change username"})}),R.jsx(Ci,{onClick:()=>j(!0),children:n.formatMessage({id:"Change password"})})]}),R.jsx(TG,{onClick:ne,children:n.formatMessage({id:"Log out"})})]})]})})},uC=["","","","","","","","","",""],lC=()=>uC[Math.floor(Math.random()*uC.length)];var WD={exports:{}};const dW={},fW=Object.freeze(Object.defineProperty({__proto__:null,default:dW},Symbol.toStringTag,{value:"Module"})),cC=tO(fW);/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */(function(t){(function(e,n){e=e||cC;var r=e.window,i=e.document,s=new function(){var o=/^(statics|enumerable|beans|preserve)$/,u=[],c=u.slice,d=Object.create,f=Object.getOwnPropertyDescriptor,p=Object.defineProperty,y=u.forEach||function(C,T){for(var k=0,M=this.length;k<M;k++)C.call(T,this[k],k,this)},_=function(C,T){for(var k in this)this.hasOwnProperty(k)&&C.call(T,this[k],k,this)},w=Object.assign||function(C){for(var T=1,k=arguments.length;T<k;T++){var M=arguments[T];for(var F in M)M.hasOwnProperty(F)&&(C[F]=M[F])}return C},E=function(C,T,k){if(C){var M=f(C,"length");(M&&typeof M.value=="number"?y:_).call(C,T,k=k||C)}return k};function b(C,T,k,M,F){var N={};function D($,H){H=H||(H=f(T,$))&&(H.get?H:H.value),typeof H=="string"&&H[0]==="#"&&(H=C[H.substring(1)]||H);var q=typeof H=="function",W=H,Q=F||q&&!H.base?H&&H.get?$ in C:C[$]:null,K;(!F||!Q)&&(q&&Q&&(H.base=Q),q&&M!==!1&&(K=$.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(N[K[3].toLowerCase()+K[4]]=K[2]),(!W||q||!W.get||typeof W.get!="function"||!A.isPlainObject(W))&&(W={value:W,writable:!0}),(f(C,$)||{configurable:!0}).configurable&&(W.configurable=!0,W.enumerable=k??!K),p(C,$,W))}if(T){for(var x in T)T.hasOwnProperty(x)&&!o.test(x)&&D(x);for(var x in N){var P=N[x],O=C["set"+P],L=C["get"+P]||O&&C["is"+P];L&&(M===!0||L.length===0)&&D(x,{get:L,set:O})}}return C}function A(){for(var C=0,T=arguments.length;C<T;C++){var k=arguments[C];k&&w(this,k)}return this}return b(A,{inject:function(C){if(C){var T=C.statics===!0?C:C.statics,k=C.beans,M=C.preserve;T!==C&&b(this.prototype,C,C.enumerable,k,M),b(this,T,null,k,M)}for(var F=1,N=arguments.length;F<N;F++)this.inject(arguments[F]);return this},extend:function(){for(var C=this,T,k,M=0,F,N=arguments.length;M<N&&!(T&&k);M++)F=arguments[M],T=T||F.initialize,k=k||F.prototype;return T=T||function(){C.apply(this,arguments)},k=T.prototype=k||d(this.prototype),p(k,"constructor",{value:T,writable:!0,configurable:!0}),b(T,this),arguments.length&&this.inject.apply(T,arguments),T.base=C,T}}).inject({enumerable:!1,initialize:A,set:A,inject:function(){for(var C=0,T=arguments.length;C<T;C++){var k=arguments[C];k&&b(this,k,k.enumerable,k.beans,k.preserve)}return this},extend:function(){var C=d(this);return C.inject.apply(C,arguments)},each:function(C,T){return E(this,C,T)},clone:function(){return new this.constructor(this)},statics:{set:w,each:E,create:d,define:p,describe:f,clone:function(C){return w(new C.constructor,C)},isPlainObject:function(C){var T=C!=null&&C.constructor;return T&&(T===Object||T===A||T.name==="Object")},pick:function(C,T){return C!==n?C:T},slice:function(C,T,k){return c.call(C,T,k)}}})};t.exports=s,s.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+s.each(this,function(o,u){if(!/^_/.test(u)){var c=typeof o;this.push(u+": "+(c==="number"?m.instance.number(o):c==="string"?"'"+o+"'":o))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(o){return s.importJSON(o,this)},exportJSON:function(o){return s.exportJSON(this,o)},toJSON:function(){return s.serialize(this)},set:function(o,u){return o&&s.filter(this,o,u,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function o(){var u=o.base.apply(this,arguments),c=u.prototype._class;return c&&!s.exports[c]&&(s.exports[c]=u),u},equals:function(o,u){if(o===u)return!0;if(o&&o.equals)return o.equals(u);if(u&&u.equals)return u.equals(o);if(o&&u&&typeof o=="object"&&typeof u=="object"){if(Array.isArray(o)&&Array.isArray(u)){var c=o.length;if(c!==u.length)return!1;for(;c--;)if(!s.equals(o[c],u[c]))return!1}else{var d=Object.keys(o),c=d.length;if(c!==Object.keys(u).length)return!1;for(;c--;){var f=d[c];if(!(u.hasOwnProperty(f)&&s.equals(o[f],u[f])))return!1}}return!0}return!1},read:function(o,u,c,d){if(this===s){var f=this.peek(o,u);return o.__index++,f}var p=this.prototype,y=p._readIndex,_=u||y&&o.__index||0,w=o.length,E=o[_];if(d=d||w-_,E instanceof this||c&&c.readNull&&E==null&&d<=1)return y&&(o.__index=_+1),E&&c&&c.clone?E.clone():E;if(E=s.create(p),y&&(E.__read=!0),E=E.initialize.apply(E,_>0||_+d<w?s.slice(o,_,_+d):o)||E,y){o.__index=_+E.__read;var b=E.__filtered;b&&(o.__filtered=b,E.__filtered=n),E.__read=n}return E},peek:function(o,u){return o[o.__index=u||o.__index||0]},remain:function(o){return o.length-(o.__index||0)},readList:function(o,u,c,d){for(var f=[],p,y=u||0,_=d?y+d:o.length,w=y;w<_;w++)f.push(Array.isArray(p=o[w])?this.read(p,0,c):this.read(o,w,c,1));return f},readNamed:function(o,u,c,d,f){var p=this.getNamed(o,u),y=p!==n;if(y){var _=o.__filtered;if(!_){var w=this.getSource(o);_=o.__filtered=s.create(w),_.__unfiltered=w}_[u]=n}return this.read(y?[p]:o,c,d,f)},readSupported:function(o,u){var c=this.getSource(o),d=this,f=!1;return c&&Object.keys(c).forEach(function(p){if(p in u){var y=d.readNamed(o,p);y!==n&&(u[p]=y),f=!0}}),f},getSource:function(o){var u=o.__source;if(u===n){var c=o.length===1&&o[0];u=o.__source=c&&s.isPlainObject(c)?c:null}return u},getNamed:function(o,u){var c=this.getSource(o);if(c)return u?c[u]:o.__filtered||c},hasNamed:function(o,u){return!!this.getNamed(o,u)},filter:function(o,u,c,d){var f;function p(b){if(!(c&&b in c)&&!(f&&b in f)){var A=u[b];A!==n&&(o[b]=A)}}if(d){for(var y={},_=0,w,E=d.length;_<E;_++)(w=d[_])in u&&(p(w),y[w]=!0);f=y}return Object.keys(u.__unfiltered||u).forEach(p),o},isPlainValue:function(o,u){return s.isPlainObject(o)||Array.isArray(o)||u&&typeof o=="string"},serialize:function(o,u,c,d){u=u||{};var f=!d,p;if(f&&(u.formatter=new m(u.precision),d={length:0,definitions:{},references:{},add:function(A,C){var T="#"+A._id,k=this.references[T];if(!k){this.length++;var M=C.call(A),F=A._class;F&&M[0]!==F&&M.unshift(F),this.definitions[T]=M,k=this.references[T]=[T]}return k}}),o&&o._serialize){p=o._serialize(u,d);var y=o._class;y&&!o._compactSerialize&&(f||!c)&&p[0]!==y&&p.unshift(y)}else if(Array.isArray(o)){p=[];for(var _=0,w=o.length;_<w;_++)p[_]=s.serialize(o[_],u,c,d)}else if(s.isPlainObject(o)){p={};for(var E=Object.keys(o),_=0,w=E.length;_<w;_++){var b=E[_];p[b]=s.serialize(o[b],u,c,d)}}else typeof o=="number"?p=u.formatter.number(o,u.precision):p=o;return f&&d.length>0?[["dictionary",d.definitions],p]:p},deserialize:function(o,u,c,d,f){var p=o,y=!c,_=y&&o&&o.length&&o[0][0]==="dictionary";if(c=c||{},Array.isArray(o)){var w=o[0],E=w==="dictionary";if(o.length==1&&/^#/.test(w))return c.dictionary[w];w=s.exports[w],p=[];for(var b=w?1:0,A=o.length;b<A;b++)p.push(s.deserialize(o[b],u,c,E,_));if(w){var C=p;u?p=u(w,C,y||f):p=new w(C)}}else if(s.isPlainObject(o)){p={},d&&(c.dictionary=p);for(var T in o)p[T]=s.deserialize(o[T],u,c)}return _?p[1]:p},exportJSON:function(o,u){var c=s.serialize(o,u);return u&&u.asString==!1?c:JSON.stringify(c)},importJSON:function(o,u){return s.deserialize(typeof o=="string"?JSON.parse(o):o,function(c,d,f){var p=f&&u&&u.constructor===c,y=p?u:s.create(c.prototype);if(d.length===1&&y instanceof te&&(p||!(y instanceof ce))){var _=d[0];s.isPlainObject(_)&&(_.insert=!1,p&&(d=d.concat([te.INSERT])))}return(p?y.set:c).apply(y,d),p&&(u=null),y})},push:function(o,u){var c=u.length;if(c<4096)o.push.apply(o,u);else{var d=o.length;o.length+=c;for(var f=0;f<c;f++)o[d+f]=u[f]}return o},splice:function(o,u,c,d){var f=u&&u.length,p=c===n;c=p?o.length:c,c>o.length&&(c=o.length);for(var y=0;y<f;y++)u[y]._index=c+y;if(p)return s.push(o,u),[];var _=[c,d];u&&s.push(_,u);for(var w=o.splice.apply(o,_),y=0,E=w.length;y<E;y++)w[y]._index=n;for(var y=c+f,E=o.length;y<E;y++)o[y]._index=y;return w},capitalize:function(o){return o.replace(/\b[a-z]/g,function(u){return u.toUpperCase()})},camelize:function(o){return o.replace(/-(.)/g,function(u,c){return c.toUpperCase()})},hyphenate:function(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function(o,u){if(typeof o!="string")s.each(o,function(p,y){this.on(y,p)},this);else{var c=this._eventTypes,d=c&&c[o],f=this._callbacks=this._callbacks||{};f=f[o]=f[o]||[],f.indexOf(u)===-1&&(f.push(u),d&&d.install&&f.length===1&&d.install.call(this,o))}return this},off:function(o,u){if(typeof o!="string"){s.each(o,function(y,_){this.off(_,y)},this);return}var c=this._eventTypes,d=c&&c[o],f=this._callbacks&&this._callbacks[o],p;return f&&(!u||(p=f.indexOf(u))!==-1&&f.length===1?(d&&d.uninstall&&d.uninstall.call(this,o),delete this._callbacks[o]):p!==-1&&f.splice(p,1)),this},once:function(o,u){return this.on(o,function c(){u.apply(this,arguments),this.off(o,c)})},emit:function(o,u){var c=this._callbacks&&this._callbacks[o];if(!c)return!1;var d=s.slice(arguments,1),f=u&&u.target&&!u.currentTarget;c=c.slice(),f&&(u.currentTarget=this);for(var p=0,y=c.length;p<y;p++)if(c[p].apply(this,d)==!1){u&&u.stop&&u.stop();break}return f&&delete u.currentTarget,!0},responds:function(o){return!!(this._callbacks&&this._callbacks[o])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(o){var u=this._eventTypes,c=this._callbacks,d=o?"install":"uninstall";if(u){for(var f in c)if(c[f].length>0){var p=u[f],y=p&&p[d];y&&y.call(this,f)}}},statics:{inject:function o(u){var c=u._events;if(c){var d={};s.each(c,function(f,p){var y=typeof f=="string",_=y?f:p,w=s.capitalize(_),E=_.substring(2).toLowerCase();d[E]=y?{}:f,_="_"+_,u["get"+w]=function(){return this[_]},u["set"+w]=function(b){var A=this[_];A&&this.off(E,A),b&&this.on(E,b),this[_]=b}}),u._eventTypes=d}return o.base.apply(this,arguments)}}},l=s.extend({_class:"PaperScope",initialize:function o(){de=this,this.settings=new s({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=o._id++,o._scopes[this._id]=this;var u=o.prototype;if(!this.support){var c=ae.getContext(1,1)||{};u.support={nativeDash:"setLineDash"in c||"mozDash"in c,nativeBlendModes:ge.nativeModes},ae.release(c)}if(!this.agent){var d=e.navigator.userAgent.toLowerCase(),f=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(d)||[])[0],p=f==="darwin"?"mac":f,y=u.agent=u.browser={platform:p};p&&(y[p]=!0),d.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(_,w,E,b,A){if(!y.chrome){var C=w==="opera"?b:/^(node|trident)$/.test(w)?A:E;y.version=C,y.versionNumber=parseFloat(C),w={trident:"msie",jsdom:"node"}[w]||w,y.name=w,y[w]=!0}}),y.chrome&&delete y.webkit,y.atom&&delete y.chrome}},version:"0.12.17",getView:function(){var o=this.project;return o&&o._view},getPaper:function(){return this},execute:function(o,u){},install:function(o){var u=this;s.each(["project","view","tool"],function(d){s.define(o,d,{configurable:!0,get:function(){return u[d]}})});for(var c in this)!/^_/.test(c)&&this[c]&&(o[c]=this[c])},setup:function(o){return de=this,this.project=new ne(o),this},createCanvas:function(o,u){return ae.getCanvas(o,u)},activate:function(){de=this},clear:function(){for(var o=this.projects,u=this.tools,c=o.length-1;c>=0;c--)o[c].remove();for(var c=u.length-1;c>=0;c--)u[c].remove()},remove:function(){this.clear(),delete l._scopes[this._id]},statics:new function(){function o(u){return u+="Attribute",function(c,d){return c[u](d)||c[u]("data-paper-"+d)}}return{_scopes:{},_id:0,get:function(u){return this._scopes[u]||null},getAttribute:o("get"),hasAttribute:o("has")}}}),h=s.extend(a,{initialize:function(o){this._scope=de,this._index=this._scope[this._list].push(this)-1,(o||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var o=this._scope[this._reference];return o&&o!==this&&o.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",o),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(s.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),g={findItemBoundsCollisions:function(o,u,c){function d(y){for(var _=new Array(y.length),w=0;w<y.length;w++){var E=y[w].getBounds();_[w]=[E.left,E.top,E.right,E.bottom]}return _}var f=d(o),p=!u||u===o?f:d(u);return this.findBoundsCollisions(f,p,c||0)},findCurveBoundsCollisions:function(o,u,c,d){function f(C){for(var T=Math.min,k=Math.max,M=new Array(C.length),F=0;F<C.length;F++){var N=C[F];M[F]=[T(N[0],N[2],N[4],N[6]),T(N[1],N[3],N[5],N[7]),k(N[0],N[2],N[4],N[6]),k(N[1],N[3],N[5],N[7])]}return M}var p=f(o),y=!u||u===o?p:f(u);if(d){for(var _=this.findBoundsCollisions(p,y,c||0,!1,!0),w=this.findBoundsCollisions(p,y,c||0,!0,!0),E=[],b=0,A=_.length;b<A;b++)E[b]={hor:_[b],ver:w[b]};return E}return this.findBoundsCollisions(p,y,c||0)},findBoundsCollisions:function(o,u,c,d,f){var p=!u||o===u,y=p?o:o.concat(u),_=o.length,w=y.length;function E(Te,Pe,Qe){for(var qe=0,He=Te.length;qe<He;){var $e=He+qe>>>1;y[Te[$e]][Pe]<Qe?qe=$e+1:He=$e}return qe-1}for(var b=d?1:0,A=b+2,C=d?0:1,T=C+2,k=new Array(w),M=0;M<w;M++)k[M]=M;k.sort(function(Te,Pe){return y[Te][b]-y[Pe][b]});for(var F=[],N=new Array(_),M=0;M<w;M++){var D=k[M],x=y[D],P=p?D:D-_,O=D<_,L=p||!O,$=O?[]:null;if(F.length){var H=E(F,A,x[b]-c)+1;if(F.splice(0,H),p&&f){$=$.concat(F);for(var q=0;q<F.length;q++){var W=F[q];N[W].push(P)}}else for(var Q=x[T],K=x[C],q=0;q<F.length;q++){var W=F[q],Y=y[W],ee=W<_,re=p||W>=_;(f||(O&&re||L&&ee)&&Q>=Y[C]-c&&K<=Y[T]+c)&&(O&&re&&$.push(p?W:W-_),L&&ee&&N[W].push(P))}}if(O&&(o===u&&$.push(D),N[D]=$),F.length){var se=x[A],ue=E(F,A,se);F.splice(ue+1,0,D)}else F.push(D)}for(var M=0;M<N.length;M++){var Ee=N[M];Ee&&Ee.sort(function(Pe,Qe){return Pe-Qe})}return N}},m=s.extend({initialize:function(o){this.precision=s.pick(o,5),this.multiplier=Math.pow(10,this.precision)},number:function(o){return this.precision<16?Math.round(o*this.multiplier)/this.multiplier:o},pair:function(o,u,c){return this.number(o)+(c||",")+this.number(u)},point:function(o,u){return this.number(o.x)+(u||",")+this.number(o.y)},size:function(o,u){return this.number(o.width)+(u||",")+this.number(o.height)},rectangle:function(o,u){return this.point(o,u)+(u||",")+this.size(o,u)}});m.instance=new m;var v=new function(){var o=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],u=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],c=Math.abs,d=Math.sqrt,f=Math.pow,p=Math.log2||function(A){return Math.log(A)*Math.LOG2E},y=1e-12,_=112e-18;function w(A,C,T){return A<C?C:A>T?T:A}function E(A,C,T){function k(H){var q=H*134217729,W=H-q,Q=W+q,K=H-Q;return[Q,K]}var M=C*C-A*T,F=C*C+A*T;if(c(M)*3<F){var N=k(A),D=k(C),x=k(T),P=C*C,O=D[0]*D[0]-P+2*D[0]*D[1]+D[1]*D[1],L=A*T,$=N[0]*x[0]-L+N[0]*x[1]+N[1]*x[0]+N[1]*x[1];M=P-L+(O-$)}return M}function b(){var A=Math.max.apply(Math,arguments);return A&&(A<1e-8||A>1e8)?f(2,-Math.round(p(A))):0}return{EPSILON:y,MACHINE_EPSILON:_,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(d(2)-1)/3,isZero:function(A){return A>=-y&&A<=y},isMachineZero:function(A){return A>=-_&&A<=_},clamp:w,integrate:function(A,C,T,k){for(var M=o[k-2],F=u[k-2],N=(T-C)*.5,D=N+C,x=0,P=k+1>>1,O=k&1?F[x++]*A(D):0;x<P;){var L=N*M[x];O+=F[x++]*(A(D+L)+A(D-L))}return N*O},findRoot:function(A,C,T,k,M,F,N){for(var D=0;D<F;D++){var x=A(T),P=x/C(T),O=T-P;if(c(P)<N){T=O;break}x>0?(M=T,T=O<=k?(k+M)*.5:O):(k=T,T=O>=M?(k+M)*.5:O)}return w(T,k,M)},solveQuadratic:function(A,C,T,k,M,F){var N,D=1/0;if(c(A)<y){if(c(C)<y)return c(T)<y?-1:0;N=-T/C}else{C*=-.5;var x=E(A,C,T);if(x&&c(x)<_){var P=b(c(A),c(C),c(T));P&&(A*=P,C*=P,T*=P,x=E(A,C,T))}if(x>=-_){var O=x<0?0:d(x),L=C+(C<0?-O:O);L===0?(N=T/A,D=-N):(N=L/A,D=T/L)}}var $=0,H=M==null,q=M-y,W=F+y;return isFinite(N)&&(H||N>q&&N<W)&&(k[$++]=H?N:w(N,M,F)),D!==N&&isFinite(D)&&(H||D>q&&D<W)&&(k[$++]=H?D:w(D,M,F)),$},solveCubic:function(A,C,T,k,M,F,N){var D=b(c(A),c(C),c(T),c(k)),x,P,O,L,$;D&&(A*=D,C*=D,T*=D,k*=D);function H(ue){x=ue;var Ee=A*x;P=Ee+C,O=P*x+T,L=(Ee+P)*x+O,$=O*x+k}if(c(A)<y)A=C,P=T,O=k,x=1/0;else if(c(k)<y)P=C,O=T,x=0;else{H(-(C/A)/3);var q=$/A,W=f(c(q),1/3),Q=q<0?-1:1,K=-L/A,Y=K>0?1.324717957244746*Math.max(W,d(K)):W,ee=x-Q*Y;if(ee!==x){do H(ee),ee=L===0?x:x-$/L/(1+_);while(Q*ee>Q*x);c(A)*x*x>c(k/x)&&(O=-k/x,P=(O-T)/x)}}var re=v.solveQuadratic(A,P,O,M,F,N),se=F==null;return isFinite(x)&&(re===0||re>0&&x!==M[0]&&x!==M[1])&&(se||x>F-y&&x<N+y)&&(M[re++]=se?x:w(x,F,N)),re}}},I={_id:1,_pools:{},get:function(o){if(o){var u=this._pools[o];return u||(u=this._pools[o]={_id:1}),u._id++}else return this._id++}},S=s.extend({_class:"Point",_readIndex:!0,initialize:function(u,c){var d=typeof u,f=this.__read,p=0;if(d==="number"){var y=typeof c=="number";this._set(u,y?c:u),f&&(p=y?2:1)}else if(d==="undefined"||u===null)this._set(0,0),f&&(p=u===null?1:0);else{var _=d==="string"?u.split(/[\s,]+/)||[]:u;p=1,Array.isArray(_)?this._set(+_[0],+(_.length>1?_[1]:_[0])):"x"in _?this._set(_.x||0,_.y||0):"width"in _?this._set(_.width||0,_.height||0):"angle"in _?(this._set(_.length||0,0),this.setAngle(_.angle||0)):(this._set(0,0),p=0)}return f&&(this.__read=p),this},set:"#initialize",_set:function(o,u){return this.x=o,this.y=u,this},equals:function(o){return this===o||o&&(this.x===o.x&&this.y===o.y||Array.isArray(o)&&this.x===o[0]&&this.y===o[1])||!1},clone:function(){return new S(this.x,this.y)},toString:function(){var o=m.instance;return"{ x: "+o.number(this.x)+", y: "+o.number(this.y)+" }"},_serialize:function(o){var u=o.formatter;return[u.number(this.x),u.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(o){if(this.isZero()){var u=this._angle||0;this._set(Math.cos(u)*o,Math.sin(u)*o)}else{var c=o/this.getLength();v.isZero(c)&&this.getAngle(),this._set(this.x*c,this.y*c)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(o){this.setAngleInRadians.call(this,o*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var o=S.read(arguments),u=this.getLength()*o.getLength();if(v.isZero(u))return NaN;var c=this.dot(o)/u;return Math.acos(c<-1?-1:c>1?1:c)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(o){if(this._angle=o,!this.isZero()){var u=this.getLength();this._set(Math.cos(o)*u,Math.sin(o)*u)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var o=S.read(arguments);return Math.atan2(this.cross(o),this.dot(o))*180/Math.PI},getDistance:function(){var o=arguments,u=S.read(o),c=u.x-this.x,d=u.y-this.y,f=c*c+d*d,p=s.read(o);return p?f:Math.sqrt(f)},normalize:function(o){o===n&&(o=1);var u=this.getLength(),c=u!==0?o/u:0,d=new S(this.x*c,this.y*c);return c>=0&&(d._angle=this._angle),d},rotate:function(o,u){if(o===0)return this.clone();o=o*Math.PI/180;var c=u?this.subtract(u):this,d=Math.sin(o),f=Math.cos(o);return c=new S(c.x*f-c.y*d,c.x*d+c.y*f),u?c.add(u):c},transform:function(o){return o?o._transformPoint(this):this},add:function(){var o=S.read(arguments);return new S(this.x+o.x,this.y+o.y)},subtract:function(){var o=S.read(arguments);return new S(this.x-o.x,this.y-o.y)},multiply:function(){var o=S.read(arguments);return new S(this.x*o.x,this.y*o.y)},divide:function(){var o=S.read(arguments);return new S(this.x/o.x,this.y/o.y)},modulo:function(){var o=S.read(arguments);return new S(this.x%o.x,this.y%o.y)},negate:function(){return new S(-this.x,-this.y)},isInside:function(){return V.read(arguments).contains(this)},isClose:function(){var o=arguments,u=S.read(o),c=s.read(o);return this.getDistance(u)<=c},isCollinear:function(){var o=S.read(arguments);return S.isCollinear(this.x,this.y,o.x,o.y)},isColinear:"#isCollinear",isOrthogonal:function(){var o=S.read(arguments);return S.isOrthogonal(this.x,this.y,o.x,o.y)},isZero:function(){var o=v.isZero;return o(this.x)&&o(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(o){return this.x*(o>1&&o<4?-1:1)>=0&&this.y*(o>2?-1:1)>=0},dot:function(){var o=S.read(arguments);return this.x*o.x+this.y*o.y},cross:function(){var o=S.read(arguments);return this.x*o.y-this.y*o.x},project:function(){var o=S.read(arguments),u=o.isZero()?0:this.dot(o)/o.dot(o);return new S(o.x*u,o.y*u)},statics:{min:function(){var o=arguments,u=S.read(o),c=S.read(o);return new S(Math.min(u.x,c.x),Math.min(u.y,c.y))},max:function(){var o=arguments,u=S.read(o),c=S.read(o);return new S(Math.max(u.x,c.x),Math.max(u.y,c.y))},random:function(){return new S(Math.random(),Math.random())},isCollinear:function(o,u,c,d){return Math.abs(o*d-u*c)<=Math.sqrt((o*o+u*u)*(c*c+d*d))*1e-8},isOrthogonal:function(o,u,c,d){return Math.abs(o*c+u*d)<=Math.sqrt((o*o+u*u)*(c*c+d*d))*1e-8}}},s.each(["round","ceil","floor","abs"],function(o){var u=Math[o];this[o]=function(){return new S(u(this.x),u(this.y))}},{})),j=S.extend({initialize:function(u,c,d,f){this._x=u,this._y=c,this._owner=d,this._setter=f},_set:function(o,u,c){return this._x=o,this._y=u,c||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(o){this._x=o,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(o){this._y=o,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(o){this._owner._changeSelection(this._getSelection(),o)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),z=s.extend({_class:"Size",_readIndex:!0,initialize:function(u,c){var d=typeof u,f=this.__read,p=0;if(d==="number"){var y=typeof c=="number";this._set(u,y?c:u),f&&(p=y?2:1)}else if(d==="undefined"||u===null)this._set(0,0),f&&(p=u===null?1:0);else{var _=d==="string"?u.split(/[\s,]+/)||[]:u;p=1,Array.isArray(_)?this._set(+_[0],+(_.length>1?_[1]:_[0])):"width"in _?this._set(_.width||0,_.height||0):"x"in _?this._set(_.x||0,_.y||0):(this._set(0,0),p=0)}return f&&(this.__read=p),this},set:"#initialize",_set:function(o,u){return this.width=o,this.height=u,this},equals:function(o){return o===this||o&&(this.width===o.width&&this.height===o.height||Array.isArray(o)&&this.width===o[0]&&this.height===o[1])||!1},clone:function(){return new z(this.width,this.height)},toString:function(){var o=m.instance;return"{ width: "+o.number(this.width)+", height: "+o.number(this.height)+" }"},_serialize:function(o){var u=o.formatter;return[u.number(this.width),u.number(this.height)]},add:function(){var o=z.read(arguments);return new z(this.width+o.width,this.height+o.height)},subtract:function(){var o=z.read(arguments);return new z(this.width-o.width,this.height-o.height)},multiply:function(){var o=z.read(arguments);return new z(this.width*o.width,this.height*o.height)},divide:function(){var o=z.read(arguments);return new z(this.width/o.width,this.height/o.height)},modulo:function(){var o=z.read(arguments);return new z(this.width%o.width,this.height%o.height)},negate:function(){return new z(-this.width,-this.height)},isZero:function(){var o=v.isZero;return o(this.width)&&o(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(o,u){return new z(Math.min(o.width,u.width),Math.min(o.height,u.height))},max:function(o,u){return new z(Math.max(o.width,u.width),Math.max(o.height,u.height))},random:function(){return new z(Math.random(),Math.random())}}},s.each(["round","ceil","floor","abs"],function(o){var u=Math[o];this[o]=function(){return new z(u(this.width),u(this.height))}},{})),J=z.extend({initialize:function(u,c,d,f){this._width=u,this._height=c,this._owner=d,this._setter=f},_set:function(o,u,c){return this._width=o,this._height=u,c||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(o){this._width=o,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(o){this._height=o,this._owner[this._setter](this)}}),V=s.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(u,c,d,f){var p=arguments,y=typeof u,_;if(y==="number"?(this._set(u,c,d,f),_=4):y==="undefined"||u===null?(this._set(0,0,0,0),_=u===null?1:0):p.length===1&&(Array.isArray(u)?(this._set.apply(this,u),_=1):u.x!==n||u.width!==n?(this._set(u.x||0,u.y||0,u.width||0,u.height||0),_=1):u.from===n&&u.to===n&&(this._set(0,0,0,0),s.readSupported(p,this)&&(_=1))),_===n){var w=S.readNamed(p,"from"),E=s.peek(p),b=w.x,A=w.y,C,T;if(E&&E.x!==n||s.hasNamed(p,"to")){var k=S.readNamed(p,"to");C=k.x-b,T=k.y-A,C<0&&(b=k.x,C=-C),T<0&&(A=k.y,T=-T)}else{var M=z.read(p);C=M.width,T=M.height}this._set(b,A,C,T),_=p.__index}var F=p.__filtered;return F&&(this.__filtered=F),this.__read&&(this.__read=_),this},set:"#initialize",_set:function(o,u,c,d){return this.x=o,this.y=u,this.width=c,this.height=d,this},clone:function(){return new V(this.x,this.y,this.width,this.height)},equals:function(o){var u=s.isPlainValue(o)?V.read(arguments):o;return u===this||u&&this.x===u.x&&this.y===u.y&&this.width===u.width&&this.height===u.height||!1},toString:function(){var o=m.instance;return"{ x: "+o.number(this.x)+", y: "+o.number(this.y)+", width: "+o.number(this.width)+", height: "+o.number(this.height)+" }"},_serialize:function(o){var u=o.formatter;return[u.number(this.x),u.number(this.y),u.number(this.width),u.number(this.height)]},getPoint:function(o){var u=o?S:j;return new u(this.x,this.y,this,"setPoint")},setPoint:function(){var o=S.read(arguments);this.x=o.x,this.y=o.y},getSize:function(o){var u=o?z:J;return new u(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var o=z.read(arguments),u=this._sx,c=this._sy,d=o.width,f=o.height;u&&(this.x+=(this.width-d)*u),c&&(this.y+=(this.height-f)*c),this.width=d,this.height=f,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(o){if(!this._fw){var u=o-this.x;this.width-=this._sx===.5?u*2:u}this.x=o,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(o){if(!this._fh){var u=o-this.y;this.height-=this._sy===.5?u*2:u}this.y=o,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(o){if(!this._fw){var u=o-this.x;this.width=this._sx===.5?u*2:u}this.x=o-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(o){if(!this._fh){var u=o-this.y;this.height=this._sy===.5?u*2:u}this.y=o-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(o){this._fw||this._sx===.5?this.x=o-this.width/2:(this._sx&&(this.x+=(o-this.x)*2*this._sx),this.width=(o-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(o){this._fh||this._sy===.5?this.y=o-this.height/2:(this._sy&&(this.y+=(o-this.y)*2*this._sy),this.height=(o-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(o){var u=o?S:j;return new u(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var o=S.read(arguments);return this.setCenterX(o.x),this.setCenterY(o.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(o){return o&&o.width!==n||(Array.isArray(o)?o:arguments).length===4?this._containsRectangle(V.read(arguments)):this._containsPoint(S.read(arguments))},_containsPoint:function(o){var u=o.x,c=o.y;return u>=this.x&&c>=this.y&&u<=this.x+this.width&&c<=this.y+this.height},_containsRectangle:function(o){var u=o.x,c=o.y;return u>=this.x&&c>=this.y&&u+o.width<=this.x+this.width&&c+o.height<=this.y+this.height},intersects:function(){var o=V.read(arguments),u=s.read(arguments)||0;return o.x+o.width>this.x-u&&o.y+o.height>this.y-u&&o.x<this.x+this.width+u&&o.y<this.y+this.height+u},intersect:function(){var o=V.read(arguments),u=Math.max(this.x,o.x),c=Math.max(this.y,o.y),d=Math.min(this.x+this.width,o.x+o.width),f=Math.min(this.y+this.height,o.y+o.height);return new V(u,c,d-u,f-c)},unite:function(){var o=V.read(arguments),u=Math.min(this.x,o.x),c=Math.min(this.y,o.y),d=Math.max(this.x+this.width,o.x+o.width),f=Math.max(this.y+this.height,o.y+o.height);return new V(u,c,d-u,f-c)},include:function(){var o=S.read(arguments),u=Math.min(this.x,o.x),c=Math.min(this.y,o.y),d=Math.max(this.x+this.width,o.x),f=Math.max(this.y+this.height,o.y);return new V(u,c,d-u,f-c)},expand:function(){var o=z.read(arguments),u=o.width,c=o.height;return new V(this.x-u/2,this.y-c/2,this.width+u,this.height+c)},scale:function(o,u){return this.expand(this.width*o-this.width,this.height*(u===n?o:u)-this.height)}},s.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(o,u){var c=o.join(""),d=/^[RL]/.test(c);u>=4&&(o[1]+=d?"Y":"X");var f=o[d?0:1],p=o[d?1:0],y="get"+f,_="get"+p,w="set"+f,E="set"+p,b="get"+c,A="set"+c;this[b]=function(C){var T=C?S:j;return new T(this[y](),this[_](),this,A)},this[A]=function(){var C=S.read(arguments);this[w](C.x),this[E](C.y)}},{beans:!0})),B=V.extend({initialize:function(u,c,d,f,p,y){this._set(u,c,d,f,!0),this._owner=p,this._setter=y},_set:function(o,u,c,d,f){return this._x=o,this._y=u,this._width=c,this._height=d,f||this._owner[this._setter](this),this}},new function(){var o=V.prototype;return s.each(["x","y","width","height"],function(u){var c=s.capitalize(u),d="_"+u;this["get"+c]=function(){return this[d]},this["set"+c]=function(f){this[d]=f,this._dontNotify||this._owner[this._setter](this)}},s.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(u){var c="set"+u;this[c]=function(){this._dontNotify=!0,o[c].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(u){var c=this._owner;c._changeSelection&&c._changeSelection(2,u)}}))}),U=s.extend({_class:"Matrix",initialize:function o(u,c){var d=arguments,f=d.length,p=!0;if(f>=6?this._set.apply(this,d):f===1||f===2?u instanceof o?this._set(u._a,u._b,u._c,u._d,u._tx,u._ty,c):Array.isArray(u)?this._set.apply(this,c?u.concat([c]):u):p=!1:f?p=!1:this.reset(),!p)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(o,u,c,d,f,p,y){return this._a=o,this._b=u,this._c=c,this._d=d,this._tx=f,this._ty=p,y||this._changed(),this},_serialize:function(o,u){return s.serialize(this.getValues(),o,!0,u)},_changed:function(){var o=this._owner;o&&(o._applyMatrix?o.transform(null,!0):o._changed(25))},clone:function(){return new U(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(o){return o===this||o&&this._a===o._a&&this._b===o._b&&this._c===o._c&&this._d===o._d&&this._tx===o._tx&&this._ty===o._ty},toString:function(){var o=m.instance;return"[["+[o.number(this._a),o.number(this._c),o.number(this._tx)].join(", ")+"], ["+[o.number(this._b),o.number(this._d),o.number(this._ty)].join(", ")+"]]"},reset:function(o){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,o||this._changed(),this},apply:function(o,u){var c=this._owner;return c?(c.transform(null,s.pick(o,!0),u),this.isIdentity()):!1},translate:function(){var o=S.read(arguments),u=o.x,c=o.y;return this._tx+=u*this._a+c*this._c,this._ty+=u*this._b+c*this._d,this._changed(),this},scale:function(){var o=arguments,u=S.read(o),c=S.read(o,0,{readNull:!0});return c&&this.translate(c),this._a*=u.x,this._b*=u.x,this._c*=u.y,this._d*=u.y,c&&this.translate(c.negate()),this._changed(),this},rotate:function(o){o*=Math.PI/180;var u=S.read(arguments,1),c=u.x,d=u.y,f=Math.cos(o),p=Math.sin(o),y=c-c*f+d*p,_=d-c*p-d*f,w=this._a,E=this._b,b=this._c,A=this._d;return this._a=f*w+p*b,this._b=f*E+p*A,this._c=-p*w+f*b,this._d=-p*E+f*A,this._tx+=y*w+_*b,this._ty+=y*E+_*A,this._changed(),this},shear:function(){var o=arguments,u=S.read(o),c=S.read(o,0,{readNull:!0});c&&this.translate(c);var d=this._a,f=this._b;return this._a+=u.y*this._c,this._b+=u.y*this._d,this._c+=u.x*d,this._d+=u.x*f,c&&this.translate(c.negate()),this._changed(),this},skew:function(){var o=arguments,u=S.read(o),c=S.read(o,0,{readNull:!0}),d=Math.PI/180,f=new S(Math.tan(u.x*d),Math.tan(u.y*d));return this.shear(f,c)},append:function(o,u){if(o){var c=this._a,d=this._b,f=this._c,p=this._d,y=o._a,_=o._c,w=o._b,E=o._d,b=o._tx,A=o._ty;this._a=y*c+w*f,this._c=_*c+E*f,this._b=y*d+w*p,this._d=_*d+E*p,this._tx+=b*c+A*f,this._ty+=b*d+A*p,u||this._changed()}return this},prepend:function(o,u){if(o){var c=this._a,d=this._b,f=this._c,p=this._d,y=this._tx,_=this._ty,w=o._a,E=o._c,b=o._b,A=o._d,C=o._tx,T=o._ty;this._a=w*c+E*d,this._c=w*f+E*p,this._b=b*c+A*d,this._d=b*f+A*p,this._tx=w*y+E*_+C,this._ty=b*y+A*_+T,u||this._changed()}return this},appended:function(o){return this.clone().append(o)},prepended:function(o){return this.clone().prepend(o)},invert:function(){var o=this._a,u=this._b,c=this._c,d=this._d,f=this._tx,p=this._ty,y=o*d-u*c,_=null;return y&&!isNaN(y)&&isFinite(f)&&isFinite(p)&&(this._a=d/y,this._b=-u/y,this._c=-c/y,this._d=o/y,this._tx=(c*p-d*f)/y,this._ty=(u*f-o*p)/y,_=this),_},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new U(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var o=this._a*this._d-this._c*this._b;return o&&!isNaN(o)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(o,u,c){return arguments.length<3?this._transformPoint(S.read(arguments)):this._transformCoordinates(o,u,c)},_transformPoint:function(o,u,c){var d=o.x,f=o.y;return u||(u=new S),u._set(d*this._a+f*this._c+this._tx,d*this._b+f*this._d+this._ty,c)},_transformCoordinates:function(o,u,c){for(var d=0,f=2*c;d<f;d+=2){var p=o[d],y=o[d+1];u[d]=p*this._a+y*this._c+this._tx,u[d+1]=p*this._b+y*this._d+this._ty}return u},_transformCorners:function(o){var u=o.x,c=o.y,d=u+o.width,f=c+o.height,p=[u,c,d,c,d,f,u,f];return this._transformCoordinates(p,p,4)},_transformBounds:function(o,u,c){for(var d=this._transformCorners(o),f=d.slice(0,2),p=f.slice(),y=2;y<8;y++){var _=d[y],w=y&1;_<f[w]?f[w]=_:_>p[w]&&(p[w]=_)}return u||(u=new V),u._set(f[0],f[1],p[0]-f[0],p[1]-f[1],c)},inverseTransform:function(){return this._inverseTransform(S.read(arguments))},_inverseTransform:function(o,u,c){var d=this._a,f=this._b,p=this._c,y=this._d,_=this._tx,w=this._ty,E=d*y-f*p,b=null;if(E&&!isNaN(E)&&isFinite(_)&&isFinite(w)){var A=o.x-this._tx,C=o.y-this._ty;u||(u=new S),b=u._set((A*y-C*p)/E,(C*d-A*f)/E,c)}return b},decompose:function(){var o=this._a,u=this._b,c=this._c,d=this._d,f=o*d-u*c,p=Math.sqrt,y=Math.atan2,_=180/Math.PI,w,E,b;if(o!==0||u!==0){var A=p(o*o+u*u);w=Math.acos(o/A)*(u>0?1:-1),E=[A,f/A],b=[y(o*c+u*d,A*A),0]}else if(c!==0||d!==0){var C=p(c*c+d*d);w=Math.asin(c/C)*(d>0?1:-1),E=[f/C,C],b=[0,y(o*c+u*d,C*C)]}else w=0,b=E=[0,0];return{translation:this.getTranslation(),rotation:w*_,scaling:new S(E),skewing:new S(b[0]*_,b[1]*_)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new S(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(o){this.isIdentity()||o.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},s.each(["a","b","c","d","tx","ty"],function(o){var u=s.capitalize(o),c="_"+o;this["get"+u]=function(){return this[c]},this["set"+u]=function(d){this[c]=d,this._changed()}},{})),Z=s.extend({_class:"Line",initialize:function(u,c,d,f,p){var y=!1;arguments.length>=4?(this._px=u,this._py=c,this._vx=d,this._vy=f,y=p):(this._px=u.x,this._py=u.y,this._vx=c.x,this._vy=c.y,y=d),y||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new S(this._px,this._py)},getVector:function(){return new S(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(o,u){return Z.intersect(this._px,this._py,this._vx,this._vy,o._px,o._py,o._vx,o._vy,!0,u)},getSide:function(o,u){return Z.getSide(this._px,this._py,this._vx,this._vy,o.x,o.y,!0,u)},getDistance:function(o){return Math.abs(this.getSignedDistance(o))},getSignedDistance:function(o){return Z.getSignedDistance(this._px,this._py,this._vx,this._vy,o.x,o.y,!0)},isCollinear:function(o){return S.isCollinear(this._vx,this._vy,o._vx,o._vy)},isOrthogonal:function(o){return S.isOrthogonal(this._vx,this._vy,o._vx,o._vy)},statics:{intersect:function(o,u,c,d,f,p,y,_,w,E){w||(c-=o,d-=u,y-=f,_-=p);var b=c*_-d*y;if(!v.isMachineZero(b)){var A=o-f,C=u-p,T=(y*C-_*A)/b,k=(c*C-d*A)/b,M=1e-12,F=-M,N=1+M;if(E||F<T&&T<N&&F<k&&k<N)return E||(T=T<=0?0:T>=1?1:T),new S(o+T*c,u+T*d)}},getSide:function(o,u,c,d,f,p,y,_){y||(c-=o,d-=u);var w=f-o,E=p-u,b=w*d-E*c;return!_&&v.isMachineZero(b)&&(b=(w*c+w*c)/(c*c+d*d),b>=0&&b<=1&&(b=0)),b<0?-1:b>0?1:0},getSignedDistance:function(o,u,c,d,f,p,y){return y||(c-=o,d-=u),c===0?d>0?f-o:o-f:d===0?c<0?p-u:u-p:((f-o)*d-(p-u)*c)/(d>c?d*Math.sqrt(1+c*c/(d*d)):c*Math.sqrt(1+d*d/(c*c)))},getDistance:function(o,u,c,d,f,p,y){return Math.abs(Z.getSignedDistance(o,u,c,d,f,p,y))}}}),ne=h.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(u){h.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new ls(null,null,this),this._view=Nt.create(this,u||ae.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(o,u){return s.serialize(this._children,o,!0,u)},_changed:function(o,u){if(o&1){var c=this._view;c&&(c._needsUpdate=!0,!c._requested&&c._autoUpdate&&c.requestUpdate())}var d=this._changes;if(d&&u){var f=this._changesById,p=u._id,y=f[p];y?y.flags|=o:d.push(f[p]={item:u,flags:o})}},clear:function(){for(var o=this._children,u=o.length-1;u>=0;u--)o[u].remove()},isEmpty:function(){return!this._children.length},remove:function o(){return o.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(o){this._currentStyle.set(o)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new ce({project:this,insert:!0})},getSymbolDefinitions:function(){var o=[],u={};return this.getItems({class:Ye,match:function(c){var d=c._definition,f=d._id;return u[f]||(u[f]=!0,o.push(d)),!1}}),o},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var o=this._selectionItems,u=[];for(var c in o){var d=o[c],f=d._selection;f&1&&d.isInserted()?u.push(d):f||this._updateSelection(d)}return u},_updateSelection:function(o){var u=o._id,c=this._selectionItems;o._selection?c[u]!==o&&(this._selectionCount++,c[u]=o):c[u]===o&&(this._selectionCount--,delete c[u])},selectAll:function(){for(var o=this._children,u=0,c=o.length;u<c;u++)o[u].setFullySelected(!0)},deselectAll:function(){var o=this._selectionItems;for(var u in o)o[u].setFullySelected(!1)},addLayer:function(o){return this.insertLayer(n,o)},insertLayer:function(o,u){if(u instanceof ce){u._remove(!1,!0),s.splice(this._children,[u],o,0),u._setProject(this,!0);var c=u._name;c&&u.setName(c),this._changes&&u._changed(5),this._activeLayer||(this._activeLayer=u)}else u=null;return u},_insertItem:function(o,u,c){return u=this.insertLayer(o,u)||(this._activeLayer||this._insertItem(n,new ce(te.NO_INSERT),!0)).insertChild(o,u),c&&u.activate&&u.activate(),u},getItems:function(o){return te._getItems(this,o)},getItem:function(o){return te._getItems(this,o,null,null,!0)[0]||null},importJSON:function(o){this.activate();var u=this._activeLayer;return s.importJSON(o,u&&u.isEmpty()&&u)},removeOn:function(o){var u=this._removeSets;if(u){o==="mouseup"&&(u.mousedrag=null);var c=u[o];if(c){for(var d in c){var f=c[d];for(var p in u){var y=u[p];y&&y!=c&&delete y[f._id]}f.remove()}u[o]=null}}},draw:function(o,u,c){this._updateVersion++,o.save(),u.applyToContext(o);for(var d=this._children,f=new s({offset:new S(0,0),pixelRatio:c,viewMatrix:u.isIdentity()?null:u,matrices:[new U],updateMatrix:!0}),p=0,y=d.length;p<y;p++)d[p].draw(o,f);if(o.restore(),this._selectionCount>0){o.save(),o.strokeWidth=1;var _=this._selectionItems,w=this._scope.settings.handleSize,E=this._updateVersion;for(var b in _)_[b]._drawSelection(o,u,w,_,E);o.restore()}}}),te=s.extend(a,{statics:{extend:function o(u){return u._serializeFields&&(u._serializeFields=s.set({},this.prototype._serializeFields,u._serializeFields)),o.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new U,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var o=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return s.each(o,function(u){this._events[u]={install:function(c){this.getView()._countItemEvent(c,1)},uninstall:function(c){this.getView()._countItemEvent(c,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:o}})},{initialize:function(){},_initialize:function(o,u){var c=o&&s.isPlainObject(o),d=c&&o.internal===!0,f=this._matrix=new U,p=c&&o.project||de.project,y=de.settings;return this._id=d?null:I.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&y.applyMatrix,u&&f.translate(u),f._owner=this,this._style=new ls(p._currentStyle,this,p),d||c&&o.insert==!1||!y.insertItems&&!(c&&o.insert==!0)?this._setProject(p):(c&&o.parent||p)._insertItem(n,this,!0),c&&o!==te.NO_INSERT&&o!==te.INSERT&&this.set(o,{internal:!0,insert:!0,project:!0,parent:!0}),c},_serialize:function(o,u){var c={},d=this;function f(p){for(var y in p){var _=d[y];s.equals(_,y==="leading"?p.fontSize*1.2:p[y])||(c[y]=s.serialize(_,o,y!=="data",u))}}return f(this._serializeFields),this instanceof oe||f(this._style._defaults),[this._class,c]},_changed:function(o){var u=this._symbol,c=this._parent||u,d=this._project;o&8&&(this._bounds=this._position=this._decomposed=n),o&16&&(this._globalMatrix=n),c&&o&72&&te._clearBoundsCache(c),o&2&&te._clearBoundsCache(this),d&&d._changed(o,this),u&&u._changed(o)},getId:function(){return this._id},getName:function(){return this._name},setName:function(o){if(this._name&&this._removeNamed(),o===+o+"")throw new Error("Names consisting only of numbers are not supported.");var u=this._getOwner();if(o&&u){var c=u._children,d=u._namedChildren;(d[o]=d[o]||[]).push(this),o in c||(c[o]=this)}this._name=o||n,this._changed(256)},getStyle:function(){return this._style},setStyle:function(o){this.getStyle().set(o)}},s.each(["locked","visible","blendMode","opacity","guide"],function(o){var u=s.capitalize(o),c="_"+o,d={locked:256,visible:265};this["get"+u]=function(){return this[c]},this["set"+u]=function(f){f!=this[c]&&(this[c]=f,this._changed(d[o]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(o){if(o!==this._selection){this._selection=o;var u=this._project;u&&(u._updateSelection(this),this._changed(257))}},_changeSelection:function(o,u){var c=this._selection;this.setSelection(u?c|o:c&~o)},isSelected:function(){if(this._selectChildren){for(var o=this._children,u=0,c=o.length;u<c;u++)if(o[u].isSelected())return!0}return!!(this._selection&1)},setSelected:function(o){if(this._selectChildren)for(var u=this._children,c=0,d=u.length;c<d;c++)u[c].setSelected(o);this._changeSelection(1,o)},isFullySelected:function(){var o=this._children,u=!!(this._selection&1);if(o&&u){for(var c=0,d=o.length;c<d;c++)if(!o[c].isFullySelected())return!1;return!0}return u},setFullySelected:function(o){var u=this._children;if(u)for(var c=0,d=u.length;c<d;c++)u[c].setFullySelected(o);this._changeSelection(1,o)},isClipMask:function(){return this._clipMask},setClipMask:function(o){this._clipMask!=(o=!!o)&&(this._clipMask=o,o&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(o){this._data=o},getPosition:function(o){var u=o?S:j,c=this._position||(this._position=this._getPositionFromBounds());return new u(c.x,c.y,this,"setPosition")},setPosition:function(){this.translate(S.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(o){return this._pivot?this._matrix._transformPoint(this._pivot):(o||this.getBounds()).getCenter(!0)},getPivot:function(){var o=this._pivot;return o?new j(o.x,o.y,this,"setPivot"):null},setPivot:function(){this._pivot=S.read(arguments,0,{clone:!0,readNull:!0}),this._position=n}},s.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(o,u){this[u]=function(c){return this.getBounds(c,o)}},{beans:!0,getBounds:function(o,u){var c=u||o instanceof U,d=s.set({},c?u:o,this._boundsOptions);(!d.stroke||this.getStrokeScaling())&&(d.cacheItem=this);var f=this._getCachedBounds(c&&o,d).rect;return arguments.length?f:new B(f.x,f.y,f.width,f.height,this,"setBounds")},setBounds:function(){var o=V.read(arguments),u=this.getBounds(),c=this._matrix,d=new U,f=o.getCenter();d.translate(f),(o.width!=u.width||o.height!=u.height)&&(c.isInvertible()||(c.set(c._backup||new U().translate(c.getTranslation())),u=this.getBounds()),d.scale(u.width!==0?o.width/u.width:0,u.height!==0?o.height/u.height:0)),f=u.getCenter(),d.translate(-f.x,-f.y),this.transform(d)},_getBounds:function(o,u){var c=this._children;return!c||!c.length?new V:(te._updateBoundsCache(this,u.cacheItem),te._getBounds(c,o,u))},_getBoundsCacheKey:function(o,u){return[o.stroke?1:0,o.handle?1:0,u?1:0].join("")},_getCachedBounds:function(o,u,c){o=o&&o._orNullIfIdentity();var d=u.internal&&!c,f=u.cacheItem,p=d?null:this._matrix._orNullIfIdentity(),y=f&&(!o||o.equals(p))&&this._getBoundsCacheKey(u,d),_=this._bounds;if(te._updateBoundsCache(this._parent||this._symbol,f),y&&_&&y in _){var w=_[y];return{rect:w.rect.clone(),nonscaling:w.nonscaling}}var E=this._getBounds(o||p,u),b=E.rect||E,A=this._style,C=E.nonscaling||A.hasStroke()&&!A.getStrokeScaling();if(y){_||(this._bounds=_={});var w=_[y]={rect:b.clone(),nonscaling:C,internal:d}}return{rect:b,nonscaling:C}},_getStrokeMatrix:function(o,u){var c=this.getStrokeScaling()?null:u&&u.internal?this:this._parent||this._symbol&&this._symbol._item,d=c?c.getViewMatrix().invert():o;return d&&d._shiftless()},statics:{_updateBoundsCache:function(o,u){if(o&&u){var c=u._id,d=o._boundsCache=o._boundsCache||{ids:{},list:[]};d.ids[c]||(d.list.push(u),d.ids[c]=u)}},_clearBoundsCache:function(o){var u=o._boundsCache;if(u){o._bounds=o._position=o._boundsCache=n;for(var c=0,d=u.list,f=d.length;c<f;c++){var p=d[c];p!==o&&(p._bounds=p._position=n,p._boundsCache&&te._clearBoundsCache(p))}}},_getBounds:function(o,u,c){var d=1/0,f=-d,p=d,y=f,_=!1;c=c||{};for(var w=0,E=o.length;w<E;w++){var b=o[w];if(b._visible&&!b.isEmpty(!0)){var A=b._getCachedBounds(u&&u.appended(b._matrix),c,!0),C=A.rect;d=Math.min(C.x,d),p=Math.min(C.y,p),f=Math.max(C.x+C.width,f),y=Math.max(C.y+C.height,y),A.nonscaling&&(_=!0)}}return{rect:isFinite(d)?new V(d,p,f-d,y-p):new V,nonscaling:_}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var o=this._decompose();return o?o.rotation:0},setRotation:function(o){var u=this.getRotation();if(u!=null&&o!=null){var c=this._decomposed;this.rotate(o-u),c&&(c.rotation=o,this._decomposed=c)}},getScaling:function(){var o=this._decompose(),u=o&&o.scaling;return new j(u?u.x:1,u?u.y:1,this,"setScaling")},setScaling:function(){var o=this.getScaling(),u=S.read(arguments,0,{clone:!0,readNull:!0});if(o&&u&&!o.equals(u)){var c=this.getRotation(),d=this._decomposed,f=new U,p=v.isZero;if(p(o.x)||p(o.y))f.translate(d.translation),c&&f.rotate(c),f.scale(u.x,u.y),this._matrix.set(f);else{var y=this.getPosition(!0);f.translate(y),c&&f.rotate(c),f.scale(u.x/o.x,u.y/o.y),c&&f.rotate(-c),f.translate(y.negate()),this.transform(f)}d&&(d.scaling=u,this._decomposed=d)}},getMatrix:function(){return this._matrix},setMatrix:function(){var o=this._matrix;o.set.apply(o,arguments)},getGlobalMatrix:function(o){var u=this._globalMatrix;if(u)for(var c=this._parent,d=[];c;){if(!c._globalMatrix){u=null;for(var f=0,p=d.length;f<p;f++)d[f]._globalMatrix=null;break}d.push(c),c=c._parent}if(!u){u=this._globalMatrix=this._matrix.clone();var c=this._parent;c&&u.prepend(c.getGlobalMatrix(!0))}return o?u:u.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(o){(this._applyMatrix=this._canApplyMatrix&&!!o)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(o,u){if(this._project!==o){this._project&&this._installEvents(!1),this._project=o;for(var c=this._children,d=0,f=c&&c.length;d<f;d++)c[d]._setProject(o);u=!0}u&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function o(u){o.base.call(this,u);for(var c=this._children,d=0,f=c&&c.length;d<f;d++)c[d]._installEvents(u)},getLayer:function(){for(var o=this;o=o._parent;)if(o instanceof ce)return o;return null},getParent:function(){return this._parent},setParent:function(o){return o.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(o){this.removeChildren(),this.addChildren(o)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var o=this._getOwner();return o&&o._children[this._index+1]||null},getPreviousSibling:function(){var o=this._getOwner();return o&&o._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(o){return o===this||o&&this._class===o._class&&this._style.equals(o._style)&&this._matrix.equals(o._matrix)&&this._locked===o._locked&&this._visible===o._visible&&this._blendMode===o._blendMode&&this._opacity===o._opacity&&this._clipMask===o._clipMask&&this._guide===o._guide&&this._equals(o)||!1},_equals:function(o){return s.equals(this._children,o._children)},clone:function(o){var u=new this.constructor(te.NO_INSERT),c=this._children,d=s.pick(o?o.insert:n,o===n||o===!0),f=s.pick(o?o.deep:n,!0);c&&u.copyAttributes(this),(!c||f)&&u.copyContent(this),c||u.copyAttributes(this),d&&u.insertAbove(this);var p=this._name,y=this._parent;if(p&&y){for(var c=y._children,_=p,w=1;c[p];)p=_+" "+w++;p!==_&&u.setName(p)}return u},copyContent:function(o){for(var u=o._children,c=0,d=u&&u.length;c<d;c++)this.addChild(u[c].clone(!1),!0)},copyAttributes:function(o,u){this.setStyle(o._style);for(var c=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],d=0,f=c.length;d<f;d++){var p=c[d];o.hasOwnProperty(p)&&(this[p]=o[p])}u||this._matrix.set(o._matrix,!0),this.setApplyMatrix(o._applyMatrix),this.setPivot(o._pivot),this.setSelection(o._selection);var y=o._data,_=o._name;this._data=y?s.clone(y):null,_&&this.setName(_)},rasterize:function(o,u){var c,d,f;s.isPlainObject(o)?(c=o.resolution,d=o.insert,f=o.raster):(c=o,d=u),f||(f=new pe(te.NO_INSERT));var p=this.getStrokeBounds(),y=(c||this.getView().getResolution())/72,_=p.getTopLeft().floor(),w=p.getBottomRight().ceil(),E=new z(w.subtract(_)),b=E.multiply(y);if(f.setSize(b,!0),!b.isZero()){var A=f.getContext(!0),C=new U().scale(y).translate(_.negate());A.save(),C.applyToContext(A),this.draw(A,new s({matrices:[C]})),A.restore()}return f._matrix.set(new U().translate(_.add(E.divide(2))).scale(1/y)),(d===n||d)&&f.insertAbove(this),f},contains:function(){var o=this._matrix;return o.isInvertible()&&!!this._contains(o._inverseTransform(S.read(arguments)))},_contains:function(o){var u=this._children;if(u){for(var c=u.length-1;c>=0;c--)if(u[c].contains(o))return!0;return!1}return o.isInside(this.getInternalBounds())},isInside:function(){return V.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new ye.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(o,u){return o instanceof te?this._asPathItem().getIntersections(o._asPathItem(),null,u,!0).length>0:!1}},new function(){function o(){var d=arguments;return this._hitTest(S.read(d),Me.getOptions(d))}function u(){var d=arguments,f=S.read(d),p=Me.getOptions(d),y=[];return this._hitTest(f,new s({all:y},p)),y}function c(d,f,p,y){var _=this._children;if(_)for(var w=_.length-1;w>=0;w--){var E=_[w],b=E!==y&&E._hitTest(d,f,p);if(b&&!f.all)return b}return null}return ne.inject({hitTest:o,hitTestAll:u,_hitTest:c}),{hitTest:o,hitTestAll:u,_hitTestChildren:c}},{_hitTest:function(o,u,c){if(this._locked||!this._visible||this._guide&&!u.guides||this.isEmpty())return null;var d=this._matrix,f=c?c.appended(d):this.getGlobalMatrix().prepend(this.getView()._matrix),p=Math.max(u.tolerance,1e-12),y=u._tolerancePadding=new z(ye._getStrokePadding(p,d._shiftless().invert()));if(o=d._inverseTransform(o),!o||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(y.multiply(2))._containsPoint(o))return null;var _=!(u.guides&&!this._guide||u.selected&&!this.isSelected()||u.type&&u.type!==s.hyphenate(this._class)||u.class&&!(this instanceof u.class)),w=u.match,E=this,b,A;function C(x){return x&&w&&!w(x)&&(x=null),x&&u.all&&u.all.push(x),x}function T(x,P){var O=P?b["get"+P]():E.getPosition();if(o.subtract(O).divide(y).length<=1)return new Me(x,E,{name:P?s.hyphenate(P):x,point:O})}var k=u.position,M=u.center,F=u.bounds;if(_&&this._parent&&(k||M||F)){if((M||F)&&(b=this.getInternalBounds()),A=k&&T("position")||M&&T("center","Center"),!A&&F)for(var N=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],D=0;D<8&&!A;D++)A=T("bounds",N[D]);A=C(A)}return A||(A=this._hitTestChildren(o,u,f)||_&&C(this._hitTestSelf(o,u,f,this.getStrokeScaling()?null:f._shiftless().invert()))||null),A&&A.point&&(A.point=d.transform(A.point)),A},_hitTestSelf:function(o,u){if(u.fill&&this.hasFill()&&this._contains(o))return new Me("fill",this)},matches:function(o,u){function c(y,_){for(var w in y)if(y.hasOwnProperty(w)){var E=y[w],b=_[w];if(s.isPlainObject(E)&&s.isPlainObject(b)){if(!c(E,b))return!1}else if(!s.equals(E,b))return!1}return!0}var d=typeof o;if(d==="object"){for(var f in o)if(o.hasOwnProperty(f)&&!this.matches(f,o[f]))return!1;return!0}else{if(d==="function")return o(this);if(o==="match")return u(this);var p=/^(empty|editable)$/.test(o)?this["is"+s.capitalize(o)]():o==="type"?s.hyphenate(this._class):this[o];if(o==="class"){if(typeof u=="function")return this instanceof u;p=this._class}if(typeof u=="function")return!!u(p);if(u){if(u.test)return u.test(p);if(s.isPlainObject(u))return c(u,p)}return s.equals(p,u)}},getItems:function(o){return te._getItems(this,o,this._matrix)},getItem:function(o){return te._getItems(this,o,this._matrix,null,!0)[0]||null},statics:{_getItems:function o(u,c,d,f,p){if(!f){var y=typeof c=="object"&&c,_=y&&y.overlapping,w=y&&y.inside,E=_||w,C=E&&V.read([E]);f={items:[],recursive:y&&y.recursive!==!1,inside:!!w,overlapping:!!_,rect:C,path:_&&new ye.Rectangle({rectangle:C,insert:!1})},y&&(c=s.filter({},c,{recursive:!0,inside:!0,overlapping:!0}))}var b=u._children,A=f.items,C=f.rect;d=C&&(d||new U);for(var T=0,k=b&&b.length;T<k;T++){var M=b[T],F=d&&d.appended(M._matrix),N=!0;if(C){var E=M.getBounds(F);if(!C.intersects(E))continue;C.contains(E)||f.overlapping&&(E.contains(C)||f.path.intersects(M,F))||(N=!1)}if(N&&M.matches(c)&&(A.push(M),p)||(f.recursive!==!1&&o(M,c,F,f,p),p&&A.length>0))break}return A}}},{importJSON:function(o){var u=s.importJSON(o,this);return u!==this?this.addChild(u):u},addChild:function(o){return this.insertChild(n,o)},insertChild:function(o,u){var c=u?this.insertChildren(o,[u]):null;return c&&c[0]},addChildren:function(o){return this.insertChildren(this._children.length,o)},insertChildren:function(o,u){var c=this._children;if(c&&u&&u.length>0){u=s.slice(u);for(var d={},f=u.length-1;f>=0;f--){var p=u[f],y=p&&p._id;!p||d[y]?u.splice(f,1):(p._remove(!1,!0),d[y]=!0)}s.splice(c,u,o,0);for(var _=this._project,w=_._changes,f=0,E=u.length;f<E;f++){var p=u[f],b=p._name;p._parent=this,p._setProject(_,!0),b&&p.setName(b),w&&p._changed(5)}this._changed(11)}else u=null;return u},_insertItem:"#insertChild",_insertAt:function(o,u){var c=o&&o._getOwner(),d=o!==this&&c?this:null;return d&&(d._remove(!1,!0),c._insertItem(o._index+u,d)),d},insertAbove:function(o){return this._insertAt(o,1)},insertBelow:function(o){return this._insertAt(o,0)},sendToBack:function(){var o=this._getOwner();return o?o._insertItem(0,this):null},bringToFront:function(){var o=this._getOwner();return o?o._insertItem(n,this):null},appendTop:"#addChild",appendBottom:function(o){return this.insertChild(0,o)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(o){return o._insertItem(n,this)},copyTo:function(o){return this.clone(!1).addTo(o)},reduce:function(o){var u=this._children;if(u&&u.length===1){var c=u[0].reduce(o);return this._parent?(c.insertAbove(this),this.remove()):c.remove(),c}return this},_removeNamed:function(){var o=this._getOwner();if(o){var u=o._children,c=o._namedChildren,d=this._name,f=c[d],p=f?f.indexOf(this):-1;p!==-1&&(u[d]==this&&delete u[d],f.splice(p,1),f.length?u[d]=f[0]:delete c[d])}},_remove:function(o,u){var c=this._getOwner(),d=this._project,f=this._index;return this._style&&this._style._dispose(),c?(this._name&&this._removeNamed(),f!=null&&(d._activeLayer===this&&(d._activeLayer=this.getNextSibling()||this.getPreviousSibling()),s.splice(c._children,null,f,1)),this._installEvents(!1),o&&d._changes&&this._changed(5),u&&c._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(o){var u=o&&o.insertBelow(this);return u&&this.remove(),u},removeChildren:function(o,u){if(!this._children)return null;o=o||0,u=s.pick(u,this._children.length);for(var c=s.splice(this._children,null,o,u-o),d=c.length-1;d>=0;d--)c[d]._remove(!0,!1);return c.length>0&&this._changed(11),c},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var o=0,u=this._children.length;o<u;o++)this._children[o]._index=o;this._changed(11)}},isEmpty:function(o){var u=this._children,c=u?u.length:0;if(o){for(var d=0;d<c;d++)if(!u[d].isEmpty(o))return!1;return!0}return!c},isEditable:function(){for(var o=this;o;){if(!o._visible||o._locked)return!1;o=o._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(o){function u(y){var _=[];do _.unshift(y);while(y=y._parent);return _}for(var c=u(this),d=u(o),f=0,p=Math.min(c.length,d.length);f<p;f++)if(c[f]!=d[f])return c[f]._index<d[f]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(o){return this._getOrder(o)===-1},isBelow:function(o){return this._getOrder(o)===1},isParent:function(o){return this._parent===o},isChild:function(o){return o&&o._parent===this},isDescendant:function(o){for(var u=this;u=u._parent;)if(u===o)return!0;return!1},isAncestor:function(o){return o?o.isDescendant(this):!1},isSibling:function(o){return this._parent===o._parent},isGroupedWith:function(o){for(var u=this._parent;u;){if(u._parent&&/^(Group|Layer|CompoundPath)$/.test(u._class)&&o.isDescendant(u))return!0;u=u._parent}return!1}},s.each(["rotate","scale","shear","skew"],function(o){var u=o==="rotate";this[o]=function(){var c=arguments,d=(u?s:S).read(c),f=S.read(c,0,{readNull:!0});return this.transform(new U()[o](d,f||this.getPosition(!0)))}},{translate:function(){var o=new U;return this.transform(o.translate.apply(o,arguments))},transform:function(o,u,c){var d=this._matrix,f=o&&!o.isIdentity(),p=c&&this._canApplyMatrix||this._applyMatrix&&(f||!d.isIdentity()||u&&this._children);if(!f&&!p)return this;if(f){!o.isInvertible()&&d.isInvertible()&&(d._backup=d.getValues()),d.prepend(o,!0);var y=this._style,_=y.getFillColor(!0),w=y.getStrokeColor(!0);_&&_.transform(o),w&&w.transform(o)}if(p&&(p=this._transformContent(d,u,c))){var E=this._pivot;E&&d._transformPoint(E,E,!0),d.reset(!0),c&&this._canApplyMatrix&&(this._applyMatrix=!0)}var b=this._bounds,A=this._position;(f||p)&&this._changed(25);var C=f&&b&&o.decompose();if(C&&C.skewing.isZero()&&C.rotation%90===0){for(var T in b){var k=b[T];if(k.nonscaling)delete b[T];else if(p||!k.internal){var M=k.rect;o._transformBounds(M,M)}}this._bounds=b;var F=b[this._getBoundsCacheKey(this._boundsOptions||{})];F&&(this._position=this._getPositionFromBounds(F.rect))}else f&&A&&this._pivot&&(this._position=o._transformPoint(A,A));return this},_transformContent:function(o,u,c){var d=this._children;if(d){for(var f=0,p=d.length;f<p;f++)d[f].transform(o,u,c);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(S.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(S.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(S.read(arguments))},localToParent:function(){return this._matrix._transformPoint(S.read(arguments))},fitBounds:function(o,u){o=V.read(arguments);var c=this.getBounds(),d=c.height/c.width,f=o.height/o.width,p=(u?d>f:d<f)?o.width/c.width:o.height/c.height,y=new V(new S,new z(c.width*p,c.height*p));y.setCenter(o.getCenter()),this.setBounds(y)}}),{_setStyles:function(o,u,c){var d=this._style,f=this._matrix;if(d.hasFill()&&(o.fillStyle=d.getFillColor().toCanvasStyle(o,f)),d.hasStroke()){o.strokeStyle=d.getStrokeColor().toCanvasStyle(o,f),o.lineWidth=d.getStrokeWidth();var p=d.getStrokeJoin(),y=d.getStrokeCap(),_=d.getMiterLimit();if(p&&(o.lineJoin=p),y&&(o.lineCap=y),_&&(o.miterLimit=_),de.support.nativeDash){var w=d.getDashArray(),E=d.getDashOffset();w&&w.length&&("setLineDash"in o?(o.setLineDash(w),o.lineDashOffset=E):(o.mozDash=w,o.mozDashOffset=E))}}if(d.hasShadow()){var b=u.pixelRatio||1,A=c._shiftless().prepend(new U().scale(b,b)),C=A.transform(new S(d.getShadowBlur(),0)),T=A.transform(this.getShadowOffset());o.shadowColor=d.getShadowColor().toCanvasStyle(o),o.shadowBlur=C.getLength(),o.shadowOffsetX=T.x,o.shadowOffsetY=T.y}},draw:function(o,u,c){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var d=u.matrices,f=u.viewMatrix,p=this._matrix,y=d[d.length-1].appended(p);if(y.isInvertible()){f=f?f.appended(y):y,d.push(y),u.updateMatrix&&(this._globalMatrix=y);var _=this._blendMode,w=v.clamp(this._opacity,0,1),E=_==="normal",b=ge.nativeModes[_],A=E&&w===1||u.dontStart||u.clip||(b||E&&w<1)&&this._canComposite(),C=u.pixelRatio||1,T,k,M;if(!A){var F=this.getStrokeBounds(f);if(!F.width||!F.height){d.pop();return}M=u.offset,k=u.offset=F.getTopLeft().floor(),T=o,o=ae.getContext(F.getSize().ceil().add(1).multiply(C)),C!==1&&o.scale(C,C)}o.save();var N=c?c.appended(p):this._canScaleStroke&&!this.getStrokeScaling(!0)&&f,D=!A&&u.clipItem,x=!N||D;if(A?(o.globalAlpha=w,b&&(o.globalCompositeOperation=_)):x&&o.translate(-k.x,-k.y),x&&(A?p:f).applyToContext(o),D&&u.clipItem.draw(o,u.extend({clip:!0})),N){o.setTransform(C,0,0,C,0,0);var P=u.offset;P&&o.translate(-P.x,-P.y)}this._draw(o,u,f,N),o.restore(),d.pop(),u.clip&&!u.dontFinish&&o.clip(this.getFillRule()),A||(ge.process(_,o,T,w,k.subtract(M).multiply(C)),ae.release(o),u.offset=M)}}},_isUpdated:function(o){var u=this._parent;if(u instanceof De)return u._isUpdated(o);var c=this._updateVersion===o;return!c&&u&&u._visible&&u._isUpdated(o)&&(this._updateVersion=o,c=!0),c},_drawSelection:function(o,u,c,d,f){var p=this._selection,y=p&1,_=p&2||y&&this._selectBounds,w=p&4;if(this._drawSelected||(y=!1),(y||_||w)&&this._isUpdated(f)){var E,b=this.getSelectedColor(!0)||(E=this.getLayer())&&E.getSelectedColor(!0),A=u.appended(this.getGlobalMatrix(!0)),C=c/2;if(o.strokeStyle=o.fillStyle=b?b.toCanvasStyle(o):"#009dec",y&&this._drawSelected(o,A,d),w){var T=this.getPosition(!0),k=this._parent,M=k?k.localToGlobal(T):T,F=M.x,N=M.y;o.beginPath(),o.arc(F,N,C,0,Math.PI*2,!0),o.stroke();for(var D=[[0,-1],[1,0],[0,1],[-1,0]],x=C,P=c+1,O=0;O<4;O++){var L=D[O],$=L[0],H=L[1];o.moveTo(F+$*x,N+H*x),o.lineTo(F+$*P,N+H*P),o.stroke()}}if(_){var q=A._transformCorners(this.getInternalBounds());o.beginPath();for(var O=0;O<8;O++)o[O?"lineTo":"moveTo"](q[O],q[++O]);o.closePath(),o.stroke();for(var O=0;O<8;O++)o.fillRect(q[O]-C,q[++O]-C,c,c)}}},_canComposite:function(){return!1}},s.each(["down","drag","up","move"],function(o){this["removeOn"+s.capitalize(o)]=function(){var u={};return u[o]=!0,this.removeOn(u)}},{removeOn:function(o){for(var u in o)if(o[u]){var c="mouse"+u,d=this._project,f=d._removeSets=d._removeSets||{};f[c]=f[c]||{},f[c][this._id]=this}return this}}),{tween:function(o,u,c){c||(c=u,u=o,o=null,c||(c=u,u=null));var d=c&&c.easing,f=c&&c.start,p=c!=null&&(typeof c=="number"?c:c.duration),y=new hu(this,o,u,p,d,f);function _(w){y._handleFrame(w.time*1e3),y.running||this.off("frame",_)}return p&&this.on("frame",_),y},tweenTo:function(o,u){return this.tween(null,o,u)},tweenFrom:function(o,u){return this.tween(o,null,u)}}),oe=te.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(u){this._children=[],this._namedChildren={},this._initialize(u)||this.addChildren(Array.isArray(u)?u:arguments)},_changed:function o(u){o.base.call(this,u),u&2050&&(this._clipItem=n)},_getClipItem:function(){var o=this._clipItem;if(o===n){o=null;for(var u=this._children,c=0,d=u.length;c<d;c++)if(u[c]._clipMask){o=u[c];break}this._clipItem=o}return o},isClipped:function(){return!!this._getClipItem()},setClipped:function(o){var u=this.getFirstChild();u&&u.setClipMask(o)},_getBounds:function o(u,c){var d=this._getClipItem();return d?d._getCachedBounds(d._matrix.prepended(u),s.set({},c,{stroke:!1})):o.base.call(this,u,c)},_hitTestChildren:function o(u,c,d){var f=this._getClipItem();return(!f||f.contains(u))&&o.base.call(this,u,c,d,f)},_draw:function(o,u){var c=u.clip,d=!c&&this._getClipItem();u=u.extend({clipItem:d,clip:!1}),c?(o.beginPath(),u.dontStart=u.dontFinish=!0):d&&d.draw(o,u.extend({clip:!0}));for(var f=this._children,p=0,y=f.length;p<y;p++){var _=f[p];_!==d&&_.draw(o,u)}}}),ce=oe.extend({_class:"Layer",initialize:function(){oe.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function o(){return this._parent?o.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),_e=te.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(u,c){this._initialize(u,c)},_equals:function(o){return this._type===o._type&&this._size.equals(o._size)&&s.equals(this._radius,o._radius)},copyContent:function(o){this.setType(o._type),this.setSize(o._size),this.setRadius(o._radius)},getType:function(){return this._type},setType:function(o){this._type=o},getShape:"#getType",setShape:"#setType",getSize:function(){var o=this._size;return new J(o.width,o.height,this,"setSize")},setSize:function(){var o=z.read(arguments);if(!this._size)this._size=o.clone();else if(!this._size.equals(o)){var u=this._type,c=o.width,d=o.height;u==="rectangle"?this._radius.set(z.min(this._radius,o.divide(2).abs())):u==="circle"?(c=d=(c+d)/2,this._radius=c/2):u==="ellipse"&&this._radius._set(c/2,d/2),this._size._set(c,d),this._changed(9)}},getRadius:function(){var o=this._radius;return this._type==="circle"?o:new J(o.width,o.height,this,"setRadius")},setRadius:function(o){var u=this._type;if(u==="circle"){if(o===this._radius)return;var c=o*2;this._radius=o,this._size._set(c,c)}else if(o=z.read(arguments),!this._radius)this._radius=o.clone();else{if(this._radius.equals(o))return;if(this._radius.set(o),u==="rectangle"){var c=z.max(this._size,o.multiply(2));this._size.set(c)}else u==="ellipse"&&this._size._set(o.width*2,o.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(o){var u=new ye[s.capitalize(this._type)]({center:new S,size:this._size,radius:this._radius,insert:!1});return u.copyAttributes(this),de.settings.applyMatrix&&u.setApplyMatrix(!0),(o===n||o)&&u.insertAbove(this),u},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(o,u,c,d){var f=this._style,p=f.hasFill(),y=f.hasStroke(),_=u.dontFinish||u.clip,w=!d;if(p||y||_){var E=this._type,b=this._radius,A=E==="circle";if(u.dontStart||o.beginPath(),w&&A)o.arc(0,0,b,0,Math.PI*2,!0);else{var C=A?b:b.width,T=A?b:b.height,k=this._size,M=k.width,F=k.height;if(w&&E==="rectangle"&&C===0&&T===0)o.rect(-M/2,-F/2,M,F);else{var N=M/2,D=F/2,x=1-.5522847498307936,P=C*x,O=T*x,L=[-N,-D+T,-N,-D+O,-N+P,-D,-N+C,-D,N-C,-D,N-P,-D,N,-D+O,N,-D+T,N,D-T,N,D-O,N-P,D,N-C,D,-N+C,D,-N+P,D,-N,D-O,-N,D-T];d&&d.transform(L,L,32),o.moveTo(L[0],L[1]),o.bezierCurveTo(L[2],L[3],L[4],L[5],L[6],L[7]),N!==C&&o.lineTo(L[8],L[9]),o.bezierCurveTo(L[10],L[11],L[12],L[13],L[14],L[15]),D!==T&&o.lineTo(L[16],L[17]),o.bezierCurveTo(L[18],L[19],L[20],L[21],L[22],L[23]),N!==C&&o.lineTo(L[24],L[25]),o.bezierCurveTo(L[26],L[27],L[28],L[29],L[30],L[31])}}o.closePath()}!_&&(p||y)&&(this._setStyles(o,u,c),p&&(o.fill(f.getFillRule()),o.shadowColor="rgba(0,0,0,0)"),y&&o.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(o,u){var c=new V(this._size).setCenter(0,0),d=this._style,f=u.stroke&&d.hasStroke()&&d.getStrokeWidth();return o&&(c=o._transformBounds(c)),f?c.expand(ye._getStrokePadding(f,this._getStrokeMatrix(o,u))):c}},new function(){function o(c,d,f){var p=c._radius;if(!p.isZero())for(var y=c._size.divide(2),_=1;_<=4;_++){var w=new S(_>1&&_<4?-1:1,_>2?-1:1),E=w.multiply(y),b=E.subtract(w.multiply(p)),A=new V(f?E.add(w.multiply(f)):E,b);if(A.contains(d))return{point:b,quadrant:_}}}function u(c,d,f,p){var y=c.divide(d);return(!p||y.isInQuadrant(p))&&y.subtract(y.normalize()).multiply(d).divide(f).length<=1}return{_contains:function c(d){if(this._type==="rectangle"){var f=o(this,d);return f?d.subtract(f.point).divide(this._radius).getLength()<=1:c.base.call(this,d)}else return d.divide(this.size).getLength()<=.5},_hitTestSelf:function c(d,f,p,y){var _=!1,w=this._style,E=f.stroke&&w.hasStroke(),b=f.fill&&w.hasFill();if(E||b){var A=this._type,C=this._radius,T=E?w.getStrokeWidth()/2:0,k=f._tolerancePadding.add(ye._getStrokePadding(T,!w.getStrokeScaling()&&y));if(A==="rectangle"){var M=k.multiply(2),F=o(this,d,M);if(F)_=u(d.subtract(F.point),C,k,F.quadrant);else{var N=new V(this._size).setCenter(0,0),D=N.expand(M),x=N.expand(M.negate());_=D._containsPoint(d)&&!x._containsPoint(d)}}else _=u(d,C,k)}return _?new Me(E?"stroke":"fill",this):c.base.apply(this,arguments)}}},{statics:new function(){function o(u,c,d,f,p){var y=s.create(_e.prototype);return y._type=u,y._size=d,y._radius=f,y._initialize(s.getNamed(p),c),y}return{Circle:function(){var u=arguments,c=S.readNamed(u,"center"),d=s.readNamed(u,"radius");return o("circle",c,new z(d*2),d,u)},Rectangle:function(){var u=arguments,c=V.readNamed(u,"rectangle"),d=z.min(z.readNamed(u,"radius"),c.getSize(!0).divide(2));return o("rectangle",c.getCenter(!0),c.getSize(!0),d,u)},Ellipse:function(){var u=arguments,c=_e._readEllipse(u),d=c.radius;return o("ellipse",c.center,d.multiply(2),d,u)},_readEllipse:function(u){var c,d;if(s.hasNamed(u,"radius"))c=S.readNamed(u,"center"),d=z.readNamed(u,"radius");else{var f=V.readNamed(u,"rectangle");c=f.getCenter(!0),d=f.getSize(!0).divide(2)}return{center:c,radius:d}}}}}),pe=te.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(u,c){if(!this._initialize(u,c!==n&&S.read(arguments))){var d,f=typeof u,p=f==="string"?i.getElementById(u):f==="object"?u:null;if(p&&p!==te.NO_INSERT){if(p.getContext||p.naturalHeight!=null)d=p;else if(p){var y=z.read(arguments);y.isZero()||(d=ae.getCanvas(y))}}d?this.setImage(d):this.setSource(u)}this._size||(this._size=new z,this._loaded=!1)},_equals:function(o){return this.getSource()===o.getSource()},copyContent:function(o){var u=o._image,c=o._canvas;if(u)this._setImage(u);else if(c){var d=ae.getCanvas(o._size);d.getContext("2d").drawImage(c,0,0),this._setImage(d)}this._crossOrigin=o._crossOrigin},getSize:function(){var o=this._size;return new J(o?o.width:0,o?o.height:0,this,"setSize")},setSize:function(o,u){var c=z.read(arguments);if(c.equals(this._size))u&&this.clear();else if(c.width>0&&c.height>0){var d=!u&&this.getElement();this._setImage(ae.getCanvas(c)),d&&this.getContext(!0).drawImage(d,0,0,c.width,c.height)}else this._canvas&&ae.release(this._canvas),this._size=c.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(o){this.setSize(o,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(o){this.setSize(this.getWidth(),o)},getLoaded:function(){return this._loaded},isEmpty:function(){var o=this._size;return!o||o.width===0&&o.height===0},getResolution:function(){var o=this._matrix,u=new S(0,0).transform(o),c=new S(1,0).transform(o).subtract(u),d=new S(0,1).transform(o).subtract(u);return new z(72/c.getLength(),72/d.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(o){var u=this;function c(d){var f=u.getView(),p=d&&d.type||"load";f&&u.responds(p)&&(de=f._scope,u.emit(p,new Er(d)))}this._setImage(o),this._loaded?setTimeout(c,0):o&&zt.add(o,{load:function(d){u._setImage(o),c(d)},error:c})},_setImage:function(o){this._canvas&&ae.release(this._canvas),o&&o.getContext?(this._image=null,this._canvas=o,this._loaded=!0):(this._image=o,this._canvas=null,this._loaded=!!(o&&o.src&&o.complete)),this._size=new z(o?o.naturalWidth||o.width:0,o?o.naturalHeight||o.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var o=ae.getContext(this._size);try{this._image&&o.drawImage(this._image,0,0),this._canvas=o.canvas}catch{ae.release(o)}}return this._canvas},setCanvas:"#setImage",getContext:function(o){return this._context||(this._context=this.getCanvas().getContext("2d")),o&&(this._image=null,this._changed(1025)),this._context},setContext:function(o){this._context=o},getSource:function(){var o=this._image;return o&&o.src||this.toDataURL()},setSource:function(o){var u=new e.Image,c=this._crossOrigin;c&&(u.crossOrigin=c),o&&(u.src=o),this.setImage(u)},getCrossOrigin:function(){var o=this._image;return o&&o.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(o){this._crossOrigin=o;var u=this._image;u&&(u.crossOrigin=o)},getSmoothing:function(){return this._smoothing},setSmoothing:function(o){this._smoothing=typeof o=="string"?o:o?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var o=V.read(arguments),u=ae.getContext(o.getSize());return u.drawImage(this.getCanvas(),o.x,o.y,o.width,o.height,0,0,o.width,o.height),u.canvas},getSubRaster:function(){var o=V.read(arguments),u=new pe(te.NO_INSERT);return u._setImage(this.getSubCanvas(o)),u.translate(o.getCenter().subtract(this.getSize().divide(2))),u._matrix.prepend(this._matrix),u.insertAbove(this),u},toDataURL:function(){var o=this._image,u=o&&o.src;if(/^data:/.test(u))return u;var c=this.getCanvas();return c?c.toDataURL.apply(c,arguments):null},drawImage:function(o){var u=S.read(arguments,1);this.getContext(!0).drawImage(o,u.x,u.y)},getAverageColor:function(o){var u,c;if(o?o instanceof xe?(c=o,u=o.getBounds()):typeof o=="object"&&("width"in o?u=new V(o):"x"in o&&(u=new V(o.x-.5,o.y-.5,1,1))):u=this.getBounds(),!u)return null;var d=32,f=Math.min(u.width,d),p=Math.min(u.height,d),y=pe._sampleContext;y?y.clearRect(0,0,d+1,d+1):y=pe._sampleContext=ae.getContext(new z(d)),y.save();var _=new U().scale(f/u.width,p/u.height).translate(-u.x,-u.y);_.applyToContext(y),c&&c.draw(y,new s({clip:!0,matrices:[_]})),this._matrix.applyToContext(y);var w=this.getElement(),E=this._size;w&&y.drawImage(w,-E.width/2,-E.height/2),y.restore();for(var b=y.getImageData(.5,.5,Math.ceil(f),Math.ceil(p)).data,A=[0,0,0],C=0,T=0,k=b.length;T<k;T+=4){var M=b[T+3];C+=M,M/=255,A[0]+=b[T]*M,A[1]+=b[T+1]*M,A[2]+=b[T+2]*M}for(var T=0;T<3;T++)A[T]/=C;return C?yt.read(A):null},getPixel:function(){var o=S.read(arguments),u=this.getContext().getImageData(o.x,o.y,1,1).data;return new yt("rgb",[u[0]/255,u[1]/255,u[2]/255],u[3]/255)},setPixel:function(){var o=arguments,u=S.read(o),c=yt.read(o),d=c._convert("rgb"),f=c._alpha,p=this.getContext(!0),y=p.createImageData(1,1),_=y.data;_[0]=d[0]*255,_[1]=d[1]*255,_[2]=d[2]*255,_[3]=f!=null?f*255:255,p.putImageData(y,u.x,u.y)},clear:function(){var o=this._size;this.getContext(!0).clearRect(0,0,o.width+1,o.height+1)},createImageData:function(){var o=z.read(arguments);return this.getContext().createImageData(o.width,o.height)},getImageData:function(){var o=V.read(arguments);return o.isEmpty()&&(o=new V(this._size)),this.getContext().getImageData(o.x,o.y,o.width,o.height)},putImageData:function(o){var u=S.read(arguments,1);this.getContext(!0).putImageData(o,u.x,u.y)},setImageData:function(o){this.setSize(o),this.getContext(!0).putImageData(o,0,0)},_getBounds:function(o,u){var c=new V(this._size).setCenter(0,0);return o?o._transformBounds(c):c},_hitTestSelf:function(o){if(this._contains(o)){var u=this;return new Me("pixel",u,{offset:o.add(u._size.divide(2)).round(),color:{get:function(){return u.getPixel(this.offset)}}})}},_draw:function(o,u,c){var d=this.getElement();if(d&&d.width>0&&d.height>0){o.globalAlpha=v.clamp(this._opacity,0,1),this._setStyles(o,u,c);var f=this._smoothing,p=f==="off";bt.setPrefixed(o,p?"imageSmoothingEnabled":"imageSmoothingQuality",p?!1:f),o.drawImage(d,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Ye=te.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(u,c){this._initialize(u,c!==n&&S.read(arguments,1))||this.setDefinition(u instanceof be?u:new be(u))},_equals:function(o){return this._definition===o._definition},copyContent:function(o){this.setDefinition(o._definition)},getDefinition:function(){return this._definition},setDefinition:function(o){this._definition=o,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(o,u){var c=this._definition._item;return c._getCachedBounds(c._matrix.prepended(o),u)},_hitTestSelf:function(o,u,c){var d=u.extend({all:!1}),f=this._definition._item._hitTest(o,d,c);return f&&(f.item=this),f},_draw:function(o,u){this._definition._item.draw(o,u)}}),be=s.extend({_class:"SymbolDefinition",initialize:function(u,c){this._id=I.get(),this.project=de.project,u&&this.setItem(u,c)},_serialize:function(o,u){return u.add(this,function(){return s.serialize([this._class,this._item],o,!1,u)})},_changed:function(o){o&8&&te._clearBoundsCache(this),o&1&&this.project._changed(o)},getItem:function(){return this._item},setItem:function(o,u){o._symbol&&(o=o.clone()),this._item&&(this._item._symbol=null),this._item=o,o.remove(),o.setSelected(!1),u||o.setPosition(new S),o._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(o){return new Ye(this,o)},clone:function(){return new be(this._item.clone(!1))},equals:function(o){return o===this||o&&this._item.equals(o._item)||!1}}),Me=s.extend({_class:"HitResult",initialize:function(u,c,d){this.type=u,this.item=c,d&&this.inject(d)},statics:{getOptions:function(o){var u=o&&s.read(o);return new s({type:null,tolerance:de.settings.hitTolerance,fill:!u,stroke:!u,segments:!u,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},u)}}}),Se=s.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(u,c,d,f,p,y){var _=arguments.length,w,E,b,A;_>0&&(u==null||typeof u=="object"?_===1&&u&&"point"in u?(w=u.point,E=u.handleIn,b=u.handleOut,A=u.selection):(w=u,E=c,b=d,A=f):(w=[u,c],E=d!==n?[d,f]:null,b=p!==n?[p,y]:null)),new je(w,this,"_point"),new je(E,this,"_handleIn"),new je(b,this,"_handleOut"),A&&this.setSelection(A)},_serialize:function(o,u){var c=this._point,d=this._selection,f=d||this.hasHandles()?[c,this._handleIn,this._handleOut]:c;return d&&f.push(d),s.serialize(f,o,!0,u)},_changed:function(o){var u=this._path;if(u){var c=u._curves,d=this._index,f;c&&((!o||o===this._point||o===this._handleIn)&&(f=d>0?c[d-1]:u._closed?c[c.length-1]:null)&&f._changed(),(!o||o===this._point||o===this._handleOut)&&(f=c[d])&&f._changed()),u._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(S.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(S.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(S.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var o=this._handleIn,u=this._handleOut;return!o.isZero()&&!u.isZero()&&o.isCollinear(u)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(o){var u=this._selection,c=this._path;this._selection=o=o||0,c&&o!==u&&(c._updateSelection(this,u,o),c._changed(257))},_changeSelection:function(o,u){var c=this._selection;this.setSelection(u?c|o:c&~o)},isSelected:function(){return!!(this._selection&7)},setSelected:function(o){this._changeSelection(7,o)},getIndex:function(){return this._index!==n?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var o=this._path,u=this._index;return o?(u>0&&!o._closed&&u===o._segments.length-1&&u--,o.getCurves()[u]||null):null},getLocation:function(){var o=this.getCurve();return o?new rt(o,this===o._segment1?0:1):null},getNext:function(){var o=this._path&&this._path._segments;return o&&(o[this._index+1]||this._path._closed&&o[0])||null},smooth:function(o,u,c){var d=o||{},f=d.type,p=d.factor,y=this.getPrevious(),_=this.getNext(),w=(y||this)._point,E=this._point,b=(_||this)._point,A=w.getDistance(E),C=E.getDistance(b);if(!f||f==="catmull-rom"){var T=p===n?.5:p,k=Math.pow(A,T),M=k*k,F=Math.pow(C,T),N=F*F;if(!u&&y){var D=2*N+3*F*k+M,x=3*F*(F+k);this.setHandleIn(x!==0?new S((N*w._x+D*E._x-M*b._x)/x-E._x,(N*w._y+D*E._y-M*b._y)/x-E._y):new S)}if(!c&&_){var D=2*M+3*k*F+N,x=3*k*(k+F);this.setHandleOut(x!==0?new S((M*b._x+D*E._x-N*w._x)/x-E._x,(M*b._y+D*E._y-N*w._y)/x-E._y):new S)}}else if(f==="geometric"){if(y&&_){var P=w.subtract(b),O=p===n?.4:p,L=O*A/(A+C);u||this.setHandleIn(P.multiply(L)),c||this.setHandleOut(P.multiply(L-O))}}else throw new Error("Smoothing method '"+f+"' not supported.")},getPrevious:function(){var o=this._path&&this._path._segments;return o&&(o[this._index-1]||this._path._closed&&o[o.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var o=this._path;return o&&this._index===o._segments.length-1||!1},reverse:function(){var o=this._handleIn,u=this._handleOut,c=o.clone();o.set(u),u.set(c)},reversed:function(){return new Se(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Se(this._point,this._handleIn,this._handleOut)},equals:function(o){return o===this||o&&this._class===o._class&&this._point.equals(o._point)&&this._handleIn.equals(o._handleIn)&&this._handleOut.equals(o._handleOut)||!1},toString:function(){var o=["point: "+this._point];return this._handleIn.isZero()||o.push("handleIn: "+this._handleIn),this._handleOut.isZero()||o.push("handleOut: "+this._handleOut),"{ "+o.join(", ")+" }"},transform:function(o){this._transformCoordinates(o,new Array(6),!0),this._changed()},interpolate:function(o,u,c){var d=1-c,f=c,p=o._point,y=u._point,_=o._handleIn,w=u._handleIn,E=u._handleOut,b=o._handleOut;this._point._set(d*p._x+f*y._x,d*p._y+f*y._y,!0),this._handleIn._set(d*_._x+f*w._x,d*_._y+f*w._y,!0),this._handleOut._set(d*b._x+f*E._x,d*b._y+f*E._y,!0),this._changed()},_transformCoordinates:function(o,u,c){var d=this._point,f=!c||!this._handleIn.isZero()?this._handleIn:null,p=!c||!this._handleOut.isZero()?this._handleOut:null,y=d._x,_=d._y,w=2;return u[0]=y,u[1]=_,f&&(u[w++]=f._x+y,u[w++]=f._y+_),p&&(u[w++]=p._x+y,u[w++]=p._y+_),o&&(o._transformCoordinates(u,u,w/2),y=u[0],_=u[1],c?(d._x=y,d._y=_,w=2,f&&(f._x=u[w++]-y,f._y=u[w++]-_),p&&(p._x=u[w++]-y,p._y=u[w++]-_)):(f||(u[w++]=y,u[w++]=_),p||(u[w++]=y,u[w++]=_))),u}}),je=S.extend({initialize:function(u,c,d){var f,p,y;if(!u)f=p=0;else if((f=u[0])!==n)p=u[1];else{var _=u;(f=_.x)===n&&(_=S.read(arguments),f=_.x),p=_.y,y=_.selected}this._x=f,this._y=p,this._owner=c,c[d]=this,y&&this.setSelected(!0)},_set:function(o,u){return this._x=o,this._y=u,this._owner._changed(this),this},getX:function(){return this._x},setX:function(o){this._x=o,this._owner._changed(this)},getY:function(){return this._y},setY:function(o){this._y=o,this._owner._changed(this)},isZero:function(){var o=v.isZero;return o(this._x)&&o(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(o){this._owner._changeSelection(this._getSelection(),o)},_getSelection:function(){var o=this._owner;return this===o._point?1:this===o._handleIn?2:this===o._handleOut?4:0}}),he=s.extend({_class:"Curve",beans:!0,initialize:function(u,c,d,f,p,y,_,w){var E=arguments.length,b,A,C,T,k,M;E===3?(this._path=u,b=c,A=d):E?E===1?"segment1"in u?(b=new Se(u.segment1),A=new Se(u.segment2)):"point1"in u?(C=u.point1,k=u.handle1,M=u.handle2,T=u.point2):Array.isArray(u)&&(C=[u[0],u[1]],T=[u[6],u[7]],k=[u[2]-u[0],u[3]-u[1]],M=[u[4]-u[6],u[5]-u[7]]):E===2?(b=new Se(u),A=new Se(c)):E===4?(C=u,k=c,M=d,T=f):E===8&&(C=[u,c],T=[_,w],k=[d-u,f-c],M=[p-_,y-w]):(b=new Se,A=new Se),this._segment1=b||new Se(C,null,k),this._segment2=A||new Se(T,M,null)},_serialize:function(o,u){return s.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],o,!0,u)},_changed:function(){this._length=this._bounds=n},clone:function(){return new he(this._segment1,this._segment2)},toString:function(){var o=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||o.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||o.push("handle2: "+this._segment2._handleIn),o.push("point2: "+this._segment2._point),"{ "+o.join(", ")+" }"},classify:function(){return he.classify(this.getValues())},remove:function(){var o=!1;if(this._path){var u=this._segment2,c=u._handleOut;o=u.remove(),o&&this._segment1._handleOut.set(c)}return o},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(S.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(S.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(S.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(S.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var o=this._path&&this._path._curves;return o&&(o[this._segment1._index+1]||this._path._closed&&o[0])||null},getPrevious:function(){var o=this._path&&this._path._curves;return o&&(o[this._segment1._index-1]||this._path._closed&&o[o.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var o=this._path;return o&&this._segment1._index===o._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(o){this.getPoint1().setSelected(o),this.getHandle1().setSelected(o),this.getHandle2().setSelected(o),this.getPoint2().setSelected(o)},getValues:function(o){return he.getValues(this._segment1,this._segment2,o)},getPoints:function(){for(var o=this.getValues(),u=[],c=0;c<8;c+=2)u.push(new S(o[c],o[c+1]));return u}},{getLength:function(){return this._length==null&&(this._length=he.getLength(this.getValues(),0,1)),this._length},getArea:function(){return he.getArea(this.getValues())},getLine:function(){return new Z(this._segment1._point,this._segment2._point)},getPart:function(o,u){return new he(he.getPart(this.getValues(),o,u))},getPartLength:function(o,u){return he.getLength(this.getValues(),o,u)},divideAt:function(o){return this.divideAtTime(o&&o.curve===this?o.time:this.getTimeAt(o))},divideAtTime:function(o,u){var c=1e-8,d=1-c,f=null;if(o>=c&&o<=d){var p=he.subdivide(this.getValues(),o),y=p[0],_=p[1],w=u||this.hasHandles(),E=this._segment1,b=this._segment2,A=this._path;w&&(E._handleOut._set(y[2]-y[0],y[3]-y[1]),b._handleIn._set(_[4]-_[6],_[5]-_[7]));var C=y[6],T=y[7],k=new Se(new S(C,T),w&&new S(y[4]-C,y[5]-T),w&&new S(_[2]-C,_[3]-T));A?(A.insert(E._index+1,k),f=this.getNext()):(this._segment2=k,this._changed(),f=new he(k,b))}return f},splitAt:function(o){var u=this._path;return u?u.splitAt(o):null},splitAtTime:function(o){return this.splitAt(this.getLocationAtTime(o))},divide:function(o,u){return this.divideAtTime(o===n?.5:u?o:this.getTimeAt(o))},split:function(o,u){return this.splitAtTime(o===n?.5:u?o:this.getTimeAt(o))},reversed:function(){return new he(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(o,u,c,d){var f=o._point,p=o._handleOut,y=u._handleIn,_=u._point,w=f.x,E=f.y,b=_.x,A=_.y,C=d?[w,E,w,E,b,A,b,A]:[w,E,w+p._x,E+p._y,b+y._x,A+y._y,b,A];return c&&c._transformCoordinates(C,C,4),C},subdivide:function(o,u){var c=o[0],d=o[1],f=o[2],p=o[3],y=o[4],_=o[5],w=o[6],E=o[7];u===n&&(u=.5);var b=1-u,A=b*c+u*f,C=b*d+u*p,T=b*f+u*y,k=b*p+u*_,M=b*y+u*w,F=b*_+u*E,N=b*A+u*T,D=b*C+u*k,x=b*T+u*M,P=b*k+u*F,O=b*N+u*x,L=b*D+u*P;return[[c,d,A,C,N,D,O,L],[O,L,x,P,M,F,w,E]]},getMonoCurves:function(o,u){var c=[],d=u?0:1,f=o[d+0],p=o[d+2],y=o[d+4],_=o[d+6];if(f>=p==p>=y&&p>=y==y>=_||he.isStraight(o))c.push(o);else{var w=3*(p-y)-f+_,E=2*(f+y)-4*p,b=p-f,A=1e-8,C=1-A,T=[],k=v.solveQuadratic(w,E,b,T,A,C);if(!k)c.push(o);else{T.sort();var M=T[0],F=he.subdivide(o,M);c.push(F[0]),k>1&&(M=(T[1]-M)/(1-M),F=he.subdivide(F[1],M),c.push(F[0])),c.push(F[1])}}return c},solveCubic:function(o,u,c,d,f,p){var y=o[u],_=o[u+2],w=o[u+4],E=o[u+6],b=0;if(!(y<c&&E<c&&_<c&&w<c||y>c&&E>c&&_>c&&w>c)){var A=3*(_-y),C=3*(w-_)-A,T=E-y-A-C;b=v.solveCubic(T,C,A,y-c,d,f,p)}return b},getTimeOf:function(o,u){var c=new S(o[0],o[1]),d=new S(o[6],o[7]),f=1e-12,p=1e-7,y=u.isClose(c,f)?0:u.isClose(d,f)?1:null;if(y===null)for(var _=[u.x,u.y],w=[],E=0;E<2;E++)for(var b=he.solveCubic(o,E,_[E],w,0,1),A=0;A<b;A++){var C=w[A];if(u.isClose(he.getPoint(o,C),p))return C}return u.isClose(c,p)?0:u.isClose(d,p)?1:null},getNearestTime:function(o,u){if(he.isStraight(o)){var c=o[0],d=o[1],f=o[6],p=o[7],y=f-c,_=p-d,w=y*y+_*_;if(w===0)return 0;var E=((u.x-c)*y+(u.y-d)*_)/w;return E<1e-12?0:E>.999999999999?1:he.getTimeOf(o,new S(c+E*y,d+E*_))}var b=100,A=1/0,C=0;function T(F){if(F>=0&&F<=1){var N=u.getDistance(he.getPoint(o,F),!0);if(N<A)return A=N,C=F,!0}}for(var k=0;k<=b;k++)T(k/b);for(var M=1/(b*2);M>1e-8;)!T(C-M)&&!T(C+M)&&(M/=2);return C},getPart:function(o,u,c){var d=u>c;if(d){var f=u;u=c,c=f}return u>0&&(o=he.subdivide(o,u)[1]),c<1&&(o=he.subdivide(o,(c-u)/(1-u))[0]),d?[o[6],o[7],o[4],o[5],o[2],o[3],o[0],o[1]]:o},isFlatEnough:function(o,u){var c=o[0],d=o[1],f=o[2],p=o[3],y=o[4],_=o[5],w=o[6],E=o[7],b=3*f-2*c-w,A=3*p-2*d-E,C=3*y-2*w-c,T=3*_-2*E-d;return Math.max(b*b,C*C)+Math.max(A*A,T*T)<=16*u*u},getArea:function(o){var u=o[0],c=o[1],d=o[2],f=o[3],p=o[4],y=o[5],_=o[6],w=o[7];return 3*((w-c)*(d+p)-(_-u)*(f+y)+f*(u-p)-d*(c-y)+w*(p+u/3)-_*(y+c/3))/20},getBounds:function(o){for(var u=o.slice(0,2),c=u.slice(),d=[0,0],f=0;f<2;f++)he._addBounds(o[f],o[f+2],o[f+4],o[f+6],f,0,u,c,d);return new V(u[0],u[1],c[0]-u[0],c[1]-u[1])},_addBounds:function(o,u,c,d,f,p,y,_,w){function E(O,L){var $=O-L,H=O+L;$<y[f]&&(y[f]=$),H>_[f]&&(_[f]=H)}p/=2;var b=y[f]+p,A=_[f]-p;if(o<b||u<b||c<b||d<b||o>A||u>A||c>A||d>A)if(u<o!=u<d&&c<o!=c<d)E(o,0),E(d,0);else{var C=3*(u-c)-o+d,T=2*(o+c)-4*u,k=u-o,M=v.solveQuadratic(C,T,k,w),F=1e-8,N=1-F;E(d,0);for(var D=0;D<M;D++){var x=w[D],P=1-x;F<=x&&x<=N&&E(P*P*P*o+3*P*P*x*u+3*P*x*x*c+x*x*x*d,p)}}}}},s.each(["getBounds","getStrokeBounds","getHandleBounds"],function(o){this[o]=function(){this._bounds||(this._bounds={});var u=this._bounds[o];return u||(u=this._bounds[o]=ye[o]([this._segment1,this._segment2],!1,this._path)),u.clone()}},{}),s.each({isStraight:function(o,u,c,d){if(u.isZero()&&c.isZero())return!0;var f=d.subtract(o);if(f.isZero())return!1;if(f.isCollinear(u)&&f.isCollinear(c)){var p=new Z(o,d),y=1e-7;if(p.getDistance(o.add(u))<y&&p.getDistance(d.add(c))<y){var _=f.dot(f),w=f.dot(u)/_,E=f.dot(c)/_;return w>=0&&w<=1&&E<=0&&E>=-1}}return!1},isLinear:function(o,u,c,d){var f=d.subtract(o).divide(3);return u.equals(f)&&c.negate().equals(f)}},function(o,u){this[u]=function(c){var d=this._segment1,f=this._segment2;return o(d._point,d._handleOut,f._handleIn,f._point,c)},this.statics[u]=function(c,d){var f=c[0],p=c[1],y=c[6],_=c[7];return o(new S(f,p),new S(c[2]-f,c[3]-p),new S(c[4]-y,c[5]-_),new S(y,_),d)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(o){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(o||0)},isCollinear:function(o){return o&&this.isStraight()&&o.isStraight()&&this.getLine().isCollinear(o.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(o,u){return this.getLocationAtTime(u?o:this.getTimeAt(o))},getLocationAtTime:function(o){return o!=null&&o>=0&&o<=1?new rt(this,o):null},getTimeAt:function(o,u){return he.getTimeAt(this.getValues(),o,u)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var o=S.read(arguments);return o.isZero()?[]:he.getTimesWithTangent(this.getValues(),o)},getOffsetAtTime:function(o){return this.getPartLength(0,o)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(S.read(arguments)))},getOffsetOf:function(){var o=this.getLocationOf.apply(this,arguments);return o?o.getOffset():null},getTimeOf:function(){return he.getTimeOf(this.getValues(),S.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var o=S.read(arguments),u=this.getValues(),c=he.getNearestTime(u,o),d=he.getPoint(u,c);return new rt(this,c,d,null,o.getDistance(d))},getNearestPoint:function(){var o=this.getNearestLocation.apply(this,arguments);return o&&o.getPoint()}},new function(){var o=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return s.each(o,function(u){this[u+"At"]=function(c,d){var f=this.getValues();return he[u](f,d?c:he.getTimeAt(f,c))},this[u+"AtTime"]=function(c){return he[u](this.getValues(),c)}},{statics:{_evaluateMethods:o}})},new function(){function o(d){var f=d[0],p=d[1],y=d[2],_=d[3],w=d[4],E=d[5],b=d[6],A=d[7],C=9*(y-w)+3*(b-f),T=6*(f+w)-12*y,k=3*(y-f),M=9*(_-E)+3*(A-p),F=6*(p+E)-12*_,N=3*(_-p);return function(D){var x=(C*D+T)*D+k,P=(M*D+F)*D+N;return Math.sqrt(x*x+P*P)}}function u(d,f){return Math.max(2,Math.min(16,Math.ceil(Math.abs(f-d)*32)))}function c(d,f,p,y){if(f==null||f<0||f>1)return null;var _=d[0],w=d[1],E=d[2],b=d[3],A=d[4],C=d[5],T=d[6],k=d[7],M=v.isZero;M(E-_)&&M(b-w)&&(E=_,b=w),M(A-T)&&M(C-k)&&(A=T,C=k);var F=3*(E-_),N=3*(A-E)-F,D=T-_-F-N,x=3*(b-w),P=3*(C-b)-x,O=k-w-x-P,L,$;if(p===0)L=f===0?_:f===1?T:((D*f+N)*f+F)*f+_,$=f===0?w:f===1?k:((O*f+P)*f+x)*f+w;else{var H=1e-8,q=1-H;if(f<H?(L=F,$=x):f>q?(L=3*(T-A),$=3*(k-C)):(L=(3*D*f+2*N)*f+F,$=(3*O*f+2*P)*f+x),y){L===0&&$===0&&(f<H||f>q)&&(L=A-E,$=C-b);var W=Math.sqrt(L*L+$*$);W&&(L/=W,$/=W)}if(p===3){var A=6*D*f+2*N,C=6*O*f+2*P,Q=Math.pow(L*L+$*$,3/2);L=Q!==0?(L*C-$*A)/Q:0,$=0}}return p===2?new S($,-L):new S(L,$)}return{statics:{classify:function(d){var f=d[0],p=d[1],y=d[2],_=d[3],w=d[4],E=d[5],b=d[6],A=d[7],C=f*(A-E)+p*(w-b)+b*E-A*w,T=y*(p-A)+_*(b-f)+f*A-p*b,k=w*(_-p)+E*(f-y)+y*p-_*f,M=3*k,F=M-T,N=F-T+C,D=Math.sqrt(N*N+F*F+M*M),x=D!==0?1/D:0,P=v.isZero,O="serpentine";N*=x,F*=x,M*=x;function L(W,Q,K){var Y=Q!==n,ee=Y&&Q>0&&Q<1,re=Y&&K>0&&K<1;return Y&&(!(ee||re)||W==="loop"&&!(ee&&re))&&(W="arch",ee=re=!1),{type:W,roots:ee||re?ee&&re?Q<K?[Q,K]:[K,Q]:[ee?Q:K]:null}}if(P(N))return P(F)?L(P(M)?"line":"quadratic"):L(O,M/(3*F));var $=3*F*F-4*N*M;if(P($))return L("cusp",F/(2*N));var H=$>0?Math.sqrt($/3):Math.sqrt(-$),q=2*N;return L($>0?O:"loop",(F+H)/q,(F-H)/q)},getLength:function(d,f,p,y){if(f===n&&(f=0),p===n&&(p=1),he.isStraight(d)){var _=d;p<1&&(_=he.subdivide(_,p)[0],f/=p),f>0&&(_=he.subdivide(_,f)[1]);var w=_[6]-_[0],E=_[7]-_[1];return Math.sqrt(w*w+E*E)}return v.integrate(y||o(d),f,p,u(f,p))},getTimeAt:function(d,f,p){if(p===n&&(p=f<0?1:0),f===0)return p;var y=Math.abs,_=1e-12,w=f>0,E=w?p:0,b=w?1:p,A=o(d),C=he.getLength(d,E,b,A),T=y(f)-C;if(y(T)<_)return w?b:E;if(T>_)return null;var k=f/C,M=0;function F(N){return M+=v.integrate(A,p,N,u(p,N)),p=N,M-f}return v.findRoot(F,A,p+k,E,b,32,1e-12)},getPoint:function(d,f){return c(d,f,0,!1)},getTangent:function(d,f){return c(d,f,1,!0)},getWeightedTangent:function(d,f){return c(d,f,1,!1)},getNormal:function(d,f){return c(d,f,2,!0)},getWeightedNormal:function(d,f){return c(d,f,2,!1)},getCurvature:function(d,f){return c(d,f,3,!1).x},getPeaks:function(d){var f=d[0],p=d[1],y=d[2],_=d[3],w=d[4],E=d[5],b=d[6],A=d[7],C=-f+3*y-3*w+b,T=3*f-6*y+3*w,k=-3*f+3*y,M=-p+3*_-3*E+A,F=3*p-6*_+3*E,N=-3*p+3*_,D=1e-8,x=1-D,P=[];return v.solveCubic(9*(C*C+M*M),9*(C*T+F*M),2*(T*T+F*F)+3*(k*C+N*M),k*T+F*N,P,D,x),P.sort()}}}},new function(){function o(T,k,M,F,N,D,x){var P=!x&&M.getPrevious()===N,O=!x&&M!==N&&M.getNext()===N,L=1e-8,$=1-L;if(F!==null&&F>=(P?L:0)&&F<=(O?$:1)&&D!==null&&D>=(O?L:0)&&D<=(P?$:1)){var H=new rt(M,F,null,x),q=new rt(N,D,null,x);H._intersection=q,q._intersection=H,(!k||k(H))&&rt.insert(T,H,!0)}}function u(T,k,M,F,N,D,x,P,O,L,$,H,q){if(++O>=4096||++P>=40)return O;var W=1e-9,Q=k[0],K=k[1],Y=k[6],ee=k[7],re=Z.getSignedDistance,se=re(Q,K,Y,ee,k[2],k[3]),ue=re(Q,K,Y,ee,k[4],k[5]),Ee=se*ue>0?3/4:4/9,Te=Ee*Math.min(0,se,ue),Pe=Ee*Math.max(0,se,ue),Qe=re(Q,K,Y,ee,T[0],T[1]),qe=re(Q,K,Y,ee,T[2],T[3]),He=re(Q,K,Y,ee,T[4],T[5]),$e=re(Q,K,Y,ee,T[6],T[7]),Ze=c(Qe,qe,He,$e),Ke=Ze[0],wt=Ze[1],st,dt;if(se===0&&ue===0&&Qe===0&&qe===0&&He===0&&$e===0||(st=d(Ke,wt,Te,Pe))==null||(dt=d(Ke.reverse(),wt.reverse(),Te,Pe))==null)return O;var mt=L+($-L)*st,at=L+($-L)*dt;if(Math.max(q-H,at-mt)<W){var Wn=(mt+at)/2,Kn=(H+q)/2;o(N,D,x?F:M,x?Kn:Wn,x?M:F,x?Wn:Kn)}else{T=he.getPart(T,st,dt);var Ir=q-H;if(dt-st>.8)if(at-mt>Ir){var Sn=he.subdivide(T,.5),Wn=(mt+at)/2;O=u(k,Sn[0],F,M,N,D,!x,P,O,H,q,mt,Wn),O=u(k,Sn[1],F,M,N,D,!x,P,O,H,q,Wn,at)}else{var Sn=he.subdivide(k,.5),Kn=(H+q)/2;O=u(Sn[0],T,F,M,N,D,!x,P,O,H,Kn,mt,at),O=u(Sn[1],T,F,M,N,D,!x,P,O,Kn,q,mt,at)}else Ir===0||Ir>=W?O=u(k,T,F,M,N,D,!x,P,O,H,q,mt,at):O=u(T,k,M,F,N,D,x,P,O,mt,at,H,q)}return O}function c(T,k,M,F){var N=[0,T],D=[1/3,k],x=[2/3,M],P=[1,F],O=k-(2*T+F)/3,L=M-(T+2*F)/3,$;if(O*L<0)$=[[N,D,P],[N,x,P]];else{var H=O/L;$=[H>=2?[N,D,P]:H<=.5?[N,x,P]:[N,D,x,P],[N,P]]}return(O||L)<0?$.reverse():$}function d(T,k,M,F){return T[0][1]<M?f(T,!0,M):k[0][1]>F?f(k,!1,F):T[0][0]}function f(T,k,M){for(var F=T[0][0],N=T[0][1],D=1,x=T.length;D<x;D++){var P=T[D][0],O=T[D][1];if(k?O>=M:O<=M)return O===M?P:F+(M-N)*(P-F)/(O-N);F=P,N=O}return null}function p(T,k,M,F,N){var D=v.isZero;if(D(F)&&D(N)){var x=he.getTimeOf(T,new S(k,M));return x===null?[]:[x]}for(var P=Math.atan2(-N,F),O=Math.sin(P),L=Math.cos(P),$=[],H=[],q=0;q<8;q+=2){var W=T[q]-k,Q=T[q+1]-M;$.push(W*L-Q*O,W*O+Q*L)}return he.solveCubic($,1,0,H,0,1),H}function y(T,k,M,F,N,D,x){for(var P=k[0],O=k[1],L=k[6],$=k[7],H=p(T,P,O,L-P,$-O),q=0,W=H.length;q<W;q++){var Q=H[q],K=he.getPoint(T,Q),Y=he.getTimeOf(k,K);Y!==null&&o(N,D,x?F:M,x?Y:Q,x?M:F,x?Q:Y)}}function _(T,k,M,F,N,D){var x=Z.intersect(T[0],T[1],T[6],T[7],k[0],k[1],k[6],k[7]);x&&o(N,D,M,he.getTimeOf(T,x),F,he.getTimeOf(k,x))}function w(T,k,M,F,N,D){var x=1e-12,P=Math.min,O=Math.max;if(O(T[0],T[2],T[4],T[6])+x>P(k[0],k[2],k[4],k[6])&&P(T[0],T[2],T[4],T[6])-x<O(k[0],k[2],k[4],k[6])&&O(T[1],T[3],T[5],T[7])+x>P(k[1],k[3],k[5],k[7])&&P(T[1],T[3],T[5],T[7])-x<O(k[1],k[3],k[5],k[7])){var L=A(T,k);if(L)for(var $=0;$<2;$++){var H=L[$];o(N,D,M,H[0],F,H[1],!0)}else{var q=he.isStraight(T),W=he.isStraight(k),Q=q&&W,K=q&&!W,Y=N.length;if((Q?_:q||W?y:u)(K?k:T,K?T:k,K?F:M,K?M:F,N,D,K,0,0,0,1,0,1),!Q||N.length===Y)for(var $=0;$<4;$++){var ee=$>>1,re=$&1,se=ee*6,ue=re*6,Ee=new S(T[se],T[se+1]),Te=new S(k[ue],k[ue+1]);Ee.isClose(Te,x)&&o(N,D,M,ee,F,re)}}}return N}function E(T,k,M,F){var N=he.classify(T);if(N.type==="loop"){var D=N.roots;o(M,F,k,D[0],k,D[1])}return M}function b(T,k,M,F,N,D){var x=1e-7,P=!k;P&&(k=T);for(var O=T.length,L=k.length,$=new Array(O),H=P?$:new Array(L),q=[],W=0;W<O;W++)$[W]=T[W].getValues(F);if(!P)for(var W=0;W<L;W++)H[W]=k[W].getValues(N);for(var Q=g.findCurveBoundsCollisions($,H,x),K=0;K<O;K++){var Y=T[K],ee=$[K];P&&E(ee,Y,q,M);var re=Q[K];if(re)for(var se=0;se<re.length;se++){if(D&&q.length)return q;var ue=re[se];if(!P||ue>K){var Ee=k[ue],Te=H[ue];w(ee,Te,Y,Ee,q,M)}}}return q}function A(T,k){function M($e){var Ze=$e[6]-$e[0],Ke=$e[7]-$e[1];return Ze*Ze+Ke*Ke}var F=Math.abs,N=Z.getDistance,D=1e-8,x=1e-7,P=he.isStraight(T),O=he.isStraight(k),L=P&&O,$=M(T)<M(k),H=$?k:T,q=$?T:k,W=H[0],Q=H[1],K=H[6]-W,Y=H[7]-Q;if(N(W,Q,K,Y,q[0],q[1],!0)<x&&N(W,Q,K,Y,q[6],q[7],!0)<x)!L&&N(W,Q,K,Y,H[2],H[3],!0)<x&&N(W,Q,K,Y,H[4],H[5],!0)<x&&N(W,Q,K,Y,q[2],q[3],!0)<x&&N(W,Q,K,Y,q[4],q[5],!0)<x&&(P=O=L=!0);else if(L)return null;if(P^O)return null;for(var ee=[T,k],re=[],se=0;se<4&&re.length<2;se++){var ue=se&1,Ee=ue^1,Te=se>>1,Pe=he.getTimeOf(ee[ue],new S(ee[Ee][Te?6:0],ee[Ee][Te?7:1]));if(Pe!=null){var Qe=ue?[Te,Pe]:[Pe,Te];(!re.length||F(Qe[0]-re[0][0])>D&&F(Qe[1]-re[0][1])>D)&&re.push(Qe)}if(se>2&&!re.length)break}if(re.length!==2)re=null;else if(!L){var qe=he.getPart(T,re[0][0],re[1][0]),He=he.getPart(k,re[0][1],re[1][1]);(F(He[2]-qe[2])>x||F(He[3]-qe[3])>x||F(He[4]-qe[4])>x||F(He[5]-qe[5])>x)&&(re=null)}return re}function C(T,k){var M=T[0],F=T[1],N=T[2],D=T[3],x=T[4],P=T[5],O=T[6],L=T[7],$=k.normalize(),H=$.x,q=$.y,W=3*O-9*x+9*N-3*M,Q=3*L-9*P+9*D-3*F,K=6*x-12*N+6*M,Y=6*P-12*D+6*F,ee=3*N-3*M,re=3*D-3*F,se=2*W*q-2*Q*H,ue=[];if(Math.abs(se)<v.CURVETIME_EPSILON){var Ee=W*re-Q*ee,se=W*Y-Q*K;if(se!=0){var Te=-Ee/se;Te>=0&&Te<=1&&ue.push(Te)}}else{var Pe=(K*K-4*W*ee)*q*q+(-2*K*Y+4*Q*ee+4*W*re)*H*q+(Y*Y-4*Q*re)*H*H,Qe=K*q-Y*H;if(Pe>=0&&se!=0){var qe=Math.sqrt(Pe),He=-(Qe+qe)/se,$e=(-Qe+qe)/se;He>=0&&He<=1&&ue.push(He),$e>=0&&$e<=1&&ue.push($e)}}return ue}return{getIntersections:function(T){var k=this.getValues(),M=T&&T!==this&&T.getValues();return M?w(k,M,this,T,[]):E(k,this,[])},statics:{getOverlaps:A,getIntersections:b,getCurveLineIntersections:p,getTimesWithTangent:C}}}),rt=s.extend({_class:"CurveLocation",initialize:function(u,c,d,f,p){if(c>=.99999999){var y=u.getNext();y&&(c=0,u=y)}this._setCurve(u),this._time=c,this._point=d||u.getPointAtTime(c),this._overlap=f,this._distance=p,this._intersection=this._next=this._previous=null},_setPath:function(o){this._path=o,this._version=o?o._version:0},_setCurve:function(o){this._setPath(o._path),this._curve=o,this._segment=null,this._segment1=o._segment1,this._segment2=o._segment2},_setSegment:function(o){var u=o.getCurve();u?this._setCurve(u):(this._setPath(o._path),this._segment1=o,this._segment2=null),this._segment=o,this._time=o===this._segment1?0:1,this._point=o._point.clone()},getSegment:function(){var o=this._segment;if(!o){var u=this.getCurve(),c=this.getTime();c===0?o=u._segment1:c===1?o=u._segment2:c!=null&&(o=u.getPartLength(0,c)<u.getPartLength(c,1)?u._segment1:u._segment2),this._segment=o}return o},getCurve:function(){var o=this._path,u=this;o&&o._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function c(d){var f=d&&d.getCurve();if(f&&(u._time=f.getTimeOf(u._point))!=null)return u._setCurve(f),f}return this._curve||c(this._segment)||c(this._segment1)||c(this._segment2.getPrevious())},getPath:function(){var o=this.getCurve();return o&&o._path},getIndex:function(){var o=this.getCurve();return o&&o.getIndex()},getTime:function(){var o=this.getCurve(),u=this._time;return o&&u==null?this._time=o.getTimeOf(this._point):u},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var o=this._offset;if(o==null){o=0;var u=this.getPath(),c=this.getIndex();if(u&&c!=null)for(var d=u.getCurves(),f=0;f<c;f++)o+=d[f].getLength();this._offset=o+=this.getCurveOffset()}return o},getCurveOffset:function(){var o=this._curveOffset;if(o==null){var u=this.getCurve(),c=this.getTime();this._curveOffset=o=c!=null&&u&&u.getPartLength(0,c)}return o},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var o=this.getCurve(),u=o&&o.divideAtTime(this.getTime());return u&&this._setSegment(u._segment1),u},split:function(){var o=this.getCurve(),u=o._path,c=o&&o.splitAtTime(this.getTime());return c&&this._setSegment(u.getLastSegment()),c},equals:function(o,u){var c=this===o;if(!c&&o instanceof rt){var d=this.getCurve(),f=o.getCurve(),p=d._path,y=f._path;if(p===y){var _=Math.abs,w=1e-7,E=_(this.getOffset()-o.getOffset()),b=!u&&this._intersection,A=!u&&o._intersection;c=(E<w||p&&_(p.getLength()-E)<w)&&(!b&&!A||b&&A&&b.equals(A,!0))}}return c},toString:function(){var o=[],u=this.getPoint(),c=m.instance;u&&o.push("point: "+u);var d=this.getIndex();d!=null&&o.push("index: "+d);var f=this.getTime();return f!=null&&o.push("time: "+c.number(f)),this._distance!=null&&o.push("distance: "+c.number(this._distance)),"{ "+o.join(", ")+" }"},isTouching:function(){var o=this._intersection;if(o&&this.getTangent().isCollinear(o.getTangent())){var u=this.getCurve(),c=o.getCurve();return!(u.isStraight()&&c.isStraight()&&u.getLine().intersect(c.getLine()))}return!1},isCrossing:function(){var o=this._intersection;if(!o)return!1;var u=this.getTime(),c=o.getTime(),d=1e-8,f=1-d,p=u>=d&&u<=f,y=c>=d&&c<=f;if(p&&y)return!this.isTouching();var _=this.getCurve(),w=_&&u<d?_.getPrevious():_,E=o.getCurve(),b=E&&c<d?E.getPrevious():E;if(u>f&&(_=_.getNext()),c>f&&(E=E.getNext()),!w||!_||!b||!E)return!1;var A=[];function C(H,q){var W=H.getValues(),Q=he.classify(W).roots||he.getPeaks(W),K=Q.length,Y=he.getLength(W,q&&K?Q[K-1]:0,!q&&K?Q[0]:1);A.push(K?Y:Y/32)}function T(H,q,W){return q<W?H>q&&H<W:H>q||H<W}p||(C(w,!0),C(_,!1)),y||(C(b,!0),C(E,!1));var k=this.getPoint(),M=Math.min.apply(Math,A),F=p?_.getTangentAtTime(u):_.getPointAt(M).subtract(k),N=p?F.negate():w.getPointAt(-M).subtract(k),D=y?E.getTangentAtTime(c):E.getPointAt(M).subtract(k),x=y?D.negate():b.getPointAt(-M).subtract(k),P=N.getAngle(),O=F.getAngle(),L=x.getAngle(),$=D.getAngle();return!!(p?T(P,L,$)^T(O,L,$)&&T(P,$,L)^T(O,$,L):T(L,P,O)^T($,P,O)&&T(L,O,P)^T($,O,P))},hasOverlap:function(){return!!this._overlap}},s.each(he._evaluateMethods,function(o){var u=o+"At";this[o]=function(){var c=this.getCurve(),d=this.getTime();return d!=null&&c&&c[u](d,!0)}},{preserve:!0}),new function(){function o(u,c,d){var f=u.length,p=0,y=f-1;function _(k,M){for(var F=k+M;F>=-1&&F<=f;F+=M){var N=u[(F%f+f)%f];if(!c.getPoint().isClose(N.getPoint(),1e-7))break;if(c.equals(N))return N}return null}for(;p<=y;){var w=p+y>>>1,E=u[w],b;if(d&&(b=c.equals(E)?E:_(w,-1)||_(w,1)))return c._overlap&&(b._overlap=b._intersection._overlap=!0),b;var A=c.getPath(),C=E.getPath(),T=A!==C?A._id-C._id:c.getIndex()+c.getTime()-(E.getIndex()+E.getTime());T<0?y=w-1:p=w+1}return u.splice(p,0,c),c}return{statics:{insert:o,expand:function(u){for(var c=u.slice(),d=u.length-1;d>=0;d--)o(c,u[d]._intersection,!1);return c}}}}),xe=te.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(o){var u,c,d;if(s.isPlainObject(o)?(c=o.segments,u=o.pathData):Array.isArray(o)?c=o:typeof o=="string"&&(u=o),c){var f=c[0];d=f&&Array.isArray(f[0])}else u&&(d=(u.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(u));var p=d?De:ye;return new p(o)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(o){this.isClockwise()!=(o=!!o)&&this.reverse()},setPathData:function(o){var u=o&&o.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),c,d=!1,f,p,y=new S,_=new S;function w(x,P){var O=+c[x];return d&&(O+=y[P]),O}function E(x){return new S(w(x,"x"),w(x+1,"y"))}this.clear();for(var b=0,A=u&&u.length;b<A;b++){var C=u[b],T=C[0],k=T.toLowerCase();c=C.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var M=c&&c.length;switch(d=T===k,f==="z"&&!/[mz]/.test(k)&&this.moveTo(y),k){case"m":case"l":for(var F=k==="m",N=0;N<M;N+=2)this[F?"moveTo":"lineTo"](y=E(N)),F&&(_=y,F=!1);p=y;break;case"h":case"v":var D=k==="h"?"x":"y";y=y.clone();for(var N=0;N<M;N++)y[D]=w(N,D),this.lineTo(y);p=y;break;case"c":for(var N=0;N<M;N+=6)this.cubicCurveTo(E(N),p=E(N+2),y=E(N+4));break;case"s":for(var N=0;N<M;N+=4)this.cubicCurveTo(/[cs]/.test(f)?y.multiply(2).subtract(p):y,p=E(N),y=E(N+2)),f=k;break;case"q":for(var N=0;N<M;N+=4)this.quadraticCurveTo(p=E(N),y=E(N+2));break;case"t":for(var N=0;N<M;N+=2)this.quadraticCurveTo(p=/[qt]/.test(f)?y.multiply(2).subtract(p):y,y=E(N)),f=k;break;case"a":for(var N=0;N<M;N+=7)this.arcTo(y=E(N+5),new z(+c[N],+c[N+1]),+c[N+2],+c[N+4],+c[N+3]);break;case"z":this.closePath(1e-12),y=_;break}f=k}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(o){var u=o.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(o):{};return u.onPath||!!(this.getFillRule()==="evenodd"?u.windingL&1||u.windingR&1:u.winding)},getIntersections:function(o,u,c,d){var f=this===o||!o,p=this._matrix._orNullIfIdentity(),y=f?p:(c||o._matrix)._orNullIfIdentity();return f||this.getBounds(p).intersects(o.getBounds(y),1e-12)?he.getIntersections(this.getCurves(),!f&&o.getCurves(),u,p,y,d):[]},getCrossings:function(o){return this.getIntersections(o,function(u){return u.isCrossing()})},getNearestLocation:function(){for(var o=S.read(arguments),u=this.getCurves(),c=1/0,d=null,f=0,p=u.length;f<p;f++){var y=u[f].getNearestLocation(o);y._distance<c&&(c=y._distance,d=y)}return d},getNearestPoint:function(){var o=this.getNearestLocation.apply(this,arguments);return o&&o.getPoint()},interpolate:function(o,u,c){var d=!this._children,f=d?"_segments":"_children",p=o[f],y=u[f],_=this[f];if(!p||!y||p.length!==y.length)throw new Error("Invalid operands in interpolate() call: "+o+", "+u);var w=_.length,E=y.length;if(w<E)for(var b=d?Se:ye,A=w;A<E;A++)this.add(new b);else w>E&&this[d?"removeSegments":"removeChildren"](E,w);for(var A=0;A<E;A++)_[A].interpolate(p[A],y[A],c);d&&(this.setClosed(o._closed),this._changed(9))},compare:function(o){var u=!1;if(o){var c=this._children||[this],d=o._children?o._children.slice():[o],f=c.length,p=d.length,y=[],_=0;u=!0;for(var w=g.findItemBoundsCollisions(c,d,v.GEOMETRIC_EPSILON),E=f-1;E>=0&&u;E--){var b=c[E];u=!1;var A=w[E];if(A)for(var C=A.length-1;C>=0&&!u;C--)b.compare(d[A[C]])&&(y[A[C]]||(y[A[C]]=!0,_++),u=!0)}u=u&&_===p}return u}}),ye=xe.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(u){this._closed=!1,this._segments=[],this._version=0;var c=arguments,d=Array.isArray(u)?typeof u[0]=="object"?u:c:u&&u.size===n&&(u.x!==n||u.point!==n)?c:null;d&&d.length>0?this.setSegments(d):(this._curves=n,this._segmentSelection=0,!d&&typeof u=="string"&&(this.setPathData(u),u=null)),this._initialize(!d&&u)},_equals:function(o){return this._closed===o._closed&&s.equals(this._segments,o._segments)},copyContent:function(o){this.setSegments(o._segments),this._closed=o._closed},_changed:function o(u){if(o.base.call(this,u),u&8){if(this._length=this._area=n,u&32)this._version++;else if(this._curves)for(var c=0,d=this._curves.length;c<d;c++)this._curves[c]._changed()}else u&64&&(this._bounds=n)},getStyle:function(){var o=this._parent;return(o instanceof De?o:this)._style},getSegments:function(){return this._segments},setSegments:function(o){var u=this.isFullySelected(),c=o&&o.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=n,c){var d=o[c-1];typeof d=="boolean"&&(this.setClosed(d),c--),this._add(Se.readList(o,0,{},c))}u&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var o=this._curves,u=this._segments;if(!o){var c=this._countCurves();o=this._curves=new Array(c);for(var d=0;d<c;d++)o[d]=new he(this,u[d],u[d+1]||u[0])}return o},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var o=this.getCurves();return o[o.length-1]},isClosed:function(){return this._closed},setClosed:function(o){if(this._closed!=(o=!!o)){if(this._closed=o,this._curves){var u=this._curves.length=this._countCurves();o&&(this._curves[u-1]=new he(this,this._segments[u-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(o,u){var c=this._segments,d=c.length,f=new m(u),p=new Array(6),y=!0,_,w,E,b,A,C,T,k,M=[];function F(D,x){if(D._transformCoordinates(o,p),_=p[0],w=p[1],y)M.push("M"+f.pair(_,w)),y=!1;else if(A=p[2],C=p[3],A===_&&C===w&&T===E&&k===b){if(!x){var P=_-E,O=w-b;M.push(P===0?"v"+f.number(O):O===0?"h"+f.number(P):"l"+f.pair(P,O))}}else M.push("c"+f.pair(T-E,k-b)+" "+f.pair(A-E,C-b)+" "+f.pair(_-E,w-b));E=_,b=w,T=p[4],k=p[5]}if(!d)return"";for(var N=0;N<d;N++)F(c[N]);return this._closed&&d>0&&(F(c[0],!0),M.push("z")),M.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(o){for(var u=this._segments,c=new Array(6),d=0,f=u.length;d<f;d++)u[d]._transformCoordinates(o,c,!0);return!0},_add:function(o,y){for(var c=this._segments,d=this._curves,f=o.length,p=y==null,y=p?c.length:y,_=0;_<f;_++){var w=o[_];w._path&&(w=o[_]=w.clone()),w._path=this,w._index=y+_,w._selection&&this._updateSelection(w,0,w._selection)}if(p)s.push(c,o);else{c.splice.apply(c,[y,0].concat(o));for(var _=y+f,E=c.length;_<E;_++)c[_]._index=_}if(d){var b=this._countCurves(),A=y>0&&y+f-1===b?y-1:y,C=A,T=Math.min(A+f,b);o._curves&&(d.splice.apply(d,[A,0].concat(o._curves)),C+=o._curves.length);for(var _=C;_<T;_++)d.splice(_,0,new he(this,null,null));this._adjustCurves(A,T)}return this._changed(41),o},_adjustCurves:function(o,u){for(var c=this._segments,d=this._curves,f,p=o;p<u;p++)f=d[p],f._path=this,f._segment1=c[p],f._segment2=c[p+1]||c[0],f._changed();(f=d[this._closed&&!o?c.length-1:o-1])&&(f._segment2=c[o]||c[0],f._changed()),(f=d[u])&&(f._segment1=c[u],f._changed())},_countCurves:function(){var o=this._segments.length;return!this._closed&&o>0?o-1:o},add:function(o){var u=arguments;return u.length>1&&typeof o!="number"?this._add(Se.readList(u)):this._add([Se.read(u)])[0]},insert:function(o,u){var c=arguments;return c.length>2&&typeof u!="number"?this._add(Se.readList(c,1),o):this._add([Se.read(c,1)],o)[0]},addSegment:function(){return this._add([Se.read(arguments)])[0]},insertSegment:function(o){return this._add([Se.read(arguments,1)],o)[0]},addSegments:function(o){return this._add(Se.readList(o))},insertSegments:function(o,u){return this._add(Se.readList(u),o)},removeSegment:function(o){return this.removeSegments(o,o+1)[0]||null},removeSegments:function(o,u,c){o=o||0,u=s.pick(u,this._segments.length);var d=this._segments,f=this._curves,p=d.length,y=d.splice(o,u-o),_=y.length;if(!_)return y;for(var w=0;w<_;w++){var E=y[w];E._selection&&this._updateSelection(E,E._selection,0),E._index=E._path=null}for(var w=o,b=d.length;w<b;w++)d[w]._index=w;if(f){for(var A=o>0&&u===p+(this._closed?1:0)?o-1:o,f=f.splice(A,_),w=f.length-1;w>=0;w--)f[w]._path=null;c&&(y._curves=f.slice(1)),this._adjustCurves(A,A)}return this._changed(41),y},clear:"#removeSegments",hasHandles:function(){for(var o=this._segments,u=0,c=o.length;u<c;u++)if(o[u].hasHandles())return!0;return!1},clearHandles:function(){for(var o=this._segments,u=0,c=o.length;u<c;u++)o[u].clearHandles()},getLength:function(){if(this._length==null){for(var o=this.getCurves(),u=0,c=0,d=o.length;c<d;c++)u+=o[c].getLength();this._length=u}return this._length},getArea:function(){var o=this._area;if(o==null){var u=this._segments,c=this._closed;o=0;for(var d=0,f=u.length;d<f;d++){var p=d+1===f;o+=he.getArea(he.getValues(u[d],u[p?0:d+1],null,p&&!c))}this._area=o}return o},isFullySelected:function(){var o=this._segments.length;return this.isSelected()&&o>0&&this._segmentSelection===o*7},setFullySelected:function(o){o&&this._selectSegments(!0),this.setSelected(o)},setSelection:function o(u){u&1||this._selectSegments(!1),o.base.call(this,u)},_selectSegments:function(o){var u=this._segments,c=u.length,d=o?7:0;this._segmentSelection=d*c;for(var f=0;f<c;f++)u[f]._selection=d},_updateSelection:function(o,u,c){o._selection=c;var d=this._segmentSelection+=c-u;d>0&&this.setSelected(!0)},divideAt:function(o){var u=this.getLocationAt(o),c;return u&&(c=u.getCurve().divideAt(u.getCurveOffset()))?c._segment1:null},splitAt:function(o){var u=this.getLocationAt(o),c=u&&u.index,d=u&&u.time,f=1e-8,p=1-f;d>p&&(c++,d=0);var y=this.getCurves();if(c>=0&&c<y.length){d>=f&&y[c++].divideAtTime(d);var _=this.removeSegments(c,this._segments.length,!0),w;return this._closed?(this.setClosed(!1),w=this):(w=new ye(te.NO_INSERT),w.insertAbove(this),w.copyAttributes(this)),w._add(_,0),this.addSegment(_[0]),w}return null},split:function(o,u){var c,d=u===n?o:(c=this.getCurves()[o])&&c.getLocationAtTime(u);return d!=null?this.splitAt(d):null},join:function(o,u){var c=u||0;if(o&&o!==this){var d=o._segments,f=this.getLastSegment(),p=o.getLastSegment();if(!p)return this;f&&f._point.isClose(p._point,c)&&o.reverse();var y=o.getFirstSegment();if(f&&f._point.isClose(y._point,c))f.setHandleOut(y._handleOut),this._add(d.slice(1));else{var _=this.getFirstSegment();_&&_._point.isClose(y._point,c)&&o.reverse(),p=o.getLastSegment(),_&&_._point.isClose(p._point,c)?(_.setHandleIn(p._handleIn),this._add(d.slice(0,d.length-1),0)):this._add(d.slice())}o._closed&&this._add([d[0]]),o.remove()}var w=this.getFirstSegment(),E=this.getLastSegment();return w!==E&&w._point.isClose(E._point,c)&&(w.setHandleIn(E._handleIn),E.remove(),this.setClosed(!0)),this},reduce:function(o){for(var u=this.getCurves(),c=o&&o.simplify,d=c?1e-7:0,f=u.length-1;f>=0;f--){var p=u[f];!p.hasHandles()&&(!p.hasLength(d)||c&&p.isCollinear(p.getNext()))&&p.remove()}return this},reverse:function(){this._segments.reverse();for(var o=0,u=this._segments.length;o<u;o++){var c=this._segments[o],d=c._handleIn;c._handleIn=c._handleOut,c._handleOut=d,c._index=o}this._curves=null,this._changed(9)},flatten:function(o){for(var u=new it(this,o||.25,256,!0),c=u.parts,d=c.length,f=[],p=0;p<d;p++)f.push(new Se(c[p].curve.slice(0,2)));!this._closed&&d>0&&f.push(new Se(c[d-1].curve.slice(6))),this.setSegments(f)},simplify:function(o){var u=new ze(this).fit(o||2.5);return u&&this.setSegments(u),!!u},smooth:function(o){var u=this,c=o||{},d=c.type||"asymmetric",f=this._segments,p=f.length,y=this._closed;function _(Ke,wt){var st=Ke&&Ke.index;if(st!=null){var dt=Ke.path;if(dt&&dt!==u)throw new Error(Ke._class+" "+st+" of "+dt+" is not part of "+u);wt&&Ke instanceof he&&st++}else st=typeof Ke=="number"?Ke:wt;return Math.min(st<0&&y?st%p:st<0?st+p:st,p-1)}var w=y&&c.from===n&&c.to===n,E=_(c.from,0),b=_(c.to,p-1);if(E>b)if(y)E-=p;else{var A=E;E=b,b=A}if(/^(?:asymmetric|continuous)$/.test(d)){var C=d==="asymmetric",T=Math.min,k=b-E+1,M=k-1,F=w?T(k,4):1,N=F,D=F,x=[];if(y||(N=T(1,E),D=T(1,p-b-1)),M+=N+D,M<=1)return;for(var P=0,O=E-N;P<=M;P++,O++)x[P]=f[(O<0?O+p:O)%p]._point;for(var L=x[0]._x+2*x[1]._x,$=x[0]._y+2*x[1]._y,H=2,q=M-1,W=[L],Q=[$],K=[H],Y=[],ee=[],P=1;P<M;P++){var re=P<q,se=re||C?1:2,ue=re?4:C?2:7,Ee=re?4:C?3:8,Te=re?2:C?0:1,Pe=se/H;H=K[P]=ue-Pe,L=W[P]=Ee*x[P]._x+Te*x[P+1]._x-Pe*L,$=Q[P]=Ee*x[P]._y+Te*x[P+1]._y-Pe*$}Y[q]=W[q]/K[q],ee[q]=Q[q]/K[q];for(var P=M-2;P>=0;P--)Y[P]=(W[P]-Y[P+1])/K[P],ee[P]=(Q[P]-ee[P+1])/K[P];Y[M]=(3*x[M]._x-Y[q])/2,ee[M]=(3*x[M]._y-ee[q])/2;for(var P=N,Qe=M-D,O=E;P<=Qe;P++,O++){var qe=f[O<0?O+p:O],He=qe._point,$e=Y[P]-He._x,Ze=ee[P]-He._y;(w||P<Qe)&&qe.setHandleOut($e,Ze),(w||P>N)&&qe.setHandleIn(-$e,-Ze)}}else for(var P=E;P<=b;P++)f[P<0?P+p:P].smooth(c,!w&&P===E,!w&&P===b)},toShape:function(o){if(!this._closed)return null;var u=this._segments,c,d,f,p;function y(C,T){var k=u[C],M=k.getNext(),F=u[T],N=F.getNext();return k._handleOut.isZero()&&M._handleIn.isZero()&&F._handleOut.isZero()&&N._handleIn.isZero()&&M._point.subtract(k._point).isCollinear(N._point.subtract(F._point))}function _(C){var T=u[C],k=T.getPrevious(),M=T.getNext();return k._handleOut.isZero()&&T._handleIn.isZero()&&T._handleOut.isZero()&&M._handleIn.isZero()&&T._point.subtract(k._point).isOrthogonal(M._point.subtract(T._point))}function w(C){var T=u[C],k=T.getNext(),M=T._handleOut,F=k._handleIn,N=.5522847498307936;if(M.isOrthogonal(F)){var D=T._point,x=k._point,P=new Z(D,M,!0).intersect(new Z(x,F,!0),!0);return P&&v.isZero(M.getLength()/P.subtract(D).getLength()-N)&&v.isZero(F.getLength()/P.subtract(x).getLength()-N)}return!1}function E(C,T){return u[C]._point.getDistance(u[T]._point)}if(!this.hasHandles()&&u.length===4&&y(0,2)&&y(1,3)&&_(1)?(c=_e.Rectangle,d=new z(E(0,3),E(0,1)),p=u[1]._point.add(u[2]._point).divide(2)):u.length===8&&w(0)&&w(2)&&w(4)&&w(6)&&y(1,5)&&y(3,7)?(c=_e.Rectangle,d=new z(E(1,6),E(0,3)),f=d.subtract(new z(E(0,7),E(1,2))).divide(2),p=u[3]._point.add(u[4]._point).divide(2)):u.length===4&&w(0)&&w(1)&&w(2)&&w(3)&&(v.isZero(E(0,2)-E(1,3))?(c=_e.Circle,f=E(0,2)/2):(c=_e.Ellipse,f=new z(E(2,0)/2,E(3,1)/2)),p=u[1]._point),c){var b=this.getPosition(!0),A=new c({center:b,size:d,radius:f,insert:!1});return A.copyAttributes(this,!0),A._matrix.prepend(this._matrix),A.rotate(p.subtract(b).getAngle()+90),(o===n||o)&&A.insertAbove(this),A}return null},toPath:"#clone",compare:function o(u){if(!u||u instanceof De)return o.base.call(this,u);var c=this.getCurves(),d=u.getCurves(),f=c.length,p=d.length;if(!f||!p)return f==p;for(var y=c[0].getValues(),_=[],w=0,E,b=0,A,C=0;C<p;C++){var F=d[C].getValues();_.push(F);var T=he.getOverlaps(y,F);if(T){E=!C&&T[0][0]>0?p-1:C,A=T[0][1];break}}for(var k=Math.abs,M=1e-8,F=_[E],N;y&&F;){var T=he.getOverlaps(y,F);if(T){var D=T[0][0];if(k(D-b)<M){b=T[1][0],b===1&&(y=++w<f?c[w].getValues():null,b=0);var x=T[0][1];if(k(x-A)<M){if(N||(N=[E,x]),A=T[1][1],A===1&&(++E>=p&&(E=0),F=_[E]||d[E].getValues(),A=0),!y)return N[0]===E&&N[1]===A;continue}}}break}return!1},_hitTestSelf:function(o,u,c,d){var f=this,p=this.getStyle(),y=this._segments,_=y.length,w=this._closed,E=u._tolerancePadding,b=E,A,C,T,k,M,F,N=u.stroke&&p.hasStroke(),D=u.fill&&p.hasFill(),x=u.curves,P=N?p.getStrokeWidth()/2:D&&u.tolerance>0||x?0:null;P!==null&&(P>0?(A=p.getStrokeJoin(),C=p.getStrokeCap(),T=p.getMiterLimit(),b=b.add(ye._getStrokePadding(P,d))):A=C="round");function O(Y,ee){return o.subtract(Y).divide(ee).length<=1}function L(Y,ee,re){if(!u.selected||ee.isSelected()){var se=Y._point;if(ee!==se&&(ee=ee.add(se)),O(ee,b))return new Me(re,f,{segment:Y,point:ee})}}function $(Y,ee){return(ee||u.segments)&&L(Y,Y._point,"segment")||!ee&&u.handles&&(L(Y,Y._handleIn,"handle-in")||L(Y,Y._handleOut,"handle-out"))}function H(Y){k.add(Y)}function q(Y){var ee=w||Y._index>0&&Y._index<_-1;if((ee?A:C)==="round")return O(Y._point,b);if(k=new ye({internal:!0,closed:!0}),ee?Y.isSmooth()||ye._addBevelJoin(Y,A,P,T,null,d,H,!0):C==="square"&&ye._addSquareCap(Y,C,P,null,d,H,!0),!k.isEmpty()){var re;return k.contains(o)||(re=k.getNearestLocation(o))&&O(re.getPoint(),E)}}if(u.ends&&!u.segments&&!w){if(F=$(y[0],!0)||$(y[_-1],!0))return F}else if(u.segments||u.handles){for(var W=0;W<_;W++)if(F=$(y[W]))return F}if(P!==null){if(M=this.getNearestLocation(o),M){var Q=M.getTime();Q===0||Q===1&&_>1?q(M.getSegment())||(M=null):O(M.getPoint(),b)||(M=null)}if(!M&&A==="miter"&&_>1)for(var W=0;W<_;W++){var K=y[W];if(o.getDistance(K._point)<=T*P&&q(K)){M=K.getLocation();break}}}return!M&&D&&this._contains(o)||M&&!N&&!x?new Me("fill",this):M?new Me(N?"stroke":"curve",this,{location:M,point:M.getPoint()}):null}},s.each(he._evaluateMethods,function(o){this[o+"At"]=function(u){var c=this.getLocationAt(u);return c&&c[o]()}},{beans:!1,getLocationOf:function(){for(var o=S.read(arguments),u=this.getCurves(),c=0,d=u.length;c<d;c++){var f=u[c].getLocationOf(o);if(f)return f}return null},getOffsetOf:function(){var o=this.getLocationOf.apply(this,arguments);return o?o.getOffset():null},getLocationAt:function(o){if(typeof o=="number"){for(var u=this.getCurves(),c=0,d=0,f=u.length;d<f;d++){var p=c,y=u[d];if(c+=y.getLength(),c>o)return y.getLocationAt(o-p)}if(u.length>0&&o<=this.getLength())return new rt(u[u.length-1],1)}else if(o&&o.getPath&&o.getPath()===this)return o;return null},getOffsetsWithTangent:function(){var o=S.read(arguments);if(o.isZero())return[];for(var u=[],c=0,d=this.getCurves(),f=0,p=d.length;f<p;f++){for(var y=d[f],_=y.getTimesWithTangent(o),w=0,E=_.length;w<E;w++){var b=c+y.getOffsetAtTime(_[w]);u.indexOf(b)<0&&u.push(b)}c+=y.length}return u}}),new function(){function o(c,d,f,p){if(p<=0)return;var y=p/2,_=p-2,w=y-1,E=new Array(6),b,A;function C(D){var x=E[D],P=E[D+1];(b!=x||A!=P)&&(c.beginPath(),c.moveTo(b,A),c.lineTo(x,P),c.stroke(),c.beginPath(),c.arc(x,P,y,0,Math.PI*2,!0),c.fill())}for(var T=0,k=d.length;T<k;T++){var M=d[T],F=M._selection;if(M._transformCoordinates(f,E),b=E[0],A=E[1],F&2&&C(2),F&4&&C(4),c.fillRect(b-y,A-y,p,p),_>0&&!(F&1)){var N=c.fillStyle;c.fillStyle="#ffffff",c.fillRect(b-w,A-w,_,_),c.fillStyle=N}}}function u(c,d,f){var p=d._segments,y=p.length,_=new Array(6),w=!0,E,b,A,C,T,k,M,F;function N(x){if(f)x._transformCoordinates(f,_),E=_[0],b=_[1];else{var P=x._point;E=P._x,b=P._y}if(w)c.moveTo(E,b),w=!1;else{if(f)T=_[2],k=_[3];else{var O=x._handleIn;T=E+O._x,k=b+O._y}T===E&&k===b&&M===A&&F===C?c.lineTo(E,b):c.bezierCurveTo(M,F,T,k,E,b)}if(A=E,C=b,f)M=_[4],F=_[5];else{var O=x._handleOut;M=A+O._x,F=C+O._y}}for(var D=0;D<y;D++)N(p[D]);d._closed&&y>0&&N(p[0])}return{_draw:function(c,d,f,p){var y=d.dontStart,_=d.dontFinish||d.clip,w=this.getStyle(),E=w.hasFill(),b=w.hasStroke(),A=w.getDashArray(),C=!de.support.nativeDash&&b&&A&&A.length;y||c.beginPath(),(E||b&&!C||_)&&(u(c,this,p),this._closed&&c.closePath());function T(x){return A[(x%C+C)%C]}if(!_&&(E||b)&&(this._setStyles(c,d,f),E&&(c.fill(w.getFillRule()),c.shadowColor="rgba(0,0,0,0)"),b)){if(C){y||c.beginPath();for(var k=new it(this,.25,32,!1,p),M=k.length,F=-w.getDashOffset(),N,D=0;F>0;)F-=T(D--)+T(D--);for(;F<M;)N=F+T(D++),(F>0||N>0)&&k.drawPart(c,Math.max(F,0),Math.max(N,0)),F=N+T(D++)}c.stroke()}},_drawSelected:function(c,d){c.beginPath(),u(c,this,d),c.stroke(),o(c,this._segments,d,de.settings.handleSize)}}},new function(){function o(u){var c=u._segments;if(!c.length)throw new Error("Use a moveTo() command first");return c[c.length-1]}return{moveTo:function(){var u=this._segments;u.length===1&&this.removeSegment(0),u.length||this._add([new Se(S.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Se(S.read(arguments))])},cubicCurveTo:function(){var u=arguments,c=S.read(u),d=S.read(u),f=S.read(u),p=o(this);p.setHandleOut(c.subtract(p._point)),this._add([new Se(f,d.subtract(f))])},quadraticCurveTo:function(){var u=arguments,c=S.read(u),d=S.read(u),f=o(this)._point;this.cubicCurveTo(c.add(f.subtract(c).multiply(1/3)),c.add(d.subtract(c).multiply(1/3)),d)},curveTo:function(){var u=arguments,c=S.read(u),d=S.read(u),f=s.pick(s.read(u),.5),p=1-f,y=o(this)._point,_=c.subtract(y.multiply(p*p)).subtract(d.multiply(f*f)).divide(2*f*p);if(_.isNaN())throw new Error("Cannot put a curve through points with parameter = "+f);this.quadraticCurveTo(_,d)},arcTo:function(){var u=arguments,c=Math.abs,d=Math.sqrt,f=o(this),p=f._point,y=S.read(u),_,w=s.peek(u),E=s.pick(w,!0),b,A,C,T;if(typeof E=="boolean")var k=p.add(y).divide(2),_=k.add(k.subtract(p).rotate(E?-90:90));else if(s.remain(u)<=2)_=y,y=S.read(u);else if(!p.equals(y)){var M=z.read(u),F=v.isZero;if(F(M.width)||F(M.height))return this.lineTo(y);var N=s.read(u),E=!!s.read(u),D=!!s.read(u),k=p.add(y).divide(2),x=p.subtract(k).rotate(-N),P=x.x,O=x.y,L=c(M.width),$=c(M.height),H=L*L,q=$*$,W=P*P,Q=O*O,K=d(W/H+Q/q);if(K>1&&(L*=K,$*=K,H=L*L,q=$*$),K=(H*q-H*Q-q*W)/(H*Q+q*W),c(K)<1e-12&&(K=0),K<0)throw new Error("Cannot create an arc with the given arguments");b=new S(L*O/$,-$*P/L).multiply((D===E?-1:1)*d(K)).rotate(N).add(k),T=new U().translate(b).rotate(N).scale(L,$),C=T._inverseTransform(p),A=C.getDirectedAngle(T._inverseTransform(y)),!E&&A>0?A-=360:E&&A<0&&(A+=360)}if(_){var Y=new Z(p.add(_).divide(2),_.subtract(p).rotate(90),!0),ee=new Z(_.add(y).divide(2),y.subtract(_).rotate(90),!0),re=new Z(p,y),se=re.getSide(_);if(b=Y.intersect(ee,!0),!b){if(!se)return this.lineTo(y);throw new Error("Cannot create an arc with the given arguments")}C=p.subtract(b),A=C.getDirectedAngle(y.subtract(b));var ue=re.getSide(b,!0);ue===0?A=se*c(A):se===ue&&(A+=A<0?360:-360)}if(A){for(var Ee=1e-5,Te=c(A),Pe=Te>=360?4:Math.ceil((Te-Ee)/90),Qe=A/Pe,qe=Qe*Math.PI/360,He=4/3*Math.sin(qe)/(1+Math.cos(qe)),$e=[],Ze=0;Ze<=Pe;Ze++){var x=y,Ke=null;if(Ze<Pe&&(Ke=C.rotate(90).multiply(He),T?(x=T._transformPoint(C),Ke=T._transformPoint(C.add(Ke)).subtract(x)):x=b.add(C)),!Ze)f.setHandleOut(Ke);else{var wt=C.rotate(-90).multiply(He);T&&(wt=T._transformPoint(C.add(wt)).subtract(x)),$e.push(new Se(x,wt,Ke))}C=C.rotate(Qe)}this._add($e)}},lineBy:function(){var u=S.read(arguments),c=o(this)._point;this.lineTo(c.add(u))},curveBy:function(){var u=arguments,c=S.read(u),d=S.read(u),f=s.read(u),p=o(this)._point;this.curveTo(p.add(c),p.add(d),f)},cubicCurveBy:function(){var u=arguments,c=S.read(u),d=S.read(u),f=S.read(u),p=o(this)._point;this.cubicCurveTo(p.add(c),p.add(d),p.add(f))},quadraticCurveBy:function(){var u=arguments,c=S.read(u),d=S.read(u),f=o(this)._point;this.quadraticCurveTo(f.add(c),f.add(d))},arcBy:function(){var u=arguments,c=o(this)._point,d=c.add(S.read(u)),f=s.pick(s.peek(u),!0);typeof f=="boolean"?this.arcTo(d,f):this.arcTo(d,c.add(S.read(u)))},closePath:function(u){this.setClosed(!0),this.join(this,u)}}},{_getBounds:function(o,u){var c=u.handle?"getHandleBounds":u.stroke?"getStrokeBounds":"getBounds";return ye[c](this._segments,this._closed,this,o,u)},statics:{getBounds:function(o,u,c,d,f,p){var y=o[0];if(!y)return new V;var _=new Array(6),w=y._transformCoordinates(d,new Array(6)),E=w.slice(0,2),b=E.slice(),A=new Array(2);function C(M){M._transformCoordinates(d,_);for(var F=0;F<2;F++)he._addBounds(w[F],w[F+4],_[F+2],_[F],F,p?p[F]:0,E,b,A);var N=w;w=_,_=N}for(var T=1,k=o.length;T<k;T++)C(o[T]);return u&&C(y),new V(E[0],E[1],b[0]-E[0],b[1]-E[1])},getStrokeBounds:function(o,u,c,d,f){var p=c.getStyle(),y=p.hasStroke(),_=p.getStrokeWidth(),w=y&&c._getStrokeMatrix(d,f),E=y&&ye._getStrokePadding(_,w),b=ye.getBounds(o,u,c,d,f,E);if(!y)return b;var A=_/2,C=p.getStrokeJoin(),T=p.getStrokeCap(),k=p.getMiterLimit(),M=new V(new z(E));function F(L){b=b.include(L)}function N(L){b=b.unite(M.setCenter(L._point.transform(d)))}function D(L,$){$==="round"||L.isSmooth()?N(L):ye._addBevelJoin(L,$,A,k,d,w,F)}function x(L,$){$==="round"?N(L):ye._addSquareCap(L,$,A,d,w,F)}var P=o.length-(u?0:1);if(P>0){for(var O=1;O<P;O++)D(o[O],C);u?D(o[0],C):(x(o[0],T),x(o[o.length-1],T))}return b},_getStrokePadding:function(o,u){if(!u)return[o,o];var c=new S(o,0).transform(u),d=new S(0,o).transform(u),f=c.getAngleInRadians(),p=c.getLength(),y=d.getLength(),_=Math.sin(f),w=Math.cos(f),E=Math.tan(f),b=Math.atan2(y*E,p),A=Math.atan2(y,E*p);return[Math.abs(p*Math.cos(b)*w+y*Math.sin(b)*_),Math.abs(y*Math.sin(A)*w+p*Math.cos(A)*_)]},_addBevelJoin:function(o,u,c,d,f,p,y,_){var w=o.getCurve(),E=w.getPrevious(),b=w.getPoint1().transform(f),A=E.getNormalAtTime(1).multiply(c).transform(p),C=w.getNormalAtTime(0).multiply(c).transform(p),T=A.getDirectedAngle(C);if((T<0||T>=180)&&(A=A.negate(),C=C.negate()),_&&y(b),y(b.add(A)),u==="miter"){var k=new Z(b.add(A),new S(-A.y,A.x),!0).intersect(new Z(b.add(C),new S(-C.y,C.x),!0),!0);k&&b.getDistance(k)<=d*c&&y(k)}y(b.add(C))},_addSquareCap:function(o,u,c,d,f,p,y){var _=o._point.transform(d),w=o.getLocation(),E=w.getNormal().multiply(w.getTime()===0?c:-c).transform(f);u==="square"&&(y&&(p(_.subtract(E)),p(_.add(E))),_=_.add(E.rotate(-90))),p(_.add(E)),p(_.subtract(E))},getHandleBounds:function(o,u,c,d,f){var p=c.getStyle(),y=f.stroke&&p.hasStroke(),_,w;if(y){var E=c._getStrokeMatrix(d,f),b=p.getStrokeWidth()/2,A=b;p.getStrokeJoin()==="miter"&&(A=b*p.getMiterLimit()),p.getStrokeCap()==="square"&&(A=Math.max(A,b*Math.SQRT2)),_=ye._getStrokePadding(b,E),w=ye._getStrokePadding(A,E)}for(var C=new Array(6),T=1/0,k=-T,M=T,F=k,N=0,D=o.length;N<D;N++){var x=o[N];x._transformCoordinates(d,C);for(var P=0;P<6;P+=2){var O=P?_:w,L=O?O[0]:0,$=O?O[1]:0,H=C[P],q=C[P+1],W=H-L,Q=H+L,K=q-$,Y=q+$;W<T&&(T=W),Q>k&&(k=Q),K<M&&(M=K),Y>F&&(F=Y)}}return new V(T,M,k-T,F-M)}}});ye.inject({statics:new function(){var o=.5522847498307936,u=[new Se([-1,0],[0,o],[0,-o]),new Se([0,-1],[-o,0],[o,0]),new Se([1,0],[0,-o],[0,o]),new Se([0,1],[o,0],[-o,0])];function c(f,p,y){var _=s.getNamed(y),w=new ye(_&&(_.insert==!0?te.INSERT:_.insert==!1?te.NO_INSERT:null));return w._add(f),w._closed=p,w.set(_,te.INSERT)}function d(f,p,y){for(var _=new Array(4),w=0;w<4;w++){var E=u[w];_[w]=new Se(E._point.multiply(p).add(f),E._handleIn.multiply(p),E._handleOut.multiply(p))}return c(_,!0,y)}return{Line:function(){var f=arguments;return c([new Se(S.readNamed(f,"from")),new Se(S.readNamed(f,"to"))],!1,f)},Circle:function(){var f=arguments,p=S.readNamed(f,"center"),y=s.readNamed(f,"radius");return d(p,new z(y),f)},Rectangle:function(){var f=arguments,p=V.readNamed(f,"rectangle"),y=z.readNamed(f,"radius",0,{readNull:!0}),_=p.getBottomLeft(!0),w=p.getTopLeft(!0),E=p.getTopRight(!0),b=p.getBottomRight(!0),A;if(!y||y.isZero())A=[new Se(_),new Se(w),new Se(E),new Se(b)];else{y=z.min(y,p.getSize(!0).divide(2));var C=y.width,T=y.height,k=C*o,M=T*o;A=[new Se(_.add(C,0),null,[-k,0]),new Se(_.subtract(0,T),[0,M]),new Se(w.add(0,T),null,[0,-M]),new Se(w.add(C,0),[-k,0],null),new Se(E.subtract(C,0),null,[k,0]),new Se(E.add(0,T),[0,-M],null),new Se(b.subtract(0,T),null,[0,M]),new Se(b.subtract(C,0),[k,0])]}return c(A,!0,f)},RoundRectangle:"#Rectangle",Ellipse:function(){var f=arguments,p=_e._readEllipse(f);return d(p.center,p.radius,f)},Oval:"#Ellipse",Arc:function(){var f=arguments,p=S.readNamed(f,"from"),y=S.readNamed(f,"through"),_=S.readNamed(f,"to"),w=s.getNamed(f),E=new ye(w&&w.insert==!1&&te.NO_INSERT);return E.moveTo(p),E.arcTo(y,_),E.set(w)},RegularPolygon:function(){for(var f=arguments,p=S.readNamed(f,"center"),y=s.readNamed(f,"sides"),_=s.readNamed(f,"radius"),w=360/y,E=y%3===0,b=new S(0,E?-_:_),A=E?-1:.5,C=new Array(y),T=0;T<y;T++)C[T]=new Se(p.add(b.rotate((T+A)*w)));return c(C,!0,f)},Star:function(){for(var f=arguments,p=S.readNamed(f,"center"),y=s.readNamed(f,"points")*2,_=s.readNamed(f,"radius1"),w=s.readNamed(f,"radius2"),E=360/y,b=new S(0,-1),A=new Array(y),C=0;C<y;C++)A[C]=new Se(p.add(b.rotate(E*C).multiply(C%2?w:_)));return c(A,!0,f)}}}});var De=xe.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(u){this._children=[],this._namedChildren={},this._initialize(u)||(typeof u=="string"?this.setPathData(u):this.addChildren(Array.isArray(u)?u:arguments))},insertChildren:function o(u,c){var d=c,f=d[0];f&&typeof f[0]=="number"&&(d=[d]);for(var p=c.length-1;p>=0;p--){var y=d[p];d===c&&!(y instanceof ye)&&(d=s.slice(d)),Array.isArray(y)?d[p]=new ye({segments:y,insert:!1}):y instanceof De&&(d.splice.apply(d,[p,1].concat(y.removeChildren())),y.remove())}return o.base.call(this,u,d)},reduce:function o(u){for(var c=this._children,d=c.length-1;d>=0;d--){var f=c[d].reduce(u);f.isEmpty()&&f.remove()}if(!c.length){var f=new ye(te.NO_INSERT);return f.copyAttributes(this),f.insertAbove(this),this.remove(),f}return o.base.call(this)},isClosed:function(){for(var o=this._children,u=0,c=o.length;u<c;u++)if(!o[u]._closed)return!1;return!0},setClosed:function(o){for(var u=this._children,c=0,d=u.length;c<d;c++)u[c].setClosed(o)},getFirstSegment:function(){var o=this.getFirstChild();return o&&o.getFirstSegment()},getLastSegment:function(){var o=this.getLastChild();return o&&o.getLastSegment()},getCurves:function(){for(var o=this._children,u=[],c=0,d=o.length;c<d;c++)s.push(u,o[c].getCurves());return u},getFirstCurve:function(){var o=this.getFirstChild();return o&&o.getFirstCurve()},getLastCurve:function(){var o=this.getLastChild();return o&&o.getLastCurve()},getArea:function(){for(var o=this._children,u=0,c=0,d=o.length;c<d;c++)u+=o[c].getArea();return u},getLength:function(){for(var o=this._children,u=0,c=0,d=o.length;c<d;c++)u+=o[c].getLength();return u},getPathData:function(o,u){for(var c=this._children,d=[],f=0,p=c.length;f<p;f++){var y=c[f],_=y._matrix;d.push(y.getPathData(o&&!_.isIdentity()?o.appended(_):o,u))}return d.join("")},_hitTestChildren:function o(u,c,d){return o.base.call(this,u,c.class===ye||c.type==="path"?c:s.set({},c,{fill:!1}),d)},_draw:function(o,u,c,d){var f=this._children;if(f.length){u=u.extend({dontStart:!0,dontFinish:!0}),o.beginPath();for(var p=0,y=f.length;p<y;p++)f[p].draw(o,u,d);if(!u.clip){this._setStyles(o,u,c);var _=this._style;_.hasFill()&&(o.fill(_.getFillRule()),o.shadowColor="rgba(0,0,0,0)"),_.hasStroke()&&o.stroke()}}},_drawSelected:function(o,u,c){for(var d=this._children,f=0,p=d.length;f<p;f++){var y=d[f],_=y._matrix;c[y._id]||y._drawSelected(o,_.isIdentity()?u:u.appended(_))}}},new function(){function o(u,c){var d=u._children;if(c&&!d.length)throw new Error("Use a moveTo() command first");return d[d.length-1]}return s.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(u){this[u]=function(){var c=o(this,!0);c[u].apply(c,arguments)}},{moveTo:function(){var u=o(this),c=u&&u.isEmpty()?u:new ye(te.NO_INSERT);c!==u&&this.addChild(c),c.moveTo.apply(c,arguments)},moveBy:function(){var u=o(this,!0),c=u&&u.getLastSegment(),d=S.read(arguments);this.moveTo(c?d.add(c._point):d)},closePath:function(u){o(this,!0).closePath(u)}})},s.each(["reverse","flatten","simplify","smooth"],function(o){this[o]=function(u){for(var c=this._children,d,f=0,p=c.length;f<p;f++)d=c[f][o](u)||d;return d}},{}));xe.inject(new function(){var o=Math.min,u=Math.max,c=Math.abs,d={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function f(N){return N._children||[N]}function p(N,D){var x=N.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(D){for(var P=f(x),O=0,L=P.length;O<L;O++){var N=P[O];!N._closed&&!N.isEmpty()&&(N.closePath(1e-12),N.getFirstSegment().setHandleIn(0,0),N.getLastSegment().setHandleOut(0,0))}x=x.resolveCrossings().reorient(x.getFillRule()==="nonzero",!0)}return x}function y(N,D,x,P,O){var L=new De(te.NO_INSERT);return L.addChildren(N,!0),L=L.reduce({simplify:D}),O&&O.insert==!1||L.insertAbove(P&&x.isSibling(P)&&x.getIndex()<P.getIndex()?P:x),L.copyAttributes(x,!0),L}function _(N){return N.hasOverlap()||N.isCrossing()}function w(N,D,x,P){if(P&&(P.trace==!1||P.stroke)&&/^(subtract|intersect)$/.test(x))return E(N,D,x);var O=p(N,!0),L=D&&N!==D&&p(D,!0),$=d[x];$[x]=!0,L&&($.subtract||$.exclude)^(L.isClockwise()^O.isClockwise())&&L.reverse();var H=T(rt.expand(O.getIntersections(L,_))),q=f(O),W=L&&f(L),Q=[],K=[],Y;function ee(Ke){for(var wt=0,st=Ke.length;wt<st;wt++){var dt=Ke[wt];s.push(Q,dt._segments),s.push(K,dt.getCurves()),dt._overlapsOnly=!0}}function re(Ke){for(var wt=[],st=0,dt=Ke&&Ke.length;st<dt;st++)wt.push(K[Ke[st]]);return wt}if(H.length){ee(q),W&&ee(W);for(var se=new Array(K.length),ue=0,Ee=K.length;ue<Ee;ue++)se[ue]=K[ue].getValues();for(var Te=g.findCurveBoundsCollisions(se,se,0,!0),Pe={},ue=0;ue<K.length;ue++){var Qe=K[ue],qe=Qe._path._id,He=Pe[qe]=Pe[qe]||{};He[Qe.getIndex()]={hor:re(Te[ue].hor),ver:re(Te[ue].ver)}}for(var ue=0,Ee=H.length;ue<Ee;ue++)M(H[ue]._segment,O,L,Pe,$);for(var ue=0,Ee=Q.length;ue<Ee;ue++){var $e=Q[ue],Ze=$e._intersection;$e._winding||M($e,O,L,Pe,$),Ze&&Ze._overlap||($e._path._overlapsOnly=!1)}Y=F(Q,$)}else Y=C(W?q.concat(W):q.slice(),function(Ke){return!!$[Ke]});return y(Y,!0,N,D,P)}function E(N,D,x){var P=p(N),O=p(D),L=P.getIntersections(O,_),$=x==="subtract",H=x==="divide",q={},W=[];function Q(ee){if(!q[ee._id]&&(H||O.contains(ee.getPointAt(ee.getLength()/2))^$))return W.unshift(ee),q[ee._id]=!0}for(var K=L.length-1;K>=0;K--){var Y=L[K].split();Y&&(Q(Y)&&Y.getFirstSegment().setHandleIn(0,0),P.getLastSegment().setHandleOut(0,0))}return Q(P),y(W,!1,N,D)}function b(N,D){for(var x=N;x;){if(x===D)return;x=x._previous}for(;N._next&&N._next!==D;)N=N._next;if(!N._next){for(;D._previous;)D=D._previous;N._next=D,D._previous=N}}function A(N){for(var D=N.length-1;D>=0;D--)N[D].clearHandles()}function C(N,D,x){var P=N&&N.length;if(P){var O=s.each(N,function(Te,Pe){this[Te._id]={container:null,winding:Te.isClockwise()?1:-1,index:Pe}},{}),L=N.slice().sort(function(Te,Pe){return c(Pe.getArea())-c(Te.getArea())}),$=L[0],H=g.findItemBoundsCollisions(L,null,v.GEOMETRIC_EPSILON);x==null&&(x=$.isClockwise());for(var q=0;q<P;q++){var W=L[q],Q=O[W._id],K=0,Y=H[q];if(Y){for(var ee=null,re=Y.length-1;re>=0;re--)if(Y[re]<q){ee=ee||W.getInteriorPoint();var se=L[Y[re]];if(se.contains(ee)){var ue=O[se._id];K=ue.winding,Q.winding+=K,Q.container=ue.exclude?ue.container:se;break}}}if(D(Q.winding)===D(K))Q.exclude=!0,N[Q.index]=null;else{var Ee=Q.container;W.setClockwise(Ee?!Ee.isClockwise():x)}}}return N}function T(N,D,x){var P=D&&[],O=1e-8,L=1-O,$=!1,H=x||[],q=x&&{},W,Q,K;function Y(wt){return wt._path._id+"."+wt._segment1._index}for(var ee=(x&&x.length)-1;ee>=0;ee--){var re=x[ee];re._path&&(q[Y(re)]=!0)}for(var ee=N.length-1;ee>=0;ee--){var se=N[ee],ue=se._time,Ee=ue,Te=D&&!D(se),re=se._curve,Pe;if(re&&(re!==Q?($=!re.hasHandles()||q&&q[Y(re)],W=[],K=null,Q=re):K>=O&&(ue/=K)),Te){W&&W.push(se);continue}else D&&P.unshift(se);if(K=Ee,ue<O)Pe=re._segment1;else if(ue>L)Pe=re._segment2;else{var Qe=re.divideAtTime(ue,!0);$&&H.push(re,Qe),Pe=Qe._segment1;for(var qe=W.length-1;qe>=0;qe--){var He=W[qe];He._time=(He._time-ue)/(1-ue)}}se._setSegment(Pe);var $e=Pe._intersection,Ze=se._intersection;if($e){b($e,Ze);for(var Ke=$e;Ke;)b(Ke._intersection,$e),Ke=Ke._next}else Pe._intersection=Ze}return x||A(H),P||N}function k(N,D,x,P,O){var L=Array.isArray(D)?D:D[x?"hor":"ver"],$=x?1:0,H=$^1,q=[N.x,N.y],W=q[$],Q=q[H],K=1e-9,Y=1e-6,ee=W-K,re=W+K,se=0,ue=0,Ee=0,Te=0,Pe=!1,Qe=!1,qe=1,He=[],$e,Ze;function Ke(Dt){var Tn=Dt[H+0],gi=Dt[H+6];if(!(Q<o(Tn,gi)||Q>u(Tn,gi))){var Qn=Dt[$+0],Hs=Dt[$+2],Xl=Dt[$+4],qs=Dt[$+6];if(Tn===gi){(Qn<re&&qs>ee||qs<re&&Qn>ee)&&(Pe=!0);return}var ta=Q===Tn?0:Q===gi||ee>u(Qn,Hs,Xl,qs)||re<o(Qn,Hs,Xl,qs)?1:he.solveCubic(Dt,H,Q,He,0,1)>0?He[0]:1,pi=ta===0?Qn:ta===1?qs:he.getPoint(Dt,ta)[x?"y":"x"],Di=Tn>gi?1:-1,Ud=$e[H]>$e[H+6]?1:-1,na=$e[$+6];return Q!==Tn?(pi<ee?Ee+=Di:pi>re?Te+=Di:Pe=!0,pi>W-Y&&pi<W+Y&&(qe/=2)):(Di!==Ud?Qn<ee?Ee+=Di:Qn>re&&(Te+=Di):Qn!=na&&(na<re&&pi>re?(Te+=Di,Pe=!0):na>ee&&pi<ee&&(Ee+=Di,Pe=!0)),qe/=4),$e=Dt,!O&&pi>ee&&pi<re&&he.getTangent(Dt,ta)[x?"x":"y"]===0&&k(N,D,!x,P,!0)}}function wt(Dt){var Tn=Dt[H+0],gi=Dt[H+2],Qn=Dt[H+4],Hs=Dt[H+6];if(Q<=u(Tn,gi,Qn,Hs)&&Q>=o(Tn,gi,Qn,Hs)){for(var Xl=Dt[$+0],qs=Dt[$+2],ta=Dt[$+4],pi=Dt[$+6],Di=ee>u(Xl,qs,ta,pi)||re<o(Xl,qs,ta,pi)?[Dt]:he.getMonoCurves(Dt,x),Ud,na=0,ZD=Di.length;na<ZD;na++)if(Ud=Ke(Di[na]))return Ud}}for(var st=0,dt=L.length;st<dt;st++){var mt=L[st],at=mt._path,Wn=mt.getValues(),Kn;if((!st||L[st-1]._path!==at)&&($e=null,at._closed||(Ze=he.getValues(at.getLastCurve().getSegment2(),mt.getSegment1(),null,!P),Ze[H]!==Ze[H+6]&&($e=Ze)),!$e)){$e=Wn;for(var Ir=at.getLastCurve();Ir&&Ir!==mt;){var Sn=Ir.getValues();if(Sn[H]!==Sn[H+6]){$e=Sn;break}Ir=Ir.getPrevious()}}if(Kn=wt(Wn))return Kn;if(st+1===dt||L[st+1]._path!==at){if(Ze&&(Kn=wt(Ze)))return Kn;Pe&&!Ee&&!Te&&(Ee=Te=at.isClockwise(P)^x?1:-1),se+=Ee,ue+=Te,Ee=Te=0,Pe&&(Qe=!0,Pe=!1),Ze=null}}return se=c(se),ue=c(ue),{winding:u(se,ue),windingL:se,windingR:ue,quality:qe,onPath:Qe}}function M(N,D,x,P,O){var L=[],$=N,H=0,K;do{var q=N.getCurve();if(q){var W=q.getLength();L.push({segment:N,curve:q,length:W}),H+=W}N=N.getNext()}while(N&&!N._intersection&&N!==$);for(var Q=[.5,.25,.75],K={winding:0,quality:-1},Y=.001,ee=1-Y,re=0;re<Q.length&&K.quality<.5;re++)for(var W=H*Q[re],se=0,ue=L.length;se<ue;se++){var Ee=L[se],Te=Ee.length;if(W<=Te){var q=Ee.curve,Pe=q._path,Qe=Pe._parent,qe=Qe instanceof De?Qe:Pe,He=v.clamp(q.getTimeAt(W),Y,ee),$e=q.getPointAtTime(He),Ze=c(q.getTangentAtTime(He).y)<Math.SQRT1_2,Ke=null;if(O.subtract&&x){var wt=qe===D?x:D,st=wt._getWinding($e,Ze,!0);if(qe===D&&st.winding||qe===x&&!st.winding){if(st.quality<1)continue;Ke={winding:0,quality:1}}}Ke=Ke||k($e,P[Pe._id][q.getIndex()],Ze,!0),Ke.quality>K.quality&&(K=Ke);break}W-=Te}for(var se=L.length-1;se>=0;se--)L[se].segment._winding=K}function F(N,D){var x=[],P;function O(dt){var mt;return!!(dt&&!dt._visited&&(!D||D[(mt=dt._winding||{}).winding]&&!(D.unite&&mt.winding===2&&mt.windingL&&mt.windingR)))}function L(dt){if(dt){for(var mt=0,at=P.length;mt<at;mt++)if(dt===P[mt])return!0}return!1}function $(dt){for(var mt=dt._segments,at=0,Wn=mt.length;at<Wn;at++)mt[at]._visited=!0}function H(dt,mt){var at=dt._intersection,Wn=at,Kn=[];mt&&(P=[dt]);function Ir(Sn,Dt){for(;Sn&&Sn!==Dt;){var Tn=Sn._segment,gi=Tn&&Tn._path;if(gi){var Qn=Tn.getNext()||gi.getFirstSegment(),Hs=Qn._intersection;Tn!==dt&&(L(Tn)||L(Qn)||Qn&&O(Tn)&&(O(Qn)||Hs&&O(Hs._segment)))&&Kn.push(Tn),mt&&P.push(Tn)}Sn=Sn._next}}if(at){for(Ir(at);at&&at._previous;)at=at._previous;Ir(at,Wn)}return Kn}N.sort(function(dt,mt){var at=dt._intersection,Wn=mt._intersection,Kn=!!(at&&at._overlap),Ir=!!(Wn&&Wn._overlap),Sn=dt._path,Dt=mt._path;return Kn^Ir?Kn?1:-1:!at^!Wn?at?1:-1:Sn!==Dt?Sn._id-Dt._id:dt._index-mt._index});for(var q=0,W=N.length;q<W;q++){var Q=N[q],K=O(Q),Y=null,ee=!1,re=!0,se=[],ue,Ee,Te;if(K&&Q._path._overlapsOnly){var Pe=Q._path,Qe=Q._intersection._segment._path;Pe.compare(Qe)&&(Pe.getArea()&&x.push(Pe.clone(!1)),$(Pe),$(Qe),K=!1)}for(;K;){var qe=!Y,He=H(Q,qe),$e=He.shift(),ee=!qe&&(L(Q)||L($e)),Ze=!ee&&$e;if(qe&&(Y=new ye(te.NO_INSERT),ue=null),ee){(Q.isFirst()||Q.isLast())&&(re=Q._path._closed),Q._visited=!0;break}if(Ze&&ue&&(se.push(ue),ue=null),ue||(Ze&&He.push(Q),ue={start:Y._segments.length,crossings:He,visited:Ee=[],handleIn:Te}),Ze&&(Q=$e),!O(Q)){Y.removeSegments(ue.start);for(var Ke=0,wt=Ee.length;Ke<wt;Ke++)Ee[Ke]._visited=!1;Ee.length=0;do Q=ue&&ue.crossings.shift(),(!Q||!Q._path)&&(Q=null,ue=se.pop(),ue&&(Ee=ue.visited,Te=ue.handleIn));while(ue&&!O(Q));if(!Q)break}var st=Q.getNext();Y.add(new Se(Q._point,Te,st&&Q._handleOut)),Q._visited=!0,Ee.push(Q),Q=st||Q._path.getFirstSegment(),Te=st&&st._handleIn}ee&&(re&&(Y.getFirstSegment().setHandleIn(Te),Y.setClosed(re)),Y.getArea()!==0&&x.push(Y))}return x}return{_getWinding:function(N,D,x){return k(N,this.getCurves(),D,x)},unite:function(N,D){return w(this,N,"unite",D)},intersect:function(N,D){return w(this,N,"intersect",D)},subtract:function(N,D){return w(this,N,"subtract",D)},exclude:function(N,D){return w(this,N,"exclude",D)},divide:function(N,D){return D&&(D.trace==!1||D.stroke)?E(this,N,"divide"):y([this.subtract(N,D),this.intersect(N,D)],!0,this,N,D)},resolveCrossings:function(){var N=this._children,D=N||[this];function x(ue,Ee){var Te=ue&&ue._intersection;return Te&&Te._overlap&&Te._path===Ee}var P=!1,O=!1,L=this.getIntersections(null,function(ue){return ue.hasOverlap()&&(P=!0)||ue.isCrossing()&&(O=!0)}),$=P&&O&&[];if(L=rt.expand(L),P)for(var H=T(L,function(ue){return ue.hasOverlap()},$),q=H.length-1;q>=0;q--){var W=H[q],Q=W._path,K=W._segment,Y=K.getPrevious(),ee=K.getNext();x(Y,Q)&&x(ee,Q)&&(K.remove(),Y._handleOut._set(0,0),ee._handleIn._set(0,0),Y!==K&&!Y.getCurve().hasLength()&&(ee._handleIn.set(Y._handleIn),Y.remove()))}O&&(T(L,P&&function(ue){var Ee=ue.getCurve(),Te=ue.getSegment(),Pe=ue._intersection,Qe=Pe._curve,qe=Pe._segment;if(Ee&&Qe&&Ee._path&&Qe._path)return!0;Te&&(Te._intersection=null),qe&&(qe._intersection=null)},$),$&&A($),D=F(s.each(D,function(ue){s.push(this,ue._segments)},[])));var re=D.length,se;return re>1&&N?(D!==N&&this.setChildren(D),se=this):re===1&&!N&&(D[0]!==this&&this.setSegments(D[0].removeSegments()),se=this),se||(se=new De(te.NO_INSERT),se.addChildren(D),se=se.reduce(),se.copyAttributes(this),this.replaceWith(se)),se},reorient:function(N,D){var x=this._children;return x&&x.length?this.setChildren(C(this.removeChildren(),function(P){return!!(N?P:P&1)},D)):D!==n&&this.setClockwise(D),this},getInteriorPoint:function(){var N=this.getBounds(),D=N.getCenter(!0);if(!this.contains(D)){for(var x=this.getCurves(),P=D.y,O=[],L=[],$=0,H=x.length;$<H;$++){var q=x[$].getValues(),W=q[1],Q=q[3],K=q[5],Y=q[7];if(P>=o(W,Q,K,Y)&&P<=u(W,Q,K,Y))for(var ee=he.getMonoCurves(q),re=0,se=ee.length;re<se;re++){var ue=ee[re],Ee=ue[1],Te=ue[7];if(Ee!==Te&&(P>=Ee&&P<=Te||P>=Te&&P<=Ee)){var Pe=P===Ee?ue[0]:P===Te?ue[6]:he.solveCubic(ue,1,P,L,0,1)===1?he.getPoint(ue,L[0]).x:(ue[0]+ue[6])/2;O.push(Pe)}}}O.length>1&&(O.sort(function(Qe,qe){return Qe-qe}),D.x=(O[0]+O[1])/2)}return D}}});var it=s.extend({_class:"PathFlattener",initialize:function(o,u,c,d,f){var p=[],y=[],_=0,w=1/(c||32),E=o._segments,b=E[0],A;function C(F,N){var D=he.getValues(F,N,f);p.push(D),T(D,F._index,0,1)}function T(F,N,D,x){if(x-D>w&&!(d&&he.isStraight(F))&&!he.isFlatEnough(F,u||.25)){var P=he.subdivide(F,.5),O=(D+x)/2;T(P[0],N,D,O),T(P[1],N,O,x)}else{var L=F[6]-F[0],$=F[7]-F[1],H=Math.sqrt(L*L+$*$);H>0&&(_+=H,y.push({offset:_,curve:F,index:N,time:x}))}}for(var k=1,M=E.length;k<M;k++)A=E[k],C(b,A),b=A;o._closed&&C(A||b,E[0]),this.curves=p,this.parts=y,this.length=_,this.index=0},_get:function(o){for(var u=this.parts,c=u.length,d,f=this.index;d=f,!(!f||u[--f].offset<o););for(;d<c;d++){var p=u[d];if(p.offset>=o){this.index=d;var y=u[d-1],_=y&&y.index===p.index?y.time:0,w=y?y.offset:0;return{index:p.index,time:_+(p.time-_)*(o-w)/(p.offset-w)}}}return{index:u[c-1].index,time:1}},drawPart:function(o,u,c){for(var d=this._get(u),f=this._get(c),p=d.index,y=f.index;p<=y;p++){var _=he.getPart(this.curves[p],p===d.index?d.time:0,p===f.index?f.time:1);p===d.index&&o.moveTo(_[0],_[1]),o.bezierCurveTo.apply(o,_.slice(2))}}},s.each(he._evaluateMethods,function(o){this[o+"At"]=function(u){var c=this._get(u);return he[o](this.curves[c.index],c.time)}},{})),ze=s.extend({initialize:function(o){for(var u=this.points=[],c=o._segments,d=o._closed,f=0,p,y=c.length;f<y;f++){var _=c[f].point;(!p||!p.equals(_))&&u.push(p=_.clone())}d&&(u.unshift(u[u.length-1]),u.push(u[1])),this.closed=d},fit:function(o){var u=this.points,c=u.length,d=null;return c>0&&(d=[new Se(u[0])],c>1&&(this.fitCubic(d,o,0,c-1,u[1].subtract(u[0]),u[c-2].subtract(u[c-1])),this.closed&&(d.shift(),d.pop()))),d},fitCubic:function(o,u,c,d,f,p){var y=this.points;if(d-c===1){var _=y[c],w=y[d],E=_.getDistance(w)/3;this.addCurve(o,[_,_.add(f.normalize(E)),w.add(p.normalize(E)),w]);return}for(var b=this.chordLengthParameterize(c,d),A=Math.max(u,u*u),C,T=!0,k=0;k<=4;k++){var M=this.generateBezier(c,d,b,f,p),F=this.findMaxError(c,d,M,b);if(F.error<u&&T){this.addCurve(o,M);return}if(C=F.index,F.error>=A)break;T=this.reparameterize(c,d,b,M),A=F.error}var N=y[C-1].subtract(y[C+1]);this.fitCubic(o,u,c,C,f,N),this.fitCubic(o,u,C,d,N.negate(),p)},addCurve:function(o,u){var c=o[o.length-1];c.setHandleOut(u[1].subtract(u[0])),o.push(new Se(u[3],u[2].subtract(u[3])))},generateBezier:function(o,u,c,d,f){for(var p=1e-12,y=Math.abs,_=this.points,w=_[o],E=_[u],b=[[0,0],[0,0]],A=[0,0],C=0,T=u-o+1;C<T;C++){var k=c[C],M=1-k,F=3*k*M,N=M*M*M,D=F*M,x=F*k,P=k*k*k,O=d.normalize(D),L=f.normalize(x),$=_[o+C].subtract(w.multiply(N+D)).subtract(E.multiply(x+P));b[0][0]+=O.dot(O),b[0][1]+=O.dot(L),b[1][0]=b[0][1],b[1][1]+=L.dot(L),A[0]+=O.dot($),A[1]+=L.dot($)}var H=b[0][0]*b[1][1]-b[1][0]*b[0][1],q,W;if(y(H)>p){var Q=b[0][0]*A[1]-b[1][0]*A[0],K=A[0]*b[1][1]-A[1]*b[0][1];q=K/H,W=Q/H}else{var Y=b[0][0]+b[0][1],ee=b[1][0]+b[1][1];q=W=y(Y)>p?A[0]/Y:y(ee)>p?A[1]/ee:0}var re=E.getDistance(w),se=p*re,ue,Ee;if(q<se||W<se)q=W=re/3;else{var Te=E.subtract(w);ue=d.normalize(q),Ee=f.normalize(W),ue.dot(Te)-Ee.dot(Te)>re*re&&(q=W=re/3,ue=Ee=null)}return[w,w.add(ue||d.normalize(q)),E.add(Ee||f.normalize(W)),E]},reparameterize:function(o,u,c,d){for(var f=o;f<=u;f++)c[f-o]=this.findRoot(d,this.points[f],c[f-o]);for(var f=1,p=c.length;f<p;f++)if(c[f]<=c[f-1])return!1;return!0},findRoot:function(o,u,c){for(var d=[],f=[],p=0;p<=2;p++)d[p]=o[p+1].subtract(o[p]).multiply(3);for(var p=0;p<=1;p++)f[p]=d[p+1].subtract(d[p]).multiply(2);var y=this.evaluate(3,o,c),_=this.evaluate(2,d,c),w=this.evaluate(1,f,c),E=y.subtract(u),b=_.dot(_)+E.dot(w);return v.isMachineZero(b)?c:c-E.dot(_)/b},evaluate:function(o,u,c){for(var d=u.slice(),f=1;f<=o;f++)for(var p=0;p<=o-f;p++)d[p]=d[p].multiply(1-c).add(d[p+1].multiply(c));return d[0]},chordLengthParameterize:function(o,u){for(var c=[0],d=o+1;d<=u;d++)c[d-o]=c[d-o-1]+this.points[d].getDistance(this.points[d-1]);for(var d=1,f=u-o;d<=f;d++)c[d]/=c[f];return c},findMaxError:function(o,u,c,d){for(var f=Math.floor((u-o+1)/2),p=0,y=o+1;y<u;y++){var _=this.evaluate(3,c,d[y-o]),w=_.subtract(this.points[y]),E=w.x*w.x+w.y*w.y;E>=p&&(p=E,f=y)}return{error:p,index:f}}}),kt=te.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(u){this._content="",this._lines=[];var c=u&&s.isPlainObject(u)&&u.x===n&&u.y===n;this._initialize(c&&u,!c&&S.read(arguments))},_equals:function(o){return this._content===o._content},copyContent:function(o){this.setContent(o._content)},getContent:function(){return this._content},setContent:function(o){this._content=""+o,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),ht=kt.extend({_class:"PointText",initialize:function(){kt.apply(this,arguments)},getPoint:function(){var o=this._matrix.getTranslation();return new j(o.x,o.y,this,"setPoint")},setPoint:function(){var o=S.read(arguments);this.translate(o.subtract(this._matrix.getTranslation()))},_draw:function(o,u,c){if(this._content){this._setStyles(o,u,c);var d=this._lines,f=this._style,p=f.hasFill(),y=f.hasStroke(),_=f.getLeading(),w=o.shadowColor;o.font=f.getFontStyle(),o.textAlign=f.getJustification();for(var E=0,b=d.length;E<b;E++){o.shadowColor=w;var A=d[E];p&&(o.fillText(A,0,0),o.shadowColor="rgba(0,0,0,0)"),y&&o.strokeText(A,0,0),o.translate(0,_)}}},_getBounds:function(o,u){var c=this._style,d=this._lines,f=d.length,p=c.getJustification(),y=c.getLeading(),_=this.getView().getTextWidth(c.getFontStyle(),d),w=0;p!=="left"&&(w-=_/(p==="center"?2:1));var E=new V(w,f?-.75*y:0,_,f*y);return o?o._transformBounds(E,E):E}}),yt=s.extend(new function(){var o={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},u={},c={transparent:[0,0,0,0]},d;function f(_){var w=_.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||_.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),E="rgb",b;if(w){var A=w[4]?4:3;b=new Array(A);for(var C=0;C<A;C++){var T=w[C+1];b[C]=parseInt(T.length==1?T+T:T,16)/255}}else if(w=_.match(/^(rgb|hsl)a?\((.*)\)$/)){E=w[1],b=w[2].trim().split(/[,\s]+/g);for(var k=E==="hsl",C=0,M=Math.min(b.length,4);C<M;C++){var F=b[C],T=parseFloat(F);if(k)if(C===0){var N=F.match(/([a-z]*)$/)[1];T*={turn:360,rad:180/Math.PI,grad:.9}[N]||1}else C<3&&(T/=100);else C<3&&(T/=/%$/.test(F)?100:255);b[C]=T}}else{var D=c[_];if(!D)if(r){d||(d=ae.getContext(1,1,{willReadFrequently:!0}),d.globalCompositeOperation="copy"),d.fillStyle="rgba(0,0,0,0)",d.fillStyle=_,d.fillRect(0,0,1,1);var x=d.getImageData(0,0,1,1).data;D=c[_]=[x[0]/255,x[1]/255,x[2]/255]}else D=[0,0,0];b=D.slice()}return[E,b]}var p=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],y={"rgb-hsb":function(_,w,E){var b=Math.max(_,w,E),A=Math.min(_,w,E),C=b-A,T=C===0?0:(b==_?(w-E)/C+(w<E?6:0):b==w?(E-_)/C+2:(_-w)/C+4)*60;return[T,b===0?0:C/b,b]},"hsb-rgb":function(_,w,E){_=(_/60%6+6)%6;var A=Math.floor(_),b=_-A,A=p[A],C=[E,E*(1-w),E*(1-w*b),E*(1-w*(1-b))];return[C[A[0]],C[A[1]],C[A[2]]]},"rgb-hsl":function(_,w,E){var b=Math.max(_,w,E),A=Math.min(_,w,E),C=b-A,T=C===0,k=T?0:(b==_?(w-E)/C+(w<E?6:0):b==w?(E-_)/C+2:(_-w)/C+4)*60,M=(b+A)/2,F=T?0:M<.5?C/(b+A):C/(2-b-A);return[k,F,M]},"hsl-rgb":function(_,w,E){if(_=(_/360%1+1)%1,w===0)return[E,E,E];for(var b=[_+1/3,_,_-1/3],A=E<.5?E*(1+w):E+w-E*w,C=2*E-A,T=[],k=0;k<3;k++){var M=b[k];M<0&&(M+=1),M>1&&(M-=1),T[k]=6*M<1?C+(A-C)*6*M:2*M<1?A:3*M<2?C+(A-C)*(2/3-M)*6:C}return T},"rgb-gray":function(_,w,E){return[_*.2989+w*.587+E*.114]},"gray-rgb":function(_){return[_,_,_]},"gray-hsb":function(_){return[0,0,_]},"gray-hsl":function(_){return[0,0,_]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return s.each(o,function(_,w){u[w]=[],s.each(_,function(E,b){var A=s.capitalize(E),C=/^(hue|saturation)$/.test(E),T=u[w][b]=w==="gradient"?E==="gradient"?function(k){var M=this._components[0];return k=pn.read(Array.isArray(k)?k:arguments,0,{readNull:!0}),M!==k&&(M&&M._removeOwner(this),k&&k._addOwner(this)),k}:function(){return S.read(arguments,0,{readNull:E==="highlight",clone:!0})}:function(k){return k==null||isNaN(k)?0:+k};this["get"+A]=function(){return this._type===w||C&&/^hs[bl]$/.test(this._type)?this._components[b]:this._convert(w)[b]},this["set"+A]=function(k){this._type!==w&&!(C&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(w),this._properties=o[w],this._type=w),this._components[b]=T.call(this,k),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function _(w){var E=arguments,b=this.__read,A=0,C,T,k,M;Array.isArray(w)&&(E=w,w=E[0]);var F=w!=null&&typeof w;if(F==="string"&&w in o&&(C=w,w=E[1],Array.isArray(w)?(T=w,k=E[2]):(b&&(A=1),E=s.slice(E,1),F=typeof w)),!T){if(M=F==="number"?E:F==="object"&&w.length!=null?w:null,M){C||(C=M.length>=3?"rgb":"gray");var N=o[C].length;k=M[N],b&&(A+=M===arguments?N+(k!=null?1:0):1),M.length>N&&(M=s.slice(M,0,N))}else if(F==="string"){var D=f(w);C=D[0],T=D[1],T.length===4&&(k=T[3],T.length--)}else if(F==="object")if(w.constructor===_){if(C=w._type,T=w._components.slice(),k=w._alpha,C==="gradient")for(var x=1,P=T.length;x<P;x++){var O=T[x];O&&(T[x]=O.clone())}}else if(w.constructor===pn)C="gradient",M=E;else{C="hue"in w?"lightness"in w?"hsl":"hsb":"gradient"in w||"stops"in w||"radial"in w?"gradient":"gray"in w?"gray":"rgb";var L=o[C],$=u[C];this._components=T=[];for(var x=0,P=L.length;x<P;x++){var H=w[L[x]];H==null&&!x&&C==="gradient"&&"stops"in w&&(H={stops:w.stops,radial:w.radial}),H=$[x].call(this,H),H!=null&&(T[x]=H)}k=w.alpha}b&&C&&(A=1)}if(this._type=C||"rgb",!T){this._components=T=[];for(var $=u[this._type],x=0,P=$.length;x<P;x++){var H=$[x].call(this,M&&M[x]);H!=null&&(T[x]=H)}}return this._components=T,this._properties=o[this._type],this._alpha=k,b&&(this.__read=A),this},set:"#initialize",_serialize:function(_,w){var E=this.getComponents();return s.serialize(/^(gray|rgb)$/.test(this._type)?E:[this._type].concat(E),_,!0,w)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(_){var w;return this._type===_?this._components.slice():(w=y[this._type+"-"+_])?w.apply(this,this._components):y["rgb-"+_].apply(this,y[this._type+"-rgb"].apply(this,this._components))},convert:function(_){return new yt(_,this._convert(_),this._alpha)},getType:function(){return this._type},setType:function(_){this._components=this._convert(_),this._properties=o[_],this._type=_},getComponents:function(){var _=this._components.slice();return this._alpha!=null&&_.push(this._alpha),_},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(_){this._alpha=_==null?null:Math.min(Math.max(_,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(_){var w=s.isPlainValue(_,!0)?yt.read(arguments):_;return w===this||w&&this._class===w._class&&this._type===w._type&&this.getAlpha()===w.getAlpha()&&s.equals(this._components,w._components)||!1},toString:function(){for(var _=this._properties,w=[],E=this._type==="gradient",b=m.instance,A=0,C=_.length;A<C;A++){var T=this._components[A];T!=null&&w.push(_[A]+": "+(E?T:b.number(T)))}return this._alpha!=null&&w.push("alpha: "+b.number(this._alpha)),"{ "+w.join(", ")+" }"},toCSS:function(_){var w=this._convert("rgb"),E=_||this._alpha==null?1:this._alpha;function b(A){return Math.round((A<0?0:A>1?1:A)*255)}return w=[b(w[0]),b(w[1]),b(w[2])],E<1&&w.push(E<0?0:E),_?"#"+((1<<24)+(w[0]<<16)+(w[1]<<8)+w[2]).toString(16).slice(1):(w.length==4?"rgba(":"rgb(")+w.join(",")+")"},toCanvasStyle:function(_,w){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var E=this._components,b=E[0],A=b._stops,C=E[1],T=E[2],k=E[3],M=w&&w.inverted(),F;if(M&&(C=M._transformPoint(C),T=M._transformPoint(T),k&&(k=M._transformPoint(k))),b._radial){var N=T.getDistance(C);if(k){var D=k.subtract(C);D.getLength()>N&&(k=C.add(D.normalize(N-.1)))}var x=k||C;F=_.createRadialGradient(x.x,x.y,0,C.x,C.y,N)}else F=_.createLinearGradient(C.x,C.y,T.x,T.y);for(var P=0,O=A.length;P<O;P++){var L=A[P],$=L._offset;F.addColorStop($??P/(O-1),L._color.toCanvasStyle())}return this._canvasStyle=F},transform:function(_){if(this._type==="gradient"){for(var w=this._components,E=1,b=w.length;E<b;E++){var A=w[E];_._transformPoint(A,A,!0)}this._changed()}},statics:{_types:o,random:function(){var _=Math.random;return new yt(_(),_(),_())},_setOwner:function(_,w,E){return _&&(_._owner&&w&&_._owner!==w&&(_=_.clone()),!_._owner^!w&&(_._owner=w||null,_._setter=E||null)),_}}})},new function(){var o={add:function(u,c){return u+c},subtract:function(u,c){return u-c},multiply:function(u,c){return u*c},divide:function(u,c){return u/c}};return s.each(o,function(u,c){this[c]=function(d){d=yt.read(arguments);for(var f=this._type,p=this._components,y=d._convert(f),_=0,w=p.length;_<w;_++)y[_]=u(p[_],y[_]);return new yt(f,y,this._alpha!=null?u(this._alpha,d.getAlpha()):null)}},{})}),pn=s.extend({_class:"Gradient",initialize:function(u,c){this._id=I.get(),u&&s.isPlainObject(u)&&(this.set(u),u=c=null),this._stops==null&&this.setStops(u||["white","black"]),this._radial==null&&this.setRadial(typeof c=="string"&&c==="radial"||c||!1)},_serialize:function(o,u){return u.add(this,function(){return s.serialize([this._stops,this._radial],o,!0,u)})},_changed:function(){for(var o=0,u=this._owners&&this._owners.length;o<u;o++)this._owners[o]._changed()},_addOwner:function(o){this._owners||(this._owners=[]),this._owners.push(o)},_removeOwner:function(o){var u=this._owners?this._owners.indexOf(o):-1;u!=-1&&(this._owners.splice(u,1),this._owners.length||(this._owners=n))},clone:function(){for(var o=[],u=0,c=this._stops.length;u<c;u++)o[u]=this._stops[u].clone();return new pn(o,this._radial)},getStops:function(){return this._stops},setStops:function(o){if(o.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var u=this._stops;if(u)for(var c=0,d=u.length;c<d;c++)u[c]._owner=n;u=this._stops=ir.readList(o,0,{clone:!0});for(var c=0,d=u.length;c<d;c++)u[c]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(o){this._radial=o,this._changed()},equals:function(o){if(o===this)return!0;if(o&&this._class===o._class){var u=this._stops,c=o._stops,d=u.length;if(d===c.length){for(var f=0;f<d;f++)if(!u[f].equals(c[f]))return!1;return!0}}return!1}}),ir=s.extend({_class:"GradientStop",initialize:function(u,c){var d=u,f=c;typeof u=="object"&&c===n&&(Array.isArray(u)&&typeof u[0]!="number"?(d=u[0],f=u[1]):("color"in u||"offset"in u||"rampPoint"in u)&&(d=u.color,f=u.offset||u.rampPoint||0)),this.setColor(d),this.setOffset(f)},clone:function(){return new ir(this._color.clone(),this._offset)},_serialize:function(o,u){var c=this._color,d=this._offset;return s.serialize(d==null?[c]:[c,d],o,!0,u)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(o){this._offset=o,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){yt._setOwner(this._color,null),this._color=yt._setOwner(yt.read(arguments,0),this,"setColor"),this._changed()},equals:function(o){return o===this||o&&this._class===o._class&&this._color.equals(o._color)&&this._offset==o._offset||!1}}),ls=s.extend(new function(){var o={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new S,selectedColor:null},u=s.set({},o,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),c=s.set({},u,{fillColor:new yt}),d={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},f={beans:!0},p={_class:"Style",beans:!0,initialize:function(_,w,E){this._values={},this._owner=w,this._project=w&&w._project||E||de.project,this._defaults=!w||w instanceof oe?u:w instanceof kt?c:o,_&&this.set(_)}};return s.each(u,function(y,_){var w=/Color$/.test(_),E=_==="shadowOffset",b=s.capitalize(_),A=d[_],C="set"+b,T="get"+b;p[C]=function(k){var M=this._owner,F=M&&M._children,N=F&&F.length>0&&!(M instanceof De);if(N)for(var D=0,x=F.length;D<x;D++)F[D]._style[C](k);if((_==="selectedColor"||!N)&&_ in this._defaults){var P=this._values[_];P!==k&&(w&&(P&&(yt._setOwner(P,null),P._canvasStyle=null),k&&k.constructor===yt&&(k=yt._setOwner(k,M,N&&C))),this._values[_]=k,M&&M._changed(A||129))}},p[T]=function(k){var M=this._owner,F=M&&M._children,N=F&&F.length>0&&!(M instanceof De),D;if(N&&!k)for(var x=0,P=F.length;x<P;x++){var O=F[x]._style[T]();if(!x)D=O;else if(!s.equals(D,O))return n}else if(_ in this._defaults){var D=this._values[_];if(D===n)D=this._defaults[_],D&&D.clone&&(D=D.clone());else{var L=w?yt:E?S:null;L&&!(D&&D.constructor===L)&&(this._values[_]=D=L.read([D],0,{readNull:!0,clone:!0}))}}return D&&w&&(D=yt._setOwner(D,M,N&&C)),D},f[T]=function(k){return this._style[T](k)},f[C]=function(k){this._style[C](k)}}),s.each({Font:"FontFamily",WindingRule:"FillRule"},function(y,_){var w="get"+_,E="set"+_;p[w]=f[w]="#get"+y,p[E]=f[E]="#set"+y}),te.inject(f),p},{set:function(o){var u=o instanceof ls,c=u?o._values:o;if(c){for(var d in c)if(d in this._defaults){var f=c[d];this[d]=f&&u&&f.clone?f.clone():f}}},equals:function(o){function u(c,d,f){var p=c._values,y=d._values,_=d._defaults;for(var w in p){var E=p[w],b=y[w];if(!(f&&w in y)&&!s.equals(E,b===n?_[w]:b))return!1}return!0}return o===this||o&&this._class===o._class&&u(this,o)&&u(o,this,!0)||!1},_dispose:function(){var o;o=this.getFillColor(),o&&(o._canvasStyle=null),o=this.getStrokeColor(),o&&(o._canvasStyle=null),o=this.getShadowColor(),o&&(o._canvasStyle=null)},hasFill:function(){var o=this.getFillColor();return!!o&&o.alpha>0},hasStroke:function(){var o=this.getStrokeColor();return!!o&&o.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var o=this.getShadowColor();return!!o&&o.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var o=this.getFontSize();return this.getFontWeight()+" "+o+(/[a-z]/i.test(o+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function o(){var u=o.base.call(this),c=this.getFontSize();return/pt|em|%|px/.test(c)&&(c=this.getView().getPixelSize(c)),u??c*1.2}}),bt=new function(){function o(u,c,d,f){for(var p=["","webkit","moz","Moz","ms","o"],y=c[0].toUpperCase()+c.substring(1),_=0;_<6;_++){var w=p[_],E=w?w+y:c;if(E in u){if(d)u[E]=f;else return u[E];break}}}return{getStyles:function(u){var c=u&&u.nodeType!==9?u.ownerDocument:u,d=c&&c.defaultView;return d&&d.getComputedStyle(u,"")},getBounds:function(u,c){var d=u.ownerDocument,f=d.body,p=d.documentElement,y;try{y=u.getBoundingClientRect()}catch{y={left:0,top:0,width:0,height:0}}var _=y.left-(p.clientLeft||f.clientLeft||0),w=y.top-(p.clientTop||f.clientTop||0);if(!c){var E=d.defaultView;_+=E.pageXOffset||p.scrollLeft||f.scrollLeft,w+=E.pageYOffset||p.scrollTop||f.scrollTop}return new V(_,w,y.width,y.height)},getViewportBounds:function(u){var c=u.ownerDocument,d=c.defaultView,f=c.documentElement;return new V(0,0,d.innerWidth||f.clientWidth,d.innerHeight||f.clientHeight)},getOffset:function(u,c){return bt.getBounds(u,c).getPoint()},getSize:function(u){return bt.getBounds(u,!0).getSize()},isInvisible:function(u){return bt.getSize(u).equals(new z(0,0))},isInView:function(u){return!bt.isInvisible(u)&&bt.getViewportBounds(u).intersects(bt.getBounds(u,!0))},isInserted:function(u){return i.body.contains(u)},getPrefixed:function(u,c){return u&&o(u,c)},setPrefixed:function(u,c,d){if(typeof c=="object")for(var f in c)o(u,f,!0,c[f]);else o(u,c,!0,d)}}},zt={add:function(o,u){if(o)for(var c in u)for(var d=u[c],f=c.split(/[\s,]+/g),p=0,y=f.length;p<y;p++){var _=f[p],w=o===i&&(_==="touchstart"||_==="touchmove")?{passive:!1}:!1;o.addEventListener(_,d,w)}},remove:function(o,u){if(o)for(var c in u)for(var d=u[c],f=c.split(/[\s,]+/g),p=0,y=f.length;p<y;p++)o.removeEventListener(f[p],d,!1)},getPoint:function(o){var u=o.targetTouches?o.targetTouches.length?o.targetTouches[0]:o.changedTouches[0]:o;return new S(u.pageX||u.clientX+i.documentElement.scrollLeft,u.pageY||u.clientY+i.documentElement.scrollTop)},getTarget:function(o){return o.target||o.srcElement},getRelatedTarget:function(o){return o.relatedTarget||o.toElement},getOffset:function(o,u){return zt.getPoint(o).subtract(bt.getOffset(u||zt.getTarget(o)))}};zt.requestAnimationFrame=new function(){var o=bt.getPrefixed(r,"requestAnimationFrame"),u=!1,c=[],d;function f(){var p=c;c=[];for(var y=0,_=p.length;y<_;y++)p[y]();u=o&&c.length,u&&o(f)}return function(p){c.push(p),o?u||(o(f),u=!0):d||(d=setInterval(f,1e3/60))}};var Nt=s.extend(a,{_class:"View",initialize:function o(u,c){function d(A){return c[A]||parseInt(c.getAttribute(A),10)}function f(){var A=bt.getSize(c);return A.isNaN()||A.isZero()?new z(d("width"),d("height")):A}var p;if(r&&c){this._id=c.getAttribute("id"),this._id==null&&c.setAttribute("id",this._id="paper-view-"+o._id++),zt.add(c,this._viewEvents);var y="none";if(bt.setPrefixed(c.style,{userDrag:y,userSelect:y,touchCallout:y,contentZooming:y,tapHighlightColor:"rgba(0,0,0,0)"}),l.hasAttribute(c,"resize")){var _=this;zt.add(r,this._windowEvents={resize:function(){_.setViewSize(f())}})}if(p=f(),l.hasAttribute(c,"stats")&&typeof Stats<"u"){this._stats=new Stats;var w=this._stats.domElement,E=w.style,b=bt.getOffset(c);E.position="absolute",E.left=b.x+"px",E.top=b.y+"px",i.body.appendChild(w)}}else p=new z(c),c=null;this._project=u,this._scope=u._scope,this._element=c,this._pixelRatio||(this._pixelRatio=r&&r.devicePixelRatio||1),this._setElementSize(p.width,p.height),this._viewSize=p,o._views.push(this),o._viewsById[this._id]=this,(this._matrix=new U)._owner=this,o._focused||(o._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!de.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Nt._focused===this&&(Nt._focused=null),Nt._views.splice(Nt._views.indexOf(this),1),delete Nt._viewsById[this._id];var o=this._project;return o._view===this&&(o._view=null),zt.remove(this._element,this._viewEvents),zt.remove(r,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:s.each(te._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(o){this[o]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(o){this._autoUpdate=o,o&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var o=this;zt.requestAnimationFrame(function(){if(o._requested=!1,o._animate){o.requestUpdate();var u=o._element;(!bt.getPrefixed(i,"hidden")||l.getAttribute(u,"keepalive")==="true")&&bt.isInView(u)&&o._handleFrame()}o._autoUpdate&&o.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){de=this._scope;var o=Date.now()/1e3,u=this._last?o-this._last:0;this._last=o,this.emit("frame",new s({delta:u,time:this._time+=u,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(o,u){var c=this._frameItems;u?(c[o._id]={item:o,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete c[o._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(o){for(var u in this._frameItems){var c=this._frameItems[u];c.item.emit("frame",new s(o,{time:c.time+=o.delta,count:c.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=n},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var o=this._viewSize;return new J(o.width,o.height,this,"setViewSize")},setViewSize:function(){var o=z.read(arguments),u=o.subtract(this._viewSize);u.isZero()||(this._setElementSize(o.width,o.height),this._viewSize.set(o),this._changed(),this.emit("resize",{size:o,delta:u}),this._autoUpdate&&this.update())},_setElementSize:function(o,u){var c=this._element;c&&(c.width!==o&&(c.width=o),c.height!==u&&(c.height=u))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new V(new S,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return bt.isInView(this._element)},isInserted:function(){return bt.isInserted(this._element)},getPixelSize:function(o){var u=this._element,c;if(u){var d=u.parentNode,f=i.createElement("div");f.style.fontSize=o,d.appendChild(f),c=parseFloat(bt.getStyles(f).fontSize),d.removeChild(f)}else c=parseFloat(c);return c},getTextWidth:function(o,u){return 0}},s.each(["rotate","scale","shear","skew"],function(o){var u=o==="rotate";this[o]=function(){var c=arguments,d=(u?s:S).read(c),f=S.read(c,0,{readNull:!0});return this.transform(new U()[o](d,f||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var o=new U;return this.transform(o.translate.apply(o,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var o=S.read(arguments);this.translate(this.getCenter().subtract(o))},getZoom:function(){var o=this._decompose().scaling;return(o.x+o.y)/2},setZoom:function(o){this.transform(new U().scale(o/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(o){var u=this.getRotation();u!=null&&o!=null&&this.rotate(o-u)},getScaling:function(){var o=this._decompose().scaling;return new j(o.x,o.y,this,"setScaling")},setScaling:function(){var o=this.getScaling(),u=S.read(arguments,0,{clone:!0,readNull:!0});o&&u&&this.scale(u.x/o.x,u.y/o.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var o=this._matrix;o.set.apply(o,arguments)},transform:function(o){this._matrix.append(o)},scrollBy:function(){this.translate(S.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(S.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(S.read(arguments))},getEventPoint:function(o){return this.viewToProject(zt.getOffset(o,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(o,u){i&&typeof u=="string"&&(u=i.getElementById(u));var c=r?Lr:Nt;return new c(o,u)}}},new function(){if(!r)return;var o,u,c=!1,d=!1;function f(K){var Y=zt.getTarget(K);return Y.getAttribute&&Nt._viewsById[Y.getAttribute("id")]}function p(){var K=Nt._focused;if(!K||!K.isVisible()){for(var Y=0,ee=Nt._views.length;Y<ee;Y++)if((K=Nt._views[Y]).isVisible()){Nt._focused=u=K;break}}}function y(K,Y,ee){K._handleMouseEvent("mousemove",Y,ee)}var _=r.navigator,w,E,b;_.pointerEnabled||_.msPointerEnabled?(w="pointerdown MSPointerDown",E="pointermove MSPointerMove",b="pointerup pointercancel MSPointerUp MSPointerCancel"):(w="touchstart",E="touchmove",b="touchend touchcancel","ontouchstart"in r&&_.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(w+=" mousedown",E+=" mousemove",b+=" mouseup"));var A={},C={mouseout:function(K){var Y=Nt._focused,ee=zt.getRelatedTarget(K);if(Y&&(!ee||ee.nodeName==="HTML")){var re=zt.getOffset(K,Y._element),se=re.x,ue=Math.abs,Ee=ue(se),Te=1<<25,Pe=Ee-Te;re.x=ue(Pe)<Ee?Pe*(se<0?-1:1):se,y(Y,K,Y.viewToProject(re))}},scroll:p};A[w]=function(K){var Y=Nt._focused=f(K);c||(c=!0,Y._handleMouseEvent("mousedown",K))},C[E]=function(K){var Y=Nt._focused;if(!d){var ee=f(K);ee?Y!==ee&&(Y&&y(Y,K),o||(o=Y),Y=Nt._focused=u=ee):u&&u===Y&&(o&&!o.isInserted()&&(o=null),Y=Nt._focused=o,o=null,p())}Y&&y(Y,K)},C[w]=function(){d=!0},C[b]=function(K){var Y=Nt._focused;Y&&c&&Y._handleMouseEvent("mouseup",K),d=c=!1},zt.add(i,C),zt.add(r,{load:p});var T=!1,k=!1,M={doubleclick:"click",mousedrag:"mousemove"},F=!1,N,D,x,P,O,L,$,H;function q(K,Y,ee,re,se,ue,Ee){var Te=!1,Pe;function Qe(qe,He){if(qe.responds(He)){if(Pe||(Pe=new ea(He,re,se,Y||qe,ue?se.subtract(ue):null)),qe.emit(He,Pe)&&(T=!0,Pe.prevented&&(k=!0),Pe.stopped))return Te=!0}else{var $e=M[He];if($e)return Qe(qe,$e)}}for(;K&&K!==Ee&&!Qe(K,ee);)K=K._parent;return Te}function W(K,Y,ee,re,se,ue){return K._project.removeOn(ee),k=T=!1,O&&q(O,null,ee,re,se,ue)||Y&&Y!==O&&!Y.isDescendant(O)&&q(Y,null,ee==="mousedrag"?"mousemove":ee,re,se,ue,O)||q(K,O||Y||K,ee,re,se,ue)}var Q={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:A,_handleMouseEvent:function(K,Y,ee){var re=this._itemEvents,se=re.native[K],ue=K==="mousemove",Ee=this._scope.tool,Te=this;function Pe(wt){return re.virtual[wt]||Te.responds(wt)||Ee&&Ee.responds(wt)}ue&&c&&Pe("mousedrag")&&(K="mousedrag"),ee||(ee=this.getEventPoint(Y));var Qe=this.getBounds().contains(ee),qe=se&&Qe&&Te._project.hitTest(ee,{tolerance:0,fill:!0,stroke:!0}),He=qe&&qe.item||null,$e=!1,Ze={};if(Ze[K.substr(5)]=!0,se&&He!==P&&(P&&q(P,null,"mouseleave",Y,ee),He&&q(He,null,"mouseenter",Y,ee),P=He),F^Qe&&(q(this,null,Qe?"mouseenter":"mouseleave",Y,ee),$e=!0),(Qe||Ze.drag)&&!ee.equals(D)&&(W(this,He,ue?K:"mousemove",Y,ee,D),$e=!0),F=Qe,Ze.down&&Qe||Ze.up&&N){if(W(this,He,K,Y,ee,N),Ze.down){if(H=He===L&&Date.now()-$<300,x=L=He,!k&&He){for(var Ke=He;Ke&&!Ke.responds("mousedrag");)Ke=Ke._parent;Ke&&(O=He)}N=ee}else Ze.up&&(!k&&He===x&&($=Date.now(),W(this,He,H?"doubleclick":"click",Y,ee,N),H=!1),x=O=null);F=!1,$e=!0}D=ee,$e&&Ee&&(T=Ee._handleMouseEvent(K,Y,ee,Ze)||T),Y.cancelable!==!1&&(T&&!Ze.move||Ze.down&&Pe("mouseup"))&&Y.preventDefault()},_handleKeyEvent:function(K,Y,ee,re){var se=this._scope,ue=se.tool,Ee;function Te(Pe){Pe.responds(K)&&(de=se,Pe.emit(K,Ee=Ee||new fi(K,Y,ee,re)))}this.isVisible()&&(Te(this),ue&&ue.responds(K)&&Te(ue))},_countItemEvent:function(K,Y){var ee=this._itemEvents,re=ee.native,se=ee.virtual;for(var ue in Q)re[ue]=(re[ue]||0)+(Q[ue][K]||0)*Y;se[K]=(se[K]||0)+Y},statics:{updateFocus:p,_resetState:function(){c=d=T=F=!1,o=u=N=D=x=P=O=L=$=H=null}}}}),Lr=Nt.extend({_class:"CanvasView",initialize:function(u,c){if(!(c instanceof r.HTMLCanvasElement)){var d=z.read(arguments,1);if(d.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+s.slice(arguments,1));c=ae.getCanvas(d)}var f=this._context=c.getContext("2d");if(f.save(),this._pixelRatio=1,!/^off|false$/.test(l.getAttribute(c,"hidpi"))){var p=r.devicePixelRatio||1,y=bt.getPrefixed(f,"backingStorePixelRatio")||1;this._pixelRatio=p/y}Nt.call(this,u,c),this._needsUpdate=!0},remove:function o(){return this._context.restore(),o.base.call(this)},_setElementSize:function o(u,c){var d=this._pixelRatio;if(o.base.call(this,u*d,c*d),d!==1){var f=this._element,p=this._context;if(!l.hasAttribute(f,"resize")){var y=f.style;y.width=u+"px",y.height=c+"px"}p.restore(),p.save(),p.scale(d,d)}},getContext:function(){return this._context},getPixelSize:function o(u){var c=de.agent,d;if(c&&c.firefox)d=o.base.call(this,u);else{var f=this._context,p=f.font;f.font=u+" serif",d=parseFloat(f.font),f.font=p}return d},getTextWidth:function(o,u){var c=this._context,d=c.font,f=0;c.font=o;for(var p=0,y=u.length;p<y;p++)f=Math.max(f,c.measureText(u[p]).width);return c.font=d,f},update:function(){if(!this._needsUpdate)return!1;var o=this._project,u=this._context,c=this._viewSize;return u.clearRect(0,0,c.width+1,c.height+1),o&&o.draw(u,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Er=s.extend({_class:"Event",initialize:function(u){this.event=u,this.type=u&&u.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Ni.modifiers}}),fi=Er.extend({_class:"KeyEvent",initialize:function(u,c,d,f){this.type=u,this.event=c,this.key=d,this.character=f},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Ni=new function(){var o={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},u={tab:"	",space:" ",enter:"\r"},c={},d={},f,p,y=new s({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var E=de&&de.agent;return E&&E.mac?this.meta:this.control}}});function _(E){var b=E.key||E.keyIdentifier;return b=/^U\+/.test(b)?String.fromCharCode(parseInt(b.substr(2),16)):/^Arrow[A-Z]/.test(b)?b.substr(5):b==="Unidentified"||b===n?String.fromCharCode(E.keyCode):b,o[b]||(b.length>1?s.hyphenate(b):b.toLowerCase())}function w(E,b,A,C){var T=Nt._focused,k;if(c[b]=E,E?d[b]=A:delete d[b],b.length>1&&(k=s.camelize(b))in y){y[k]=E;var M=de&&de.agent;if(k==="meta"&&M&&M.mac)if(E)f={};else{for(var F in f)F in d&&w(!1,F,f[F],C);f=null}}else E&&f&&(f[b]=A);T&&T._handleKeyEvent(E?"keydown":"keyup",C,b,A)}return zt.add(i,{keydown:function(E){var b=_(E),A=de&&de.agent;b.length>1||A&&A.chrome&&(E.altKey||A.mac&&E.metaKey||!A.mac&&E.ctrlKey)?w(!0,b,u[b]||(b.length>1?"":b),E):p=b},keypress:function(E){if(p){var b=_(E),A=E.charCode,C=A>=32?String.fromCharCode(A):b.length>1?"":b;b!==p&&(b=C.toLowerCase()),w(!0,b,C,E),p=null}},keyup:function(E){var b=_(E);b in d&&w(!1,b,d[b],E)}}),zt.add(r,{blur:function(E){for(var b in d)w(!1,b,d[b],E)}}),{modifiers:y,isDown:function(E){return!!c[E]}}},ea=Er.extend({_class:"MouseEvent",initialize:function(u,c,d,f,p){this.type=u,this.event=c,this.point=d,this.target=f,this.delta=p},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Bd=Er.extend({_class:"ToolEvent",_item:null,initialize:function(u,c,d){this.tool=u,this.type=c,this.event=d},_choosePoint:function(o,u){return o||(u?u.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(o){this._point=o},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(o){this._lastPoint=o},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(o){this._downPoint=o},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(o){this._middlePoint=o},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(o){this._delta=o},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(o){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=o},getItem:function(){if(!this._item){var o=this.tool._scope.project.hitTest(this.getPoint());if(o){for(var u=o.item,c=u._parent;/^(Group|CompoundPath)$/.test(c._class);)u=c,c=c._parent;this._item=u}}return this._item},setItem:function(o){this._item=o},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}});h.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(u){h.call(this),this._moveCount=-1,this._downCount=-1,this.set(u)},getMinDistance:function(){return this._minDistance},setMinDistance:function(o){this._minDistance=o,o!=null&&this._maxDistance!=null&&o>this._maxDistance&&(this._maxDistance=o)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(o){this._maxDistance=o,this._minDistance!=null&&o!=null&&o<this._minDistance&&(this._minDistance=o)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(o){this._minDistance=this._maxDistance=o},_handleMouseEvent:function(o,u,c,d){de=this._scope,d.drag&&!this.responds(o)&&(o="mousemove");var f=d.move||d.drag,p=this.responds(o),y=this.minDistance,_=this.maxDistance,w=!1,E=this;function b(C,T){var k=c,M=f?E._point:E._downPoint||k;if(f){if(E._moveCount>=0&&k.equals(M))return!1;if(M&&(C!=null||T!=null)){var F=k.subtract(M),N=F.getLength();if(N<(C||0))return!1;T&&(k=M.add(F.normalize(Math.min(N,T))))}E._moveCount++}return E._point=k,E._lastPoint=M||k,d.down&&(E._moveCount=-1,E._downPoint=k,E._downCount++),!0}function A(){p&&(w=E.emit(o,new Bd(E,o,u))||w)}if(d.down)b(),A();else if(d.up)b(null,_),A();else if(p)for(;b(y,_);)A();return w}});var hu=s.extend(a,{_class:"Tween",statics:{easings:new s({linear:function(o){return o},easeInQuad:function(o){return o*o},easeOutQuad:function(o){return o*(2-o)},easeInOutQuad:function(o){return o<.5?2*o*o:-1+2*(2-o)*o},easeInCubic:function(o){return o*o*o},easeOutCubic:function(o){return--o*o*o+1},easeInOutCubic:function(o){return o<.5?4*o*o*o:(o-1)*(2*o-2)*(2*o-2)+1},easeInQuart:function(o){return o*o*o*o},easeOutQuart:function(o){return 1- --o*o*o*o},easeInOutQuart:function(o){return o<.5?8*o*o*o*o:1-8*--o*o*o*o},easeInQuint:function(o){return o*o*o*o*o},easeOutQuint:function(o){return 1+--o*o*o*o*o},easeInOutQuint:function(o){return o<.5?16*o*o*o*o*o:1+16*--o*o*o*o*o}})},initialize:function o(u,c,d,f,p,y){this.object=u;var _=typeof p,w=_==="function";this.type=w?_:_==="string"?p:"linear",this.easing=w?p:o.easings[this.type],this.duration=f,this.running=!1,this._then=null,this._startTime=null;var E=c||d;this._keys=E?Object.keys(E):[],this._parsedKeys=this._parseKeys(this._keys),this._from=E&&this._getState(c),this._to=E&&this._getState(d),y!==!1&&this.start()},then:function(o){return this._then=o,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(o){if(this.running){o>=1&&(o=1,this.running=!1);for(var u=this.easing(o),c=this._keys,d=function(b){return typeof b=="function"?b(u,o):b},f=0,p=c&&c.length;f<p;f++){var y=c[f],_=d(this._from[y]),w=d(this._to[y]),E=_&&w&&_.__add&&w.__add?w.__subtract(_).__multiply(u).__add(_):(w-_)*u+_;this._setProperty(this._parsedKeys[y],E)}this.responds("update")&&this.emit("update",new s({progress:o,factor:u})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(o){var u=this._startTime,c=u?(o-u)/this.duration:0;u||(this._startTime=o),this.update(c)},_getState:function(o){for(var u=this._keys,c={},d=0,f=u.length;d<f;d++){var p=u[d],y=this._parsedKeys[p],_=this._getProperty(y),w;if(o){var E=this._resolveValue(_,o[p]);this._setProperty(y,E),w=this._getProperty(y),w=w&&w.clone?w.clone():w,this._setProperty(y,_)}else w=_&&_.clone?_.clone():_;c[p]=w}return c},_resolveValue:function(o,u){if(u){if(Array.isArray(u)&&u.length===2){var c=u[0];return c&&c.match&&c.match(/^[+\-\*\/]=/)?this._calculate(o,c[0],u[1]):u}else if(typeof u=="string"){var d=u.match(/^[+\-*/]=(.*)/);if(d){var f=JSON.parse(d[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(o,u[0],f)}}}return u},_calculate:function(o,u,c){return de.PaperScript.calculateBinary(o,u,c)},_parseKeys:function(o){for(var u={},c=0,d=o.length;c<d;c++){var f=o[c],p=f.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");u[f]=p.split("/")}return u},_getProperty:function(o,u){for(var c=this.object,d=0,f=o.length-(u||0);d<f&&c;d++)c=c[o[d]];return c},_setProperty:function(o,u){var c=this._getProperty(o,1);c&&(c[o[o.length-1]]=u)}}),X={request:function(o){var u=new e.XMLHttpRequest;return u.open((o.method||"get").toUpperCase(),o.url,s.pick(o.async,!0)),o.mimeType&&u.overrideMimeType(o.mimeType),u.onload=function(){var c=u.status;c===0||c===200?o.onLoad&&o.onLoad.call(u,u.responseText):u.onerror()},u.onerror=function(){var c=u.status,d='Could not load "'+o.url+'" (Status: '+c+")";if(o.onError)o.onError(d,c);else throw new Error(d)},u.send(null)}},ae=s.exports.CanvasProvider={canvases:[],getCanvas:function(o,u,c){if(!r)return null;var d,f=!0;typeof o=="object"&&(u=o.height,o=o.width),this.canvases.length?d=this.canvases.pop():(d=i.createElement("canvas"),f=!1);var p=d.getContext("2d",c||{});if(!p)throw new Error("Canvas "+d+" is unable to provide a 2D context.");return d.width===o&&d.height===u?f&&p.clearRect(0,0,o+1,u+1):(d.width=o,d.height=u),p.save(),d},getContext:function(o,u,c){var d=this.getCanvas(o,u,c);return d?d.getContext("2d",c||{}):null},release:function(o){var u=o&&o.canvas?o.canvas:o;u&&u.getContext&&(u.getContext("2d").restore(),this.canvases.push(u))}},ge=new function(){var o=Math.min,u=Math.max,c=Math.abs,d,f,p,y,_,w,E,b,A,C,T;function k(O,L,$){return .2989*O+.587*L+.114*$}function M(O,L,$,W){var q=W-k(O,L,$);A=O+q,C=L+q,T=$+q;var W=k(A,C,T),Q=o(A,C,T),K=u(A,C,T);if(Q<0){var Y=W-Q;A=W+(A-W)*W/Y,C=W+(C-W)*W/Y,T=W+(T-W)*W/Y}if(K>255){var ee=255-W,re=K-W;A=W+(A-W)*ee/re,C=W+(C-W)*ee/re,T=W+(T-W)*ee/re}}function F(O,L,$){return u(O,L,$)-o(O,L,$)}function N(O,L,$,H){var q=[O,L,$],W=u(O,L,$),Q=o(O,L,$),K;Q=Q===O?0:Q===L?1:2,W=W===O?0:W===L?1:2,K=o(Q,W)===0?u(Q,W)===1?2:1:0,q[W]>q[Q]?(q[K]=(q[K]-q[Q])*H/(q[W]-q[Q]),q[W]=H):q[K]=q[W]=0,q[Q]=0,A=q[0],C=q[1],T=q[2]}var D={multiply:function(){A=_*d/255,C=w*f/255,T=E*p/255},screen:function(){A=_+d-_*d/255,C=w+f-w*f/255,T=E+p-E*p/255},overlay:function(){A=_<128?2*_*d/255:255-2*(255-_)*(255-d)/255,C=w<128?2*w*f/255:255-2*(255-w)*(255-f)/255,T=E<128?2*E*p/255:255-2*(255-E)*(255-p)/255},"soft-light":function(){var O=d*_/255;A=O+_*(255-(255-_)*(255-d)/255-O)/255,O=f*w/255,C=O+w*(255-(255-w)*(255-f)/255-O)/255,O=p*E/255,T=O+E*(255-(255-E)*(255-p)/255-O)/255},"hard-light":function(){A=d<128?2*d*_/255:255-2*(255-d)*(255-_)/255,C=f<128?2*f*w/255:255-2*(255-f)*(255-w)/255,T=p<128?2*p*E/255:255-2*(255-p)*(255-E)/255},"color-dodge":function(){A=_===0?0:d===255?255:o(255,255*_/(255-d)),C=w===0?0:f===255?255:o(255,255*w/(255-f)),T=E===0?0:p===255?255:o(255,255*E/(255-p))},"color-burn":function(){A=_===255?255:d===0?0:u(0,255-(255-_)*255/d),C=w===255?255:f===0?0:u(0,255-(255-w)*255/f),T=E===255?255:p===0?0:u(0,255-(255-E)*255/p)},darken:function(){A=_<d?_:d,C=w<f?w:f,T=E<p?E:p},lighten:function(){A=_>d?_:d,C=w>f?w:f,T=E>p?E:p},difference:function(){A=_-d,A<0&&(A=-A),C=w-f,C<0&&(C=-C),T=E-p,T<0&&(T=-T)},exclusion:function(){A=_+d*(255-_-_)/255,C=w+f*(255-w-w)/255,T=E+p*(255-E-E)/255},hue:function(){N(d,f,p,F(_,w,E)),M(A,C,T,k(_,w,E))},saturation:function(){N(_,w,E,F(d,f,p)),M(A,C,T,k(_,w,E))},luminosity:function(){M(_,w,E,k(d,f,p))},color:function(){M(d,f,p,k(_,w,E))},add:function(){A=o(_+d,255),C=o(w+f,255),T=o(E+p,255)},subtract:function(){A=u(_-d,0),C=u(w-f,0),T=u(E-p,0)},average:function(){A=(_+d)/2,C=(w+f)/2,T=(E+p)/2},negation:function(){A=255-c(255-d-_),C=255-c(255-f-w),T=255-c(255-p-E)}},x=this.nativeModes=s.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(O){this[O]=!0},{}),P=ae.getContext(1,1,{willReadFrequently:!0});P&&(s.each(D,function(O,L){var $=L==="darken",H=!1;P.save();try{P.fillStyle=$?"#300":"#a00",P.fillRect(0,0,1,1),P.globalCompositeOperation=L,P.globalCompositeOperation===L&&(P.fillStyle=$?"#a00":"#300",P.fillRect(0,0,1,1),H=P.getImageData(0,0,1,1).data[0]!==$?170:51)}catch{}P.restore(),x[L]=H}),ae.release(P)),this.process=function(O,L,$,H,q){var W=L.canvas,Q=O==="normal";if(Q||x[O])$.save(),$.setTransform(1,0,0,1,0,0),$.globalAlpha=H,Q||($.globalCompositeOperation=O),$.drawImage(W,q.x,q.y),$.restore();else{var K=D[O];if(!K)return;for(var Y=$.getImageData(q.x,q.y,W.width,W.height),ee=Y.data,re=L.getImageData(0,0,W.width,W.height).data,se=0,ue=ee.length;se<ue;se+=4){d=re[se],_=ee[se],f=re[se+1],w=ee[se+1],p=re[se+2],E=ee[se+2],y=re[se+3],b=ee[se+3],K();var Ee=y*H/255,Te=1-Ee;ee[se]=Ee*A+Te*_,ee[se+1]=Ee*C+Te*w,ee[se+2]=Ee*T+Te*E,ee[se+3]=y*H+Te*b}$.putImageData(Y,q.x,q.y)}}},Ce=new function(){var o="http://www.w3.org/2000/svg",u="http://www.w3.org/2000/xmlns",c="http://www.w3.org/1999/xlink",d={href:c,xlink:u,xmlns:u+"/","xmlns:xlink":u+"/"};function f(_,w,E){return y(i.createElementNS(o,_),w,E)}function p(_,w){var E=d[w],b=E?_.getAttributeNS(E,w):_.getAttribute(w);return b==="null"?null:b}function y(_,w,E){for(var b in w){var A=w[b],C=d[b];typeof A=="number"&&E&&(A=E.number(A)),C?_.setAttributeNS(C,b,A):_.setAttribute(b,A)}return _}return{svg:o,xmlns:u,xlink:c,create:f,get:p,set:y}},Re=s.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(o,u){return!u&&(o instanceof xe||o instanceof _e||o instanceof kt)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(o,u){var c=s.capitalize(u),d=o[2];this[u]={type:o[1],property:u,attribute:o[0],toSVG:d,fromSVG:d&&s.each(d,function(f,p){this[f]=p},{}),exportFilter:o[3],get:"get"+c,set:"set"+c}},{});new function(){var o;function u(D,x,P){var O=new s,L=D.getTranslation();if(x){var $;D.isInvertible()?(D=D._shiftless(),$=D._inverseTransform(L),L=null):$=new S,O[P?"cx":"x"]=$.x,O[P?"cy":"y"]=$.y}if(!D.isIdentity()){var H=D.decompose();if(H){var q=[],W=H.rotation,Q=H.scaling,K=H.skewing;L&&!L.isZero()&&q.push("translate("+o.point(L)+")"),W&&q.push("rotate("+o.number(W)+")"),(!v.isZero(Q.x-1)||!v.isZero(Q.y-1))&&q.push("scale("+o.point(Q)+")"),K.x&&q.push("skewX("+o.number(K.x)+")"),K.y&&q.push("skewY("+o.number(K.y)+")"),O.transform=q.join(" ")}else O.transform="matrix("+D.getValues().join(",")+")"}return O}function c(D,x){for(var P=u(D._matrix),O=D._children,L=Ce.create("g",P,o),$=0,H=O.length;$<H;$++){var q=O[$],W=F(q,x);if(W)if(q.isClipMask()){var Q=Ce.create("clipPath");Q.appendChild(W),k(q,Q,"clip"),Ce.set(L,{"clip-path":"url(#"+Q.id+")"})}else L.appendChild(W)}return L}function d(D,x){var P=u(D._matrix,!0),O=D.getSize(),L=D.getImage();return P.x-=O.width/2,P.y-=O.height/2,P.width=O.width,P.height=O.height,P.href=x.embedImages==!1&&L&&L.src||D.toDataURL(),Ce.create("image",P,o)}function f(D,x){var P=x.matchShapes;if(P){var O=D.toShape(!1);if(O)return p(O)}var L=D._segments,$=L.length,H,q=u(D._matrix);if(P&&$>=2&&!D.hasHandles())if($>2){H=D._closed?"polygon":"polyline";for(var W=[],Q=0;Q<$;Q++)W.push(o.point(L[Q]._point));q.points=W.join(" ")}else{H="line";var K=L[0]._point,Y=L[1]._point;q.set({x1:K.x,y1:K.y,x2:Y.x,y2:Y.y})}else H="path",q.d=D.getPathData(null,x.precision);return Ce.create(H,q,o)}function p(D){var x=D._type,P=D._radius,O=u(D._matrix,!0,x!=="rectangle");if(x==="rectangle"){x="rect";var L=D._size,$=L.width,H=L.height;O.x-=$/2,O.y-=H/2,O.width=$,O.height=H,P.isZero()&&(P=null)}return P&&(x==="circle"?O.r=P:(O.rx=P.width,O.ry=P.height)),Ce.create(x,O,o)}function y(D,x){var P=u(D._matrix),O=D.getPathData(null,x.precision);return O&&(P.d=O),Ce.create("path",P,o)}function _(D,x){var P=u(D._matrix,!0),O=D._definition,L=T(O,"symbol"),$=O._item,H=$.getStrokeBounds();return L||(L=Ce.create("symbol",{viewBox:o.rectangle(H)}),L.appendChild(F($,x)),k(O,L,"symbol")),P.href="#"+L.id,P.x+=H.x,P.y+=H.y,P.width=H.width,P.height=H.height,P.overflow="visible",Ce.create("use",P,o)}function w(D){var x=T(D,"color");if(!x){var P=D.getGradient(),O=P._radial,L=D.getOrigin(),$=D.getDestination(),H;if(O){H={cx:L.x,cy:L.y,r:L.getDistance($)};var q=D.getHighlight();q&&(H.fx=q.x,H.fy=q.y)}else H={x1:L.x,y1:L.y,x2:$.x,y2:$.y};H.gradientUnits="userSpaceOnUse",x=Ce.create((O?"radial":"linear")+"Gradient",H,o);for(var W=P._stops,Q=0,K=W.length;Q<K;Q++){var Y=W[Q],ee=Y._color,re=ee.getAlpha(),se=Y._offset;H={offset:se??Q/(K-1)},ee&&(H["stop-color"]=ee.toCSS(!0)),re<1&&(H["stop-opacity"]=re),x.appendChild(Ce.create("stop",H,o))}k(D,x,"color")}return"url(#"+x.id+")"}function E(D){var x=Ce.create("text",u(D._matrix,!0),o);return x.textContent=D._content,x}var b={Group:c,Layer:c,Raster:d,Path:f,Shape:p,CompoundPath:y,SymbolItem:_,PointText:E};function A(D,x,P){var O={},L=!P&&D.getParent(),$=[];return D._name!=null&&(O.id=D._name),s.each(Re,function(H){var q=H.get,W=H.type,Q=D[q]();if(H.exportFilter?H.exportFilter(D,Q):!L||!s.equals(L[q](),Q)){if(W==="color"&&Q!=null){var K=Q.getAlpha();K<1&&(O[H.attribute+"-opacity"]=K)}W==="style"?$.push(H.attribute+": "+Q):O[H.attribute]=Q==null?"none":W==="color"?Q.gradient?w(Q):Q.toCSS(!0):W==="array"?Q.join(","):W==="lookup"?H.toSVG[Q]:Q}}),$.length&&(O.style=$.join(";")),O.opacity===1&&delete O.opacity,D._visible||(O.visibility="hidden"),Ce.set(x,O,o)}var C;function T(D,x){return C||(C={ids:{},svgs:{}}),D&&C.svgs[x+"-"+(D._id||D.__id||(D.__id=I.get("svg")))]}function k(D,x,P){C||T();var O=C.ids[P]=(C.ids[P]||0)+1;x.id=P+"-"+O,C.svgs[P+"-"+(D._id||D.__id)]=x}function M(D,x){var P=D,O=null;if(C){P=D.nodeName.toLowerCase()==="svg"&&D;for(var L in C.svgs)O||(P||(P=Ce.create("svg"),P.appendChild(D)),O=P.insertBefore(Ce.create("defs"),P.firstChild)),O.appendChild(C.svgs[L]);C=null}return x.asString?new e.XMLSerializer().serializeToString(P):P}function F(D,x,P){var O=b[D._class],L=O&&O(D,x);if(L){var $=x.onExport;$&&(L=$(D,L,x)||L);var H=JSON.stringify(D._data);H&&H!=="{}"&&H!=="null"&&L.setAttribute("data-paper-data",H)}return L&&A(D,L,P)}function N(D){return D||(D={}),o=new m(D.precision),D}te.inject({exportSVG:function(D){return D=N(D),M(F(this,D,!0),D)}}),ne.inject({exportSVG:function(D){D=N(D);var x=this._children,P=this.getView(),O=s.pick(D.bounds,"view"),L=D.matrix||O==="view"&&P._matrix,$=L&&U.read([L]),H=O==="view"?new V([0,0],P.getViewSize()):O==="content"?te._getBounds(x,$,{stroke:!0}).rect:V.read([O],0,{readNull:!0}),q={version:"1.1",xmlns:Ce.svg,"xmlns:xlink":Ce.xlink};H&&(q.width=H.width,q.height=H.height,(H.x||H.x===0||H.y||H.y===0)&&(q.viewBox=o.rectangle(H)));var W=Ce.create("svg",q,o),Q=W;$&&!$.isIdentity()&&(Q=W.appendChild(Ce.create("g",u($),o)));for(var K=0,Y=x.length;K<Y;K++)Q.appendChild(F(x[K],D,!0));return M(W,D)}})},new function(){var o={},u;function c(x,P,O,L,$,H){var q=Ce.get(x,P)||H,W=q==null?L?null:O?"":0:O?q:parseFloat(q);return/%\s*$/.test(q)?W/100*($?1:u[/x|^width/.test(P)?"width":"height"]):W}function d(x,P,O,L,$,H,q){return P=c(x,P||"x",!1,L,$,H),O=c(x,O||"y",!1,L,$,q),L&&(P==null||O==null)?null:new S(P,O)}function f(x,P,O,L,$){return P=c(x,P||"width",!1,L,$),O=c(x,O||"height",!1,L,$),L&&(P==null||O==null)?null:new z(P,O)}function p(x,P,O){return x==="none"?null:P==="number"?parseFloat(x):P==="array"?x?x.split(/[\s,]+/g).map(parseFloat):[]:P==="color"?F(x)||x:P==="lookup"?O[x]:x}function y(x,P,O,L){var $=x.childNodes,H=P==="clippath",q=P==="defs",W=new oe,Q=W._project,K=Q._currentStyle,Y=[];if(!H&&!q&&(W=M(W,x,L),Q._currentStyle=W._style.clone()),L)for(var ee=x.querySelectorAll("defs"),re=0,se=ee.length;re<se;re++)N(ee[re],O,!1);for(var re=0,se=$.length;re<se;re++){var ue=$[re],Ee;ue.nodeType===1&&!/^defs$/i.test(ue.nodeName)&&(Ee=N(ue,O,!1))&&!(Ee instanceof be)&&Y.push(Ee)}return W.addChildren(Y),H&&(W=M(W.reduce(),x,L)),Q._currentStyle=K,(H||q)&&(W.remove(),W=null),W}function _(x,P){for(var O=x.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),L=[],$=0,H=O.length;$<H;$+=2)L.push(new S(parseFloat(O[$]),parseFloat(O[$+1])));var q=new ye(L);return P==="polygon"&&q.closePath(),q}function w(x){return xe.create(x.getAttribute("d"))}function E(x,P){var O=(c(x,"href",!0)||"").substring(1),L=P==="radialgradient",$;if(O)$=o[O].getGradient(),$._radial^L&&($=$.clone(),$._radial=L);else{for(var H=x.childNodes,q=[],W=0,Q=H.length;W<Q;W++){var K=H[W];K.nodeType===1&&q.push(M(new ir,K))}$=new pn(q,L)}var Y,ee,re,se=c(x,"gradientUnits",!0)!=="userSpaceOnUse";L?(Y=d(x,"cx","cy",!1,se,"50%","50%"),ee=Y.add(c(x,"r",!1,!1,se,"50%"),0),re=d(x,"fx","fy",!0,se)):(Y=d(x,"x1","y1",!1,se,"0%","0%"),ee=d(x,"x2","y2",!1,se,"100%","0%"));var ue=M(new yt($,Y,ee,re),x);return ue._scaleToBounds=se,null}var b={"#document":function(x,P,O,L){for(var $=x.childNodes,H=0,q=$.length;H<q;H++){var W=$[H];if(W.nodeType===1)return N(W,O,L)}},g:y,svg:y,clippath:y,polygon:_,polyline:_,path:w,lineargradient:E,radialgradient:E,image:function(x){var P=new pe(c(x,"href",!0));return P.on("load",function(){var O=f(x);this.setSize(O);var L=d(x).add(O.divide(2));this._matrix.append(new U().translate(L))}),P},symbol:function(x,P,O,L){return new be(y(x,P,O,L),!0)},defs:y,use:function(x){var P=(c(x,"href",!0)||"").substring(1),O=o[P],L=d(x);return O?O instanceof be?O.place(L):O.clone().translate(L):null},circle:function(x){return new _e.Circle(d(x,"cx","cy"),c(x,"r"))},ellipse:function(x){return new _e.Ellipse({center:d(x,"cx","cy"),radius:f(x,"rx","ry")})},rect:function(x){return new _e.Rectangle(new V(d(x),f(x)),f(x,"rx","ry"))},line:function(x){return new ye.Line(d(x,"x1","y1"),d(x,"x2","y2"))},text:function(x){var P=new ht(d(x).add(d(x,"dx","dy")));return P.setContent(x.textContent.trim()||""),P},switch:y};function A(x,P,O,L){if(x.transform){for(var $=(L.getAttribute(O)||"").split(/\)\s*/g),H=new U,q=0,W=$.length;q<W;q++){var Q=$[q];if(!Q)break;for(var K=Q.split(/\(\s*/),Y=K[0],ee=K[1].split(/[\s,]+/g),re=0,se=ee.length;re<se;re++)ee[re]=parseFloat(ee[re]);switch(Y){case"matrix":H.append(new U(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]));break;case"rotate":H.rotate(ee[0],ee[1]||0,ee[2]||0);break;case"translate":H.translate(ee[0],ee[1]||0);break;case"scale":H.scale(ee);break;case"skewX":H.skew(ee[0],0);break;case"skewY":H.skew(0,ee[0]);break}}x.transform(H)}}function C(x,P,O){var L=O==="fill-opacity"?"getFillColor":"getStrokeColor",$=x[L]&&x[L]();$&&$.setAlpha(parseFloat(P))}var T=s.set(s.each(Re,function(x){this[x.attribute]=function(P,O){if(P[x.set]&&(P[x.set](p(O,x.type,x.fromSVG)),x.type==="color")){var L=P[x.get]();if(L&&L._scaleToBounds){var $=P.getBounds();L.transform(new U().translate($.getPoint()).scale($.getSize()))}}}},{}),{id:function(x,P){o[P]=x,x.setName&&x.setName(P)},"clip-path":function(x,P){var O=F(P);if(O)if(O=O.clone(),O.setClipMask(!0),x instanceof oe)x.insertChild(0,O);else return new oe(O,x)},gradientTransform:A,transform:A,"fill-opacity":C,"stroke-opacity":C,visibility:function(x,P){x.setVisible&&x.setVisible(P==="visible")},display:function(x,P){x.setVisible&&x.setVisible(P!==null)},"stop-color":function(x,P){x.setColor&&x.setColor(P)},"stop-opacity":function(x,P){x._color&&x._color.setAlpha(parseFloat(P))},offset:function(x,P){if(x.setOffset){var O=P.match(/(.*)%$/);x.setOffset(O?O[1]/100:parseFloat(P))}},viewBox:function(x,P,O,L,$){var H=new V(p(P,"array")),q=f(L,null,null,!0),W,Q;if(x instanceof oe){var K=q?q.divide(H.getSize()):1,Q=new U().scale(K).translate(H.getPoint().negate());W=x}else x instanceof be&&(q&&H.setSize(q),W=x._item);if(W){if(k(L,"overflow",$)!=="visible"){var Y=new _e.Rectangle(H);Y.setClipMask(!0),W.addChild(Y)}Q&&W.transform(Q)}}});function k(x,P,O){var L=x.attributes[P],$=L&&L.value;if(!$&&x.style){var H=s.camelize(P);$=x.style[H],!$&&O.node[H]!==O.parent[H]&&($=O.node[H])}return $?$==="none"?null:$:n}function M(x,P,O){var L=P.parentNode,$={node:bt.getStyles(P)||{},parent:!O&&!/^defs$/i.test(L.tagName)&&bt.getStyles(L)||{}};return s.each(T,function(H,q){var W=k(P,q,$);x=W!==n&&H(x,W,q,P,$)||x}),x}function F(x){var P=x&&x.match(/\((?:["'#]*)([^"')]+)/),O=P&&P[1],L=O&&o[r?O.replace(r.location.href.split("#")[0]+"#",""):O];return L&&L._scaleToBounds&&(L=L.clone(),L._scaleToBounds=!0),L}function N(x,P,O){var L=x.nodeName.toLowerCase(),$=L!=="#document",H=i.body,q,W,Q;O&&$&&(u=de.getView().getSize(),u=f(x,null,null,!0)||u,q=Ce.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),W=x.parentNode,Q=x.nextSibling,q.appendChild(x),H.appendChild(q));var K=de.settings,Y=K.applyMatrix,ee=K.insertItems;K.applyMatrix=!1,K.insertItems=!1;var re=b[L],se=re&&re(x,L,P,O)||null;if(K.insertItems=ee,K.applyMatrix=Y,se){$&&!(se instanceof oe)&&(se=M(se,x,O));var ue=P.onImport,Ee=$&&x.getAttribute("data-paper-data");ue&&(se=ue(x,se,P)||se),P.expandShapes&&se instanceof _e&&(se.remove(),se=se.toPath()),Ee&&(se._data=JSON.parse(Ee))}return q&&(H.removeChild(q),W&&(Q?W.insertBefore(x,Q):W.appendChild(x))),O&&(o={},se&&s.pick(P.applyMatrix,Y)&&se.matrix.apply(!0,!0)),se}function D(x,P,O){if(!x)return null;P=typeof P=="function"?{onLoad:P}:P||{};var L=de,$=null;function H(K){try{var Y=typeof K=="object"?K:new e.DOMParser().parseFromString(K.trim(),"image/svg+xml");if(!Y.nodeName)throw Y=null,new Error("Unsupported SVG source: "+x);de=L,$=N(Y,P,!0),(!P||P.insert!==!1)&&O._insertItem(n,$);var ee=P.onLoad;ee&&ee($,K)}catch(re){q(re)}}function q(K,Y){var ee=P.onError;if(ee)ee(K,Y);else throw new Error(K)}if(typeof x=="string"&&!/^[\s\S]*</.test(x)){var W=i.getElementById(x);W?H(W):X.request({url:x,async:!0,onLoad:H,onError:q})}else if(typeof File<"u"&&x instanceof File){var Q=new FileReader;return Q.onload=function(){H(Q.result)},Q.onerror=function(){q(Q.error)},Q.readAsText(x)}else H(x);return $}te.inject({importSVG:function(x,P){return D(x,P,this)}}),ne.inject({importSVG:function(x,P){return this.activate(),D(x,P,this)}})};var de=new(l.inject(s.exports,{Base:s,Numerical:v,Key:Ni,DomEvent:zt,DomElement:bt,document:i,window:r,Symbol:be,PlacedSymbol:Ye}));return de.agent.node&&cC(de),typeof n=="function"&&n.amd?n("paper",de):t&&(t.exports=de),de}).call(eO,typeof self=="object"?self:null)})(WD);var gW=WD.exports;const Ge=_C(gW),pW=t=>{const e=Ge.project.importSVG(`<path d="${t}" />`,{applyMatrix:!0,insert:!1}),n={path:e.exportSVG().getAttribute("d"),edges:e.curves.length,height:Math.round(e.bounds.height),width:Math.round(e.bounds.width),length:Math.round(e.length)};if(e.remove(),n.edges<3||n.edges>23)throw new Error("Invalid path");return n},mW=({tangram:t,deferred:e})=>{const{tangramsStarredBy:n}=G.useContext(Mr),r=G.useMemo(()=>{let i=0;for(const s in n[t.id])n[t.id][s]&&(i+=1);return i},[t,n]);return R.jsx(us,{onClose:()=>e.reject(cn),css:{gap:3},children:R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1",alignItems:"center"},children:[R.jsx(Md,{selected:!0,tangram:t}),R.jsx(Xe,{css:{fontSize:2},children:R.jsx(Et,{id:"Earned {stars}",values:{stars:r,starIcon:()=>R.jsx(xr,{icon:Uo,css:{fill:"currentColor"}})}})})]})})},_W=({tangram:t,deferred:e})=>{const n=en(),r=G.useContext(hi),{currentUser:i}=G.useContext(Gn),[s,a]=G.useState(()=>({...t})),{tangramsStarredBy:l}=G.useContext(Mr),h=i&&!t.id,g=G.useMemo(()=>({path:t.path,category:t.category,emoji:t.category!=="digits"&&t.category!=="letters"?t.emoji:lC(),letterIndex:t.category==="letters"?Mc.indexOf(t.emoji):void 0,digitIndex:t.category==="digits"?Oc.indexOf(t.emoji):void 0}),[t]),{handleSubmit:m,register:v,watch:I,setError:S,clearErrors:j,formState:z}=cu({defaultValues:g}),{path:J,category:V,emoji:B,letterIndex:U,digitIndex:Z}=I();G.useEffect(()=>{try{const ce=pW(J);a(_e=>({..._e,...ce})),j("path")}catch{S("path",{type:"invalid",message:n.formatMessage({id:"Invalid path"})})}},[J,S,j,n]),G.useEffect(()=>{const ce=V==="letters"?Mc[U]:V==="digits"?Oc[Z]:B||lC();a(_e=>({..._e,emoji:ce}))},[V,B,U,Z]),G.useEffect(()=>{a(ce=>({...ce,category:V}))},[V]);const ne=async()=>{window.confirm(n.formatMessage({id:"Are you sure you want to delete this tangram?"}))&&(await Ot.firestore().collection("tangrams").doc(t.id).delete(),r(n.formatMessage({id:"Tangram deleted successfuly"})),e.resolve())},te=async()=>{h?(await Ot.firestore().collection("tangrams").add({...s,uid:i.uid,approved:!1}),r(n.formatMessage({id:"Tangram submitted for review"}))):(await Ot.firestore().collection("tangrams").doc(t.id).update(s),r(n.formatMessage({id:"Tangram modified successfuly"}))),e.resolve()},oe=G.useMemo(()=>{if(!t.approved)return 0;let ce=0;for(const _e in l[t.id])l[t.id][_e]&&(ce+=1);return ce},[t,l]);return R.jsxs(us,{title:R.jsx(qr,{children:h?n.formatMessage({id:"Submit your tangram"}):n.formatMessage({id:"Edit your tangram"})}),onClose:()=>e.reject(cn),as:"form",onSubmit:m(te),css:{gap:3},children:[R.jsxs(fe,{css:{gap:3,overflow:"auto",flex:"1"},children:[R.jsx(Md,{showStroke:i.isAdmin,selected:!0,completed:!0,tangram:s,css:{alignSelf:"center"}}),t.approved&&R.jsx(Xe,{css:{alignSelf:"center",fontSize:2},children:R.jsx(Et,{id:"Earned {stars}",values:{stars:oe,starIcon:()=>R.jsx(xr,{icon:Uo,css:{fill:"currentColor"}})}})}),h&&!i.isAdmin&&R.jsx(vs,{children:R.jsx(Et,{id:"A moderator will have to approve your tangram. It can be deleted or edited at any time.",values:{br:()=>R.jsx("br",{})}})}),i&&i.isAdmin&&R.jsx(R.Fragment,{children:R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Path"})}),R.jsx(fn,{as:"textarea",...v("path")}),z.errors.path&&R.jsx(kr,{children:z.errors.path.message})]})}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Category"})}),R.jsx(fn,{as:"select",...v("category"),children:GV.map(ce=>R.jsx("option",{value:ce,children:n.formatMessage({id:ce})},ce))})]}),V==="digits"?R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(fn,{as:"select",...v("digitIndex"),children:Oc.map((ce,_e)=>R.jsx("option",{value:_e,children:ce},_e))})]}):V==="letters"?R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(fn,{as:"select",...v("letterIndex"),children:Mc.map((ce,_e)=>R.jsx("option",{value:_e,children:ce},_e))})]}):R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:n.formatMessage({id:"Victory emoji"})}),R.jsx(fn,{...v("emoji")}),R.jsx(vs,{children:n.formatMessage({id:"Leave empty for random emoji"})})]})]}),R.jsx(dr,{type:"submit",children:h?n.formatMessage({id:"Submit!"}):n.formatMessage({id:"Edit!"})}),!h&&R.jsx(fe,{css:{alignItems:"center"},children:R.jsx(Ci,{onClick:ne,children:n.formatMessage({id:"Or delete tangram"})})})]})},vW=({tangram:t,deferred:e})=>{const{currentUser:n}=G.useContext(Gn);return n&&(n.isAdmin||!t.id||t.uid===n.uid)?R.jsx(_W,{tangram:t,deferred:e}):R.jsx(mW,{tangram:t,deferred:e})};class ps{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}const KD=G.createContext([!0,()=>{}]),zI=()=>G.useContext(KD),yW=({children:t})=>{const[e,n]=G.useState(!0);G.useEffect(()=>{const s=window.localStorage.getItem("showBackgroundPattern");if(s===null){n(!0);return}try{const a=JSON.parse(s);n(!!JSON.parse(a))}catch{window.localStorage.removeItem("showBackgroundPattern")}},[]);const r=G.useCallback(()=>{const s=!e;n(s),window.localStorage.setItem("showBackgroundPattern",JSON.stringify(s))},[e]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(KD.Provider,{value:i,children:t})},QD=G.createContext(["",()=>{}]),YD=()=>G.useContext(QD),hC="css-system-theme",dC={breakpoints:{s:"40em",m:"52em",l:"64em"},space:[0,4,8,16,32,64,128,256,512],sizes:{menu:40,inline:16,logo:128,icon:24,badge:32,badgeBig:86},borderWidths:{loader:8},radii:[0,4,8,16,32],fontSizes:[10,12,14,18,22,30,46,62,70]},xf={light:{...dC,colors:{pieces:{st1:"#FECA57",st2:"#48DBFB",mt1:"#1DD1A1",lt1:"#FF6B6B",lt2:"#8557E0",sq:"#FF9FF3",rh:"#54A0FF"},difficulties:["#10ac84","#2e86de","#ee5253"],shape:"#121212",background:"#fff",dialogBackground:"#d9d9d9",dialogText:"#303030",inputBackground:"#fff",errorText:"#bd0808",notificationBackground:"#FFFFFFdd"}},dark:{...dC,colors:{pieces:{st1:"#CE9518",st2:"#1CACCB",mt1:"#0CA57C",lt1:"#C33B3B",lt2:"#5C2DB9",sq:"#C95EBC",rh:"#2E75CF"},difficulties:["#0b8767","#1a6cbd","#ce3737"],shape:"#595959",background:"#15141a",dialogBackground:"#383838",dialogText:"#d8d8d8",inputBackground:"#595959",errorText:"#e63c3c",notificationBackground:"#000000dd"}}},wW="light",EW=({children:t})=>{const[e,n]=G.useState(wW);G.useEffect(()=>{const s=window.localStorage.getItem(hC);xf[s]&&n(s)},[]);const r=G.useCallback(s=>{xf[s]&&(n(s),window.localStorage.setItem(hC,s))},[xf]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(QD.Provider,{value:i,children:R.jsx(ki.Provider,{value:xf[e],children:t})})},$I=G.createContext(),IW=({deferred:t,tip:{id:e,title:n=R.jsx(qr,{children:R.jsx(Et,{id:"Random tip"})}),content:r}})=>{const i=en(),[s,a]=G.useState(!1);return R.jsxs(us,{onClose:()=>t.reject(cn),title:n,css:{gap:3},children:[r,R.jsx(dr,{onClick:()=>t.resolve(s),children:i.formatMessage({id:"Got it!"})}),e!=="welcome"&&R.jsxs(fe,{as:"label",css:{gap:1,flexDirection:"row",cursor:"pointer",alignItems:"flex-end"},children:[R.jsx("input",{type:"checkbox",checked:s,onChange:()=>a(!s)}),R.jsx(Xe,{as:"small",children:i.formatMessage({id:"I don't want to see tips anymore"})})]})]})},sr={settingsIcon:R.jsx(xr,{icon:MD}),accountIcon:R.jsx(xr,{icon:VD}),menuIcon:R.jsx(xr,{icon:DD}),galleryIcon:R.jsx(xr,{icon:ND}),shareIcon:R.jsx(xr,{icon:LD}),createIcon:R.jsx(xr,{icon:OD}),leaderboardIcon:R.jsx(xr,{icon:kD}),starIcon:R.jsx(xr,{icon:Uo}),br:()=>R.jsx("br",{})},SW=[{id:"particles",predicate:({particles:t})=>t,content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.particles",values:sr})})},{id:"menu",content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.menu",values:sr})})},{id:"gallery",content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.gallery",values:sr})})},{id:"difficulty",predicate:({showBackgroundPattern:t})=>t,content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.difficulty",values:sr})})},{id:"theme",predicate:({themeKey:t})=>t!=="dark",content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.theme",values:sr})})},{id:"sound",predicate:({soundEnabled:t})=>t,content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.sound",values:sr})})},{id:"account1",predicate:({currentUser:t})=>!t,content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.account1",values:sr})})},{id:"account2",predicate:({currentUser:t})=>!t,content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.account2",values:sr})})},{id:"stars",predicate:({currentUser:t})=>t,content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.stars",values:sr})})},{id:"create",predicate:({currentUser:t,approvedTangrams:e,isTangramCompleted:n})=>{if(t){let r=0;for(const{id:i}of e)if(n(i)&&(r+=1,r===10))return!0}return!1},content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.create",values:sr})})},{id:"share",content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.share",values:sr})})},{id:"card",content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.card",values:sr})})},{id:"leaderboard",content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.leaderboard",values:sr})})}],TW=({children:t})=>{const e=en(),n=G.useContext(hi),[r,i]=G.useState(null),[s,a]=G.useState(!0),{soundEnabled:l}=G.useContext(di),[h]=YD(),[g]=zI(),{currentUser:m}=G.useContext(Gn),{approvedTangrams:v}=G.useContext(Zo),{isTangramCompleted:I}=G.useContext(Mr);G.useEffect(()=>{a(window.localStorage.getItem("hideTips")===null)},[]),G.useEffect(()=>{s?window.localStorage.removeItem("hideTips"):window.localStorage.setItem("hideTips",!0)},[s]);const S=()=>{let Z=[];const ne=localStorage.getItem("seenTips");if(ne)try{const te=JSON.parse(ne);if(!Array.isArray(te))throw new Error("Invalid data for seenTips : "+te);Z=te}catch{localStorage.removeItem("seenTips")}return Z},j=G.useCallback(Z=>{const ne=S(),te=new ps;return i({deferred:te,tip:Z}),te.promise.then(oe=>{oe&&a(!1)}).finally(()=>{localStorage.setItem("seenTips",JSON.stringify([...ne,Z.id])),i(null)})},[]),z=G.useCallback(()=>{!s||S().includes("welcome")||(!m||!v.some(ne=>I(ne.id)))&&j({id:"welcome",title:R.jsx(qr,{children:R.jsx(Et,{id:"Welcome to Amstangram",values:sr})}),content:R.jsx(Xe,{css:{textAlign:"justify"},children:R.jsx(Et,{id:"tips.welcome",values:sr})})})},[j,s,m,v,I]),J=G.useCallback(()=>{if(!s)return;const Z=S(),ne=SW.filter(({id:oe,predicate:ce=()=>!0})=>!Z.includes(oe)&&ce({themeKey:h,showBackgroundPattern:g,currentUser:m,approvedTangrams:v,isTangramCompleted:I,soundEnabled:l}));if(!ne.length)return;const te=ne[0];j(te)},[j,v,I,h,m,g,l,s]),V=G.useCallback(()=>{a(Z=>!Z)},[]),B=G.useCallback(()=>{a(!0),window.localStorage.removeItem("seenTips"),n(e.formatMessage({id:"Tips reseted successfuly"}))},[n,e]),U=G.useMemo(()=>({showRandomTip:J,showWelcome:z,tipsEnabled:s,toggleTips:V,resetTips:B}),[J,z,s,V,B]);return R.jsxs($I.Provider,{value:U,children:[t,r&&R.jsx(IW,{...r})]})},Cf=20,vc=({leftComponent:t,leftValue:e,rightComponent:n,rightValue:r,value:i,onChange:s,invertSounds:a})=>{const{playToggle:l,soundEnabled:h}=G.useContext(di),g=G.useContext(ki),m=G.useMemo(()=>i===r?"right":"left",[i,r]),v=()=>{a?h||l({forceSoundEnabled:!0}):l()},I=()=>{s((m==="left"?"right":"left")==="right"?r:e),v()},S=j=>{j!==m&&(s(j==="right"?r:e),v())};return R.jsxs(fe,{css:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:3},children:[R.jsx(fe,{css:{cursor:"pointer",flex:"1",alignItems:"flex-end"},onClick:()=>S("left"),children:t}),R.jsx(fe,{onClick:I,css:{cursor:"pointer",position:"relative",bg:"inputBackground",width:`${2*Cf}px`,height:`${Cf}px`,borderRadius:"99999px"},children:R.jsx(fe,{css:{position:"absolute",size:`${Cf}px`,borderRadius:"99999px",bg:"dialogText",boxShadow:`0 0 0 2px ${g.colors.inputBackground}`,transition:"left 250ms ease-in-out"},style:{left:m==="left"?0:Cf}})}),R.jsx(fe,{css:{cursor:"pointer",flex:"1",alignItems:"flex-start"},onClick:()=>S("right"),children:n})]})},XD=G.createContext([!0,()=>{}]),JD=()=>G.useContext(XD),xW=({children:t})=>{const[e,n]=G.useState(!0);G.useEffect(()=>{const s=window.localStorage.getItem("showParticles");if(s===null){n(!0);return}try{const a=JSON.parse(s);n(!!JSON.parse(a))}catch{window.localStorage.removeItem("showParticles")}},[]);const r=G.useCallback(()=>{const s=!e;n(s),window.localStorage.setItem("showParticles",JSON.stringify(s))},[e]),i=G.useMemo(()=>[e,r],[e,r]);return R.jsx(XD.Provider,{value:i,children:t})},CW=({deferred:t})=>{const{soundEnabled:e,toggleSound:n}=G.useContext(di),{tipsEnabled:r,toggleTips:i,resetTips:s}=G.useContext($I),[a,l]=zI(),[h,g]=JD(),{language:m,setLanguage:v}=G.useContext(jI),I=en(),[S,j]=YD(),z=J=>{v(J.target.value)};return R.jsxs(us,{title:R.jsx(qr,{children:I.formatMessage({id:"Settings"})}),onClose:()=>t.reject(cn),css:{gap:4},children:[R.jsxs(fe,{css:{gap:3},children:[R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:I.formatMessage({id:"Language"})}),R.jsx(fn,{as:"select",onChange:z,value:m,children:x0.map(J=>R.jsx("option",{value:J,children:I.formatMessage({id:J})},J))})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:I.formatMessage({id:"Difficulty"})}),R.jsx(vc,{value:a,onChange:l,leftComponent:R.jsx(Xe,{children:I.formatMessage({id:"Easy"})}),leftValue:!0,rightComponent:R.jsx(Xe,{children:I.formatMessage({id:"Hard"})}),rightValue:!1})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:I.formatMessage({id:"Theme"})}),R.jsx(vc,{value:S,onChange:j,leftComponent:R.jsx(fe,{as:cG,css:{size:"icon"}}),leftValue:"light",rightComponent:R.jsx(fe,{as:uG,css:{size:"icon"}}),rightValue:"dark"})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:I.formatMessage({id:"Sounds"})}),R.jsx(vc,{invertSounds:!0,value:e,onChange:n,leftComponent:R.jsx(fe,{as:dG,css:{size:"icon"}}),leftValue:!1,rightComponent:R.jsx(fe,{as:hG,css:{size:"icon"}}),rightValue:!0})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:I.formatMessage({id:"Show particles"})}),R.jsx(vc,{value:h,onChange:g,leftComponent:R.jsx(Xe,{children:I.formatMessage({id:"Yes"})}),leftValue:!0,rightComponent:R.jsx(Xe,{children:I.formatMessage({id:"No"})}),rightValue:!1})]}),R.jsxs(fe,{css:{gap:2},children:[R.jsx("label",{children:I.formatMessage({id:"Show tips"})}),R.jsx(vc,{value:r,onChange:i,leftComponent:R.jsx(Xe,{children:I.formatMessage({id:"Yes"})}),leftValue:!0,rightComponent:R.jsx(Xe,{children:I.formatMessage({id:"No"})}),rightValue:!1})]})]}),R.jsx(SG,{onClick:s,children:I.formatMessage({id:"Reset tips"})})]})},Fd=G.createContext(),bW=({children:t})=>{const{initialized:e}=G.useContext(Gn),{playlist:n,setPlaylist:r,startRandomPlaylist:i,initialized:s}=G.useContext(Mr),{initialized:a,approvedTangrams:l}=G.useContext(Zo),[h,g]=G.useState(!1),[m,v]=G.useState(null),I=G.useCallback(async je=>{const he=new ps;v({uid:je,deferred:he});try{await he.promise}catch(rt){if(rt!==cn)throw rt}finally{v(null)}},[]),[S,j]=G.useState(null),z=G.useCallback(async()=>{const je=new ps;j(je);try{await je.promise}catch(he){if(he!==cn)throw he}finally{j(null)}},[]),[J,V]=G.useState(null),B=G.useCallback(async()=>{const je=new ps;V(je);try{await je.promise}catch(he){if(he!==cn)throw he}finally{V(null)}},[]),[U,Z]=G.useState(null),ne=G.useCallback(async()=>{const je=new ps;Z(je);try{await je.promise}catch(he){if(he!==cn)throw he}finally{Z(null)}},[]),[te,oe]=G.useState(null),ce=G.useCallback(async je=>{const he=new ps;oe({deferred:he,tangram:je});try{await he.promise}catch(rt){if(rt!==cn)throw rt}finally{oe(null)}},[]),[_e,pe]=G.useState(null),Ye=G.useCallback(async()=>{const je=new ps;pe(je);try{await je.promise}catch(he){if(he!==cn)throw he}finally{pe(null)}},[]),[be,Me]=G.useState(null);G.useEffect(()=>{(async()=>{if(a&&s&&e&&!h){let he=!1;if(!n&&window.location.search){const rt=new URLSearchParams(window.location.search);if(rt.has("tangrams")){const xe=rt.get("tangrams").split(","),ye=rt.get("uid"),De=l.filter(it=>xe.includes(it.id));if(De.length){window.history.replaceState({},document.title,window.location.origin);const it=new ps;Me({deferred:it,tangrams:De,uid:ye});try{await it.promise,he=!0,r(De)}catch(ze){if(ze!==cn)throw ze}finally{Me(null)}}}}he||i(!0),g(!0)}})()},[a,s,e,h]);const Se=G.useMemo(()=>({showProfile:I,showLeaderboard:z,showGallery:B,showLogin:ne,showTangram:ce,showSettings:Ye}),[I,z,B,ne,ce,Ye]);return R.jsxs(Fd.Provider,{value:Se,children:[t,U&&R.jsx(nW,{deferred:U}),J&&R.jsx(NG,{deferred:J}),te&&R.jsx(vW,{...te}),m&&R.jsx(hW,{...m}),S&&R.jsx(DG,{deferred:S}),be&&R.jsx(bG,{...be}),_e&&R.jsx(CW,{deferred:_e})]})},Iu=({action:t,icon:e,text:n})=>{const{playButton:r}=G.useContext(di);return R.jsxs(fe,{css:{alignItems:"center",flexDirection:"row",gap:3,cursor:"pointer",py:3},onClick:()=>{r(),t()},children:[R.jsx(fe,{as:e,css:{size:"icon"}}),R.jsx(Xe,{css:{fontSize:3},children:n})]})},AW=()=>{const{playlist:t,saveRequestId:e}=G.useContext(Mr),{currentUser:n}=G.useContext(Gn),{playButton:r}=G.useContext(di),i=en(),{showLeaderboard:s,showGallery:a,showLogin:l,showProfile:h,showSettings:g}=G.useContext(Fd),[m,v]=G.useState();G.useEffect(()=>{m&&m.reject(cn)},[t,e]);const{requestSave:I}=G.useContext(Mr),S=async()=>{r();const J=new ps;v(J);try{await J.promise}catch(V){if(V!==cn)throw V}finally{v(null)}},j=ag({0:{color:"pieces.lt2"},14:{color:"pieces.rh"},28:{color:"pieces.st2"},42:{color:"pieces.mt1"},57:{color:"pieces.st1"},71:{color:"pieces.lt1"},85:{color:"pieces.sq"},100:{color:"pieces.lt2"}}),z=ag({from:{transform:"translate(0, 0)"},to:{transform:"translate(30px, -30px)"}});return R.jsxs(R.Fragment,{children:[R.jsx(fe,{css:{position:"fixed",top:3,left:3,animation:`${j} 20s linear infinite both`},children:R.jsx(fe,{as:DD,css:{size:"menu",cursor:"pointer"},onClick:S})}),m&&R.jsxs(us,{onClose:()=>m.reject(cn),title:R.jsxs(fe,{css:{flexDirection:"row",gap:3,alignItems:"center"},children:[R.jsx(KP,{css:{size:"badge",ml:"-2px",mr:"-6px",overflow:"visible","& > g":{animation:`${z} ${Zr}ms ${wv}ms ease both`}}}),R.jsx(qr,{children:i.formatMessage({id:"Amstangram"})})]}),css:{gap:3,overflow:"initial"},children:[R.jsxs(fe,{children:[n?R.jsx(Iu,{action:()=>h(n.uid),icon:()=>R.jsx(Km,{css:{mx:-1},uid:n.uid,size:"badge"}),text:i.formatMessage({id:"See my profile"})}):R.jsx(Iu,{action:l,icon:VD,text:i.formatMessage({id:"Log in"})}),R.jsx(Iu,{action:a,icon:ND,text:i.formatMessage({id:"Tangram gallery"})}),R.jsx(Iu,{action:I,icon:OD,text:i.formatMessage({id:"Save tangram"})}),R.jsx(Iu,{action:s,icon:kD,text:i.formatMessage({id:"Leaderboard"})}),R.jsx(Iu,{action:g,icon:MD,text:i.formatMessage({id:"Settings"})})]}),R.jsxs(fe,{css:{flexDirection:"row",alignItems:"baseline",justifyContent:"space-between"},children:[R.jsx(vs,{as:Jx,href:`mailto:millagou.benjamin@gmail.com?subject=${i.formatMessage({id:"A word about Amstangram"})}`,target:"_blank",rel:"noopener, noreferrer",children:i.formatMessage({id:"Contact "})}),R.jsx(vs,{as:Jx,href:"https://github.com/myagoo/amstangram",target:"_blank",rel:"noopener, noreferrer",children:i.formatMessage({id:"Version {code}"},{code:".."})})]})]})]})},Jh=(t,e)=>{const n=new window.ClipperLib.ClipperOffset,r=new window.ClipperLib.Paths;if(n.AddPaths([t.map(({x:i,y:s})=>({X:i,Y:s}))],window.ClipperLib.JoinType.jtMiter,window.ClipperLib.EndType.etClosedPolygon),n.MiterLimit=0,n.ArcTolerance=0,n.Execute(r,e),r.length)return r[0].map(({X:i,Y:s})=>new Ge.Point(i,s))},PW=t=>{const e=t[1].getDistance(t[2]),n=t[0].getDistance(t[2]),r=t[0].getDistance(t[1]),i=e+n+r,s=(t[0].x*e+t[1].x*n+t[2].x*r)/i,a=(t[0].y*e+t[1].y*n+t[2].y*r)/i;return new Ge.Point(s,a)},yc=(t,e)=>{const n=[new Ge.Point(0,0),new Ge.Point(t*2,0),new Ge.Point(t,t)],r=new Ge.Path({name:"display",segments:n,closed:!0}),i=new Ge.Path({name:"collision",segments:Jh(n,-ga),closed:!0}),s=new Ge.Path({name:"insetBorder",segments:Jh(n,-_s),closed:!0,strokeWidth:_s}),a=PW(n),l=new Ge.Point(Ge.view.center.x+a.x-r.bounds.width/2,Ge.view.center.y+a.y-r.bounds.height/2);return new Ge.Group({children:[r,i,s],position:Ge.view.center,pivot:l,data:{id:e,collisions:new Set},applyMatrix:!0})},RW=(t,e)=>{const n=[new Ge.Point(0,0),new Ge.Point(t*2,0),new Ge.Point(t*3,t),new Ge.Point(t,t)],r=new Ge.Path({name:"display",segments:n,closed:!0}),i=new Ge.Path({name:"collision",segments:Jh(n,-ga),closed:!0,strokeWidth:ga}),s=new Ge.Path({name:"insetBorder",segments:Jh(n,-_s),closed:!0,strokeWidth:_s});return new Ge.Group({children:[r,i,s],position:Ge.view.center,data:{id:e,collisions:new Set},applyMatrix:!0})},kW=(t,e)=>{const n=new Ge.Path.Rectangle({name:"display",point:[0,0],size:[t,t]}),r=new Ge.Path.Rectangle({name:"collision",point:[ga,ga],size:[t-ga*2,t-ga*2]}),i=new Ge.Path.Rectangle({name:"insetBorder",point:[_s,_s],size:[t-_s*2,t-_s*2],strokeWidth:_s});return new Ge.Group({children:[n,r,i],position:Ge.view.center,data:{id:e,collisions:new Set},applyMatrix:!0,rotation:Math.round(Math.random()*7)*45})},NW=()=>{const t=UV,e=Math.sqrt(Math.pow(t,2)*2),n=Math.sqrt(Math.pow(e,2)*2);return new Ge.Group([yc(t,"st1"),yc(t,"st2"),yc(e,"mt1"),yc(n,"lt1"),yc(n,"lt2"),kW(e,"sq"),RW(t,"rh")])},DW=(t,e)=>{let n;for(const h of t.children){const g=h.children.display;n?n=n.unite(g,{insert:!1}):n=g}n.scale(1/e),n.position=new Ge.Point(n.bounds.width/2,n.bounds.height/2);const r=n.exportSVG().getAttribute("d"),i=n.curves.length,s=Math.round(n.bounds.width),a=Math.round(n.bounds.height),l=Math.round(n.length);return n.remove(),{width:s,height:a,length:l,path:r,edges:i}},fC=(t,e,n)=>{const r={x:n.x-e.x,y:n.y-e.y},i={x:t.x-e.x,y:t.y-e.y},s=r.x*r.x+r.y*r.y;let a=i.x*r.x+i.y*r.y;const l=Math.min(1,Math.max(0,a/s));return a=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x),new Ge.Point(e.x+r.x*l,e.y+r.y*l)},gC=(t,e,n)=>{for(const r of e)for(const{point:i}of r.segments)for(const{point:s}of t.segments){const a=s.getDistance(i);a<n.distance&&(n.distance=a,n.shape=r,n.vector=i.subtract(s))}if(!n.vector)for(const r of e){for(const{point:i}of t.segments)for(const{point:s,next:{point:a}}of r.segments){const l=fC(i,s,a),h=l.getDistance(i);h<n.distance&&(n.distance=h,n.vector=l.subtract(i),n.shape=r,n.segment=[s,a],n.point=i)}for(const{point:i}of r.segments)for(const{point:s,next:{point:a}}of t.segments){const l=fC(i,s,a),h=l.getDistance(i);h<n.distance&&(n.distance=h,n.vector=i.subtract(l),n.shape=t,n.segment=[s,a])}}return n},pC=(t,e,n)=>{if(n.segment){let r=n.maxDistance,i;const[s,a]=n.segment,l=Math.atan2(a.y-s.y,a.x-s.x),h=Math.atan2(s.y-a.y,s.x-a.x);for(const g of[l,h])for(const{point:m}of t.segments){if(m===n.point)continue;const v=m.add(n.vector),I=new Ge.Point(v.x+n.maxDistance*Math.cos(g),v.y+n.maxDistance*Math.sin(g)),S=new Ge.Path.Line({from:v,to:I,insert:!1});for(const j of e){const z=S.getIntersections(j);for(const{point:J}of z){const V=J.subtract(v).add(n.vector);V.length<n.maxDistance&&V.length<=r&&(r=V.length,i=V)}}}i&&(n.vector=i)}},OW=(t,e,n,r)=>{let i={maxDistance:t,distance:t};return gC(e,n,i),r&&gC(e,r,i),pC(e,n.filter(s=>s.shape!==i.shape),i),r&&pC(e,r,i),i.vector},MW=(t,e,n)=>{let r=t;for(const i of e.children){if(i.data.collisions.size>0)return;r=r.unite(new Ge.Path({segments:Jh(i.children.display.segments.map(({point:s})=>s),-n),closed:!0,insert:!1}),{insert:!1})}return Math.round(r.length*1e3)===Math.round(t.length*1e3)},LW=t=>{for(const e of t.children)if(e.data.collisions.size>0)return!1;return!0},bf=(t,e)=>{const n=t.pivot?t.pivot.subtract(t.bounds.center):new Ge.Point;t.bounds.x<0&&(t.position.x=t.bounds.width/2+n.x),t.bounds.y<0&&(t.position.y=t.bounds.height/2+n.y),t.bounds.x+t.bounds.width>e.width/window.devicePixelRatio&&(t.position.x=e.width/window.devicePixelRatio-t.bounds.width/2+n.x),t.bounds.y+t.bounds.height>e.height/window.devicePixelRatio&&(t.position.y=e.height/window.devicePixelRatio-t.bounds.height/2+n.y)},VW=(t,e)=>{const n=new Ge.Point(Ge.project.view.bounds.width,Ge.project.view.bounds.height).subtract(IS*2);if(t.position=Ge.Point.random().multiply(n).add(IS),t.data.id==="rh"){const r=Math.round(Math.random()*3)*45;t.rotation=r,t.data.rotation=r}else t.rotation=Math.round(Math.random()*7)*45},mC=(t,e)=>e.segments.every(n=>t.contains(n.point)),rv=(t,e)=>{for(const r of e.children){if(r===t)continue;const i=t.children.collision,s=r.children.collision;i.intersects(s)||mC(i,s)||mC(s,i)?(t.data.collisions.add(r.data.id),r.data.collisions.add(t.data.id)):(t.data.collisions.delete(r.data.id),r.data.collisions.delete(t.data.id))}let n=!0;for(const r of e.children)r.data.collisions.size>0?(n=!1,r.children.display.opacity=jV):r.children.display.opacity=1;return n},FW=({tangram:t,onStop:e,onNext:n,onApprove:r,onStarToggle:i})=>{const s=en(),[a,l]=G.useState(!1),{playStar:h}=G.useContext(di),{tangramsStarredBy:g,isTangramStarred:m}=G.useContext(Mr),v=G.useMemo(()=>{let z=0;for(const J in g[t.id])g[t.id][J]&&(z+=1);return z},[t,g]),I=m(t.id),S=ag({0:{opacity:"0",transform:"rotate(0) scale(0)"},100:{opacity:1,transform:`rotate(${360*5}deg) scale(1)`}}),j=()=>{setTimeout(()=>l(!0),1e3)};return R.jsx(fe,{css:{position:"absolute",top:0,left:0,right:0,bottom:0,alignItems:"center",justifyContent:"center",gap:3},children:R.jsxs(fe,{css:{position:"relative"},children:[R.jsx(fe,{onAnimationEnd:j,css:{textShadow:"0px 5px 10px #00000080",fontSize:"30vmin",animation:`2000ms ${S} cubic-bezier(.6,1.56,.58,.92) forwards`},children:t.emoji},"emojiSpin"),a&&R.jsxs(fe,{css:{mt:3,position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",flexDirection:"row",gap:3,animation:`${Zr}ms fadeIn ease both`},children:[r&&R.jsxs(fe,{as:dr,onClick:r,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:aG,css:{size:"icon"}}),R.jsx(Xe,{children:s.formatMessage({id:"Approve"})})]}),i&&R.jsxs(fe,{as:dr,mute:!0,onClick:()=>{h(),i()},css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(Xe,{children:v}),R.jsx(fe,{as:Uo,css:{size:"icon",fill:I?"currentColor":void 0},deps:[I]})]}),n?R.jsxs(fe,{as:dr,onClick:n,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:lG,css:{size:"icon"}}),R.jsx(Xe,{children:s.formatMessage({id:"Next"})})]}):R.jsxs(fe,{as:dr,onClick:e,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"},children:[R.jsx(fe,{as:FD,css:{size:"icon"}}),R.jsx(Xe,{children:s.formatMessage({id:"Quit"})})]})]})]})})},BW=()=>{const t=en(),{showRandomTip:e,showWelcome:n}=G.useContext($I),{showLogin:r,showTangram:i}=G.useContext(Fd),{playTangram:s,playVictory:a}=G.useContext(di),l=G.useRef();l.current={tangram:s,victory:a};const{currentUser:h}=G.useContext(Gn),g=G.useRef();g.current=h;const m=G.useContext(ki),v=G.useContext(hi),[I]=zI(),[S]=JD(),{saveRequestId:j,playlist:z,setPlaylist:J,markTangramAsComplete:V,toggleTangramStar:B}=G.useContext(Mr),U=G.useRef();U.current=V;const[Z,ne]=G.useState(0),[te,oe]=G.useState(!1),ce=G.useRef(),_e=G.useRef(),pe=G.useRef(),Ye=G.useRef(),be=G.useRef(),Me=G.useRef(),Se=G.useRef(),je=G.useMemo(()=>z&&z[Z],[z,Z]),he=()=>{oe(!1),ne(Z+1),e()},rt=()=>{oe(!1),J(null),e()},xe=async()=>{await Ot.firestore().collection("tangrams").doc(je.id).update({approved:!0}),v(t.formatMessage({id:"Tangram approved"}))};return G.useEffect(()=>{ne(0)},[z]),G.useEffect(()=>{if(j){if(!LW(pe.current)){v(t.formatMessage({id:"You can't save an invalid tangram"}));return}const ye=DW(pe.current,_e.current);if(ye.edges===23){v(t.formatMessage({id:"You can't save such an easy tangram"}));return}(async()=>{h||await r(),await i(ye)})()}},[j]),G.useEffect(()=>{const ye=()=>{if(ce.current&&pe.current)for(const De of pe.current.children)bf(De,ce.current)};return window.addEventListener("resize",ye),()=>window.removeEventListener("resize",ye)},[]),G.useLayoutEffect(()=>{const ye=Date.now(),De=ze=>{let kt=null,ht=null,yt=null,pn=null;const ir=Lr=>{document.activeElement===ce.current&&(document.body.style.cursor="pointer")},ls=Lr=>{document.body.style.cursor="default"},bt=Lr=>{yt=Date.now(),pn=Lr.point,kt=Lr.point.subtract(ze.position),ht=ze.clone({insert:!1,deep:!0}),ze.bringToFront()},zt=Lr=>{document.body.style.cursor="move";const fi=Lr.point.subtract(ze.position).subtract(kt);ht.position=ze.position.add(fi);const Ni=ht.children["display 1"],ea=pe.current.children.filter(X=>X!==ze).map(({children:X})=>X.display),Bd=Me.current&&be.current?be.current.children?be.current.children:[be.current]:null,hu=OW(ES,Ni,ea,Bd);hu&&(ht.position.x+=hu.x,ht.position.y+=hu.y),bf(ht,ce.current),ze.position=ht.position,rv(ze,pe.current)},Nt=Lr=>{if(document.body.style.cursor="pointer",Lr.point.subtract(pn).length<ES&&Date.now()-yt<HV&&(ze.rotation+=45,ze.data.id==="rh"&&(ze.data.rotation+=45,ze.data.rotation===180&&(ze.data.rotation=0,ze.scale(-1,1))),l.current.tangram(),bf(ze,ce.current),rv(ze,pe.current),yt=null,pn=null),kt=null,ht&&ht.remove(),ht=null,!!be.current&&(Me.current===!1&&(be.current.position=pe.current.position),MW(be.current,pe.current,Me.current?zV:$V))){U.current(je,Date.now()-ye);for(const Er of pe.current.children)Er.data.removeListeners();if(document.body.style.cursor="default",!Se.current){l.current.victory(),oe(!0);return}Ge.project.activeLayer.tween({opacity:0},{duration:Kd,easing:"easeInCubic"});for(const Er of Ye.current)Er.data.animation.stop(),Er.tween({"position.x":pe.current.position.x,"position.y":pe.current.position.y,opacity:CS},{duration:Kd,easing:"easeInCubic"});setTimeout(()=>{l.current.victory(),Ge.project.activeLayer.tween({opacity:1},{duration:Zr,easing:"easeOutCubic"});const Er=Math.max(Ge.view.bounds.width,Ge.view.bounds.height)/2;for(const fi of Ye.current){fi.data.animation.stop();const Ni=Math.random()*Math.PI*2,ea=Math.random()*Er;fi.tween({"position.x":fi.position.x+ea*Math.cos(Ni),"position.y":fi.position.y+ea*Math.sin(Ni),opacity:0},{duration:Kd,easing:"easeOutCubic"})}oe(!0)},Kd)}};ze.on({mouseenter:ir,mouseleave:ls,mousedown:bt,mousedrag:zt,mouseup:Nt}),ze.data.removeListeners=()=>ze.off({mouseenter:ir,mouseleave:ls,mousedown:bt,mousedrag:zt,mouseup:Nt})};return(()=>{Ge.setup(ce.current),pe.current=NW(),je&&(be.current=Ge.project.importSVG(`<path d="${je.path}" />`,{applyMatrix:!0}),be.current.sendToBack(),be.current.fillRule="evenodd",be.current.closed=!0);const ze=Ge.project.view.bounds,kt=be.current?be.current.bounds:pe.current.children[3].bounds.scale(2);ze.width>ze.height?_e.current=Math.min(2,Math.min(ze.width*.7,700)/kt.width,Math.min(ze.height*.8,600)/kt.height):_e.current=Math.min(2,Math.min(ze.width*.8,600)/kt.width,Math.min(ze.height*.7,700)/kt.height),be.current&&(be.current.scale(_e.current),be.current.position=Ge.view.center);for(const ht of pe.current.children)ht.scale(_e.current),VW(ht,ce.current),De(ht),bf(ht,ce.current),rv(ht,pe.current)})(),()=>{Ge.project.remove(),Ye.current=null,pe.current=null,be.current=null}},[je]),G.useLayoutEffect(()=>{Me.current=I,be.current&&(I?(be.current.fillColor=m.colors.shape,be.current.position=Ge.view.center):be.current.fillColor="transparent")},[je,I,m]),G.useLayoutEffect(()=>{if(Se.current=S,!S)return;const ye=new Ge.Group;ye.sendToBack();const De=new Ge.Point(ce.current.width,ce.current.height).divide(window.devicePixelRatio),it=()=>Math.random()*(qV-TS)+TS,ze=()=>Math.random()*(CS-xS)+xS;Ye.current=new Array(SS);for(let kt=0;kt<SS;kt++){const ht=new Ge.Path.Circle({center:Ge.Point.random().multiply(De),radius:it(),opacity:ze(),parent:ye,data:{index:kt}}),yt=()=>{const pn={radius:it(),opacity:ze(),"position.x":Math.min(ce.current.width/window.devicePixelRatio,Math.max(0,ht.position.x+Math.random()*200-100)),"position.y":Math.min(ce.current.height/window.devicePixelRatio,Math.max(0,ht.position.y+Math.random()*200-100))};ht.data.animation=ht.tween(pn,{duration:Math.random()*1e4+5e3,easing:"easeInOutQuad"}).then(yt)};yt(),Ye.current[kt]=ht}return()=>{ye.remove(),Ye.current=null}},[je,S]),G.useLayoutEffect(()=>{for(const De of pe.current.children)De.children.display.fillColor=m.colors.pieces[De.data.id],De.children.insetBorder.strokeColor=m.colors.pieces[De.data.id];const ye=Object.values(m.colors.pieces);if(S)for(const De of Ye.current)De.fillColor=ye[Math.floor(Math.random()*ye.length)]},[m.colors,je,S]),G.useEffect(()=>{n()},[]),R.jsxs(fe,{css:{flex:"1",position:"relative",color:"dialogText",animation:`${Zr}ms fadeIn ease`},children:[je&&I===!1&&R.jsx(fe,{css:{zIndex:-1,position:"absolute",top:3,right:3,cursor:"pointer"},children:R.jsx(Md,{tangram:je,selected:!0,hideBadge:!0})}),R.jsx(fe,{as:"canvas",ref:ce,css:{minHeight:"auto",flex:1}}),je&&te&&R.jsx(FW,{tangram:je,onStop:rt,onNext:Z<z.length-1?he:void 0,onApprove:h&&h.isAdmin&&!je.approved?xe:void 0,onStarToggle:h&&je.approved?()=>B(je):void 0})]})},UW=()=>{const t=en(),e=G.useContext(hi),[n,r]=G.useState(!1),[i,s]=G.useState(!1),[a,l]=G.useState(!1),[h,g]=G.useState(!1),{initialized:m}=G.useContext(Zo),{playlist:v,initialized:I}=G.useContext(Mr),{currentUser:S,initialized:j}=G.useContext(Gn),z=j&&m&&I&&v;if(G.useEffect(()=>{setTimeout(()=>r(!0),Zr*2),l(setTimeout(()=>s(!0),Zr*2))},[]),G.useEffect(()=>{z&&(clearTimeout(a),s(!1))},[z]),h)return R.jsxs(R.Fragment,{children:[R.jsx(BW,{}),R.jsx(AW,{})]});const J=()=>{g(!0),S&&e(t.formatMessage({id:"Logged in as {username}"},{username:S.username}))};return R.jsxs(fe,{css:{flex:"1",alignItems:"center",justifyContent:"center",gap:3,animation:z&&n?`${Zr}ms fadeIn ease ${wv}ms forwards reverse`:void 0},deps:[z,n],onAnimationEnd:V=>{V.currentTarget===V.target&&J()},children:[R.jsx(fe,{css:{animation:`${Zr}ms fadeIn ease ${wv}ms both`},children:R.jsx(KP,{css:{size:"logo",overflow:"visible","& > g":{transition:`all ${Zr}ms ease`,transform:z&&n?"translate(30px, -30px)":"translate(0, 0)"}},deps:[z,n]})}),R.jsx(qr,{css:{transition:`opacity ${Zr}ms ease`,opacity:i?1:0},deps:[i],children:t.formatMessage({id:"Loading..."})})]})};navigator.serviceWorker.getRegistrations().then(function(t){for(let e of t)e.unregister()});const jW=()=>(G.useEffect(()=>{matchMedia("hover: none").matches&&(window.oncontextmenu=function(){return!1})},[]),cF({body:{m:0,bg:"background",fontFamily:`-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
        "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
        "Helvetica Neue", sans-serif`,"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",transition:`background-color ${sg}ms`},"body, html, #root":{height:"100%"},"#root":{display:"flex",flexDirection:"column",padding:`
        env(safe-area-inset-top, 0)
        env(safe-area-inset-right, 0)
        env(safe-area-inset-bottom, 0)
        env(safe-area-inset-left, 0)
      `},"*":{boxSizing:"border-box",userSelect:"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"},"input, textarea":{"-webkit-user-select":"initial","-moz-user-select":"initial","-ms-user-select":"initial",userSelect:"initial"}}),R.jsx(IG,{children:R.jsx(aW,{children:R.jsx(tG,{children:R.jsx(nG,{children:R.jsx(rG,{children:R.jsx(yW,{children:R.jsx(xW,{children:R.jsx(iG,{children:R.jsx(TW,{children:R.jsx(bW,{children:R.jsx(fe,{css:{flex:"1",color:"dialogText",fontSize:3},children:R.jsx(UW,{})})})})})})})})})})})}));Av.createRoot(document.getElementById("root")).render(R.jsx(EW,{children:R.jsx(jW,{})}));export{eO as c,_C as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}