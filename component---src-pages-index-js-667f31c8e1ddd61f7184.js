(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{0:function(e,t){},1:function(e,t){},"4HyT":function(e,t,r){e.exports=r.p+"static/victory-d5a884f20ade826001ea9fd93be86345.wav"},Hrb7:function(e,t,r){e.exports=r.p+"static/button-14ce515d099e43f117dc184a4b22a8a7.wav"},Lnxd:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r("ioFf"),r("91GP");var n=r("q1tI"),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=n.createContext&&n.createContext(a),i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&(r[n[a]]=e[n[a]])}return r};function s(e){return function(t){return n.createElement(u,i({attr:i({},e.attr)},t),function e(t){return t&&t.map((function(t,r){return n.createElement(t.tag,i({key:r},t.attr),e(t.child))}))}(e.child))}}function u(e){var t=function(t){var r,a=e.size||t.size||"1em";t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className);var o=e.attr,s=e.title,u=c(e,["attr","title"]);return n.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,u,{className:r,style:i({color:e.color||t.color},t.style,e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&n.createElement("title",null,s),e.children)};return void 0!==o?n.createElement(o.Consumer,null,(function(e){return t(e)})):t(a)}},NczM:function(e,t,r){e.exports=r.p+"static/card-96da3e7a10f4a164c88ac0a09b36ffec.wav"},RXBc:function(e,t,r){"use strict";r.r(t);var n=r("I9K0"),a=r("q1tI"),o=r.n(a),i=r("zSVi"),c=r("MyaD");function s(){var e=Object(a.useContext)(i.a);return Object(c.f)(e),e}r("91GP"),r("rGqo"),r("yt8O"),r("Btvt"),r("RW0V");var u=Object(n.createPrimitive)("div",(function(e){var t=e.css,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["css"]);return Object.assign({css:Object(n.useGap)(Object.assign({display:"flex",minWidth:0,minHeight:0,flex:"none",alignSelf:"auto",alignItems:"stretch",flexDirection:"column",justifyContent:"flex-start"},t))},r)})),l=function(e){var t=Object(a.useContext)(n.ThemeContext);return o.a.createElement(u,Object.assign({as:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 467.27 512"},e),o.a.createElement("polygon",{fill:t.colors.shape,points:"352.33 159.67 432.16 239.45 432.16 399.13 319.29 512 93.55 512 159.67 445.87 0 286.25 319.29 286.25 272.55 239.45 272.55 79.84 352.33 0 465.26 112.87 352.33 112.87 352.33 159.67"}),o.a.createElement("g",null,o.a.createElement("polygon",{fill:t.colors.pieces.mt1,points:"272.57 79.84 272.57 239.45 352.36 319.29 432.19 399.13 432.19 239.45 352.36 159.67 352.36 112.87 465.29 112.87 352.36 0 272.57 79.84"}),o.a.createElement("polygon",{fill:t.colors.pieces.st1,points:"93.58 512 319.32 512 432.19 399.13 319.32 286.25 93.58 512"}),o.a.createElement("polygon",{fill:t.colors.pieces.lt2,points:"159.67 445.87 239.48 366.05 319.31 286.24 0.03 286.24 159.67 445.87"})))},f=r("X7BR"),d=(r("VRzm"),r("rE2o"),r("ioFf"),r("XfO3"),r("HEwt"),r("f3/d"),r("a1Th"),r("o0o1")),m=r.n(d),p=(r("ls82"),r("Vd3H"),r("Wcq6")),g=r.n(p);g.a.apps.length||g.a.initializeApp({apiKey:"AIzaSyAHOemftrTSOUjtoA6K3VR2hkOU5H-ScSI",authDomain:"amstangram.firebaseapp.com",databaseURL:"https://amstangram.firebaseio.com",projectId:"amstangram",storageBucket:"amstangram.appspot.com",messagingSenderId:"1075176148116",appId:"1:1075176148116:web:e61e6512cd983a75533881",measurementId:"G-PLH3BSWLM2"});var v=g.a,b=r("i8i4"),h=Object(n.extendPrimitive)(u,{css:{fontSize:3,p:2,borderRadius:1,bg:"notificationBackground",color:"dialogText",animation:f.FADE_TRANSITION_DURATION/2+"ms fadeIn both",boxShadow:"0px 0px 10px #00000080"}}),y=Object(a.createContext)(null),E=function(e){var t=e.children,r=Object(a.useRef)(),n=Object(a.useState)(null),i=n[0],c=n[1],s=Object(a.useCallback)((function(e){c((function(t){return t&&clearTimeout(t.timeoutId),{content:e,timeoutId:setTimeout((function(){c(null)}),2e3)}}))}),[]);return o.a.createElement(y.Provider,{value:s},t,i&&Object(b.createPortal)(o.a.createElement(u,{css:{position:"fixed",top:0,left:0,bottom:0,right:0,pointerEvents:"none",alignItems:"center",justifyContent:"center"}},o.a.createElement(h,{ref:r},i.content)),document.getElementById("notificationContainer")))};function O(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function j(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){x(o,n,a,i,c,"next",e)}function c(e){x(o,n,a,i,c,"throw",e)}i(void 0)}))}}var S=Object(a.createContext)(null),C=function(e){var t=e.children,r=Object(a.useState)(void 0),n=r[0],i=r[1],c=Object(a.useState)(null),s=c[0],u=c[1],l=Object(a.useState)(!1),f=l[0],d=l[1];Object(a.useEffect)((function(){void 0!==n&&null!==s&&d(!0)}),[n,s]),Object(a.useEffect)((function(){return v.auth().onAuthStateChanged(function(){var e=j(m.a.mark((function e(t){var r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}i(null),e.next=9;break;case 4:return e.next=6,v.firestore().collection("users").doc(t.uid).get();case 6:r=e.sent,n=r.data(),i(Object.assign({uid:t.uid},n,{firebaseUser:t}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(a.useEffect)((function(){return v.firestore().collection("users").onSnapshot((function(e){for(var t,r={},n=O(e.docs);!(t=n()).done;){var a=t.value,o=a.data();r[a.id]=o}u(r)}))}),[]);var p=Object(a.useCallback)(function(){var e=j(m.a.mark((function e(t,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.firebaseUser.updateProfile({displayName:r});case 2:return e.next=4,v.firestore().collection("users").doc(t.uid).update({username:r});case 4:i(Object.assign({},t,{username:r}));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[]),g=Object(a.useCallback)(function(){var e=j(m.a.mark((function e(t,r,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.auth.EmailAuthProvider.credential(t.firebaseUser.email,r),e.next=3,t.firebaseUser.reauthenticateWithCredential(a);case 3:return e.next=5,t.firebaseUser.updatePassword(n);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),[]),b=Object(a.useCallback)(function(){var e=j(m.a.mark((function e(t,r,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.auth.EmailAuthProvider.credential(t.firebaseUser.email,n),e.next=3,t.firebaseUser.reauthenticateWithCredential(a);case 3:return e.next=5,t.firebaseUser.updateEmail(r);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),[]),h=Object(a.useMemo)((function(){return{initialized:f,currentUser:n,usersMetadata:s,updateUsername:p,updatePassword:g,updateEmail:b}}),[f,n,s,p,g,b]);return o.a.createElement(S.Provider,{value:h},t)},I=function(e,t){return t.edges===e.edges?t.length-e.length:t.edges-e.edges},k=function(e,t){return f.DIGITS.indexOf(e.emoji)-f.DIGITS.indexOf(t.emoji)},A=function(e,t){return f.LETTERS.indexOf(e.emoji)-f.LETTERS.indexOf(t.emoji)};function M(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var R=Object(a.createContext)([]),L=function(e){var t=e.children,r=Object(a.useContext)(S).currentUser,n=Object(a.useState)(null),i=n[0],c=n[1];Object(a.useEffect)((function(){return v.firestore().collection("tangrams").onSnapshot((function(e){for(var t,r=[],n=M(e.docs);!(t=n()).done;){var a=t.value,o=a.id,i=a.data(),s=Object.assign({},i);r.push(Object.assign({id:o},s))}c(r)}))}),[]);var s=Object(a.useMemo)((function(){if(!i)return{initialized:!1,approvedTangrams:null,pendingTangrams:null,approvedTangramsByCategory:null};for(var e,t=[],n=[],a=M(i);!(e=a()).done;){var o=e.value;o.approved?t.push(o):r&&(r.isAdmin||o.uid===r.uid)&&n.push(o)}return{initialized:!0,approvedTangrams:t,pendingTangrams:n}}),[r,i]);return o.a.createElement(R.Provider,{value:s},t)};function P(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){P(o,n,a,i,c,"next",e)}function c(e){P(o,n,a,i,c,"throw",e)}i(void 0)}))}}function _(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(e,t):void 0}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var B=Object(a.createContext)(null),z=function(e){var t=e.children,r=s(),n=Object(a.useContext)(y),i=Object(a.useContext)(S).currentUser,c=Object(a.useContext)(R).approvedTangrams,u=Object(a.useState)(null),l=u[0],f=u[1],d=Object(a.useState)(null),p=d[0],g=d[1],b=Object(a.useState)(null),h=b[0],E=b[1],O=Object(a.useState)(0),w=O[0],x=O[1],j=Object(a.useState)(!1),C=j[0],I=j[1];Object(a.useEffect)((function(){l&&p&&I(!0)}),[l,p]),Object(a.useEffect)((function(){return v.firestore().collection("stats").onSnapshot((function(e){for(var t,r={},n={},a=function(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=D(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}(e.docs);!(t=a()).done;){var o=t.value,i=o.id,c=o.data();for(var s in r[i]||(r[i]={},n[i]={}),c)r[i][s]=c[s].completed,n[i][s]=c[s].starred}f(r),g(n)}))}),[]);var k=Object(a.useCallback)((function(e){return!(!i||!p[e])&&!0===p[e][i.uid]}),[i,p]),A=Object(a.useCallback)((function(e){return!(!i||!l[e])&&void 0!==l[e][i.uid]}),[i,l]),M=Object(a.useCallback)((function(e){var t,a,o=window.location.origin+"/?tangrams="+e.map((function(e){return e.id})).join(",");i&&(o+="&uid="+i.uid),t=o,(a=document.createElement("textarea")).value=t,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),n(r.formatMessage({id:"Challenge link copied to clipboard"}))}),[n,i,r]),T=Object(a.useCallback)((function(){x((function(e){return e+1}))}),[]),L=Object(a.useCallback)((function(e){var t=e?function(e,t){var r=e.id,n=e.edges,a=t.id,o=t.edges,i=A(r),c=A(a);return i||c?i-c:o-n}:function(e,t){var r=e.id,n=t.id;return A(r)-A(n)},r=function(e){for(var t,r,n=e.length;0!==n;)r=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[r],e[r]=t;return e}(_(c)).sort(t);E(r)}),[c,A]),P=Object(a.useCallback)(function(){var e=N(m.a.mark((function e(t,r){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i||!c.some((function(e){return e.id===t.id}))||A(t.id)){e.next=3;break}return e.next=3,v.firestore().collection("stats").doc(t.id).set(((n={})[i.uid]={completed:r},n),{merge:!0});case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[c,i,A]),U=Object(a.useCallback)(function(){var e=N(m.a.mark((function e(t){var r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i||!c.some((function(e){return e.id===t.id}))){e.next=4;break}return n=k(t.id),e.next=4,v.firestore().collection("stats").doc(t.id).set(((r={})[i.uid]={starred:!n},r),{merge:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[c,i,k]),z=Object(a.useMemo)((function(){return{initialized:C,requestSave:T,saveRequestId:w,playlist:h,setPlaylist:E,shareTangrams:M,startRandomPlaylist:L,tangramsCompletedBy:l,tangramsStarredBy:p,toggleTangramStar:U,markTangramAsComplete:P,isTangramCompleted:A,isTangramStarred:k}}),[C,T,w,h,M,L,l,p,U,P,A,k]);return o.a.createElement(B.Provider,{value:z},t)},F=(r("CX2u"),r("Tgqd"));r("Z2Ku"),r("L9s1"),r("KKXr"),r("OG14");function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var V=function(e,t){void 0===t&&(t={});var n,i=t,c=i.volume,s=void 0===c?1:c,u=i.playbackRate,l=void 0===u?1:u,f=i.soundEnabled,d=void 0===f||f,m=i.interrupt,p=void 0!==m&&m,g=i.onload,v=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(i,["volume","playbackRate","soundEnabled","interrupt","onload"]),b=o.a.useRef(null),h=o.a.useState(!1),y=h[0],E=h[1],O=o.a.useState(null),w=O[0],x=O[1],j=o.a.useState(null),S=j[0],C=j[1],I=function(){"function"==typeof g&&g.call(this),x(1e3*this.duration())};n=function(){r.e(9).then(r.t.bind(null,"HlzF",7)).then((function(t){b.current=t.Howl;var r=new b.current(G({src:[e],volume:s,onload:I},v));C(r)}))},Object(a.useEffect)(n,[]),o.a.useEffect((function(){b.current&&S&&C(new b.current(G({src:[e],volume:s,onload:I},v)))}),[e]),o.a.useEffect((function(){S&&(S.volume(s),S.rate(l))}),[s,l]);var k=o.a.useCallback((function(e){void 0===e&&(e={}),S&&(d||e.forceSoundEnabled)&&(p&&S.stop(),e.playbackRate&&S.rate(e.playbackRate),S.play(e.id),S.once("end",(function(){return E(!1)})),E(!0))}),[S,d,p]),A=o.a.useCallback((function(e){S&&(S.stop(e),E(!1))}),[S]),M=o.a.useCallback((function(e){S&&(S.pause(e),E(!1))}),[S]);return[k,{sound:S,stop:A,pause:M,isPlaying:y,duration:w}]},q=r("xiZb"),W=r.n(q),H=r("Hrb7"),Y=r.n(H),X=r("NczM"),K=r.n(X),$=r("wCrC"),J=r.n($),Q=r("4HyT"),Z=r.n(Q),ee=Object(a.createContext)([!0,function(){}]),te=function(e){var t=e.children,r=Object(a.useState)(!0),n=r[0],i=r[1],c=V(W.a,{soundEnabled:n})[0],s=V(Y.a,{soundEnabled:n})[0],u=V(Y.a,{soundEnabled:n})[0],l=V(K.a,{soundEnabled:n})[0],f=V(J.a,{soundEnabled:n})[0],d=V(Z.a,{soundEnabled:n})[0];Object(a.useEffect)((function(){i("off"!==window.localStorage.getItem("sound"))}),[]);var m=Object(a.useCallback)((function(){var e=!n;i(e),window.localStorage.setItem("sound",e?"on":"off")}),[n]),p=Object(a.useMemo)((function(){return{soundEnabled:n,toggleSound:m,playButton:s,playToggle:u,playCard:l,playStar:c,playTangram:f,playVictory:d}}),[n,m,s,u,l,c,f,d]);return o.a.createElement(ee.Provider,{value:p},t)};function re(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}var ne=Object(n.createPrimitive)("button",(function(e){var t=e.css,r=e.onClick,n=e.mute,o=re(e,["css","onClick","mute"]),i=Object(a.useContext)(ee).playButton;return Object.assign({css:Object.assign({borderRadius:2,minWidth:0,minHeight:0,flex:"none",fontWeight:"bold",border:"none",fontSize:"inherit",color:"inherit",background:"none",cursor:"pointer",p:3,"&:disabled":{opacity:.3,cursor:"not-allowed"},"&:focus":{outline:"none"}},t),onClick:function(e){n||i(),r&&r(e)}},o)})),ae=Object(n.extendPrimitive)(ne,{css:{border:"2px solid",borderRadius:2}}),oe=Object(n.extendPrimitive)(ne,{css:{border:"2px solid",color:"errorText"}}),ie=Object(n.extendPrimitive)(ne,(function(e){var t=e.css,r=re(e,["css"]),a=Object(n.useKeyframes)({0:{bg:"pieces.lt2"},14:{bg:"pieces.rh"},28:{bg:"pieces.st2"},42:{bg:"pieces.mt1"},57:{bg:"pieces.st1"},71:{bg:"pieces.lt1"},85:{bg:"pieces.sq"},100:{bg:"pieces.lt2"}});return Object.assign({css:Object.assign({animation:a+" 20s linear infinite both",color:"#FFFFFFDD"},t)},r)}));var ce=function(e){var t=e.uid,r=e.size,i=void 0===r?"badge":r,c=e.css,s=e.onClick,l=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["uid","size","css","onClick"]),f=Object(a.useContext)(ee).playButton,d=Object(a.useContext)(n.ThemeContext),m=Math.max(40,d.sizes[i]||i);return o.a.createElement(u,Object.assign({as:"img",src:"https://api.adorable.io/avatars/"+m+"/"+t+".png",css:Object.assign({m:"2px",boxShadow:"0 0 0 2px "+d.colors.dialogText,borderRadius:"50%",size:i},c),onClick:s?function(e){f(),s(e)}:void 0},l))};var se=function(e){var t,r,i,c,s,l,d,m,p=e.showStroke,g=e.tangram,v=e.completed,b=e.selected,h=e.css,y=e.onBadgeClick,E=e.onClick,O=e.onLongPress,w=e.hideBadge,x=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["showStroke","tangram","completed","selected","css","onBadgeClick","onClick","onLongPress","hideBadge"]),j=g.path,S=g.width,C=g.height,I=g.uid,k=g.approved,A=g.emoji,M=Object(a.useMemo)((function(){return function(e){return e.edges>16?0:e.edges>8?1:2}(g)}),[g]),T=Object(a.useContext)(ee).playCard,R=Object(a.useContext)(n.ThemeContext).colors.difficulties[M],L=Object(a.useCallback)((function(){O&&O(g)}),[O,g]),P=(t=L,r=1e3,i=Object(a.useState)(null),c=i[0],s=i[1],{onMouseDown:l=function(e){if(c&&e.touches&&1!==e.touches.length)clearTimeout(c.timeoutId);else{var n=e.touches?e.touches.item(0):e;s({timeoutId:setTimeout(t,r),startEvent:{clientX:n.clientX,clientY:n.clientY}})}},onMouseUp:m=function(){c&&clearTimeout(c.timeoutId)},onMouseMove:d=function(e){if(c){var t=e.touches?e.touches.item(0):e;Math.sqrt(Math.pow(t.clientX-c.startEvent.clientX,2)+Math.pow(t.clientY-c.startEvent.clientY,2))>10&&clearTimeout(c.timeoutId)}},onMouseLeave:m,onTouchStart:l,onTouchEnd:m,onTouchMove:d});return o.a.createElement(u,Object.assign({css:h,onClick:E?function(){T(),E(g)}:void 0},P,x),o.a.createElement(u,{css:{opacity:I&&!1===k?.5:1,borderRadius:5,boxShadow:b?"0px 0px 0px 4px "+R:"0px 0px 0px 1px rgba(0, 0, 0, 0.1)",m:1,bg:"background",transition:"background-color "+f.COLOR_TRANSITION_DURATION+"ms",p:3,textAlign:"center",position:"relative",cursor:E||O?"pointer":void 0,width:128,height:178},deps:[R,b,I,k]},o.a.createElement(u,{as:"svg",css:{flex:"1",justifyContent:"center",fill:R,stroke:p?"lime":void 0,strokeWidth:p?8:void 0},deps:[p,R],viewBox:"0 0 "+S+" "+C,dangerouslySetInnerHTML:{__html:'<path d="'+j+'" />'}}),v&&o.a.createElement(u,{css:{position:"absolute",top:1,left:1,fontSize:"30px"}},A),I&&!w&&o.a.createElement(ce,{uid:I,css:{position:"absolute",bottom:1,right:1,cursor:y?"pointer":void 0},onClick:y?function(e){e.stopPropagation(),y(I)}:void 0})))};var ue=function(e){var t=e.children,r=e.title,n=e.onClose,i=e.css,c=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["children","title","onClose","css"]),s=Object(a.useContext)(ee).playButton;return Object(b.createPortal)(o.a.createElement(u,{onClick:n,css:{position:"fixed",top:0,left:0,right:0,bottom:0,bg:"#00000080",alignItems:"center",justifyContent:"center",animation:f.FADE_TRANSITION_DURATION/2+"ms fadeIn ease both",p:3}},o.a.createElement(u,{css:{flex:"0 1 auto",bg:"dialogBackground",color:"dialogText",borderRadius:3,transition:"background-color "+f.COLOR_TRANSITION_DURATION+"ms, color "+f.COLOR_TRANSITION_DURATION+"ms",fontSize:3,p:3,gap:3,maxWidth:"95vw",minWidth:"300px"},onClick:function(e){return e.stopPropagation()}},o.a.createElement(u,{css:{flexDirection:"row",gap:3,alignItems:"center",justifyContent:"space-between",zIndex:1}},r,o.a.createElement(u,{as:F.o,css:{cursor:"pointer",size:"badge",ml:r?void 0:"auto"},onClick:function(){s(),n()}})),o.a.createElement(u,Object.assign({css:Object.assign({overflow:"auto",flex:"1",maxWidth:"100%"},i)},c),t))),document.getElementById("dialogContainer"))},le=Object(n.createPrimitive)("div",{css:{display:"inline",minWidth:0,minHeight:0,flex:"none"}}),fe=Object(n.extendPrimitive)(le,{css:{fontSize:2,color:"errorText"}}),de=Object(n.extendPrimitive)(le,{css:{fontSize:2,opacity:.75}}),me=Object(n.extendPrimitive)(le,{css:{fontSize:4,fontWeight:"bold"}}),pe=Object(n.extendPrimitive)(le,{css:{fontSize:3,fontWeight:"bold"}}),ge=Object(n.createPrimitive)("a",{css:{cursor:"pointer",textDecoration:"underline",color:"inherit","&:visited":{color:"inherit"}}}),ve=Object(n.extendPrimitive)(le,{css:{cursor:"pointer",textDecoration:"underline"}}),be=function(e){var t=e.icon,r=e.css;return o.a.createElement(le,{as:t,css:Object.assign({position:"relative",top:"0.1em",size:"0.9em"},r)})},he=function(e){var t=e.uid,r=e.tangrams,n=e.deferred,i=s(),c=Object(a.useContext)(S).usersMetadata,l=Object(a.useContext)(B).setPlaylist,d=c[t]?c[t].username:null;return o.a.createElement(ue,{title:o.a.createElement(me,null,d?i.formatMessage({id:"{username} challenged you"},{username:d}):i.formatMessage({id:"Rise to the challenge"},{username:d})),onClose:function(){return n.reject(f.DIALOG_CLOSED_REASON)},css:{gap:3,overflow:"initial",maxWidth:"568px"}},o.a.createElement(u,{css:{flex:"1",overflow:"auto",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",m:-1}},r.map((function(e){return o.a.createElement(se,{key:e.id,selected:!0,tangram:e,css:{m:1}})}))),o.a.createElement(ie,{onClick:function(){l(r),n.resolve()}},i.formatMessage({id:"Let's go!"})))},ye=(r("I5cv"),r("KQm4")),Ee=r("1OyB"),Oe=r("vuIU"),we=r("Ji7U"),xe=r("md7G"),je=r("foSv"),Se=r("LiQ7"),Ce=r("6koa");function Ie(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ke=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Ae=r.n(Ce).a||Ce;function Me(e,t){return Object(Se.a)(Object.assign(Object.assign({},c.a),{locale:"en"}),Object(c.b)(),e,t)}var Te=function(e){Object(we.a)(n,e);var t,r=(t=n,function(){var e,r=Object(je.a)(t);if(Ie()){var n=Object(je.a)(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return Object(xe.a)(this,e)});function n(){return Object(Ee.a)(this,n),r.apply(this,arguments)}return Object(Oe.a)(n,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,r=t.values,n=ke(t,["values"]),a=e.values,o=ke(e,["values"]);return!Ae(a,r)||!Ae(n,o)}},{key:"render",value:function(){var e=this;return a.createElement(i.a.Consumer,null,(function(t){e.props.defaultMessage||Object(c.f)(t);var r=t||{},n=r.formatMessage,o=void 0===n?Me:n,i=r.textComponent,s=void 0===i?a.Fragment:i,u=e.props,l=u.id,f=u.description,d=u.defaultMessage,m=u.values,p=u.children,g=u.tagName,v=void 0===g?s:g,b=o({id:l,description:f,defaultMessage:d},m);return Array.isArray(b)||(b=[b]),"function"==typeof p?p.apply(void 0,Object(ye.a)(b)):v?a.createElement.apply(a,[v,null].concat(Object(ye.a)(b))):b}))}}]),n}(a.Component);Te.displayName="FormattedMessage",Te.defaultProps={values:{}};var Re=Te,Le=Object(n.createPrimitive)("input",{type:"text",css:{color:"inherit",fontSize:"inherit",bg:"inputBackground",border:"none",borderRadius:2,borderColor:"currentColor",p:2,"&:disabled":{opacity:.5,cursor:"not-allowed"},"&:focus":{outline:"none"}}});function Pe(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_e(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function Ne(e){return function(e){if(Array.isArray(e))return De(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_e(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){if(e){if("string"==typeof e)return De(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(e,t):void 0}}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ue=Object(n.extendPrimitive)(u,(function(e){var t=e.css,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["css"]),o=Object(a.useContext)(n.ThemeContext);return Object.assign({css:Object.assign({p:3,alignItems:"center",position:"sticky",top:0,zIndex:1,background:"linear-gradient(0deg, rgba(0,0,0,0) 0%, "+o.colors.dialogBackground+" 50%)"},t)},r)})),Be=function(e){var t=e.deferred,r=s(),n=Object(a.useContext)(S).currentUser,i=Object(a.useContext)(R),c=i.pendingTangrams,l=i.approvedTangrams,d=Object(a.useContext)(Kr),m=d.showProfile,p=d.showTangram,g=Object(a.useContext)(B),v=g.setPlaylist,b=g.shareTangrams,h=g.startRandomPlaylist,y=g.isTangramCompleted,E=g.isTangramStarred,O=Object(a.useState)([]),w=O[0],x=O[1],j=Object(a.useState)((function(){var e=window.localStorage.getItem("selectedGalleryFilter");return["all","uncompleted","starred","pending"].includes(e)?e:"all"})),C=j[0],M=j[1],T=Object(a.useCallback)((function(e){console.log(e),x((function(t){return t.some((function(t){return t.id===e.id}))?t.filter((function(t){return t.id!==e.id})):[].concat(Ne(t),[e])}))}),[]),L=Object(a.useMemo)((function(){for(var e,t={},r=Pe("pending"===C?c:l);!(e=r()).done;){var n=e.value;"uncompleted"===C&&y(n.id)||("starred"!==C||E(n.id))&&(t[n.category]||(t[n.category]=[]),t[n.category].push(n))}for(var a,o={},i=Pe(Object.keys(t).sort());!(a=i()).done;){var s=a.value;o[s]=t[s].sort("letters"===s?A:"digits"===s?k:I)}return o}),[c,l,C,y,E]),P=Object.keys(L);return o.a.createElement(o.a.Fragment,null,o.a.createElement(ue,{title:o.a.createElement(me,null,r.formatMessage({id:"Tangram gallery"})),css:{gap:3,width:"568px"},onClose:function(){return t.reject(f.DIALOG_CLOSED_REASON)}},o.a.createElement(o.a.Fragment,null,o.a.createElement(Le,{as:"select",value:C,onChange:function(e){M(e.target.value),window.localStorage.setItem("selectedGalleryFilter",e.target.value)}},o.a.createElement("option",{value:"all"},r.formatMessage({id:"All tangrams"})),o.a.createElement("option",{value:"uncompleted"},r.formatMessage({id:"Uncompleted tangrams"})),o.a.createElement("option",{value:"starred"},r.formatMessage({id:"‚òÖ Starred tangrams"})),o.a.createElement("option",{value:"pending"},r.formatMessage({id:"Pending approbation tangrams"}))),o.a.createElement(u,{css:{flex:"1",overflow:"auto",gap:3}},0===P.length?o.a.createElement(u,{key:"noresult",css:{gap:3,alignItems:"center"}},"uncompleted"===C?o.a.createElement(o.a.Fragment,null,o.a.createElement(le,{css:{fontSize:"8em"}},"üçæ"),o.a.createElement(u,{css:{gap:2,alignItems:"center",px:3}},o.a.createElement(pe,{css:{textAlign:"center"}},o.a.createElement(Re,{id:"You've completed all tangrams"})),o.a.createElement(de,null,o.a.createElement(Re,{id:"Come back later for more or create your own tangrams"})))):"pending"===C?n&&n.isAdmin?o.a.createElement(o.a.Fragment,null,o.a.createElement(le,{css:{fontSize:"8em"}},"üëÆ"),o.a.createElement(u,{css:{gap:2,alignItems:"center",px:3}},o.a.createElement(pe,{css:{textAlign:"center"}},o.a.createElement(Re,{id:"No tangram left to approve"})),o.a.createElement(de,null,o.a.createElement(Re,{id:"Good job moderator {username}!",values:{username:n.username}})))):o.a.createElement(o.a.Fragment,null,o.a.createElement(le,{css:{fontSize:"8em"}},"üëç"),o.a.createElement(u,{css:{gap:2,alignItems:"center",px:3}},o.a.createElement(pe,{css:{textAlign:"center"}},o.a.createElement(Re,{id:"All your tangrams have been approved"})),o.a.createElement(de,null,o.a.createElement(Re,{id:"Create more tangrams and earn <starIcon></starIcon>",values:{starIcon:function(){return o.a.createElement(be,{icon:F.j,css:{fill:"currentColor"}})}}})))):"starred"===C?o.a.createElement(o.a.Fragment,null,o.a.createElement(le,{css:{fontSize:"8em"}},"üåÉ"),o.a.createElement(u,{css:{gap:2,alignItems:"center",px:3}},o.a.createElement(pe,{css:{textAlign:"center"}},o.a.createElement(Re,{id:"No starred tangrams yet"})),o.a.createElement(de,null,o.a.createElement(Re,{id:"Press <starIcon></starIcon> to star a tangram and show your love",values:{starIcon:function(){return o.a.createElement(be,{icon:F.j,css:{fill:"currentColor"}})}}})))):o.a.createElement(o.a.Fragment,null,o.a.createElement(le,{css:{fontSize:"8em"}},"ü§∑"),o.a.createElement(u,{css:{gap:2,alignItems:"center",px:3}},o.a.createElement(pe,{css:{textAlign:"center"}},o.a.createElement(Re,{id:"Nothing to see here"})),o.a.createElement(de,null,o.a.createElement(Re,{id:"Something might have gone wrong"}))))):o.a.createElement(u,{key:"results",css:{flex:"1",overflow:"auto",gap:3}},P.map((function(e){return o.a.createElement(u,{key:e},o.a.createElement(Ue,null,o.a.createElement(pe,null,r.formatMessage({id:e}))),o.a.createElement(u,{css:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 136px)",gridColumnGap:2,gridRowGap:2,justifyContent:"center",justifyItems:"center",alignItems:"center"}},L[e].map((function(e){return o.a.createElement(se,{showStroke:"pending"===C&&n&&n.isAdmin,key:e.id,tangram:e,completed:y(e.id),selected:w.some((function(t){return t.id===e.id})),onClick:T,onBadgeClick:m,onLongPress:p})}))))})))),o.a.createElement(u,{css:{flexDirection:"row",gap:2}},o.a.createElement(ie,{onClick:function(){w.length?v(w):h(),t.resolve()},css:{flex:"1"}},0===w.length?r.formatMessage({id:"Play now!"}):1===w.length?r.formatMessage({id:"Start 1 tangram!"}):r.formatMessage({id:"Start {count} tangrams!"},{count:w.length})),o.a.createElement(ie,{disabled:0===w.length,onClick:function(){return b(w)}},o.a.createElement(u,{as:F.i,css:{size:"icon",m:"-2px"}}))))))};function ze(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Fe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fe(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ge=function(e){var t=e.deferred,r=s(),n=Object(a.useContext)(Kr).showProfile,i=Object(a.useContext)(S),c=i.currentUser,l=i.usersMetadata,d=Object(a.useContext)(R).approvedTangrams,m=Object(a.useContext)(B),p=m.tangramsStarredBy,g=m.tangramsCompletedBy,v=Object(a.useState)((function(){var e=window.localStorage.getItem("selectedLeaderboard");return["stars","completed","created"].includes(e)?e:"stars"})),b=v[0],h=v[1],y=Object(a.useMemo)((function(){for(var e,t={},r={},n={},a=ze(d);!(e=a()).done;){var o=e.value,i=o.id,c=o.uid;for(var s in r[c]||(r[c]=0,t[c]=0),p[i])s!==c&&p[i][s]&&(t[c]+=1);for(var u in r[c]+=1,g[i])n[u]||(n[u]=0),n[u]+=1}return Object.keys(l).map((function(e){var a=l[e];return Object.assign({uid:e},a,{stars:t[e]||0,completed:n[e]||0,created:r[e]||0})}))}),[d,p,g,l]),E=Object(a.useMemo)((function(){if(y)return y.sort((function(e,t){return t[b]-e[b]}))}),[y,b]);return o.a.createElement(ue,{title:o.a.createElement(me,null,r.formatMessage({id:"Leaderboard"})),onClose:function(){return t.reject(f.DIALOG_CLOSED_REASON)},css:{gap:3}},o.a.createElement(o.a.Fragment,null,o.a.createElement(Le,{as:"select",value:b,onChange:function(e){h(e.target.value),window.localStorage.setItem("selectedLeaderboard",e.target.value)}},o.a.createElement("option",{value:"stars"},r.formatMessage({id:"Stars earned"})),o.a.createElement("option",{value:"completed"},r.formatMessage({id:"Completed tangrams"})),o.a.createElement("option",{value:"created"},r.formatMessage({id:"Created tangrams"}))),o.a.createElement(u,{css:{flex:"1",overflow:"auto",gap:2}},E.map((function(e,t){var r=e.uid,a=e.username,i=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["uid","username"]);return o.a.createElement(u,{key:r,css:{flexDirection:"row",gap:2,alignItems:"center",fontSize:0===t?"1.6em":1===t?"1.4em":2===t?"1.2em":void 0},deps:[t]},o.a.createElement(ce,{uid:r,size:"badge",onClick:function(){return function(e){n(e)}(r)}}),o.a.createElement(le,{css:{flex:"1",fontWeight:c&&c.uid===r?"bold":void 0},deps:[c,r]},a),o.a.createElement(le,null,i[b],"stars"===b&&o.a.createElement(o.a.Fragment,null," ",o.a.createElement(be,{icon:F.j,css:{fill:"currentColor"}}))))})))))};r("bHtr"),r("hhXQ"),r("SRfc"),r("T39b");function Ve(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function qe(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ve(o,n,a,i,c,"next",e)}function c(e){Ve(o,n,a,i,c,"throw",e)}i(void 0)}))}}r("Oyvg"),r("dRSK"),r("9VmF");var We=r("rePB");var He=r("BsWD");function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(s){a=!0,o=s}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}}(e,t)||Object(He.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r("/8Fb"),r("pIFo");var Xe=function(e){return void 0===e},Ke=function(e){return null===e||Xe(e)},$e=function(e){return Array.isArray(e)},Je=function(e){return"object"==typeof e},Qe=function(e){return!Ke(e)&&!$e(e)&&Je(e)},Ze=function(e){return Qe(e)&&e.nodeType===Node.ELEMENT_NODE},et={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit"},tt="undefined",rt={BLUR:"blur",CHANGE:"change",INPUT:"input"},nt="max",at="min",ot="maxLength",it="minLength",ct="pattern",st="required",ut="validate",lt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ft=/^\w*$/,dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mt=/\\(\\)?/g;var pt=function(e){return!$e(e)&&(ft.test(e)||!lt.test(e))},gt=function(e){var t=[];return e.replace(dt,(function(e,r,n,a){t.push(n?a.replace(mt,"$1"):r||e)})),t};function vt(e,t,r){for(var n=-1,a=pt(t)?[t]:gt(t),o=a.length,i=o-1;++n<o;){var c=a[n],s=r;if(n!==i){var u=e[c];s=Qe(u)||$e(u)?u:isNaN(+a[n+1])?{}:[]}e[c]=s,e=e[c]}return e}var bt=function(e){return Object.entries(e).reduce((function(e,t){var r=Ye(t,2),n=r[0],a=r[1];return pt(n)?Object.assign(Object.assign({},e),Object(We.a)({},n,a)):(vt(e,n,a),e)}),{})},ht=function(e,t,r){var n=t.split(/[,[\].]+?/).filter(Boolean).reduce((function(e,t){return Ke(e)?e:e[t]}),e);return Xe(n)||n===e?e[t]||r:n},yt=function(e,t){for(var r in e)if(ht(t,r)){var n=e[r];if(n){if(n.ref.focus){n.ref.focus();break}if(n.options){n.options[0].ref.focus();break}}}},Et=function(e,t){Ze(e)&&e.removeEventListener&&(e.removeEventListener(rt.INPUT,t),e.removeEventListener(rt.CHANGE,t),e.removeEventListener(rt.BLUR,t))},Ot=function(e){return"radio"===e.type},wt=function(e){return"checkbox"===e.type};function xt(e){return!e||e instanceof HTMLElement&&e.nodeType!==Node.DOCUMENT_NODE&&xt(e.parentNode)}var jt=function(e){return Qe(e)&&!Object.keys(e).length};function St(e){return $e(e)?e:gt(e)}function Ct(e,t){return 1==t.length?e:function(e,t){for(var r=pt(t)?[t]:St(t),n=t.length,a=0;a<n;)e=Xe(e)?a++:e[r[a++]];return a==n?e:void 0}(e,function(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t;for(var o=Array(a);++n<a;)o[n]=e[n+t];return o}(t,0,-1))}function It(e,t){return t.forEach((function(t){!function(e,t){for(var r=pt(t)?[t]:St(t),n=Ct(e,r),a=r[r.length-1],o=!(null!=n)||delete n[a],i=void 0,c=0;c<r.slice(0,-1).length;c++){var s=-1,u=void 0,l=r.slice(0,-(c+1)),f=l.length-1;for(c>0&&(i=e);++s<l.length;){var d=l[s];u=u?u[d]:e[d],f===s&&(Qe(u)&&jt(u)||$e(u)&&!u.filter((function(e){return Qe(e)&&!jt(e)})).length)&&(i?delete i[d]:delete e[d]),i=u}}}(e,t)})),e}var kt={isValid:!1,value:""},At=function(e){return $e(e)?e.filter(Boolean).reduce((function(e,t){var r=t.ref,n=r.checked,a=r.value;return n?{isValid:!0,value:a}:e}),kt):kt},Mt=function(e){return Object(ye.a)(e).filter((function(e){return e.selected})).map((function(e){return e.value}))},Tt=function(e){return"file"===e.type},Rt=function(e){return"select-multiple"===e.type},Lt=function(e){return""===e},Pt={value:!1,isValid:!1},Nt={value:!0,isValid:!0},_t=function(e){if($e(e)){if(e.length>1){var t=e.filter((function(e){return e.ref.checked})).map((function(e){return e.ref.value}));return{value:t,isValid:!!t.length}}var r=e[0].ref,n=r.checked,a=r.value,o=r.attributes;return n?o&&!Xe(o.value)?Xe(a)||Lt(a)?Nt:{value:a,isValid:!0}:Nt:Pt}return Pt};function Dt(e,t){var r=t.name,n=t.value,a=e[r];return Tt(t)?t.files:Ot(t)?a?At(a.options).value:"":Rt(t)?Mt(t.options):wt(t)?!!a&&_t(a.options).value:n}var Ut=function(e){return"string"==typeof e},Bt=function(e,t){var r={},n=function(n){(Xe(t)||(Ut(t)?n.startsWith(t):$e(t)?t.find((function(e){return n.startsWith(e)})):t&&t.nest))&&(r[n]=Dt(e,e[n].ref))};for(var a in e)n(a);return r},zt=function(e,t){var r=t.type,n=t.types,a=t.message;return Qe(e)&&e.type===r&&e.message===a&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.entries(e),n=Object.keys(t);return r.length===n.length&&r.reduce((function(e,r){var n=Ye(r,2),a=n[0],o=n[1];return!!e&&(t[a]&&t[a]===o)}),!0)}(e.types,n)};var Ft=function(e){return e instanceof RegExp},Gt=function(e){var t;return Qe(t=e)&&!Ft(t)?e:{value:e,message:""}},Vt=function(e){return"function"==typeof e},qt=function(e){return"boolean"==typeof e},Wt=function(e){return Ut(e)||Qe(e)&&Object(a.isValidElement)(e)};function Ht(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"validate";if(Wt(e)||qt(e)&&!e)return{type:r,message:Wt(e)?e:"",ref:t}}var Yt=function(e,t,r,n,a){if(t){var o=r[e];return Object.assign(Object.assign({},o),{types:Object.assign(Object.assign({},o&&o.types?o.types:{}),Object(We.a)({},n,a||!0))})}return{}},Xt=function(){var e=qe(m.a.mark((function e(t,r,n){var a,o,i,c,s,u,l,f,d,p,g,v,b,h,y,E,O,w,x,j,S,C,I,k,A,M,T,R,L,P,N,_,D,U,B,z,F,G,V,q,W,H,Y,X,K,$,J,Q,Z,ee,te,re,ne,ae,oe,ie,ce,se,ue;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.ref,o=n.ref,i=o.type,c=o.value,s=o.name,u=n.options,l=n.required,f=n.maxLength,d=n.minLength,p=n.min,g=n.max,v=n.pattern,b=n.validate,y=t.current,E={},O=Ot(a),w=wt(a),x=O||w,j=Lt(c),S=Yt.bind(null,s,r,E),C=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ot,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:it,c=e?t:n;if(E[s]=Object.assign({type:e?o:i,message:c,ref:a},S(e?o:i,c)),!r)return E},!l||!(!O&&!w&&(j||Ke(c))||qt(c)&&!c||w&&!_t(u).isValid||O&&!At(u).isValid)){e.next=15;break}if(I=Wt(l)?{value:!!l,message:l}:Gt(l),k=I.value,A=I.message,!k){e.next=15;break}if(E[s]=Object.assign({type:st,message:A,ref:x?null===(h=y[s].options)||void 0===h?void 0:h[0].ref:a},S(st,A)),r){e.next=15;break}return e.abrupt("return",E);case 15:if(Ke(p)&&Ke(g)){e.next=23;break}if(R=Gt(g),L=R.value,P=R.message,N=Gt(p),_=N.value,D=N.message,"number"===i||!i&&!isNaN(c)?(U=a.valueAsNumber||parseFloat(c),Ke(L)||(M=U>L),Ke(_)||(T=U<_)):(B=a.valueAsDate||new Date(c),Ut(L)&&(M=B>new Date(L)),Ut(_)&&(T=B<new Date(_))),!M&&!T){e.next=23;break}if(C(!!M,P,D,nt,at),r){e.next=23;break}return e.abrupt("return",E);case 23:if(!Ut(c)||j||!f&&!d){e.next=33;break}if(z=Gt(f),F=z.value,G=z.message,V=Gt(d),q=V.value,W=V.message,H=c.toString().length,Y=!Ke(F)&&H>F,X=!Ke(q)&&H<q,!Y&&!X){e.next=33;break}if(C(!!Y,G,W),r){e.next=33;break}return e.abrupt("return",E);case 33:if(!v||j){e.next=39;break}if(K=Gt(v),$=K.value,J=K.message,!Ft($)||$.test(c)){e.next=39;break}if(E[s]=Object.assign({type:ct,message:J,ref:a},S(ct,J)),r){e.next=39;break}return e.abrupt("return",E);case 39:if(!b){e.next=72;break}if(Q=Dt(y,a),Z=x&&u?u[0].ref:a,!Vt(b)){e.next=53;break}return e.next=45,b(Q);case 45:if(ee=e.sent,!(te=Ht(ee,Z))){e.next=51;break}if(E[s]=Object.assign(Object.assign({},te),S(ut,te.message)),r){e.next=51;break}return e.abrupt("return",E);case 51:e.next=72;break;case 53:if(!Qe(b)){e.next=72;break}re={},ne=0,ae=Object.entries(b);case 56:if(!(ne<ae.length)){e.next=68;break}if(oe=Ye(ae[ne],2),ie=oe[0],ce=oe[1],jt(re)||r){e.next=60;break}return e.abrupt("break",68);case 60:return e.next=62,ce(Q);case 62:se=e.sent,(ue=Ht(se,Z,ie))&&(re=Object.assign(Object.assign({},ue),S(ie,ue.message)),r&&(E[s]=re));case 65:ne++,e.next=56;break;case 68:if(jt(re)){e.next=72;break}if(E[s]=Object.assign({ref:Z},re),r){e.next=72;break}return e.abrupt("return",E);case 72:return e.abrupt("return",E);case 73:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Kt=function(e,t){return $e(e.inner)?e.inner.reduce((function(e,r){var n=r.path,a=r.message,o=r.type;return Object.assign(Object.assign({},e),e[n]&&t?Object(We.a)({},n,Yt(n,t,e,o,a)):Object(We.a)({},n,e[n]||Object.assign({message:a,type:o},t?{types:Object(We.a)({},o,a||!0)}:{})))}),{}):Object(We.a)({},e.path,{message:e.message,type:e.type})};function $t(e,t,r,n,a){return Jt.apply(this,arguments)}function Jt(){return(Jt=qe(m.a.mark((function e(t,r,n,a,o){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return",a(n,o));case 2:return e.prev=2,e.next=5,t.validate(n,{abortEarly:!1,context:o});case 5:return e.t0=e.sent,e.t1={},e.abrupt("return",{values:e.t0,errors:e.t1});case 10:return e.prev=10,e.t2=e.catch(2),e.abrupt("return",{values:{},errors:bt(Kt(e.t2,r))});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}var Qt=function(e){return Ke(e)||!Je(e)},Zt=function(e,t){return function e(t,r){var n=function(r,n,a){var o=a?"".concat(t,".").concat(n):"".concat(t,"[").concat(n,"]");return Qt(r)?o:e(o,r)};return $e(r)?r.map((function(e,t){return n(e,t)})):Object.entries(r).map((function(e){var t=Ye(e,2),r=t[0],a=t[1];return n(a,r,!0)}))}(e,t).flat(1/0)},er=function(e,t,r,n){var a;return r.add(t),jt(e)?a=void 0:Xe(e[t])?(a=ht(bt(e),t),Xe(a)||Zt(t,a).forEach((function(e){return r.add(e)}))):(a=e[t],r.add(t)),Xe(a)?Qe(n)?ht(n,t):n:a},tr=function(e){var t=e.isOnChange,r=e.hasError,n=e.isBlurEvent,a=e.isOnSubmit,o=e.isReValidateOnSubmit,i=e.isOnBlur,c=e.isReValidateOnBlur,s=e.isSubmitted;return t&&n||a&&o||a&&!s||i&&!n&&!r||c&&!n&&r||o&&s},rr=function(e){return e.substring(0,e.indexOf("["))},nr=function(e,t){var r=bt(Bt(e));return t?ht(r,t,r):r};function ar(e,t){var r=!1;if(!$e(e)||!$e(t)||e.length!==t.length)return!0;for(var n=0;n<e.length&&!r;n++){var a=e[n],o=t[n];if(Xe(o)||Object.keys(a).length!==Object.keys(o).length){r=!0;break}for(var i in a)if(a[i]!==o[i]){r=!0;break}}return r}var or=function(e,t){return RegExp("^".concat(t,"[\\d+]").replace(/\[/g,"\\[").replace(/\]/g,"\\]")).test(e)},ir=function(e,t){return Object(ye.a)(e).reduce((function(e,r){return!!or(t,r)||e}),!1)},cr=function(e){return typeof FileList!==tt&&e instanceof FileList};var sr=function(e){return{isOnSubmit:!e||e===et.onSubmit,isOnBlur:e===et.onBlur,isOnChange:e===et.onChange}},ur=function(e){return Ot(e)||wt(e)};function lr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mode,r=void 0===t?et.onSubmit:t,n=e.reValidateMode,o=void 0===n?et.onChange:n,i=e.validationSchema,c=e.validationResolver,s=e.validationContext,u=e.defaultValues,l=void 0===u?{}:u,f=e.submitFocusError,d=void 0===f||f,p=e.validateCriteriaMode,g=Object(a.useRef)({}),v="all"===p,b=Object(a.useRef)({}),h=Object(a.useRef)({}),y=Object(a.useRef)({}),E=Object(a.useRef)(new Set),O=Object(a.useRef)(new Set),w=Object(a.useRef)(new Set),x=Object(a.useRef)(new Set),j=Object(a.useRef)(!0),S=Object(a.useRef)({}),C=Object(a.useRef)(l),I=Object(a.useRef)(!1),k=Object(a.useRef)(!1),A=Object(a.useRef)(!1),M=Object(a.useRef)(!1),T=Object(a.useRef)(0),R=Object(a.useRef)(!1),L=Object(a.useRef)(),P=Object(a.useRef)({}),N=Object(a.useRef)(s),_=Object(a.useRef)(new Set),D=Ye(Object(a.useState)(),2)[1],U=Object(a.useRef)(sr(r)).current,B=U.isOnBlur,z=U.isOnSubmit,F=U.isOnChange,G=typeof window===tt,V=!(!i&&!c),q=typeof document!==tt&&!G&&!Xe(window.HTMLElement),W=q&&"Proxy"in window,H=Object(a.useRef)({dirty:!W,dirtyFields:!W,isSubmitted:z,submitCount:!W,touched:!W,isSubmitting:!W,isValid:!W}),Y=Object(a.useRef)(sr(o)).current,X=Y.isOnBlur,K=Y.isOnSubmit;N.current=s;var $=Object(a.useCallback)((function(){I.current||D({})}),[]),J=Object(a.useCallback)((function(e,t,r,n){var a=r||function(e){var t=e.errors,r=e.name,n=e.error,a=e.validFields,o=e.fieldsWithValidation,i=jt(n),c=jt(t),s=ht(n,r),u=ht(t,r);return!(i&&a.has(r)||u&&u.isManual)&&(!!(c!==i||!c&&!u||i&&o.has(r)&&!a.has(r))||s&&!zt(u,s))}({errors:b.current,error:t,name:e,validFields:x.current,fieldsWithValidation:w.current});if(jt(t)?((w.current.has(e)||V)&&(x.current.add(e),a=a||ht(b.current,e)),b.current=It(b.current,[e])):(x.current.delete(e),a=a||!ht(b.current,e),vt(b.current,e,t[e])),a&&!n)return $(),!0}),[$,V]),Q=Object(a.useCallback)((function(e,t){var r=e.ref,n=e.options,a=r.type,o=q&&Ze(r)&&Ke(t)?"":t;return Ot(r)&&n?n.forEach((function(e){var t=e.ref;return t.checked=t.value===o})):Tt(r)?cr(o)?r.files=o:r.value=o:Rt(r)?Object(ye.a)(r.options).forEach((function(e){return e.selected=o.includes(e.value)})):wt(r)&&n?n.length>1?n.forEach((function(e){var t=e.ref;return t.checked=o.includes(t.value)})):n[0].ref.checked=!!o:r.value=o,!!a}),[q]),Z=function(e){if(!g.current[e]||!H.current.dirty&&!H.current.dirtyFields)return!1;var t=ir(_.current,e),r=O.current.size,n=S.current[e]!==Dt(g.current,g.current[e].ref);if(t){var a=rr(e);n=ar(nr(g.current,a),ht(C.current,a))}var o=(t?M.current:O.current.has(e))!==n;return n?O.current.add(e):O.current.delete(e),M.current=t?n:!!O.current.size,H.current.dirty?o:r!==O.current.size},ee=Object(a.useCallback)((function(e){if(Z(e)||!ht(h.current,e)&&H.current.touched)return!!vt(h.current,e,!0)}),[]),te=Object(a.useCallback)((function(e,t,r){var n=$e(t);for(var a in t){var o="".concat(r||e).concat(n?"[".concat(a,"]"):".".concat(a));Qe(t[a])&&te(e,t[a],o);var i=g.current[o];i&&(Q(i,t[a]),ee(o))}}),[Q,ee]),re=Object(a.useCallback)((function(e,t){var r=g.current[e];if(r){Q(r,t);var n=ee(e);if(qt(n))return n}else Qt(t)||te(e,t)}),[ee,Q,te]),ne=Object(a.useCallback)(function(){var e=qe(m.a.mark((function e(t,r){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=g.current[t]){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Xt(g,v,n);case 5:return a=e.sent,J(t,a,!1,r),e.abrupt("return",jt(a));case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[J,v]),ae=Object(a.useCallback)(function(){var e=qe(m.a.mark((function e(t){var r,n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$t(i,v,nr(g.current),c,N.current);case 2:return r=e.sent,n=r.errors,a=j.current,j.current=jt(n),$e(t)?(t.forEach((function(e){var t=ht(n,e);t?vt(b.current,e,t):It(b.current,[e])})),$()):J(t,ht(n,t)?Object(We.a)({},t,ht(n,t)):{},a!==j.current),e.abrupt("return",jt(b.current));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[$,J,v,c,i]),oe=Object(a.useCallback)(function(){var e=qe(m.a.mark((function e(t){var r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t||Object.keys(g.current),!V){e.next=3;break}return e.abrupt("return",ae(r));case 3:if(!$e(r)){e.next=9;break}return e.next=6,Promise.all(r.map(function(){var e=qe(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(t,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return n=e.sent,$(),e.abrupt("return",n.every(Boolean));case 9:return e.next=11,ne(r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[ae,ne,$,V]),ie=function(e){return k.current||E.current.has(e)||E.current.has((e.match(/\w+/)||[])[0])};L.current=L.current?L.current:function(){var e=qe(m.a.mark((function e(t){var r,n,a,o,s,u,l,f,d,p,y,E,O,w,x;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.type,n=t.target,a=n?n.name:"",o=g.current,s=b.current,u=o[a],l=ht(s,a),u){e.next=8;break}return e.abrupt("return");case 8:if(d=r===rt.BLUR,p=tr({hasError:!!l,isOnChange:F,isBlurEvent:d,isOnSubmit:z,isReValidateOnSubmit:K,isOnBlur:B,isReValidateOnBlur:X,isSubmitted:A.current}),y=Z(a),E=ie(a)||y,d&&!ht(h.current,a)&&H.current.touched&&(vt(h.current,a,!0),E=!0),!p){e.next=15;break}return e.abrupt("return",E&&$());case 15:if(!V){e.next=26;break}return e.next=18,$t(i,v,nr(o),c,N.current);case 18:O=e.sent,w=O.errors,x=j.current,j.current=jt(w),f=ht(w,a)?Object(We.a)({},a,ht(w,a)):{},x!==j.current&&(E=!0),e.next=29;break;case 26:return e.next=28,Xt(g,v,u);case 28:f=e.sent;case 29:!J(a,f)&&E&&$();case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var ce=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=jt(C.current)?Bt(g.current):C.current;$t(i,v,bt(Object.assign(Object.assign({},t),e)),c,N.current).then((function(e){var t=e.errors,r=j.current;j.current=jt(t),r!==j.current&&$()}))}),[$,v,c]),se=Object(a.useCallback)((function(e,t){!Xe(L.current)&&e&&function(e,t,r,n){var a=r.ref,o=r.ref,i=o.name,c=o.type,s=r.mutationWatcher;if(c){var u=e[i];if((Ot(a)||wt(a))&&u){var l=u.options;$e(l)&&l.length?(l.filter(Boolean).forEach((function(e,r){var a=e.ref,o=e.mutationWatcher;(a&&xt(a)||n)&&(Et(a,t),o&&o.disconnect(),It(l,["[".concat(r,"]")]))})),l&&!l.filter(Boolean).length&&delete e[i]):delete e[i]}else(xt(a)||n)&&(Et(a,t),s&&s.disconnect(),delete e[i])}else delete e[i]}(g.current,L.current,e,t)}),[]),ue=Object(a.useCallback)((function(e,t){if(e&&(!e||!ir(_.current,e.ref.name)||t)){se(e,t);var r=e.ref.name;b.current=It(b.current,[r]),h.current=It(h.current,[r]),S.current=It(S.current,[r]),[O,w,x,E].forEach((function(e){return e.current.delete(r)})),(H.current.isValid||H.current.touched)&&($(),V&&ce())}}),[$,V,ce,se]);var le=function(e){var t=e.name,r=e.type,n=e.types,a=e.message,o=e.preventRender,i=g.current[t];zt(b.current[t],{type:r,message:a,types:n})||(vt(b.current,t,{type:r,types:n,message:a,ref:i?i.ref:{},isManual:!0}),o||$())};function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.name)return console.warn("Missing name @",e);var r,n=e.name,a=e.type,o=e.value,i=Object.assign({ref:e},t),c=g.current,s=ur(e),u=c[n],l=!0,f=!1;if(s?u&&$e(u.options)&&u.options.filter(Boolean).find((function(e){var t=e.ref;return o===t.value})):u)c[n]=Object.assign(Object.assign({},u),t);else{if(a){var d=(m=e,p=function(){return ue(i)},(b=new MutationObserver((function(){xt(m)&&(b.disconnect(),p())}))).observe(window.document,{childList:!0,subtree:!0}),b);u=s?Object.assign({options:[].concat(Object(ye.a)(u&&u.options||[]),[{ref:e,mutationWatcher:d}]),ref:{type:a,name:n}},t):Object.assign(Object.assign({},i),{mutationWatcher:d})}else u=i;var m,p,b;if(c[n]=u,jt(C.current)||(r=ht(C.current,n),l=Xe(r),f=ir(_.current,n),l||f||Q(u,r)),V&&!f&&H.current.isValid?ce():jt(t)||(w.current.add(n),!z&&H.current.isValid&&Xt(g,v,u).then((function(e){var t=j.current;jt(e)?x.current.add(n):j.current=!1,t!==j.current&&$()}))),S.current[n]||f&&l||(S.current[n]=l?Dt(c,u.ref):r),a)!function(e){var t=e.field.ref,r=e.handleChange,n=e.isRadioOrCheckbox;Ze(t)&&r&&(t.addEventListener(n?rt.CHANGE:rt.INPUT,r),t.addEventListener(rt.BLUR,r))}({field:s&&u.options?u.options[u.options.length-1]:u,isRadioOrCheckbox:s,handleChange:L.current})}}var de=Object(a.useCallback)((function(e){return function(){var t=qe(m.a.mark((function t(r){var n,a,o,s,u,l,f,p,h,y,E,O;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&(r.preventDefault(),r.persist()),n={},a={},o=g.current,H.current.isSubmitting&&(R.current=!0,$()),t.prev=5,!V){t.next=18;break}return a=Bt(o),t.next=10,$t(i,v,bt(a),c,N.current);case 10:s=t.sent,u=s.errors,l=s.values,b.current=u,n=u,a=l,t.next=30;break;case 18:f=0,p=Object.values(o);case 19:if(!(f<p.length)){t.next=30;break}if(!(h=p[f])){t.next=27;break}return y=h.ref,E=h.ref.name,t.next=25,Xt(g,v,h);case 25:(O=t.sent)[E]?(vt(n,E,O[E]),x.current.delete(E)):(w.current.has(E)&&x.current.add(E),a[E]=Dt(o,y));case 27:f++,t.next=19;break;case 30:if(!jt(n)){t.next=36;break}return b.current={},t.next=34,e(bt(a),r);case 34:t.next=38;break;case 36:d&&q&&yt(o,n),b.current=n;case 38:return t.prev=38,A.current=!0,R.current=!1,T.current=T.current+1,$(),t.finish(38);case 44:case"end":return t.stop()}}),t,null,[[5,,38,44]])})));return function(e){return t.apply(this,arguments)}}()}),[q,$,V,d,v,c,i]),me=function(e){var t=e.errors,r=e.dirty,n=e.isSubmitted,a=e.touched,o=e.isValid,i=e.submitCount;g.current={},t||(b.current={}),a||(h.current={}),o||(x.current=new Set,w.current=new Set,j.current=!0),r||(O.current=new Set,M.current=!1),n||(A.current=!1),i||(T.current=0),S.current={},y.current={},E.current=new Set,k.current=!1};Object(a.useEffect)((function(){return function(){I.current=!0,g.current&&Object.values(g.current).forEach((function(e){return ue(e,!0)}))}}),[ue]),V||(j.current=x.current.size>=w.current.size&&jt(b.current));var pe={dirty:M.current,dirtyFields:O.current,isSubmitted:A.current,submitCount:T.current,touched:h.current,isSubmitting:R.current,isValid:z?A.current&&jt(b.current):j.current},ge={triggerValidation:oe,setValue:Object(a.useCallback)((function(e,t,r){var n=!1,a=$e(e);(a?e:[e]).forEach((function(e){var r=Ut(e);n=!(!re(r?e:Object.keys(e)[0],r?t:Object.values(e)[0])&&!a)||ie(e)})),(n||a)&&$(),(r||a&&t)&&oe(a?void 0:e)}),[$,re,oe]),register:Object(a.useCallback)((function(e,t){if(!G)if(Ut(e))fe({name:e},t);else{if(!(Qe(e)&&"name"in e))return function(t){return t&&fe(t,e)};fe(e,t)}}),[C.current,S.current]),unregister:Object(a.useCallback)((function(e){jt(g.current)||($e(e)?e:[e]).forEach((function(e){return ue(g.current[e],!0)}))}),[]),getValues:Object(a.useCallback)((function(e){var t=Bt(g.current),r=jt(t)?C.current:t;return e&&e.nest?bt(r):r}),[]),formState:W?new Proxy(pe,{get:function(e,t){return t in e?(H.current[t]=!0,e[t]):{}}}):pe},ve=Object.assign(Object.assign(Object.assign({removeFieldEventListener:se,reRender:$},V?{validateSchemaIsValid:ce}:{}),{mode:{isOnBlur:B,isOnSubmit:z,isOnChange:F},reValidateMode:{isReValidateOnBlur:X,isReValidateOnSubmit:K},errorsRef:b,touchedFieldsRef:h,fieldsRef:g,isWatchAllRef:k,watchFieldsRef:E,resetFieldArrayFunctionRef:P,fieldArrayDefaultValues:y,validFieldsRef:x,dirtyFieldsRef:O,fieldsWithValidationRef:w,fieldArrayNamesRef:_,isDirtyRef:M,readFormStateRef:H,defaultValuesRef:C}),ge);return Object.assign({watch:function(e,t){var r=Xe(t)?Xe(C.current)?{}:C.current:t,n=Bt(g.current,e),a=E.current;if(jt(r)||(H.current.dirty=!0),Ut(e))return er(n,e,a,r);if($e(e))return e.reduce((function(e,t){return Object.assign(Object.assign({},e),Object(We.a)({},t,er(n,t,a,r)))}),{});k.current=!0;var o=!jt(n)&&n||r;return e&&e.nest?bt(o):o},control:ve,handleSubmit:de,reset:Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(q)for(var r=0,n=Object.values(g.current);r<n.length;r++){var a=n[r];if(a){var o=a.ref,i=a.options,c=ur(o)&&$e(i)?i[0].ref:o;if(Ze(c))try{c.closest("form").reset();break}catch(s){}}}e&&(C.current=e),Object.values(P.current).forEach((function(e){return Vt(e)&&e()})),me(t),$()}),[]),clearError:Object(a.useCallback)((function(e){Xe(e)?b.current={}:It(b.current,$e(e)?e:[e]),$()}),[]),setError:Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;Ut(e)?le(Object.assign({name:e},Qe(t)?{types:t,type:""}:{type:t,message:r})):$e(e)&&(e.forEach((function(e){return le(Object.assign(Object.assign({},e),{preventRender:!0}))})),$())}),[]),errors:b.current},ge)}Object(a.createContext)(null);function fr(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function dr(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){fr(o,n,a,i,c,"next",e)}function c(e){fr(o,n,a,i,c,"throw",e)}i(void 0)}))}}var mr=function(e){var t=e.onSignup,r=e.switchTab,n=s(),i=lr(),c=i.handleSubmit,l=i.register,f=i.watch,d=i.setError,p=i.errors,g=i.formState,b=f("password"),h=Object(a.useCallback)(function(){var e=dr(m.a.mark((function e(r){var a,o,i,c,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.email,o=r.username,i=r.password,e.prev=1,e.next=4,v.auth().createUserWithEmailAndPassword(a,i);case 4:return c=e.sent,s=c.user,u={username:o,signupDate:Date.now()},e.next=9,v.firestore().collection("users").doc(s.uid).set(u);case 9:t(Object.assign({uid:s.uid},u,{firebaseUser:s})),e.next=24;break;case 12:e.prev=12,e.t0=e.catch(1),e.t1=e.t0.code,e.next="auth/weak-password"===e.t1?17:"auth/email-already-in-use"===e.t1?19:"auth/invalid-email"===e.t1?21:23;break;case 17:return d("password","weakPassword",n.formatMessage({id:"Password is too weak"})),e.abrupt("break",24);case 19:return d("email","alreadyExists",n.formatMessage({id:"Email address already in use"})),e.abrupt("break",24);case 21:return d("email","invalid",n.formatMessage({id:"Invalid email address"})),e.abrupt("break",24);case 23:return e.abrupt("return");case 24:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),[t,d,n]);return o.a.createElement(u,{as:"form",name:"signup",autoComplete:"off",onSubmit:c(h),css:{gap:4}},o.a.createElement(u,{css:{gap:3}},o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Username"})),o.a.createElement(Le,{name:"username",ref:l({required:n.formatMessage({id:"Username is required"})})}),p.username&&o.a.createElement(fe,null,p.username.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Email address"})),o.a.createElement(Le,{type:"email",name:"email",ref:l({required:n.formatMessage({id:"Email address is required"})})}),p.email&&o.a.createElement(fe,null,p.email.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Password"})),o.a.createElement(Le,{autoComplete:"new-password",type:"password",name:"password",ref:l({required:n.formatMessage({id:"Password is required"})})}),p.password&&o.a.createElement(fe,null,p.password.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Confirm password"})),o.a.createElement(Le,{autoComplete:"off",type:"password",name:"passwordConfirm",ref:l({required:"Password is required",validate:function(e){return e===b||n.formatMessage({id:"Passwords must match"})}})}),p.passwordConfirm&&o.a.createElement(fe,null,p.passwordConfirm.message))),o.a.createElement(u,{css:{gap:3}},o.a.createElement(ie,{disabled:g.isSubmitting,type:"submit"},n.formatMessage({id:"Sign me up!"})),o.a.createElement(u,{css:{alignItems:"center"}},o.a.createElement(ve,{onClick:r},n.formatMessage({id:"I already have an account"})))))},pr=function(e){var t=e.onSignin,r=e.switchTab,n=s(),i=lr(),c=i.handleSubmit,l=i.register,f=i.setError,d=i.errors,p=i.formState,g=Object(a.useCallback)(function(){var e=dr(m.a.mark((function e(r){var a,o,i,c,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.email,o=r.password,e.prev=1,e.next=4,v.auth().signInWithEmailAndPassword(a,o);case 4:return i=e.sent,c=i.user,e.next=8,v.firestore().collection("users").doc(c.uid).get();case 8:s=e.sent,u=s.data(),t(Object.assign({uid:c.uid},u,{firebaseUser:c})),e.next=23;break;case 13:e.prev=13,e.t0=e.catch(1),e.t1=e.t0.code,e.next="auth/invalid-email"===e.t1?18:"auth/user-not-found"===e.t1?18:"auth/user-disabled"===e.t1?18:"auth/wrong-password"===e.t1?20:22;break;case 18:return f("email","invalid",n.formatMessage({id:"Unknown email address"})),e.abrupt("break",23);case 20:return f("password","mismatch",n.formatMessage({id:"Incorrect password"})),e.abrupt("break",23);case 22:return e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),[t,f,n]);return o.a.createElement(u,{as:"form",name:"signin",onSubmit:c(g),css:{gap:4}},o.a.createElement(u,{css:{gap:3}},o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Email address"})),o.a.createElement(Le,{type:"email",name:"email",ref:l({required:n.formatMessage({id:"Email address is required"})})}),d.email&&o.a.createElement(fe,null,d.email.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Password"})),o.a.createElement(Le,{type:"password",name:"password",ref:l({required:n.formatMessage({id:"Password is required"})})}),d.password&&o.a.createElement(fe,null,d.password.message))),o.a.createElement(u,{css:{gap:3}},o.a.createElement(ie,{type:"submit",disabled:p.isSubmitting},n.formatMessage({id:"Sign me in!"})),o.a.createElement(u,{css:{alignItems:"center"}},o.a.createElement(ve,{onClick:r},n.formatMessage({id:"I don't have an account"})))))},gr=function(e){var t=e.deferred,r=s(),n=Object(a.useContext)(y),i=Object(a.useState)("signup"),c=i[0],u=i[1],l=function(e){t.resolve(e),n(r.formatMessage({id:"Logged in as {username}"},{username:e.username}))};return o.a.createElement(ue,{title:"signup"===c?o.a.createElement(me,null,r.formatMessage({id:"Create your account"})):o.a.createElement(me,null,r.formatMessage({id:"Connect to your account"})),onClose:function(){return t.reject(f.DIALOG_CLOSED_REASON)}},"signup"===c?o.a.createElement(mr,{onSignup:l,switchTab:function(){return u("signin")}}):o.a.createElement(pr,{onSignin:l,switchTab:function(){return u("signup")}}))},vr=r("3TQf");function br(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return hr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hr(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yr(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function Er(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){yr(o,n,a,i,c,"next",e)}function c(e){yr(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Or=function(e){var t=e.currentUser,r=e.onClose,n=s(),i=Object(a.useContext)(S).updateEmail,c=Object(a.useContext)(y),l=lr(),f=l.handleSubmit,d=l.register,p=l.setError,g=l.errors,v=l.formState,b=Object(a.useCallback)(function(){var e=Er(m.a.mark((function e(a){var o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.password,s=a.newEmail,e.prev=1,e.next=4,i(t,o,s);case 4:c(n.formatMessage({id:"Email address updated successfuly"})),r(),e.next=21;break;case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0.code,e.next="auth/email-already-in-use"===e.t1?13:"auth/invalid-email"===e.t1?15:"auth/wrong-password"===e.t1?17:19;break;case 13:return p("newEmail","alreadyExists",n.formatMessage({id:"Email address already in use"})),e.abrupt("break",21);case 15:return p("newEmail","invalid",n.formatMessage({id:"Invalid email address"})),e.abrupt("break",21);case 17:return p("password","mismatch",n.formatMessage({id:"Incorrect password"})),e.abrupt("break",21);case 19:throw c(n.formatMessage({id:"An error occured, please retry later"})),e.t0;case 21:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[t,i,p,r,c,n]);return o.a.createElement(u,{as:"form",onSubmit:f(b),css:{flex:"1",gap:4}},o.a.createElement(u,{css:{gap:3,overflow:"auto",flex:"1"}},o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Password"})),o.a.createElement(Le,{type:"password",name:"password",ref:d({required:n.formatMessage({id:"Password is required"})})}),g.password&&o.a.createElement(fe,null,g.password.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"New email address"})),o.a.createElement(Le,{type:"email",name:"newEmail",ref:d({required:n.formatMessage({id:"Email address is required"})})}),g.newEmail&&o.a.createElement(fe,null,g.newEmail.message))),o.a.createElement(u,{css:{gap:3}},o.a.createElement(ie,{disabled:v.isSubmitting,type:"submit"},n.formatMessage({id:"Change email address"})),o.a.createElement(u,{css:{alignItems:"center"}},o.a.createElement(ve,{onClick:r},n.formatMessage({id:"Back"})))))},wr=function(e){var t=e.currentUser,r=e.onClose,n=s(),i=Object(a.useContext)(S).updateUsername,c=Object(a.useContext)(y),l=lr(),f=l.handleSubmit,d=l.register,p=l.errors,g=l.formState,v=Object(a.useCallback)(function(){var e=Er(m.a.mark((function e(a){var o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.newUsername,e.prev=1,e.next=4,i(t,o);case 4:c(n.formatMessage({id:"Username updated successfuly"})),r(),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),c(n.formatMessage({id:"An error occured, please retry later"})),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[t,i,r,c,n]);return o.a.createElement(u,{as:"form",onSubmit:f(v),css:{flex:"1",gap:4}},o.a.createElement(u,{css:{gap:3,overflow:"auto",flex:"1"}},o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"New username"})),o.a.createElement(Le,{type:"text",name:"newUsername",ref:d({required:n.formatMessage({id:"Username is required"})})}),p.newUsername&&o.a.createElement(fe,null,p.newUsername.message))),o.a.createElement(u,{css:{gap:3}},o.a.createElement(ie,{disabled:g.isSubmitting,type:"submit"},n.formatMessage({id:"Change username"})),o.a.createElement(u,{css:{alignItems:"center"}},o.a.createElement(ve,{onClick:r},n.formatMessage({id:"Back"})))))},xr=function(e){var t=e.currentUser,r=e.onClose,n=s(),i=Object(a.useContext)(S).updateUsername,c=Object(a.useContext)(y),l=lr(),f=l.handleSubmit,d=l.register,p=l.watch,g=l.setError,v=l.errors,b=l.formState,h=p("newPassword"),E=Object(a.useCallback)(function(){var e=Er(m.a.mark((function e(a){var o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.password,s=a.newPassword,e.prev=1,e.next=4,i(t,o,s);case 4:c(n.formatMessage({id:"Password changed successfuly"})),r(),e.next=19;break;case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0.code,e.next="auth/weak-password"===e.t1?13:"auth/wrong-password"===e.t1?15:17;break;case 13:return g("newPassword","weakPassword",n.formatMessage({id:"Password is too weak"})),e.abrupt("break",19);case 15:return g("password","mismatch",n.formatMessage({id:"Incorrect password"})),e.abrupt("break",19);case 17:return c(n.formatMessage({id:"An error occured, please retry later"})),e.abrupt("return");case 19:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[t,i,r,g,c,n]);return o.a.createElement(u,{as:"form",onSubmit:f(E),css:{flex:"1",gap:4}},o.a.createElement(u,{css:{gap:3,overflow:"auto",flex:"1"}},o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Current password"})),o.a.createElement(Le,{type:"password",name:"password",ref:d({required:n.formatMessage({id:"Password is required"})})}),v.password&&o.a.createElement(fe,null,v.password.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"New password"})),o.a.createElement(Le,{type:"password",name:"newPassword",autoComplete:"new-password",ref:d({required:n.formatMessage({id:"Password is required"})})}),v.newPassword&&o.a.createElement(fe,null,v.newPassword.message)),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Confirm new password"})),o.a.createElement(Le,{type:"password",name:"newPasswordConfirm",ref:d({required:"Password is required",validate:function(e){return e===h||n.formatMessage({id:"Passwords must match"})}})}),v.newPasswordConfirm&&o.a.createElement(fe,null,v.newPasswordConfirm.message))),o.a.createElement(u,{css:{gap:3}},o.a.createElement(ie,{disabled:b.isSubmitting,type:"submit"},n.formatMessage({id:"Change password"})),o.a.createElement(u,{css:{alignItems:"center"}},o.a.createElement(ve,{onClick:r},n.formatMessage({id:"Back"})))))},jr=function(e){var t=e.uid,r=e.deferred,n=s(),i=Object(a.useContext)(y),c=Object(a.useContext)(vr.LanguageContext).language,l=Object(a.useContext)(S),d=l.currentUser,p=l.usersMetadata[t],g=p.username,b=p.signupDate,h=Object(a.useState)(!1),E=h[0],O=h[1],w=Object(a.useState)(!1),x=w[0],j=w[1],C=Object(a.useState)(!1),I=C[0],k=C[1],A=Object(a.useContext)(R).approvedTangrams,M=Object(a.useContext)(B),T=M.tangramsStarredBy,L=M.tangramsCompletedBy,P=Object(a.useMemo)((function(){for(var e,r=0,n=0,a=0,o=br(A);!(e=o()).done;){var i=e.value;if(i.uid===t)for(var c in n++,T[i.id])c!==t&&T[i.id][c]&&(r+=1);for(var s in L[i.id])s===t&&(a+=1)}return{stars:r,completed:a,created:n}}),[A,L,T,t]),N=P.stars,_=P.completed,D=P.created,U=function(){var e=Er(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm(n.formatMessage({id:"Are you sure you want to log out?"}))){e.next=5;break}return e.next=3,v.auth().signOut();case 3:r.reject(f.DIALOG_CLOSED_REASON),i(n.formatMessage({id:"Logged out"}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(ue,{onClose:function(){return r.reject(f.DIALOG_CLOSED_REASON)},css:{overflow:"auto",pt:4,mt:-4,gap:3}},E?o.a.createElement(Or,{currentUser:d,onClose:function(){return O(!1)}}):x?o.a.createElement(wr,{currentUser:d,onClose:function(){return j(!1)}}):I?o.a.createElement(xr,{currentUser:d,onClose:function(){return k(!1)}}):o.a.createElement(u,{css:{gap:4,mt:-4}},o.a.createElement(u,{css:{gap:3,alignItems:"center"}},o.a.createElement(ce,{uid:t,size:"badgeBig"}),o.a.createElement(me,null,g),o.a.createElement(u,{css:{gap:2,fontSize:2,alignItems:"center"}},d&&t===d.uid&&o.a.createElement(le,null,d.firebaseUser.email),o.a.createElement(le,null,n.formatMessage({id:"Joined {signupDate}"},{signupDate:new Intl.DateTimeFormat(c).format(b)})),o.a.createElement(le,null,n.formatMessage({id:"Completed {completed}/{total} tangrams"},{completed:_,total:A.length})),o.a.createElement(le,null,n.formatMessage({id:"Created {created} tangrams"},{created:D})),o.a.createElement(le,null,o.a.createElement(Re,{id:"Earned {stars}",values:{stars:N,starIcon:function(){return o.a.createElement(be,{icon:F.j,css:{fill:"currentColor"}})}}})))),d&&d.uid===t&&o.a.createElement(o.a.Fragment,null,o.a.createElement(u,{css:{gap:3,alignItems:"center"}},o.a.createElement(ve,{onClick:function(){return O(!0)}},n.formatMessage({id:"Change email address"})),o.a.createElement(ve,{onClick:function(){return j(!0)}},n.formatMessage({id:"Change username"})),o.a.createElement(ve,{onClick:function(){return k(!0)}},n.formatMessage({id:"Change password"}))),o.a.createElement(oe,{onClick:U},n.formatMessage({id:"Log out"})))))},Sr=["üí™","üî•","üò±","üòé","üéâ","ü•á","üöÄ","üëå","üëç","üòµ"],Cr=function(){return Sr[Math.floor(Math.random()*Sr.length)]},Ir=r("BbdF"),kr=r.n(Ir);function Ar(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function Mr(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ar(o,n,a,i,c,"next",e)}function c(e){Ar(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Tr=function(e){var t=e.tangram,r=e.deferred,n=Object(a.useContext)(B).tangramsStarredBy,i=Object(a.useMemo)((function(){var e=0;for(var r in n[t.id])n[t.id][r]&&(e+=1);return e}),[t,n]);return o.a.createElement(ue,{onClose:function(){return r.reject(f.DIALOG_CLOSED_REASON)},css:{gap:3}},o.a.createElement(u,{css:{gap:3,overflow:"auto",flex:"1",alignItems:"center"}},o.a.createElement(se,{selected:!0,tangram:t}),o.a.createElement(le,{css:{fontSize:2}},o.a.createElement(Re,{id:"Earned {stars}",values:{stars:i,starIcon:function(){return o.a.createElement(be,{icon:F.j,css:{fill:"currentColor"}})}}}))))},Rr=function(e){var t=e.tangram,r=e.deferred,n=s(),i=Object(a.useContext)(y),c=Object(a.useContext)(S).currentUser,l=Object(a.useState)((function(){return Object.assign({},t)})),d=l[0],p=l[1],g=Object(a.useContext)(B).tangramsStarredBy,b=c&&!t.id,h=lr({defaultValues:Object(a.useMemo)((function(){return{path:t.path,category:t.category,emoji:"digits"!==t.category&&"letters"!==t.category?t.emoji:Cr(),letterIndex:"letters"===t.category?f.LETTERS.indexOf(t.emoji):void 0,digitIndex:"digits"===t.category?f.DIGITS.indexOf(t.emoji):void 0}}),[t])}),E=h.handleSubmit,O=h.register,w=h.watch,x=h.errors,j=h.setError,C=h.clearError,I=w(),k=I.path,A=I.category,M=I.emoji,T=I.letterIndex,R=I.digitIndex;Object(a.useEffect)((function(){try{var e=function(e){var t=kr.a.project.importSVG('<path d="'+e+'" />',{applyMatrix:!0,insert:!1}),r={path:t.exportSVG().getAttribute("d"),edges:t.curves.length,height:Math.round(t.bounds.height),width:Math.round(t.bounds.width),length:Math.round(t.length)};if(t.remove(),r.edges<3||r.edges>23)throw new Error("Invalid path");return r}(k);p((function(t){return Object.assign({},t,{},e)})),C("path")}catch(t){j("path","invalid",n.formatMessage({id:"Invalid path"}))}}),[k,j,C,n]),Object(a.useEffect)((function(){var e="letters"===A?f.LETTERS[T]:"digits"===A?f.DIGITS[R]:M||Cr();p((function(t){return Object.assign({},t,{emoji:e})}))}),[A,M,T,R]),Object(a.useEffect)((function(){p((function(e){return Object.assign({},e,{category:A})}))}),[A]);var L=function(){var e=Mr(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm(n.formatMessage({id:"Are you sure you want to delete this tangram?"}))){e.next=5;break}return e.next=3,v.firestore().collection("tangrams").doc(t.id).delete();case 3:i(n.formatMessage({id:"Tangram deleted successfuly"})),r.resolve();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Mr(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=6;break}return e.next=3,v.firestore().collection("tangrams").add(Object.assign({},d,{uid:c.uid,approved:!1}));case 3:i(n.formatMessage({id:"Tangram submitted for review"})),e.next=9;break;case 6:return e.next=8,v.firestore().collection("tangrams").doc(t.id).update(d);case 8:i(n.formatMessage({id:"Tangram modified successfuly"}));case 9:r.resolve();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=Object(a.useMemo)((function(){if(!t.approved)return 0;var e=0;for(var r in g[t.id])g[t.id][r]&&(e+=1);return e}),[t,g]);return o.a.createElement(ue,{title:o.a.createElement(me,null,b?n.formatMessage({id:"Submit your tangram"}):n.formatMessage({id:"Edit your tangram"})),onClose:function(){return r.reject(f.DIALOG_CLOSED_REASON)},as:"form",onSubmit:E(P),css:{gap:3}},o.a.createElement(u,{css:{gap:3,overflow:"auto",flex:"1"}},o.a.createElement(se,{showStroke:c.isAdmin,selected:!0,completed:!0,tangram:d,css:{alignSelf:"center"}}),t.approved&&o.a.createElement(le,{css:{alignSelf:"center",fontSize:2}},o.a.createElement(Re,{id:"Earned {stars}",values:{stars:N,starIcon:function(){return o.a.createElement(be,{icon:F.j,css:{fill:"currentColor"}})}}})),b&&!c.isAdmin&&o.a.createElement(de,null,o.a.createElement(Re,{id:"A moderator will have to approve your tangram. It can be deleted or edited at any time.",values:{br:function(){return o.a.createElement("br",null)}}})),c&&c.isAdmin&&o.a.createElement(o.a.Fragment,null,o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Path"})),o.a.createElement(Le,{as:"textarea",name:"path",ref:O}),x.path&&o.a.createElement(fe,null,x.path.message))),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Category"})),o.a.createElement(Le,{as:"select",name:"category",ref:O},f.CATEGORIES.map((function(e){return o.a.createElement("option",{key:e,value:e},n.formatMessage({id:e}))})))),"digits"===A?o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Victory emoji"})),o.a.createElement(Le,{as:"select",name:"digitIndex",ref:O},f.DIGITS.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e)})))):"letters"===A?o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Victory emoji"})),o.a.createElement(Le,{as:"select",name:"letterIndex",ref:O},f.LETTERS.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e)})))):o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,n.formatMessage({id:"Victory emoji"})),o.a.createElement(Le,{name:"emoji",ref:O}),o.a.createElement(de,null,n.formatMessage({id:"Leave empty for random emoji"})))),o.a.createElement(ie,{type:"submit"},b?n.formatMessage({id:"Submit!"}):n.formatMessage({id:"Edit!"})),!b&&o.a.createElement(u,{css:{alignItems:"center"}},o.a.createElement(ve,{onClick:L},n.formatMessage({id:"Or delete tangram"}))))},Lr=function(e){var t=e.tangram,r=e.deferred,n=Object(a.useContext)(S).currentUser;return n&&(n.isAdmin||!t.id||t.uid===n.uid)?o.a.createElement(Rr,{tangram:t,deferred:r}):o.a.createElement(Tr,{tangram:t,deferred:r})},Pr=function(){var e=this;this.promise=new Promise((function(t,r){e.resolve=t,e.reject=r}))},Nr=r("expU"),_r=Object(a.createContext)([!0,function(){}]),Dr=function(){return Object(a.useContext)(_r)},Ur=function(e){var t=e.children,r=Object(a.useState)(!0),n=r[0],i=r[1];Object(a.useEffect)((function(){var e=window.localStorage.getItem("showBackgroundPattern");if(null!==e)try{var t=JSON.parse(e);i(!!JSON.parse(t))}catch(r){window.localStorage.removeItem("showBackgroundPattern")}else i(!0)}),[]);var c=Object(a.useCallback)((function(){var e=!n;i(e),window.localStorage.setItem("showBackgroundPattern",JSON.stringify(e))}),[n]),s=Object(a.useMemo)((function(){return[n,c]}),[n,c]);return o.a.createElement(_r.Provider,{value:s},t)};function Br(e){return function(e){if(Array.isArray(e))return Fr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||zr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zr(e,t){if(e){if("string"==typeof e)return Fr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fr(e,t):void 0}}function Fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gr=Object(a.createContext)(),Vr=function(e){var t=e.deferred,r=e.tip,n=r.id,i=r.title,c=void 0===i?o.a.createElement(me,null,o.a.createElement(Re,{id:"Random tip"})):i,l=r.content,d=s(),m=Object(a.useState)(!1),p=m[0],g=m[1];return o.a.createElement(ue,{onClose:function(){return t.reject(f.DIALOG_CLOSED_REASON)},title:c,css:{gap:3,maxWidth:"300px"}},l,o.a.createElement(ie,{onClick:function(){return t.resolve(p)}},d.formatMessage({id:"Got it!"})),"welcome"!==n&&o.a.createElement(u,{as:"label",css:{gap:1,flexDirection:"row",cursor:"pointer",alignItems:"flex-end"}},o.a.createElement("input",{type:"checkbox",checked:p,onChange:function(){return g(!p)}}),o.a.createElement(le,{as:"small"},d.formatMessage({id:"I don't want to see tips anymore"}))))},qr={settingsIcon:o.a.createElement(be,{icon:F.h}),accountIcon:o.a.createElement(be,{icon:F.l}),menuIcon:o.a.createElement(be,{icon:F.d}),galleryIcon:o.a.createElement(be,{icon:F.c}),shareIcon:o.a.createElement(be,{icon:F.i}),createIcon:o.a.createElement(be,{icon:F.g}),leaderboardIcon:o.a.createElement(be,{icon:F.a}),starIcon:o.a.createElement(be,{icon:F.j}),br:function(){return o.a.createElement("br",null)}},Wr=[{id:"menu",content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.menu",values:qr}))},{id:"gallery",content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.gallery",values:qr}))},{id:"difficulty",predicate:function(e){return e.showBackgroundPattern},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.difficulty",values:qr}))},{id:"theme",predicate:function(e){return"dark"!==e.themeKey},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.theme",values:qr}))},{id:"sound",predicate:function(e){return e.soundEnabled},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.sound",values:qr}))},{id:"account1",predicate:function(e){return!e.currentUser},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.account1",values:qr}))},{id:"account2",predicate:function(e){return!e.currentUser},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.account2",values:qr}))},{id:"stars",predicate:function(e){return e.currentUser},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.stars",values:qr}))},{id:"create",predicate:function(e){var t=e.currentUser,r=e.approvedTangrams,n=e.isTangramCompleted;if(t)for(var a,o=0,i=function(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=zr(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}(r);!(a=i()).done;){if(n(a.value.id)&&10===(o+=1))return!0}return!1},content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.create",values:qr}))},{id:"share",content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.share",values:qr}))},{id:"card",content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.card",values:qr}))},{id:"leaderboard",content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.leaderboard",values:qr}))}],Hr=function(e){var t=e.children,r=s(),n=Object(a.useContext)(y),i=Object(a.useState)(null),c=i[0],u=i[1],l=Object(a.useState)(!0),f=l[0],d=l[1],m=Object(a.useContext)(ee).soundEnabled,p=Object(Nr.useSwitchTheme)()[0],g=Dr()[0],v=Object(a.useContext)(S).currentUser,b=Object(a.useContext)(R).approvedTangrams,h=Object(a.useContext)(B).isTangramCompleted;Object(a.useEffect)((function(){d(null===window.localStorage.getItem("hideTips"))}),[]),Object(a.useEffect)((function(){f?window.localStorage.removeItem("hideTips"):window.localStorage.setItem("hideTips",!0)}),[f]);var E=function(){var e=[],t=localStorage.getItem("seenTips");if(t)try{var r=JSON.parse(t);if(!Array.isArray(r))throw new Error("Invalid data for seenTips : "+r);e=r}catch(n){localStorage.removeItem("seenTips")}return e},O=Object(a.useCallback)((function(e){var t=E(),r=new Pr;return u({deferred:r,tip:e}),r.promise.then((function(e){e&&d(!1)})).finally((function(){localStorage.setItem("seenTips",JSON.stringify([].concat(Br(t),[e.id]))),u(null)}))}),[]),w=Object(a.useCallback)((function(){f&&(E().includes("welcome")||v&&b.some((function(e){return h(e.id)}))||O({id:"welcome",title:o.a.createElement(me,null,o.a.createElement(Re,{id:"Welcome to Amstangram",values:qr})),content:o.a.createElement(le,{css:{textAlign:"justify"}},o.a.createElement(Re,{id:"tips.welcome",values:qr}))}))}),[O,f,v,b,h]),x=Object(a.useCallback)((function(){if(f){var e=E(),t=Wr.filter((function(t){var r=t.id,n=t.predicate,a=void 0===n?function(){return!0}:n;return!e.includes(r)&&a({themeKey:p,showBackgroundPattern:g,currentUser:v,approvedTangrams:b,isTangramCompleted:h,soundEnabled:m})}));if(t.length){var r=t[0];O(r)}}}),[O,b,h,p,v,g,m,f]),j=Object(a.useCallback)((function(){d((function(e){return!e}))}),[]),C=Object(a.useCallback)((function(){d(!0),window.localStorage.removeItem("seenTips"),n(r.formatMessage({id:"Tips reseted successfuly"}))}),[n,r]),I=Object(a.useMemo)((function(){return{showRandomTip:x,showWelcome:w,tipsEnabled:f,toggleTips:j,resetTips:C}}),[x,w,f,j,C]);return o.a.createElement(Gr.Provider,{value:I},t,c&&o.a.createElement(Vr,c))},Yr=function(e){var t=e.leftComponent,r=e.leftValue,i=e.rightComponent,c=e.rightValue,s=e.value,l=e.onChange,f=e.invertSounds,d=Object(a.useContext)(ee),m=d.playToggle,p=d.soundEnabled,g=Object(a.useContext)(n.ThemeContext),v=Object(a.useMemo)((function(){return s===c?"right":"left"}),[s,c]),b=function(){f?p||m({forceSoundEnabled:!0}):m()},h=function(e){e!==v&&(l("right"===e?c:r),b())};return o.a.createElement(u,{css:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:3}},o.a.createElement(u,{css:{cursor:"pointer",flex:"1",alignItems:"flex-end"},onClick:function(){return h("left")}},t),o.a.createElement(u,{onClick:function(){l("right"===("left"===v?"right":"left")?c:r),b()},css:{cursor:"pointer",position:"relative",bg:"inputBackground",width:"40px",height:"20px",borderRadius:"99999px"}},o.a.createElement(u,{css:{position:"absolute",size:"20px",borderRadius:"99999px",bg:"dialogText",boxShadow:"0 0 0 2px "+g.colors.inputBackground,transition:"left 250ms ease-in-out"},style:{left:"left"===v?0:20}})),o.a.createElement(u,{css:{cursor:"pointer",flex:"1",alignItems:"flex-start"},onClick:function(){return h("right")}},i))},Xr=function(e){var t=e.deferred,r=Object(a.useContext)(ee),n=r.soundEnabled,i=r.toggleSound,c=Object(a.useContext)(Gr),l=c.tipsEnabled,d=c.toggleTips,m=c.resetTips,p=Dr(),g=p[0],v=p[1],b=Object(a.useContext)(vr.LanguageContext),h=b.language,y=b.setLanguage,E=s(),O=Object(Nr.useSwitchTheme)(),w=O[0],x=O[1];return o.a.createElement(ue,{title:o.a.createElement(me,null,E.formatMessage({id:"Settings"})),onClose:function(){return t.reject(f.DIALOG_CLOSED_REASON)},css:{gap:4}},o.a.createElement(u,{css:{gap:3}},o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,E.formatMessage({id:"Language"})),o.a.createElement(Le,{as:"select",onChange:function(e){y(e.target.value)},value:h},vr.supportedLanguages.map((function(e){return o.a.createElement("option",{key:e,value:e},E.formatMessage({id:e}))})))),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,E.formatMessage({id:"Difficulty"})),o.a.createElement(Yr,{value:g,onChange:v,leftComponent:o.a.createElement(le,null,E.formatMessage({id:"Easy"})),leftValue:!0,rightComponent:o.a.createElement(le,null,E.formatMessage({id:"Hard"})),rightValue:!1})),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,E.formatMessage({id:"Theme"})),o.a.createElement(Yr,{value:w,onChange:x,leftComponent:o.a.createElement(u,{as:F.k,css:{size:"icon"}}),leftValue:"light",rightComponent:o.a.createElement(u,{as:F.e,css:{size:"icon"}}),rightValue:"dark"})),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,E.formatMessage({id:"Sounds"})),o.a.createElement(Yr,{invertSounds:!0,value:n,onChange:i,leftComponent:o.a.createElement(u,{as:F.n,css:{size:"icon"}}),leftValue:!1,rightComponent:o.a.createElement(u,{as:F.m,css:{size:"icon"}}),rightValue:!0})),o.a.createElement(u,{css:{gap:2}},o.a.createElement("label",null,E.formatMessage({id:"Show tips"})),o.a.createElement(Yr,{value:l,onChange:d,leftComponent:o.a.createElement(le,null,E.formatMessage({id:"Yes"})),leftValue:!0,rightComponent:o.a.createElement(le,null,E.formatMessage({id:"No"})),rightValue:!1}))),o.a.createElement(ae,{onClick:m},E.formatMessage({id:"Reset tips"})))},Kr=Object(a.createContext)(),$r=function(e){var t=e.children,r=Object(a.useContext)(S).initialized,n=Object(a.useContext)(B),i=n.playlist,c=n.startRandomPlaylist,s=n.initialized,u=Object(a.useContext)(R),l=u.initialized,f=u.approvedTangrams,d=Object(a.useState)(!1),m=d[0],p=d[1],g=Object(a.useState)(null),v=g[0],b=g[1],h=Object(a.useCallback)((function(e){var t=new Pr;return b({uid:e,deferred:t}),t.promise.finally((function(){return b(null)}))}),[]),y=Object(a.useState)(null),E=y[0],O=y[1],w=Object(a.useCallback)((function(){var e=new Pr;return O(e),e.promise.finally((function(){return O(null)}))}),[]),x=Object(a.useState)(null),j=x[0],C=x[1],I=Object(a.useCallback)((function(){var e=new Pr;return C(e),e.promise.finally((function(){return C(null)}))}),[]),k=Object(a.useState)(null),A=k[0],M=k[1],T=Object(a.useCallback)((function(){var e=new Pr;return M(e),e.promise.finally((function(){return M(null)}))}),[]),L=Object(a.useState)(null),P=L[0],N=L[1],_=Object(a.useCallback)((function(e){var t=new Pr;return N({deferred:t,tangram:e}),t.promise.finally((function(){return N(null)}))}),[]),D=Object(a.useState)(null),U=D[0],z=D[1],F=Object(a.useCallback)((function(){var e=new Pr;return z(e),e.promise.finally((function(){return z(null)}))}),[]),G=Object(a.useState)(null),V=G[0],q=G[1];Object(a.useEffect)((function(){if(l&&s&&r&&!m){var e=!1;if(!i&&window.location.search){var t=new URLSearchParams(window.location.search);if(t.has("tangrams")){var n=t.get("tangrams").split(","),a=t.get("uid"),o=f.filter((function(e){return n.includes(e.id)}));if(o.length){e=!0,window.history.replaceState({},document.title,window.location.origin);var u=new Pr;q({deferred:u,tangrams:o,uid:a}),u.promise.catch((function(e){if(e instanceof Error)throw e;c(!0)})).finally((function(){return q(null)}))}}}e||c(!0),p(!0)}}),[l,s,r,m]);var W=Object(a.useMemo)((function(){return{showProfile:h,showLeaderboard:w,showGallery:I,showLogin:T,showTangram:_,showSettings:F}}),[h,w,I,T,_,F]);return o.a.createElement(Kr.Provider,{value:W},t,A&&o.a.createElement(gr,{deferred:A}),j&&o.a.createElement(Be,{deferred:j}),P&&o.a.createElement(Lr,P),v&&o.a.createElement(jr,v),E&&o.a.createElement(Ge,{deferred:E}),V&&o.a.createElement(he,V),U&&o.a.createElement(Xr,{deferred:U}))},Jr=function(e){var t=e.action,r=e.icon,n=e.text,i=Object(a.useContext)(ee).playButton;return o.a.createElement(u,{css:{alignItems:"center",flexDirection:"row",gap:3,cursor:"pointer",py:3},onClick:function(){i(),t()}},o.a.createElement(u,{as:r,css:{size:"icon"}}),o.a.createElement(le,{css:{fontSize:3}},n))},Qr=function(){var e=Object(a.useContext)(B),t=e.playlist,r=e.saveRequestId,i=Object(a.useContext)(S).currentUser,c=Object(a.useContext)(ee).playButton,d=s(),m=Object(a.useContext)(Kr),p=m.showLeaderboard,g=m.showGallery,v=m.showLogin,b=m.showProfile,h=m.showSettings,y=Object(a.useState)(),E=y[0],O=y[1];Object(a.useEffect)((function(){E&&E.reject(f.DIALOG_CLOSED_REASON)}),[t,r]);var w=Object(a.useContext)(B).requestSave,x=Object(n.useKeyframes)({0:{color:"pieces.lt2"},14:{color:"pieces.rh"},28:{color:"pieces.st2"},42:{color:"pieces.mt1"},57:{color:"pieces.st1"},71:{color:"pieces.lt1"},85:{color:"pieces.sq"},100:{color:"pieces.lt2"}}),j=Object(n.useKeyframes)({from:{transform:"translate(0, 0)"},to:{transform:"translate(30px, -30px)"}});return o.a.createElement(o.a.Fragment,null,o.a.createElement(u,{css:{position:"fixed",top:3,left:3,animation:x+" 20s linear infinite both"}},o.a.createElement(u,{as:F.d,css:{size:"menu",cursor:"pointer"},onClick:function(){c();var e=new Pr;return O(e),e.promise.finally((function(){return O(null)}))}})),E&&o.a.createElement(ue,{onClose:function(){return E.reject(f.DIALOG_CLOSED_REASON)},title:o.a.createElement(u,{css:{flexDirection:"row",gap:3,alignItems:"center"}},o.a.createElement(l,{css:{size:"badge",ml:"-2px",mr:"-6px",overflow:"visible","& > g":{animation:j+" "+f.FADE_TRANSITION_DURATION+"ms "+f.FADE_STAGGER_DURATION+"ms ease both"}}}),o.a.createElement(me,null,d.formatMessage({id:"Amstangram"}))),css:{gap:3,overflow:"initial"}},o.a.createElement(u,null,i?o.a.createElement(Jr,{action:function(){return b(i.uid)},icon:function(){return o.a.createElement(ce,{css:{mx:-1},uid:i.uid,size:"badge"})},text:d.formatMessage({id:"See my profile"})}):o.a.createElement(Jr,{action:v,icon:F.l,text:d.formatMessage({id:"Log in"})}),o.a.createElement(Jr,{action:g,icon:F.c,text:d.formatMessage({id:"Tangram gallery"})}),o.a.createElement(Jr,{action:w,icon:F.g,text:d.formatMessage({id:"Save tangram"})}),o.a.createElement(Jr,{action:p,icon:F.a,text:d.formatMessage({id:"Leaderboard"})}),o.a.createElement(Jr,{action:h,icon:F.h,text:d.formatMessage({id:"Settings"})})),o.a.createElement(u,{css:{flexDirection:"row",alignItems:"baseline",justifyContent:"space-between"}},o.a.createElement(de,{as:ge,href:"mailto:millagou.benjamin@gmail.com?subject="+d.formatMessage({id:"A word about Amstangram"}),target:"_blank",rel:"noopener, noreferrer"},d.formatMessage({id:"Contact üíå"})),o.a.createElement(de,{as:ge,href:"https://github.com/myagoo/amstangram",target:"_blank",rel:"noopener, noreferrer"},d.formatMessage({id:"Version {code}"},{code:"‚≠ê.üçΩ.üí£"})))))},Zr=function(e,t){var r=new window.ClipperLib.ClipperOffset,n=new window.ClipperLib.Paths;if(r.AddPaths([e.map((function(e){return{X:e.x,Y:e.y}}))],window.ClipperLib.JoinType.jtMiter,window.ClipperLib.EndType.etClosedPolygon),r.MiterLimit=0,r.ArcTolerance=0,r.Execute(n,t),n.length)return n[0].map((function(e){var t=e.X,r=e.Y;return new kr.a.Point(t,r)}))},en=function(e,t){var r=[new kr.a.Point(0,0),new kr.a.Point(2*e,0),new kr.a.Point(e,e)],n=new kr.a.Path({name:"display",segments:r,closed:!0}),a=new kr.a.Path({name:"collision",segments:Zr(r,-f.COLLISION_MARGIN),closed:!0}),o=new kr.a.Path({name:"insetBorder",segments:Zr(r,-f.INSET_BORDER),closed:!0,strokeWidth:f.INSET_BORDER}),i=function(e){var t=e[1].getDistance(e[2]),r=e[0].getDistance(e[2]),n=e[0].getDistance(e[1]),a=t+r+n,o=(e[0].x*t+e[1].x*r+e[2].x*n)/a,i=(e[0].y*t+e[1].y*r+e[2].y*n)/a;return new kr.a.Point(o,i)}(r),c=new kr.a.Point(kr.a.view.center.x+i.x-n.bounds.width/2,kr.a.view.center.y+i.y-n.bounds.height/2);return new kr.a.Group({children:[n,a,o],position:kr.a.view.center,pivot:c,data:{id:t,collisions:new Set},applyMatrix:!0})},tn=function(e,t){var r=[new kr.a.Point(0,0),new kr.a.Point(2*e,0),new kr.a.Point(3*e,e),new kr.a.Point(e,e)],n=new kr.a.Path({name:"display",segments:r,closed:!0}),a=new kr.a.Path({name:"collision",segments:Zr(r,-f.COLLISION_MARGIN),closed:!0,strokeWidth:f.COLLISION_MARGIN}),o=new kr.a.Path({name:"insetBorder",segments:Zr(r,-f.INSET_BORDER),closed:!0,strokeWidth:f.INSET_BORDER});return new kr.a.Group({children:[n,a,o],position:kr.a.view.center,data:{id:t,collisions:new Set},applyMatrix:!0})};function rn(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return nn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nn(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var an=function(e,t,r){var n=r.x-t.x,a=r.y-t.y,o=n*n+a*a,i=(e.x-t.x)*n+(e.y-t.y)*a,c=Math.min(1,Math.max(0,i/o));return i=(r.x-t.x)*(e.y-t.y)-(r.y-t.y)*(e.x-t.x),new kr.a.Point(t.x+n*c,t.y+a*c)};function on(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return cn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cn(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sn=function(e,t,r){for(var n,a=on(t);!(n=a()).done;)for(var o,i=n.value,c=on(i.segments);!(o=c()).done;)for(var s,u=o.value.point,l=on(e.segments);!(s=l()).done;){var f=s.value.point,d=f.getDistance(u);d<r.distance&&(r.distance=d,r.shape=i,r.vector=u.subtract(f))}if(!r.vector)for(var m,p=on(t);!(m=p()).done;){for(var g,v=m.value,b=on(e.segments);!(g=b()).done;)for(var h,y=g.value.point,E=on(v.segments);!(h=E()).done;){var O=h.value,w=O.point,x=O.next.point,j=an(y,w,x),S=j.getDistance(y);S<r.distance&&(r.distance=S,r.vector=j.subtract(y),r.shape=v,r.segment=[w,x],r.point=y)}for(var C,I=on(v.segments);!(C=I()).done;)for(var k,A=C.value.point,M=on(e.segments);!(k=M()).done;){var T=k.value,R=T.point,L=T.next.point,P=an(A,R,L),N=P.getDistance(A);N<r.distance&&(r.distance=N,r.vector=A.subtract(P),r.shape=e,r.segment=[R,L])}}return r},un=function(e,t,r){if(r.segment){for(var n,a=r.maxDistance,o=r.segment,i=o[0],c=o[1],s=0,u=[Math.atan2(c.y-i.y,c.x-i.x),Math.atan2(i.y-c.y,i.x-c.x)];s<u.length;s++)for(var l,f=u[s],d=on(e.segments);!(l=d()).done;){var m=l.value.point;if(m!==r.point)for(var p,g=m.add(r.vector),v=new kr.a.Point(g.x+r.maxDistance*Math.cos(f),g.y+r.maxDistance*Math.sin(f)),b=new kr.a.Path.Line({from:g,to:v,insert:!1}),h=on(t);!(p=h()).done;)for(var y,E=p.value,O=on(b.getIntersections(E));!(y=O()).done;){var w=y.value.point.subtract(g).add(r.vector);w.length<r.maxDistance&&w.length<=a&&(a=w.length,n=w)}}n&&(r.vector=n)}};function ln(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return fn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fn(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dn(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return mn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mn(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pn=function(e,t){var r=e.pivot?e.pivot.subtract(e.bounds.center):new kr.a.Point;e.bounds.x<0&&(e.position.x=e.bounds.width/2+r.x),e.bounds.y<0&&(e.position.y=e.bounds.height/2+r.y),e.bounds.x+e.bounds.width>t.width/window.devicePixelRatio&&(e.position.x=t.width/window.devicePixelRatio-e.bounds.width/2+r.x),e.bounds.y+e.bounds.height>t.height/window.devicePixelRatio&&(e.position.y=t.height/window.devicePixelRatio-e.bounds.height/2+r.y)},gn=function(e,t){var r=new kr.a.Point(kr.a.project.view.bounds.width,kr.a.project.view.bounds.height).subtract(2*f.SCRAMBLE_PADDING);if(e.position=kr.a.Point.random().multiply(r).add(f.SCRAMBLE_PADDING),"rh"===e.data.id){var n=45*Math.round(3*Math.random());e.rotation=n,e.data.rotation=n}else e.rotation=45*Math.round(7*Math.random())},vn=function(e,t){return t.segments.every((function(t){return e.contains(t.point)}))};function bn(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return hn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hn(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var yn=function(e,t){for(var r,n=bn(t.children);!(r=n()).done;){var a=r.value;if(a!==e){var o=e.children.collision,i=a.children.collision;o.intersects(i)||vn(o,i)||vn(i,o)?(e.data.collisions.add(a.data.id),a.data.collisions.add(e.data.id)):(e.data.collisions.delete(a.data.id),a.data.collisions.delete(e.data.id))}}for(var c,s=!0,u=bn(t.children);!(c=u()).done;){var l=c.value;l.data.collisions.size>0?(s=!1,l.children.display.opacity=f.OVERLAPING_OPACITY):l.children.display.opacity=1}return s},En=function(e){var t=e.tangram,r=e.onStop,i=e.onNext,c=e.onApprove,l=e.onStarToggle,d=s(),m=Object(a.useState)(!1),p=m[0],g=m[1],v=Object(a.useContext)(ee).playStar,b=Object(a.useContext)(B),h=b.tangramsStarredBy,y=b.isTangramStarred,E=Object(a.useMemo)((function(){var e=0;for(var r in h[t.id])h[t.id][r]&&(e+=1);return e}),[t,h]),O=y(t.id),w=Object(n.useKeyframes)({0:{opacity:"0",transform:"rotate(0) scale(0)"},100:{opacity:1,transform:"rotate(1800deg) scale(1)"}});return o.a.createElement(u,{css:{position:"absolute",top:0,left:0,right:0,bottom:0,alignItems:"center",justifyContent:"center",gap:3}},o.a.createElement(u,{css:{position:"relative"}},o.a.createElement(u,{key:"emojiSpin",onAnimationEnd:function(){setTimeout((function(){return g(!0)}),1e3)},css:{textShadow:"0px 5px 10px #00000080",fontSize:"30vmin",animation:"2000ms "+w+" cubic-bezier(.6,1.56,.58,.92) forwards"}},t.emoji),p&&o.a.createElement(u,{css:{mt:3,position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",flexDirection:"row",gap:3,animation:f.FADE_TRANSITION_DURATION+"ms fadeIn ease both"}},c&&o.a.createElement(u,{as:ie,onClick:c,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"}},o.a.createElement(u,{as:F.b,css:{size:"icon"}}),o.a.createElement(le,null,d.formatMessage({id:"Approve"}))),l&&o.a.createElement(u,{as:ie,mute:!0,onClick:function(){v(),l()},css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"}},o.a.createElement(le,null,E),o.a.createElement(u,{as:F.j,css:{size:"icon",fill:O?"currentColor":void 0},deps:[O]})),i?o.a.createElement(u,{as:ie,onClick:i,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"}},o.a.createElement(u,{as:F.f,css:{size:"icon"}}),o.a.createElement(le,null,d.formatMessage({id:"Next"}))):o.a.createElement(u,{as:ie,onClick:r,css:{boxShadow:"0px 5px 10px #00000080",flexDirection:"row",gap:2,alignItems:"flex-end"}},o.a.createElement(u,{as:F.o,css:{size:"icon"}}),o.a.createElement(le,null,d.formatMessage({id:"Quit"}))))))};function On(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return wn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wn(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xn(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void r(u)}c.done?t(s):Promise.resolve(s).then(n,a)}function jn(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){xn(o,n,a,i,c,"next",e)}function c(e){xn(o,n,a,i,c,"throw",e)}i(void 0)}))}}var Sn=function(){var e=s(),t=Object(a.useContext)(Gr),r=t.showRandomTip,i=t.showWelcome,c=Object(a.useContext)(Kr),l=c.showLogin,d=c.showTangram,p=Object(a.useContext)(ee),g=p.playTangram,b=p.playVictory,h=Object(a.useRef)();h.current={tangram:g,victory:b};var E=Object(a.useContext)(S).currentUser;Object(a.useRef)().current=E;var O=Object(a.useContext)(n.ThemeContext),w=Object(a.useContext)(y),x=Dr()[0],j=Object(a.useContext)(B),C=j.saveRequestId,I=j.playlist,k=j.setPlaylist,A=j.markTangramAsComplete,M=j.toggleTangramStar,T=Object(a.useRef)();T.current=A;var R=Object(a.useState)(0),L=R[0],P=R[1],N=Object(a.useState)(!1),_=N[0],D=N[1],U=Object(a.useRef)(),z=Object(a.useRef)(),F=Object(a.useRef)(),G=Object(a.useRef)(),V=Object(a.useRef)(),q=Object(a.useRef)(),W=Object(a.useMemo)((function(){return I&&I[L]}),[I,L]),H=function(){var t=jn(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.firestore().collection("tangrams").doc(W.id).update({approved:!0});case 2:w(e.formatMessage({id:"Tangram approved"}));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){P(0)}),[I]),Object(a.useEffect)((function(){if(C){if(!function(e){for(var t,r=dn(e.children);!(t=r()).done;){if(t.value.data.collisions.size>0)return!1}return!0}(F.current))return void w(e.formatMessage({id:"You can't save an invalid tangram"}));var t=function(e,t){for(var r,n,a=rn(e.children);!(n=a()).done;){var o=n.value.children.display;r=r?r.unite(o,{insert:!1}):o}r.scale(1/t),r.position=new kr.a.Point(r.bounds.width/2,r.bounds.height/2);var i=r.exportSVG().getAttribute("d"),c=r.curves.length,s=Math.round(r.bounds.width),u=Math.round(r.bounds.height),l=Math.round(r.length);return r.remove(),{width:s,height:u,length:l,path:i,edges:c}}(F.current,z.current);if(23===t.edges)return void w(e.formatMessage({id:"You can't save such an easy tangram"}));(function(){var e=jn(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E){e.next=3;break}return e.next=3,l();case 3:return e.next=5,d(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}}),[C]),Object(a.useEffect)((function(){var e=function(){if(U.current&&F.current)for(var e,t=On(F.current.children);!(e=t()).done;){var r=e.value;pn(r,U.current)}};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),Object(a.useLayoutEffect)((function(){var e=Date.now(),t=function(t){var r=null,n=null,a=null,o=null,i=function(e){document.activeElement===U.current&&(document.body.style.cursor="pointer")},c=function(e){document.body.style.cursor="default"},s=function(e){a=Date.now(),o=e.point,r=e.point.subtract(t.position),n=t.clone({insert:!1,deep:!0}),t.bringToFront()},u=function(e){document.body.style.cursor="move";var a=e.point.subtract(t.position).subtract(r);n.position=t.position.add(a);var o,i,c,s,u,l=n.children["display 1"],d=F.current.children.filter((function(e){return e!==t})).map((function(e){return e.children.display})),m=q.current&&V.current?V.current.children?V.current.children:[V.current]:null,p=(o=f.SNAP_DISTANCE,s=m,sn(i=l,c=d,u={maxDistance:o,distance:o}),s&&sn(i,s,u),un(i,c.filter((function(e){return e.shape!==u.shape})),u),s&&un(i,s,u),u.vector);p&&(n.position.x+=p.x,n.position.y+=p.y),pn(n,U.current),t.position=n.position,yn(t,F.current)},l=function(i){if(document.body.style.cursor="pointer",i.point.subtract(o).length<f.SNAP_DISTANCE&&Date.now()-a<f.CLICK_TIMEOUT&&(t.rotation+=45,"rh"===t.data.id&&(t.data.rotation+=45,180===t.data.rotation&&(t.data.rotation=0,t.scale(-1,1))),h.current.tangram(),pn(t,U.current),yn(t,F.current),a=null,o=null),r=null,n&&n.remove(),n=null,V.current&&(!1===q.current&&(V.current.position=F.current.position),function(e,t,r){for(var n,a=e,o=ln(t.children);!(n=o()).done;){var i=n.value;if(i.data.collisions.size>0)return;a=a.unite(new kr.a.Path({segments:Zr(i.children.display.segments.map((function(e){return e.point})),-r),closed:!0,insert:!1}),{insert:!1})}return Math.round(1e3*a.length)===Math.round(1e3*e.length)}(V.current,F.current,q.current?f.STRICT_ERROR_MARGIN:f.SOFT_ERROR_MARGIN))){T.current(W,Date.now()-e);for(var c,s=On(F.current.children);!(c=s()).done;){c.value.data.removeListeners()}document.body.style.cursor="default",kr.a.project.activeLayer.tween({opacity:0},{duration:f.VICTORY_PARTICLES_DURATION,easing:"easeInCubic"});for(var u,l=On(G.current);!(u=l()).done;){var d=u.value;d.data.animation.stop(),d.tween({"position.x":F.current.position.x,"position.y":F.current.position.y,opacity:f.MAX_PARTICLE_OPACITY},{duration:f.VICTORY_PARTICLES_DURATION,easing:"easeInCubic"})}setTimeout((function(){h.current.victory(),kr.a.project.activeLayer.tween({opacity:1},{duration:f.FADE_TRANSITION_DURATION,easing:"easeOutCubic"});for(var e,t=Math.max(kr.a.view.bounds.width,kr.a.view.bounds.height)/2,r=On(G.current);!(e=r()).done;){var n=e.value;n.data.animation.stop();var a=Math.random()*Math.PI*2,o=Math.random()*t;n.tween({"position.x":n.position.x+o*Math.cos(a),"position.y":n.position.y+o*Math.sin(a),opacity:0},{duration:f.VICTORY_PARTICLES_DURATION,easing:"easeOutCubic"})}D(!0)}),f.VICTORY_PARTICLES_DURATION)}};t.on({mouseenter:i,mouseleave:c,mousedown:s,mousedrag:u,mouseup:l}),t.data.removeListeners=function(){return t.off({mouseenter:i,mouseleave:c,mousedown:s,mousedrag:u,mouseup:l})}};return function(){var e,r,n,a,o,i,c,s;kr.a.setup(U.current),F.current=(i=f.SMALL_TRIANGLE_BASE,c=Math.sqrt(2*Math.pow(i,2)),s=Math.sqrt(2*Math.pow(c,2)),new kr.a.Group([en(i,"st1"),en(i,"st2"),en(c,"mt1"),en(s,"lt1"),en(s,"lt2"),(e=c,r="sq",n=new kr.a.Path.Rectangle({name:"display",point:[0,0],size:[e,e]}),a=new kr.a.Path.Rectangle({name:"collision",point:[f.COLLISION_MARGIN,f.COLLISION_MARGIN],size:[e-2*f.COLLISION_MARGIN,e-2*f.COLLISION_MARGIN]}),o=new kr.a.Path.Rectangle({name:"insetBorder",point:[f.INSET_BORDER,f.INSET_BORDER],size:[e-2*f.INSET_BORDER,e-2*f.INSET_BORDER],strokeWidth:f.INSET_BORDER}),new kr.a.Group({children:[n,a,o],position:kr.a.view.center,data:{id:r,collisions:new Set},applyMatrix:!0,rotation:45*Math.round(7*Math.random())})),tn(i,"rh")])),W&&(V.current=kr.a.project.importSVG('<path d="'+W.path+'" />',{applyMatrix:!0}),V.current.sendToBack(),V.current.fillRule="evenodd",V.current.closed=!0);var u=kr.a.project.view.bounds,l=V.current?V.current.bounds:F.current.children[3].bounds.scale(2);u.width>u.height?z.current=Math.min(2,Math.min(.6*u.width,700)/l.width,Math.min(.8*u.height,600)/l.height):z.current=Math.min(2,Math.min(.8*u.width,600)/l.width,Math.min(.6*u.height,700)/l.height),V.current&&(V.current.scale(z.current),V.current.position=kr.a.view.center);for(var d,m=On(F.current.children);!(d=m()).done;){var p=d.value;p.scale(z.current),gn(p,U.current),t(p),pn(p,U.current),yn(p,F.current)}}(),function(){kr.a.project.remove(),G.current=null,F.current=null,V.current=null}}),[W]),Object(a.useLayoutEffect)((function(){q.current=x,V.current&&(x?(V.current.fillColor=O.colors.shape,V.current.position=kr.a.view.center):V.current.fillColor="transparent")}),[W,x,O]),Object(a.useLayoutEffect)((function(){var e=new kr.a.Group;e.sendToBack();var t=new kr.a.Point(U.current.width,U.current.height).divide(window.devicePixelRatio),r=function(){return Math.random()*(f.MAX_PARTICLE_SIZE-f.MIN_PARTICLE_SIZE)+f.MIN_PARTICLE_SIZE},n=function(){return Math.random()*(f.MAX_PARTICLE_OPACITY-f.MIN_PARTICLE_OPACITY)+f.MIN_PARTICLE_OPACITY};G.current=new Array(f.PARTICLES_COUNT);for(var a=function(a){var o=new kr.a.Path.Circle({center:kr.a.Point.random().multiply(t),radius:r(),opacity:n(),parent:e,data:{index:a}});!function e(){var t={radius:r(),opacity:n(),"position.x":Math.min(U.current.width/window.devicePixelRatio,Math.max(0,o.position.x+200*Math.random()-100)),"position.y":Math.min(U.current.height/window.devicePixelRatio,Math.max(0,o.position.y+200*Math.random()-100))};o.data.animation=o.tween(t,{duration:1e4*Math.random()+5e3,easing:"easeInOutQuad"}).then(e)}(),G.current[a]=o},o=0;o<f.PARTICLES_COUNT;o++)a(o)}),[W]),Object(a.useLayoutEffect)((function(){for(var e,t=On(F.current.children);!(e=t()).done;){var r=e.value;r.children.display.fillColor=O.colors.pieces[r.data.id],r.children.insetBorder.strokeColor=O.colors.pieces[r.data.id]}for(var n,a=Object.values(O.colors.pieces),o=On(G.current);!(n=o()).done;){n.value.fillColor=a[Math.floor(Math.random()*a.length)]}}),[O.colors,W]),Object(a.useEffect)((function(){i()}),[]),o.a.createElement(u,{css:{flex:"1",position:"relative",color:"dialogText",animation:f.FADE_TRANSITION_DURATION+"ms fadeIn ease"}},W&&!1===x&&o.a.createElement(u,{css:{zIndex:-1,position:"absolute",top:3,right:3,cursor:"pointer"}},o.a.createElement(se,{tangram:W,selected:!0,hideBadge:!0})),o.a.createElement(u,{as:"canvas",ref:U,css:{minHeight:"auto",flex:1}}),W&&_&&o.a.createElement(En,{tangram:W,onStop:function(){D(!1),k(null),r()},onNext:L<I.length-1?function(){D(!1),P(L+1),r()}:void 0,onApprove:E&&E.isAdmin&&!W.approved?H:void 0,onStarToggle:E&&W.approved?function(){return M(W)}:void 0}))},Cn=function(){var e=s(),t=Object(a.useContext)(y),r=Object(a.useState)(!1),n=r[0],i=r[1],c=Object(a.useState)(!1),d=c[0],m=c[1],p=Object(a.useState)(!1),g=p[0],v=p[1],b=Object(a.useState)(!1),h=b[0],E=b[1],O=Object(a.useContext)(R).initialized,w=Object(a.useContext)(B),x=w.playlist,j=w.initialized,C=Object(a.useContext)(S),I=C.currentUser,k=C.initialized&&O&&j&&x;if(Object(a.useEffect)((function(){setTimeout((function(){return i(!0)}),2*f.FADE_TRANSITION_DURATION),v(setTimeout((function(){return m(!0)}),2*f.FADE_TRANSITION_DURATION))}),[]),Object(a.useEffect)((function(){k&&(clearTimeout(g),m(!1))}),[k]),h)return o.a.createElement(o.a.Fragment,null,o.a.createElement(Sn,null),o.a.createElement(Qr,null));return o.a.createElement(u,{css:{flex:"1",alignItems:"center",justifyContent:"center",gap:3,animation:k&&n?f.FADE_TRANSITION_DURATION+"ms fadeIn ease "+f.FADE_STAGGER_DURATION+"ms reverse":void 0},deps:[k,n],onAnimationEnd:function(r){r.currentTarget===r.target&&(E(!0),I&&t(e.formatMessage({id:"Logged in as {username}"},{username:I.username})))}},o.a.createElement(u,{css:{animation:f.FADE_TRANSITION_DURATION+"ms fadeIn ease "+f.FADE_STAGGER_DURATION+"ms both"}},o.a.createElement(l,{css:{size:"logo",overflow:"visible","& > g":{transition:"all "+f.FADE_TRANSITION_DURATION+"ms ease",transform:k&&n?"translate(30px, -30px)":"translate(0, 0)"}},deps:[k,n]})),o.a.createElement(me,{css:{transition:"opacity "+f.FADE_TRANSITION_DURATION+"ms ease",opacity:d?1:0},deps:[d]},e.formatMessage({id:"Loading..."})))};t.default=function(){return Object(a.useEffect)((function(){window.oncontextmenu=function(){return!1}}),[]),Object(n.useGlobalCss)({body:{m:0,bg:"background",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",\n        "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",\n        "Helvetica Neue", sans-serif',"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",transition:"background-color "+f.COLOR_TRANSITION_DURATION+"ms"},"body, html, #___gatsby, #gatsby-focus-wrapper":{height:"100%"},"#gatsby-focus-wrapper":{display:"flex",flexDirection:"column",padding:"\n        env(safe-area-inset-top, 0)\n        env(safe-area-inset-right, 0)\n        env(safe-area-inset-bottom, 0)\n        env(safe-area-inset-left, 0)\n      "},"*":{boxSizing:"border-box",userSelect:"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"},"input, textarea":{"-webkit-user-select":"initial","-moz-user-select":"initial","-ms-user-select":"initial",userSelect:"initial"}}),o.a.createElement(te,null,o.a.createElement(vr.LanguageProvider,null,o.a.createElement(E,null,o.a.createElement(C,null,o.a.createElement(L,null,o.a.createElement(Ur,null,o.a.createElement(z,null,o.a.createElement(Hr,null,o.a.createElement($r,null,o.a.createElement(u,{css:{flex:"1",color:"dialogText",fontSize:3}},o.a.createElement(Cn,null)))))))))))}},Wcq6:function(e,t,r){"use strict";var n,a=(n=r("wj3C"))&&"object"==typeof n&&"default"in n?n.default:n;a.registerVersion("firebase","7.14.0","app"),e.exports=a},bHtr:function(e,t,r){var n=r("XKFU");n(n.P,"Array",{fill:r("Nr18")}),r("nGyu")("fill")},ls82:function(e,t,r){r("rGqo"),r("yt8O"),r("a1Th"),r("VRzm"),r("Btvt"),r("f3/d"),r("rE2o"),r("ioFf");var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),i=new I(n||[]);return o._invoke=function(e,t,r){var n=l;return function(a,o){if(n===d)throw new Error("Generator is already running");if(n===m){if("throw"===a)throw o;return A()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var c=j(i,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var s=u(e,t,r);if("normal"===s.type){if(n=r.done?m:f,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=m,r.method="throw",r.arg=s.arg)}}}(e,r,i),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}e.wrap=s;var l="suspendedStart",f="suspendedYield",d="executing",m="completed",p={};function g(){}function v(){}function b(){}var h={};h[o]=function(){return this};var y=Object.getPrototypeOf,E=y&&y(y(k([])));E&&E!==r&&n.call(E,o)&&(h=E);var O=b.prototype=g.prototype=Object.create(h);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function x(e){var t;this._invoke=function(r,a){function o(){return new Promise((function(t,o){!function t(r,a,o,i){var c=u(e[r],e,a);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,o,i)}),(function(e){t("throw",e,o,i)})):Promise.resolve(l).then((function(e){s.value=e,o(s)}),(function(e){return t("throw",e,o,i)}))}i(c.arg)}(r,a,t,o)}))}return t=t?t.then(o,o):o()}}function j(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var a=u(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var o=a.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function k(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:A}}function A(){return{value:t,done:!0}}return v.prototype=O.constructor=b,b.constructor=v,b[c]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},w(x.prototype),x.prototype[i]=function(){return this},e.AsyncIterator=x,e.async=function(t,r,n,a){var o=new x(s(t,r,n,a));return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(O),O[c]="Generator",O[o]=function(){return this},O.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=k,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return c.type="throw",c.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=n}catch(a){Function("r","regeneratorRuntime = r")(n)}},mLhc:function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),i=new I(n||[]);return o._invoke=function(e,t,r){var n=l;return function(a,o){if(n===d)throw new Error("Generator is already running");if(n===m){if("throw"===a)throw o;return A()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var c=j(i,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var s=u(e,t,r);if("normal"===s.type){if(n=r.done?m:f,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=m,r.method="throw",r.arg=s.arg)}}}(e,r,i),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}e.wrap=s;var l="suspendedStart",f="suspendedYield",d="executing",m="completed",p={};function g(){}function v(){}function b(){}var h={};h[o]=function(){return this};var y=Object.getPrototypeOf,E=y&&y(y(k([])));E&&E!==r&&n.call(E,o)&&(h=E);var O=b.prototype=g.prototype=Object.create(h);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function x(e,t){var r;this._invoke=function(a,o){function i(){return new t((function(r,i){!function r(a,o,i,c){var s=u(e[a],e,o);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(f).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,c)}))}c(s.arg)}(a,o,r,i)}))}return r=r?r.then(i,i):i()}}function j(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var a=u(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var o=a.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function k(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:A}}function A(){return{value:t,done:!0}}return v.prototype=O.constructor=b,b.constructor=v,b[c]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},w(x.prototype),x.prototype[i]=function(){return this},e.AsyncIterator=x,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new x(s(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(O),O[c]="Generator",O[o]=function(){return this},O.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=k,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return c.type="throw",c.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=n}catch(a){Function("r","regeneratorRuntime = r")(n)}},o0o1:function(e,t,r){e.exports=r("mLhc")},"pp/T":function(e,t,r){var n=r("XKFU");n(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},wCrC:function(e,t,r){e.exports=r.p+"static/pop-a0c7623b355005c8fd4af82974179acf.wav"},xiZb:function(e,t,r){e.exports=r.p+"static/star-14d2045abc08778cfdeaa1d9b31b8fb4.wav"}}]);
//# sourceMappingURL=component---src-pages-index-js-667f31c8e1ddd61f7184.js.map